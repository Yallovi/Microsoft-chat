{
  "version": 3,
  "sources": ["../../@microsoft/mgt-element/dist/es6/IBatch.ts", "../../@microsoft/mgt-element/dist/es6/IGraph.ts", "../../@microsoft/microsoft-graph-client/src/RequestMethod.ts", "../../@microsoft/microsoft-graph-client/src/content/BatchRequestContent.ts", "../../@microsoft/microsoft-graph-client/src/content/BatchResponseContent.ts", "../../@microsoft/microsoft-graph-client/src/Constants.ts", "../../@microsoft/microsoft-graph-client/src/GraphClientError.ts", "../../@microsoft/microsoft-graph-client/src/GraphRequestUtil.ts", "../../@microsoft/microsoft-graph-client/src/middleware/MiddlewareControl.ts", "../../@microsoft/microsoft-graph-client/src/middleware/MiddlewareUtil.ts", "../../@microsoft/microsoft-graph-client/src/middleware/options/AuthenticationHandlerOptions.ts", "../../@microsoft/microsoft-graph-client/src/middleware/options/TelemetryHandlerOptions.ts", "../../@microsoft/microsoft-graph-client/src/middleware/AuthenticationHandler.ts", "../../@microsoft/microsoft-graph-client/src/middleware/HTTPMessageHandler.ts", "../../@microsoft/microsoft-graph-client/src/middleware/options/RetryHandlerOptions.ts", "../../@microsoft/microsoft-graph-client/src/middleware/RetryHandler.ts", "../../@microsoft/microsoft-graph-client/src/middleware/options/RedirectHandlerOptions.ts", "../../@microsoft/microsoft-graph-client/src/middleware/RedirectHandler.ts", "../../@microsoft/microsoft-graph-client/src/Version.ts", "../../@microsoft/microsoft-graph-client/src/middleware/TelemetryHandler.ts", "../../@microsoft/microsoft-graph-client/src/middleware/MiddlewareFactory.ts", "../../@microsoft/microsoft-graph-client/src/middleware/options/ChaosStrategy.ts", "../../@microsoft/microsoft-graph-client/src/middleware/options/ChaosHandlerOptions.ts", "../../@microsoft/microsoft-graph-client/src/middleware/options/ChaosHandlerData.ts", "../../@microsoft/microsoft-graph-client/src/middleware/ChaosHandler.ts", "../../@microsoft/microsoft-graph-client/src/ResponseType.ts", "../../@microsoft/microsoft-graph-client/src/GraphResponseHandler.ts", "../../@microsoft/microsoft-graph-client/src/tasks/FileUploadTask/Range.ts", "../../@microsoft/microsoft-graph-client/src/tasks/FileUploadTask/UploadResult.ts", "../../@microsoft/microsoft-graph-client/src/tasks/LargeFileUploadTask.ts", "../../@microsoft/microsoft-graph-client/src/tasks/FileUploadTask/FileObjectClasses/FileUpload.ts", "../../@microsoft/microsoft-graph-client/src/tasks/OneDriveLargeFileUploadTaskUtil.ts", "../../@microsoft/microsoft-graph-client/src/tasks/OneDriveLargeFileUploadTask.ts", "../../@microsoft/microsoft-graph-client/src/tasks/FileUploadTask/FileObjectClasses/StreamUpload.ts", "../../@microsoft/microsoft-graph-client/src/tasks/PageIterator.ts", "../../@microsoft/microsoft-graph-client/src/CustomAuthenticationProvider.ts", "../../@microsoft/microsoft-graph-client/src/GraphError.ts", "../../@microsoft/microsoft-graph-client/src/GraphErrorHandler.ts", "../../@microsoft/microsoft-graph-client/src/GraphRequest.ts", "../../@microsoft/microsoft-graph-client/src/HTTPClient.ts", "../../@microsoft/microsoft-graph-client/src/HTTPClientFactory.ts", "../../@microsoft/microsoft-graph-client/src/ValidatePolyFilling.ts", "../../@microsoft/microsoft-graph-client/src/Client.ts", "../../@microsoft/microsoft-graph-client/src/browser/index.ts", "../../@microsoft/mgt-element/dist/es6/utils/utils/index.ts", "../../@microsoft/mgt-element/dist/es6/utils/utils/EventDispatcher.ts", "../../@microsoft/mgt-element/dist/es6/providers/providers/IProvider.ts", "../../@microsoft/mgt-element/dist/es6/providers/providers/Providers.ts", "../../@microsoft/mgt-element/dist/es6/utils/utils/GraphHelpers.ts", "../../@microsoft/mgt-element/dist/es6/utils/utils/Batch.ts", "../../@microsoft/mgt-element/dist/es6/utils/utils/ComponentMiddlewareOptions.ts", "../../@microsoft/mgt-element/dist/es6/utils/utils/SdkVersionMiddleware.ts", "../../@microsoft/mgt-element/dist/es6/utils/utils/version.ts", "../../@microsoft/mgt-element/dist/es6/components/components/customElementHelper.ts", "../../@microsoft/mgt-element/dist/es6/Graph.ts", "../../@microsoft/mgt-element/dist/es6/BetaGraph.ts", "../../@lit/reactive-element/src/css-tag.ts", "../../@lit/reactive-element/src/reactive-element.ts", "../../lit-html/src/lit-html.ts", "../../lit-element/src/lit-element.ts", "../../lit-html/src/is-server.ts", "../../lit/index.js", "../../@lit/reactive-element/src/decorators/custom-element.ts", "../../@lit/reactive-element/src/decorators/property.ts", "../../@lit/reactive-element/src/decorators/state.ts", "../../@lit/reactive-element/src/decorators/base.ts", "../../@lit/reactive-element/src/decorators/event-options.ts", "../../@lit/reactive-element/src/decorators/query.ts", "../../@lit/reactive-element/src/decorators/query-all.ts", "../../@lit/reactive-element/src/decorators/query-async.ts", "../../@lit/reactive-element/src/decorators/query-assigned-elements.ts", "../../@lit/reactive-element/src/decorators/query-assigned-nodes.ts", "../../lit/decorators.js", "../../@microsoft/mgt-element/dist/es6/utils/utils/LocalizationHelper.ts", "../../@microsoft/mgt-element/dist/es6/components/components/baseComponent.ts", "../../@microsoft/mgt-element/dist/es6/components/components/baseProvider.ts", "../../@microsoft/mgt-element/dist/es6/utils/utils/equals.ts", "../../@microsoft/mgt-element/dist/es6/utils/utils/TemplateHelper.ts", "../../@microsoft/mgt-element/dist/es6/components/components/templatedComponent.ts", "../../@microsoft/mgt-element/dist/es6/providers/providers/SimpleProvider.ts", "../../idb/build/esm/wrap-idb-value.js", "../../idb/build/esm/index.js", "../../@microsoft/mgt-element/dist/es6/utils/utils/Cache.ts", "../../@microsoft/mgt-element/dist/es6/utils/utils/TeamsHelper.ts", "../../@microsoft/mgt-element/dist/es6/utils/utils/TemplateContext.ts", "../../@microsoft/mgt-element/dist/es6/utils/utils/GraphPageIterator.ts", "../../@microsoft/mgt-element/dist/es6/utils/utils/mgtHtml.ts", "../../@microsoft/mgt-element/dist/es6/utils/utils/CustomElement.ts", "../../@microsoft/mgt-element/dist/es6/utils/utils/SessionCache.ts", "../../@microsoft/mgt-element/dist/es6/mock/mock/MockGraph.ts", "../../@microsoft/mgt-element/dist/es6/mock/mock/MockProvider.ts", "../../@microsoft/mgt-element/dist/es6/index.ts"],
  "sourcesContent": ["/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * Represents a response from a request executed in a batch\n *\n * @export\n * @class BatchResponse\n */\n// tslint:disable-next-line:max-classes-per-file\nexport class BatchResponse {\n  /**\n   * The index of the requests as it was added to the queue\n   * Use this value if you need to sort the responses\n   * in the order they were added\n   *\n   * @type {number}\n   * @memberof BatchResponse\n   */\n  public index: number;\n\n  /**\n   * The id of the requests\n   *\n   * @type {string}\n   * @memberof BatchResponse\n   */\n  public id: string;\n\n  /**\n   * The content of the response\n   *\n   * @type {*}\n   * @memberof BatchResponse\n   */\n  public content: any;\n  /**\n   * The header of the response\n   * @type {*}\n   * @memberof BatchResponse\n   */\n  public headers: string[];\n}\n\n/**\n * Represents a collection of Graph requests to be sent simultaneously.\n *\n * @export\n * @interface IBatch\n */\nexport interface IBatch {\n  /**\n   * Get whether there are requests that have not been executed\n   *\n   * @readonly\n   * @memberof IBatch\n   */\n  readonly hasRequests: boolean;\n\n  /**\n   * sets new request and scopes\n   *\n   * @param {string} id\n   * @param {string} resource\n   * @param {string[]} [scopes]\n   * @param {{ [header: string]: string }} [headers]\n   * @memberof IBatch\n   */\n  get(id: string, resource: string, scopes?: string[], headers?: { [header: string]: string });\n\n  /**\n   * Execute the next set of requests.\n   * This will execute up to 20 requests at a time\n   *\n   * @returns {Promise<Map<string, BatchResponse>>}\n   * @memberof IBatch\n   */\n  executeNext(): Promise<Map<string, BatchResponse>>;\n\n  /**\n   * Execute all requests, up to 20 at a time until\n   * all requests have been executed\n   *\n   * @returns {Promise<Map<string, BatchResponse>>}\n   * @memberof IBatch\n   */\n  executeAll(): Promise<Map<string, BatchResponse>>;\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { Client, GraphRequest } from '@microsoft/microsoft-graph-client';\nimport { IBatch } from './IBatch';\n\n/**\n * The common functions of the Graph\n *\n * @export\n * @interface IGraph\n */\nexport interface IGraph {\n  /**\n   * the internal client used to make graph calls\n   *\n   * @type {Client}\n   * @memberof IGraph\n   */\n  readonly client: Client;\n\n  /**\n   * the component name appended to Graph request headers\n   *\n   * @type {string}\n   * @memberof IGraph\n   */\n  readonly componentName: string;\n\n  /**\n   * the version of the graph to query\n   *\n   * @type {string}\n   * @memberof IGraph\n   */\n  readonly version: string;\n\n  /**\n   * returns a new instance of the Graph using the same\n   * client within the context of the provider.\n   *\n   * @param {Element} component\n   * @returns {IGraph}\n   * @memberof IGraph\n   */\n  forComponent(component: Element | string): IGraph;\n\n  /**\n   * use this method to make calls directly to the Graph.\n   *\n   * @param {string} path\n   * @returns {GraphRequest}\n   * @memberof IGraph\n   */\n  api(path: string): GraphRequest;\n\n  /**\n   * creates a new batch request\n   *\n   * @returns {Batch}\n   * @memberof IGraph\n   */\n  createBatch(): IBatch;\n}\n\n/**\n * GraphEndpoint is a valid URL that is used to access the Graph.\n */\nexport type GraphEndpoint =\n  | 'https://graph.microsoft.com'\n  | 'https://graph.microsoft.us'\n  | 'https://dod-graph.microsoft.us'\n  | 'https://graph.microsoft.de'\n  | 'https://microsoftgraph.chinacloudapi.cn';\n\n/**\n * MICROSOFT_GRAPH_ENDPOINTS is a set of all the valid Graph URL endpoints.\n */\nexport const MICROSOFT_GRAPH_ENDPOINTS: Set<GraphEndpoint> = new Set<GraphEndpoint>();\n\n/**\n * MICROSOFT_GRAPH_DEFAULT_ENDPOINT is the default Graph endpoint that is silently set on\n * the providers as the baseURL.\n */\nexport const MICROSOFT_GRAPH_DEFAULT_ENDPOINT: GraphEndpoint = 'https://graph.microsoft.com';\n\n(() => {\n  const endpoints: GraphEndpoint[] = [\n    MICROSOFT_GRAPH_DEFAULT_ENDPOINT,\n    'https://graph.microsoft.us',\n    'https://dod-graph.microsoft.us',\n    'https://graph.microsoft.de',\n    'https://microsoftgraph.chinacloudapi.cn'\n  ];\n  endpoints.forEach(endpoint => MICROSOFT_GRAPH_ENDPOINTS.add(endpoint));\n})();\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @enum\n * Enum for RequestMethods\n * @property {string} GET - The get request type\n * @property {string} PATCH - The patch request type\n * @property {string} POST - The post request type\n * @property {string} PUT - The put request type\n * @property {string} DELETE - The delete request type\n */\nexport enum RequestMethod {\n\tGET = \"GET\",\n\tPATCH = \"PATCH\",\n\tPOST = \"POST\",\n\tPUT = \"PUT\",\n\tDELETE = \"DELETE\",\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module BatchRequestContent\n */\nimport { RequestMethod } from \"../RequestMethod\";\n\n/**\n * @interface\n * Signature to represent the buffer request body parsing method\n * @property {Function} buffer - Returns a promise that resolves to a buffer of the request body\n */\ninterface NodeBody {\n\tbuffer(): Promise<Buffer>;\n}\n\n/**\n * @interface\n * Signature to represent the Request for both Node and browser environments\n * @extends Request\n * @extends NodeBody\n */\ninterface IsomorphicRequest extends Request, NodeBody {}\n\n/**\n * @interface\n * Signature representing BatchRequestStep data\n * @property {string} id - Unique identity for the request, Should not be an empty string\n * @property {string[]} [dependsOn] - Array of dependencies\n * @property {Request} request - The Request object\n */\nexport interface BatchRequestStep {\n\tid: string;\n\tdependsOn?: string[];\n\trequest: Request;\n}\n\n/**\n * @interface\n * Signature representing single request in a Batching\n * @extends RequestInit\n * @see {@link https://github.com/Microsoft/TypeScript/blob/master/lib/lib.dom.d.ts#L1337} and {@link https://fetch.spec.whatwg.org/#requestinit}\n *\n * @property {string} url - The url value of the request\n */\n\nexport interface RequestData extends RequestInit {\n\turl: string;\n}\n\n/**\n * @interface\n * Signature representing batch request data\n * @property {string} id - Unique identity for the request, Should not be an empty string\n * @property {string[]} [dependsOn] - Array of dependencies\n */\nexport interface BatchRequestData extends RequestData {\n\tid: string;\n\tdependsOn?: string[];\n}\n\n/**\n * @interface\n * Signature representing batch request body\n * @property {BatchRequestData[]} requests - Array of request data, a json representation of requests for batch\n */\n\nexport interface BatchRequestBody {\n\trequests: BatchRequestData[];\n}\n\n/**\n * @class\n * Class for handling BatchRequestContent\n */\nexport class BatchRequestContent {\n\t/**\n\t * @private\n\t * @static\n\t * Limit for number of requests {@link - https://developer.microsoft.com/en-us/graph/docs/concepts/known_issues#json-batching}\n\t */\n\tprivate static requestLimit = 20;\n\n\t/**\n\t * @public\n\t * To keep track of requests, key will be id of the request and value will be the request json\n\t */\n\tpublic requests: Map<string, BatchRequestStep>;\n\n\t/**\n\t * @private\n\t * @static\n\t * Validates the dependency chain of the requests\n\t *\n\t * Note:\n\t * Individual requests can depend on other individual requests. Currently, requests can only depend on a single other request, and must follow one of these three patterns:\n\t * 1. Parallel - no individual request states a dependency in the dependsOn property.\n\t * 2. Serial - all individual requests depend on the previous individual request.\n\t * 3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.\n\t * As JSON batching matures, these limitations will be removed.\n\t * @see {@link https://developer.microsoft.com/en-us/graph/docs/concepts/known_issues#json-batching}\n\t *\n\t * @param {Map<string, BatchRequestStep>} requests - The map of requests.\n\t * @returns The boolean indicating the validation status\n\t */\n\n\tprivate static validateDependencies(requests: Map<string, BatchRequestStep>): boolean {\n\t\tconst isParallel = (reqs: Map<string, BatchRequestStep>): boolean => {\n\t\t\tconst iterator = reqs.entries();\n\t\t\tlet cur = iterator.next();\n\t\t\twhile (!cur.done) {\n\t\t\t\tconst curReq = cur.value[1];\n\t\t\t\tif (curReq.dependsOn !== undefined && curReq.dependsOn.length > 0) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tcur = iterator.next();\n\t\t\t}\n\t\t\treturn true;\n\t\t};\n\t\tconst isSerial = (reqs: Map<string, BatchRequestStep>): boolean => {\n\t\t\tconst iterator = reqs.entries();\n\t\t\tlet cur = iterator.next();\n\t\t\tconst firstRequest: BatchRequestStep = cur.value[1];\n\t\t\tif (firstRequest.dependsOn !== undefined && firstRequest.dependsOn.length > 0) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tlet prev = cur;\n\t\t\tcur = iterator.next();\n\t\t\twhile (!cur.done) {\n\t\t\t\tconst curReq: BatchRequestStep = cur.value[1];\n\t\t\t\tif (curReq.dependsOn === undefined || curReq.dependsOn.length !== 1 || curReq.dependsOn[0] !== prev.value[1].id) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tprev = cur;\n\t\t\t\tcur = iterator.next();\n\t\t\t}\n\t\t\treturn true;\n\t\t};\n\t\tconst isSame = (reqs: Map<string, BatchRequestStep>): boolean => {\n\t\t\tconst iterator = reqs.entries();\n\t\t\tlet cur = iterator.next();\n\t\t\tconst firstRequest: BatchRequestStep = cur.value[1];\n\t\t\tlet dependencyId: string;\n\t\t\tif (firstRequest.dependsOn === undefined || firstRequest.dependsOn.length === 0) {\n\t\t\t\tdependencyId = firstRequest.id;\n\t\t\t} else {\n\t\t\t\tif (firstRequest.dependsOn.length === 1) {\n\t\t\t\t\tconst fDependencyId = firstRequest.dependsOn[0];\n\t\t\t\t\tif (fDependencyId !== firstRequest.id && reqs.has(fDependencyId)) {\n\t\t\t\t\t\tdependencyId = fDependencyId;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tcur = iterator.next();\n\t\t\twhile (!cur.done) {\n\t\t\t\tconst curReq = cur.value[1];\n\t\t\t\tif ((curReq.dependsOn === undefined || curReq.dependsOn.length === 0) && dependencyId !== curReq.id) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (curReq.dependsOn !== undefined && curReq.dependsOn.length !== 0) {\n\t\t\t\t\tif (curReq.dependsOn.length === 1 && (curReq.id === dependencyId || curReq.dependsOn[0] !== dependencyId)) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tif (curReq.dependsOn.length > 1) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcur = iterator.next();\n\t\t\t}\n\t\t\treturn true;\n\t\t};\n\t\tif (requests.size === 0) {\n\t\t\tconst error = new Error(\"Empty requests map, Please provide at least one request.\");\n\t\t\terror.name = \"Empty Requests Error\";\n\t\t\tthrow error;\n\t\t}\n\t\treturn isParallel(requests) || isSerial(requests) || isSame(requests);\n\t}\n\n\t/**\n\t * @private\n\t * @static\n\t * @async\n\t * Converts Request Object instance to a JSON\n\t * @param {IsomorphicRequest} request - The IsomorphicRequest Object instance\n\t * @returns A promise that resolves to JSON representation of a request\n\t */\n\tprivate static async getRequestData(request: IsomorphicRequest): Promise<RequestData> {\n\t\tconst requestData: RequestData = {\n\t\t\turl: \"\",\n\t\t};\n\t\tconst hasHttpRegex = new RegExp(\"^https?://\");\n\t\t// Stripping off hostname, port and url scheme\n\t\trequestData.url = hasHttpRegex.test(request.url) ? \"/\" + request.url.split(/.*?\\/\\/.*?\\//)[1] : request.url;\n\t\trequestData.method = request.method;\n\t\tconst headers = {};\n\t\trequest.headers.forEach((value, key) => {\n\t\t\theaders[key] = value;\n\t\t});\n\t\tif (Object.keys(headers).length) {\n\t\t\trequestData.headers = headers;\n\t\t}\n\t\tif (request.method === RequestMethod.PATCH || request.method === RequestMethod.POST || request.method === RequestMethod.PUT) {\n\t\t\trequestData.body = await BatchRequestContent.getRequestBody(request);\n\t\t}\n\t\t/**\n\t\t * TODO: Check any other property needs to be used from the Request object and add them\n\t\t */\n\t\treturn requestData;\n\t}\n\n\t/**\n\t * @private\n\t * @static\n\t * @async\n\t * Gets the body of a Request object instance\n\t * @param {IsomorphicRequest} request - The IsomorphicRequest object instance\n\t * @returns The Promise that resolves to a body value of a Request\n\t */\n\tprivate static async getRequestBody(request: IsomorphicRequest): Promise<any> {\n\t\tlet bodyParsed = false;\n\t\tlet body;\n\t\ttry {\n\t\t\tconst cloneReq = request.clone();\n\t\t\tbody = await cloneReq.json();\n\t\t\tbodyParsed = true;\n\t\t} catch (e) {\n\t\t\t//TODO- Handle empty catches\n\t\t}\n\t\tif (!bodyParsed) {\n\t\t\ttry {\n\t\t\t\tif (typeof Blob !== \"undefined\") {\n\t\t\t\t\tconst blob = await request.blob();\n\t\t\t\t\tconst reader = new FileReader();\n\t\t\t\t\tbody = await new Promise((resolve) => {\n\t\t\t\t\t\treader.addEventListener(\n\t\t\t\t\t\t\t\"load\",\n\t\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\t\tconst dataURL = reader.result as string;\n\t\t\t\t\t\t\t\t/**\n\t\t\t\t\t\t\t\t * Some valid dataURL schemes:\n\t\t\t\t\t\t\t\t *  1. data:text/vnd-example+xyz;foo=bar;base64,R0lGODdh\n\t\t\t\t\t\t\t\t *  2. data:text/plain;charset=UTF-8;page=21,the%20data:1234,5678\n\t\t\t\t\t\t\t\t *  3. data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==\n\t\t\t\t\t\t\t\t *  4. data:image/png,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==\n\t\t\t\t\t\t\t\t *  5. data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==\n\t\t\t\t\t\t\t\t * @see Syntax {@link https://en.wikipedia.org/wiki/Data_URI_scheme} for more\n\t\t\t\t\t\t\t\t */\n\t\t\t\t\t\t\t\tconst regex = new RegExp(\"^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$\");\n\t\t\t\t\t\t\t\tconst segments = regex.exec(dataURL);\n\t\t\t\t\t\t\t\tresolve(segments[4]);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tfalse,\n\t\t\t\t\t\t);\n\t\t\t\t\t\treader.readAsDataURL(blob);\n\t\t\t\t\t});\n\t\t\t\t} else if (typeof Buffer !== \"undefined\") {\n\t\t\t\t\tconst buffer = await request.buffer();\n\t\t\t\t\tbody = buffer.toString(\"base64\");\n\t\t\t\t}\n\t\t\t\tbodyParsed = true;\n\t\t\t} catch (e) {\n\t\t\t\t// TODO-Handle empty catches\n\t\t\t}\n\t\t}\n\t\treturn body;\n\t}\n\n\t/**\n\t * @public\n\t * @constructor\n\t * Constructs a BatchRequestContent instance\n\t * @param {BatchRequestStep[]} [requests] - Array of requests value\n\t * @returns An instance of a BatchRequestContent\n\t */\n\tpublic constructor(requests?: BatchRequestStep[]) {\n\t\tthis.requests = new Map();\n\t\tif (typeof requests !== \"undefined\") {\n\t\t\tconst limit = BatchRequestContent.requestLimit;\n\t\t\tif (requests.length > limit) {\n\t\t\t\tconst error = new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${limit}`);\n\t\t\t\terror.name = \"Limit Exceeded Error\";\n\t\t\t\tthrow error;\n\t\t\t}\n\t\t\tfor (const req of requests) {\n\t\t\t\tthis.addRequest(req);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @public\n\t * Adds a request to the batch request content\n\t * @param {BatchRequestStep} request - The request value\n\t * @returns The id of the added request\n\t */\n\tpublic addRequest(request: BatchRequestStep): string {\n\t\tconst limit = BatchRequestContent.requestLimit;\n\t\tif (request.id === \"\") {\n\t\t\tconst error = new Error(`Id for a request is empty, Please provide an unique id`);\n\t\t\terror.name = \"Empty Id For Request\";\n\t\t\tthrow error;\n\t\t}\n\t\tif (this.requests.size === limit) {\n\t\t\tconst error = new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${limit}`);\n\t\t\terror.name = \"Limit Exceeded Error\";\n\t\t\tthrow error;\n\t\t}\n\t\tif (this.requests.has(request.id)) {\n\t\t\tconst error = new Error(`Adding request with duplicate id ${request.id}, Make the id of the requests unique`);\n\t\t\terror.name = \"Duplicate RequestId Error\";\n\t\t\tthrow error;\n\t\t}\n\t\tthis.requests.set(request.id, request);\n\t\treturn request.id;\n\t}\n\n\t/**\n\t * @public\n\t * Removes request from the batch payload and its dependencies from all dependents\n\t * @param {string} requestId - The id of a request that needs to be removed\n\t * @returns The boolean indicating removed status\n\t */\n\tpublic removeRequest(requestId: string): boolean {\n\t\tconst deleteStatus = this.requests.delete(requestId);\n\t\tconst iterator = this.requests.entries();\n\t\tlet cur = iterator.next();\n\t\t/**\n\t\t * Removing dependencies where this request is present as a dependency\n\t\t */\n\t\twhile (!cur.done) {\n\t\t\tconst dependencies = cur.value[1].dependsOn;\n\t\t\tif (typeof dependencies !== \"undefined\") {\n\t\t\t\tconst index = dependencies.indexOf(requestId);\n\t\t\t\tif (index !== -1) {\n\t\t\t\t\tdependencies.splice(index, 1);\n\t\t\t\t}\n\t\t\t\tif (dependencies.length === 0) {\n\t\t\t\t\tdelete cur.value[1].dependsOn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tcur = iterator.next();\n\t\t}\n\t\treturn deleteStatus;\n\t}\n\n\t/**\n\t * @public\n\t * @async\n\t * Serialize content from BatchRequestContent instance\n\t * @returns The body content to make batch request\n\t */\n\tpublic async getContent(): Promise<BatchRequestBody> {\n\t\tconst requests: BatchRequestData[] = [];\n\t\tconst requestBody: BatchRequestBody = {\n\t\t\trequests,\n\t\t};\n\t\tconst iterator = this.requests.entries();\n\t\tlet cur = iterator.next();\n\t\tif (cur.done) {\n\t\t\tconst error = new Error(\"No requests added yet, Please add at least one request.\");\n\t\t\terror.name = \"Empty Payload\";\n\t\t\tthrow error;\n\t\t}\n\t\tif (!BatchRequestContent.validateDependencies(this.requests)) {\n\t\t\tconst error = new Error(`Invalid dependency found, Dependency should be:\n1. Parallel - no individual request states a dependency in the dependsOn property.\n2. Serial - all individual requests depend on the previous individual request.\n3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.`);\n\t\t\terror.name = \"Invalid Dependency\";\n\t\t\tthrow error;\n\t\t}\n\t\twhile (!cur.done) {\n\t\t\tconst requestStep: BatchRequestStep = cur.value[1];\n\t\t\tconst batchRequestData: BatchRequestData = (await BatchRequestContent.getRequestData(requestStep.request as IsomorphicRequest)) as BatchRequestData;\n\t\t\t/**\n\t\t\t * @see{@https://tools.ietf.org/html/rfc7578#section-4.4}\n\t\t\t * TODO- Setting/Defaulting of content-type header to the correct value\n\t\t\t * @see {@link https://developer.microsoft.com/en-us/graph/docs/concepts/json_batching#request-format}\n\t\t\t */\n\t\t\tif (batchRequestData.body !== undefined && (batchRequestData.headers === undefined || batchRequestData.headers[\"content-type\"] === undefined)) {\n\t\t\t\tconst error = new Error(`Content-type header is not mentioned for request #${requestStep.id}, For request having body, Content-type header should be mentioned`);\n\t\t\t\terror.name = \"Invalid Content-type header\";\n\t\t\t\tthrow error;\n\t\t\t}\n\t\t\tbatchRequestData.id = requestStep.id;\n\t\t\tif (requestStep.dependsOn !== undefined && requestStep.dependsOn.length > 0) {\n\t\t\t\tbatchRequestData.dependsOn = requestStep.dependsOn;\n\t\t\t}\n\t\t\trequests.push(batchRequestData);\n\t\t\tcur = iterator.next();\n\t\t}\n\t\trequestBody.requests = requests;\n\t\treturn requestBody;\n\t}\n\n\t/**\n\t * @public\n\t * Adds a dependency for a given dependent request\n\t * @param {string} dependentId - The id of the dependent request\n\t * @param {string} [dependencyId] - The id of the dependency request, if not specified the preceding request will be considered as a dependency\n\t * @returns Nothing\n\t */\n\tpublic addDependency(dependentId: string, dependencyId?: string): void {\n\t\tif (!this.requests.has(dependentId)) {\n\t\t\tconst error = new Error(`Dependent ${dependentId} does not exists, Please check the id`);\n\t\t\terror.name = \"Invalid Dependent\";\n\t\t\tthrow error;\n\t\t}\n\t\tif (typeof dependencyId !== \"undefined\" && !this.requests.has(dependencyId)) {\n\t\t\tconst error = new Error(`Dependency ${dependencyId} does not exists, Please check the id`);\n\t\t\terror.name = \"Invalid Dependency\";\n\t\t\tthrow error;\n\t\t}\n\t\tif (typeof dependencyId !== \"undefined\") {\n\t\t\tconst dependent = this.requests.get(dependentId);\n\t\t\tif (dependent.dependsOn === undefined) {\n\t\t\t\tdependent.dependsOn = [];\n\t\t\t}\n\t\t\tif (dependent.dependsOn.indexOf(dependencyId) !== -1) {\n\t\t\t\tconst error = new Error(`Dependency ${dependencyId} is already added for the request ${dependentId}`);\n\t\t\t\terror.name = \"Duplicate Dependency\";\n\t\t\t\tthrow error;\n\t\t\t}\n\t\t\tdependent.dependsOn.push(dependencyId);\n\t\t} else {\n\t\t\tconst iterator = this.requests.entries();\n\t\t\tlet prev;\n\t\t\tlet cur = iterator.next();\n\t\t\twhile (!cur.done && cur.value[1].id !== dependentId) {\n\t\t\t\tprev = cur;\n\t\t\t\tcur = iterator.next();\n\t\t\t}\n\t\t\tif (typeof prev !== \"undefined\") {\n\t\t\t\tconst dId = prev.value[0];\n\t\t\t\tif (cur.value[1].dependsOn === undefined) {\n\t\t\t\t\tcur.value[1].dependsOn = [];\n\t\t\t\t}\n\t\t\t\tif (cur.value[1].dependsOn.indexOf(dId) !== -1) {\n\t\t\t\t\tconst error = new Error(`Dependency ${dId} is already added for the request ${dependentId}`);\n\t\t\t\t\terror.name = \"Duplicate Dependency\";\n\t\t\t\t\tthrow error;\n\t\t\t\t}\n\t\t\t\tcur.value[1].dependsOn.push(dId);\n\t\t\t} else {\n\t\t\t\tconst error = new Error(`Can't add dependency ${dependencyId}, There is only a dependent request in the batch`);\n\t\t\t\terror.name = \"Invalid Dependency Addition\";\n\t\t\t\tthrow error;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @public\n\t * Removes a dependency for a given dependent request id\n\t * @param {string} dependentId - The id of the dependent request\n\t * @param {string} [dependencyId] - The id of the dependency request, if not specified will remove all the dependencies of that request\n\t * @returns The boolean indicating removed status\n\t */\n\tpublic removeDependency(dependentId: string, dependencyId?: string): boolean {\n\t\tconst request = this.requests.get(dependentId);\n\t\tif (typeof request === \"undefined\" || request.dependsOn === undefined || request.dependsOn.length === 0) {\n\t\t\treturn false;\n\t\t}\n\t\tif (typeof dependencyId !== \"undefined\") {\n\t\t\tconst index = request.dependsOn.indexOf(dependencyId);\n\t\t\tif (index === -1) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\trequest.dependsOn.splice(index, 1);\n\t\t\treturn true;\n\t\t} else {\n\t\t\tdelete request.dependsOn;\n\t\t\treturn true;\n\t\t}\n\t}\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module BatchResponseContent\n */\n\n/**\n * @interface\n * Signature represents key value pair object\n */\ninterface KeyValuePairObject {\n\t[key: string]: any;\n}\n\n/**\n * @interface\n * Signature representing Batch response body\n * @property {KeyValuePairObject[]} responses - An array of key value pair representing response object for every request\n * @property {string} [@odata.nextLink] - The nextLink value to get next set of responses in case of asynchronous batch requests\n */\nexport interface BatchResponseBody {\n\tresponses: KeyValuePairObject[];\n\t\"@odata.nextLink\"?: string;\n}\n\n/**\n * @class\n * Class that handles BatchResponseContent\n */\nexport class BatchResponseContent {\n\t/**\n\t * To hold the responses\n\t */\n\tprivate responses: Map<string, Response>;\n\n\t/**\n\t * Holds the next link url\n\t */\n\tprivate nextLink: string;\n\n\t/**\n\t * @public\n\t * @constructor\n\t * Creates the BatchResponseContent instance\n\t * @param {BatchResponseBody} response - The response body returned for batch request from server\n\t * @returns An instance of a BatchResponseContent\n\t */\n\tpublic constructor(response: BatchResponseBody) {\n\t\tthis.responses = new Map();\n\t\tthis.update(response);\n\t}\n\n\t/**\n\t * @private\n\t * Creates native Response object from the json representation of it.\n\t * @param {KeyValuePairObject} responseJSON - The response json value\n\t * @returns The Response Object instance\n\t */\n\tprivate createResponseObject(responseJSON: KeyValuePairObject): Response {\n\t\tconst body = responseJSON.body;\n\t\tconst options: KeyValuePairObject = {};\n\t\toptions.status = responseJSON.status;\n\t\tif (responseJSON.statusText !== undefined) {\n\t\t\toptions.statusText = responseJSON.statusText;\n\t\t}\n\t\toptions.headers = responseJSON.headers;\n\t\tif (options.headers !== undefined && options.headers[\"Content-Type\"] !== undefined) {\n\t\t\tif (options.headers[\"Content-Type\"].split(\";\")[0] === \"application/json\") {\n\t\t\t\tconst bodyString = JSON.stringify(body);\n\t\t\t\treturn new Response(bodyString, options);\n\t\t\t}\n\t\t}\n\t\treturn new Response(body, options);\n\t}\n\n\t/**\n\t * @public\n\t * Updates the Batch response content instance with given responses.\n\t * @param {BatchResponseBody} response - The response json representing batch response message\n\t * @returns Nothing\n\t */\n\tpublic update(response: BatchResponseBody): void {\n\t\tthis.nextLink = response[\"@odata.nextLink\"];\n\t\tconst responses = response.responses;\n\t\tfor (let i = 0, l = responses.length; i < l; i++) {\n\t\t\tthis.responses.set(responses[i].id, this.createResponseObject(responses[i]));\n\t\t}\n\t}\n\n\t/**\n\t * @public\n\t * To get the response of a request for a given request id\n\t * @param {string} requestId - The request id value\n\t * @returns The Response object instance for the particular request\n\t */\n\tpublic getResponseById(requestId: string): Response {\n\t\treturn this.responses.get(requestId);\n\t}\n\n\t/**\n\t * @public\n\t * To get all the responses of the batch request\n\t * @returns The Map of id and Response objects\n\t */\n\tpublic getResponses(): Map<string, Response> {\n\t\treturn this.responses;\n\t}\n\n\t/**\n\t * @public\n\t * To get the iterator for the responses\n\t * @returns The Iterable generator for the response objects\n\t */\n\tpublic *getResponsesIterator(): IterableIterator<[string, Response]> {\n\t\tconst iterator = this.responses.entries();\n\t\tlet cur = iterator.next();\n\t\twhile (!cur.done) {\n\t\t\tyield cur.value;\n\t\t\tcur = iterator.next();\n\t\t}\n\t}\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module Constants\n */\n\n/**\n * @constant\n * A Default API endpoint version for a request\n */\nexport const GRAPH_API_VERSION = \"v1.0\";\n\n/**\n * @constant\n * A Default base url for a request\n */\nexport const GRAPH_BASE_URL = \"https://graph.microsoft.com/\";\n\n/**\n * To hold list of the service root endpoints for Microsoft Graph and Graph Explorer for each national cloud.\n * Set(iterable:Object) is not supported in Internet Explorer. The consumer is recommended to use a suitable polyfill.\n */\nexport const GRAPH_URLS = new Set<string>([\"graph.microsoft.com\", \"graph.microsoft.us\", \"dod-graph.microsoft.us\", \"graph.microsoft.de\", \"microsoftgraph.chinacloudapi.cn\", \"canary.graph.microsoft.com\"]);\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module GraphClientError\n */\n\n/**\n * @class\n * Create GraphClientError object to handle client-side errors\n * encountered within the JavaScript Client SDK.\n * Whereas GraphError Class should be used to handle errors in the response from the Graph API.\n */\n\nexport class GraphClientError extends Error {\n\t/**\n\t * @public\n\t * A custom error. This property should set be when the error is not of instanceOf Error/GraphClientError.\n\t * Example =\n\t * const client = MicrosoftGraph.Client.init({\n\t * \t\tdefaultVersion: \"v1.0\",\n\t *  \tauthProvider: (done) => { done({TokenError:\"AccessToken cannot be null\"}, \"<ACCESS_TOKEN>\");\n\t * });\n\t */\n\tpublic customError?: any;\n\n\t/**\n\t * @public\n\t * @static\n\t * @async\n\t * To set the GraphClientError object\n\t * @param {any} error - The error returned encountered by the Graph JavaScript Client SDK while processing request\n\t * @returns GraphClientError object set to the error passed\n\t */\n\tpublic static setGraphClientError(error: any): GraphClientError {\n\t\tlet graphClientError: GraphClientError;\n\t\tif (error instanceof Error) {\n\t\t\tgraphClientError = error;\n\t\t} else {\n\t\t\tgraphClientError = new GraphClientError();\n\t\t\tgraphClientError.customError = error;\n\t\t}\n\t\treturn graphClientError;\n\t}\n\n\t/**\n\t * @public\n\t * @constructor\n\t * Creates an instance of GraphClientError\n\t * @param {string} message? - Error message\n\t * @returns An instance of GraphClientError\n\t */\n\tpublic constructor(message?: string) {\n\t\tsuper(message);\n\t\tObject.setPrototypeOf(this, GraphClientError.prototype);\n\t}\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module GraphRequestUtil\n */\nimport { GRAPH_URLS } from \"./Constants\";\nimport { GraphClientError } from \"./GraphClientError\";\n/**\n * To hold list of OData query params\n */\nexport const oDataQueryNames = [\"$select\", \"$expand\", \"$orderby\", \"$filter\", \"$top\", \"$skip\", \"$skipToken\", \"$count\"];\n\n/**\n * To construct the URL by appending the segments with \"/\"\n * @param {string[]} urlSegments - The array of strings\n * @returns The constructed URL string\n */\nexport const urlJoin = (urlSegments: string[]): string => {\n\tconst removePostSlash = (s) => s.replace(/\\/+$/, \"\");\n\tconst removePreSlash = (s) => s.replace(/^\\/+/, \"\");\n\tconst joiner = (pre, cur) => [removePostSlash(pre), removePreSlash(cur)].join(\"/\");\n\tconst parts = Array.prototype.slice.call(urlSegments);\n\treturn parts.reduce(joiner);\n};\n\n/**\n * Serializes the content\n * @param {any} content - The content value that needs to be serialized\n * @returns The serialized content\n *\n * Note:\n * This conversion is required due to the following reasons:\n * Body parameter of Request method of isomorphic-fetch only accepts Blob, ArrayBuffer, FormData, TypedArrays string.\n * Node.js platform does not support Blob, FormData. Javascript File object inherits from Blob so it is also not supported in node. Therefore content of type Blob, File, FormData will only come from browsers.\n * Parallel to ArrayBuffer in javascript, node provides Buffer interface. Node's Buffer is able to send the arbitrary binary data to the server successfully for both Browser and Node platform. Whereas sending binary data via ArrayBuffer or TypedArrays was only possible using Browser. To support both Node and Browser, `serializeContent` converts TypedArrays or ArrayBuffer to `Node Buffer`.\n * If the data received is in JSON format, `serializeContent` converts the JSON to string.\n */\n\nexport const serializeContent = (content: any): any => {\n\tconst className: string = content && content.constructor && content.constructor.name;\n\tif (className === \"Buffer\" || className === \"Blob\" || className === \"File\" || className === \"FormData\" || typeof content === \"string\") {\n\t\treturn content;\n\t}\n\tif (className === \"ArrayBuffer\") {\n\t\tcontent = Buffer.from(content);\n\t} else if (className === \"Int8Array\" || className === \"Int16Array\" || className === \"Int32Array\" || className === \"Uint8Array\" || className === \"Uint16Array\" || className === \"Uint32Array\" || className === \"Uint8ClampedArray\" || className === \"Float32Array\" || className === \"Float64Array\" || className === \"DataView\") {\n\t\tcontent = Buffer.from(content.buffer);\n\t} else {\n\t\ttry {\n\t\t\tcontent = JSON.stringify(content);\n\t\t} catch (error) {\n\t\t\tthrow new Error(\"Unable to stringify the content\");\n\t\t}\n\t}\n\treturn content;\n};\n\n/**\n * Checks if the url is one of the service root endpoints for Microsoft Graph and Graph Explorer.\n * @param {string} url - The url to be verified\n * @returns {boolean} - Returns true if the url is a Graph URL\n */\nexport const isGraphURL = (url: string): boolean => {\n\treturn isValidEndpoint(url);\n};\n\n/**\n * Checks if the url is for one of the custom hosts provided during client initialization\n * @param {string} url - The url to be verified\n * @param {Set} customHosts - The url to be verified\n * @returns {boolean} - Returns true if the url is a for a custom host\n */\nexport const isCustomHost = (url: string, customHosts: Set<string>): boolean => {\n\tcustomHosts.forEach((host) => isCustomHostValid(host));\n\treturn isValidEndpoint(url, customHosts);\n};\n\n/**\n * Checks if the url is for one of the provided hosts.\n * @param {string} url - The url to be verified\n * @param {Set<string>} allowedHosts - A set of hosts.\n * @returns {boolean} - Returns true is for one of the provided endpoints.\n */\nconst isValidEndpoint = (url: string, allowedHosts: Set<string> = GRAPH_URLS): boolean => {\n\t// Valid Graph URL pattern - https://graph.microsoft.com/{version}/{resource}?{query-parameters}\n\t// Valid Graph URL example - https://graph.microsoft.com/v1.0/\n\turl = url.toLowerCase();\n\n\tif (url.indexOf(\"https://\") !== -1) {\n\t\turl = url.replace(\"https://\", \"\");\n\n\t\t// Find where the host ends\n\t\tconst startofPortNoPos = url.indexOf(\":\");\n\t\tconst endOfHostStrPos = url.indexOf(\"/\");\n\t\tlet hostName = \"\";\n\t\tif (endOfHostStrPos !== -1) {\n\t\t\tif (startofPortNoPos !== -1 && startofPortNoPos < endOfHostStrPos) {\n\t\t\t\thostName = url.substring(0, startofPortNoPos);\n\t\t\t\treturn allowedHosts.has(hostName);\n\t\t\t}\n\t\t\t// Parse out the host\n\t\t\thostName = url.substring(0, endOfHostStrPos);\n\t\t\treturn allowedHosts.has(hostName);\n\t\t}\n\t}\n\n\treturn false;\n};\n\n/**\n * Throws error if the string is not a valid host/hostname and contains other url parts.\n * @param {string} host - The host to be verified\n */\nconst isCustomHostValid = (host: string) => {\n\tif (host.indexOf(\"/\") !== -1) {\n\t\tthrow new GraphClientError(\"Please add only hosts or hostnames to the CustomHosts config. If the url is `http://example.com:3000/`, host is `example:3000`\");\n\t}\n};\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module MiddlewareControl\n */\n\nimport { MiddlewareOptions } from \"./options/IMiddlewareOptions\";\n\n/**\n * @class\n * Class representing MiddlewareControl\n */\nexport class MiddlewareControl {\n\t/**\n\t * @private\n\t * A member holding map of MiddlewareOptions\n\t */\n\tprivate middlewareOptions: Map<Function, MiddlewareOptions>;\n\n\t/**\n\t * @public\n\t * @constructor\n\t * Creates an instance of MiddlewareControl\n\t * @param {MiddlewareOptions[]} [middlewareOptions = []] - The array of middlewareOptions\n\t * @returns The instance of MiddlewareControl\n\t */\n\tpublic constructor(middlewareOptions: MiddlewareOptions[] = []) {\n\t\tthis.middlewareOptions = new Map<Function, MiddlewareOptions>();\n\t\tfor (const option of middlewareOptions) {\n\t\t\tconst fn = option.constructor;\n\t\t\tthis.middlewareOptions.set(fn, option);\n\t\t}\n\t}\n\n\t/**\n\t * @public\n\t * To get the middleware option using the class of the option\n\t * @param {Function} fn - The class of the strongly typed option class\n\t * @returns The middleware option\n\t * @example\n\t * // if you wanted to return the middleware option associated with this class (MiddlewareControl)\n\t * // call this function like this:\n\t * getMiddlewareOptions(MiddlewareControl)\n\t */\n\tpublic getMiddlewareOptions(fn: Function): MiddlewareOptions {\n\t\treturn this.middlewareOptions.get(fn);\n\t}\n\n\t/**\n\t * @public\n\t * To set the middleware options using the class of the option\n\t * @param {Function} fn - The class of the strongly typed option class\n\t * @param {MiddlewareOptions} option - The strongly typed middleware option\n\t * @returns nothing\n\t */\n\tpublic setMiddlewareOptions(fn: Function, option: MiddlewareOptions): void {\n\t\tthis.middlewareOptions.set(fn, option);\n\t}\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module MiddlewareUtil\n */\n\nimport { FetchOptions } from \"../IFetchOptions\";\n\n/**\n * @constant\n * To generate the UUID\n * @returns The UUID string\n */\nexport const generateUUID = (): string => {\n\tlet uuid = \"\";\n\tfor (let j = 0; j < 32; j++) {\n\t\tif (j === 8 || j === 12 || j === 16 || j === 20) {\n\t\t\tuuid += \"-\";\n\t\t}\n\t\tuuid += Math.floor(Math.random() * 16).toString(16);\n\t}\n\treturn uuid;\n};\n\n/**\n * @constant\n * To get the request header from the request\n * @param {RequestInfo} request - The request object or the url string\n * @param {FetchOptions|undefined} options - The request options object\n * @param {string} key - The header key string\n * @returns A header value for the given key from the request\n */\nexport const getRequestHeader = (request: RequestInfo, options: FetchOptions | undefined, key: string): string | null => {\n\tlet value: string = null;\n\tif (typeof Request !== \"undefined\" && request instanceof Request) {\n\t\tvalue = (request as Request).headers.get(key);\n\t} else if (typeof options !== \"undefined\" && options.headers !== undefined) {\n\t\tif (typeof Headers !== \"undefined\" && options.headers instanceof Headers) {\n\t\t\tvalue = (options.headers as Headers).get(key);\n\t\t} else if (options.headers instanceof Array) {\n\t\t\tconst headers = options.headers as string[][];\n\t\t\tfor (let i = 0, l = headers.length; i < l; i++) {\n\t\t\t\tif (headers[i][0] === key) {\n\t\t\t\t\tvalue = headers[i][1];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (options.headers[key] !== undefined) {\n\t\t\tvalue = options.headers[key];\n\t\t}\n\t}\n\treturn value;\n};\n\n/**\n * @constant\n * To set the header value to the given request\n * @param {RequestInfo} request - The request object or the url string\n * @param {FetchOptions|undefined} options - The request options object\n * @param {string} key - The header key string\n * @param {string } value - The header value string\n * @returns Nothing\n */\nexport const setRequestHeader = (request: RequestInfo, options: FetchOptions | undefined, key: string, value: string): void => {\n\tif (typeof Request !== \"undefined\" && request instanceof Request) {\n\t\t(request as Request).headers.set(key, value);\n\t} else if (typeof options !== \"undefined\") {\n\t\tif (options.headers === undefined) {\n\t\t\toptions.headers = new Headers({\n\t\t\t\t[key]: value,\n\t\t\t});\n\t\t} else {\n\t\t\tif (typeof Headers !== \"undefined\" && options.headers instanceof Headers) {\n\t\t\t\t(options.headers as Headers).set(key, value);\n\t\t\t} else if (options.headers instanceof Array) {\n\t\t\t\tlet i = 0;\n\t\t\t\tconst l = options.headers.length;\n\t\t\t\tfor (; i < l; i++) {\n\t\t\t\t\tconst header = options.headers[i];\n\t\t\t\t\tif (header[0] === key) {\n\t\t\t\t\t\theader[1] = value;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (i === l) {\n\t\t\t\t\t(options.headers as string[][]).push([key, value]);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tObject.assign(options.headers, { [key]: value });\n\t\t\t}\n\t\t}\n\t}\n};\n\n/**\n * @constant\n * To append the header value to the given request\n * @param {RequestInfo} request - The request object or the url string\n * @param {FetchOptions|undefined} options - The request options object\n * @param {string} key - The header key string\n * @param {string } value - The header value string\n * @returns Nothing\n */\nexport const appendRequestHeader = (request: RequestInfo, options: FetchOptions | undefined, key: string, value: string): void => {\n\tif (typeof Request !== \"undefined\" && request instanceof Request) {\n\t\t(request as Request).headers.append(key, value);\n\t} else if (typeof options !== \"undefined\") {\n\t\tif (options.headers === undefined) {\n\t\t\toptions.headers = new Headers({\n\t\t\t\t[key]: value,\n\t\t\t});\n\t\t} else {\n\t\t\tif (typeof Headers !== \"undefined\" && options.headers instanceof Headers) {\n\t\t\t\t(options.headers as Headers).append(key, value);\n\t\t\t} else if (options.headers instanceof Array) {\n\t\t\t\t(options.headers as string[][]).push([key, value]);\n\t\t\t} else if (options.headers === undefined) {\n\t\t\t\toptions.headers = { [key]: value };\n\t\t\t} else if (options.headers[key] === undefined) {\n\t\t\t\toptions.headers[key] = value;\n\t\t\t} else {\n\t\t\t\toptions.headers[key] += `, ${value}`;\n\t\t\t}\n\t\t}\n\t}\n};\n\n/**\n * @constant\n * To clone the request with the new url\n * @param {string} url - The new url string\n * @param {Request} request - The request object\n * @returns A promise that resolves to request object\n */\nexport const cloneRequestWithNewUrl = async (newUrl: string, request: Request): Promise<Request> => {\n\tconst body = request.headers.get(\"Content-Type\") ? await request.blob() : await Promise.resolve(undefined);\n\tconst { method, headers, referrer, referrerPolicy, mode, credentials, cache, redirect, integrity, keepalive, signal } = request;\n\treturn new Request(newUrl, { method, headers, body, referrer, referrerPolicy, mode, credentials, cache, redirect, integrity, keepalive, signal });\n};\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module AuthenticationHandlerOptions\n */\n\nimport { AuthenticationProvider } from \"../../IAuthenticationProvider\";\nimport { AuthenticationProviderOptions } from \"../../IAuthenticationProviderOptions\";\nimport { MiddlewareOptions } from \"./IMiddlewareOptions\";\n\n/**\n * @class\n * @implements MiddlewareOptions\n * Class representing AuthenticationHandlerOptions\n */\nexport class AuthenticationHandlerOptions implements MiddlewareOptions {\n\t/**\n\t * @public\n\t * A member holding an instance of an authentication provider\n\t */\n\tpublic authenticationProvider: AuthenticationProvider;\n\n\t/**\n\t * @public\n\t * A member holding an instance of authentication provider options\n\t */\n\tpublic authenticationProviderOptions: AuthenticationProviderOptions;\n\n\t/**\n\t * @public\n\t * @constructor\n\t * To create an instance of AuthenticationHandlerOptions\n\t * @param {AuthenticationProvider} [authenticationProvider] - The authentication provider instance\n\t * @param {AuthenticationProviderOptions} [authenticationProviderOptions] - The authentication provider options instance\n\t * @returns An instance of AuthenticationHandlerOptions\n\t */\n\tpublic constructor(authenticationProvider?: AuthenticationProvider, authenticationProviderOptions?: AuthenticationProviderOptions) {\n\t\tthis.authenticationProvider = authenticationProvider;\n\t\tthis.authenticationProviderOptions = authenticationProviderOptions;\n\t}\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module TelemetryHandlerOptions\n */\n\nimport { Context } from \"../../IContext\";\nimport { MiddlewareControl } from \"../MiddlewareControl\";\nimport { MiddlewareOptions } from \"./IMiddlewareOptions\";\n\n/**\n * @enum\n * @property {number} NONE - The hexadecimal flag value for nothing enabled\n * @property {number} REDIRECT_HANDLER_ENABLED - The hexadecimal flag value for redirect handler enabled\n * @property {number} RETRY_HANDLER_ENABLED - The hexadecimal flag value for retry handler enabled\n * @property {number} AUTHENTICATION_HANDLER_ENABLED - The hexadecimal flag value for the authentication handler enabled\n */\n\nexport enum FeatureUsageFlag {\n\t/* eslint-disable  @typescript-eslint/naming-convention */\n\tNONE = 0x0,\n\tREDIRECT_HANDLER_ENABLED = 0x1,\n\tRETRY_HANDLER_ENABLED = 0x2,\n\tAUTHENTICATION_HANDLER_ENABLED = 0x4,\n\t/* eslint-enable  @typescript-eslint/naming-convention */\n}\n\n/**\n * @class\n * @implements MiddlewareOptions\n * Class for TelemetryHandlerOptions\n */\n\nexport class TelemetryHandlerOptions implements MiddlewareOptions {\n\t/**\n\t * @private\n\t * A member to hold the OR of feature usage flags\n\t */\n\tprivate featureUsage: FeatureUsageFlag = FeatureUsageFlag.NONE;\n\n\t/**\n\t * @public\n\t * @static\n\t * To update the feature usage in the context object\n\t * @param {Context} context - The request context object containing middleware options\n\t * @param {FeatureUsageFlag} flag - The flag value\n\t * @returns nothing\n\t */\n\tpublic static updateFeatureUsageFlag(context: Context, flag: FeatureUsageFlag): void {\n\t\tlet options: TelemetryHandlerOptions;\n\t\tif (context.middlewareControl instanceof MiddlewareControl) {\n\t\t\toptions = context.middlewareControl.getMiddlewareOptions(TelemetryHandlerOptions) as TelemetryHandlerOptions;\n\t\t} else {\n\t\t\tcontext.middlewareControl = new MiddlewareControl();\n\t\t}\n\t\tif (typeof options === \"undefined\") {\n\t\t\toptions = new TelemetryHandlerOptions();\n\t\t\tcontext.middlewareControl.setMiddlewareOptions(TelemetryHandlerOptions, options);\n\t\t}\n\t\toptions.setFeatureUsage(flag);\n\t}\n\n\t/**\n\t * @private\n\t * To set the feature usage flag\n\t * @param {FeatureUsageFlag} flag - The flag value\n\t * @returns nothing\n\t */\n\tprivate setFeatureUsage(flag: FeatureUsageFlag): void {\n\t\tthis.featureUsage = this.featureUsage | flag;\n\t}\n\n\t/**\n\t * @public\n\t * To get the feature usage\n\t * @returns A feature usage flag as hexadecimal string\n\t */\n\tpublic getFeatureUsage(): string {\n\t\treturn this.featureUsage.toString(16);\n\t}\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module AuthenticationHandler\n */\n\nimport { isCustomHost, isGraphURL } from \"../GraphRequestUtil\";\nimport { AuthenticationProvider } from \"../IAuthenticationProvider\";\nimport { AuthenticationProviderOptions } from \"../IAuthenticationProviderOptions\";\nimport { Context } from \"../IContext\";\nimport { Middleware } from \"./IMiddleware\";\nimport { MiddlewareControl } from \"./MiddlewareControl\";\nimport { appendRequestHeader } from \"./MiddlewareUtil\";\nimport { AuthenticationHandlerOptions } from \"./options/AuthenticationHandlerOptions\";\nimport { FeatureUsageFlag, TelemetryHandlerOptions } from \"./options/TelemetryHandlerOptions\";\n\n/**\n * @class\n * @implements Middleware\n * Class representing AuthenticationHandler\n */\nexport class AuthenticationHandler implements Middleware {\n\t/**\n\t * @private\n\t * A member representing the authorization header name\n\t */\n\tprivate static AUTHORIZATION_HEADER = \"Authorization\";\n\n\t/**\n\t * @private\n\t * A member to hold an AuthenticationProvider instance\n\t */\n\tprivate authenticationProvider: AuthenticationProvider;\n\n\t/**\n\t * @private\n\t * A member to hold next middleware in the middleware chain\n\t */\n\tprivate nextMiddleware: Middleware;\n\n\t/**\n\t * @public\n\t * @constructor\n\t * Creates an instance of AuthenticationHandler\n\t * @param {AuthenticationProvider} authenticationProvider - The authentication provider for the authentication handler\n\t */\n\tpublic constructor(authenticationProvider: AuthenticationProvider) {\n\t\tthis.authenticationProvider = authenticationProvider;\n\t}\n\n\t/**\n\t * @public\n\t * @async\n\t * To execute the current middleware\n\t * @param {Context} context - The context object of the request\n\t * @returns A Promise that resolves to nothing\n\t */\n\tpublic async execute(context: Context): Promise<void> {\n\t\tconst url = typeof context.request === \"string\" ? context.request : context.request.url;\n\t\tif (isGraphURL(url) || (context.customHosts && isCustomHost(url, context.customHosts))) {\n\t\t\tlet options: AuthenticationHandlerOptions;\n\t\t\tif (context.middlewareControl instanceof MiddlewareControl) {\n\t\t\t\toptions = context.middlewareControl.getMiddlewareOptions(AuthenticationHandlerOptions) as AuthenticationHandlerOptions;\n\t\t\t}\n\t\t\tlet authenticationProvider: AuthenticationProvider;\n\t\t\tlet authenticationProviderOptions: AuthenticationProviderOptions;\n\t\t\tif (options) {\n\t\t\t\tauthenticationProvider = options.authenticationProvider;\n\t\t\t\tauthenticationProviderOptions = options.authenticationProviderOptions;\n\t\t\t}\n\t\t\tif (!authenticationProvider) {\n\t\t\t\tauthenticationProvider = this.authenticationProvider;\n\t\t\t}\n\t\t\tconst token: string = await authenticationProvider.getAccessToken(authenticationProviderOptions);\n\t\t\tconst bearerKey = `Bearer ${token}`;\n\t\t\tappendRequestHeader(context.request, context.options, AuthenticationHandler.AUTHORIZATION_HEADER, bearerKey);\n\t\t\tTelemetryHandlerOptions.updateFeatureUsageFlag(context, FeatureUsageFlag.AUTHENTICATION_HANDLER_ENABLED);\n\t\t} else {\n\t\t\tif (context.options.headers) {\n\t\t\t\tdelete context.options.headers[AuthenticationHandler.AUTHORIZATION_HEADER];\n\t\t\t}\n\t\t}\n\t\treturn await this.nextMiddleware.execute(context);\n\t}\n\n\t/**\n\t * @public\n\t * To set the next middleware in the chain\n\t * @param {Middleware} next - The middleware instance\n\t * @returns Nothing\n\t */\n\tpublic setNext(next: Middleware): void {\n\t\tthis.nextMiddleware = next;\n\t}\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module HTTPMessageHandler\n */\n\nimport { Context } from \"../IContext\";\nimport { Middleware } from \"./IMiddleware\";\n\n/**\n * @class\n * @implements Middleware\n * Class for HTTPMessageHandler\n */\nexport class HTTPMessageHandler implements Middleware {\n\t/**\n\t * @public\n\t * @async\n\t * To execute the current middleware\n\t * @param {Context} context - The request context object\n\t * @returns A promise that resolves to nothing\n\t */\n\tpublic async execute(context: Context): Promise<void> {\n\t\tcontext.response = await fetch(context.request, context.options);\n\t}\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module RetryHandlerOptions\n */\n\nimport { FetchOptions } from \"../../IFetchOptions\";\nimport { MiddlewareOptions } from \"./IMiddlewareOptions\";\n\n/**\n * @type\n * A type declaration for shouldRetry callback\n */\nexport type ShouldRetry = (delay: number, attempt: number, request: RequestInfo, options: FetchOptions | undefined, response: Response) => boolean;\n\n/**\n * @class\n * @implements MiddlewareOptions\n * Class for RetryHandlerOptions\n */\n\nexport class RetryHandlerOptions implements MiddlewareOptions {\n\t/**\n\t * @private\n\t * @static\n\t * A member holding default delay value in seconds\n\t */\n\tprivate static DEFAULT_DELAY = 3;\n\n\t/**\n\t * @private\n\t * @static\n\t * A member holding default maxRetries value\n\t */\n\tprivate static DEFAULT_MAX_RETRIES = 3;\n\n\t/**\n\t * @private\n\t * @static\n\t * A member holding maximum delay value in seconds\n\t */\n\tprivate static MAX_DELAY = 180;\n\n\t/**\n\t * @private\n\t * @static\n\t * A member holding maximum maxRetries value\n\t */\n\tprivate static MAX_MAX_RETRIES = 10;\n\n\t/**\n\t * @public\n\t * A member holding delay value in seconds\n\t */\n\tpublic delay: number;\n\n\t/**\n\t * @public\n\t * A member holding maxRetries value\n\t */\n\tpublic maxRetries: number;\n\n\t/**\n\t * @public\n\t * A member holding shouldRetry callback\n\t */\n\tpublic shouldRetry: ShouldRetry;\n\n\t/**\n\t * @private\n\t * A member holding default shouldRetry callback\n\t */\n\tprivate static defaultShouldRetry: ShouldRetry = () => true;\n\n\t/**\n\t * @public\n\t * @constructor\n\t * To create an instance of RetryHandlerOptions\n\t * @param {number} [delay = RetryHandlerOptions.DEFAULT_DELAY] - The delay value in seconds\n\t * @param {number} [maxRetries = RetryHandlerOptions.DEFAULT_MAX_RETRIES] - The maxRetries value\n\t * @param {ShouldRetry} [shouldRetry = RetryHandlerOptions.DEFAULT_SHOULD_RETRY] - The shouldRetry callback function\n\t * @returns An instance of RetryHandlerOptions\n\t */\n\tpublic constructor(delay: number = RetryHandlerOptions.DEFAULT_DELAY, maxRetries: number = RetryHandlerOptions.DEFAULT_MAX_RETRIES, shouldRetry: ShouldRetry = RetryHandlerOptions.defaultShouldRetry) {\n\t\tif (delay > RetryHandlerOptions.MAX_DELAY && maxRetries > RetryHandlerOptions.MAX_MAX_RETRIES) {\n\t\t\tconst error = new Error(`Delay and MaxRetries should not be more than ${RetryHandlerOptions.MAX_DELAY} and ${RetryHandlerOptions.MAX_MAX_RETRIES}`);\n\t\t\terror.name = \"MaxLimitExceeded\";\n\t\t\tthrow error;\n\t\t} else if (delay > RetryHandlerOptions.MAX_DELAY) {\n\t\t\tconst error = new Error(`Delay should not be more than ${RetryHandlerOptions.MAX_DELAY}`);\n\t\t\terror.name = \"MaxLimitExceeded\";\n\t\t\tthrow error;\n\t\t} else if (maxRetries > RetryHandlerOptions.MAX_MAX_RETRIES) {\n\t\t\tconst error = new Error(`MaxRetries should not be more than ${RetryHandlerOptions.MAX_MAX_RETRIES}`);\n\t\t\terror.name = \"MaxLimitExceeded\";\n\t\t\tthrow error;\n\t\t} else if (delay < 0 && maxRetries < 0) {\n\t\t\tconst error = new Error(`Delay and MaxRetries should not be negative`);\n\t\t\terror.name = \"MinExpectationNotMet\";\n\t\t\tthrow error;\n\t\t} else if (delay < 0) {\n\t\t\tconst error = new Error(`Delay should not be negative`);\n\t\t\terror.name = \"MinExpectationNotMet\";\n\t\t\tthrow error;\n\t\t} else if (maxRetries < 0) {\n\t\t\tconst error = new Error(`MaxRetries should not be negative`);\n\t\t\terror.name = \"MinExpectationNotMet\";\n\t\t\tthrow error;\n\t\t}\n\t\tthis.delay = Math.min(delay, RetryHandlerOptions.MAX_DELAY);\n\t\tthis.maxRetries = Math.min(maxRetries, RetryHandlerOptions.MAX_MAX_RETRIES);\n\t\tthis.shouldRetry = shouldRetry;\n\t}\n\n\t/**\n\t * @public\n\t * To get the maximum delay\n\t * @returns A maximum delay\n\t */\n\tpublic getMaxDelay(): number {\n\t\treturn RetryHandlerOptions.MAX_DELAY;\n\t}\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module RetryHandler\n */\n\nimport { Context } from \"../IContext\";\nimport { FetchOptions } from \"../IFetchOptions\";\nimport { RequestMethod } from \"../RequestMethod\";\nimport { Middleware } from \"./IMiddleware\";\nimport { MiddlewareControl } from \"./MiddlewareControl\";\nimport { getRequestHeader, setRequestHeader } from \"./MiddlewareUtil\";\nimport { RetryHandlerOptions } from \"./options/RetryHandlerOptions\";\nimport { FeatureUsageFlag, TelemetryHandlerOptions } from \"./options/TelemetryHandlerOptions\";\n\n/**\n * @class\n * @implements Middleware\n * Class for RetryHandler\n */\nexport class RetryHandler implements Middleware {\n\t/**\n\t * @private\n\t * @static\n\t * A list of status codes that needs to be retried\n\t */\n\tprivate static RETRY_STATUS_CODES: number[] = [\n\t\t429, // Too many requests\n\t\t503, // Service unavailable\n\t\t504, // Gateway timeout\n\t];\n\n\t/**\n\t * @private\n\t * @static\n\t * A member holding the name of retry attempt header\n\t */\n\tprivate static RETRY_ATTEMPT_HEADER = \"Retry-Attempt\";\n\n\t/**\n\t * @private\n\t * @static\n\t * A member holding the name of retry after header\n\t */\n\tprivate static RETRY_AFTER_HEADER = \"Retry-After\";\n\n\t/**\n\t * @private\n\t * A member to hold next middleware in the middleware chain\n\t */\n\tprivate nextMiddleware: Middleware;\n\n\t/**\n\t * @private\n\t * A member holding the retry handler options\n\t */\n\tprivate options: RetryHandlerOptions;\n\n\t/**\n\t * @public\n\t * @constructor\n\t * To create an instance of RetryHandler\n\t * @param {RetryHandlerOptions} [options = new RetryHandlerOptions()] - The retry handler options value\n\t * @returns An instance of RetryHandler\n\t */\n\tpublic constructor(options: RetryHandlerOptions = new RetryHandlerOptions()) {\n\t\tthis.options = options;\n\t}\n\n\t/**\n\t *\n\t * @private\n\t * To check whether the response has the retry status code\n\t * @param {Response} response - The response object\n\t * @returns Whether the response has retry status code or not\n\t */\n\tprivate isRetry(response: Response): boolean {\n\t\treturn RetryHandler.RETRY_STATUS_CODES.indexOf(response.status) !== -1;\n\t}\n\n\t/**\n\t * @private\n\t * To check whether the payload is buffered or not\n\t * @param {RequestInfo} request - The url string or the request object value\n\t * @param {FetchOptions} options - The options of a request\n\t * @returns Whether the payload is buffered or not\n\t */\n\tprivate isBuffered(request: RequestInfo, options: FetchOptions | undefined): boolean {\n\t\tconst method = typeof request === \"string\" ? options.method : (request as Request).method;\n\t\tconst isPutPatchOrPost: boolean = method === RequestMethod.PUT || method === RequestMethod.PATCH || method === RequestMethod.POST;\n\t\tif (isPutPatchOrPost) {\n\t\t\tconst isStream = getRequestHeader(request, options, \"Content-Type\") === \"application/octet-stream\";\n\t\t\tif (isStream) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\t/**\n\t * @private\n\t * To get the delay for a retry\n\t * @param {Response} response - The response object\n\t * @param {number} retryAttempts - The current attempt count\n\t * @param {number} delay - The delay value in seconds\n\t * @returns A delay for a retry\n\t */\n\tprivate getDelay(response: Response, retryAttempts: number, delay: number): number {\n\t\tconst getRandomness = () => Number(Math.random().toFixed(3));\n\t\tconst retryAfter = response.headers !== undefined ? response.headers.get(RetryHandler.RETRY_AFTER_HEADER) : null;\n\t\tlet newDelay: number;\n\t\tif (retryAfter !== null) {\n\t\t\tif (Number.isNaN(Number(retryAfter))) {\n\t\t\t\tnewDelay = Math.round((new Date(retryAfter).getTime() - Date.now()) / 1000);\n\t\t\t} else {\n\t\t\t\tnewDelay = Number(retryAfter);\n\t\t\t}\n\t\t} else {\n\t\t\t// Adding randomness to avoid retrying at a same\n\t\t\tnewDelay = retryAttempts >= 2 ? this.getExponentialBackOffTime(retryAttempts) + delay + getRandomness() : delay + getRandomness();\n\t\t}\n\t\treturn Math.min(newDelay, this.options.getMaxDelay() + getRandomness());\n\t}\n\n\t/**\n\t * @private\n\t * To get an exponential back off value\n\t * @param {number} attempts - The current attempt count\n\t * @returns An exponential back off value\n\t */\n\tprivate getExponentialBackOffTime(attempts: number): number {\n\t\treturn Math.round((1 / 2) * (2 ** attempts - 1));\n\t}\n\n\t/**\n\t * @private\n\t * @async\n\t * To add delay for the execution\n\t * @param {number} delaySeconds - The delay value in seconds\n\t * @returns Nothing\n\t */\n\tprivate async sleep(delaySeconds: number): Promise<void> {\n\t\tconst delayMilliseconds = delaySeconds * 1000;\n\t\treturn new Promise((resolve) => setTimeout(resolve, delayMilliseconds));\n\t}\n\n\tprivate getOptions(context: Context): RetryHandlerOptions {\n\t\tlet options: RetryHandlerOptions;\n\t\tif (context.middlewareControl instanceof MiddlewareControl) {\n\t\t\toptions = context.middlewareControl.getMiddlewareOptions(this.options.constructor) as RetryHandlerOptions;\n\t\t}\n\t\tif (typeof options === \"undefined\") {\n\t\t\toptions = Object.assign(new RetryHandlerOptions(), this.options);\n\t\t}\n\t\treturn options;\n\t}\n\n\t/**\n\t * @private\n\t * @async\n\t * To execute the middleware with retries\n\t * @param {Context} context - The context object\n\t * @param {number} retryAttempts - The current attempt count\n\t * @param {RetryHandlerOptions} options - The retry middleware options instance\n\t * @returns A Promise that resolves to nothing\n\t */\n\tprivate async executeWithRetry(context: Context, retryAttempts: number, options: RetryHandlerOptions): Promise<void> {\n\t\tawait this.nextMiddleware.execute(context);\n\t\tif (retryAttempts < options.maxRetries && this.isRetry(context.response) && this.isBuffered(context.request, context.options) && options.shouldRetry(options.delay, retryAttempts, context.request, context.options, context.response)) {\n\t\t\t++retryAttempts;\n\t\t\tsetRequestHeader(context.request, context.options, RetryHandler.RETRY_ATTEMPT_HEADER, retryAttempts.toString());\n\t\t\tconst delay = this.getDelay(context.response, retryAttempts, options.delay);\n\t\t\tawait this.sleep(delay);\n\t\t\treturn await this.executeWithRetry(context, retryAttempts, options);\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t}\n\n\t/**\n\t * @public\n\t * @async\n\t * To execute the current middleware\n\t * @param {Context} context - The context object of the request\n\t * @returns A Promise that resolves to nothing\n\t */\n\tpublic async execute(context: Context): Promise<void> {\n\t\tconst retryAttempts = 0;\n\t\tconst options: RetryHandlerOptions = this.getOptions(context);\n\t\tTelemetryHandlerOptions.updateFeatureUsageFlag(context, FeatureUsageFlag.RETRY_HANDLER_ENABLED);\n\t\treturn await this.executeWithRetry(context, retryAttempts, options);\n\t}\n\n\t/**\n\t * @public\n\t * To set the next middleware in the chain\n\t * @param {Middleware} next - The middleware instance\n\t * @returns Nothing\n\t */\n\tpublic setNext(next: Middleware): void {\n\t\tthis.nextMiddleware = next;\n\t}\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module RedirectHandlerOptions\n */\n\nimport { MiddlewareOptions } from \"./IMiddlewareOptions\";\n\n/**\n * @type\n * A type declaration for shouldRetry callback\n */\nexport type ShouldRedirect = (response: Response) => boolean;\n\n/**\n * @class\n * @implements MiddlewareOptions\n * A class representing RedirectHandlerOptions\n */\nexport class RedirectHandlerOptions implements MiddlewareOptions {\n\t/**\n\t * @private\n\t * @static\n\t * A member holding default max redirects value\n\t */\n\tprivate static DEFAULT_MAX_REDIRECTS = 5;\n\n\t/**\n\t * @private\n\t * @static\n\t * A member holding maximum max redirects value\n\t */\n\tprivate static MAX_MAX_REDIRECTS = 20;\n\n\t/**\n\t * @public\n\t * A member holding max redirects value\n\t */\n\tpublic maxRedirects: number;\n\n\t/**\n\t * @public\n\t * A member holding shouldRedirect callback\n\t */\n\tpublic shouldRedirect: ShouldRedirect;\n\n\t/**\n\t * @private\n\t * A member holding default shouldRedirect callback\n\t */\n\tprivate static defaultShouldRedirect: ShouldRedirect = () => true;\n\n\t/**\n\t * @public\n\t * @constructor\n\t * To create an instance of RedirectHandlerOptions\n\t * @param {number} [maxRedirects = RedirectHandlerOptions.DEFAULT_MAX_REDIRECTS] - The max redirects value\n\t * @param {ShouldRedirect} [shouldRedirect = RedirectHandlerOptions.DEFAULT_SHOULD_RETRY] - The should redirect callback\n\t * @returns An instance of RedirectHandlerOptions\n\t */\n\tpublic constructor(maxRedirects: number = RedirectHandlerOptions.DEFAULT_MAX_REDIRECTS, shouldRedirect: ShouldRedirect = RedirectHandlerOptions.defaultShouldRedirect) {\n\t\tif (maxRedirects > RedirectHandlerOptions.MAX_MAX_REDIRECTS) {\n\t\t\tconst error = new Error(`MaxRedirects should not be more than ${RedirectHandlerOptions.MAX_MAX_REDIRECTS}`);\n\t\t\terror.name = \"MaxLimitExceeded\";\n\t\t\tthrow error;\n\t\t}\n\t\tif (maxRedirects < 0) {\n\t\t\tconst error = new Error(`MaxRedirects should not be negative`);\n\t\t\terror.name = \"MinExpectationNotMet\";\n\t\t\tthrow error;\n\t\t}\n\t\tthis.maxRedirects = maxRedirects;\n\t\tthis.shouldRedirect = shouldRedirect;\n\t}\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module RedirectHandler\n */\n\nimport { Context } from \"../IContext\";\nimport { RequestMethod } from \"../RequestMethod\";\nimport { Middleware } from \"./IMiddleware\";\nimport { MiddlewareControl } from \"./MiddlewareControl\";\nimport { cloneRequestWithNewUrl } from \"./MiddlewareUtil\";\nimport { RedirectHandlerOptions } from \"./options/RedirectHandlerOptions\";\nimport { FeatureUsageFlag, TelemetryHandlerOptions } from \"./options/TelemetryHandlerOptions\";\n\n/**\n * @class\n * Class\n * @implements Middleware\n * Class representing RedirectHandler\n */\nexport class RedirectHandler implements Middleware {\n\t/**\n\t * @private\n\t * @static\n\t * A member holding the array of redirect status codes\n\t */\n\tprivate static REDIRECT_STATUS_CODES: number[] = [\n\t\t301, // Moved Permanently\n\t\t302, // Found\n\t\t303, // See Other\n\t\t307, // Temporary Permanently\n\t\t308, // Moved Permanently\n\t];\n\n\t/**\n\t * @private\n\t * @static\n\t * A member holding SeeOther status code\n\t */\n\tprivate static STATUS_CODE_SEE_OTHER = 303;\n\n\t/**\n\t * @private\n\t * @static\n\t * A member holding the name of the location header\n\t */\n\tprivate static LOCATION_HEADER = \"Location\";\n\n\t/**\n\t * @private\n\t * @static\n\t * A member representing the authorization header name\n\t */\n\tprivate static AUTHORIZATION_HEADER = \"Authorization\";\n\n\t/**\n\t * @private\n\t * @static\n\t * A member holding the manual redirect value\n\t */\n\tprivate static MANUAL_REDIRECT: RequestRedirect = \"manual\";\n\n\t/**\n\t * @private\n\t * A member holding options to customize the handler behavior\n\t */\n\tprivate options: RedirectHandlerOptions;\n\n\t/**\n\t * @private\n\t * A member to hold next middleware in the middleware chain\n\t */\n\tprivate nextMiddleware: Middleware;\n\n\t/**\n\t * @public\n\t * @constructor\n\t * To create an instance of RedirectHandler\n\t * @param {RedirectHandlerOptions} [options = new RedirectHandlerOptions()] - The redirect handler options instance\n\t * @returns An instance of RedirectHandler\n\t */\n\n\tpublic constructor(options: RedirectHandlerOptions = new RedirectHandlerOptions()) {\n\t\tthis.options = options;\n\t}\n\n\t/**\n\t * @private\n\t * To check whether the response has the redirect status code or not\n\t * @param {Response} response - The response object\n\t * @returns A boolean representing whether the response contains the redirect status code or not\n\t */\n\tprivate isRedirect(response: Response): boolean {\n\t\treturn RedirectHandler.REDIRECT_STATUS_CODES.indexOf(response.status) !== -1;\n\t}\n\n\t/**\n\t * @private\n\t * To check whether the response has location header or not\n\t * @param {Response} response - The response object\n\t * @returns A boolean representing the whether the response has location header or not\n\t */\n\tprivate hasLocationHeader(response: Response): boolean {\n\t\treturn response.headers.has(RedirectHandler.LOCATION_HEADER);\n\t}\n\n\t/**\n\t * @private\n\t * To get the redirect url from location header in response object\n\t * @param {Response} response - The response object\n\t * @returns A redirect url from location header\n\t */\n\tprivate getLocationHeader(response: Response): string {\n\t\treturn response.headers.get(RedirectHandler.LOCATION_HEADER);\n\t}\n\n\t/**\n\t * @private\n\t * To check whether the given url is a relative url or not\n\t * @param {string} url - The url string value\n\t * @returns A boolean representing whether the given url is a relative url or not\n\t */\n\tprivate isRelativeURL(url: string): boolean {\n\t\treturn url.indexOf(\"://\") === -1;\n\t}\n\n\t/**\n\t * @private\n\t * To check whether the authorization header in the request should be dropped for consequent redirected requests\n\t * @param {string} requestUrl - The request url value\n\t * @param {string} redirectUrl - The redirect url value\n\t * @returns A boolean representing whether the authorization header in the request should be dropped for consequent redirected requests\n\t */\n\tprivate shouldDropAuthorizationHeader(requestUrl: string, redirectUrl: string): boolean {\n\t\tconst schemeHostRegex = /^[A-Za-z].+?:\\/\\/.+?(?=\\/|$)/;\n\t\tconst requestMatches: string[] = schemeHostRegex.exec(requestUrl);\n\t\tlet requestAuthority: string;\n\t\tlet redirectAuthority: string;\n\t\tif (requestMatches !== null) {\n\t\t\trequestAuthority = requestMatches[0];\n\t\t}\n\t\tconst redirectMatches: string[] = schemeHostRegex.exec(redirectUrl);\n\t\tif (redirectMatches !== null) {\n\t\t\tredirectAuthority = redirectMatches[0];\n\t\t}\n\t\treturn typeof requestAuthority !== \"undefined\" && typeof redirectAuthority !== \"undefined\" && requestAuthority !== redirectAuthority;\n\t}\n\n\t/**\n\t * @private\n\t * @async\n\t * To update a request url with the redirect url\n\t * @param {string} redirectUrl - The redirect url value\n\t * @param {Context} context - The context object value\n\t * @returns Nothing\n\t */\n\tprivate async updateRequestUrl(redirectUrl: string, context: Context): Promise<void> {\n\t\tcontext.request = typeof context.request === \"string\" ? redirectUrl : await cloneRequestWithNewUrl(redirectUrl, context.request as Request);\n\t}\n\n\t/**\n\t * @private\n\t * To get the options for execution of the middleware\n\t * @param {Context} context - The context object\n\t * @returns A options for middleware execution\n\t */\n\tprivate getOptions(context: Context): RedirectHandlerOptions {\n\t\tlet options: RedirectHandlerOptions;\n\t\tif (context.middlewareControl instanceof MiddlewareControl) {\n\t\t\toptions = context.middlewareControl.getMiddlewareOptions(RedirectHandlerOptions) as RedirectHandlerOptions;\n\t\t}\n\t\tif (typeof options === \"undefined\") {\n\t\t\toptions = Object.assign(new RedirectHandlerOptions(), this.options);\n\t\t}\n\t\treturn options;\n\t}\n\n\t/**\n\t * @private\n\t * @async\n\t * To execute the next middleware and to handle in case of redirect response returned by the server\n\t * @param {Context} context - The context object\n\t * @param {number} redirectCount - The redirect count value\n\t * @param {RedirectHandlerOptions} options - The redirect handler options instance\n\t * @returns A promise that resolves to nothing\n\t */\n\tprivate async executeWithRedirect(context: Context, redirectCount: number, options: RedirectHandlerOptions): Promise<void> {\n\t\tawait this.nextMiddleware.execute(context);\n\t\tconst response = context.response;\n\t\tif (redirectCount < options.maxRedirects && this.isRedirect(response) && this.hasLocationHeader(response) && options.shouldRedirect(response)) {\n\t\t\t++redirectCount;\n\t\t\tif (response.status === RedirectHandler.STATUS_CODE_SEE_OTHER) {\n\t\t\t\tcontext.options.method = RequestMethod.GET;\n\t\t\t\tdelete context.options.body;\n\t\t\t} else {\n\t\t\t\tconst redirectUrl: string = this.getLocationHeader(response);\n\t\t\t\tif (!this.isRelativeURL(redirectUrl) && this.shouldDropAuthorizationHeader(response.url, redirectUrl)) {\n\t\t\t\t\tdelete context.options.headers[RedirectHandler.AUTHORIZATION_HEADER];\n\t\t\t\t}\n\t\t\t\tawait this.updateRequestUrl(redirectUrl, context);\n\t\t\t}\n\t\t\tawait this.executeWithRedirect(context, redirectCount, options);\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t}\n\n\t/**\n\t * @public\n\t * @async\n\t * To execute the current middleware\n\t * @param {Context} context - The context object of the request\n\t * @returns A Promise that resolves to nothing\n\t */\n\tpublic async execute(context: Context): Promise<void> {\n\t\tconst redirectCount = 0;\n\t\tconst options = this.getOptions(context);\n\t\tcontext.options.redirect = RedirectHandler.MANUAL_REDIRECT;\n\t\tTelemetryHandlerOptions.updateFeatureUsageFlag(context, FeatureUsageFlag.REDIRECT_HANDLER_ENABLED);\n\t\treturn await this.executeWithRedirect(context, redirectCount, options);\n\t}\n\n\t/**\n\t * @public\n\t * To set the next middleware in the chain\n\t * @param {Middleware} next - The middleware instance\n\t * @returns Nothing\n\t */\n\tpublic setNext(next: Middleware): void {\n\t\tthis.nextMiddleware = next;\n\t}\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n// THIS FILE IS AUTO GENERATED\n// ANY CHANGES WILL BE LOST DURING BUILD\n\n/**\n * @module Version\n */\n\nexport const PACKAGE_VERSION = \"3.0.5\";\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module TelemetryHandler\n */\nimport { isCustomHost, isGraphURL } from \"../GraphRequestUtil\";\nimport { Context } from \"../IContext\";\nimport { PACKAGE_VERSION } from \"../Version\";\nimport { Middleware } from \"./IMiddleware\";\nimport { MiddlewareControl } from \"./MiddlewareControl\";\nimport { appendRequestHeader, generateUUID, getRequestHeader, setRequestHeader } from \"./MiddlewareUtil\";\nimport { TelemetryHandlerOptions } from \"./options/TelemetryHandlerOptions\";\n\n/**\n * @class\n * @implements Middleware\n * Class for TelemetryHandler\n */\nexport class TelemetryHandler implements Middleware {\n\t/**\n\t * @private\n\t * @static\n\t * A member holding the name of the client request id header\n\t */\n\tprivate static CLIENT_REQUEST_ID_HEADER = \"client-request-id\";\n\n\t/**\n\t * @private\n\t * @static\n\t * A member holding the name of the sdk version header\n\t */\n\tprivate static SDK_VERSION_HEADER = \"SdkVersion\";\n\n\t/**\n\t * @private\n\t * @static\n\t * A member holding the language prefix for the sdk version header value\n\t */\n\tprivate static PRODUCT_NAME = \"graph-js\";\n\n\t/**\n\t * @private\n\t * @static\n\t * A member holding the key for the feature usage metrics\n\t */\n\tprivate static FEATURE_USAGE_STRING = \"featureUsage\";\n\n\t/**\n\t * @private\n\t * A member to hold next middleware in the middleware chain\n\t */\n\tprivate nextMiddleware: Middleware;\n\n\t/**\n\t * @public\n\t * @async\n\t * To execute the current middleware\n\t * @param {Context} context - The context object of the request\n\t * @returns A Promise that resolves to nothing\n\t */\n\tpublic async execute(context: Context): Promise<void> {\n\t\tconst url = typeof context.request === \"string\" ? context.request : context.request.url;\n\t\tif (isGraphURL(url) || (context.customHosts && isCustomHost(url, context.customHosts))) {\n\t\t\t// Add telemetry only if the request url is a Graph URL.\n\t\t\t// Errors are reported as in issue #265 if headers are present when redirecting to a non Graph URL\n\t\t\tlet clientRequestId: string = getRequestHeader(context.request, context.options, TelemetryHandler.CLIENT_REQUEST_ID_HEADER);\n\t\t\tif (!clientRequestId) {\n\t\t\t\tclientRequestId = generateUUID();\n\t\t\t\tsetRequestHeader(context.request, context.options, TelemetryHandler.CLIENT_REQUEST_ID_HEADER, clientRequestId);\n\t\t\t}\n\t\t\tlet sdkVersionValue = `${TelemetryHandler.PRODUCT_NAME}/${PACKAGE_VERSION}`;\n\t\t\tlet options: TelemetryHandlerOptions;\n\t\t\tif (context.middlewareControl instanceof MiddlewareControl) {\n\t\t\t\toptions = context.middlewareControl.getMiddlewareOptions(TelemetryHandlerOptions) as TelemetryHandlerOptions;\n\t\t\t}\n\t\t\tif (options) {\n\t\t\t\tconst featureUsage: string = options.getFeatureUsage();\n\t\t\t\tsdkVersionValue += ` (${TelemetryHandler.FEATURE_USAGE_STRING}=${featureUsage})`;\n\t\t\t}\n\t\t\tappendRequestHeader(context.request, context.options, TelemetryHandler.SDK_VERSION_HEADER, sdkVersionValue);\n\t\t} else {\n\t\t\t// Remove telemetry headers if present during redirection.\n\t\t\tdelete context.options.headers[TelemetryHandler.CLIENT_REQUEST_ID_HEADER];\n\t\t\tdelete context.options.headers[TelemetryHandler.SDK_VERSION_HEADER];\n\t\t}\n\t\treturn await this.nextMiddleware.execute(context);\n\t}\n\n\t/**\n\t * @public\n\t * To set the next middleware in the chain\n\t * @param {Middleware} next - The middleware instance\n\t * @returns Nothing\n\t */\n\tpublic setNext(next: Middleware): void {\n\t\tthis.nextMiddleware = next;\n\t}\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module MiddlewareFactory\n */\n\nimport { AuthenticationProvider } from \"../IAuthenticationProvider\";\nimport { AuthenticationHandler } from \"./AuthenticationHandler\";\nimport { HTTPMessageHandler } from \"./HTTPMessageHandler\";\nimport { Middleware } from \"./IMiddleware\";\nimport { RedirectHandlerOptions } from \"./options/RedirectHandlerOptions\";\nimport { RetryHandlerOptions } from \"./options/RetryHandlerOptions\";\nimport { RedirectHandler } from \"./RedirectHandler\";\nimport { RetryHandler } from \"./RetryHandler\";\nimport { TelemetryHandler } from \"./TelemetryHandler\";\n\n/**\n * @private\n * To check whether the environment is node or not\n * @returns A boolean representing the environment is node or not\n */\nconst isNodeEnvironment = (): boolean => {\n\treturn typeof process === \"object\" && typeof require === \"function\";\n};\n\n/**\n * @class\n * Class containing function(s) related to the middleware pipelines.\n */\nexport class MiddlewareFactory {\n\t/**\n\t * @public\n\t * @static\n\t * Returns the default middleware chain an array with the  middleware handlers\n\t * @param {AuthenticationProvider} authProvider - The authentication provider instance\n\t * @returns an array of the middleware handlers of the default middleware chain\n\t */\n\tpublic static getDefaultMiddlewareChain(authProvider: AuthenticationProvider): Middleware[] {\n\t\tconst middleware: Middleware[] = [];\n\t\tconst authenticationHandler = new AuthenticationHandler(authProvider);\n\t\tconst retryHandler = new RetryHandler(new RetryHandlerOptions());\n\t\tconst telemetryHandler = new TelemetryHandler();\n\t\tconst httpMessageHandler = new HTTPMessageHandler();\n\n\t\tmiddleware.push(authenticationHandler);\n\t\tmiddleware.push(retryHandler);\n\t\tif (isNodeEnvironment()) {\n\t\t\tconst redirectHandler = new RedirectHandler(new RedirectHandlerOptions());\n\t\t\tmiddleware.push(redirectHandler);\n\t\t}\n\t\tmiddleware.push(telemetryHandler);\n\t\tmiddleware.push(httpMessageHandler);\n\n\t\treturn middleware;\n\t}\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module ChaosStrategy\n */\n\n/**\n * Strategy used for Testing Handler\n * @enum\n */\nexport enum ChaosStrategy {\n\tMANUAL,\n\tRANDOM,\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module ChaosHandlerOptions\n */\n\nimport { ChaosStrategy } from \"./ChaosStrategy\";\nimport { MiddlewareOptions } from \"./IMiddlewareOptions\";\n\n/**\n * Class representing ChaosHandlerOptions\n * @class\n * Class\n * @implements MiddlewareOptions\n */\nexport class ChaosHandlerOptions implements MiddlewareOptions {\n\t/**\n\t * Specifies the startegy used for the Testing Handler -> RANDOM/MANUAL\n\t *\n\t * @public\n\t */\n\tpublic chaosStrategy: ChaosStrategy;\n\n\t/**\n\t * Status code to be returned in the response\n\t *\n\t * @public\n\t */\n\tpublic statusCode: number;\n\n\t/**\n\t * The Message to be returned in the response\n\t *\n\t * @public\n\t */\n\tpublic statusMessage: string;\n\n\t/**\n\t * The percentage of randomness/chaos in the handler\n\t *\n\t * Setting the default value as 10%\n\t * @public\n\t */\n\tpublic chaosPercentage: number;\n\n\t/**\n\t * The response body to be returned in the response\n\t *\n\t * @public\n\t */\n\tpublic responseBody: any;\n\n\t/**\n\t * The response headers to be returned in the response\n\t *\n\t * @public\n\t */\n\tpublic headers: Headers;\n\n\t/**\n\t * @public\n\t * @constructor\n\t * To create an instance of Testing Handler Options\n\t * @param {ChaosStrategy} chaosStrategy - Specifies the startegy used for the Testing Handler -> RAMDOM/MANUAL\n\t * @param {string} statusMessage - The Message to be returned in the response\n\t * @param {number?} statusCode - The statusCode to be returned in the response\n\t * @param {number?} chaosPercentage - The percentage of randomness/chaos in the handler\n\t * @param {any?} responseBody - The response body to be returned in the response\n\t * @returns An instance of ChaosHandlerOptions\n\t */\n\tpublic constructor(chaosStrategy: ChaosStrategy = ChaosStrategy.RANDOM, statusMessage = \"Some error Happened\", statusCode?: number, chaosPercentage?: number, responseBody?: any, headers?: Headers) {\n\t\tthis.chaosStrategy = chaosStrategy;\n\t\tthis.statusCode = statusCode;\n\t\tthis.statusMessage = statusMessage;\n\t\tthis.chaosPercentage = chaosPercentage !== undefined ? chaosPercentage : 10;\n\t\tthis.responseBody = responseBody;\n\t\tthis.headers = headers;\n\t\tif (this.chaosPercentage > 100) {\n\t\t\tthrow new Error(\"Error Pecentage can not be more than 100\");\n\t\t}\n\t}\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module ChaosHandlerData\n */\n\n/**\n * Contains RequestMethod to corresponding array of possible status codes, used for Random mode\n */\nexport const methodStatusCode: { [key: string]: number[] } = {\n\tGET: [429, 500, 502, 503, 504],\n\tPOST: [429, 500, 502, 503, 504, 507],\n\tPUT: [429, 500, 502, 503, 504, 507],\n\tPATCH: [429, 500, 502, 503, 504],\n\tDELETE: [429, 500, 502, 503, 504, 507],\n};\n\n/**\n * Contains statusCode to statusMessage map\n */\nexport const httpStatusCode: { [key: number]: string } = {\n\t100: \"Continue\",\n\t101: \"Switching Protocols\",\n\t102: \"Processing\",\n\t103: \"Early Hints\",\n\t200: \"OK\",\n\t201: \"Created\",\n\t202: \"Accepted\",\n\t203: \"Non-Authoritative Information\",\n\t204: \"No Content\",\n\t205: \"Reset Content\",\n\t206: \"Partial Content\",\n\t207: \"Multi-Status\",\n\t208: \"Already Reported\",\n\t226: \"IM Used\",\n\t300: \"Multiple Choices\",\n\t301: \"Moved Permanently\",\n\t302: \"Found\",\n\t303: \"See Other\",\n\t304: \"Not Modified\",\n\t305: \"Use Proxy\",\n\t307: \"Temporary Redirect\",\n\t308: \"Permanent Redirect\",\n\t400: \"Bad Request\",\n\t401: \"Unauthorized\",\n\t402: \"Payment Required\",\n\t403: \"Forbidden\",\n\t404: \"Not Found\",\n\t405: \"Method Not Allowed\",\n\t406: \"Not Acceptable\",\n\t407: \"Proxy Authentication Required\",\n\t408: \"Request Timeout\",\n\t409: \"Conflict\",\n\t410: \"Gone\",\n\t411: \"Length Required\",\n\t412: \"Precondition Failed\",\n\t413: \"Payload Too Large\",\n\t414: \"URI Too Long\",\n\t415: \"Unsupported Media Type\",\n\t416: \"Range Not Satisfiable\",\n\t417: \"Expectation Failed\",\n\t421: \"Misdirected Request\",\n\t422: \"Unprocessable Entity\",\n\t423: \"Locked\",\n\t424: \"Failed Dependency\",\n\t425: \"Too Early\",\n\t426: \"Upgrade Required\",\n\t428: \"Precondition Required\",\n\t429: \"Too Many Requests\",\n\t431: \"Request Header Fields Too Large\",\n\t451: \"Unavailable For Legal Reasons\",\n\t500: \"Internal Server Error\",\n\t501: \"Not Implemented\",\n\t502: \"Bad Gateway\",\n\t503: \"Service Unavailable\",\n\t504: \"Gateway Timeout\",\n\t505: \"HTTP Version Not Supported\",\n\t506: \"Variant Also Negotiates\",\n\t507: \"Insufficient Storage\",\n\t508: \"Loop Detected\",\n\t510: \"Not Extended\",\n\t511: \"Network Authentication Required\",\n};\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module ChaosHandler\n */\n\nimport { Context } from \"../IContext\";\nimport { RequestMethod } from \"../RequestMethod\";\nimport { Middleware } from \"./IMiddleware\";\nimport { MiddlewareControl } from \"./MiddlewareControl\";\nimport { generateUUID } from \"./MiddlewareUtil\";\nimport { httpStatusCode, methodStatusCode } from \"./options/ChaosHandlerData\";\nimport { ChaosHandlerOptions } from \"./options/ChaosHandlerOptions\";\nimport { ChaosStrategy } from \"./options/ChaosStrategy\";\n\n/**\n * Class representing ChaosHandler\n * @class\n * Class\n * @implements Middleware\n */\nexport class ChaosHandler implements Middleware {\n\t/**\n\t * A member holding options to customize the handler behavior\n\t *\n\t * @private\n\t */\n\tprivate options: ChaosHandlerOptions;\n\n\t/**\n\t * container for the manual map that has been written by the client\n\t *\n\t * @private\n\t */\n\tprivate manualMap: Map<string, Map<string, number>>;\n\n\t/**\n\t * @private\n\t * A member to hold next middleware in the middleware chain\n\t */\n\tprivate nextMiddleware: Middleware;\n\n\t/**\n\t * @public\n\t * @constructor\n\t * To create an instance of Testing Handler\n\t * @param {ChaosHandlerOptions} [options = new ChaosHandlerOptions()] - The testing handler options instance\n\t * @param manualMap - The Map passed by user containing url-statusCode info\n\t * @returns An instance of Testing Handler\n\t */\n\tpublic constructor(options: ChaosHandlerOptions = new ChaosHandlerOptions(), manualMap?: Map<string, Map<string, number>>) {\n\t\tthis.options = options;\n\t\tthis.manualMap = manualMap;\n\t}\n\n\t/**\n\t * Generates responseHeader\n\t * @private\n\t * @param {ChaosHandlerOptions} chaosHandlerOptions - The ChaosHandlerOptions object\n\t * @param {string} requestID - request id\n\t * @param {string} requestDate - date of the request\n\t * @returns response Header\n\t */\n\tprivate createResponseHeaders(chaosHandlerOptions: ChaosHandlerOptions, requestID: string, requestDate: string) {\n\t\tconst responseHeader: Headers = chaosHandlerOptions.headers ? new Headers(chaosHandlerOptions.headers) : new Headers();\n\t\tresponseHeader.append(\"Cache-Control\", \"no-store\");\n\t\tresponseHeader.append(\"request-id\", requestID);\n\t\tresponseHeader.append(\"client-request-id\", requestID);\n\t\tresponseHeader.append(\"x-ms-ags-diagnostic\", \"\");\n\t\tresponseHeader.append(\"Date\", requestDate);\n\t\tresponseHeader.append(\"Strict-Transport-Security\", \"\");\n\n\t\tif (chaosHandlerOptions.statusCode === 429) {\n\t\t\t// throttling case has to have a timeout scenario\n\t\t\tresponseHeader.append(\"retry-after\", \"3\");\n\t\t}\n\n\t\treturn responseHeader;\n\t}\n\n\t/**\n\t * Generates responseBody\n\t * @private\n\t * @param {ChaosHandlerOptions} chaosHandlerOptions - The ChaosHandlerOptions object\n\t * @param {string} requestID - request id\n\t * @param {string} requestDate - date of the request\n\t *  * @returns response body\n\t */\n\tprivate createResponseBody(chaosHandlerOptions: ChaosHandlerOptions, requestID: string, requestDate: string) {\n\t\tif (chaosHandlerOptions.responseBody) {\n\t\t\treturn chaosHandlerOptions.responseBody;\n\t\t}\n\t\tlet body: any;\n\t\tif (chaosHandlerOptions.statusCode >= 400) {\n\t\t\tconst codeMessage: string = httpStatusCode[chaosHandlerOptions.statusCode];\n\t\t\tconst errMessage: string = chaosHandlerOptions.statusMessage;\n\n\t\t\tbody = {\n\t\t\t\terror: {\n\t\t\t\t\tcode: codeMessage,\n\t\t\t\t\tmessage: errMessage,\n\t\t\t\t\tinnerError: {\n\t\t\t\t\t\t\"request-id\": requestID,\n\t\t\t\t\t\tdate: requestDate,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\t\t} else {\n\t\t\tbody = {};\n\t\t}\n\t\treturn body;\n\t}\n\n\t/**\n\t * creates a response\n\t * @private\n\t * @param {ChaosHandlerOptions} chaosHandlerOptions - The ChaosHandlerOptions object\n\t * @param {Context} context - Contains the context of the request\n\t */\n\tprivate createResponse(chaosHandlerOptions: ChaosHandlerOptions, context: Context) {\n\t\tconst requestURL = context.request as string;\n\t\tconst requestID = generateUUID();\n\t\tconst requestDate = new Date();\n\t\tconst responseHeader = this.createResponseHeaders(chaosHandlerOptions, requestID, requestDate.toString());\n\t\tconst responseBody = this.createResponseBody(chaosHandlerOptions, requestID, requestDate.toString());\n\t\tconst init: any = { url: requestURL, status: chaosHandlerOptions.statusCode, statusText: chaosHandlerOptions.statusMessage, headers: responseHeader };\n\t\tcontext.response = new Response(typeof responseBody === \"string\" ? responseBody : JSON.stringify(responseBody), init);\n\t}\n\n\t/**\n\t * Decides whether to send the request to the graph or not\n\t * @private\n\t * @param {ChaosHandlerOptions} chaosHandlerOptions - A ChaosHandlerOptions object\n\t * @param {Context} context - Contains the context of the request\n\t * @returns nothing\n\t */\n\tprivate async sendRequest(chaosHandlerOptions: ChaosHandlerOptions, context: Context): Promise<void> {\n\t\tthis.setStatusCode(chaosHandlerOptions, context.request as string, context.options.method as RequestMethod);\n\t\tif ((chaosHandlerOptions.chaosStrategy === ChaosStrategy.MANUAL && !this.nextMiddleware) || Math.floor(Math.random() * 100) < chaosHandlerOptions.chaosPercentage) {\n\t\t\tthis.createResponse(chaosHandlerOptions, context);\n\t\t} else if (this.nextMiddleware) {\n\t\t\tawait this.nextMiddleware.execute(context);\n\t\t}\n\t}\n\n\t/**\n\t * Fetches a random status code for the RANDOM mode from the predefined array\n\t * @private\n\t * @param {string} requestMethod - the API method for the request\n\t * @returns a random status code from a given set of status codes\n\t */\n\tprivate getRandomStatusCode(requestMethod: RequestMethod): number {\n\t\tconst statusCodeArray: number[] = methodStatusCode[requestMethod] as number[];\n\t\treturn statusCodeArray[Math.floor(Math.random() * statusCodeArray.length)];\n\t}\n\n\t/**\n\t * To fetch the relative URL out of the complete URL using a predefined regex pattern\n\t * @private\n\t * @param {string} urlMethod - the complete URL\n\t * @returns the string as relative URL\n\t */\n\tprivate getRelativeURL(urlMethod: string): string {\n\t\tconst pattern = /https?:\\/\\/graph\\.microsoft\\.com\\/[^/]+(.+?)(\\?|$)/;\n\t\tlet relativeURL: string;\n\t\tif (pattern.exec(urlMethod) !== null) {\n\t\t\trelativeURL = pattern.exec(urlMethod)[1];\n\t\t}\n\t\treturn relativeURL;\n\t}\n\n\t/**\n\t * To fetch the status code from the map(if needed), then returns response by calling createResponse\n\t * @private\n\t * @param {ChaosHandlerOptions} chaosHandlerOptions - The ChaosHandlerOptions object\n\t * @param {string} requestURL - the URL for the request\n\t * @param {string} requestMethod - the API method for the request\n\t */\n\tprivate setStatusCode(chaosHandlerOptions: ChaosHandlerOptions, requestURL: string, requestMethod: RequestMethod) {\n\t\tif (chaosHandlerOptions.chaosStrategy === ChaosStrategy.MANUAL) {\n\t\t\tif (chaosHandlerOptions.statusCode === undefined) {\n\t\t\t\t// manual mode with no status code, can be a global level or request level without statusCode\n\t\t\t\tconst relativeURL: string = this.getRelativeURL(requestURL);\n\t\t\t\tif (this.manualMap.get(relativeURL) !== undefined) {\n\t\t\t\t\t// checking Manual Map for exact match\n\t\t\t\t\tif (this.manualMap.get(relativeURL).get(requestMethod) !== undefined) {\n\t\t\t\t\t\tchaosHandlerOptions.statusCode = this.manualMap.get(relativeURL).get(requestMethod);\n\t\t\t\t\t}\n\t\t\t\t\t// else statusCode would be undefined\n\t\t\t\t} else {\n\t\t\t\t\t// checking for regex match if exact match doesn't work\n\t\t\t\t\tthis.manualMap.forEach((value: Map<string, number>, key: string) => {\n\t\t\t\t\t\tconst regexURL = new RegExp(key + \"$\");\n\t\t\t\t\t\tif (regexURL.test(relativeURL)) {\n\t\t\t\t\t\t\tif (this.manualMap.get(key).get(requestMethod) !== undefined) {\n\t\t\t\t\t\t\t\tchaosHandlerOptions.statusCode = this.manualMap.get(key).get(requestMethod);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// else statusCode would be undefined\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t// Case of redirection or request url not in map ---> statusCode would be undefined\n\t\t\t}\n\t\t} else {\n\t\t\t// Handling the case of Random here\n\t\t\tchaosHandlerOptions.statusCode = this.getRandomStatusCode(requestMethod);\n\t\t\t// else statusCode would be undefined\n\t\t}\n\t}\n\n\t/**\n\t * To get the options for execution of the middleware\n\t * @private\n\t * @param {Context} context - The context object\n\t * @returns options for middleware execution\n\t */\n\tprivate getOptions(context: Context): ChaosHandlerOptions {\n\t\tlet options: ChaosHandlerOptions;\n\t\tif (context.middlewareControl instanceof MiddlewareControl) {\n\t\t\toptions = context.middlewareControl.getMiddlewareOptions(ChaosHandlerOptions) as ChaosHandlerOptions;\n\t\t}\n\t\tif (typeof options === \"undefined\") {\n\t\t\toptions = Object.assign(new ChaosHandlerOptions(), this.options);\n\t\t}\n\n\t\treturn options;\n\t}\n\n\t/**\n\t * To execute the current middleware\n\t * @public\n\t * @async\n\t * @param {Context} context - The context object of the request\n\t * @returns A Promise that resolves to nothing\n\t */\n\tpublic async execute(context: Context): Promise<void> {\n\t\tconst chaosHandlerOptions: ChaosHandlerOptions = this.getOptions(context);\n\t\treturn await this.sendRequest(chaosHandlerOptions, context);\n\t}\n\n\t/**\n\t * @public\n\t * To set the next middleware in the chain\n\t * @param {Middleware} next - The middleware instance\n\t * @returns Nothing\n\t */\n\tpublic setNext(next: Middleware): void {\n\t\tthis.nextMiddleware = next;\n\t}\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @enum\n * Enum for ResponseType values\n * @property {string} ARRAYBUFFER - To download response content as an [ArrayBuffer]{@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer}\n * @property {string} BLOB - To download content as a [binary/blob] {@link https://developer.mozilla.org/en-US/docs/Web/API/Blob}\n * @property {string} DOCUMENT - This downloads content as a document or stream\n * @property {string} JSON - To download response content as a json\n * @property {string} STREAM - To download response as a [stream]{@link https://nodejs.org/api/stream.html}\n * @property {string} TEXT - For downloading response as a text\n */\n\nexport enum ResponseType {\n\tARRAYBUFFER = \"arraybuffer\",\n\tBLOB = \"blob\",\n\tDOCUMENT = \"document\",\n\tJSON = \"json\",\n\tRAW = \"raw\",\n\tSTREAM = \"stream\",\n\tTEXT = \"text\",\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module GraphResponseHandler\n * References - https://fetch.spec.whatwg.org/#responses\n */\n\nimport { GraphRequestCallback } from \"./IGraphRequestCallback\";\nimport { ResponseType } from \"./ResponseType\";\n\n/**\n * @enum\n * Enum for document types\n * @property {string} TEXT_HTML - The text/html content type\n * @property {string} TEXT_XML - The text/xml content type\n * @property {string} APPLICATION_XML - The application/xml content type\n * @property {string} APPLICATION_XHTML - The application/xhml+xml content type\n */\nexport enum DocumentType {\n\tTEXT_HTML = \"text/html\",\n\tTEXT_XML = \"text/xml\",\n\tAPPLICATION_XML = \"application/xml\",\n\tAPPLICATION_XHTML = \"application/xhtml+xml\",\n}\n\n/**\n * @enum\n * Enum for Content types\n * @property {string} TEXT_PLAIN - The text/plain content type\n * @property {string} APPLICATION_JSON - The application/json content type\n */\n\nenum ContentType {\n\tTEXT_PLAIN = \"text/plain\",\n\tAPPLICATION_JSON = \"application/json\",\n}\n\n/**\n * @enum\n * Enum for Content type regex\n * @property {string} DOCUMENT - The regex to match document content types\n * @property {string} IMAGE - The regex to match image content types\n */\nenum ContentTypeRegexStr {\n\tDOCUMENT = \"^(text\\\\/(html|xml))|(application\\\\/(xml|xhtml\\\\+xml))$\",\n\tIMAGE = \"^image\\\\/.+\",\n}\n\n/**\n * @class\n * Class for GraphResponseHandler\n */\n\nexport class GraphResponseHandler {\n\t/**\n\t * @private\n\t * @static\n\t * To parse Document response\n\t * @param {Response} rawResponse - The response object\n\t * @param {DocumentType} type - The type to which the document needs to be parsed\n\t * @returns A promise that resolves to a document content\n\t */\n\tprivate static parseDocumentResponse(rawResponse: Response, type: DocumentType): Promise<any> {\n\t\tif (typeof DOMParser !== \"undefined\") {\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\trawResponse.text().then((xmlString) => {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst parser = new DOMParser();\n\t\t\t\t\t\tconst xmlDoc = parser.parseFromString(xmlString, type);\n\t\t\t\t\t\tresolve(xmlDoc);\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\treject(error);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t} else {\n\t\t\treturn Promise.resolve(rawResponse.body);\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t * @static\n\t * @async\n\t * To convert the native Response to response content\n\t * @param {Response} rawResponse - The response object\n\t * @param {ResponseType} [responseType] - The response type value\n\t * @returns A promise that resolves to the converted response content\n\t */\n\tprivate static async convertResponse(rawResponse: Response, responseType?: ResponseType): Promise<any> {\n\t\tif (rawResponse.status === 204) {\n\t\t\t// NO CONTENT\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\tlet responseValue: any;\n\t\tconst contentType = rawResponse.headers.get(\"Content-type\");\n\t\tswitch (responseType) {\n\t\t\tcase ResponseType.ARRAYBUFFER:\n\t\t\t\tresponseValue = await rawResponse.arrayBuffer();\n\t\t\t\tbreak;\n\t\t\tcase ResponseType.BLOB:\n\t\t\t\tresponseValue = await rawResponse.blob();\n\t\t\t\tbreak;\n\t\t\tcase ResponseType.DOCUMENT:\n\t\t\t\tresponseValue = await GraphResponseHandler.parseDocumentResponse(rawResponse, DocumentType.TEXT_XML);\n\t\t\t\tbreak;\n\t\t\tcase ResponseType.JSON:\n\t\t\t\tresponseValue = await rawResponse.json();\n\t\t\t\tbreak;\n\t\t\tcase ResponseType.STREAM:\n\t\t\t\tresponseValue = await Promise.resolve(rawResponse.body);\n\t\t\t\tbreak;\n\t\t\tcase ResponseType.TEXT:\n\t\t\t\tresponseValue = await rawResponse.text();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tif (contentType !== null) {\n\t\t\t\t\tconst mimeType = contentType.split(\";\")[0];\n\t\t\t\t\tif (new RegExp(ContentTypeRegexStr.DOCUMENT).test(mimeType)) {\n\t\t\t\t\t\tresponseValue = await GraphResponseHandler.parseDocumentResponse(rawResponse, mimeType as DocumentType);\n\t\t\t\t\t} else if (new RegExp(ContentTypeRegexStr.IMAGE).test(mimeType)) {\n\t\t\t\t\t\tresponseValue = rawResponse.blob();\n\t\t\t\t\t} else if (mimeType === ContentType.TEXT_PLAIN) {\n\t\t\t\t\t\tresponseValue = await rawResponse.text();\n\t\t\t\t\t} else if (mimeType === ContentType.APPLICATION_JSON) {\n\t\t\t\t\t\tresponseValue = await rawResponse.json();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresponseValue = Promise.resolve(rawResponse.body);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t/**\n\t\t\t\t\t * RFC specification {@link https://tools.ietf.org/html/rfc7231#section-3.1.1.5} says:\n\t\t\t\t\t *  A sender that generates a message containing a payload body SHOULD\n\t\t\t\t\t *  generate a Content-Type header field in that message unless the\n\t\t\t\t\t *  intended media type of the enclosed representation is unknown to the\n\t\t\t\t\t *  sender.  If a Content-Type header field is not present, the recipient\n\t\t\t\t\t *  MAY either assume a media type of \"application/octet-stream\"\n\t\t\t\t\t *  ([RFC2046], Section 4.5.1) or examine the data to determine its type.\n\t\t\t\t\t *\n\t\t\t\t\t *  So assuming it as a stream type so returning the body.\n\t\t\t\t\t */\n\t\t\t\t\tresponseValue = Promise.resolve(rawResponse.body);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t\treturn responseValue;\n\t}\n\n\t/**\n\t * @public\n\t * @static\n\t * @async\n\t * To get the parsed response\n\t * @param {Response} rawResponse - The response object\n\t * @param {ResponseType} [responseType] - The response type value\n\t * @param {GraphRequestCallback} [callback] - The graph request callback function\n\t * @returns The parsed response\n\t */\n\tpublic static async getResponse(rawResponse: Response, responseType?: ResponseType, callback?: GraphRequestCallback): Promise<any> {\n\t\tif (responseType === ResponseType.RAW) {\n\t\t\treturn Promise.resolve(rawResponse);\n\t\t} else {\n\t\t\tconst response = await GraphResponseHandler.convertResponse(rawResponse, responseType);\n\t\t\tif (rawResponse.ok) {\n\t\t\t\t// Status Code 2XX\n\t\t\t\tif (typeof callback === \"function\") {\n\t\t\t\t\tcallback(null, response);\n\t\t\t\t} else {\n\t\t\t\t\treturn response;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// NOT OK Response\n\t\t\t\tthrow response;\n\t\t\t}\n\t\t}\n\t}\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module Range\n */\n\n/**\n * @class\n * Class representing Range\n */\nexport class Range {\n\t/**\n\t * @public\n\t * The minimum value of the range\n\t */\n\tpublic minValue: number;\n\n\t/**\n\t * @public\n\t * The maximum value of the range\n\t */\n\tpublic maxValue: number;\n\n\t/**\n\t * @public\n\t * @constructor\n\t * Creates a range for given min and max values\n\t * @param {number} [minVal = -1] - The minimum value.\n\t * @param {number} [maxVal = -1] - The maximum value.\n\t * @returns An instance of a Range\n\t */\n\tpublic constructor(minVal = -1, maxVal = -1) {\n\t\tthis.minValue = minVal;\n\t\tthis.maxValue = maxVal;\n\t}\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * Class representing a successful file upload result\n */\nexport class UploadResult {\n\t/**\n\t * @private\n\t * Location value looked up in the response header\n\t */\n\tprivate _location: string;\n\n\t/**\n\t * @private\n\t * Response body of the final raw response\n\t */\n\tprivate _responseBody: unknown;\n\n\t/**\n\t * @public\n\t * Get of the location value.\n\t * Location value is looked up in the response header\n\t */\n\tpublic get location(): string {\n\t\treturn this._location;\n\t}\n\n\t/**\n\t * @public\n\t * Set the location value\n\t * Location value is looked up in the response header\n\t */\n\tpublic set location(location: string) {\n\t\tthis._location = location;\n\t}\n\n\t/**\n\t * @public\n\t * Get The response body from the completed upload response\n\t */\n\tpublic get responseBody() {\n\t\treturn this._responseBody;\n\t}\n\n\t/**\n\t * @public\n\t * Set the response body from the completed upload response\n\t */\n\tpublic set responseBody(responseBody: unknown) {\n\t\tthis._responseBody = responseBody;\n\t}\n\n\t/**\n\t * @public\n\t * @param {responseBody} responsebody - The response body from the completed upload response\n\t * @param {location} location - The location value from the headers from the completed upload response\n\t */\n\tpublic constructor(responseBody: unknown, location: string) {\n\t\t// Response body or the location parameter can be undefined.\n\t\tthis._location = location;\n\t\tthis._responseBody = responseBody;\n\t}\n\n\t/**\n\t * @public\n\t * @param {responseBody} responseBody - The response body from the completed upload response\n\t * @param {responseHeaders} responseHeaders - The headers from the completed upload response\n\t */\n\tpublic static CreateUploadResult(responseBody?: unknown, responseHeaders?: Headers) {\n\t\treturn new UploadResult(responseBody, responseHeaders.get(\"location\"));\n\t}\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module LargeFileUploadTask\n */\n\nimport { GraphClientError } from \"../GraphClientError\";\nimport { GraphResponseHandler } from \"../GraphResponseHandler\";\nimport { Client } from \"../index\";\nimport { ResponseType } from \"../ResponseType\";\nimport { UploadEventHandlers } from \"./FileUploadTask/Interfaces/IUploadEventHandlers\";\nimport { Range } from \"./FileUploadTask/Range\";\nimport { UploadResult } from \"./FileUploadTask/UploadResult\";\n\n/**\n * @interface\n * Signature to representing key value pairs\n * @property {[key: string] : string | number} - The Key value pair\n */\ninterface KeyValuePairObjectStringNumber {\n\t[key: string]: string | number;\n}\n\n/**\n * @interface\n * Signature to represent the resulting response in the status enquiry request\n * @property {string} expirationDateTime - The expiration time of the upload session\n * @property {string[]} nextExpectedRanges - The ranges expected in next consecutive request in the upload\n */\ninterface UploadStatusResponse {\n\texpirationDateTime: string;\n\tnextExpectedRanges: string[];\n}\n\n/**\n * @interface\n * Signature to define options for upload task\n * @property {number} [rangeSize = LargeFileUploadTask.DEFAULT_FILE_SIZE] - Specifies the range chunk size\n * @property {UploadEventHandlers} uploadEventHandlers - UploadEventHandlers attached to an upload task\n */\nexport interface LargeFileUploadTaskOptions {\n\trangeSize?: number;\n\tuploadEventHandlers?: UploadEventHandlers;\n}\n\n/**\n * @interface\n * Signature to represent upload session resulting from the session creation in the server\n * @property {string} url - The URL to which the file upload is made\n * @property {Date} expiry - The expiration of the time of the upload session\n */\nexport interface LargeFileUploadSession {\n\turl: string;\n\texpiry: Date;\n\tisCancelled?: boolean;\n}\n\n/**\n * @type\n * Representing the return type of the sliceFile function that is type of the slice of a given range.\n */\nexport type SliceType = ArrayBuffer | Blob | Uint8Array;\n\n/**\n * @interface\n * Signature to define the properties and content of the file in upload task\n * @property {ArrayBuffer | File} content - The actual file content\n * @property {string} name - Specifies the file name with extension\n * @property {number} size - Specifies size of the file\n */\nexport interface FileObject<T> {\n\tcontent: T;\n\tname: string;\n\tsize: number;\n\tsliceFile(range: Range): SliceType | Promise<SliceType>;\n}\n\n/**\n * @class\n * Class representing LargeFileUploadTask\n */\nexport class LargeFileUploadTask<T> {\n\t/**\n\t * @private\n\t * Default value for the rangeSize\n\t */\n\tprivate DEFAULT_FILE_SIZE: number = 5 * 1024 * 1024;\n\n\t/**\n\t * @protected\n\t * The GraphClient instance\n\t */\n\tprotected client: Client;\n\n\t/**\n\t * @protected\n\t * The object holding file details\n\t */\n\tprotected file: FileObject<T>;\n\n\t/**\n\t * @protected\n\t * The object holding options for the task\n\t */\n\tprotected options: LargeFileUploadTaskOptions;\n\n\t/**\n\t * @protected\n\t * The object for upload session\n\t */\n\tprotected uploadSession: LargeFileUploadSession;\n\n\t/**\n\t * @protected\n\t * The next range needs to be uploaded\n\t */\n\tprotected nextRange: Range;\n\n\t/**\n\t * @public\n\t * @static\n\t * @async\n\t * Makes request to the server to create an upload session\n\t * @param {Client} client - The GraphClient instance\n\t * @param {string} requestUrl - The URL to create the upload session\n\t * @param {any} payload - The payload that needs to be sent\n\t * @param {KeyValuePairObjectStringNumber} headers - The headers that needs to be sent\n\t * @returns The promise that resolves to LargeFileUploadSession\n\t */\n\tpublic static async createUploadSession(client: Client, requestUrl: string, payload: any, headers: KeyValuePairObjectStringNumber = {}): Promise<LargeFileUploadSession> {\n\t\tconst session = await client\n\t\t\t.api(requestUrl)\n\t\t\t.headers(headers)\n\t\t\t.post(payload);\n\t\tconst largeFileUploadSession: LargeFileUploadSession = {\n\t\t\turl: session.uploadUrl,\n\t\t\texpiry: new Date(session.expirationDateTime),\n\t\t\tisCancelled: false,\n\t\t};\n\t\treturn largeFileUploadSession;\n\t}\n\n\t/**\n\t * @public\n\t * @constructor\n\t * Constructs a LargeFileUploadTask\n\t * @param {Client} client - The GraphClient instance\n\t * @param {FileObject} file - The FileObject holding details of a file that needs to be uploaded\n\t * @param {LargeFileUploadSession} uploadSession - The upload session to which the upload has to be done\n\t * @param {LargeFileUploadTaskOptions} options - The upload task options\n\t * @returns An instance of LargeFileUploadTask\n\t */\n\tpublic constructor(client: Client, file: FileObject<T>, uploadSession: LargeFileUploadSession, options: LargeFileUploadTaskOptions = {}) {\n\t\tthis.client = client;\n\n\t\tif (!file.sliceFile) {\n\t\t\tthrow new GraphClientError(\"Please pass the FileUpload object, StreamUpload object or any custom implementation of the FileObject interface\");\n\t\t} else {\n\t\t\tthis.file = file;\n\t\t}\n\t\tthis.file = file;\n\t\tif (!options.rangeSize) {\n\t\t\toptions.rangeSize = this.DEFAULT_FILE_SIZE;\n\t\t}\n\n\t\tthis.options = options;\n\t\tthis.uploadSession = uploadSession;\n\t\tthis.nextRange = new Range(0, this.options.rangeSize - 1);\n\t}\n\n\t/**\n\t * @private\n\t * Parses given range string to the Range instance\n\t * @param {string[]} ranges - The ranges value\n\t * @returns The range instance\n\t */\n\tprivate parseRange(ranges: string[]): Range {\n\t\tconst rangeStr = ranges[0];\n\t\tif (typeof rangeStr === \"undefined\" || rangeStr === \"\") {\n\t\t\treturn new Range();\n\t\t}\n\t\tconst firstRange = rangeStr.split(\"-\");\n\t\tconst minVal = parseInt(firstRange[0], 10);\n\t\tlet maxVal = parseInt(firstRange[1], 10);\n\t\tif (Number.isNaN(maxVal)) {\n\t\t\tmaxVal = this.file.size - 1;\n\t\t}\n\t\treturn new Range(minVal, maxVal);\n\t}\n\n\t/**\n\t * @private\n\t * Updates the expiration date and the next range\n\t * @param {UploadStatusResponse} response - The response of the upload status\n\t * @returns Nothing\n\t */\n\tprivate updateTaskStatus(response: UploadStatusResponse): void {\n\t\tthis.uploadSession.expiry = new Date(response.expirationDateTime);\n\t\tthis.nextRange = this.parseRange(response.nextExpectedRanges);\n\t}\n\n\t/**\n\t * @public\n\t * Gets next range that needs to be uploaded\n\t * @returns The range instance\n\t */\n\tpublic getNextRange(): Range {\n\t\tif (this.nextRange.minValue === -1) {\n\t\t\treturn this.nextRange;\n\t\t}\n\t\tconst minVal = this.nextRange.minValue;\n\t\tlet maxValue = minVal + this.options.rangeSize - 1;\n\t\tif (maxValue >= this.file.size) {\n\t\t\tmaxValue = this.file.size - 1;\n\t\t}\n\t\treturn new Range(minVal, maxValue);\n\t}\n\n\t/**\n\t * @deprecated This function has been moved into FileObject interface.\n\t * @public\n\t * Slices the file content to the given range\n\t * @param {Range} range - The range value\n\t * @returns The sliced ArrayBuffer or Blob\n\t */\n\tpublic sliceFile(range: Range): ArrayBuffer | Blob {\n\t\tconsole.warn(\"The LargeFileUploadTask.sliceFile() function has been deprecated and moved into the FileObject interface.\");\n\t\tif (this.file.content instanceof ArrayBuffer || this.file.content instanceof Blob || this.file.content instanceof Uint8Array) {\n\t\t\treturn this.file.content.slice(range.minValue, range.maxValue + 1);\n\t\t}\n\t\tthrow new GraphClientError(\"The LargeFileUploadTask.sliceFile() function expects only Blob, ArrayBuffer or Uint8Array file content. Please note that the sliceFile() function is deprecated.\");\n\t}\n\n\t/**\n\t * @public\n\t * @async\n\t * Uploads file to the server in a sequential order by slicing the file\n\t * @returns The promise resolves to uploaded response\n\t */\n\tpublic async upload(): Promise<UploadResult> {\n\t\tconst uploadEventHandlers = this.options && this.options.uploadEventHandlers;\n\t\twhile (!this.uploadSession.isCancelled) {\n\t\t\tconst nextRange = this.getNextRange();\n\t\t\tif (nextRange.maxValue === -1) {\n\t\t\t\tconst err = new Error(\"Task with which you are trying to upload is already completed, Please check for your uploaded file\");\n\t\t\t\terr.name = \"Invalid Session\";\n\t\t\t\tthrow err;\n\t\t\t}\n\t\t\tconst fileSlice = await this.file.sliceFile(nextRange);\n\t\t\tconst rawResponse = await this.uploadSliceGetRawResponse(fileSlice, nextRange, this.file.size);\n\t\t\tif (!rawResponse) {\n\t\t\t\tthrow new GraphClientError(\"Something went wrong! Large file upload slice response is null.\");\n\t\t\t}\n\n\t\t\tconst responseBody = await GraphResponseHandler.getResponse(rawResponse);\n\t\t\t/**\n\t\t\t * (rawResponse.status === 201) -> This condition is applicable for OneDrive, PrintDocument and Outlook APIs.\n\t\t\t * (rawResponse.status === 200 && responseBody.id) -> This additional condition is applicable only for OneDrive API.\n\t\t\t */\n\t\t\tif (rawResponse.status === 201 || (rawResponse.status === 200 && responseBody.id)) {\n\t\t\t\tthis.reportProgress(uploadEventHandlers, nextRange);\n\t\t\t\treturn UploadResult.CreateUploadResult(responseBody, rawResponse.headers);\n\t\t\t}\n\n\t\t\t/* Handling the API issue where the case of Outlook upload response property -'nextExpectedRanges'  is not uniform.\n\t\t\t * https://github.com/microsoftgraph/msgraph-sdk-serviceissues/issues/39\n\t\t\t */\n\t\t\tconst res: UploadStatusResponse = {\n\t\t\t\texpirationDateTime: responseBody.expirationDateTime || responseBody.ExpirationDateTime,\n\t\t\t\tnextExpectedRanges: responseBody.NextExpectedRanges || responseBody.nextExpectedRanges,\n\t\t\t};\n\t\t\tthis.updateTaskStatus(res);\n\t\t\tthis.reportProgress(uploadEventHandlers, nextRange);\n\t\t}\n\t}\n\n\tprivate reportProgress(uploadEventHandlers: UploadEventHandlers, nextRange: Range) {\n\t\tif (uploadEventHandlers && uploadEventHandlers.progress) {\n\t\t\tuploadEventHandlers.progress(nextRange, uploadEventHandlers.extraCallbackParam);\n\t\t}\n\t}\n\n\t/**\n\t * @public\n\t * @async\n\t * Uploads given slice to the server\n\t * @param {ArrayBuffer | Blob | File} fileSlice - The file slice\n\t * @param {Range} range - The range value\n\t * @param {number} totalSize - The total size of a complete file\n\t * @returns The response body of the upload slice result\n\t */\n\tpublic async uploadSlice(fileSlice: ArrayBuffer | Blob | File, range: Range, totalSize: number): Promise<unknown> {\n\t\treturn await this.client\n\t\t\t.api(this.uploadSession.url)\n\t\t\t.headers({\n\t\t\t\t\"Content-Length\": `${range.maxValue - range.minValue + 1}`,\n\t\t\t\t\"Content-Range\": `bytes ${range.minValue}-${range.maxValue}/${totalSize}`,\n\t\t\t\t\"Content-Type\": \"application/octet-stream\",\n\t\t\t})\n\t\t\t.put(fileSlice);\n\t}\n\n\t/**\n\t * @public\n\t * @async\n\t * Uploads given slice to the server\n\t * @param {unknown} fileSlice - The file slice\n\t * @param {Range} range - The range value\n\t * @param {number} totalSize - The total size of a complete file\n\t * @returns The raw response of the upload slice result\n\t */\n\tpublic async uploadSliceGetRawResponse(fileSlice: unknown, range: Range, totalSize: number): Promise<Response> {\n\t\treturn await this.client\n\t\t\t.api(this.uploadSession.url)\n\t\t\t.headers({\n\t\t\t\t\"Content-Length\": `${range.maxValue - range.minValue + 1}`,\n\t\t\t\t\"Content-Range\": `bytes ${range.minValue}-${range.maxValue}/${totalSize}`,\n\t\t\t\t\"Content-Type\": \"application/octet-stream\",\n\t\t\t})\n\t\t\t.responseType(ResponseType.RAW)\n\t\t\t.put(fileSlice);\n\t}\n\n\t/**\n\t * @public\n\t * @async\n\t * Deletes upload session in the server\n\t * @returns The promise resolves to cancelled response\n\t */\n\tpublic async cancel(): Promise<unknown> {\n\t\tconst cancelResponse = await this.client\n\t\t\t.api(this.uploadSession.url)\n\t\t\t.responseType(ResponseType.RAW)\n\t\t\t.delete();\n\t\tif (cancelResponse.status === 204) {\n\t\t\tthis.uploadSession.isCancelled = true;\n\t\t}\n\t\treturn cancelResponse;\n\t}\n\n\t/**\n\t * @public\n\t * @async\n\t * Gets status for the upload session\n\t * @returns The promise resolves to the status enquiry response\n\t */\n\tpublic async getStatus(): Promise<unknown> {\n\t\tconst response = await this.client.api(this.uploadSession.url).get();\n\t\tthis.updateTaskStatus(response);\n\t\treturn response;\n\t}\n\n\t/**\n\t * @public\n\t * @async\n\t * Resumes upload session and continue uploading the file from the last sent range\n\t * @returns The promise resolves to the uploaded response\n\t */\n\tpublic async resume(): Promise<unknown> {\n\t\tawait this.getStatus();\n\t\treturn await this.upload();\n\t}\n\n\t/**\n\t * @public\n\t * @async\n\t * Get the upload session information\n\t * @returns The large file upload session\n\t */\n\tpublic getUploadSession(): LargeFileUploadSession {\n\t\treturn this.uploadSession;\n\t}\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { GraphClientError } from \"../../../GraphClientError\";\nimport { FileObject, SliceType } from \"../../LargeFileUploadTask\";\nimport { Range } from \"../Range\";\n\n/**\n * @class\n * Class used for creating LargeFileUploadTask fileobject.\n * This class accepts files of type ArrayBuffer, Blob, Uint8Array.\n */\nexport class FileUpload implements FileObject<SliceType> {\n\t/**\n\t * @public\n\t * @constructor\n\t * @param {ArrayBuffer | Blob | Uint8Array} content - The file to be uploaded\n\t * @param {string} name - The name of the file to be uploaded\n\t * @param {number} size - The total size of the file to be uploaded\n\t * @returns An instance of the FileUpload class\n\t */\n\tpublic constructor(public content: ArrayBuffer | Blob | Uint8Array, public name: string, public size: number) {\n\t\tif (!content || !name || !size) {\n\t\t\tthrow new GraphClientError(\"Please provide the upload content, name of the file and size of the file\");\n\t\t}\n\t}\n\n\t/**\n\t * @public\n\t * Slices the file content to the given range\n\t * @param {Range} range - The range value\n\t * @returns The sliced file part\n\t */\n\tpublic sliceFile(range: Range): ArrayBuffer | Blob | Uint8Array {\n\t\treturn this.content.slice(range.minValue, range.maxValue + 1);\n\t}\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module OneDriveLargeFileUploadTaskUtil\n */\n\n/**\n * @constant\n * Default value for the rangeSize\n * Recommended size is between 5 - 10 MB {@link https://developer.microsoft.com/en-us/graph/docs/api-reference/v1.0/api/driveitem_createuploadsession#best-practices}\n */\nconst DEFAULT_FILE_SIZE: number = 5 * 1024 * 1024;\n\n/**\n * @constant\n * Rounds off the given value to a multiple of 320 KB\n * @param {number} value - The value\n * @returns The rounded off value\n */\nconst roundTo320KB = (value: number): number => {\n\tif (value > 320 * 1024) {\n\t\tvalue = Math.floor(value / (320 * 1024)) * 320 * 1024;\n\t}\n\treturn value;\n};\n\n/**\n * @constant\n * Get the valid rangeSize for a file slicing (validity is based on the constrains mentioned in here\n * {@link https://developer.microsoft.com/en-us/graph/docs/api-reference/v1.0/api/driveitem_createuploadsession#upload-bytes-to-the-upload-session})\n *\n * @param {number} [rangeSize = DEFAULT_FILE_SIZE] - The rangeSize value.\n * @returns The valid rangeSize\n */\nexport const getValidRangeSize = (rangeSize: number = DEFAULT_FILE_SIZE): number => {\n\tconst sixtyMB = 60 * 1024 * 1024;\n\tif (rangeSize > sixtyMB) {\n\t\trangeSize = sixtyMB;\n\t}\n\treturn roundTo320KB(rangeSize);\n};\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module OneDriveLargeFileUploadTask\n */\n\nimport { GraphClientError } from \"../GraphClientError\";\nimport { Client } from \"../index\";\nimport { FileUpload } from \"./FileUploadTask/FileObjectClasses/FileUpload\";\nimport { UploadEventHandlers } from \"./FileUploadTask/Interfaces/IUploadEventHandlers\";\nimport { FileObject, LargeFileUploadSession, LargeFileUploadTask, LargeFileUploadTaskOptions } from \"./LargeFileUploadTask\";\nimport { getValidRangeSize } from \"./OneDriveLargeFileUploadTaskUtil\";\n\n/**\n * @interface\n * Signature to define options when creating an upload task\n * @property {string} fileName - Specifies the name of a file to be uploaded (with extension)\n * @property {string} [fileDescription] - Specifies the description of the file to be uploaded\n * @property {string} [path] - The path to which the file needs to be uploaded\n * @property {number} [rangeSize] - Specifies the range chunk size\n * @property {string} [conflictBehavior] - Conflict behaviour option\n * @property {UploadEventHandlers} [uploadEventHandlers] - UploadEventHandlers attached to an upload task\n */\nexport interface OneDriveLargeFileUploadOptions {\n\tfileName: string;\n\tfileDescription?: string;\n\tpath?: string;\n\trangeSize?: number;\n\tconflictBehavior?: string;\n\tuploadEventHandlers?: UploadEventHandlers;\n    /// <summary>\n    /// Default upload session url is : \"/me/drive/root:/{file-path}:/createUploadSession\"\n    /// Set this property to override the default upload session url. Example: \"/me/drive/special/{name}\"\n    /// </summary>\n    uploadSessionURL?: string;\n}\n\n/**\n * @interface\n * Signature to define options when creating an upload task\n * @property {string} fileName - Specifies the name of a file to be uploaded (with extension)\n * @property {string} [fileDescription] - Specifies the description of the file to be uploaded\n * @property {string} [conflictBehavior] - Conflict behaviour option\n */\ninterface OneDriveFileUploadSessionPayLoad {\n\tfileName: string;\n\tfileDescription?: string;\n\tconflictBehavior?: string;\n}\n\n/**\n * @interface\n * Signature to define the file information when processing an upload task\n * @property {File | Uint8Array} content - The file content\n * @property {number} size - The size of file\n */\ninterface FileInfo {\n\tcontent: File | Uint8Array;\n\tsize: number;\n}\n\n/**\n * @class\n * Class representing OneDriveLargeFileUploadTask\n */\nexport class OneDriveLargeFileUploadTask<T> extends LargeFileUploadTask<T> {\n\t/**\n\t * @private\n\t * @static\n\t * Default path for the file being uploaded\n\t */\n\tprivate static DEFAULT_UPLOAD_PATH = \"/\";\n\n\t/**\n\t * @private\n\t * @static\n\t * Constructs the create session url for Onedrive\n\t * @param {string} fileName - The name of the file\n\t * @param {path} [path = OneDriveLargeFileUploadTask.DEFAULT_UPLOAD_PATH] - The path for the upload\n\t * @returns The constructed create session url\n\t */\n\tprivate static constructCreateSessionUrl(fileName: string, path: string = OneDriveLargeFileUploadTask.DEFAULT_UPLOAD_PATH): string {\n\t\tfileName = fileName.trim();\n\t\tpath = path.trim();\n\t\tif (path === \"\") {\n\t\t\tpath = \"/\";\n\t\t}\n\t\tif (path[0] !== \"/\") {\n\t\t\tpath = `/${path}`;\n\t\t}\n\t\tif (path[path.length - 1] !== \"/\") {\n\t\t\tpath = `${path}/`;\n\t\t}\n\t\t// we choose to encode each component of the file path separately because when encoding full URI\n\t\t// with encodeURI, special characters like # or % in the file name doesn't get encoded as desired\n\t\treturn `/me/drive/root:${path\n\t\t\t.split(\"/\")\n\t\t\t.map((p) => encodeURIComponent(p))\n\t\t\t.join(\"/\")}${encodeURIComponent(fileName)}:/createUploadSession`;\n\t}\n\n\t/**\n\t * @private\n\t * @static\n\t * Get file information\n\t * @param {Blob | Uint8Array | File} file - The file entity\n\t * @param {string} fileName - The file name\n\t * @returns {FileInfo} The file information\n\t */\n\tprivate static getFileInfo(file: Blob | Uint8Array | File, fileName: string): FileInfo {\n\t\tlet content;\n\t\tlet size;\n\t\tif (typeof Blob !== \"undefined\" && file instanceof Blob) {\n\t\t\tcontent = new File([file as Blob], fileName);\n\t\t\tsize = content.size;\n\t\t} else if (typeof File !== \"undefined\" && file instanceof File) {\n\t\t\tcontent = file as File;\n\t\t\tsize = content.size;\n\t\t} else if (typeof Uint8Array !== \"undefined\" && file instanceof Uint8Array) {\n\t\t\tconst b = file as Uint8Array;\n\t\t\tsize = b.byteLength;\n\t\t\tcontent = b.buffer.slice(b.byteOffset, b.byteOffset + b.byteLength);\n\t\t}\n\t\treturn {\n\t\t\tcontent,\n\t\t\tsize,\n\t\t};\n\t}\n\n\t/**\n\t * @public\n\t * @static\n\t * @async\n\t * Creates a OneDriveLargeFileUploadTask\n\t * @param {Client} client - The GraphClient instance\n\t * @param {Blob | Uint8Array | File} file - File represented as Blob, Uint8Array or File\n\t * @param {OneDriveLargeFileUploadOptions} options - The options for upload task\n\t * @returns The promise that will be resolves to OneDriveLargeFileUploadTask instance\n\t */\n\tpublic static async create(client: Client, file: Blob | Uint8Array | File, options: OneDriveLargeFileUploadOptions): Promise<OneDriveLargeFileUploadTask<Blob | ArrayBuffer | Uint8Array>> {\n\t\tif (!client || !file || !options) {\n\t\t\tthrow new GraphClientError(\"Please provide the Graph client instance, file object and OneDriveLargeFileUploadOptions value\");\n\t\t}\n\t\tconst fileName = options.fileName;\n\t\tconst fileInfo = OneDriveLargeFileUploadTask.getFileInfo(file, fileName);\n\t\tconst fileObj = new FileUpload(fileInfo.content, fileName, fileInfo.size);\n\t\treturn this.createTaskWithFileObject<Blob | ArrayBuffer | Uint8Array>(client, fileObj, options);\n\t}\n\n\t/**\n\t * @public\n\t * @static\n\t * @async\n\t * Creates a OneDriveLargeFileUploadTask\n\t * @param {Client} client - The GraphClient instance\n\t * @param {FileObject} fileObject - FileObject instance\n\t * @param {OneDriveLargeFileUploadOptions} options - The options for upload task\n\t * @returns The promise that will be resolves to OneDriveLargeFileUploadTask instance\n\t */\n\tpublic static async createTaskWithFileObject<T>(client: Client, fileObject: FileObject<T>, options: OneDriveLargeFileUploadOptions): Promise<OneDriveLargeFileUploadTask<T>> {\n\t\tif (!client || !fileObject || !options) {\n\t\t\tthrow new GraphClientError(\"Please provide the Graph client instance, FileObject interface implementation and OneDriveLargeFileUploadOptions value\");\n\t\t}\n\t\tconst requestUrl = options.uploadSessionURL ? options.uploadSessionURL: OneDriveLargeFileUploadTask.constructCreateSessionUrl(options.fileName, options.path);\n\t\tconst uploadSessionPayload: OneDriveFileUploadSessionPayLoad = {\n\t\t\tfileName: options.fileName,\n\t\t\tfileDescription: options.fileDescription,\n\t\t\tconflictBehavior: options.conflictBehavior,\n\t\t};\n\t\tconst session = await OneDriveLargeFileUploadTask.createUploadSession(client, requestUrl, uploadSessionPayload);\n\t\tconst rangeSize = getValidRangeSize(options.rangeSize);\n\t\treturn new OneDriveLargeFileUploadTask(client, fileObject, session, {\n\t\t\trangeSize,\n\t\t\tuploadEventHandlers: options.uploadEventHandlers,\n\t\t});\n\t}\n\n\t/**\n\t * @public\n\t * @static\n\t * @async\n\t * Makes request to the server to create an upload session\n\t * @param {Client} client - The GraphClient instance\n\t * @param {string} requestUrl - The URL to create the upload session\n\t * @param {string} payloadOptions - The payload option. Default conflictBehavior is 'rename'\n\t * @returns The promise that resolves to LargeFileUploadSession\n\t */\n\tpublic static async createUploadSession(client: Client, requestUrl: string, payloadOptions: OneDriveFileUploadSessionPayLoad): Promise<LargeFileUploadSession> {\n\t\tconst payload = {\n\t\t\titem: {\n\t\t\t\t\"@microsoft.graph.conflictBehavior\": payloadOptions?.conflictBehavior || \"rename\",\n\t\t\t\tname: payloadOptions?.fileName,\n\t\t\t\tdescription: payloadOptions?.fileDescription,\n\t\t\t},\n\t\t};\n\t\treturn super.createUploadSession(client, requestUrl, payload);\n\t}\n\n\t/**\n\t * @public\n\t * @constructor\n\t * Constructs a OneDriveLargeFileUploadTask\n\t * @param {Client} client - The GraphClient instance\n\t * @param {FileObject} file - The FileObject holding details of a file that needs to be uploaded\n\t * @param {LargeFileUploadSession} uploadSession - The upload session to which the upload has to be done\n\t * @param {LargeFileUploadTaskOptions} options - The upload task options\n\t * @returns An instance of OneDriveLargeFileUploadTask\n\t */\n\tpublic constructor(client: Client, file: FileObject<T>, uploadSession: LargeFileUploadSession, options: LargeFileUploadTaskOptions) {\n\t\tsuper(client, file, uploadSession, options);\n\t}\n\n\t/**\n\t * @public\n\t * Commits upload session to end uploading\n\t * @param {string} requestUrl - The URL to commit the upload session\n\t * @param {string} conflictBehavior - Conflict behaviour option. Default is 'rename'\n\t * @returns The promise resolves to committed response\n\t */\n\tpublic async commit(requestUrl: string, conflictBehavior = \"rename\"): Promise<unknown> {\n\t\tconst payload = {\n\t\t\tname: this.file.name,\n\t\t\t\"@microsoft.graph.conflictBehavior\": conflictBehavior,\n\t\t\t\"@microsoft.graph.sourceUrl\": this.uploadSession.url,\n\t\t};\n\t\treturn await this.client.api(requestUrl).put(payload);\n\t}\n}\n", "import { GraphClientError } from \"../../../GraphClientError\";\nimport { FileObject, SliceType } from \"../../LargeFileUploadTask\";\nimport { Range } from \"../Range\";\n\n/**\n * @interface\n * Interface to store slice of a stream and range of the slice.\n * @property {Buffer} fileSlice - The slice of the stream\n * @property {Range} range - The range of the slice\n */\ninterface SliceRecord {\n\tfileSlice: Buffer;\n\trange: Range;\n}\n\n/**\n * @class\n * FileObject class for Readable Stream upload\n */\nexport class StreamUpload implements FileObject<NodeStream> {\n\t/**\n\t * @private\n\t * Represents a cache of the last attempted upload slice.\n\t * This can be used when resuming a previously failed slice upload.\n\t */\n\tprivate previousSlice: SliceRecord;\n\n\tpublic constructor(public content: NodeStream, public name: string, public size: number) {\n\t\tif (!content || !name || !size) {\n\t\t\tthrow new GraphClientError(\"Please provide the Readable Stream content, name of the file and size of the file\");\n\t\t}\n\t}\n\n\t/**\n\t * @public\n\t * Slices the file content to the given range\n\t * @param {Range} range - The range value\n\t * @returns The sliced file part\n\t */\n\tpublic async sliceFile(range: Range): Promise<SliceType> {\n\t\tlet rangeSize = range.maxValue - range.minValue + 1;\n\t\t/* readable.readable Is true if it is safe to call readable.read(),\n\t\t * which means the stream has not been destroyed or emitted 'error' or 'end'\n\t\t */\n\t\tconst bufs = [];\n\n\t\t/**\n\t\t * The sliceFile reads the first `rangeSize` number of bytes from the stream.\n\t\t * The previousSlice property is used to seek the range of bytes in the previous slice.\n\t\t * Suppose, the sliceFile reads bytes from `10 - 20` from the stream but the upload of this slice fails.\n\t\t * When the user resumes, the stream will have bytes from position 21.\n\t\t * The previousSlice.Range is used to compare if the requested range is cached in the previousSlice property or present in the Readable Stream.\n\t\t */\n\t\tif (this.previousSlice) {\n\t\t\tif (range.minValue < this.previousSlice.range.minValue) {\n\t\t\t\tthrow new GraphClientError(\"An error occurred while uploading the stream. Please restart the stream upload from the first byte of the file.\");\n\t\t\t}\n\n\t\t\tif (range.minValue < this.previousSlice.range.maxValue) {\n\t\t\t\tconst previousRangeMin = this.previousSlice.range.minValue;\n\t\t\t\tconst previousRangeMax = this.previousSlice.range.maxValue;\n\n\t\t\t\t// Check if the requested range is same as previously sliced range\n\t\t\t\tif (range.minValue === previousRangeMin && range.maxValue === previousRangeMax) {\n\t\t\t\t\treturn this.previousSlice.fileSlice;\n\t\t\t\t}\n\n\t\t\t\t/**\n\t\t\t\t * The following check considers a possibility\n\t\t\t\t * of an upload failing after some of the bytes of the previous slice\n\t\t\t\t * were successfully uploaded.\n\t\t\t\t * Example - Previous slice range - `10 - 20`. Current requested range is `15 - 20`.\n\t\t\t\t */\n\t\t\t\tif (range.maxValue === previousRangeMax) {\n\t\t\t\t\treturn this.previousSlice.fileSlice.slice(range.minValue, range.maxValue + 1);\n\t\t\t\t}\n\n\t\t\t\t/**\n\t\t\t\t * If an upload fails after some of the bytes of the previous slice\n\t\t\t\t * were successfully uploaded and the new Range.Maximum is greater than the previous Range.Maximum\n\t\t\t\t * Example - Previous slice range - `10 - 20`. Current requested range is `15 - 25`,\n\t\t\t\t * then read the bytes from position 15 to 20 from previousSlice.fileSlice and read bytes from position 21 to 25 from the Readable Stream\n\t\t\t\t */\n\t\t\t\tbufs.push(this.previousSlice.fileSlice.slice(range.minValue, previousRangeMax + 1));\n\n\t\t\t\trangeSize = range.maxValue - previousRangeMax;\n\t\t\t}\n\t\t}\n\n\t\tif (this.content && this.content.readable) {\n\t\t\tif (this.content.readableLength >= rangeSize) {\n\t\t\t\tbufs.push(this.content.read(rangeSize));\n\t\t\t} else {\n\t\t\t\tbufs.push(await this.readNBytesFromStream(rangeSize));\n\t\t\t}\n\t\t} else {\n\t\t\tthrow new GraphClientError(\"Stream is not readable.\");\n\t\t}\n\t\tconst slicedChunk = Buffer.concat(bufs);\n\t\tthis.previousSlice = { fileSlice: slicedChunk, range };\n\n\t\treturn slicedChunk;\n\t}\n\n\t/**\n\t * @private\n\t * Reads the specified byte size from the stream\n\t * @param {number} size - The size of bytes to be read\n\t * @returns Buffer with the given length of data.\n\t */\n\n\tprivate readNBytesFromStream(size: number): Promise<Buffer> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst chunks = [];\n\t\t\tlet remainder = size;\n\t\t\tlet length = 0;\n\t\t\tthis.content.on(\"end\", () => {\n\t\t\t\tif (remainder > 0) {\n\t\t\t\t\treturn reject(new GraphClientError(\"Stream ended before reading required range size\"));\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.content.on(\"readable\", () => {\n\t\t\t\t/**\n\t\t\t\t * (chunk = this.content.read(size)) can return null if size of stream is less than 'size' parameter.\n\t\t\t\t * Read the remainder number of bytes from the stream iteratively as they are available.\n\t\t\t\t */\n\t\t\t\tlet chunk;\n\t\t\t\twhile (length < size && (chunk = this.content.read(remainder)) !== null) {\n\t\t\t\t\tlength += chunk.length;\n\t\t\t\t\tchunks.push(chunk);\n\t\t\t\t\tif (remainder > 0) {\n\t\t\t\t\t\tremainder = size - length;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (length === size) {\n\t\t\t\t\treturn resolve(Buffer.concat(chunks));\n\t\t\t\t}\n\n\t\t\t\tif (!this.content || !this.content.readable) {\n\t\t\t\t\treturn reject(new GraphClientError(\"Error encountered while reading the stream during the upload\"));\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module PageIterator\n */\n\nimport { FetchOptions } from \"../IFetchOptions\";\nimport { Client } from \"../index\";\nimport { MiddlewareOptions } from \"../middleware/options/IMiddlewareOptions\";\n\n/**\n * Signature representing PageCollection\n * @property {any[]} value - The collection value\n * @property {string} [@odata.nextLink] - The nextLink value\n * @property {string} [@odata.deltaLink] - The deltaLink value\n * @property {any} Additional - Any number of additional properties (This is to accept the any additional data returned by in the response to the nextLink request)\n */\nexport interface PageCollection {\n\tvalue: any[];\n\t\"@odata.nextLink\"?: string;\n\t\"@odata.deltaLink\"?: string;\n\t[Key: string]: any;\n}\n\n/**\n * Signature to define the request options to be sent during request.\n * The values of the GraphRequestOptions properties are passed to the Graph Request object.\n * @property {HeadersInit} headers - the header options for the request\n * @property {MiddlewareOptions[]} middlewareoptions - The middleware options for the request\n * @property {FetchOptions} options - The fetch options for the request\n */\nexport interface GraphRequestOptions {\n\theaders?: HeadersInit;\n\tmiddlewareOptions?: MiddlewareOptions[];\n\toptions?: FetchOptions;\n}\n\n/**\n * Signature representing callback for page iterator\n * @property {Function} callback - The callback function which should return boolean to continue the continue/stop the iteration.\n */\nexport type PageIteratorCallback = (data: any) => boolean;\n\n/**\n * @class\n * Class for PageIterator\n */\nexport class PageIterator {\n\t/**\n\t * @private\n\t * Member holding the GraphClient instance\n\t */\n\tprivate client: Client;\n\n\t/**\n\t * @private\n\t * Member holding the page collection\n\t */\n\tprivate collection: any[];\n\n\t/**\n\t * @private\n\t * Member variable referring to nextLink of the page collection\n\t */\n\tprivate nextLink: string | undefined;\n\n\t/**\n\t * @private\n\t * Member variable referring to deltaLink of the request\n\t */\n\tprivate deltaLink: string | undefined;\n\n\t/**\n\t * @private\n\t * Holding callback for Iteration.\n\t */\n\n\tprivate callback: PageIteratorCallback;\n\n\t/**\n\t * @private\n\t * Member holding a complete/incomplete status of an iterator\n\t */\n\tprivate complete: boolean;\n\n\t/**\n\t * @private\n\t * Information to be added to the request\n\t */\n\tprivate requestOptions: GraphRequestOptions;\n\n\t/**\n\t * @private\n\t * Member holding the current position on the collection\n\t */\n\tprivate cursor: number;\n\n\t/**\n\t * @public\n\t * @constructor\n\t * Creates new instance for PageIterator\n\t * @param {Client} client - The graph client instance\n\t * @param {PageCollection} pageCollection - The page collection object\n\t * @param {PageIteratorCallback} callBack - The callback function\n\t * @param {GraphRequestOptions} requestOptions - The request options\n\t * @returns An instance of a PageIterator\n\t */\n\tpublic constructor(client: Client, pageCollection: PageCollection, callback: PageIteratorCallback, requestOptions?: GraphRequestOptions) {\n\t\tthis.client = client;\n\t\tthis.collection = pageCollection.value;\n\t\tthis.nextLink = pageCollection[\"@odata.nextLink\"];\n\t\tthis.deltaLink = pageCollection[\"@odata.deltaLink\"];\n\t\tthis.callback = callback;\n\t\tthis.cursor = 0;\n\t\tthis.complete = false;\n\t\tthis.requestOptions = requestOptions;\n\t}\n\n\t/**\n\t * @private\n\t * Iterates over a collection by enqueuing entries one by one and kicking the callback with the enqueued entry\n\t * @returns A boolean indicating the continue flag to process next page\n\t */\n\tprivate iterationHelper(): boolean {\n\t\tif (this.collection === undefined) {\n\t\t\treturn false;\n\t\t}\n\t\tlet advance = true;\n\t\twhile (advance && this.cursor < this.collection.length) {\n\t\t\tconst item = this.collection[this.cursor];\n\t\t\tadvance = this.callback(item);\n\t\t\tthis.cursor++;\n\t\t}\n\t\treturn advance;\n\t}\n\n\t/**\n\t * @private\n\t * @async\n\t * Helper to make a get request to fetch next page with nextLink url and update the page iterator instance with the returned response\n\t * @returns A promise that resolves to a response data with next page collection\n\t */\n\tprivate async fetchAndUpdateNextPageData(): Promise<any> {\n\t\tlet graphRequest = this.client.api(this.nextLink);\n\t\tif (this.requestOptions) {\n\t\t\tif (this.requestOptions.headers) {\n\t\t\t\tgraphRequest = graphRequest.headers(this.requestOptions.headers);\n\t\t\t}\n\t\t\tif (this.requestOptions.middlewareOptions) {\n\t\t\t\tgraphRequest = graphRequest.middlewareOptions(this.requestOptions.middlewareOptions);\n\t\t\t}\n\t\t\tif (this.requestOptions.options) {\n\t\t\t\tgraphRequest = graphRequest.options(this.requestOptions.options);\n\t\t\t}\n\t\t}\n\n\t\tconst response: PageCollection = await graphRequest.get();\n\t\tthis.collection = response.value;\n\t\tthis.cursor = 0;\n\t\tthis.nextLink = response[\"@odata.nextLink\"];\n\t\tthis.deltaLink = response[\"@odata.deltaLink\"];\n\t}\n\n\t/**\n\t * @public\n\t * Getter to get the deltaLink in the current response\n\t * @returns A deltaLink which is being used to make delta requests in future\n\t */\n\tpublic getDeltaLink(): string | undefined {\n\t\treturn this.deltaLink;\n\t}\n\n\t/**\n\t * @public\n\t * @async\n\t * Iterates over the collection and kicks callback for each item on iteration. Fetches next set of data through nextLink and iterates over again\n\t * This happens until the nextLink is drained out or the user responds with a red flag to continue from callback\n\t * @returns A Promise that resolves to nothing on completion and throws error incase of any discrepancy.\n\t */\n\tpublic async iterate(): Promise<any> {\n\t\tlet advance = this.iterationHelper();\n\t\twhile (advance) {\n\t\t\tif (this.nextLink !== undefined) {\n\t\t\t\tawait this.fetchAndUpdateNextPageData();\n\t\t\t\tadvance = this.iterationHelper();\n\t\t\t} else {\n\t\t\t\tadvance = false;\n\t\t\t}\n\t\t}\n\t\tif (this.nextLink === undefined && this.cursor >= this.collection.length) {\n\t\t\tthis.complete = true;\n\t\t}\n\t}\n\n\t/**\n\t * @public\n\t * @async\n\t * To resume the iteration\n\t * Note: This internally calls the iterate method, It's just for more readability.\n\t * @returns A Promise that resolves to nothing on completion and throws error incase of any discrepancy\n\t */\n\tpublic async resume(): Promise<any> {\n\t\treturn this.iterate();\n\t}\n\n\t/**\n\t * @public\n\t * To get the completeness status of the iterator\n\t * @returns Boolean indicating the completeness\n\t */\n\tpublic isComplete(): boolean {\n\t\treturn this.complete;\n\t}\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module CustomAuthenticationProvider\n */\n\nimport { GraphClientError } from \"./GraphClientError\";\nimport { AuthenticationProvider } from \"./IAuthenticationProvider\";\nimport { AuthProvider } from \"./IAuthProvider\";\n\n/**\n * @class\n * Class representing CustomAuthenticationProvider\n * @extends AuthenticationProvider\n */\nexport class CustomAuthenticationProvider implements AuthenticationProvider {\n\t/**\n\t * @private\n\t * A member to hold authProvider callback\n\t */\n\tprivate provider: AuthProvider;\n\n\t/**\n\t * @public\n\t * @constructor\n\t * Creates an instance of CustomAuthenticationProvider\n\t * @param {AuthProviderCallback} provider - An authProvider function\n\t * @returns An instance of CustomAuthenticationProvider\n\t */\n\tpublic constructor(provider: AuthProvider) {\n\t\tthis.provider = provider;\n\t}\n\n\t/**\n\t * @public\n\t * @async\n\t * To get the access token\n\t * @returns The promise that resolves to an access token\n\t */\n\tpublic async getAccessToken(): Promise<any> {\n\t\treturn new Promise((resolve: (accessToken: string) => void, reject: (error: any) => void) => {\n\t\t\tthis.provider(async (error: any, accessToken: string | null) => {\n\t\t\t\tif (accessToken) {\n\t\t\t\t\tresolve(accessToken);\n\t\t\t\t} else {\n\t\t\t\t\tif (!error) {\n\t\t\t\t\t\tconst invalidTokenMessage = \"Access token is undefined or empty.\\\n\t\t\t\t\t\tPlease provide a valid token.\\\n\t\t\t\t\t\tFor more help - https://github.com/microsoftgraph/msgraph-sdk-javascript/blob/dev/docs/CustomAuthenticationProvider.md\";\n\t\t\t\t\t\terror = new GraphClientError(invalidTokenMessage);\n\t\t\t\t\t}\n\t\t\t\t\tconst err = await GraphClientError.setGraphClientError(error);\n\t\t\t\t\treject(err);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module GraphError\n */\n\n/**\n * @class\n * Class for GraphError\n * @NOTE: This is NOT what is returned from the Graph\n * GraphError is created from parsing JSON errors returned from the graph\n * Some fields are renamed ie, \"request-id\" => requestId so you can use dot notation\n */\n\nexport class GraphError extends Error {\n\t/**\n\t * @public\n\t * A member holding status code of the error\n\t */\n\tpublic statusCode: number;\n\n\t/**\n\t * @public\n\t * A member holding code i.e name of the error\n\t */\n\tpublic code: string | null;\n\n\t/**\n\t * @public\n\t * A member holding request-id i.e identifier of the request\n\t */\n\tpublic requestId: string | null;\n\n\t/**\n\t * @public\n\t * A member holding processed date and time of the request\n\t */\n\tpublic date: Date;\n\n    public headers?: Headers;\n\n\t/**\n\t * @public\n\t * A member holding original error response by the graph service\n\t */\n\tpublic body: any;\n\n\t/**\n\t * @public\n\t * @constructor\n\t * Creates an instance of GraphError\n\t * @param {number} [statusCode = -1] - The status code of the error\n\t * @param {string} [message] - The message of the error\n\t * @param {Error} [baseError] - The base error\n\t * @returns An instance of GraphError\n\t */\n\tpublic constructor(statusCode = -1, message?: string, baseError?: Error) {\n\t\tsuper(message || (baseError && baseError.message));\n\t\t// https://github.com/Microsoft/TypeScript/wiki/Breaking-Changes#extending-built-ins-like-error-array-and-map-may-no-longer-work\n\t\tObject.setPrototypeOf(this, GraphError.prototype);\n\t\tthis.statusCode = statusCode;\n\t\tthis.code = null;\n\t\tthis.requestId = null;\n\t\tthis.date = new Date();\n\t\tthis.body = null;\n\t\tthis.stack = baseError ? baseError.stack : this.stack;\n\t}\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module GraphErrorHandler\n */\n\nimport { GraphError } from \"./GraphError\";\nimport { GraphRequestCallback } from \"./IGraphRequestCallback\";\n\n/**\n * @interface\n * Signature for the json represent of the error response from the Graph API\n * https://docs.microsoft.com/en-us/graph/errors\n * @property {[key: string] : string | number} - The Key value pair\n */\ninterface GraphAPIErrorResponse {\n\terror: {\n\t\tcode: string;\n\t\tmessage: string;\n\t\tinnerError: any;\n\t};\n}\n\n/**\n * @class\n * Class for GraphErrorHandler\n */\n\nexport class GraphErrorHandler {\n\t/**\n\t * @private\n\t * @static\n\t * Populates the GraphError instance with Error instance values\n\t * @param {Error} error - The error returned by graph service or some native error\n\t * @param {number} [statusCode] - The status code of the response\n\t * @returns The GraphError instance\n\t */\n\tprivate static constructError(error: Error, statusCode?: number, rawResponse?: Response): GraphError {\n\t\tconst gError = new GraphError(statusCode, \"\", error);\n\t\tif (error.name !== undefined) {\n\t\t\tgError.code = error.name;\n\t\t}\n\t\tgError.body = error.toString();\n\t\tgError.date = new Date();\n\t\tgError.headers = rawResponse?.headers;\n\t\treturn gError;\n\t}\n\n\t/**\n\t * @private\n\t * @static\n\t * @async\n\t * Populates the GraphError instance from the Error returned by graph service\n\t * @param {GraphAPIErrorResponse} graphError - The error possibly returned by graph service or some native error\n\t * @param {number} statusCode - The status code of the response\n\t * @returns A promise that resolves to GraphError instance\n\t *\n\t * Example error for https://graph.microsoft.com/v1.0/me/events?$top=3&$search=foo\n\t * {\n\t *      \"error\": {\n\t *          \"code\": \"SearchEvents\",\n\t *          \"message\": \"The parameter $search is not currently supported on the Events resource.\",\n\t *          \"innerError\": {\n\t *              \"request-id\": \"b31c83fd-944c-4663-aa50-5d9ceb367e19\",\n\t *              \"date\": \"2016-11-17T18:37:45\"\n\t *          }\n\t *      }\n\t *  }\n\t */\n\tprivate static constructErrorFromResponse(graphError: GraphAPIErrorResponse, statusCode: number, rawResponse?: Response): GraphError {\n\t\tconst error = graphError.error;\n\t\tconst gError = new GraphError(statusCode, error.message);\n\t\tgError.code = error.code;\n\t\tif (error.innerError !== undefined) {\n\t\t\tgError.requestId = error.innerError[\"request-id\"];\n\t\t\tgError.date = new Date(error.innerError.date);\n\t\t}\n\n\t\tgError.body = JSON.stringify(error);\n\t\tgError.headers = rawResponse?.headers;\n\n\t\treturn gError;\n\t}\n\n\t/**\n\t * @public\n\t * @static\n\t * @async\n\t * To get the GraphError object\n\t * Reference - https://docs.microsoft.com/en-us/graph/errors\n\t * @param {any} [error = null] - The error returned by graph service or some native error\n\t * @param {number} [statusCode = -1] - The status code of the response\n\t * @param {GraphRequestCallback} [callback] - The graph request callback function\n\t * @returns A promise that resolves to GraphError instance\n\t */\n\tpublic static async getError(error: any = null, statusCode = -1, callback?: GraphRequestCallback, rawResponse?: Response): Promise<GraphError> {\n\t\tlet gError: GraphError;\n\t\tif (error && error.error) {\n\t\t\tgError = GraphErrorHandler.constructErrorFromResponse(error, statusCode, rawResponse);\n\t\t} else if (error instanceof Error) {\n\t\t\tgError = GraphErrorHandler.constructError(error, statusCode, rawResponse);\n\t\t} else {\n\t\t\tgError = new GraphError(statusCode);\n\t\t\tgError.body = error; // if a custom error is passed which is not instance of Error object or a graph API response\n\t\t}\n\t\tif (typeof callback === \"function\") {\n\t\t\tcallback(gError, null);\n\t\t} else {\n\t\t\treturn gError;\n\t\t}\n\t}\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module GraphRequest\n */\nimport { GraphClientError } from \"./GraphClientError\";\nimport { GraphError } from \"./GraphError\";\nimport { GraphErrorHandler } from \"./GraphErrorHandler\";\nimport { oDataQueryNames, serializeContent, urlJoin } from \"./GraphRequestUtil\";\nimport { GraphResponseHandler } from \"./GraphResponseHandler\";\nimport { HTTPClient } from \"./HTTPClient\";\nimport { ClientOptions } from \"./IClientOptions\";\nimport { Context } from \"./IContext\";\nimport { FetchOptions } from \"./IFetchOptions\";\nimport { GraphRequestCallback } from \"./IGraphRequestCallback\";\nimport { MiddlewareControl } from \"./middleware/MiddlewareControl\";\nimport { MiddlewareOptions } from \"./middleware/options/IMiddlewareOptions\";\nimport { RequestMethod } from \"./RequestMethod\";\nimport { ResponseType } from \"./ResponseType\";\n/**\n * @interface\n * Signature to representing key value pairs\n * @property {[key: string] : string | number} - The Key value pair\n */\ninterface KeyValuePairObjectStringNumber {\n\t[key: string]: string | number;\n}\n\n/**\n * @interface\n * Signature to define URL components\n * @template http://graph.microsoft.com/VERSION/PATH?QUERYSTRING&OTHER_QUERY_PARAMS\n *\n * @property {string} host - The host to which the request needs to be made\n * @property {string} version - Version of the graph endpoint\n * @property {string} [path] - The path of the resource request\n * @property {KeyValuePairObjectStringNumber} oDataQueryParams - The oData Query Params\n * @property {KeyValuePairObjectStringNumber} otherURLQueryParams - The other query params for a request\n * @property {string[]} otherURLQueryOptions - The non key-value query parameters. Example- '/me?$whatif'\n */\nexport interface URLComponents {\n\thost: string;\n\tversion: string;\n\tpath?: string;\n\toDataQueryParams: KeyValuePairObjectStringNumber;\n\totherURLQueryParams: KeyValuePairObjectStringNumber;\n\totherURLQueryOptions?: string[];\n}\n\n/**\n * @class\n * A Class representing GraphRequest\n */\nexport class GraphRequest {\n\t/**\n\t * @private\n\t * A member variable to hold HTTPClient instance\n\t */\n\tprivate httpClient: HTTPClient;\n\n\t/**\n\t * @private\n\t * A member variable to hold client options\n\t */\n\tprivate config: ClientOptions;\n\n\t/**\n\t * @private\n\t * A member to hold URL Components data\n\t */\n\tprivate urlComponents: URLComponents;\n\n\t/**\n\t * @private\n\t * A member to hold custom header options for a request\n\t */\n\tprivate _headers: HeadersInit;\n\n\t/**\n\t * @private\n\t * A member to hold custom options for a request\n\t */\n\tprivate _options: FetchOptions;\n\n\t/**\n\t * @private\n\t * A member to hold the array of middleware options for a request\n\t */\n\tprivate _middlewareOptions: MiddlewareOptions[];\n\n\t/**\n\t * @private\n\t * A member to hold custom response type for a request\n\t */\n\tprivate _responseType: ResponseType;\n\n\t/**\n\t * @public\n\t * @constructor\n\t * Creates an instance of GraphRequest\n\t * @param {HTTPClient} httpClient - The HTTPClient instance\n\t * @param {ClientOptions} config - The options for making request\n\t * @param {string} path - A path string\n\t */\n\tpublic constructor(httpClient: HTTPClient, config: ClientOptions, path: string) {\n\t\tthis.httpClient = httpClient;\n\t\tthis.config = config;\n\t\tthis.urlComponents = {\n\t\t\thost: this.config.baseUrl,\n\t\t\tversion: this.config.defaultVersion,\n\t\t\toDataQueryParams: {},\n\t\t\totherURLQueryParams: {},\n\t\t\totherURLQueryOptions: [],\n\t\t};\n\t\tthis._headers = {};\n\t\tthis._options = {};\n\t\tthis._middlewareOptions = [];\n\t\tthis.parsePath(path);\n\t}\n\n\t/**\n\t * @private\n\t * Parses the path string and creates URLComponents out of it\n\t * @param {string} path - The request path string\n\t * @returns Nothing\n\t */\n\tprivate parsePath = (path: string): void => {\n\t\t// Strips out the base of the url if they passed in\n\t\tif (path.indexOf(\"https://\") !== -1) {\n\t\t\tpath = path.replace(\"https://\", \"\");\n\n\t\t\t// Find where the host ends\n\t\t\tconst endOfHostStrPos = path.indexOf(\"/\");\n\t\t\tif (endOfHostStrPos !== -1) {\n\t\t\t\t// Parse out the host\n\t\t\t\tthis.urlComponents.host = \"https://\" + path.substring(0, endOfHostStrPos);\n\t\t\t\t// Strip the host from path\n\t\t\t\tpath = path.substring(endOfHostStrPos + 1, path.length);\n\t\t\t}\n\n\t\t\t// Remove the following version\n\t\t\tconst endOfVersionStrPos = path.indexOf(\"/\");\n\t\t\tif (endOfVersionStrPos !== -1) {\n\t\t\t\t// Parse out the version\n\t\t\t\tthis.urlComponents.version = path.substring(0, endOfVersionStrPos);\n\t\t\t\t// Strip version from path\n\t\t\t\tpath = path.substring(endOfVersionStrPos + 1, path.length);\n\t\t\t}\n\t\t}\n\n\t\t// Strip out any leading \"/\"\n\t\tif (path.charAt(0) === \"/\") {\n\t\t\tpath = path.substr(1);\n\t\t}\n\n\t\tconst queryStrPos = path.indexOf(\"?\");\n\t\tif (queryStrPos === -1) {\n\t\t\t// No query string\n\t\t\tthis.urlComponents.path = path;\n\t\t} else {\n\t\t\tthis.urlComponents.path = path.substr(0, queryStrPos);\n\n\t\t\t// Capture query string into oDataQueryParams and otherURLQueryParams\n\t\t\tconst queryParams = path.substring(queryStrPos + 1, path.length).split(\"&\");\n\t\t\tfor (const queryParam of queryParams) {\n\t\t\t\tthis.parseQueryParameter(queryParam);\n\t\t\t}\n\t\t}\n\t};\n\n\t/**\n\t * @private\n\t * Adds the query parameter as comma separated values\n\t * @param {string} propertyName - The name of a property\n\t * @param {string|string[]} propertyValue - The vale of a property\n\t * @param {IArguments} additionalProperties - The additional properties\n\t * @returns Nothing\n\t */\n\tprivate addCsvQueryParameter(propertyName: string, propertyValue: string | string[], additionalProperties: IArguments): void {\n\t\t// If there are already $propertyName value there, append a \",\"\n\t\tthis.urlComponents.oDataQueryParams[propertyName] = this.urlComponents.oDataQueryParams[propertyName] ? this.urlComponents.oDataQueryParams[propertyName] + \",\" : \"\";\n\n\t\tlet allValues: string[] = [];\n\n\t\tif (additionalProperties.length > 1 && typeof propertyValue === \"string\") {\n\t\t\tallValues = Array.prototype.slice.call(additionalProperties);\n\t\t} else if (typeof propertyValue === \"string\") {\n\t\t\tallValues.push(propertyValue);\n\t\t} else {\n\t\t\tallValues = allValues.concat(propertyValue);\n\t\t}\n\n\t\tthis.urlComponents.oDataQueryParams[propertyName] += allValues.join(\",\");\n\t}\n\n\t/**\n\t * @private\n\t * Builds the full url from the URLComponents to make a request\n\t * @returns The URL string that is qualified to make a request to graph endpoint\n\t */\n\tprivate buildFullUrl(): string {\n\t\tconst url = urlJoin([this.urlComponents.host, this.urlComponents.version, this.urlComponents.path]) + this.createQueryString();\n\n\t\tif (this.config.debugLogging) {\n\t\t\tconsole.log(url);\n\t\t}\n\t\treturn url;\n\t}\n\n\t/**\n\t * @private\n\t * Builds the query string from the URLComponents\n\t * @returns The Constructed query string\n\t */\n\tprivate createQueryString(): string {\n\t\t// Combining query params from oDataQueryParams and otherURLQueryParams\n\t\tconst urlComponents = this.urlComponents;\n\t\tconst query: string[] = [];\n\t\tif (Object.keys(urlComponents.oDataQueryParams).length !== 0) {\n\t\t\tfor (const property in urlComponents.oDataQueryParams) {\n\t\t\t\tif (Object.prototype.hasOwnProperty.call(urlComponents.oDataQueryParams, property)) {\n\t\t\t\t\tquery.push(property + \"=\" + urlComponents.oDataQueryParams[property]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (Object.keys(urlComponents.otherURLQueryParams).length !== 0) {\n\t\t\tfor (const property in urlComponents.otherURLQueryParams) {\n\t\t\t\tif (Object.prototype.hasOwnProperty.call(urlComponents.otherURLQueryParams, property)) {\n\t\t\t\t\tquery.push(property + \"=\" + urlComponents.otherURLQueryParams[property]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (urlComponents.otherURLQueryOptions.length !== 0) {\n\t\t\tfor (const str of urlComponents.otherURLQueryOptions) {\n\t\t\t\tquery.push(str);\n\t\t\t}\n\t\t}\n\t\treturn query.length > 0 ? \"?\" + query.join(\"&\") : \"\";\n\t}\n\n\t/**\n\t * @private\n\t * Parses the query parameters to set the urlComponents property of the GraphRequest object\n\t * @param {string|KeyValuePairObjectStringNumber} queryDictionaryOrString - The query parameter\n\t * @returns The same GraphRequest instance that is being called with\n\t */\n\tprivate parseQueryParameter(queryDictionaryOrString: string | KeyValuePairObjectStringNumber): GraphRequest {\n\t\tif (typeof queryDictionaryOrString === \"string\") {\n\t\t\tif (queryDictionaryOrString.charAt(0) === \"?\") {\n\t\t\t\tqueryDictionaryOrString = queryDictionaryOrString.substring(1);\n\t\t\t}\n\n\t\t\tif (queryDictionaryOrString.indexOf(\"&\") !== -1) {\n\t\t\t\tconst queryParams = queryDictionaryOrString.split(\"&\");\n\t\t\t\tfor (const str of queryParams) {\n\t\t\t\t\tthis.parseQueryParamenterString(str);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.parseQueryParamenterString(queryDictionaryOrString);\n\t\t\t}\n\t\t} else if (queryDictionaryOrString.constructor === Object) {\n\t\t\tfor (const key in queryDictionaryOrString) {\n\t\t\t\tif (Object.prototype.hasOwnProperty.call(queryDictionaryOrString, key)) {\n\t\t\t\t\tthis.setURLComponentsQueryParamater(key, queryDictionaryOrString[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * @private\n\t * Parses the query parameter of string type to set the urlComponents property of the GraphRequest object\n\t * @param {string} queryParameter - the query parameters\n\t * returns nothing\n\t */\n\tprivate parseQueryParamenterString(queryParameter: string): void {\n\t\t/* The query key-value pair must be split on the first equals sign to avoid errors in parsing nested query parameters.\n                 Example-> \"/me?$expand=home($select=city)\" */\n\t\tif (this.isValidQueryKeyValuePair(queryParameter)) {\n\t\t\tconst indexOfFirstEquals = queryParameter.indexOf(\"=\");\n\t\t\tconst paramKey = queryParameter.substring(0, indexOfFirstEquals);\n\t\t\tconst paramValue = queryParameter.substring(indexOfFirstEquals + 1);\n\t\t\tthis.setURLComponentsQueryParamater(paramKey, paramValue);\n\t\t} else {\n\t\t\t/* Push values which are not of key-value structure.\n            Example-> Handle an invalid input->.query(test), .query($select($select=name)) and let the Graph API respond with the error in the URL*/\n\t\t\tthis.urlComponents.otherURLQueryOptions.push(queryParameter);\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t * Sets values into the urlComponents property of GraphRequest object.\n\t * @param {string} paramKey - the query parameter key\n\t * @param {string} paramValue - the query paramter value\n\t * @returns nothing\n\t */\n\tprivate setURLComponentsQueryParamater(paramKey: string, paramValue: string | number): void {\n\t\tif (oDataQueryNames.indexOf(paramKey) !== -1) {\n\t\t\tconst currentValue = this.urlComponents.oDataQueryParams[paramKey];\n\t\t\tconst isValueAppendable = currentValue && (paramKey === \"$expand\" || paramKey === \"$select\" || paramKey === \"$orderby\");\n\t\t\tthis.urlComponents.oDataQueryParams[paramKey] = isValueAppendable ? currentValue + \",\" + paramValue : paramValue;\n\t\t} else {\n\t\t\tthis.urlComponents.otherURLQueryParams[paramKey] = paramValue;\n\t\t}\n\t}\n\t/**\n\t * @private\n\t * Check if the query parameter string has a valid key-value structure\n\t * @param {string} queryString - the query parameter string. Example -> \"name=value\"\n\t * #returns true if the query string has a valid key-value structure else false\n\t */\n\tprivate isValidQueryKeyValuePair(queryString: string): boolean {\n\t\tconst indexofFirstEquals = queryString.indexOf(\"=\");\n\t\tif (indexofFirstEquals === -1) {\n\t\t\treturn false;\n\t\t}\n\t\tconst indexofOpeningParanthesis = queryString.indexOf(\"(\");\n\t\tif (indexofOpeningParanthesis !== -1 && queryString.indexOf(\"(\") < indexofFirstEquals) {\n\t\t\t// Example -> .query($select($expand=true));\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\t/**\n\t * @private\n\t * Updates the custom headers and options for a request\n\t * @param {FetchOptions} options - The request options object\n\t * @returns Nothing\n\t */\n\tprivate updateRequestOptions(options: FetchOptions): void {\n\t\tconst optionsHeaders: HeadersInit = { ...options.headers };\n\t\tif (this.config.fetchOptions !== undefined) {\n\t\t\tconst fetchOptions: FetchOptions = { ...this.config.fetchOptions };\n\t\t\tObject.assign(options, fetchOptions);\n\t\t\tif (typeof this.config.fetchOptions.headers !== undefined) {\n\t\t\t\toptions.headers = { ...this.config.fetchOptions.headers };\n\t\t\t}\n\t\t}\n\t\tObject.assign(options, this._options);\n\t\tif (options.headers !== undefined) {\n\t\t\tObject.assign(optionsHeaders, options.headers);\n\t\t}\n\t\tObject.assign(optionsHeaders, this._headers);\n\t\toptions.headers = optionsHeaders;\n\t}\n\n\t/**\n\t * @private\n\t * @async\n\t * Adds the custom headers and options to the request and makes the HTTPClient send request call\n\t * @param {RequestInfo} request - The request url string or the Request object value\n\t * @param {FetchOptions} options - The options to make a request\n\t * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call\n\t * @returns A promise that resolves to the response content\n\t */\n\tprivate async send(request: RequestInfo, options: FetchOptions, callback?: GraphRequestCallback): Promise<any> {\n\t\tlet rawResponse: Response;\n\t\tconst middlewareControl = new MiddlewareControl(this._middlewareOptions);\n\t\tthis.updateRequestOptions(options);\n\t\tconst customHosts = this.config?.customHosts;\n\t\ttry {\n\t\t\tconst context: Context = await this.httpClient.sendRequest({\n\t\t\t\trequest,\n\t\t\t\toptions,\n\t\t\t\tmiddlewareControl,\n\t\t\t\tcustomHosts,\n\t\t\t});\n\n\t\t\trawResponse = context.response;\n\t\t\tconst response: any = await GraphResponseHandler.getResponse(rawResponse, this._responseType, callback);\n\t\t\treturn response;\n\t\t} catch (error) {\n\t\t\tif (error instanceof GraphClientError) {\n\t\t\t\tthrow error;\n\t\t\t}\n\t\t\tlet statusCode: number;\n\n\t\t\tif (rawResponse) {\n\t\t\t\tstatusCode = rawResponse.status;\n\t\t\t}\n\t\t\tconst gError: GraphError = await GraphErrorHandler.getError(error, statusCode, callback, rawResponse);\n\t\t\tthrow gError;\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t * Checks if the content-type is present in the _headers property. If not present, defaults the content-type to application/json\n\t * @param none\n\t * @returns nothing\n\t */\n\tprivate setHeaderContentType(): void {\n\t\tif (!this._headers) {\n\t\t\tthis.header(\"Content-Type\", \"application/json\");\n\t\t\treturn;\n\t\t}\n\t\tconst headerKeys = Object.keys(this._headers);\n\t\tfor (const headerKey of headerKeys) {\n\t\t\tif (headerKey.toLowerCase() === \"content-type\") {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t// Default the content-type to application/json in case the content-type is not present in the header\n\t\tthis.header(\"Content-Type\", \"application/json\");\n\t}\n\n\t/**\n\t * @public\n\t * Sets the custom header for a request\n\t * @param {string} headerKey - A header key\n\t * @param {string} headerValue - A header value\n\t * @returns The same GraphRequest instance that is being called with\n\t */\n\tpublic header(headerKey: string, headerValue: string): GraphRequest {\n\t\tthis._headers[headerKey] = headerValue;\n\t\treturn this;\n\t}\n\n\t/**\n\t * @public\n\t * Sets the custom headers for a request\n\t * @param {KeyValuePairObjectStringNumber | HeadersInit} headers - The request headers\n\t * @returns The same GraphRequest instance that is being called with\n\t */\n\tpublic headers(headers: KeyValuePairObjectStringNumber | HeadersInit): GraphRequest {\n\t\tfor (const key in headers) {\n\t\t\tif (Object.prototype.hasOwnProperty.call(headers, key)) {\n\t\t\t\tthis._headers[key] = headers[key] as string;\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\t/**\n\t * @public\n\t * Sets the option for making a request\n\t * @param {string} key - The key value\n\t * @param {any} value - The value\n\t * @returns The same GraphRequest instance that is being called with\n\t */\n\tpublic option(key: string, value: any): GraphRequest {\n\t\tthis._options[key] = value;\n\t\treturn this;\n\t}\n\n\t/**\n\t * @public\n\t * Sets the options for making a request\n\t * @param {{ [key: string]: any }} options - The options key value pair\n\t * @returns The same GraphRequest instance that is being called with\n\t */\n\tpublic options(options: { [key: string]: any }): GraphRequest {\n\t\tfor (const key in options) {\n\t\t\tif (Object.prototype.hasOwnProperty.call(options, key)) {\n\t\t\t\tthis._options[key] = options[key];\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\t/**\n\t * @public\n\t * Sets the middleware options for a request\n\t * @param {MiddlewareOptions[]} options - The array of middleware options\n\t * @returns The same GraphRequest instance that is being called with\n\t */\n\tpublic middlewareOptions(options: MiddlewareOptions[]): GraphRequest {\n\t\tthis._middlewareOptions = options;\n\t\treturn this;\n\t}\n\n\t/**\n\t * @public\n\t * Sets the api endpoint version for a request\n\t * @param {string} version - The version value\n\t * @returns The same GraphRequest instance that is being called with\n\t */\n\tpublic version(version: string): GraphRequest {\n\t\tthis.urlComponents.version = version;\n\t\treturn this;\n\t}\n\n\t/**\n\t * @public\n\t * Sets the api endpoint version for a request\n\t * @param {ResponseType} responseType - The response type value\n\t * @returns The same GraphRequest instance that is being called with\n\t */\n\tpublic responseType(responseType: ResponseType): GraphRequest {\n\t\tthis._responseType = responseType;\n\t\treturn this;\n\t}\n\n\t/**\n\t * @public\n\t * To add properties for select OData Query param\n\t * @param {string|string[]} properties - The Properties value\n\t * @returns The same GraphRequest instance that is being called with, after adding the properties for $select query\n\t */\n\t/*\n\t * Accepts .select(\"displayName,birthday\")\n\t *     and .select([\"displayName\", \"birthday\"])\n\t *     and .select(\"displayName\", \"birthday\")\n\t *\n\t */\n\tpublic select(properties: string | string[]): GraphRequest {\n\t\tthis.addCsvQueryParameter(\"$select\", properties, arguments);\n\t\treturn this;\n\t}\n\n\t/**\n\t * @public\n\t * To add properties for expand OData Query param\n\t * @param {string|string[]} properties - The Properties value\n\t * @returns The same GraphRequest instance that is being called with, after adding the properties for $expand query\n\t */\n\tpublic expand(properties: string | string[]): GraphRequest {\n\t\tthis.addCsvQueryParameter(\"$expand\", properties, arguments);\n\t\treturn this;\n\t}\n\n\t/**\n\t * @public\n\t * To add properties for orderby OData Query param\n\t * @param {string|string[]} properties - The Properties value\n\t * @returns The same GraphRequest instance that is being called with, after adding the properties for $orderby query\n\t */\n\tpublic orderby(properties: string | string[]): GraphRequest {\n\t\tthis.addCsvQueryParameter(\"$orderby\", properties, arguments);\n\t\treturn this;\n\t}\n\n\t/**\n\t * @public\n\t * To add query string for filter OData Query param. The request URL accepts only one $filter Odata Query option and its value is set to the most recently passed filter query string.\n\t * @param {string} filterStr - The filter query string\n\t * @returns The same GraphRequest instance that is being called with, after adding the $filter query\n\t */\n\tpublic filter(filterStr: string): GraphRequest {\n\t\tthis.urlComponents.oDataQueryParams.$filter = filterStr;\n\t\treturn this;\n\t}\n\n\t/**\n\t * @public\n\t * To add criterion for search OData Query param. The request URL accepts only one $search Odata Query option and its value is set to the most recently passed search criterion string.\n\t * @param {string} searchStr - The search criterion string\n\t * @returns The same GraphRequest instance that is being called with, after adding the $search query criteria\n\t */\n\tpublic search(searchStr: string): GraphRequest {\n\t\tthis.urlComponents.oDataQueryParams.$search = searchStr;\n\t\treturn this;\n\t}\n\n\t/**\n\t * @public\n\t * To add number for top OData Query param. The request URL accepts only one $top Odata Query option and its value is set to the most recently passed number value.\n\t * @param {number} n - The number value\n\t * @returns The same GraphRequest instance that is being called with, after adding the number for $top query\n\t */\n\tpublic top(n: number): GraphRequest {\n\t\tthis.urlComponents.oDataQueryParams.$top = n;\n\t\treturn this;\n\t}\n\n\t/**\n\t * @public\n\t * To add number for skip OData Query param. The request URL accepts only one $skip Odata Query option and its value is set to the most recently passed number value.\n\t * @param {number} n - The number value\n\t * @returns The same GraphRequest instance that is being called with, after adding the number for the $skip query\n\t */\n\tpublic skip(n: number): GraphRequest {\n\t\tthis.urlComponents.oDataQueryParams.$skip = n;\n\t\treturn this;\n\t}\n\n\t/**\n\t * @public\n\t * To add token string for skipToken OData Query param. The request URL accepts only one $skipToken Odata Query option and its value is set to the most recently passed token value.\n\t * @param {string} token - The token value\n\t * @returns The same GraphRequest instance that is being called with, after adding the token string for $skipToken query option\n\t */\n\tpublic skipToken(token: string): GraphRequest {\n\t\tthis.urlComponents.oDataQueryParams.$skipToken = token;\n\t\treturn this;\n\t}\n\n\t/**\n\t * @public\n\t * To add boolean for count OData Query param. The URL accepts only one $count Odata Query option and its value is set to the most recently passed boolean value.\n\t * @param {boolean} isCount - The count boolean\n\t * @returns The same GraphRequest instance that is being called with, after adding the boolean value for the $count query option\n\t */\n\tpublic count(isCount = true): GraphRequest {\n\t\tthis.urlComponents.oDataQueryParams.$count = isCount.toString();\n\t\treturn this;\n\t}\n\n\t/**\n\t * @public\n\t * Appends query string to the urlComponent\n\t * @param {string|KeyValuePairObjectStringNumber} queryDictionaryOrString - The query value\n\t * @returns The same GraphRequest instance that is being called with, after appending the query string to the url component\n\t */\n\t/*\n\t * Accepts .query(\"displayName=xyz\")\n\t *     and .select({ name: \"value\" })\n\t */\n\tpublic query(queryDictionaryOrString: string | KeyValuePairObjectStringNumber): GraphRequest {\n\t\treturn this.parseQueryParameter(queryDictionaryOrString);\n\t}\n\n\t/**\n\t * @public\n\t * @async\n\t * Makes a http request with GET method\n\t * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call\n\t * @returns A promise that resolves to the get response\n\t */\n\tpublic async get(callback?: GraphRequestCallback): Promise<any> {\n\t\tconst url = this.buildFullUrl();\n\t\tconst options: FetchOptions = {\n\t\t\tmethod: RequestMethod.GET,\n\t\t};\n\t\tconst response = await this.send(url, options, callback);\n\t\treturn response;\n\t}\n\n\t/**\n\t * @public\n\t * @async\n\t * Makes a http request with POST method\n\t * @param {any} content - The content that needs to be sent with the request\n\t * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call\n\t * @returns A promise that resolves to the post response\n\t */\n\tpublic async post(content: any, callback?: GraphRequestCallback): Promise<any> {\n\t\tconst url = this.buildFullUrl();\n\t\tconst options: FetchOptions = {\n\t\t\tmethod: RequestMethod.POST,\n\t\t\tbody: serializeContent(content),\n\t\t};\n\t\tconst className: string = content && content.constructor && content.constructor.name;\n\t\tif (className === \"FormData\") {\n\t\t\t// Content-Type headers should not be specified in case the of FormData type content\n\t\t\toptions.headers = {};\n\t\t} else {\n\t\t\tthis.setHeaderContentType();\n\t\t\toptions.headers = this._headers;\n\t\t}\n\t\treturn await this.send(url, options, callback);\n\t}\n\n\t/**\n\t * @public\n\t * @async\n\t * Alias for Post request call\n\t * @param {any} content - The content that needs to be sent with the request\n\t * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call\n\t * @returns A promise that resolves to the post response\n\t */\n\tpublic async create(content: any, callback?: GraphRequestCallback): Promise<any> {\n\t\treturn await this.post(content, callback);\n\t}\n\n\t/**\n\t * @public\n\t * @async\n\t * Makes http request with PUT method\n\t * @param {any} content - The content that needs to be sent with the request\n\t * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call\n\t * @returns A promise that resolves to the put response\n\t */\n\tpublic async put(content: any, callback?: GraphRequestCallback): Promise<any> {\n\t\tconst url = this.buildFullUrl();\n\t\tthis.setHeaderContentType();\n\t\tconst options: FetchOptions = {\n\t\t\tmethod: RequestMethod.PUT,\n\t\t\tbody: serializeContent(content),\n\t\t};\n\t\treturn await this.send(url, options, callback);\n\t}\n\n\t/**\n\t * @public\n\t * @async\n\t * Makes http request with PATCH method\n\t * @param {any} content - The content that needs to be sent with the request\n\t * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call\n\t * @returns A promise that resolves to the patch response\n\t */\n\tpublic async patch(content: any, callback?: GraphRequestCallback): Promise<any> {\n\t\tconst url = this.buildFullUrl();\n\t\tthis.setHeaderContentType();\n\t\tconst options: FetchOptions = {\n\t\t\tmethod: RequestMethod.PATCH,\n\t\t\tbody: serializeContent(content),\n\t\t};\n\t\treturn await this.send(url, options, callback);\n\t}\n\n\t/**\n\t * @public\n\t * @async\n\t * Alias for PATCH request\n\t * @param {any} content - The content that needs to be sent with the request\n\t * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call\n\t * @returns A promise that resolves to the patch response\n\t */\n\tpublic async update(content: any, callback?: GraphRequestCallback): Promise<any> {\n\t\treturn await this.patch(content, callback);\n\t}\n\n\t/**\n\t * @public\n\t * @async\n\t * Makes http request with DELETE method\n\t * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call\n\t * @returns A promise that resolves to the delete response\n\t */\n\tpublic async delete(callback?: GraphRequestCallback): Promise<any> {\n\t\tconst url = this.buildFullUrl();\n\t\tconst options: FetchOptions = {\n\t\t\tmethod: RequestMethod.DELETE,\n\t\t};\n\t\treturn await this.send(url, options, callback);\n\t}\n\n\t/**\n\t * @public\n\t * @async\n\t * Alias for delete request call\n\t * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call\n\t * @returns A promise that resolves to the delete response\n\t */\n\tpublic async del(callback?: GraphRequestCallback): Promise<any> {\n\t\treturn await this.delete(callback);\n\t}\n\n\t/**\n\t * @public\n\t * @async\n\t * Makes a http request with GET method to read response as a stream.\n\t * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call\n\t * @returns A promise that resolves to the getStream response\n\t */\n\tpublic async getStream(callback?: GraphRequestCallback): Promise<any> {\n\t\tconst url = this.buildFullUrl();\n\t\tconst options = {\n\t\t\tmethod: RequestMethod.GET,\n\t\t};\n\t\tthis.responseType(ResponseType.STREAM);\n\t\treturn await this.send(url, options, callback);\n\t}\n\n\t/**\n\t * @public\n\t * @async\n\t * Makes a http request with GET method to read response as a stream.\n\t * @param {any} stream - The stream instance\n\t * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call\n\t * @returns A promise that resolves to the putStream response\n\t */\n\tpublic async putStream(stream: any, callback?: GraphRequestCallback): Promise<any> {\n\t\tconst url = this.buildFullUrl();\n\t\tconst options = {\n\t\t\tmethod: RequestMethod.PUT,\n\t\t\theaders: {\n\t\t\t\t\"Content-Type\": \"application/octet-stream\",\n\t\t\t},\n\t\t\tbody: stream,\n\t\t};\n\t\treturn await this.send(url, options, callback);\n\t}\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module HTTPClient\n */\n\nimport { Context } from \"./IContext\";\nimport { Middleware } from \"./middleware/IMiddleware\";\n\n/**\n * @class\n * Class representing HTTPClient\n */\nexport class HTTPClient {\n\t/**\n\t * @private\n\t * A member holding first middleware of the middleware chain\n\t */\n\tprivate middleware: Middleware;\n\n\t/**\n\t * @public\n\t * @constructor\n\t * Creates an instance of a HTTPClient\n\t * @param {...Middleware} middleware - The first middleware of the middleware chain or a sequence of all the Middleware handlers\n\t */\n\tpublic constructor(...middleware: Middleware[]) {\n\t\tif (!middleware || !middleware.length) {\n\t\t\tconst error = new Error();\n\t\t\terror.name = \"InvalidMiddlewareChain\";\n\t\t\terror.message = \"Please provide a default middleware chain or custom middleware chain\";\n\t\t\tthrow error;\n\t\t}\n\t\tthis.setMiddleware(...middleware);\n\t}\n\n\t/**\n\t * @private\n\t * Processes the middleware parameter passed to set this.middleware property\n\t * The calling function should validate if middleware is not undefined or not empty.\n\t * @param {...Middleware} middleware - The middleware passed\n\t * @returns Nothing\n\t */\n\tprivate setMiddleware(...middleware: Middleware[]): void {\n\t\tif (middleware.length > 1) {\n\t\t\tthis.parseMiddleWareArray(middleware);\n\t\t} else {\n\t\t\tthis.middleware = middleware[0];\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t * Processes the middleware array to construct the chain\n\t * and sets this.middleware property to the first middleware handler of the array\n\t * The calling function should validate if middleware is not undefined or not empty\n\t * @param {Middleware[]} middlewareArray - The array of middleware handlers\n\t * @returns Nothing\n\t */\n\tprivate parseMiddleWareArray(middlewareArray: Middleware[]) {\n\t\tmiddlewareArray.forEach((element, index) => {\n\t\t\tif (index < middlewareArray.length - 1) {\n\t\t\t\telement.setNext(middlewareArray[index + 1]);\n\t\t\t}\n\t\t});\n\t\tthis.middleware = middlewareArray[0];\n\t}\n\n\t/**\n\t * @public\n\t * @async\n\t * To send the request through the middleware chain\n\t * @param {Context} context - The context of a request\n\t * @returns A promise that resolves to the Context\n\t */\n\tpublic async sendRequest(context: Context): Promise<Context> {\n\t\tif (typeof context.request === \"string\" && context.options === undefined) {\n\t\t\tconst error = new Error();\n\t\t\terror.name = \"InvalidRequestOptions\";\n\t\t\terror.message = \"Unable to execute the middleware, Please provide valid options for a request\";\n\t\t\tthrow error;\n\t\t}\n\t\tawait this.middleware.execute(context);\n\t\treturn context;\n\t}\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module HTTPClientFactory\n */\n\nimport { HTTPClient } from \"./HTTPClient\";\nimport { AuthenticationProvider } from \"./IAuthenticationProvider\";\nimport { AuthenticationHandler } from \"./middleware/AuthenticationHandler\";\nimport { HTTPMessageHandler } from \"./middleware/HTTPMessageHandler\";\nimport { Middleware } from \"./middleware/IMiddleware\";\nimport { RedirectHandlerOptions } from \"./middleware/options/RedirectHandlerOptions\";\nimport { RetryHandlerOptions } from \"./middleware/options/RetryHandlerOptions\";\nimport { RedirectHandler } from \"./middleware/RedirectHandler\";\nimport { RetryHandler } from \"./middleware/RetryHandler\";\nimport { TelemetryHandler } from \"./middleware/TelemetryHandler\";\n\n/**\n * @private\n * To check whether the environment is node or not\n * @returns A boolean representing the environment is node or not\n */\nconst isNodeEnvironment = (): boolean => {\n\treturn typeof process === \"object\" && typeof require === \"function\";\n};\n\n/**\n * @class\n * Class representing HTTPClientFactory\n */\nexport class HTTPClientFactory {\n\t/**\n\t * @public\n\t * @static\n\t * Creates HTTPClient with default middleware chain\n\t * @param {AuthenticationProvider} authProvider - The authentication provider instance\n\t * @returns A HTTPClient instance\n\t *\n\t * NOTE: These are the things that we need to remember while doing modifications in the below default pipeline.\n\t * \t\t* HTTPMessageHandler should be the last one in the middleware pipeline, because this makes the actual network call of the request\n\t * \t\t* TelemetryHandler should be the one prior to the last middleware in the chain, because this is the one which actually collects and appends the usage flag and placing this handler \t*\t\t  before making the actual network call ensures that the usage of all features are recorded in the flag.\n\t * \t\t* The best place for AuthenticationHandler is in the starting of the pipeline, because every other handler might have to work for multiple times for a request but the auth token for\n\t * \t\t  them will remain same. For example, Retry and Redirect handlers might be working multiple times for a request based on the response but their auth token would remain same.\n\t */\n\tpublic static createWithAuthenticationProvider(authProvider: AuthenticationProvider): HTTPClient {\n\t\tconst authenticationHandler = new AuthenticationHandler(authProvider);\n\t\tconst retryHandler = new RetryHandler(new RetryHandlerOptions());\n\t\tconst telemetryHandler = new TelemetryHandler();\n\t\tconst httpMessageHandler = new HTTPMessageHandler();\n\n\t\tauthenticationHandler.setNext(retryHandler);\n\t\tif (isNodeEnvironment()) {\n\t\t\tconst redirectHandler = new RedirectHandler(new RedirectHandlerOptions());\n\t\t\tretryHandler.setNext(redirectHandler);\n\t\t\tredirectHandler.setNext(telemetryHandler);\n\t\t} else {\n\t\t\tretryHandler.setNext(telemetryHandler);\n\t\t}\n\t\ttelemetryHandler.setNext(httpMessageHandler);\n\t\treturn HTTPClientFactory.createWithMiddleware(authenticationHandler);\n\t}\n\n\t/**\n\t * @public\n\t * @static\n\t * Creates a middleware chain with the given one\n\t * @property {...Middleware} middleware - The first middleware of the middleware chain or a sequence of all the Middleware handlers\n\t * @returns A HTTPClient instance\n\t */\n\tpublic static createWithMiddleware(...middleware: Middleware[]): HTTPClient {\n\t\t// Middleware should not empty or undefined. This is check is present in the HTTPClient constructor.\n\t\treturn new HTTPClient(...middleware);\n\t}\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @constant\n * @function\n * Validates availability of Promise and fetch in global context\n * @returns The true in case the Promise and fetch available, otherwise throws error\n */\n\nexport const validatePolyFilling = (): boolean => {\n\tif (typeof Promise === \"undefined\" && typeof fetch === \"undefined\") {\n\t\tconst error = new Error(\"Library cannot function without Promise and fetch. So, please provide polyfill for them.\");\n\t\terror.name = \"PolyFillNotAvailable\";\n\t\tthrow error;\n\t} else if (typeof Promise === \"undefined\") {\n\t\tconst error = new Error(\"Library cannot function without Promise. So, please provide polyfill for it.\");\n\t\terror.name = \"PolyFillNotAvailable\";\n\t\tthrow error;\n\t} else if (typeof fetch === \"undefined\") {\n\t\tconst error = new Error(\"Library cannot function without fetch. So, please provide polyfill for it.\");\n\t\terror.name = \"PolyFillNotAvailable\";\n\t\tthrow error;\n\t}\n\treturn true;\n};\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * @module Client\n */\n\nimport { GRAPH_API_VERSION, GRAPH_BASE_URL } from \"./Constants\";\nimport { CustomAuthenticationProvider } from \"./CustomAuthenticationProvider\";\nimport { GraphRequest } from \"./GraphRequest\";\nimport { HTTPClient } from \"./HTTPClient\";\nimport { HTTPClientFactory } from \"./HTTPClientFactory\";\nimport { ClientOptions } from \"./IClientOptions\";\nimport { Options } from \"./IOptions\";\nimport { validatePolyFilling } from \"./ValidatePolyFilling\";\n\nexport class Client {\n\t/**\n\t * @private\n\t * A member which stores the Client instance options\n\t */\n\tprivate config: ClientOptions = {\n\t\tbaseUrl: GRAPH_BASE_URL,\n\t\tdebugLogging: false,\n\t\tdefaultVersion: GRAPH_API_VERSION,\n\t};\n\n\t/**\n\t * @private\n\t * A member which holds the HTTPClient instance\n\t */\n\tprivate httpClient: HTTPClient;\n\n\t/**\n\t * @public\n\t * @static\n\t * To create a client instance with options and initializes the default middleware chain\n\t * @param {Options} options - The options for client instance\n\t * @returns The Client instance\n\t */\n\tpublic static init(options: Options): Client {\n\t\tconst clientOptions: ClientOptions = {};\n\t\tfor (const i in options) {\n\t\t\tif (Object.prototype.hasOwnProperty.call(options, i)) {\n\t\t\t\tclientOptions[i] = i === \"authProvider\" ? new CustomAuthenticationProvider(options[i]) : options[i];\n\t\t\t}\n\t\t}\n\t\treturn Client.initWithMiddleware(clientOptions);\n\t}\n\n\t/**\n\t * @public\n\t * @static\n\t * To create a client instance with the Client Options\n\t * @param {ClientOptions} clientOptions - The options object for initializing the client\n\t * @returns The Client instance\n\t */\n\tpublic static initWithMiddleware(clientOptions: ClientOptions): Client {\n\t\treturn new Client(clientOptions);\n\t}\n\n\t/**\n\t * @private\n\t * @constructor\n\t * Creates an instance of Client\n\t * @param {ClientOptions} clientOptions - The options to instantiate the client object\n\t */\n\tprivate constructor(clientOptions: ClientOptions) {\n\t\tvalidatePolyFilling();\n\t\tfor (const key in clientOptions) {\n\t\t\tif (Object.prototype.hasOwnProperty.call(clientOptions, key)) {\n\t\t\t\tthis.config[key] = clientOptions[key];\n\t\t\t}\n\t\t}\n\t\tlet httpClient: HTTPClient;\n\t\tif (clientOptions.authProvider !== undefined && clientOptions.middleware !== undefined) {\n\t\t\tconst error = new Error();\n\t\t\terror.name = \"AmbiguityInInitialization\";\n\t\t\terror.message = \"Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both\";\n\t\t\tthrow error;\n\t\t} else if (clientOptions.authProvider !== undefined) {\n\t\t\thttpClient = HTTPClientFactory.createWithAuthenticationProvider(clientOptions.authProvider);\n\t\t} else if (clientOptions.middleware !== undefined) {\n\t\t\thttpClient = new HTTPClient(...[].concat(clientOptions.middleware));\n\t\t} else {\n\t\t\tconst error = new Error();\n\t\t\terror.name = \"InvalidMiddlewareChain\";\n\t\t\terror.message = \"Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain\";\n\t\t\tthrow error;\n\t\t}\n\t\tthis.httpClient = httpClient;\n\t}\n\n\t/**\n\t * @public\n\t * Entry point to make requests\n\t * @param {string} path - The path string value\n\t * @returns The graph request instance\n\t */\n\tpublic api(path: string): GraphRequest {\n\t\treturn new GraphRequest(this.httpClient, this.config, path);\n\t}\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n// eslint-disable-next-line @typescript-eslint/triple-slash-reference\n/// <reference path= \"../../shims.d.ts\" />\nexport { BatchRequestStep, BatchRequestData, BatchRequestContent, RequestData, BatchRequestBody } from \"../content/BatchRequestContent\";\nexport { BatchResponseBody, BatchResponseContent } from \"../content/BatchResponseContent\";\n\nexport { AuthenticationHandler } from \"../middleware/AuthenticationHandler\";\nexport { HTTPMessageHandler } from \"../middleware/HTTPMessageHandler\";\nexport { Middleware } from \"../middleware/IMiddleware\";\nexport { RetryHandler } from \"../middleware/RetryHandler\";\nexport { RedirectHandler } from \"../middleware/RedirectHandler\";\nexport { TelemetryHandler } from \"../middleware/TelemetryHandler\";\nexport { MiddlewareFactory } from \"../middleware/MiddlewareFactory\";\nexport { AuthenticationHandlerOptions } from \"../middleware/options/AuthenticationHandlerOptions\";\nexport { MiddlewareOptions } from \"../middleware/options/IMiddlewareOptions\";\nexport { ShouldRetry, RetryHandlerOptions } from \"../middleware/options/RetryHandlerOptions\";\nexport { ShouldRedirect, RedirectHandlerOptions } from \"../middleware/options/RedirectHandlerOptions\";\nexport { FeatureUsageFlag, TelemetryHandlerOptions } from \"../middleware/options/TelemetryHandlerOptions\";\nexport { ChaosHandlerOptions } from \"../middleware/options/ChaosHandlerOptions\";\nexport { ChaosStrategy } from \"../middleware/options/ChaosStrategy\";\nexport { ChaosHandler } from \"../middleware/ChaosHandler\";\n\nexport { SliceType, LargeFileUploadTaskOptions, LargeFileUploadTask, LargeFileUploadSession, FileObject } from \"../tasks/LargeFileUploadTask\";\nexport { OneDriveLargeFileUploadTask, OneDriveLargeFileUploadOptions } from \"../tasks/OneDriveLargeFileUploadTask\";\nexport { getValidRangeSize } from \"../tasks/OneDriveLargeFileUploadTaskUtil\";\nexport { StreamUpload } from \"../tasks/FileUploadTask/FileObjectClasses/StreamUpload\";\nexport { FileUpload } from \"../tasks/FileUploadTask/FileObjectClasses/FileUpload\";\nexport { UploadResult } from \"../tasks/FileUploadTask/UploadResult\";\nexport { UploadEventHandlers } from \"../tasks/FileUploadTask/Interfaces/IUploadEventHandlers\";\nexport { Range } from \"../tasks/FileUploadTask/Range\";\nexport { PageIteratorCallback, PageIterator, PageCollection, GraphRequestOptions } from \"../tasks/PageIterator\";\n\nexport { Client } from \"../Client\";\nexport { CustomAuthenticationProvider } from \"../CustomAuthenticationProvider\";\nexport { GraphError } from \"../GraphError\";\nexport { GraphClientError } from \"../GraphClientError\";\nexport { GraphRequest } from \"../GraphRequest\";\nexport { AuthProvider } from \"../IAuthProvider\";\nexport { AuthenticationProvider } from \"../IAuthenticationProvider\";\nexport { AuthenticationProviderOptions } from \"../IAuthenticationProviderOptions\";\nexport { AuthProviderCallback } from \"../IAuthProviderCallback\";\nexport { ClientOptions } from \"../IClientOptions\";\nexport { Context } from \"../IContext\";\nexport { NodeFetchInit, FetchOptions } from \"../IFetchOptions\";\nexport { GraphRequestCallback } from \"../IGraphRequestCallback\";\nexport { Options } from \"../IOptions\";\nexport { ResponseType } from \"../ResponseType\";\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * returns a promise that resolves after specified time\n * @param time in milliseconds\n */\nexport const delay = (ms: number): Promise<void> => {\n  return new Promise(resolve => {\n    setTimeout(resolve, ms);\n  });\n};\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * An EventHandler for custom events\n */\nexport type EventHandler<E> = (event: E) => void;\n\n/**\n * Provider EventDispatcher\n *\n * @export\n * @class EventDispatcher\n * @template E\n */\nexport class EventDispatcher<E> {\n  private eventHandlers: EventHandler<E>[] = [];\n  /**\n   * fires event handler\n   *\n   * @param {E} event\n   * @memberof EventDispatcher\n   */\n\n  public fire(event: E) {\n    for (const handler of this.eventHandlers) {\n      handler(event);\n    }\n  }\n\n  /**\n   * adds eventHandler\n   *\n   * @param {EventHandler<E>} eventHandler\n   * @memberof EventDispatcher\n   */\n  public add(eventHandler: EventHandler<E>) {\n    this.eventHandlers.push(eventHandler);\n  }\n\n  /**\n   * removes eventHandler\n   *\n   * @param {EventHandler<E>} eventHandler\n   * @memberof EventDispatcher\n   */\n  public remove(eventHandler: EventHandler<E>) {\n    for (let i = 0; i < this.eventHandlers.length; i++) {\n      if (this.eventHandlers[i] === eventHandler) {\n        this.eventHandlers.splice(i, 1);\n        i--;\n      }\n    }\n  }\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { AuthenticationProvider, AuthenticationProviderOptions } from '@microsoft/microsoft-graph-client';\nimport { validateBaseURL } from '../utils/GraphHelpers';\nimport { GraphEndpoint, IGraph, MICROSOFT_GRAPH_DEFAULT_ENDPOINT } from '../IGraph';\nimport { EventDispatcher, EventHandler } from '../utils/EventDispatcher';\n\n/**\n * Provider Type to be extended for implmenting new providers\n *\n * @export\n * @abstract\n * @class IProvider\n * @implements {AuthenticationProvider}\n */\nexport abstract class IProvider implements AuthenticationProvider {\n  /**\n   * The Graph object that contains the Graph client sdk\n   *\n   * @type {Graph}\n   * @memberof IProvider\n   */\n  public graph: IGraph;\n\n  /**\n   * Specifies if the provider has enabled support for multiple accounts\n   *\n   * @protected\n   * @type {boolean}\n   * @memberof IProvider\n   */\n  protected isMultipleAccountDisabled: boolean = true;\n\n  /**\n   * Specifies if Multi account functionality is supported by the provider and enabled.\n   *\n   * @readonly\n   * @type {boolean}\n   * @memberof IProvider\n   */\n  public get isMultiAccountSupportedAndEnabled(): boolean {\n    return false;\n  }\n  private _state: ProviderState;\n  private _loginChangedDispatcher = new EventDispatcher<LoginChangedEvent>();\n  private _activeAccountChangedDispatcher = new EventDispatcher<ActiveAccountChanged>();\n  private _baseURL: GraphEndpoint = MICROSOFT_GRAPH_DEFAULT_ENDPOINT;\n\n  /**\n   * The base URL to be used in the graph client config.\n   */\n  public set baseURL(url: GraphEndpoint) {\n    if (validateBaseURL(url)) {\n      this._baseURL = url;\n      return;\n    } else {\n      throw new Error(`${url} is not a valid Graph URL endpoint.`);\n    }\n  }\n\n  public get baseURL(): GraphEndpoint {\n    return this._baseURL;\n  }\n\n  /**\n   * Enable/Disable incremental consent\n   *\n   * @protected\n   * @type {boolean}\n   * @memberof IProvider\n   */\n  private _isIncrementalConsentDisabled: boolean = false;\n\n  protected isMultipleAccountSupported: boolean = false;\n  public get isMultiAccountSupported(): boolean {\n    return this.isMultipleAccountSupported;\n  }\n  /**\n   * returns state of Provider\n   *\n   * @readonly\n   * @type {ProviderState}\n   * @memberof IProvider\n   */\n  public get state(): ProviderState {\n    return this._state;\n  }\n\n  /**\n   * Incremental consent setting\n   *\n   * @readonly\n   * @memberof IProvider\n   */\n  public get isIncrementalConsentDisabled(): boolean {\n    return this._isIncrementalConsentDisabled;\n  }\n\n  /**\n   * Enable/Disable incremental consent\n   *\n   * @readonly\n   * @memberof IProvider\n   */\n  public set isIncrementalConsentDisabled(disabled: boolean) {\n    this._isIncrementalConsentDisabled = disabled;\n  }\n\n  /**\n   * Name used for analytics\n   *\n   * @readonly\n   * @memberof IProvider\n   */\n  public get name() {\n    return 'MgtIProvider';\n  }\n\n  constructor() {\n    this._state = ProviderState.Loading;\n  }\n\n  /**\n   * sets state of Provider and fires loginchangedDispatcher\n   *\n   * @param {ProviderState} state\n   * @memberof IProvider\n   */\n  public setState(state: ProviderState) {\n    if (state !== this._state) {\n      this._state = state;\n      this._loginChangedDispatcher.fire({});\n    }\n  }\n\n  /**\n   * event handler when login changes\n   *\n   * @param {EventHandler<LoginChangedEvent>} eventHandler\n   * @memberof IProvider\n   */\n  public onStateChanged(eventHandler: EventHandler<LoginChangedEvent>) {\n    this._loginChangedDispatcher.add(eventHandler);\n  }\n  /**\n   * removes event handler for when login changes\n   *\n   * @param {EventHandler<LoginChangedEvent>} eventHandler\n   * @memberof IProvider\n   */\n  public removeStateChangedHandler(eventHandler: EventHandler<LoginChangedEvent>) {\n    this._loginChangedDispatcher.remove(eventHandler);\n  }\n\n  /**\n   * option implementation that can be called to sign in user (required for mgt-login to work)\n   *\n   * @returns {Promise<void>}\n   * @memberof IProvider\n   */\n  public login?(): Promise<void>;\n\n  /**\n   * optional implementation that can be called to sign out user (required for mgt-login to work)\n   *\n   * @returns {Promise<void>}\n   * @memberof IProvider\n   */\n  public logout?(): Promise<void>;\n\n  /**\n   * Returns all signed in accounts.\n   *\n   * @return {*}  {any[]}\n   * @memberof IProvider\n   */\n  public getAllAccounts?(): IProviderAccount[];\n\n  /**\n   * Returns active account in case of multi-account sign in\n   *\n   * @return {*}  {any[]}\n   * @memberof IProvider\n   */\n  public getActiveAccount?(): IProviderAccount;\n\n  /**\n   * Switch between two signed in accounts\n   *\n   * @param {*} user\n   * @memberof IProvider\n   */\n  public setActiveAccount?(user: IProviderAccount) {\n    this.fireActiveAccountChanged();\n  }\n\n  /**\n   * Event handler when Active account changes\n   *\n   * @param {EventHandler<ActiveAccountChanged>} eventHandler\n   * @memberof IProvider\n   */\n  public onActiveAccountChanged(eventHandler: EventHandler<ActiveAccountChanged>) {\n    this._activeAccountChangedDispatcher.add(eventHandler);\n  }\n\n  /**\n   * Removes event handler for when Active account changes\n   *\n   * @param {EventHandler<ActiveAccountChanged>} eventHandler\n   * @memberof IProvider\n   */\n  public removeActiveAccountChangedHandler(eventHandler: EventHandler<ActiveAccountChanged>) {\n    this._activeAccountChangedDispatcher.remove(eventHandler);\n  }\n\n  /**\n   * Fires event when active account changes\n   *\n   * @memberof IProvider\n   */\n  private fireActiveAccountChanged() {\n    this._activeAccountChangedDispatcher.fire({});\n  }\n\n  /**\n   * uses scopes to recieve access token\n   *\n   * @param {...string[]} scopes\n   * @returns {Promise<string>}\n   * @memberof IProvider\n   */\n  public getAccessTokenForScopes(...scopes: string[]): Promise<string> {\n    return this.getAccessToken({ scopes });\n  }\n\n  /**\n   * Promise to receive access token using Provider options\n   *\n   * @abstract\n   * @param {AuthenticationProviderOptions} [options]\n   * @returns {Promise<string>}\n   * @memberof IProvider\n   */\n  public abstract getAccessToken(options?: AuthenticationProviderOptions): Promise<string>;\n}\n\n/**\n * ActiveAccountChanged Event\n *\n * @export\n * @interface ActiveAccountChanged\n */\nexport interface ActiveAccountChanged {}\n/**\n * loginChangedEvent\n *\n * @export\n * @interface LoginChangedEvent\n */\n// tslint:disable-next-line: no-empty-interface\nexport interface LoginChangedEvent {}\n\n/**\n * LoginType\n *\n * @export\n * @enum {number}\n */\nexport enum LoginType {\n  /**\n   * Popup = 0\n   */\n  Popup,\n  /**\n   * Redirect = 1\n   */\n  Redirect\n}\n\n/**\n * ProviderState\n *\n * @export\n * @enum {number}\n */\nexport enum ProviderState {\n  /**\n   * Loading = 0\n   */\n  Loading,\n  /**\n   * SignedOut = 1\n   */\n  SignedOut,\n  /**\n   * SignedIn = 2\n   */\n  SignedIn\n}\n\n/**\n * Account details\n *\n * @export\n */\nexport type IProviderAccount = {\n  id: string;\n  mail?: string;\n  name?: string;\n  tenantId?: string;\n};\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { Client } from '@microsoft/microsoft-graph-client';\nimport { User } from '@microsoft/microsoft-graph-types';\n\nimport { EventDispatcher, EventHandler } from '../utils/EventDispatcher';\nimport { IProvider, ProviderState } from './IProvider';\n\n/**\n * Provides implementation for acquiring the necessary access token for calling the Microsoft Graph APIs.\n *\n * @export\n * @class Providers\n */\nexport class Providers {\n  /**\n   * returns the value of provider used globally. All components use this property to get a reference to the provider.\n   *\n   * @static\n   * @type {IProvider}\n   * @memberof Providers\n   */\n  public static get globalProvider(): IProvider {\n    return this._globalProvider;\n  }\n\n  public static set globalProvider(provider: IProvider) {\n    if (provider !== this._globalProvider) {\n      if (this._globalProvider) {\n        this._globalProvider.removeStateChangedHandler(this.handleProviderStateChanged);\n        if (this._globalProvider.isMultiAccountSupportedAndEnabled) {\n          this._globalProvider.removeActiveAccountChangedHandler(this.handleActiveAccountChanged);\n        }\n      }\n\n      if (provider) {\n        provider.onStateChanged(this.handleProviderStateChanged);\n        if (provider.isMultiAccountSupportedAndEnabled) {\n          provider.onActiveAccountChanged(this.handleActiveAccountChanged);\n        }\n      }\n\n      this._globalProvider = provider;\n      this._eventDispatcher.fire(ProvidersChangedState.ProviderChanged);\n    }\n  }\n\n  /**\n   * Fires event when Provider changes state\n   *\n   * @static\n   * @param {EventHandler<ProvidersChangedState>} event\n   * @memberof Providers\n   */\n  public static onProviderUpdated(event: EventHandler<ProvidersChangedState>) {\n    this._eventDispatcher.add(event);\n  }\n\n  /**\n   * Remove event handler\n   *\n   * @static\n   * @param {EventHandler<ProvidersChangedState>} event\n   * @memberof Providers\n   */\n  public static removeProviderUpdatedListener(event: EventHandler<ProvidersChangedState>) {\n    this._eventDispatcher.remove(event);\n  }\n\n  /**\n   * Fires event when Provider changes state\n   *\n   * @static\n   * @param {EventHandler<ProvidersChangedState>} event\n   * @memberof Providers\n   */\n  public static onActiveAccountChanged(event: EventHandler<any>) {\n    this._activeAccountChangedDispatcher.add(event);\n  }\n\n  /**\n   * Remove event handler\n   *\n   * @static\n   * @param {EventHandler<ProvidersChangedState>} event\n   * @memberof Providers\n   */\n  public static removeActiveAccountChangedListener(event: EventHandler<any>) {\n    this._activeAccountChangedDispatcher.remove(event);\n  }\n\n  /**\n   * Gets the current signed in user\n   *\n   * @static\n   * @memberof Providers\n   */\n  public static me(): Promise<User> {\n    if (!this.client) {\n      this._mePromise = null;\n      return null;\n    }\n\n    if (!this._mePromise) {\n      this._mePromise = this.getMe();\n    }\n\n    return this._mePromise;\n  }\n\n  /**\n   * Get current signed in user details\n   *\n   * @private\n   * @static\n   * @return {*}  {Promise<User>}\n   * @memberof Providers\n   */\n  private static async getMe(): Promise<User> {\n    try {\n      const response: User = await this.client.api('me').get();\n      if (response && response.id) {\n        return response;\n      }\n    } catch {}\n\n    return null;\n  }\n\n  /**\n   * Gets the cache ID, creates one if it does not exist\n   *\n   * @static\n   * @memberof Providers\n   */\n  public static async getCacheId() {\n    if (this._cacheId) {\n      return this._cacheId;\n    }\n    if (Providers.globalProvider && Providers.globalProvider.state == ProviderState.SignedIn) {\n      if (!this._cacheId) {\n        const client = this.client;\n        if (client) {\n          try {\n            this._cacheId = await this.createCacheId();\n          } catch {}\n        }\n      }\n    }\n    return this._cacheId;\n  }\n\n  /**\n   * Unset the cache ID\n   *\n   * @static\n   * @memberof Providers\n   */\n  private static unsetCacheId() {\n    this._cacheId = null;\n    this._mePromise = null;\n  }\n\n  /**\n   * Create cache ID\n   *\n   * @private\n   * @static\n   * @return {*}  {Promise<string>}\n   * @memberof Providers\n   */\n  private static async createCacheId(): Promise<string> {\n    if (Providers.globalProvider.isMultiAccountSupportedAndEnabled) {\n      const cacheId = this.createCacheIdWithAccountDetails();\n      if (cacheId) {\n        return cacheId;\n      }\n    }\n    return await this.createCacheIdWithUserDetails();\n  }\n\n  /**\n   * Create a cache ID with user userID and principal name\n   *\n   * @static\n   * @param {User} response\n   * @return {*}\n   * @memberof Providers\n   */\n  private static async createCacheIdWithUserDetails(): Promise<string> {\n    const response: User = await this.me();\n    if (response && response.id) {\n      return response.id + '-' + response.userPrincipalName;\n    } else return null;\n  }\n\n  /**\n   * Create cache ID with tenant ID and user ID\n   *\n   * @private\n   * @static\n   * @return {*}  {string}\n   * @memberof Providers\n   */\n  private static createCacheIdWithAccountDetails(): string {\n    const user = Providers.globalProvider.getActiveAccount();\n    if (user.tenantId && user.id) {\n      return user.tenantId + user.id;\n    } else return null;\n  }\n\n  /**\n   * Gets the current graph client\n   *\n   * @readonly\n   * @static\n   * @type {Client}\n   * @memberof Providers\n   */\n  public static get client(): Client {\n    if (Providers.globalProvider && Providers.globalProvider.state === ProviderState.SignedIn) {\n      return Providers.globalProvider.graph.client;\n    }\n    return null;\n  }\n\n  private static _eventDispatcher: EventDispatcher<ProvidersChangedState> = new EventDispatcher<ProvidersChangedState>();\n\n  private static _activeAccountChangedDispatcher: EventDispatcher<any> = new EventDispatcher<any>();\n\n  private static _globalProvider: IProvider;\n  private static _cacheId: string;\n  private static _mePromise: Promise<User>;\n\n  private static handleProviderStateChanged() {\n    if (!Providers.globalProvider || Providers.globalProvider.state !== ProviderState.SignedIn) {\n      // clear current signed in user info\n      Providers._mePromise = null;\n    }\n\n    Providers._eventDispatcher.fire(ProvidersChangedState.ProviderStateChanged);\n  }\n\n  private static handleActiveAccountChanged() {\n    Providers.unsetCacheId();\n    Providers._activeAccountChangedDispatcher.fire(null);\n  }\n}\n\n/**\n * on Provider Change State\n *\n * @export\n * @enum {number}\n */\nexport enum ProvidersChangedState {\n  /**\n   * ProviderChanged = 0\n   */\n  ProviderChanged,\n  /**\n   * ProviderStateChanged = 1\n   */\n  ProviderStateChanged\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { AuthenticationHandlerOptions, Middleware } from '@microsoft/microsoft-graph-client';\nimport { GraphEndpoint, MICROSOFT_GRAPH_ENDPOINTS } from '../IGraph';\nimport { Providers } from '../providers/Providers';\n\n/**\n * creates an AuthenticationHandlerOptions from scopes array that\n * can be used in the Graph sdk middleware chain\n *\n * @export\n * @param {...string[]} scopes\n * @returns\n */\nexport function prepScopes(...scopes: string[]) {\n  const authProviderOptions = {\n    scopes\n  };\n\n  if (!Providers.globalProvider.isIncrementalConsentDisabled) {\n    return [new AuthenticationHandlerOptions(undefined, authProviderOptions)];\n  } else {\n    return [];\n  }\n}\n\n/**\n * Helper method to chain Middleware when instantiating new Client\n *\n * @param {...Middleware[]} middleware\n * @returns {Middleware}\n */\nexport function chainMiddleware(...middleware: Middleware[]): Middleware {\n  const rootMiddleware = middleware[0];\n  let current = rootMiddleware;\n  for (let i = 1; i < middleware.length; ++i) {\n    const next = middleware[i];\n    if (current.setNext) {\n      current.setNext(next);\n    }\n    current = next;\n  }\n  return rootMiddleware;\n}\n\n/**\n * Helper method to validate a base URL string\n * @param url a URL string\n * @returns GraphEndpoint\n */\nexport function validateBaseURL(url: string): GraphEndpoint {\n  try {\n    const urlObj = new URL(url);\n    const originAsEndpoint = urlObj.origin as GraphEndpoint;\n    if (MICROSOFT_GRAPH_ENDPOINTS.has(originAsEndpoint)) {\n      return originAsEndpoint;\n    }\n  } catch (error) {\n    return;\n  }\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { BatchResponse, IBatch } from '../IBatch';\nimport { BatchRequestContent, MiddlewareOptions } from '@microsoft/microsoft-graph-client';\nimport { delay } from '../utils';\nimport { prepScopes } from './GraphHelpers';\nimport { IGraph } from '../IGraph';\n\n/**\n * Represents a request to be executed in a batch\n *\n * @class BatchRequest\n */\nexport class BatchRequest {\n  /**\n   * url used in request\n   *\n   * @type {string}\n   * @memberof BatchRequest\n   */\n  public resource: string;\n\n  /**\n   * method passed to be requested\n   *\n   * @type {string}\n   * @memberof BatchRequest\n   */\n  public method: string;\n\n  /**\n   * The index of the requests as it was added to the queue\n   * Use this value if you need to sort the responses\n   * in the order they were added\n   *\n   * @type {number}\n   * @memberof BatchRequest\n   */\n  public index: number;\n\n  /**\n   * The headers of the request\n   *\n   * @type {{[headerName: string]: string}}\n   * @memberof BatchRequest\n   */\n  public headers: { [header: string]: string };\n\n  /**\n   * The id of the requests\n   *\n   * @type {string}\n   * @memberof BatchRequest\n   */\n  public id: string;\n\n  constructor(index, id, resource: string, method: string) {\n    if (resource.charAt(0) !== '/') {\n      resource = '/' + resource;\n    }\n    this.resource = resource;\n    this.method = method;\n    this.index = index;\n    this.id = id;\n  }\n}\n\n/**\n * Method to reduce repetitive requests to the Graph\n *\n * @export\n * @class Batch\n */\n// tslint:disable-next-line: max-classes-per-file\nexport class Batch implements IBatch {\n  // this doesn't really mater what it is as long as it's a root base url\n  // otherwise a Request assumes the current path and that could change the relative path\n  private static baseUrl = 'https://graph.microsoft.com';\n\n  private allRequests: BatchRequest[];\n  private requestsQueue: number[];\n  private scopes: string[];\n  private retryAfter: number;\n\n  private graph: IGraph;\n\n  private nextIndex: number;\n\n  constructor(graph: IGraph) {\n    this.graph = graph;\n    this.allRequests = [];\n    this.requestsQueue = [];\n    this.scopes = [];\n    this.nextIndex = 0;\n    this.retryAfter = 0;\n  }\n\n  /**\n   * Get whether there are requests that have not been executed\n   *\n   * @readonly\n   * @memberof Batch\n   */\n  public get hasRequests() {\n    return this.requestsQueue.length > 0;\n  }\n\n  /**\n   * sets new request and scopes\n   *\n   * @param {string} id\n   * @param {string} resource\n   * @param {string[]} [scopes]\n   * @memberof Batch\n   */\n  public get(id: string, resource: string, scopes?: string[], headers?: { [header: string]: string }) {\n    const index = this.nextIndex++;\n    const request = new BatchRequest(index, id, resource, 'GET');\n    request.headers = headers;\n    this.allRequests.push(request);\n    this.requestsQueue.push(index);\n    if (scopes) {\n      this.scopes = this.scopes.concat(scopes);\n    }\n  }\n\n  /**\n   * Execute the next set of requests.\n   * This will execute up to 20 requests at a time\n   *\n   * @returns {Promise<Map<string, BatchResponse>>}\n   * @memberof Batch\n   */\n  public async executeNext(): Promise<Map<string, BatchResponse>> {\n    const responses: Map<string, BatchResponse> = new Map();\n\n    if (this.retryAfter) {\n      await delay(this.retryAfter * 1000);\n      this.retryAfter = 0;\n    }\n\n    if (!this.hasRequests) {\n      return responses;\n    }\n\n    // batch can support up to 20 requests\n    const nextBatch = this.requestsQueue.splice(0, 20);\n\n    const batchRequestContent = new BatchRequestContent();\n\n    for (const request of nextBatch.map(i => this.allRequests[i])) {\n      batchRequestContent.addRequest({\n        id: request.index.toString(),\n        request: new Request(Batch.baseUrl + request.resource, {\n          method: request.method,\n          headers: request.headers\n        })\n      });\n    }\n\n    const middlewareOptions: MiddlewareOptions[] = this.scopes.length ? prepScopes(...this.scopes) : [];\n    const batchRequest = this.graph.api('$batch').middlewareOptions(middlewareOptions);\n\n    const batchRequestBody = await batchRequestContent.getContent();\n    const batchResponse = await batchRequest.post(batchRequestBody);\n\n    for (const r of batchResponse.responses) {\n      const response = new BatchResponse();\n      const request = this.allRequests[r.id];\n\n      response.id = request.id;\n      response.index = request.index;\n      response.headers = r.headers;\n\n      if (r.status !== 200) {\n        if (r.status === 429) {\n          // this request was throttled\n          // add request back to queue and set retry wait time\n          this.requestsQueue.unshift(r.id);\n          this.retryAfter = Math.max(this.retryAfter, parseInt(r.headers['Retry-After'], 10) || 1);\n        }\n        continue;\n      } else if (r.headers['Content-Type'].includes('image/jpeg')) {\n        response.content = 'data:image/jpeg;base64,' + r.body;\n      } else if (r.headers['Content-Type'].includes('image/pjpeg')) {\n        response.content = 'data:image/pjpeg;base64,' + r.body;\n      } else if (r.headers['Content-Type'].includes('image/png')) {\n        response.content = 'data:image/png;base64,' + r.body;\n      } else {\n        response.content = r.body;\n      }\n\n      responses.set(request.id, response);\n    }\n\n    return responses;\n  }\n\n  /**\n   * Execute all requests, up to 20 at a time until\n   * all requests have been executed\n   *\n   * @returns {Promise<Map<string, BatchResponse>>}\n   * @memberof Batch\n   */\n  public async executeAll(): Promise<Map<string, BatchResponse>> {\n    const responses: Map<string, BatchResponse> = new Map();\n\n    while (this.hasRequests) {\n      const r = await this.executeNext();\n      for (const [key, value] of r) {\n        responses.set(key, value);\n      }\n    }\n\n    return responses;\n  }\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { MiddlewareOptions } from '@microsoft/microsoft-graph-client';\nimport { MgtBaseComponent } from '../components/baseComponent';\n\n/**\n * Middleware Options used for component telemetry\n *\n * @export\n * @class ComponentMiddlewareOptions\n * @implements {MiddlewareOptions}\n */\nexport class ComponentMiddlewareOptions implements MiddlewareOptions {\n  /**\n   * The name of the component\n   *\n   * @type {string}\n   * @memberof ComponentMiddlewareOptions\n   */\n  public componentName: string;\n\n  constructor(component: MgtBaseComponent | string) {\n    if (typeof component === 'string') {\n      this.componentName = component;\n    } else {\n      this.componentName = component.tagName.toLowerCase();\n    }\n  }\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { Context, Middleware } from '@microsoft/microsoft-graph-client';\nimport {\n  getRequestHeader,\n  setRequestHeader\n} from '@microsoft/microsoft-graph-client/lib/es/src/middleware/MiddlewareUtil';\nimport { ComponentMiddlewareOptions } from './ComponentMiddlewareOptions';\nimport { validateBaseURL } from './GraphHelpers';\n\n/**\n * Implements Middleware for the Graph sdk to inject\n * the toolkit version in the SdkVersion header\n *\n * @class SdkVersionMiddleware\n * @implements {Middleware}\n */\nexport class SdkVersionMiddleware implements Middleware {\n  /**\n   * @private\n   * A member to hold next middleware in the middleware chain\n   */\n  private _nextMiddleware: Middleware;\n  private _packageVersion: string;\n  private _providerName: string;\n\n  constructor(packageVersion: string, providerName?: string) {\n    this._packageVersion = packageVersion;\n    this._providerName = providerName;\n  }\n\n  // tslint:disable-next-line: completed-docs\n  public async execute(context: Context): Promise<void> {\n    try {\n      if (typeof context.request === 'string') {\n        if (validateBaseURL(context.request)) {\n          // Header parts must follow the format: 'name/version'\n          const headerParts: string[] = [];\n\n          const componentOptions = context.middlewareControl.getMiddlewareOptions(\n            ComponentMiddlewareOptions\n          ) as ComponentMiddlewareOptions;\n\n          if (componentOptions) {\n            const componentVersion: string = `${componentOptions.componentName}/${this._packageVersion}`;\n            headerParts.push(componentVersion);\n          }\n\n          if (this._providerName) {\n            const providerVersion: string = `${this._providerName}/${this._packageVersion}`;\n            headerParts.push(providerVersion);\n          }\n\n          // Package version\n          const packageVersion: string = `mgt/${this._packageVersion}`;\n          headerParts.push(packageVersion);\n\n          // Existing SdkVersion header value\n          headerParts.push(getRequestHeader(context.request, context.options, 'SdkVersion'));\n\n          // Join the header parts together and update the SdkVersion request header value\n          const sdkVersionHeaderValue = headerParts.join(', ');\n          setRequestHeader(context.request, context.options, 'SdkVersion', sdkVersionHeaderValue);\n        } else {\n          delete context?.options?.headers['SdkVersion'];\n        }\n      }\n    } catch (error) {\n      // ignore error\n    }\n    return await this._nextMiddleware.execute(context);\n  }\n\n  /**\n   * Handles setting of next middleware\n   *\n   * @param {Middleware} next\n   * @memberof SdkVersionMiddleware\n   */\n  public setNext(next: Middleware): void {\n    this._nextMiddleware = next;\n  }\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n// THIS FILE IS AUTO GENERATED\n// ANY CHANGES WILL BE LOST DURING BUILD\n\nexport const PACKAGE_VERSION = '3.0.0-preview.1-next.mgt-chat.97255fa';\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nclass CustomElementHelper {\n  private readonly defaultPrefix = 'mgt';\n  private _disambiguation = '';\n\n  /**\n   * Adds a disambiguation segment to the custom elements registered with the browser\n   *\n   * @param {string} disambiguation\n   * @return {CustomElementHelper} the current object\n   * @memberof CustomElementHelper\n   */\n  public withDisambiguation(disambiguation: string) {\n    if (disambiguation && !this._disambiguation) this._disambiguation = disambiguation;\n    return this;\n  }\n\n  /**\n   * Provides the prefix to be used for mgt web component tags\n   *\n   * @readonly\n   * @type {string}\n   * @memberof CustomElementHelper\n   */\n  public get prefix(): string {\n    return this._disambiguation ? `${this.defaultPrefix}-${this._disambiguation}` : this.defaultPrefix;\n  }\n\n  /**\n   * Returns the current value for the disambiguation\n   *\n   * @readonly\n   * @type {string}\n   * @memberof CustomElementHelper\n   */\n  public get disambiguation(): string {\n    return this._disambiguation;\n  }\n\n  /**\n   * Returns true if a value has been provided for the disambiguation\n   *\n   * @readonly\n   * @type {boolean}\n   * @memberof CustomElementHelper\n   */\n  public get isDisambiguated(): boolean {\n    return Boolean(this._disambiguation);\n  }\n\n  /**\n   * Removes disambiguation from the provided tagName.\n   * Intended for use when providing tag names in analytics headers passed by the Graph client\n   *\n   * @param {string} tagName\n   * @return {*}  {string}\n   * @memberof CustomElementHelper\n   */\n  public normalize(tagName: string): string {\n    return this.isDisambiguated\n      ? tagName.toUpperCase().replace(this.prefix.toUpperCase(), this.defaultPrefix.toUpperCase())\n      : tagName;\n  }\n}\n\n/**\n * Helper object to provide the desired prefix for mgt web component tags\n *\n * @type CustomElementHelper\n */\nconst customElementHelper = new CustomElementHelper();\nexport { customElementHelper };\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport {\n  AuthenticationHandler,\n  Client,\n  GraphRequest,\n  HTTPMessageHandler,\n  Middleware,\n  MiddlewareOptions,\n  RetryHandler,\n  RetryHandlerOptions,\n  TelemetryHandler\n} from '@microsoft/microsoft-graph-client';\n\nimport { IGraph, MICROSOFT_GRAPH_DEFAULT_ENDPOINT } from './IGraph';\nimport { IProvider } from './providers/IProvider';\nimport { Batch } from './utils/Batch';\nimport { ComponentMiddlewareOptions } from './utils/ComponentMiddlewareOptions';\nimport { chainMiddleware } from './utils/GraphHelpers';\nimport { SdkVersionMiddleware } from './utils/SdkVersionMiddleware';\nimport { PACKAGE_VERSION } from './utils/version';\nimport { customElementHelper } from './components/customElementHelper';\n\n/**\n * The version of the Graph to use for making requests.\n */\nconst GRAPH_VERSION = 'v1.0';\n\n/**\n * The base Graph implementation.\n *\n * @export\n * @abstract\n * @class Graph\n */\nexport class Graph implements IGraph {\n  /**\n   * the internal client used to make graph calls\n   *\n   * @readonly\n   * @type {Client}\n   * @memberof Graph\n   */\n  public get client(): Client {\n    return this._client;\n  }\n\n  /**\n   * the component name appended to Graph request headers\n   *\n   * @readonly\n   * @type {string}\n   * @memberof Graph\n   */\n  public get componentName(): string {\n    return this._componentName;\n  }\n\n  /**\n   * the version of the graph to query\n   *\n   * @readonly\n   * @type {string}\n   * @memberof Graph\n   */\n  public get version(): string {\n    return this._version;\n  }\n\n  private _client: Client;\n  private _componentName: string;\n  private _version: string;\n\n  constructor(client: Client, version: string = GRAPH_VERSION) {\n    this._client = client;\n    this._version = version;\n  }\n\n  /**\n   * Returns a new instance of the Graph using the same\n   * client within the context of the provider.\n   *\n   * @param {Element} component\n   * @returns {IGraph}\n   * @memberof Graph\n   */\n  public forComponent(component: Element | string): Graph {\n    const graph = new Graph(this._client, this._version);\n    graph.setComponent(component);\n    return graph;\n  }\n\n  /**\n   * Returns a new graph request for a specific component\n   * Used internally for analytics purposes\n   *\n   * @param {string} path\n   * @memberof Graph\n   */\n  public api(path: string): GraphRequest {\n    let request = this._client.api(path).version(this._version);\n\n    if (this._componentName) {\n      request.middlewareOptions = (options: MiddlewareOptions[]): GraphRequest => {\n        const requestObj = request as any;\n        requestObj._middlewareOptions = requestObj._middlewareOptions.concat(options);\n        return request;\n      };\n      request = request.middlewareOptions([new ComponentMiddlewareOptions(this._componentName)]);\n    }\n\n    return request;\n  }\n\n  /**\n   * creates a new batch request\n   *\n   * @returns {Batch}\n   * @memberof Graph\n   */\n  public createBatch(): Batch {\n    return new Batch(this);\n  }\n\n  /**\n   * sets the component name used in request headers.\n   *\n   * @protected\n   * @param {Element} component\n   * @memberof Graph\n   */\n  protected setComponent(component: Element | string): void {\n    this._componentName = component instanceof Element ? customElementHelper.normalize(component.tagName) : component;\n  }\n}\n\n/**\n * create a new Graph instance using the specified provider.\n *\n * @static\n * @param {IProvider} provider\n * @returns {Graph}\n * @memberof Graph\n */\nexport function createFromProvider(provider: IProvider, version?: string, component?: Element): Graph {\n  const middleware: Middleware[] = [\n    new AuthenticationHandler(provider),\n    new RetryHandler(new RetryHandlerOptions()),\n    new TelemetryHandler(),\n    new SdkVersionMiddleware(PACKAGE_VERSION, provider.name),\n    new HTTPMessageHandler()\n  ];\n\n  let baseURL = provider.baseURL ? provider.baseURL : MICROSOFT_GRAPH_DEFAULT_ENDPOINT;\n  const client = Client.initWithMiddleware({\n    middleware: chainMiddleware(...middleware),\n    baseUrl: baseURL\n  });\n\n  const graph = new Graph(client, version);\n  return component ? graph.forComponent(component) : graph;\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { IGraph } from './IGraph';\nimport { Client } from '@microsoft/microsoft-graph-client';\nimport { Graph } from './Graph';\n\n/**\n * The version of the Graph to use for making requests.\n */\nconst GRAPH_VERSION = 'beta';\n\n/**\n * BetaGraph\n *\n * @export\n * @class BetaGraph\n * @extends {BetaGraph}\n */\nexport class BetaGraph extends Graph {\n  /**\n   * get a BetaGraph instance based on an existing IGraph implementation.\n   *\n   * @static\n   * @param {Graph} graph\n   * @returns {BetaGraph}\n   * @memberof BetaGraph\n   */\n  public static fromGraph(graph: IGraph): BetaGraph {\n    const betaGraph = new BetaGraph(graph.client);\n    betaGraph.setComponent(graph.componentName);\n    return betaGraph;\n  }\n\n  constructor(client: Client, version: string = GRAPH_VERSION) {\n    super(client, version);\n  }\n\n  /**\n   * Returns a new instance of the Graph using the same\n   * client within the context of the provider.\n   *\n   * @param {Element} component\n   * @returns {BetaGraph}\n   * @memberof BetaGraph\n   */\n  public forComponent(component: Element | string): BetaGraph {\n    const graph = new BetaGraph(this.client);\n    this.setComponent(component);\n    return graph;\n  }\n}\n", "/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\n\nconst NODE_MODE = false;\nconst global = NODE_MODE ? globalThis : window;\n\n/**\n * Whether the current browser supports `adoptedStyleSheets`.\n */\nexport const supportsAdoptingStyleSheets =\n  global.ShadowRoot &&\n  (global.ShadyCSS === undefined || global.ShadyCSS.nativeShadow) &&\n  'adoptedStyleSheets' in Document.prototype &&\n  'replace' in CSSStyleSheet.prototype;\n\n/**\n * A CSSResult or native CSSStyleSheet.\n *\n * In browsers that support constructible CSS style sheets, CSSStyleSheet\n * object can be used for styling along side CSSResult from the `css`\n * template tag.\n */\nexport type CSSResultOrNative = CSSResult | CSSStyleSheet;\n\nexport type CSSResultArray = Array<CSSResultOrNative | CSSResultArray>;\n\n/**\n * A single CSSResult, CSSStyleSheet, or an array or nested arrays of those.\n */\nexport type CSSResultGroup = CSSResultOrNative | CSSResultArray;\n\nconst constructionToken = Symbol();\n\nconst cssTagCache = new WeakMap<TemplateStringsArray, CSSStyleSheet>();\n\n/**\n * A container for a string of CSS text, that may be used to create a CSSStyleSheet.\n *\n * CSSResult is the return value of `css`-tagged template literals and\n * `unsafeCSS()`. In order to ensure that CSSResults are only created via the\n * `css` tag and `unsafeCSS()`, CSSResult cannot be constructed directly.\n */\nexport class CSSResult {\n  // This property needs to remain unminified.\n  ['_$cssResult$'] = true;\n  readonly cssText: string;\n  private _styleSheet?: CSSStyleSheet;\n  private _strings: TemplateStringsArray | undefined;\n\n  private constructor(\n    cssText: string,\n    strings: TemplateStringsArray | undefined,\n    safeToken: symbol\n  ) {\n    if (safeToken !== constructionToken) {\n      throw new Error(\n        'CSSResult is not constructable. Use `unsafeCSS` or `css` instead.'\n      );\n    }\n    this.cssText = cssText;\n    this._strings = strings;\n  }\n\n  // This is a getter so that it's lazy. In practice, this means stylesheets\n  // are not created until the first element instance is made.\n  get styleSheet(): CSSStyleSheet | undefined {\n    // If `supportsAdoptingStyleSheets` is true then we assume CSSStyleSheet is\n    // constructable.\n    let styleSheet = this._styleSheet;\n    const strings = this._strings;\n    if (supportsAdoptingStyleSheets && styleSheet === undefined) {\n      const cacheable = strings !== undefined && strings.length === 1;\n      if (cacheable) {\n        styleSheet = cssTagCache.get(strings);\n      }\n      if (styleSheet === undefined) {\n        (this._styleSheet = styleSheet = new CSSStyleSheet()).replaceSync(\n          this.cssText\n        );\n        if (cacheable) {\n          cssTagCache.set(strings, styleSheet);\n        }\n      }\n    }\n    return styleSheet;\n  }\n\n  toString(): string {\n    return this.cssText;\n  }\n}\n\ntype ConstructableCSSResult = CSSResult & {\n  new (\n    cssText: string,\n    strings: TemplateStringsArray | undefined,\n    safeToken: symbol\n  ): CSSResult;\n};\n\nconst textFromCSSResult = (value: CSSResultGroup | number) => {\n  // This property needs to remain unminified.\n  if ((value as CSSResult)['_$cssResult$'] === true) {\n    return (value as CSSResult).cssText;\n  } else if (typeof value === 'number') {\n    return value;\n  } else {\n    throw new Error(\n      `Value passed to 'css' function must be a 'css' function result: ` +\n        `${value}. Use 'unsafeCSS' to pass non-literal values, but take care ` +\n        `to ensure page security.`\n    );\n  }\n};\n\n/**\n * Wrap a value for interpolation in a {@linkcode css} tagged template literal.\n *\n * This is unsafe because untrusted CSS text can be used to phone home\n * or exfiltrate data to an attacker controlled site. Take care to only use\n * this with trusted input.\n */\nexport const unsafeCSS = (value: unknown) =>\n  new (CSSResult as ConstructableCSSResult)(\n    typeof value === 'string' ? value : String(value),\n    undefined,\n    constructionToken\n  );\n\n/**\n * A template literal tag which can be used with LitElement's\n * {@linkcode LitElement.styles} property to set element styles.\n *\n * For security reasons, only literal string values and number may be used in\n * embedded expressions. To incorporate non-literal values {@linkcode unsafeCSS}\n * may be used inside an expression.\n */\nexport const css = (\n  strings: TemplateStringsArray,\n  ...values: (CSSResultGroup | number)[]\n): CSSResult => {\n  const cssText =\n    strings.length === 1\n      ? strings[0]\n      : values.reduce(\n          (acc, v, idx) => acc + textFromCSSResult(v) + strings[idx + 1],\n          strings[0]\n        );\n  return new (CSSResult as ConstructableCSSResult)(\n    cssText,\n    strings,\n    constructionToken\n  );\n};\n\n/**\n * Applies the given styles to a `shadowRoot`. When Shadow DOM is\n * available but `adoptedStyleSheets` is not, styles are appended to the\n * `shadowRoot` to [mimic spec behavior](https://wicg.github.io/construct-stylesheets/#using-constructed-stylesheets).\n * Note, when shimming is used, any styles that are subsequently placed into\n * the shadowRoot should be placed *before* any shimmed adopted styles. This\n * will match spec behavior that gives adopted sheets precedence over styles in\n * shadowRoot.\n */\nexport const adoptStyles = (\n  renderRoot: ShadowRoot,\n  styles: Array<CSSResultOrNative>\n) => {\n  if (supportsAdoptingStyleSheets) {\n    (renderRoot as ShadowRoot).adoptedStyleSheets = styles.map((s) =>\n      s instanceof CSSStyleSheet ? s : s.styleSheet!\n    );\n  } else {\n    styles.forEach((s) => {\n      const style = document.createElement('style');\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      const nonce = (global as any)['litNonce'];\n      if (nonce !== undefined) {\n        style.setAttribute('nonce', nonce);\n      }\n      style.textContent = (s as CSSResult).cssText;\n      renderRoot.appendChild(style);\n    });\n  }\n};\n\nconst cssResultFromStyleSheet = (sheet: CSSStyleSheet) => {\n  let cssText = '';\n  for (const rule of sheet.cssRules) {\n    cssText += rule.cssText;\n  }\n  return unsafeCSS(cssText);\n};\n\nexport const getCompatibleStyle =\n  supportsAdoptingStyleSheets ||\n  (NODE_MODE && global.CSSStyleSheet === undefined)\n    ? (s: CSSResultOrNative) => s\n    : (s: CSSResultOrNative) =>\n        s instanceof CSSStyleSheet ? cssResultFromStyleSheet(s) : s;\n", "/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\n\n/**\n * Use this module if you want to create your own base class extending\n * {@link ReactiveElement}.\n * @packageDocumentation\n */\n\nimport {\n  getCompatibleStyle,\n  adoptStyles,\n  CSSResultGroup,\n  CSSResultOrNative,\n} from './css-tag.js';\nimport type {\n  ReactiveController,\n  ReactiveControllerHost,\n} from './reactive-controller.js';\n\n// In the Node build, this import will be injected by Rollup:\n// import {HTMLElement, customElements} from '@lit-labs/ssr-dom-shim';\n\nexport * from './css-tag.js';\nexport type {\n  ReactiveController,\n  ReactiveControllerHost,\n} from './reactive-controller.js';\n\nconst NODE_MODE = false;\nconst global = NODE_MODE ? globalThis : window;\n\nif (NODE_MODE) {\n  global.customElements ??= customElements;\n}\n\nconst DEV_MODE = true;\n\nlet requestUpdateThenable: (name: string) => {\n  then: (\n    onfulfilled?: (value: boolean) => void,\n    _onrejected?: () => void\n  ) => void;\n};\n\nlet issueWarning: (code: string, warning: string) => void;\n\nconst trustedTypes = (global as unknown as {trustedTypes?: {emptyScript: ''}})\n  .trustedTypes;\n\n// Temporary workaround for https://crbug.com/993268\n// Currently, any attribute starting with \"on\" is considered to be a\n// TrustedScript source. Such boolean attributes must be set to the equivalent\n// trusted emptyScript value.\nconst emptyStringForBooleanAttribute = trustedTypes\n  ? (trustedTypes.emptyScript as unknown as '')\n  : '';\n\nconst polyfillSupport = DEV_MODE\n  ? global.reactiveElementPolyfillSupportDevMode\n  : global.reactiveElementPolyfillSupport;\n\nif (DEV_MODE) {\n  // Ensure warnings are issued only 1x, even if multiple versions of Lit\n  // are loaded.\n  const issuedWarnings: Set<string | undefined> = (global.litIssuedWarnings ??=\n    new Set());\n\n  // Issue a warning, if we haven't already.\n  issueWarning = (code: string, warning: string) => {\n    warning += ` See https://lit.dev/msg/${code} for more information.`;\n    if (!issuedWarnings.has(warning)) {\n      console.warn(warning);\n      issuedWarnings.add(warning);\n    }\n  };\n\n  issueWarning(\n    'dev-mode',\n    `Lit is in dev mode. Not recommended for production!`\n  );\n\n  // Issue polyfill support warning.\n  if (global.ShadyDOM?.inUse && polyfillSupport === undefined) {\n    issueWarning(\n      'polyfill-support-missing',\n      `Shadow DOM is being polyfilled via \\`ShadyDOM\\` but ` +\n        `the \\`polyfill-support\\` module has not been loaded.`\n    );\n  }\n\n  requestUpdateThenable = (name) => ({\n    then: (\n      onfulfilled?: (value: boolean) => void,\n      _onrejected?: () => void\n    ) => {\n      issueWarning(\n        'request-update-promise',\n        `The \\`requestUpdate\\` method should no longer return a Promise but ` +\n          `does so on \\`${name}\\`. Use \\`updateComplete\\` instead.`\n      );\n      if (onfulfilled !== undefined) {\n        onfulfilled(false);\n      }\n    },\n  });\n}\n\n/**\n * Contains types that are part of the unstable debug API.\n *\n * Everything in this API is not stable and may change or be removed in the future,\n * even on patch releases.\n */\n// eslint-disable-next-line @typescript-eslint/no-namespace\nexport namespace ReactiveUnstable {\n  /**\n   * When Lit is running in dev mode and `window.emitLitDebugLogEvents` is true,\n   * we will emit 'lit-debug' events to window, with live details about the update and render\n   * lifecycle. These can be useful for writing debug tooling and visualizations.\n   *\n   * Please be aware that running with window.emitLitDebugLogEvents has performance overhead,\n   * making certain operations that are normally very cheap (like a no-op render) much slower,\n   * because we must copy data and dispatch events.\n   */\n  // eslint-disable-next-line @typescript-eslint/no-namespace\n  export namespace DebugLog {\n    export type Entry = Update;\n    export interface Update {\n      kind: 'update';\n    }\n  }\n}\n\ninterface DebugLoggingWindow {\n  // Even in dev mode, we generally don't want to emit these events, as that's\n  // another level of cost, so only emit them when DEV_MODE is true _and_ when\n  // window.emitLitDebugEvents is true.\n  emitLitDebugLogEvents?: boolean;\n}\n\n/**\n * Useful for visualizing and logging insights into what the Lit template system is doing.\n *\n * Compiled out of prod mode builds.\n */\nconst debugLogEvent = DEV_MODE\n  ? (event: ReactiveUnstable.DebugLog.Entry) => {\n      const shouldEmit = (global as unknown as DebugLoggingWindow)\n        .emitLitDebugLogEvents;\n      if (!shouldEmit) {\n        return;\n      }\n      global.dispatchEvent(\n        new CustomEvent<ReactiveUnstable.DebugLog.Entry>('lit-debug', {\n          detail: event,\n        })\n      );\n    }\n  : undefined;\n\n/*\n * When using Closure Compiler, JSCompiler_renameProperty(property, object) is\n * replaced at compile time by the munged name for object[property]. We cannot\n * alias this function, so we have to use a small shim that has the same\n * behavior when not compiling.\n */\n/*@__INLINE__*/\nconst JSCompiler_renameProperty = <P extends PropertyKey>(\n  prop: P,\n  _obj: unknown\n): P => prop;\n\n/**\n * Converts property values to and from attribute values.\n */\nexport interface ComplexAttributeConverter<Type = unknown, TypeHint = unknown> {\n  /**\n   * Called to convert an attribute value to a property\n   * value.\n   */\n  fromAttribute?(value: string | null, type?: TypeHint): Type;\n\n  /**\n   * Called to convert a property value to an attribute\n   * value.\n   *\n   * It returns unknown instead of string, to be compatible with\n   * https://github.com/WICG/trusted-types (and similar efforts).\n   */\n  toAttribute?(value: Type, type?: TypeHint): unknown;\n}\n\ntype AttributeConverter<Type = unknown, TypeHint = unknown> =\n  | ComplexAttributeConverter<Type>\n  | ((value: string | null, type?: TypeHint) => Type);\n\n/**\n * Defines options for a property accessor.\n */\nexport interface PropertyDeclaration<Type = unknown, TypeHint = unknown> {\n  /**\n   * When set to `true`, indicates the property is internal private state. The\n   * property should not be set by users. When using TypeScript, this property\n   * should be marked as `private` or `protected`, and it is also a common\n   * practice to use a leading `_` in the name. The property is not added to\n   * `observedAttributes`.\n   */\n  readonly state?: boolean;\n\n  /**\n   * Indicates how and whether the property becomes an observed attribute.\n   * If the value is `false`, the property is not added to `observedAttributes`.\n   * If true or absent, the lowercased property name is observed (e.g. `fooBar`\n   * becomes `foobar`). If a string, the string value is observed (e.g\n   * `attribute: 'foo-bar'`).\n   */\n  readonly attribute?: boolean | string;\n\n  /**\n   * Indicates the type of the property. This is used only as a hint for the\n   * `converter` to determine how to convert the attribute\n   * to/from a property.\n   */\n  readonly type?: TypeHint;\n\n  /**\n   * Indicates how to convert the attribute to/from a property. If this value\n   * is a function, it is used to convert the attribute value a the property\n   * value. If it's an object, it can have keys for `fromAttribute` and\n   * `toAttribute`. If no `toAttribute` function is provided and\n   * `reflect` is set to `true`, the property value is set directly to the\n   * attribute. A default `converter` is used if none is provided; it supports\n   * `Boolean`, `String`, `Number`, `Object`, and `Array`. Note,\n   * when a property changes and the converter is used to update the attribute,\n   * the property is never updated again as a result of the attribute changing,\n   * and vice versa.\n   */\n  readonly converter?: AttributeConverter<Type, TypeHint>;\n\n  /**\n   * Indicates if the property should reflect to an attribute.\n   * If `true`, when the property is set, the attribute is set using the\n   * attribute name determined according to the rules for the `attribute`\n   * property option and the value of the property converted using the rules\n   * from the `converter` property option.\n   */\n  readonly reflect?: boolean;\n\n  /**\n   * A function that indicates if a property should be considered changed when\n   * it is set. The function should take the `newValue` and `oldValue` and\n   * return `true` if an update should be requested.\n   */\n  hasChanged?(value: Type, oldValue: Type): boolean;\n\n  /**\n   * Indicates whether an accessor will be created for this property. By\n   * default, an accessor will be generated for this property that requests an\n   * update when set. If this flag is `true`, no accessor will be created, and\n   * it will be the user's responsibility to call\n   * `this.requestUpdate(propertyName, oldValue)` to request an update when\n   * the property changes.\n   */\n  readonly noAccessor?: boolean;\n}\n\n/**\n * Map of properties to PropertyDeclaration options. For each property an\n * accessor is made, and the property is processed according to the\n * PropertyDeclaration options.\n */\nexport interface PropertyDeclarations {\n  readonly [key: string]: PropertyDeclaration;\n}\n\ntype PropertyDeclarationMap = Map<PropertyKey, PropertyDeclaration>;\n\ntype AttributeMap = Map<string, PropertyKey>;\n\n/**\n * A Map of property keys to values.\n *\n * Takes an optional type parameter T, which when specified as a non-any,\n * non-unknown type, will make the Map more strongly-typed, associating the map\n * keys with their corresponding value type on T.\n *\n * Use `PropertyValues<this>` when overriding ReactiveElement.update() and\n * other lifecycle methods in order to get stronger type-checking on keys\n * and values.\n */\n// This type is conditional so that if the parameter T is not specified, or\n// is `any`, the type will include `Map<PropertyKey, unknown>`. Since T is not\n// given in the uses of PropertyValues in this file, all uses here fallback to\n// meaning `Map<PropertyKey, unknown>`, but if a developer uses\n// `PropertyValues<this>` (or any other value for T) they will get a\n// strongly-typed Map type.\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport type PropertyValues<T = any> = T extends object\n  ? PropertyValueMap<T>\n  : Map<PropertyKey, unknown>;\n\n/**\n * Do not use, instead prefer {@linkcode PropertyValues}.\n */\n// This type must be exported such that JavaScript generated by the Google\n// Closure Compiler can import a type reference.\nexport interface PropertyValueMap<T> extends Map<PropertyKey, unknown> {\n  get<K extends keyof T>(k: K): T[K];\n  set<K extends keyof T>(key: K, value: T[K]): this;\n  has<K extends keyof T>(k: K): boolean;\n  delete<K extends keyof T>(k: K): boolean;\n}\n\nexport const defaultConverter: ComplexAttributeConverter = {\n  toAttribute(value: unknown, type?: unknown): unknown {\n    switch (type) {\n      case Boolean:\n        value = value ? emptyStringForBooleanAttribute : null;\n        break;\n      case Object:\n      case Array:\n        // if the value is `null` or `undefined` pass this through\n        // to allow removing/no change behavior.\n        value = value == null ? value : JSON.stringify(value);\n        break;\n    }\n    return value;\n  },\n\n  fromAttribute(value: string | null, type?: unknown) {\n    let fromValue: unknown = value;\n    switch (type) {\n      case Boolean:\n        fromValue = value !== null;\n        break;\n      case Number:\n        fromValue = value === null ? null : Number(value);\n        break;\n      case Object:\n      case Array:\n        // Do *not* generate exception when invalid JSON is set as elements\n        // don't normally complain on being mis-configured.\n        // TODO(sorvell): Do generate exception in *dev mode*.\n        try {\n          // Assert to adhere to Bazel's \"must type assert JSON parse\" rule.\n          fromValue = JSON.parse(value!) as unknown;\n        } catch (e) {\n          fromValue = null;\n        }\n        break;\n    }\n    return fromValue;\n  },\n};\n\nexport interface HasChanged {\n  (value: unknown, old: unknown): boolean;\n}\n\n/**\n * Change function that returns true if `value` is different from `oldValue`.\n * This method is used as the default for a property's `hasChanged` function.\n */\nexport const notEqual: HasChanged = (value: unknown, old: unknown): boolean => {\n  // This ensures (old==NaN, value==NaN) always returns false\n  return old !== value && (old === old || value === value);\n};\n\nconst defaultPropertyDeclaration: PropertyDeclaration = {\n  attribute: true,\n  type: String,\n  converter: defaultConverter,\n  reflect: false,\n  hasChanged: notEqual,\n};\n\n/**\n * The Closure JS Compiler doesn't currently have good support for static\n * property semantics where \"this\" is dynamic (e.g.\n * https://github.com/google/closure-compiler/issues/3177 and others) so we use\n * this hack to bypass any rewriting by the compiler.\n */\nconst finalized = 'finalized';\n\n/**\n * A string representing one of the supported dev mode warning categories.\n */\nexport type WarningKind = 'change-in-update' | 'migration';\n\nexport type Initializer = (element: ReactiveElement) => void;\n\n/**\n * Base element class which manages element properties and attributes. When\n * properties change, the `update` method is asynchronously called. This method\n * should be supplied by subclassers to render updates as desired.\n * @noInheritDoc\n */\nexport abstract class ReactiveElement\n  // In the Node build, this `extends` clause will be substituted with\n  // `(globalThis.HTMLElement ?? HTMLElement)`.\n  //\n  // This way, we will first prefer any global `HTMLElement` polyfill that the\n  // user has assigned, and then fall back to the `HTMLElement` shim which has\n  // been imported (see note at the top of this file about how this import is\n  // generated by Rollup). Note that the `HTMLElement` variable has been\n  // shadowed by this import, so it no longer refers to the global.\n  extends HTMLElement\n  implements ReactiveControllerHost\n{\n  // Note: these are patched in only in DEV_MODE.\n  /**\n   * Read or set all the enabled warning categories for this class.\n   *\n   * This property is only used in development builds.\n   *\n   * @nocollapse\n   * @category dev-mode\n   */\n  static enabledWarnings?: WarningKind[];\n\n  /**\n   * Enable the given warning category for this class.\n   *\n   * This method only exists in development builds, so it should be accessed\n   * with a guard like:\n   *\n   * ```ts\n   * // Enable for all ReactiveElement subclasses\n   * ReactiveElement.enableWarning?.('migration');\n   *\n   * // Enable for only MyElement and subclasses\n   * MyElement.enableWarning?.('migration');\n   * ```\n   *\n   * @nocollapse\n   * @category dev-mode\n   */\n  static enableWarning?: (warningKind: WarningKind) => void;\n\n  /**\n   * Disable the given warning category for this class.\n   *\n   * This method only exists in development builds, so it should be accessed\n   * with a guard like:\n   *\n   * ```ts\n   * // Disable for all ReactiveElement subclasses\n   * ReactiveElement.disableWarning?.('migration');\n   *\n   * // Disable for only MyElement and subclasses\n   * MyElement.disableWarning?.('migration');\n   * ```\n   *\n   * @nocollapse\n   * @category dev-mode\n   */\n  static disableWarning?: (warningKind: WarningKind) => void;\n\n  /**\n   * Adds an initializer function to the class that is called during instance\n   * construction.\n   *\n   * This is useful for code that runs against a `ReactiveElement`\n   * subclass, such as a decorator, that needs to do work for each\n   * instance, such as setting up a `ReactiveController`.\n   *\n   * ```ts\n   * const myDecorator = (target: typeof ReactiveElement, key: string) => {\n   *   target.addInitializer((instance: ReactiveElement) => {\n   *     // This is run during construction of the element\n   *     new MyController(instance);\n   *   });\n   * }\n   * ```\n   *\n   * Decorating a field will then cause each instance to run an initializer\n   * that adds a controller:\n   *\n   * ```ts\n   * class MyElement extends LitElement {\n   *   @myDecorator foo;\n   * }\n   * ```\n   *\n   * Initializers are stored per-constructor. Adding an initializer to a\n   * subclass does not add it to a superclass. Since initializers are run in\n   * constructors, initializers will run in order of the class hierarchy,\n   * starting with superclasses and progressing to the instance's class.\n   *\n   * @nocollapse\n   */\n  static addInitializer(initializer: Initializer) {\n    this.finalize();\n    (this._initializers ??= []).push(initializer);\n  }\n\n  static _initializers?: Initializer[];\n\n  /*\n   * Due to closure compiler ES6 compilation bugs, @nocollapse is required on\n   * all static methods and properties with initializers.  Reference:\n   * - https://github.com/google/closure-compiler/issues/1776\n   */\n\n  /**\n   * Maps attribute names to properties; for example `foobar` attribute to\n   * `fooBar` property. Created lazily on user subclasses when finalizing the\n   * class.\n   * @nocollapse\n   */\n  private static __attributeToPropertyMap: AttributeMap;\n\n  /**\n   * Marks class as having finished creating properties.\n   */\n  protected static [finalized] = true;\n\n  /**\n   * Memoized list of all element properties, including any superclass properties.\n   * Created lazily on user subclasses when finalizing the class.\n   * @nocollapse\n   * @category properties\n   */\n  static elementProperties: PropertyDeclarationMap = new Map();\n\n  /**\n   * User-supplied object that maps property names to `PropertyDeclaration`\n   * objects containing options for configuring reactive properties. When\n   * a reactive property is set the element will update and render.\n   *\n   * By default properties are public fields, and as such, they should be\n   * considered as primarily settable by element users, either via attribute or\n   * the property itself.\n   *\n   * Generally, properties that are changed by the element should be private or\n   * protected fields and should use the `state: true` option. Properties\n   * marked as `state` do not reflect from the corresponding attribute\n   *\n   * However, sometimes element code does need to set a public property. This\n   * should typically only be done in response to user interaction, and an event\n   * should be fired informing the user; for example, a checkbox sets its\n   * `checked` property when clicked and fires a `changed` event. Mutating\n   * public properties should typically not be done for non-primitive (object or\n   * array) properties. In other cases when an element needs to manage state, a\n   * private property set with the `state: true` option should be used. When\n   * needed, state properties can be initialized via public properties to\n   * facilitate complex interactions.\n   * @nocollapse\n   * @category properties\n   */\n  static properties: PropertyDeclarations;\n\n  /**\n   * Memoized list of all element styles.\n   * Created lazily on user subclasses when finalizing the class.\n   * @nocollapse\n   * @category styles\n   */\n  static elementStyles: Array<CSSResultOrNative> = [];\n\n  /**\n   * Array of styles to apply to the element. The styles should be defined\n   * using the {@linkcode css} tag function, via constructible stylesheets, or\n   * imported from native CSS module scripts.\n   *\n   * Note on Content Security Policy:\n   *\n   * Element styles are implemented with `<style>` tags when the browser doesn't\n   * support adopted StyleSheets. To use such `<style>` tags with the style-src\n   * CSP directive, the style-src value must either include 'unsafe-inline' or\n   * `nonce-<base64-value>` with `<base64-value>` replaced be a server-generated\n   * nonce.\n   *\n   * To provide a nonce to use on generated `<style>` elements, set\n   * `window.litNonce` to a server-generated nonce in your page's HTML, before\n   * loading application code:\n   *\n   * ```html\n   * <script>\n   *   // Generated and unique per request:\n   *   window.litNonce = 'a1b2c3d4';\n   * </script>\n   * ```\n   * @nocollapse\n   * @category styles\n   */\n  static styles?: CSSResultGroup;\n\n  /**\n   * The set of properties defined by this class that caused an accessor to be\n   * added during `createProperty`.\n   * @nocollapse\n   */\n  private static __reactivePropertyKeys?: Set<PropertyKey>;\n\n  /**\n   * Returns a list of attributes corresponding to the registered properties.\n   * @nocollapse\n   * @category attributes\n   */\n  static get observedAttributes() {\n    // note: piggy backing on this to ensure we're finalized.\n    this.finalize();\n    const attributes: string[] = [];\n    // Use forEach so this works even if for/of loops are compiled to for loops\n    // expecting arrays\n    this.elementProperties.forEach((v, p) => {\n      const attr = this.__attributeNameForProperty(p, v);\n      if (attr !== undefined) {\n        this.__attributeToPropertyMap.set(attr, p);\n        attributes.push(attr);\n      }\n    });\n    return attributes;\n  }\n\n  /**\n   * Creates a property accessor on the element prototype if one does not exist\n   * and stores a {@linkcode PropertyDeclaration} for the property with the\n   * given options. The property setter calls the property's `hasChanged`\n   * property option or uses a strict identity check to determine whether or not\n   * to request an update.\n   *\n   * This method may be overridden to customize properties; however,\n   * when doing so, it's important to call `super.createProperty` to ensure\n   * the property is setup correctly. This method calls\n   * `getPropertyDescriptor` internally to get a descriptor to install.\n   * To customize what properties do when they are get or set, override\n   * `getPropertyDescriptor`. To customize the options for a property,\n   * implement `createProperty` like this:\n   *\n   * ```ts\n   * static createProperty(name, options) {\n   *   options = Object.assign(options, {myOption: true});\n   *   super.createProperty(name, options);\n   * }\n   * ```\n   *\n   * @nocollapse\n   * @category properties\n   */\n  static createProperty(\n    name: PropertyKey,\n    options: PropertyDeclaration = defaultPropertyDeclaration\n  ) {\n    // if this is a state property, force the attribute to false.\n    if (options.state) {\n      // Cast as any since this is readonly.\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      (options as any).attribute = false;\n    }\n    // Note, since this can be called by the `@property` decorator which\n    // is called before `finalize`, we ensure finalization has been kicked off.\n    this.finalize();\n    this.elementProperties.set(name, options);\n    // Do not generate an accessor if the prototype already has one, since\n    // it would be lost otherwise and that would never be the user's intention;\n    // Instead, we expect users to call `requestUpdate` themselves from\n    // user-defined accessors. Note that if the super has an accessor we will\n    // still overwrite it\n    if (!options.noAccessor && !this.prototype.hasOwnProperty(name)) {\n      const key = typeof name === 'symbol' ? Symbol() : `__${name}`;\n      const descriptor = this.getPropertyDescriptor(name, key, options);\n      if (descriptor !== undefined) {\n        Object.defineProperty(this.prototype, name, descriptor);\n        if (DEV_MODE) {\n          // If this class doesn't have its own set, create one and initialize\n          // with the values in the set from the nearest ancestor class, if any.\n          if (!this.hasOwnProperty('__reactivePropertyKeys')) {\n            this.__reactivePropertyKeys = new Set(\n              this.__reactivePropertyKeys ?? []\n            );\n          }\n          this.__reactivePropertyKeys!.add(name);\n        }\n      }\n    }\n  }\n\n  /**\n   * Returns a property descriptor to be defined on the given named property.\n   * If no descriptor is returned, the property will not become an accessor.\n   * For example,\n   *\n   * ```ts\n   * class MyElement extends LitElement {\n   *   static getPropertyDescriptor(name, key, options) {\n   *     const defaultDescriptor =\n   *         super.getPropertyDescriptor(name, key, options);\n   *     const setter = defaultDescriptor.set;\n   *     return {\n   *       get: defaultDescriptor.get,\n   *       set(value) {\n   *         setter.call(this, value);\n   *         // custom action.\n   *       },\n   *       configurable: true,\n   *       enumerable: true\n   *     }\n   *   }\n   * }\n   * ```\n   *\n   * @nocollapse\n   * @category properties\n   */\n  protected static getPropertyDescriptor(\n    name: PropertyKey,\n    key: string | symbol,\n    options: PropertyDeclaration\n  ): PropertyDescriptor | undefined {\n    return {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      get(): any {\n        return (this as {[key: string]: unknown})[key as string];\n      },\n      set(this: ReactiveElement, value: unknown) {\n        const oldValue = (this as {} as {[key: string]: unknown})[\n          name as string\n        ];\n        (this as {} as {[key: string]: unknown})[key as string] = value;\n        (this as unknown as ReactiveElement).requestUpdate(\n          name,\n          oldValue,\n          options\n        );\n      },\n      configurable: true,\n      enumerable: true,\n    };\n  }\n\n  /**\n   * Returns the property options associated with the given property.\n   * These options are defined with a `PropertyDeclaration` via the `properties`\n   * object or the `@property` decorator and are registered in\n   * `createProperty(...)`.\n   *\n   * Note, this method should be considered \"final\" and not overridden. To\n   * customize the options for a given property, override\n   * {@linkcode createProperty}.\n   *\n   * @nocollapse\n   * @final\n   * @category properties\n   */\n  static getPropertyOptions(name: PropertyKey) {\n    return this.elementProperties.get(name) || defaultPropertyDeclaration;\n  }\n\n  /**\n   * Creates property accessors for registered properties, sets up element\n   * styling, and ensures any superclasses are also finalized. Returns true if\n   * the element was finalized.\n   * @nocollapse\n   */\n  protected static finalize() {\n    if (this.hasOwnProperty(finalized)) {\n      return false;\n    }\n    this[finalized] = true;\n    // finalize any superclasses\n    const superCtor = Object.getPrototypeOf(this) as typeof ReactiveElement;\n    superCtor.finalize();\n    // Create own set of initializers for this class if any exist on the\n    // superclass and copy them down. Note, for a small perf boost, avoid\n    // creating initializers unless needed.\n    if (superCtor._initializers !== undefined) {\n      this._initializers = [...superCtor._initializers];\n    }\n    this.elementProperties = new Map(superCtor.elementProperties);\n    // initialize Map populated in observedAttributes\n    this.__attributeToPropertyMap = new Map();\n    // make any properties\n    // Note, only process \"own\" properties since this element will inherit\n    // any properties defined on the superClass, and finalization ensures\n    // the entire prototype chain is finalized.\n    if (this.hasOwnProperty(JSCompiler_renameProperty('properties', this))) {\n      const props = this.properties;\n      // support symbols in properties (IE11 does not support this)\n      const propKeys = [\n        ...Object.getOwnPropertyNames(props),\n        ...Object.getOwnPropertySymbols(props),\n      ];\n      // This for/of is ok because propKeys is an array\n      for (const p of propKeys) {\n        // note, use of `any` is due to TypeScript lack of support for symbol in\n        // index types\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        this.createProperty(p, (props as any)[p]);\n      }\n    }\n    this.elementStyles = this.finalizeStyles(this.styles);\n    // DEV mode warnings\n    if (DEV_MODE) {\n      const warnRemovedOrRenamed = (name: string, renamed = false) => {\n        if (this.prototype.hasOwnProperty(name)) {\n          issueWarning(\n            renamed ? 'renamed-api' : 'removed-api',\n            `\\`${name}\\` is implemented on class ${this.name}. It ` +\n              `has been ${renamed ? 'renamed' : 'removed'} ` +\n              `in this version of LitElement.`\n          );\n        }\n      };\n      warnRemovedOrRenamed('initialize');\n      warnRemovedOrRenamed('requestUpdateInternal');\n      warnRemovedOrRenamed('_getUpdateComplete', true);\n    }\n    return true;\n  }\n\n  /**\n   * Options used when calling `attachShadow`. Set this property to customize\n   * the options for the shadowRoot; for example, to create a closed\n   * shadowRoot: `{mode: 'closed'}`.\n   *\n   * Note, these options are used in `createRenderRoot`. If this method\n   * is customized, options should be respected if possible.\n   * @nocollapse\n   * @category rendering\n   */\n  static shadowRootOptions: ShadowRootInit = {mode: 'open'};\n\n  /**\n   * Takes the styles the user supplied via the `static styles` property and\n   * returns the array of styles to apply to the element.\n   * Override this method to integrate into a style management system.\n   *\n   * Styles are deduplicated preserving the _last_ instance in the list. This\n   * is a performance optimization to avoid duplicated styles that can occur\n   * especially when composing via subclassing. The last item is kept to try\n   * to preserve the cascade order with the assumption that it's most important\n   * that last added styles override previous styles.\n   *\n   * @nocollapse\n   * @category styles\n   */\n  protected static finalizeStyles(\n    styles?: CSSResultGroup\n  ): Array<CSSResultOrNative> {\n    const elementStyles = [];\n    if (Array.isArray(styles)) {\n      // Dedupe the flattened array in reverse order to preserve the last items.\n      // Casting to Array<unknown> works around TS error that\n      // appears to come from trying to flatten a type CSSResultArray.\n      const set = new Set((styles as Array<unknown>).flat(Infinity).reverse());\n      // Then preserve original order by adding the set items in reverse order.\n      for (const s of set) {\n        elementStyles.unshift(getCompatibleStyle(s as CSSResultOrNative));\n      }\n    } else if (styles !== undefined) {\n      elementStyles.push(getCompatibleStyle(styles));\n    }\n    return elementStyles;\n  }\n\n  /**\n   * Node or ShadowRoot into which element DOM should be rendered. Defaults\n   * to an open shadowRoot.\n   * @category rendering\n   */\n  readonly renderRoot!: HTMLElement | ShadowRoot;\n\n  /**\n   * Returns the property name for the given attribute `name`.\n   * @nocollapse\n   */\n  private static __attributeNameForProperty(\n    name: PropertyKey,\n    options: PropertyDeclaration\n  ) {\n    const attribute = options.attribute;\n    return attribute === false\n      ? undefined\n      : typeof attribute === 'string'\n      ? attribute\n      : typeof name === 'string'\n      ? name.toLowerCase()\n      : undefined;\n  }\n\n  private __instanceProperties?: PropertyValues = new Map();\n  // Initialize to an unresolved Promise so we can make sure the element has\n  // connected before first update.\n  private __updatePromise!: Promise<boolean>;\n\n  /**\n   * True if there is a pending update as a result of calling `requestUpdate()`.\n   * Should only be read.\n   * @category updates\n   */\n  isUpdatePending = false;\n\n  /**\n   * Is set to `true` after the first update. The element code cannot assume\n   * that `renderRoot` exists before the element `hasUpdated`.\n   * @category updates\n   */\n  hasUpdated = false;\n\n  /**\n   * Map with keys for any properties that have changed since the last\n   * update cycle with previous values.\n   *\n   * @internal\n   */\n  _$changedProperties!: PropertyValues;\n\n  /**\n   * Map with keys of properties that should be reflected when updated.\n   */\n  private __reflectingProperties?: Map<PropertyKey, PropertyDeclaration>;\n\n  /**\n   * Name of currently reflecting property\n   */\n  private __reflectingProperty: PropertyKey | null = null;\n\n  /**\n   * Set of controllers.\n   */\n  private __controllers?: ReactiveController[];\n\n  constructor() {\n    super();\n    this._initialize();\n  }\n\n  /**\n   * Internal only override point for customizing work done when elements\n   * are constructed.\n   *\n   * @internal\n   */\n  _initialize() {\n    this.__updatePromise = new Promise<boolean>(\n      (res) => (this.enableUpdating = res)\n    );\n    this._$changedProperties = new Map();\n    this.__saveInstanceProperties();\n    // ensures first update will be caught by an early access of\n    // `updateComplete`\n    this.requestUpdate();\n    (this.constructor as typeof ReactiveElement)._initializers?.forEach((i) =>\n      i(this)\n    );\n  }\n\n  /**\n   * Registers a `ReactiveController` to participate in the element's reactive\n   * update cycle. The element automatically calls into any registered\n   * controllers during its lifecycle callbacks.\n   *\n   * If the element is connected when `addController()` is called, the\n   * controller's `hostConnected()` callback will be immediately called.\n   * @category controllers\n   */\n  addController(controller: ReactiveController) {\n    (this.__controllers ??= []).push(controller);\n    // If a controller is added after the element has been connected,\n    // call hostConnected. Note, re-using existence of `renderRoot` here\n    // (which is set in connectedCallback) to avoid the need to track a\n    // first connected state.\n    if (this.renderRoot !== undefined && this.isConnected) {\n      controller.hostConnected?.();\n    }\n  }\n\n  /**\n   * Removes a `ReactiveController` from the element.\n   * @category controllers\n   */\n  removeController(controller: ReactiveController) {\n    // Note, if the indexOf is -1, the >>> will flip the sign which makes the\n    // splice do nothing.\n    this.__controllers?.splice(this.__controllers.indexOf(controller) >>> 0, 1);\n  }\n\n  /**\n   * Fixes any properties set on the instance before upgrade time.\n   * Otherwise these would shadow the accessor and break these properties.\n   * The properties are stored in a Map which is played back after the\n   * constructor runs. Note, on very old versions of Safari (<=9) or Chrome\n   * (<=41), properties created for native platform properties like (`id` or\n   * `name`) may not have default values set in the element constructor. On\n   * these browsers native properties appear on instances and therefore their\n   * default value will overwrite any element default (e.g. if the element sets\n   * this.id = 'id' in the constructor, the 'id' will become '' since this is\n   * the native platform default).\n   */\n  private __saveInstanceProperties() {\n    // Use forEach so this works even if for/of loops are compiled to for loops\n    // expecting arrays\n    (this.constructor as typeof ReactiveElement).elementProperties.forEach(\n      (_v, p) => {\n        if (this.hasOwnProperty(p)) {\n          this.__instanceProperties!.set(p, this[p as keyof this]);\n          delete this[p as keyof this];\n        }\n      }\n    );\n  }\n\n  /**\n   * Returns the node into which the element should render and by default\n   * creates and returns an open shadowRoot. Implement to customize where the\n   * element's DOM is rendered. For example, to render into the element's\n   * childNodes, return `this`.\n   *\n   * @return Returns a node into which to render.\n   * @category rendering\n   */\n  protected createRenderRoot(): Element | ShadowRoot {\n    const renderRoot =\n      this.shadowRoot ??\n      this.attachShadow(\n        (this.constructor as typeof ReactiveElement).shadowRootOptions\n      );\n    adoptStyles(\n      renderRoot,\n      (this.constructor as typeof ReactiveElement).elementStyles\n    );\n    return renderRoot;\n  }\n\n  /**\n   * On first connection, creates the element's renderRoot, sets up\n   * element styling, and enables updating.\n   * @category lifecycle\n   */\n  connectedCallback() {\n    // create renderRoot before first update.\n    if (this.renderRoot === undefined) {\n      (\n        this as {\n          renderRoot: Element | DocumentFragment;\n        }\n      ).renderRoot = this.createRenderRoot();\n    }\n    this.enableUpdating(true);\n    this.__controllers?.forEach((c) => c.hostConnected?.());\n  }\n\n  /**\n   * Note, this method should be considered final and not overridden. It is\n   * overridden on the element instance with a function that triggers the first\n   * update.\n   * @category updates\n   */\n  protected enableUpdating(_requestedUpdate: boolean) {}\n\n  /**\n   * Allows for `super.disconnectedCallback()` in extensions while\n   * reserving the possibility of making non-breaking feature additions\n   * when disconnecting at some point in the future.\n   * @category lifecycle\n   */\n  disconnectedCallback() {\n    this.__controllers?.forEach((c) => c.hostDisconnected?.());\n  }\n\n  /**\n   * Synchronizes property values when attributes change.\n   *\n   * Specifically, when an attribute is set, the corresponding property is set.\n   * You should rarely need to implement this callback. If this method is\n   * overridden, `super.attributeChangedCallback(name, _old, value)` must be\n   * called.\n   *\n   * See [using the lifecycle callbacks](https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_custom_elements#using_the_lifecycle_callbacks)\n   * on MDN for more information about the `attributeChangedCallback`.\n   * @category attributes\n   */\n  attributeChangedCallback(\n    name: string,\n    _old: string | null,\n    value: string | null\n  ) {\n    this._$attributeToProperty(name, value);\n  }\n\n  private __propertyToAttribute(\n    name: PropertyKey,\n    value: unknown,\n    options: PropertyDeclaration = defaultPropertyDeclaration\n  ) {\n    const attr = (\n      this.constructor as typeof ReactiveElement\n    ).__attributeNameForProperty(name, options);\n    if (attr !== undefined && options.reflect === true) {\n      const converter =\n        (options.converter as ComplexAttributeConverter)?.toAttribute !==\n        undefined\n          ? (options.converter as ComplexAttributeConverter)\n          : defaultConverter;\n      const attrValue = converter.toAttribute!(value, options.type);\n      if (\n        DEV_MODE &&\n        (this.constructor as typeof ReactiveElement).enabledWarnings!.indexOf(\n          'migration'\n        ) >= 0 &&\n        attrValue === undefined\n      ) {\n        issueWarning(\n          'undefined-attribute-value',\n          `The attribute value for the ${name as string} property is ` +\n            `undefined on element ${this.localName}. The attribute will be ` +\n            `removed, but in the previous version of \\`ReactiveElement\\`, ` +\n            `the attribute would not have changed.`\n        );\n      }\n      // Track if the property is being reflected to avoid\n      // setting the property again via `attributeChangedCallback`. Note:\n      // 1. this takes advantage of the fact that the callback is synchronous.\n      // 2. will behave incorrectly if multiple attributes are in the reaction\n      // stack at time of calling. However, since we process attributes\n      // in `update` this should not be possible (or an extreme corner case\n      // that we'd like to discover).\n      // mark state reflecting\n      this.__reflectingProperty = name;\n      if (attrValue == null) {\n        this.removeAttribute(attr);\n      } else {\n        this.setAttribute(attr, attrValue as string);\n      }\n      // mark state not reflecting\n      this.__reflectingProperty = null;\n    }\n  }\n\n  /** @internal */\n  _$attributeToProperty(name: string, value: string | null) {\n    const ctor = this.constructor as typeof ReactiveElement;\n    // Note, hint this as an `AttributeMap` so closure clearly understands\n    // the type; it has issues with tracking types through statics\n    const propName = (ctor.__attributeToPropertyMap as AttributeMap).get(name);\n    // Use tracking info to avoid reflecting a property value to an attribute\n    // if it was just set because the attribute changed.\n    if (propName !== undefined && this.__reflectingProperty !== propName) {\n      const options = ctor.getPropertyOptions(propName);\n      const converter =\n        typeof options.converter === 'function'\n          ? {fromAttribute: options.converter}\n          : options.converter?.fromAttribute !== undefined\n          ? options.converter\n          : defaultConverter;\n      // mark state reflecting\n      this.__reflectingProperty = propName;\n      this[propName as keyof this] = converter.fromAttribute!(\n        value,\n        options.type\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      ) as any;\n      // mark state not reflecting\n      this.__reflectingProperty = null;\n    }\n  }\n\n  /**\n   * Requests an update which is processed asynchronously. This should be called\n   * when an element should update based on some state not triggered by setting\n   * a reactive property. In this case, pass no arguments. It should also be\n   * called when manually implementing a property setter. In this case, pass the\n   * property `name` and `oldValue` to ensure that any configured property\n   * options are honored.\n   *\n   * @param name name of requesting property\n   * @param oldValue old value of requesting property\n   * @param options property options to use instead of the previously\n   *     configured options\n   * @category updates\n   */\n  requestUpdate(\n    name?: PropertyKey,\n    oldValue?: unknown,\n    options?: PropertyDeclaration\n  ): void {\n    let shouldRequestUpdate = true;\n    // If we have a property key, perform property update steps.\n    if (name !== undefined) {\n      options =\n        options ||\n        (this.constructor as typeof ReactiveElement).getPropertyOptions(name);\n      const hasChanged = options.hasChanged || notEqual;\n      if (hasChanged(this[name as keyof this], oldValue)) {\n        if (!this._$changedProperties.has(name)) {\n          this._$changedProperties.set(name, oldValue);\n        }\n        // Add to reflecting properties set.\n        // Note, it's important that every change has a chance to add the\n        // property to `_reflectingProperties`. This ensures setting\n        // attribute + property reflects correctly.\n        if (options.reflect === true && this.__reflectingProperty !== name) {\n          if (this.__reflectingProperties === undefined) {\n            this.__reflectingProperties = new Map();\n          }\n          this.__reflectingProperties.set(name, options);\n        }\n      } else {\n        // Abort the request if the property should not be considered changed.\n        shouldRequestUpdate = false;\n      }\n    }\n    if (!this.isUpdatePending && shouldRequestUpdate) {\n      this.__updatePromise = this.__enqueueUpdate();\n    }\n    // Note, since this no longer returns a promise, in dev mode we return a\n    // thenable which warns if it's called.\n    return DEV_MODE\n      ? (requestUpdateThenable(this.localName) as unknown as void)\n      : undefined;\n  }\n\n  /**\n   * Sets up the element to asynchronously update.\n   */\n  private async __enqueueUpdate() {\n    this.isUpdatePending = true;\n    try {\n      // Ensure any previous update has resolved before updating.\n      // This `await` also ensures that property changes are batched.\n      await this.__updatePromise;\n    } catch (e) {\n      // Refire any previous errors async so they do not disrupt the update\n      // cycle. Errors are refired so developers have a chance to observe\n      // them, and this can be done by implementing\n      // `window.onunhandledrejection`.\n      Promise.reject(e);\n    }\n    const result = this.scheduleUpdate();\n    // If `scheduleUpdate` returns a Promise, we await it. This is done to\n    // enable coordinating updates with a scheduler. Note, the result is\n    // checked to avoid delaying an additional microtask unless we need to.\n    if (result != null) {\n      await result;\n    }\n    return !this.isUpdatePending;\n  }\n\n  /**\n   * Schedules an element update. You can override this method to change the\n   * timing of updates by returning a Promise. The update will await the\n   * returned Promise, and you should resolve the Promise to allow the update\n   * to proceed. If this method is overridden, `super.scheduleUpdate()`\n   * must be called.\n   *\n   * For instance, to schedule updates to occur just before the next frame:\n   *\n   * ```ts\n   * override protected async scheduleUpdate(): Promise<unknown> {\n   *   await new Promise((resolve) => requestAnimationFrame(() => resolve()));\n   *   super.scheduleUpdate();\n   * }\n   * ```\n   * @category updates\n   */\n  protected scheduleUpdate(): void | Promise<unknown> {\n    return this.performUpdate();\n  }\n\n  /**\n   * Performs an element update. Note, if an exception is thrown during the\n   * update, `firstUpdated` and `updated` will not be called.\n   *\n   * Call `performUpdate()` to immediately process a pending update. This should\n   * generally not be needed, but it can be done in rare cases when you need to\n   * update synchronously.\n   *\n   * Note: To ensure `performUpdate()` synchronously completes a pending update,\n   * it should not be overridden. In LitElement 2.x it was suggested to override\n   * `performUpdate()` to also customizing update scheduling. Instead, you should now\n   * override `scheduleUpdate()`. For backwards compatibility with LitElement 2.x,\n   * scheduling updates via `performUpdate()` continues to work, but will make\n   * also calling `performUpdate()` to synchronously process updates difficult.\n   *\n   * @category updates\n   */\n  protected performUpdate(): void | Promise<unknown> {\n    // Abort any update if one is not pending when this is called.\n    // This can happen if `performUpdate` is called early to \"flush\"\n    // the update.\n    if (!this.isUpdatePending) {\n      return;\n    }\n    debugLogEvent?.({kind: 'update'});\n    // create renderRoot before first update.\n    if (!this.hasUpdated) {\n      // Produce warning if any class properties are shadowed by class fields\n      if (DEV_MODE) {\n        const shadowedProperties: string[] = [];\n        (\n          this.constructor as typeof ReactiveElement\n        ).__reactivePropertyKeys?.forEach((p) => {\n          if (this.hasOwnProperty(p) && !this.__instanceProperties?.has(p)) {\n            shadowedProperties.push(p as string);\n          }\n        });\n        if (shadowedProperties.length) {\n          throw new Error(\n            `The following properties on element ${this.localName} will not ` +\n              `trigger updates as expected because they are set using class ` +\n              `fields: ${shadowedProperties.join(', ')}. ` +\n              `Native class fields and some compiled output will overwrite ` +\n              `accessors used for detecting changes. See ` +\n              `https://lit.dev/msg/class-field-shadowing ` +\n              `for more information.`\n          );\n        }\n      }\n    }\n    // Mixin instance properties once, if they exist.\n    if (this.__instanceProperties) {\n      // Use forEach so this works even if for/of loops are compiled to for loops\n      // expecting arrays\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      this.__instanceProperties!.forEach((v, p) => ((this as any)[p] = v));\n      this.__instanceProperties = undefined;\n    }\n    let shouldUpdate = false;\n    const changedProperties = this._$changedProperties;\n    try {\n      shouldUpdate = this.shouldUpdate(changedProperties);\n      if (shouldUpdate) {\n        this.willUpdate(changedProperties);\n        this.__controllers?.forEach((c) => c.hostUpdate?.());\n        this.update(changedProperties);\n      } else {\n        this.__markUpdated();\n      }\n    } catch (e) {\n      // Prevent `firstUpdated` and `updated` from running when there's an\n      // update exception.\n      shouldUpdate = false;\n      // Ensure element can accept additional updates after an exception.\n      this.__markUpdated();\n      throw e;\n    }\n    // The update is no longer considered pending and further updates are now allowed.\n    if (shouldUpdate) {\n      this._$didUpdate(changedProperties);\n    }\n  }\n\n  /**\n   * Invoked before `update()` to compute values needed during the update.\n   *\n   * Implement `willUpdate` to compute property values that depend on other\n   * properties and are used in the rest of the update process.\n   *\n   * ```ts\n   * willUpdate(changedProperties) {\n   *   // only need to check changed properties for an expensive computation.\n   *   if (changedProperties.has('firstName') || changedProperties.has('lastName')) {\n   *     this.sha = computeSHA(`${this.firstName} ${this.lastName}`);\n   *   }\n   * }\n   *\n   * render() {\n   *   return html`SHA: ${this.sha}`;\n   * }\n   * ```\n   *\n   * @category updates\n   */\n  protected willUpdate(_changedProperties: PropertyValues): void {}\n\n  // Note, this is an override point for polyfill-support.\n  // @internal\n  _$didUpdate(changedProperties: PropertyValues) {\n    this.__controllers?.forEach((c) => c.hostUpdated?.());\n    if (!this.hasUpdated) {\n      this.hasUpdated = true;\n      this.firstUpdated(changedProperties);\n    }\n    this.updated(changedProperties);\n    if (\n      DEV_MODE &&\n      this.isUpdatePending &&\n      (this.constructor as typeof ReactiveElement).enabledWarnings!.indexOf(\n        'change-in-update'\n      ) >= 0\n    ) {\n      issueWarning(\n        'change-in-update',\n        `Element ${this.localName} scheduled an update ` +\n          `(generally because a property was set) ` +\n          `after an update completed, causing a new update to be scheduled. ` +\n          `This is inefficient and should be avoided unless the next update ` +\n          `can only be scheduled as a side effect of the previous update.`\n      );\n    }\n  }\n\n  private __markUpdated() {\n    this._$changedProperties = new Map();\n    this.isUpdatePending = false;\n  }\n\n  /**\n   * Returns a Promise that resolves when the element has completed updating.\n   * The Promise value is a boolean that is `true` if the element completed the\n   * update without triggering another update. The Promise result is `false` if\n   * a property was set inside `updated()`. If the Promise is rejected, an\n   * exception was thrown during the update.\n   *\n   * To await additional asynchronous work, override the `getUpdateComplete`\n   * method. For example, it is sometimes useful to await a rendered element\n   * before fulfilling this Promise. To do this, first await\n   * `super.getUpdateComplete()`, then any subsequent state.\n   *\n   * @return A promise of a boolean that resolves to true if the update completed\n   *     without triggering another update.\n   * @category updates\n   */\n  get updateComplete(): Promise<boolean> {\n    return this.getUpdateComplete();\n  }\n\n  /**\n   * Override point for the `updateComplete` promise.\n   *\n   * It is not safe to override the `updateComplete` getter directly due to a\n   * limitation in TypeScript which means it is not possible to call a\n   * superclass getter (e.g. `super.updateComplete.then(...)`) when the target\n   * language is ES5 (https://github.com/microsoft/TypeScript/issues/338).\n   * This method should be overridden instead. For example:\n   *\n   * ```ts\n   * class MyElement extends LitElement {\n   *   override async getUpdateComplete() {\n   *     const result = await super.getUpdateComplete();\n   *     await this._myChild.updateComplete;\n   *     return result;\n   *   }\n   * }\n   * ```\n   *\n   * @return A promise of a boolean that resolves to true if the update completed\n   *     without triggering another update.\n   * @category updates\n   */\n  protected getUpdateComplete(): Promise<boolean> {\n    return this.__updatePromise;\n  }\n\n  /**\n   * Controls whether or not `update()` should be called when the element requests\n   * an update. By default, this method always returns `true`, but this can be\n   * customized to control when to update.\n   *\n   * @param _changedProperties Map of changed properties with old values\n   * @category updates\n   */\n  protected shouldUpdate(_changedProperties: PropertyValues): boolean {\n    return true;\n  }\n\n  /**\n   * Updates the element. This method reflects property values to attributes.\n   * It can be overridden to render and keep updated element DOM.\n   * Setting properties inside this method will *not* trigger\n   * another update.\n   *\n   * @param _changedProperties Map of changed properties with old values\n   * @category updates\n   */\n  protected update(_changedProperties: PropertyValues) {\n    if (this.__reflectingProperties !== undefined) {\n      // Use forEach so this works even if for/of loops are compiled to for\n      // loops expecting arrays\n      this.__reflectingProperties.forEach((v, k) =>\n        this.__propertyToAttribute(k, this[k as keyof this], v)\n      );\n      this.__reflectingProperties = undefined;\n    }\n    this.__markUpdated();\n  }\n\n  /**\n   * Invoked whenever the element is updated. Implement to perform\n   * post-updating tasks via DOM APIs, for example, focusing an element.\n   *\n   * Setting properties inside this method will trigger the element to update\n   * again after this update cycle completes.\n   *\n   * @param _changedProperties Map of changed properties with old values\n   * @category updates\n   */\n  protected updated(_changedProperties: PropertyValues) {}\n\n  /**\n   * Invoked when the element is first updated. Implement to perform one time\n   * work on the element after update.\n   *\n   * ```ts\n   * firstUpdated() {\n   *   this.renderRoot.getElementById('my-text-area').focus();\n   * }\n   * ```\n   *\n   * Setting properties inside this method will trigger the element to update\n   * again after this update cycle completes.\n   *\n   * @param _changedProperties Map of changed properties with old values\n   * @category updates\n   */\n  protected firstUpdated(_changedProperties: PropertyValues) {}\n}\n\n// Apply polyfills if available\npolyfillSupport?.({ReactiveElement});\n\n// Dev mode warnings...\nif (DEV_MODE) {\n  // Default warning set.\n  ReactiveElement.enabledWarnings = ['change-in-update'];\n  const ensureOwnWarnings = function (ctor: typeof ReactiveElement) {\n    if (\n      !ctor.hasOwnProperty(JSCompiler_renameProperty('enabledWarnings', ctor))\n    ) {\n      ctor.enabledWarnings = ctor.enabledWarnings!.slice();\n    }\n  };\n  ReactiveElement.enableWarning = function (\n    this: typeof ReactiveElement,\n    warning: WarningKind\n  ) {\n    ensureOwnWarnings(this);\n    if (this.enabledWarnings!.indexOf(warning) < 0) {\n      this.enabledWarnings!.push(warning);\n    }\n  };\n  ReactiveElement.disableWarning = function (\n    this: typeof ReactiveElement,\n    warning: WarningKind\n  ) {\n    ensureOwnWarnings(this);\n    const i = this.enabledWarnings!.indexOf(warning);\n    if (i >= 0) {\n      this.enabledWarnings!.splice(i, 1);\n    }\n  };\n}\n\n// IMPORTANT: do not change the property name or the assignment expression.\n// This line will be used in regexes to search for ReactiveElement usage.\n(global.reactiveElementVersions ??= []).push('1.6.1');\nif (DEV_MODE && global.reactiveElementVersions.length > 1) {\n  issueWarning!(\n    'multiple-versions',\n    `Multiple versions of Lit loaded. Loading multiple versions ` +\n      `is not recommended.`\n  );\n}\n", "/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\n\n// IMPORTANT: these imports must be type-only\nimport type {Directive, DirectiveResult, PartInfo} from './directive.js';\n\nconst DEV_MODE = true;\nconst ENABLE_EXTRA_SECURITY_HOOKS = true;\nconst ENABLE_SHADYDOM_NOPATCH = true;\nconst NODE_MODE = false;\n// Use window for browser builds because IE11 doesn't have globalThis.\nconst global = NODE_MODE ? globalThis : window;\n\n/**\n * Contains types that are part of the unstable debug API.\n *\n * Everything in this API is not stable and may change or be removed in the future,\n * even on patch releases.\n */\n// eslint-disable-next-line @typescript-eslint/no-namespace\nexport namespace LitUnstable {\n  /**\n   * When Lit is running in dev mode and `window.emitLitDebugLogEvents` is true,\n   * we will emit 'lit-debug' events to window, with live details about the update and render\n   * lifecycle. These can be useful for writing debug tooling and visualizations.\n   *\n   * Please be aware that running with window.emitLitDebugLogEvents has performance overhead,\n   * making certain operations that are normally very cheap (like a no-op render) much slower,\n   * because we must copy data and dispatch events.\n   */\n  // eslint-disable-next-line @typescript-eslint/no-namespace\n  export namespace DebugLog {\n    export type Entry =\n      | TemplatePrep\n      | TemplateInstantiated\n      | TemplateInstantiatedAndUpdated\n      | TemplateUpdating\n      | BeginRender\n      | EndRender\n      | CommitPartEntry\n      | SetPartValue;\n    export interface TemplatePrep {\n      kind: 'template prep';\n      template: Template;\n      strings: TemplateStringsArray;\n      clonableTemplate: HTMLTemplateElement;\n      parts: TemplatePart[];\n    }\n    export interface BeginRender {\n      kind: 'begin render';\n      id: number;\n      value: unknown;\n      container: HTMLElement | DocumentFragment;\n      options: RenderOptions | undefined;\n      part: ChildPart | undefined;\n    }\n    export interface EndRender {\n      kind: 'end render';\n      id: number;\n      value: unknown;\n      container: HTMLElement | DocumentFragment;\n      options: RenderOptions | undefined;\n      part: ChildPart;\n    }\n    export interface TemplateInstantiated {\n      kind: 'template instantiated';\n      template: Template | CompiledTemplate;\n      instance: TemplateInstance;\n      options: RenderOptions | undefined;\n      fragment: Node;\n      parts: Array<Part | undefined>;\n      values: unknown[];\n    }\n    export interface TemplateInstantiatedAndUpdated {\n      kind: 'template instantiated and updated';\n      template: Template | CompiledTemplate;\n      instance: TemplateInstance;\n      options: RenderOptions | undefined;\n      fragment: Node;\n      parts: Array<Part | undefined>;\n      values: unknown[];\n    }\n    export interface TemplateUpdating {\n      kind: 'template updating';\n      template: Template | CompiledTemplate;\n      instance: TemplateInstance;\n      options: RenderOptions | undefined;\n      parts: Array<Part | undefined>;\n      values: unknown[];\n    }\n    export interface SetPartValue {\n      kind: 'set part';\n      part: Part;\n      value: unknown;\n      valueIndex: number;\n      values: unknown[];\n      templateInstance: TemplateInstance;\n    }\n\n    export type CommitPartEntry =\n      | CommitNothingToChildEntry\n      | CommitText\n      | CommitNode\n      | CommitAttribute\n      | CommitProperty\n      | CommitBooleanAttribute\n      | CommitEventListener\n      | CommitToElementBinding;\n\n    export interface CommitNothingToChildEntry {\n      kind: 'commit nothing to child';\n      start: ChildNode;\n      end: ChildNode | null;\n      parent: Disconnectable | undefined;\n      options: RenderOptions | undefined;\n    }\n\n    export interface CommitText {\n      kind: 'commit text';\n      node: Text;\n      value: unknown;\n      options: RenderOptions | undefined;\n    }\n\n    export interface CommitNode {\n      kind: 'commit node';\n      start: Node;\n      parent: Disconnectable | undefined;\n      value: Node;\n      options: RenderOptions | undefined;\n    }\n\n    export interface CommitAttribute {\n      kind: 'commit attribute';\n      element: Element;\n      name: string;\n      value: unknown;\n      options: RenderOptions | undefined;\n    }\n\n    export interface CommitProperty {\n      kind: 'commit property';\n      element: Element;\n      name: string;\n      value: unknown;\n      options: RenderOptions | undefined;\n    }\n\n    export interface CommitBooleanAttribute {\n      kind: 'commit boolean attribute';\n      element: Element;\n      name: string;\n      value: boolean;\n      options: RenderOptions | undefined;\n    }\n\n    export interface CommitEventListener {\n      kind: 'commit event listener';\n      element: Element;\n      name: string;\n      value: unknown;\n      oldListener: unknown;\n      options: RenderOptions | undefined;\n      // True if we're removing the old event listener (e.g. because settings changed, or value is nothing)\n      removeListener: boolean;\n      // True if we're adding a new event listener (e.g. because first render, or settings changed)\n      addListener: boolean;\n    }\n\n    export interface CommitToElementBinding {\n      kind: 'commit to element binding';\n      element: Element;\n      value: unknown;\n      options: RenderOptions | undefined;\n    }\n  }\n}\n\ninterface DebugLoggingWindow {\n  // Even in dev mode, we generally don't want to emit these events, as that's\n  // another level of cost, so only emit them when DEV_MODE is true _and_ when\n  // window.emitLitDebugEvents is true.\n  emitLitDebugLogEvents?: boolean;\n}\n\n/**\n * Useful for visualizing and logging insights into what the Lit template system is doing.\n *\n * Compiled out of prod mode builds.\n */\nconst debugLogEvent = DEV_MODE\n  ? (event: LitUnstable.DebugLog.Entry) => {\n      const shouldEmit = (global as unknown as DebugLoggingWindow)\n        .emitLitDebugLogEvents;\n      if (!shouldEmit) {\n        return;\n      }\n      global.dispatchEvent(\n        new CustomEvent<LitUnstable.DebugLog.Entry>('lit-debug', {\n          detail: event,\n        })\n      );\n    }\n  : undefined;\n// Used for connecting beginRender and endRender events when there are nested\n// renders when errors are thrown preventing an endRender event from being\n// called.\nlet debugLogRenderId = 0;\n\nlet issueWarning: (code: string, warning: string) => void;\n\nif (DEV_MODE) {\n  global.litIssuedWarnings ??= new Set();\n\n  // Issue a warning, if we haven't already.\n  issueWarning = (code: string, warning: string) => {\n    warning += code\n      ? ` See https://lit.dev/msg/${code} for more information.`\n      : '';\n    if (!global.litIssuedWarnings!.has(warning)) {\n      console.warn(warning);\n      global.litIssuedWarnings!.add(warning);\n    }\n  };\n\n  issueWarning(\n    'dev-mode',\n    `Lit is in dev mode. Not recommended for production!`\n  );\n}\n\nconst wrap =\n  ENABLE_SHADYDOM_NOPATCH &&\n  global.ShadyDOM?.inUse &&\n  global.ShadyDOM?.noPatch === true\n    ? global.ShadyDOM!.wrap\n    : (node: Node) => node;\n\nconst trustedTypes = (global as unknown as Partial<Window>).trustedTypes;\n\n/**\n * Our TrustedTypePolicy for HTML which is declared using the html template\n * tag function.\n *\n * That HTML is a developer-authored constant, and is parsed with innerHTML\n * before any untrusted expressions have been mixed in. Therefor it is\n * considered safe by construction.\n */\nconst policy = trustedTypes\n  ? trustedTypes.createPolicy('lit-html', {\n      createHTML: (s) => s,\n    })\n  : undefined;\n\n/**\n * Used to sanitize any value before it is written into the DOM. This can be\n * used to implement a security policy of allowed and disallowed values in\n * order to prevent XSS attacks.\n *\n * One way of using this callback would be to check attributes and properties\n * against a list of high risk fields, and require that values written to such\n * fields be instances of a class which is safe by construction. Closure's Safe\n * HTML Types is one implementation of this technique (\n * https://github.com/google/safe-html-types/blob/master/doc/safehtml-types.md).\n * The TrustedTypes polyfill in API-only mode could also be used as a basis\n * for this technique (https://github.com/WICG/trusted-types).\n *\n * @param node The HTML node (usually either a #text node or an Element) that\n *     is being written to. Note that this is just an exemplar node, the write\n *     may take place against another instance of the same class of node.\n * @param name The name of an attribute or property (for example, 'href').\n * @param type Indicates whether the write that's about to be performed will\n *     be to a property or a node.\n * @return A function that will sanitize this class of writes.\n */\nexport type SanitizerFactory = (\n  node: Node,\n  name: string,\n  type: 'property' | 'attribute'\n) => ValueSanitizer;\n\n/**\n * A function which can sanitize values that will be written to a specific kind\n * of DOM sink.\n *\n * See SanitizerFactory.\n *\n * @param value The value to sanitize. Will be the actual value passed into\n *     the lit-html template literal, so this could be of any type.\n * @return The value to write to the DOM. Usually the same as the input value,\n *     unless sanitization is needed.\n */\nexport type ValueSanitizer = (value: unknown) => unknown;\n\nconst identityFunction: ValueSanitizer = (value: unknown) => value;\nconst noopSanitizer: SanitizerFactory = (\n  _node: Node,\n  _name: string,\n  _type: 'property' | 'attribute'\n) => identityFunction;\n\n/** Sets the global sanitizer factory. */\nconst setSanitizer = (newSanitizer: SanitizerFactory) => {\n  if (!ENABLE_EXTRA_SECURITY_HOOKS) {\n    return;\n  }\n  if (sanitizerFactoryInternal !== noopSanitizer) {\n    throw new Error(\n      `Attempted to overwrite existing lit-html security policy.` +\n        ` setSanitizeDOMValueFactory should be called at most once.`\n    );\n  }\n  sanitizerFactoryInternal = newSanitizer;\n};\n\n/**\n * Only used in internal tests, not a part of the public API.\n */\nconst _testOnlyClearSanitizerFactoryDoNotCallOrElse = () => {\n  sanitizerFactoryInternal = noopSanitizer;\n};\n\nconst createSanitizer: SanitizerFactory = (node, name, type) => {\n  return sanitizerFactoryInternal(node, name, type);\n};\n\n// Added to an attribute name to mark the attribute as bound so we can find\n// it easily.\nconst boundAttributeSuffix = '$lit$';\n\n// This marker is used in many syntactic positions in HTML, so it must be\n// a valid element name and attribute name. We don't support dynamic names (yet)\n// but this at least ensures that the parse tree is closer to the template\n// intention.\nconst marker = `lit$${String(Math.random()).slice(9)}$`;\n\n// String used to tell if a comment is a marker comment\nconst markerMatch = '?' + marker;\n\n// Text used to insert a comment marker node. We use processing instruction\n// syntax because it's slightly smaller, but parses as a comment node.\nconst nodeMarker = `<${markerMatch}>`;\n\nconst d =\n  NODE_MODE && global.document === undefined\n    ? ({\n        createTreeWalker() {\n          return {};\n        },\n      } as unknown as Document)\n    : document;\n\n// Creates a dynamic marker. We never have to search for these in the DOM.\nconst createMarker = () => d.createComment('');\n\n// https://tc39.github.io/ecma262/#sec-typeof-operator\ntype Primitive = null | undefined | boolean | number | string | symbol | bigint;\nconst isPrimitive = (value: unknown): value is Primitive =>\n  value === null || (typeof value != 'object' && typeof value != 'function');\nconst isArray = Array.isArray;\nconst isIterable = (value: unknown): value is Iterable<unknown> =>\n  isArray(value) ||\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  typeof (value as any)?.[Symbol.iterator] === 'function';\n\nconst SPACE_CHAR = `[ \\t\\n\\f\\r]`;\nconst ATTR_VALUE_CHAR = `[^ \\t\\n\\f\\r\"'\\`<>=]`;\nconst NAME_CHAR = `[^\\\\s\"'>=/]`;\n\n// These regexes represent the five parsing states that we care about in the\n// Template's HTML scanner. They match the *end* of the state they're named\n// after.\n// Depending on the match, we transition to a new state. If there's no match,\n// we stay in the same state.\n// Note that the regexes are stateful. We utilize lastIndex and sync it\n// across the multiple regexes used. In addition to the five regexes below\n// we also dynamically create a regex to find the matching end tags for raw\n// text elements.\n\n/**\n * End of text is: `<` followed by:\n *   (comment start) or (tag) or (dynamic tag binding)\n */\nconst textEndRegex = /<(?:(!--|\\/[^a-zA-Z])|(\\/?[a-zA-Z][^>\\s]*)|(\\/?$))/g;\nconst COMMENT_START = 1;\nconst TAG_NAME = 2;\nconst DYNAMIC_TAG_NAME = 3;\n\nconst commentEndRegex = /-->/g;\n/**\n * Comments not started with <!--, like </{, can be ended by a single `>`\n */\nconst comment2EndRegex = />/g;\n\n/**\n * The tagEnd regex matches the end of the \"inside an opening\" tag syntax\n * position. It either matches a `>`, an attribute-like sequence, or the end\n * of the string after a space (attribute-name position ending).\n *\n * See attributes in the HTML spec:\n * https://www.w3.org/TR/html5/syntax.html#elements-attributes\n *\n * \" \\t\\n\\f\\r\" are HTML space characters:\n * https://infra.spec.whatwg.org/#ascii-whitespace\n *\n * So an attribute is:\n *  * The name: any character except a whitespace character, (\"), ('), \">\",\n *    \"=\", or \"/\". Note: this is different from the HTML spec which also excludes control characters.\n *  * Followed by zero or more space characters\n *  * Followed by \"=\"\n *  * Followed by zero or more space characters\n *  * Followed by:\n *    * Any character except space, ('), (\"), \"<\", \">\", \"=\", (`), or\n *    * (\") then any non-(\"), or\n *    * (') then any non-(')\n */\nconst tagEndRegex = new RegExp(\n  `>|${SPACE_CHAR}(?:(${NAME_CHAR}+)(${SPACE_CHAR}*=${SPACE_CHAR}*(?:${ATTR_VALUE_CHAR}|(\"|')|))|$)`,\n  'g'\n);\nconst ENTIRE_MATCH = 0;\nconst ATTRIBUTE_NAME = 1;\nconst SPACES_AND_EQUALS = 2;\nconst QUOTE_CHAR = 3;\n\nconst singleQuoteAttrEndRegex = /'/g;\nconst doubleQuoteAttrEndRegex = /\"/g;\n/**\n * Matches the raw text elements.\n *\n * Comments are not parsed within raw text elements, so we need to search their\n * text content for marker strings.\n */\nconst rawTextElement = /^(?:script|style|textarea|title)$/i;\n\n/** TemplateResult types */\nconst HTML_RESULT = 1;\nconst SVG_RESULT = 2;\n\ntype ResultType = typeof HTML_RESULT | typeof SVG_RESULT;\n\n// TemplatePart types\n// IMPORTANT: these must match the values in PartType\nconst ATTRIBUTE_PART = 1;\nconst CHILD_PART = 2;\nconst PROPERTY_PART = 3;\nconst BOOLEAN_ATTRIBUTE_PART = 4;\nconst EVENT_PART = 5;\nconst ELEMENT_PART = 6;\nconst COMMENT_PART = 7;\n\n/**\n * The return type of the template tag functions, {@linkcode html} and\n * {@linkcode svg}.\n *\n * A `TemplateResult` object holds all the information about a template\n * expression required to render it: the template strings, expression values,\n * and type of template (html or svg).\n *\n * `TemplateResult` objects do not create any DOM on their own. To create or\n * update DOM you need to render the `TemplateResult`. See\n * [Rendering](https://lit.dev/docs/components/rendering) for more information.\n *\n */\nexport type TemplateResult<T extends ResultType = ResultType> = {\n  // This property needs to remain unminified.\n  ['_$litType$']: T;\n  strings: TemplateStringsArray;\n  values: unknown[];\n};\n\nexport type HTMLTemplateResult = TemplateResult<typeof HTML_RESULT>;\n\nexport type SVGTemplateResult = TemplateResult<typeof SVG_RESULT>;\n\nexport interface CompiledTemplateResult {\n  // This is a factory in order to make template initialization lazy\n  // and allow ShadyRenderOptions scope to be passed in.\n  // This property needs to remain unminified.\n  ['_$litType$']: CompiledTemplate;\n  values: unknown[];\n}\n\nexport interface CompiledTemplate extends Omit<Template, 'el'> {\n  // el is overridden to be optional. We initialize it on first render\n  el?: HTMLTemplateElement;\n\n  // The prepared HTML string to create a template element from.\n  h: TrustedHTML;\n}\n\n/**\n * Generates a template literal tag function that returns a TemplateResult with\n * the given result type.\n */\nconst tag =\n  <T extends ResultType>(type: T) =>\n  (strings: TemplateStringsArray, ...values: unknown[]): TemplateResult<T> => {\n    // Warn against templates octal escape sequences\n    // We do this here rather than in render so that the warning is closer to the\n    // template definition.\n    if (DEV_MODE && strings.some((s) => s === undefined)) {\n      console.warn(\n        'Some template strings are undefined.\\n' +\n          'This is probably caused by illegal octal escape sequences.'\n      );\n    }\n    return {\n      // This property needs to remain unminified.\n      ['_$litType$']: type,\n      strings,\n      values,\n    };\n  };\n\n/**\n * Interprets a template literal as an HTML template that can efficiently\n * render to and update a container.\n *\n * ```ts\n * const header = (title: string) => html`<h1>${title}</h1>`;\n * ```\n *\n * The `html` tag returns a description of the DOM to render as a value. It is\n * lazy, meaning no work is done until the template is rendered. When rendering,\n * if a template comes from the same expression as a previously rendered result,\n * it's efficiently updated instead of replaced.\n */\nexport const html = tag(HTML_RESULT);\n\n/**\n * Interprets a template literal as an SVG fragment that can efficiently\n * render to and update a container.\n *\n * ```ts\n * const rect = svg`<rect width=\"10\" height=\"10\"></rect>`;\n *\n * const myImage = html`\n *   <svg viewBox=\"0 0 10 10\" xmlns=\"http://www.w3.org/2000/svg\">\n *     ${rect}\n *   </svg>`;\n * ```\n *\n * The `svg` *tag function* should only be used for SVG fragments, or elements\n * that would be contained **inside** an `<svg>` HTML element. A common error is\n * placing an `<svg>` *element* in a template tagged with the `svg` tag\n * function. The `<svg>` element is an HTML element and should be used within a\n * template tagged with the {@linkcode html} tag function.\n *\n * In LitElement usage, it's invalid to return an SVG fragment from the\n * `render()` method, as the SVG fragment will be contained within the element's\n * shadow root and thus cannot be used within an `<svg>` HTML element.\n */\nexport const svg = tag(SVG_RESULT);\n\n/**\n * A sentinel value that signals that a value was handled by a directive and\n * should not be written to the DOM.\n */\nexport const noChange = Symbol.for('lit-noChange');\n\n/**\n * A sentinel value that signals a ChildPart to fully clear its content.\n *\n * ```ts\n * const button = html`${\n *  user.isAdmin\n *    ? html`<button>DELETE</button>`\n *    : nothing\n * }`;\n * ```\n *\n * Prefer using `nothing` over other falsy values as it provides a consistent\n * behavior between various expression binding contexts.\n *\n * In child expressions, `undefined`, `null`, `''`, and `nothing` all behave the\n * same and render no nodes. In attribute expressions, `nothing` _removes_ the\n * attribute, while `undefined` and `null` will render an empty string. In\n * property expressions `nothing` becomes `undefined`.\n */\nexport const nothing = Symbol.for('lit-nothing');\n\n/**\n * The cache of prepared templates, keyed by the tagged TemplateStringsArray\n * and _not_ accounting for the specific template tag used. This means that\n * template tags cannot be dynamic - the must statically be one of html, svg,\n * or attr. This restriction simplifies the cache lookup, which is on the hot\n * path for rendering.\n */\nconst templateCache = new WeakMap<TemplateStringsArray, Template>();\n\n/**\n * Object specifying options for controlling lit-html rendering. Note that\n * while `render` may be called multiple times on the same `container` (and\n * `renderBefore` reference node) to efficiently update the rendered content,\n * only the options passed in during the first render are respected during\n * the lifetime of renders to that unique `container` + `renderBefore`\n * combination.\n */\nexport interface RenderOptions {\n  /**\n   * An object to use as the `this` value for event listeners. It's often\n   * useful to set this to the host component rendering a template.\n   */\n  host?: object;\n  /**\n   * A DOM node before which to render content in the container.\n   */\n  renderBefore?: ChildNode | null;\n  /**\n   * Node used for cloning the template (`importNode` will be called on this\n   * node). This controls the `ownerDocument` of the rendered DOM, along with\n   * any inherited context. Defaults to the global `document`.\n   */\n  creationScope?: {importNode(node: Node, deep?: boolean): Node};\n  /**\n   * The initial connected state for the top-level part being rendered. If no\n   * `isConnected` option is set, `AsyncDirective`s will be connected by\n   * default. Set to `false` if the initial render occurs in a disconnected tree\n   * and `AsyncDirective`s should see `isConnected === false` for their initial\n   * render. The `part.setConnected()` method must be used subsequent to initial\n   * render to change the connected state of the part.\n   */\n  isConnected?: boolean;\n}\n\nconst walker = d.createTreeWalker(\n  d,\n  129 /* NodeFilter.SHOW_{ELEMENT|COMMENT} */,\n  null,\n  false\n);\n\nlet sanitizerFactoryInternal: SanitizerFactory = noopSanitizer;\n\n//\n// Classes only below here, const variable declarations only above here...\n//\n// Keeping variable declarations and classes together improves minification.\n// Interfaces and type aliases can be interleaved freely.\n//\n\n// Type for classes that have a `_directive` or `_directives[]` field, used by\n// `resolveDirective`\nexport interface DirectiveParent {\n  _$parent?: DirectiveParent;\n  _$isConnected: boolean;\n  __directive?: Directive;\n  __directives?: Array<Directive | undefined>;\n}\n\n/**\n * Returns an HTML string for the given TemplateStringsArray and result type\n * (HTML or SVG), along with the case-sensitive bound attribute names in\n * template order. The HTML contains comment markers denoting the `ChildPart`s\n * and suffixes on bound attributes denoting the `AttributeParts`.\n *\n * @param strings template strings array\n * @param type HTML or SVG\n * @return Array containing `[html, attrNames]` (array returned for terseness,\n *     to avoid object fields since this code is shared with non-minified SSR\n *     code)\n */\nconst getTemplateHtml = (\n  strings: TemplateStringsArray,\n  type: ResultType\n): [TrustedHTML, Array<string | undefined>] => {\n  // Insert makers into the template HTML to represent the position of\n  // bindings. The following code scans the template strings to determine the\n  // syntactic position of the bindings. They can be in text position, where\n  // we insert an HTML comment, attribute value position, where we insert a\n  // sentinel string and re-write the attribute name, or inside a tag where\n  // we insert the sentinel string.\n  const l = strings.length - 1;\n  // Stores the case-sensitive bound attribute names in the order of their\n  // parts. ElementParts are also reflected in this array as undefined\n  // rather than a string, to disambiguate from attribute bindings.\n  const attrNames: Array<string | undefined> = [];\n  let html = type === SVG_RESULT ? '<svg>' : '';\n\n  // When we're inside a raw text tag (not it's text content), the regex\n  // will still be tagRegex so we can find attributes, but will switch to\n  // this regex when the tag ends.\n  let rawTextEndRegex: RegExp | undefined;\n\n  // The current parsing state, represented as a reference to one of the\n  // regexes\n  let regex = textEndRegex;\n\n  for (let i = 0; i < l; i++) {\n    const s = strings[i];\n    // The index of the end of the last attribute name. When this is\n    // positive at end of a string, it means we're in an attribute value\n    // position and need to rewrite the attribute name.\n    // We also use a special value of -2 to indicate that we encountered\n    // the end of a string in attribute name position.\n    let attrNameEndIndex = -1;\n    let attrName: string | undefined;\n    let lastIndex = 0;\n    let match!: RegExpExecArray | null;\n\n    // The conditions in this loop handle the current parse state, and the\n    // assignments to the `regex` variable are the state transitions.\n    while (lastIndex < s.length) {\n      // Make sure we start searching from where we previously left off\n      regex.lastIndex = lastIndex;\n      match = regex.exec(s);\n      if (match === null) {\n        break;\n      }\n      lastIndex = regex.lastIndex;\n      if (regex === textEndRegex) {\n        if (match[COMMENT_START] === '!--') {\n          regex = commentEndRegex;\n        } else if (match[COMMENT_START] !== undefined) {\n          // We started a weird comment, like </{\n          regex = comment2EndRegex;\n        } else if (match[TAG_NAME] !== undefined) {\n          if (rawTextElement.test(match[TAG_NAME])) {\n            // Record if we encounter a raw-text element. We'll switch to\n            // this regex at the end of the tag.\n            rawTextEndRegex = new RegExp(`</${match[TAG_NAME]}`, 'g');\n          }\n          regex = tagEndRegex;\n        } else if (match[DYNAMIC_TAG_NAME] !== undefined) {\n          if (DEV_MODE) {\n            throw new Error(\n              'Bindings in tag names are not supported. Please use static templates instead. ' +\n                'See https://lit.dev/docs/templates/expressions/#static-expressions'\n            );\n          }\n          regex = tagEndRegex;\n        }\n      } else if (regex === tagEndRegex) {\n        if (match[ENTIRE_MATCH] === '>') {\n          // End of a tag. If we had started a raw-text element, use that\n          // regex\n          regex = rawTextEndRegex ?? textEndRegex;\n          // We may be ending an unquoted attribute value, so make sure we\n          // clear any pending attrNameEndIndex\n          attrNameEndIndex = -1;\n        } else if (match[ATTRIBUTE_NAME] === undefined) {\n          // Attribute name position\n          attrNameEndIndex = -2;\n        } else {\n          attrNameEndIndex = regex.lastIndex - match[SPACES_AND_EQUALS].length;\n          attrName = match[ATTRIBUTE_NAME];\n          regex =\n            match[QUOTE_CHAR] === undefined\n              ? tagEndRegex\n              : match[QUOTE_CHAR] === '\"'\n              ? doubleQuoteAttrEndRegex\n              : singleQuoteAttrEndRegex;\n        }\n      } else if (\n        regex === doubleQuoteAttrEndRegex ||\n        regex === singleQuoteAttrEndRegex\n      ) {\n        regex = tagEndRegex;\n      } else if (regex === commentEndRegex || regex === comment2EndRegex) {\n        regex = textEndRegex;\n      } else {\n        // Not one of the five state regexes, so it must be the dynamically\n        // created raw text regex and we're at the close of that element.\n        regex = tagEndRegex;\n        rawTextEndRegex = undefined;\n      }\n    }\n\n    if (DEV_MODE) {\n      // If we have a attrNameEndIndex, which indicates that we should\n      // rewrite the attribute name, assert that we're in a valid attribute\n      // position - either in a tag, or a quoted attribute value.\n      console.assert(\n        attrNameEndIndex === -1 ||\n          regex === tagEndRegex ||\n          regex === singleQuoteAttrEndRegex ||\n          regex === doubleQuoteAttrEndRegex,\n        'unexpected parse state B'\n      );\n    }\n\n    // We have four cases:\n    //  1. We're in text position, and not in a raw text element\n    //     (regex === textEndRegex): insert a comment marker.\n    //  2. We have a non-negative attrNameEndIndex which means we need to\n    //     rewrite the attribute name to add a bound attribute suffix.\n    //  3. We're at the non-first binding in a multi-binding attribute, use a\n    //     plain marker.\n    //  4. We're somewhere else inside the tag. If we're in attribute name\n    //     position (attrNameEndIndex === -2), add a sequential suffix to\n    //     generate a unique attribute name.\n\n    // Detect a binding next to self-closing tag end and insert a space to\n    // separate the marker from the tag end:\n    const end =\n      regex === tagEndRegex && strings[i + 1].startsWith('/>') ? ' ' : '';\n    html +=\n      regex === textEndRegex\n        ? s + nodeMarker\n        : attrNameEndIndex >= 0\n        ? (attrNames.push(attrName!),\n          s.slice(0, attrNameEndIndex) +\n            boundAttributeSuffix +\n            s.slice(attrNameEndIndex)) +\n          marker +\n          end\n        : s +\n          marker +\n          (attrNameEndIndex === -2 ? (attrNames.push(undefined), i) : end);\n  }\n\n  const htmlResult: string | TrustedHTML =\n    html + (strings[l] || '<?>') + (type === SVG_RESULT ? '</svg>' : '');\n\n  // A security check to prevent spoofing of Lit template results.\n  // In the future, we may be able to replace this with Array.isTemplateObject,\n  // though we might need to make that check inside of the html and svg\n  // functions, because precompiled templates don't come in as\n  // TemplateStringArray objects.\n  if (!Array.isArray(strings) || !strings.hasOwnProperty('raw')) {\n    let message = 'invalid template strings array';\n    if (DEV_MODE) {\n      message = `\n          Internal Error: expected template strings to be an array\n          with a 'raw' field. Faking a template strings array by\n          calling html or svg like an ordinary function is effectively\n          the same as calling unsafeHtml and can lead to major security\n          issues, e.g. opening your code up to XSS attacks.\n\n          If you're using the html or svg tagged template functions normally\n          and still seeing this error, please file a bug at\n          https://github.com/lit/lit/issues/new?template=bug_report.md\n          and include information about your build tooling, if any.\n        `\n        .trim()\n        .replace(/\\n */g, '\\n');\n    }\n    throw new Error(message);\n  }\n  // Returned as an array for terseness\n  return [\n    policy !== undefined\n      ? policy.createHTML(htmlResult)\n      : (htmlResult as unknown as TrustedHTML),\n    attrNames,\n  ];\n};\n\n/** @internal */\nexport type {Template};\nclass Template {\n  /** @internal */\n  el!: HTMLTemplateElement;\n  /** @internal */\n  parts: Array<TemplatePart> = [];\n\n  constructor(\n    // This property needs to remain unminified.\n    {strings, ['_$litType$']: type}: TemplateResult,\n    options?: RenderOptions\n  ) {\n    let node: Node | null;\n    let nodeIndex = 0;\n    let attrNameIndex = 0;\n    const partCount = strings.length - 1;\n    const parts = this.parts;\n\n    // Create template element\n    const [html, attrNames] = getTemplateHtml(strings, type);\n    this.el = Template.createElement(html, options);\n    walker.currentNode = this.el.content;\n\n    // Reparent SVG nodes into template root\n    if (type === SVG_RESULT) {\n      const content = this.el.content;\n      const svgElement = content.firstChild!;\n      svgElement.remove();\n      content.append(...svgElement.childNodes);\n    }\n\n    // Walk the template to find binding markers and create TemplateParts\n    while ((node = walker.nextNode()) !== null && parts.length < partCount) {\n      if (node.nodeType === 1) {\n        if (DEV_MODE) {\n          const tag = (node as Element).localName;\n          // Warn if `textarea` includes an expression and throw if `template`\n          // does since these are not supported. We do this by checking\n          // innerHTML for anything that looks like a marker. This catches\n          // cases like bindings in textarea there markers turn into text nodes.\n          if (\n            /^(?:textarea|template)$/i!.test(tag) &&\n            (node as Element).innerHTML.includes(marker)\n          ) {\n            const m =\n              `Expressions are not supported inside \\`${tag}\\` ` +\n              `elements. See https://lit.dev/msg/expression-in-${tag} for more ` +\n              `information.`;\n            if (tag === 'template') {\n              throw new Error(m);\n            } else issueWarning('', m);\n          }\n        }\n        // TODO (justinfagnani): for attempted dynamic tag names, we don't\n        // increment the bindingIndex, and it'll be off by 1 in the element\n        // and off by two after it.\n        if ((node as Element).hasAttributes()) {\n          // We defer removing bound attributes because on IE we might not be\n          // iterating attributes in their template order, and would sometimes\n          // remove an attribute that we still need to create a part for.\n          const attrsToRemove = [];\n          for (const name of (node as Element).getAttributeNames()) {\n            // `name` is the name of the attribute we're iterating over, but not\n            // _necessarily_ the name of the attribute we will create a part\n            // for. They can be different in browsers that don't iterate on\n            // attributes in source order. In that case the attrNames array\n            // contains the attribute name we'll process next. We only need the\n            // attribute name here to know if we should process a bound attribute\n            // on this element.\n            if (\n              name.endsWith(boundAttributeSuffix) ||\n              name.startsWith(marker)\n            ) {\n              const realName = attrNames[attrNameIndex++];\n              attrsToRemove.push(name);\n              if (realName !== undefined) {\n                // Lowercase for case-sensitive SVG attributes like viewBox\n                const value = (node as Element).getAttribute(\n                  realName.toLowerCase() + boundAttributeSuffix\n                )!;\n                const statics = value.split(marker);\n                const m = /([.?@])?(.*)/.exec(realName)!;\n                parts.push({\n                  type: ATTRIBUTE_PART,\n                  index: nodeIndex,\n                  name: m[2],\n                  strings: statics,\n                  ctor:\n                    m[1] === '.'\n                      ? PropertyPart\n                      : m[1] === '?'\n                      ? BooleanAttributePart\n                      : m[1] === '@'\n                      ? EventPart\n                      : AttributePart,\n                });\n              } else {\n                parts.push({\n                  type: ELEMENT_PART,\n                  index: nodeIndex,\n                });\n              }\n            }\n          }\n          for (const name of attrsToRemove) {\n            (node as Element).removeAttribute(name);\n          }\n        }\n        // TODO (justinfagnani): benchmark the regex against testing for each\n        // of the 3 raw text element names.\n        if (rawTextElement.test((node as Element).tagName)) {\n          // For raw text elements we need to split the text content on\n          // markers, create a Text node for each segment, and create\n          // a TemplatePart for each marker.\n          const strings = (node as Element).textContent!.split(marker);\n          const lastIndex = strings.length - 1;\n          if (lastIndex > 0) {\n            (node as Element).textContent = trustedTypes\n              ? (trustedTypes.emptyScript as unknown as '')\n              : '';\n            // Generate a new text node for each literal section\n            // These nodes are also used as the markers for node parts\n            // We can't use empty text nodes as markers because they're\n            // normalized when cloning in IE (could simplify when\n            // IE is no longer supported)\n            for (let i = 0; i < lastIndex; i++) {\n              (node as Element).append(strings[i], createMarker());\n              // Walk past the marker node we just added\n              walker.nextNode();\n              parts.push({type: CHILD_PART, index: ++nodeIndex});\n            }\n            // Note because this marker is added after the walker's current\n            // node, it will be walked to in the outer loop (and ignored), so\n            // we don't need to adjust nodeIndex here\n            (node as Element).append(strings[lastIndex], createMarker());\n          }\n        }\n      } else if (node.nodeType === 8) {\n        const data = (node as Comment).data;\n        if (data === markerMatch) {\n          parts.push({type: CHILD_PART, index: nodeIndex});\n        } else {\n          let i = -1;\n          while ((i = (node as Comment).data.indexOf(marker, i + 1)) !== -1) {\n            // Comment node has a binding marker inside, make an inactive part\n            // The binding won't work, but subsequent bindings will\n            parts.push({type: COMMENT_PART, index: nodeIndex});\n            // Move to the end of the match\n            i += marker.length - 1;\n          }\n        }\n      }\n      nodeIndex++;\n    }\n    debugLogEvent?.({\n      kind: 'template prep',\n      template: this,\n      clonableTemplate: this.el,\n      parts: this.parts,\n      strings,\n    });\n  }\n\n  // Overridden via `litHtmlPolyfillSupport` to provide platform support.\n  /** @nocollapse */\n  static createElement(html: TrustedHTML, _options?: RenderOptions) {\n    const el = d.createElement('template');\n    el.innerHTML = html as unknown as string;\n    return el;\n  }\n}\n\nexport interface Disconnectable {\n  _$parent?: Disconnectable;\n  _$disconnectableChildren?: Set<Disconnectable>;\n  // Rather than hold connection state on instances, Disconnectables recursively\n  // fetch the connection state from the RootPart they are connected in via\n  // getters up the Disconnectable tree via _$parent references. This pushes the\n  // cost of tracking the isConnected state to `AsyncDirectives`, and avoids\n  // needing to pass all Disconnectables (parts, template instances, and\n  // directives) their connection state each time it changes, which would be\n  // costly for trees that have no AsyncDirectives.\n  _$isConnected: boolean;\n}\n\nfunction resolveDirective(\n  part: ChildPart | AttributePart | ElementPart,\n  value: unknown,\n  parent: DirectiveParent = part,\n  attributeIndex?: number\n): unknown {\n  // Bail early if the value is explicitly noChange. Note, this means any\n  // nested directive is still attached and is not run.\n  if (value === noChange) {\n    return value;\n  }\n  let currentDirective =\n    attributeIndex !== undefined\n      ? (parent as AttributePart).__directives?.[attributeIndex]\n      : (parent as ChildPart | ElementPart | Directive).__directive;\n  const nextDirectiveConstructor = isPrimitive(value)\n    ? undefined\n    : // This property needs to remain unminified.\n      (value as DirectiveResult)['_$litDirective$'];\n  if (currentDirective?.constructor !== nextDirectiveConstructor) {\n    // This property needs to remain unminified.\n    currentDirective?.['_$notifyDirectiveConnectionChanged']?.(false);\n    if (nextDirectiveConstructor === undefined) {\n      currentDirective = undefined;\n    } else {\n      currentDirective = new nextDirectiveConstructor(part as PartInfo);\n      currentDirective._$initialize(part, parent, attributeIndex);\n    }\n    if (attributeIndex !== undefined) {\n      ((parent as AttributePart).__directives ??= [])[attributeIndex] =\n        currentDirective;\n    } else {\n      (parent as ChildPart | Directive).__directive = currentDirective;\n    }\n  }\n  if (currentDirective !== undefined) {\n    value = resolveDirective(\n      part,\n      currentDirective._$resolve(part, (value as DirectiveResult).values),\n      currentDirective,\n      attributeIndex\n    );\n  }\n  return value;\n}\n\n/**\n * An updateable instance of a Template. Holds references to the Parts used to\n * update the template instance.\n */\nclass TemplateInstance implements Disconnectable {\n  /** @internal */\n  _$template: Template;\n  /** @internal */\n  _parts: Array<Part | undefined> = [];\n\n  /** @internal */\n  _$parent: ChildPart;\n  /** @internal */\n  _$disconnectableChildren?: Set<Disconnectable> = undefined;\n\n  constructor(template: Template, parent: ChildPart) {\n    this._$template = template;\n    this._$parent = parent;\n  }\n\n  // Called by ChildPart parentNode getter\n  get parentNode() {\n    return this._$parent.parentNode;\n  }\n\n  // See comment in Disconnectable interface for why this is a getter\n  get _$isConnected() {\n    return this._$parent._$isConnected;\n  }\n\n  // This method is separate from the constructor because we need to return a\n  // DocumentFragment and we don't want to hold onto it with an instance field.\n  _clone(options: RenderOptions | undefined) {\n    const {\n      el: {content},\n      parts: parts,\n    } = this._$template;\n    const fragment = (options?.creationScope ?? d).importNode(content, true);\n    walker.currentNode = fragment;\n\n    let node = walker.nextNode()!;\n    let nodeIndex = 0;\n    let partIndex = 0;\n    let templatePart = parts[0];\n\n    while (templatePart !== undefined) {\n      if (nodeIndex === templatePart.index) {\n        let part: Part | undefined;\n        if (templatePart.type === CHILD_PART) {\n          part = new ChildPart(\n            node as HTMLElement,\n            node.nextSibling,\n            this,\n            options\n          );\n        } else if (templatePart.type === ATTRIBUTE_PART) {\n          part = new templatePart.ctor(\n            node as HTMLElement,\n            templatePart.name,\n            templatePart.strings,\n            this,\n            options\n          );\n        } else if (templatePart.type === ELEMENT_PART) {\n          part = new ElementPart(node as HTMLElement, this, options);\n        }\n        this._parts.push(part);\n        templatePart = parts[++partIndex];\n      }\n      if (nodeIndex !== templatePart?.index) {\n        node = walker.nextNode()!;\n        nodeIndex++;\n      }\n    }\n    return fragment;\n  }\n\n  _update(values: Array<unknown>) {\n    let i = 0;\n    for (const part of this._parts) {\n      if (part !== undefined) {\n        debugLogEvent?.({\n          kind: 'set part',\n          part,\n          value: values[i],\n          valueIndex: i,\n          values,\n          templateInstance: this,\n        });\n        if ((part as AttributePart).strings !== undefined) {\n          (part as AttributePart)._$setValue(values, part as AttributePart, i);\n          // The number of values the part consumes is part.strings.length - 1\n          // since values are in between template spans. We increment i by 1\n          // later in the loop, so increment it by part.strings.length - 2 here\n          i += (part as AttributePart).strings!.length - 2;\n        } else {\n          part._$setValue(values[i]);\n        }\n      }\n      i++;\n    }\n  }\n}\n\n/*\n * Parts\n */\ntype AttributeTemplatePart = {\n  readonly type: typeof ATTRIBUTE_PART;\n  readonly index: number;\n  readonly name: string;\n  /** @internal */\n  readonly ctor: typeof AttributePart;\n  /** @internal */\n  readonly strings: ReadonlyArray<string>;\n};\ntype NodeTemplatePart = {\n  readonly type: typeof CHILD_PART;\n  readonly index: number;\n};\ntype ElementTemplatePart = {\n  readonly type: typeof ELEMENT_PART;\n  readonly index: number;\n};\ntype CommentTemplatePart = {\n  readonly type: typeof COMMENT_PART;\n  readonly index: number;\n};\n\n/**\n * A TemplatePart represents a dynamic part in a template, before the template\n * is instantiated. When a template is instantiated Parts are created from\n * TemplateParts.\n */\ntype TemplatePart =\n  | NodeTemplatePart\n  | AttributeTemplatePart\n  | ElementTemplatePart\n  | CommentTemplatePart;\n\nexport type Part =\n  | ChildPart\n  | AttributePart\n  | PropertyPart\n  | BooleanAttributePart\n  | ElementPart\n  | EventPart;\n\nexport type {ChildPart};\nclass ChildPart implements Disconnectable {\n  readonly type = CHILD_PART;\n  readonly options: RenderOptions | undefined;\n  _$committedValue: unknown = nothing;\n  /** @internal */\n  __directive?: Directive;\n  /** @internal */\n  _$startNode: ChildNode;\n  /** @internal */\n  _$endNode: ChildNode | null;\n  private _textSanitizer: ValueSanitizer | undefined;\n  /** @internal */\n  _$parent: Disconnectable | undefined;\n  /**\n   * Connection state for RootParts only (i.e. ChildPart without _$parent\n   * returned from top-level `render`). This field is unsed otherwise. The\n   * intention would clearer if we made `RootPart` a subclass of `ChildPart`\n   * with this field (and a different _$isConnected getter), but the subclass\n   * caused a perf regression, possibly due to making call sites polymorphic.\n   * @internal\n   */\n  __isConnected: boolean;\n\n  // See comment in Disconnectable interface for why this is a getter\n  get _$isConnected() {\n    // ChildParts that are not at the root should always be created with a\n    // parent; only RootChildNode's won't, so they return the local isConnected\n    // state\n    return this._$parent?._$isConnected ?? this.__isConnected;\n  }\n\n  // The following fields will be patched onto ChildParts when required by\n  // AsyncDirective\n  /** @internal */\n  _$disconnectableChildren?: Set<Disconnectable> = undefined;\n  /** @internal */\n  _$notifyConnectionChanged?(\n    isConnected: boolean,\n    removeFromParent?: boolean,\n    from?: number\n  ): void;\n  /** @internal */\n  _$reparentDisconnectables?(parent: Disconnectable): void;\n\n  constructor(\n    startNode: ChildNode,\n    endNode: ChildNode | null,\n    parent: TemplateInstance | ChildPart | undefined,\n    options: RenderOptions | undefined\n  ) {\n    this._$startNode = startNode;\n    this._$endNode = endNode;\n    this._$parent = parent;\n    this.options = options;\n    // Note __isConnected is only ever accessed on RootParts (i.e. when there is\n    // no _$parent); the value on a non-root-part is \"don't care\", but checking\n    // for parent would be more code\n    this.__isConnected = options?.isConnected ?? true;\n    if (ENABLE_EXTRA_SECURITY_HOOKS) {\n      // Explicitly initialize for consistent class shape.\n      this._textSanitizer = undefined;\n    }\n  }\n\n  /**\n   * The parent node into which the part renders its content.\n   *\n   * A ChildPart's content consists of a range of adjacent child nodes of\n   * `.parentNode`, possibly bordered by 'marker nodes' (`.startNode` and\n   * `.endNode`).\n   *\n   * - If both `.startNode` and `.endNode` are non-null, then the part's content\n   * consists of all siblings between `.startNode` and `.endNode`, exclusively.\n   *\n   * - If `.startNode` is non-null but `.endNode` is null, then the part's\n   * content consists of all siblings following `.startNode`, up to and\n   * including the last child of `.parentNode`. If `.endNode` is non-null, then\n   * `.startNode` will always be non-null.\n   *\n   * - If both `.endNode` and `.startNode` are null, then the part's content\n   * consists of all child nodes of `.parentNode`.\n   */\n  get parentNode(): Node {\n    let parentNode: Node = wrap(this._$startNode).parentNode!;\n    const parent = this._$parent;\n    if (\n      parent !== undefined &&\n      parentNode?.nodeType === 11 /* Node.DOCUMENT_FRAGMENT */\n    ) {\n      // If the parentNode is a DocumentFragment, it may be because the DOM is\n      // still in the cloned fragment during initial render; if so, get the real\n      // parentNode the part will be committed into by asking the parent.\n      parentNode = (parent as ChildPart | TemplateInstance).parentNode;\n    }\n    return parentNode;\n  }\n\n  /**\n   * The part's leading marker node, if any. See `.parentNode` for more\n   * information.\n   */\n  get startNode(): Node | null {\n    return this._$startNode;\n  }\n\n  /**\n   * The part's trailing marker node, if any. See `.parentNode` for more\n   * information.\n   */\n  get endNode(): Node | null {\n    return this._$endNode;\n  }\n\n  _$setValue(value: unknown, directiveParent: DirectiveParent = this): void {\n    if (DEV_MODE && this.parentNode === null) {\n      throw new Error(\n        `This \\`ChildPart\\` has no \\`parentNode\\` and therefore cannot accept a value. This likely means the element containing the part was manipulated in an unsupported way outside of Lit's control such that the part's marker nodes were ejected from DOM. For example, setting the element's \\`innerHTML\\` or \\`textContent\\` can do this.`\n      );\n    }\n    value = resolveDirective(this, value, directiveParent);\n    if (isPrimitive(value)) {\n      // Non-rendering child values. It's important that these do not render\n      // empty text nodes to avoid issues with preventing default <slot>\n      // fallback content.\n      if (value === nothing || value == null || value === '') {\n        if (this._$committedValue !== nothing) {\n          debugLogEvent?.({\n            kind: 'commit nothing to child',\n            start: this._$startNode,\n            end: this._$endNode,\n            parent: this._$parent,\n            options: this.options,\n          });\n          this._$clear();\n        }\n        this._$committedValue = nothing;\n      } else if (value !== this._$committedValue && value !== noChange) {\n        this._commitText(value);\n      }\n      // This property needs to remain unminified.\n    } else if ((value as TemplateResult)['_$litType$'] !== undefined) {\n      this._commitTemplateResult(value as TemplateResult);\n    } else if ((value as Node).nodeType !== undefined) {\n      if (DEV_MODE && this.options?.host === value) {\n        this._commitText(\n          `[probable mistake: rendered a template's host in itself ` +\n            `(commonly caused by writing \\${this} in a template]`\n        );\n        console.warn(\n          `Attempted to render the template host`,\n          value,\n          `inside itself. This is almost always a mistake, and in dev mode `,\n          `we render some warning text. In production however, we'll `,\n          `render it, which will usually result in an error, and sometimes `,\n          `in the element disappearing from the DOM.`\n        );\n        return;\n      }\n      this._commitNode(value as Node);\n    } else if (isIterable(value)) {\n      this._commitIterable(value);\n    } else {\n      // Fallback, will render the string representation\n      this._commitText(value);\n    }\n  }\n\n  private _insert<T extends Node>(node: T) {\n    return wrap(wrap(this._$startNode).parentNode!).insertBefore(\n      node,\n      this._$endNode\n    );\n  }\n\n  private _commitNode(value: Node): void {\n    if (this._$committedValue !== value) {\n      this._$clear();\n      if (\n        ENABLE_EXTRA_SECURITY_HOOKS &&\n        sanitizerFactoryInternal !== noopSanitizer\n      ) {\n        const parentNodeName = this._$startNode.parentNode?.nodeName;\n        if (parentNodeName === 'STYLE' || parentNodeName === 'SCRIPT') {\n          let message = 'Forbidden';\n          if (DEV_MODE) {\n            if (parentNodeName === 'STYLE') {\n              message =\n                `Lit does not support binding inside style nodes. ` +\n                `This is a security risk, as style injection attacks can ` +\n                `exfiltrate data and spoof UIs. ` +\n                `Consider instead using css\\`...\\` literals ` +\n                `to compose styles, and make do dynamic styling with ` +\n                `css custom properties, ::parts, <slot>s, ` +\n                `and by mutating the DOM rather than stylesheets.`;\n            } else {\n              message =\n                `Lit does not support binding inside script nodes. ` +\n                `This is a security risk, as it could allow arbitrary ` +\n                `code execution.`;\n            }\n          }\n          throw new Error(message);\n        }\n      }\n      debugLogEvent?.({\n        kind: 'commit node',\n        start: this._$startNode,\n        parent: this._$parent,\n        value: value,\n        options: this.options,\n      });\n      this._$committedValue = this._insert(value);\n    }\n  }\n\n  private _commitText(value: unknown): void {\n    // If the committed value is a primitive it means we called _commitText on\n    // the previous render, and we know that this._$startNode.nextSibling is a\n    // Text node. We can now just replace the text content (.data) of the node.\n    if (\n      this._$committedValue !== nothing &&\n      isPrimitive(this._$committedValue)\n    ) {\n      const node = wrap(this._$startNode).nextSibling as Text;\n      if (ENABLE_EXTRA_SECURITY_HOOKS) {\n        if (this._textSanitizer === undefined) {\n          this._textSanitizer = createSanitizer(node, 'data', 'property');\n        }\n        value = this._textSanitizer(value);\n      }\n      debugLogEvent?.({\n        kind: 'commit text',\n        node,\n        value,\n        options: this.options,\n      });\n      (node as Text).data = value as string;\n    } else {\n      if (ENABLE_EXTRA_SECURITY_HOOKS) {\n        const textNode = d.createTextNode('');\n        this._commitNode(textNode);\n        // When setting text content, for security purposes it matters a lot\n        // what the parent is. For example, <style> and <script> need to be\n        // handled with care, while <span> does not. So first we need to put a\n        // text node into the document, then we can sanitize its content.\n        if (this._textSanitizer === undefined) {\n          this._textSanitizer = createSanitizer(textNode, 'data', 'property');\n        }\n        value = this._textSanitizer(value);\n        debugLogEvent?.({\n          kind: 'commit text',\n          node: textNode,\n          value,\n          options: this.options,\n        });\n        textNode.data = value as string;\n      } else {\n        this._commitNode(d.createTextNode(value as string));\n        debugLogEvent?.({\n          kind: 'commit text',\n          node: wrap(this._$startNode).nextSibling as Text,\n          value,\n          options: this.options,\n        });\n      }\n    }\n    this._$committedValue = value;\n  }\n\n  private _commitTemplateResult(\n    result: TemplateResult | CompiledTemplateResult\n  ): void {\n    // This property needs to remain unminified.\n    const {values, ['_$litType$']: type} = result;\n    // If $litType$ is a number, result is a plain TemplateResult and we get\n    // the template from the template cache. If not, result is a\n    // CompiledTemplateResult and _$litType$ is a CompiledTemplate and we need\n    // to create the <template> element the first time we see it.\n    const template: Template | CompiledTemplate =\n      typeof type === 'number'\n        ? this._$getTemplate(result as TemplateResult)\n        : (type.el === undefined &&\n            (type.el = Template.createElement(type.h, this.options)),\n          type);\n\n    if ((this._$committedValue as TemplateInstance)?._$template === template) {\n      debugLogEvent?.({\n        kind: 'template updating',\n        template,\n        instance: this._$committedValue as TemplateInstance,\n        parts: (this._$committedValue as TemplateInstance)._parts,\n        options: this.options,\n        values,\n      });\n      (this._$committedValue as TemplateInstance)._update(values);\n    } else {\n      const instance = new TemplateInstance(template as Template, this);\n      const fragment = instance._clone(this.options);\n      debugLogEvent?.({\n        kind: 'template instantiated',\n        template,\n        instance,\n        parts: instance._parts,\n        options: this.options,\n        fragment,\n        values,\n      });\n      instance._update(values);\n      debugLogEvent?.({\n        kind: 'template instantiated and updated',\n        template,\n        instance,\n        parts: instance._parts,\n        options: this.options,\n        fragment,\n        values,\n      });\n      this._commitNode(fragment);\n      this._$committedValue = instance;\n    }\n  }\n\n  // Overridden via `litHtmlPolyfillSupport` to provide platform support.\n  /** @internal */\n  _$getTemplate(result: TemplateResult) {\n    let template = templateCache.get(result.strings);\n    if (template === undefined) {\n      templateCache.set(result.strings, (template = new Template(result)));\n    }\n    return template;\n  }\n\n  private _commitIterable(value: Iterable<unknown>): void {\n    // For an Iterable, we create a new InstancePart per item, then set its\n    // value to the item. This is a little bit of overhead for every item in\n    // an Iterable, but it lets us recurse easily and efficiently update Arrays\n    // of TemplateResults that will be commonly returned from expressions like:\n    // array.map((i) => html`${i}`), by reusing existing TemplateInstances.\n\n    // If value is an array, then the previous render was of an\n    // iterable and value will contain the ChildParts from the previous\n    // render. If value is not an array, clear this part and make a new\n    // array for ChildParts.\n    if (!isArray(this._$committedValue)) {\n      this._$committedValue = [];\n      this._$clear();\n    }\n\n    // Lets us keep track of how many items we stamped so we can clear leftover\n    // items from a previous render\n    const itemParts = this._$committedValue as ChildPart[];\n    let partIndex = 0;\n    let itemPart: ChildPart | undefined;\n\n    for (const item of value) {\n      if (partIndex === itemParts.length) {\n        // If no existing part, create a new one\n        // TODO (justinfagnani): test perf impact of always creating two parts\n        // instead of sharing parts between nodes\n        // https://github.com/lit/lit/issues/1266\n        itemParts.push(\n          (itemPart = new ChildPart(\n            this._insert(createMarker()),\n            this._insert(createMarker()),\n            this,\n            this.options\n          ))\n        );\n      } else {\n        // Reuse an existing part\n        itemPart = itemParts[partIndex];\n      }\n      itemPart._$setValue(item);\n      partIndex++;\n    }\n\n    if (partIndex < itemParts.length) {\n      // itemParts always have end nodes\n      this._$clear(\n        itemPart && wrap(itemPart._$endNode!).nextSibling,\n        partIndex\n      );\n      // Truncate the parts array so _value reflects the current state\n      itemParts.length = partIndex;\n    }\n  }\n\n  /**\n   * Removes the nodes contained within this Part from the DOM.\n   *\n   * @param start Start node to clear from, for clearing a subset of the part's\n   *     DOM (used when truncating iterables)\n   * @param from  When `start` is specified, the index within the iterable from\n   *     which ChildParts are being removed, used for disconnecting directives in\n   *     those Parts.\n   *\n   * @internal\n   */\n  _$clear(\n    start: ChildNode | null = wrap(this._$startNode).nextSibling,\n    from?: number\n  ) {\n    this._$notifyConnectionChanged?.(false, true, from);\n    while (start && start !== this._$endNode) {\n      const n = wrap(start!).nextSibling;\n      (wrap(start!) as Element).remove();\n      start = n;\n    }\n  }\n  /**\n   * Implementation of RootPart's `isConnected`. Note that this metod\n   * should only be called on `RootPart`s (the `ChildPart` returned from a\n   * top-level `render()` call). It has no effect on non-root ChildParts.\n   * @param isConnected Whether to set\n   * @internal\n   */\n  setConnected(isConnected: boolean) {\n    if (this._$parent === undefined) {\n      this.__isConnected = isConnected;\n      this._$notifyConnectionChanged?.(isConnected);\n    } else if (DEV_MODE) {\n      throw new Error(\n        'part.setConnected() may only be called on a ' +\n          'RootPart returned from render().'\n      );\n    }\n  }\n}\n\n/**\n * A top-level `ChildPart` returned from `render` that manages the connected\n * state of `AsyncDirective`s created throughout the tree below it.\n */\nexport interface RootPart extends ChildPart {\n  /**\n   * Sets the connection state for `AsyncDirective`s contained within this root\n   * ChildPart.\n   *\n   * lit-html does not automatically monitor the connectedness of DOM rendered;\n   * as such, it is the responsibility of the caller to `render` to ensure that\n   * `part.setConnected(false)` is called before the part object is potentially\n   * discarded, to ensure that `AsyncDirective`s have a chance to dispose of\n   * any resources being held. If a `RootPart` that was previously\n   * disconnected is subsequently re-connected (and its `AsyncDirective`s should\n   * re-connect), `setConnected(true)` should be called.\n   *\n   * @param isConnected Whether directives within this tree should be connected\n   * or not\n   */\n  setConnected(isConnected: boolean): void;\n}\n\nexport type {AttributePart};\nclass AttributePart implements Disconnectable {\n  readonly type = ATTRIBUTE_PART as\n    | typeof ATTRIBUTE_PART\n    | typeof PROPERTY_PART\n    | typeof BOOLEAN_ATTRIBUTE_PART\n    | typeof EVENT_PART;\n  readonly element: HTMLElement;\n  readonly name: string;\n  readonly options: RenderOptions | undefined;\n\n  /**\n   * If this attribute part represents an interpolation, this contains the\n   * static strings of the interpolation. For single-value, complete bindings,\n   * this is undefined.\n   */\n  readonly strings?: ReadonlyArray<string>;\n  /** @internal */\n  _$committedValue: unknown | Array<unknown> = nothing;\n  /** @internal */\n  __directives?: Array<Directive | undefined>;\n  /** @internal */\n  _$parent: Disconnectable;\n  /** @internal */\n  _$disconnectableChildren?: Set<Disconnectable> = undefined;\n\n  protected _sanitizer: ValueSanitizer | undefined;\n\n  get tagName() {\n    return this.element.tagName;\n  }\n\n  // See comment in Disconnectable interface for why this is a getter\n  get _$isConnected() {\n    return this._$parent._$isConnected;\n  }\n\n  constructor(\n    element: HTMLElement,\n    name: string,\n    strings: ReadonlyArray<string>,\n    parent: Disconnectable,\n    options: RenderOptions | undefined\n  ) {\n    this.element = element;\n    this.name = name;\n    this._$parent = parent;\n    this.options = options;\n    if (strings.length > 2 || strings[0] !== '' || strings[1] !== '') {\n      this._$committedValue = new Array(strings.length - 1).fill(new String());\n      this.strings = strings;\n    } else {\n      this._$committedValue = nothing;\n    }\n    if (ENABLE_EXTRA_SECURITY_HOOKS) {\n      this._sanitizer = undefined;\n    }\n  }\n\n  /**\n   * Sets the value of this part by resolving the value from possibly multiple\n   * values and static strings and committing it to the DOM.\n   * If this part is single-valued, `this._strings` will be undefined, and the\n   * method will be called with a single value argument. If this part is\n   * multi-value, `this._strings` will be defined, and the method is called\n   * with the value array of the part's owning TemplateInstance, and an offset\n   * into the value array from which the values should be read.\n   * This method is overloaded this way to eliminate short-lived array slices\n   * of the template instance values, and allow a fast-path for single-valued\n   * parts.\n   *\n   * @param value The part value, or an array of values for multi-valued parts\n   * @param valueIndex the index to start reading values from. `undefined` for\n   *   single-valued parts\n   * @param noCommit causes the part to not commit its value to the DOM. Used\n   *   in hydration to prime attribute parts with their first-rendered value,\n   *   but not set the attribute, and in SSR to no-op the DOM operation and\n   *   capture the value for serialization.\n   *\n   * @internal\n   */\n  _$setValue(\n    value: unknown | Array<unknown>,\n    directiveParent: DirectiveParent = this,\n    valueIndex?: number,\n    noCommit?: boolean\n  ) {\n    const strings = this.strings;\n\n    // Whether any of the values has changed, for dirty-checking\n    let change = false;\n\n    if (strings === undefined) {\n      // Single-value binding case\n      value = resolveDirective(this, value, directiveParent, 0);\n      change =\n        !isPrimitive(value) ||\n        (value !== this._$committedValue && value !== noChange);\n      if (change) {\n        this._$committedValue = value;\n      }\n    } else {\n      // Interpolation case\n      const values = value as Array<unknown>;\n      value = strings[0];\n\n      let i, v;\n      for (i = 0; i < strings.length - 1; i++) {\n        v = resolveDirective(this, values[valueIndex! + i], directiveParent, i);\n\n        if (v === noChange) {\n          // If the user-provided value is `noChange`, use the previous value\n          v = (this._$committedValue as Array<unknown>)[i];\n        }\n        change ||=\n          !isPrimitive(v) || v !== (this._$committedValue as Array<unknown>)[i];\n        if (v === nothing) {\n          value = nothing;\n        } else if (value !== nothing) {\n          value += (v ?? '') + strings[i + 1];\n        }\n        // We always record each value, even if one is `nothing`, for future\n        // change detection.\n        (this._$committedValue as Array<unknown>)[i] = v;\n      }\n    }\n    if (change && !noCommit) {\n      this._commitValue(value);\n    }\n  }\n\n  /** @internal */\n  _commitValue(value: unknown) {\n    if (value === nothing) {\n      (wrap(this.element) as Element).removeAttribute(this.name);\n    } else {\n      if (ENABLE_EXTRA_SECURITY_HOOKS) {\n        if (this._sanitizer === undefined) {\n          this._sanitizer = sanitizerFactoryInternal(\n            this.element,\n            this.name,\n            'attribute'\n          );\n        }\n        value = this._sanitizer(value ?? '');\n      }\n      debugLogEvent?.({\n        kind: 'commit attribute',\n        element: this.element,\n        name: this.name,\n        value,\n        options: this.options,\n      });\n      (wrap(this.element) as Element).setAttribute(\n        this.name,\n        (value ?? '') as string\n      );\n    }\n  }\n}\n\nexport type {PropertyPart};\nclass PropertyPart extends AttributePart {\n  override readonly type = PROPERTY_PART;\n\n  /** @internal */\n  override _commitValue(value: unknown) {\n    if (ENABLE_EXTRA_SECURITY_HOOKS) {\n      if (this._sanitizer === undefined) {\n        this._sanitizer = sanitizerFactoryInternal(\n          this.element,\n          this.name,\n          'property'\n        );\n      }\n      value = this._sanitizer(value);\n    }\n    debugLogEvent?.({\n      kind: 'commit property',\n      element: this.element,\n      name: this.name,\n      value,\n      options: this.options,\n    });\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    (this.element as any)[this.name] = value === nothing ? undefined : value;\n  }\n}\n\n// Temporary workaround for https://crbug.com/993268\n// Currently, any attribute starting with \"on\" is considered to be a\n// TrustedScript source. Such boolean attributes must be set to the equivalent\n// trusted emptyScript value.\nconst emptyStringForBooleanAttribute = trustedTypes\n  ? (trustedTypes.emptyScript as unknown as '')\n  : '';\n\nexport type {BooleanAttributePart};\nclass BooleanAttributePart extends AttributePart {\n  override readonly type = BOOLEAN_ATTRIBUTE_PART;\n\n  /** @internal */\n  override _commitValue(value: unknown) {\n    debugLogEvent?.({\n      kind: 'commit boolean attribute',\n      element: this.element,\n      name: this.name,\n      value: !!(value && value !== nothing),\n      options: this.options,\n    });\n    if (value && value !== nothing) {\n      (wrap(this.element) as Element).setAttribute(\n        this.name,\n        emptyStringForBooleanAttribute\n      );\n    } else {\n      (wrap(this.element) as Element).removeAttribute(this.name);\n    }\n  }\n}\n\ntype EventListenerWithOptions = EventListenerOrEventListenerObject &\n  Partial<AddEventListenerOptions>;\n\n/**\n * An AttributePart that manages an event listener via add/removeEventListener.\n *\n * This part works by adding itself as the event listener on an element, then\n * delegating to the value passed to it. This reduces the number of calls to\n * add/removeEventListener if the listener changes frequently, such as when an\n * inline function is used as a listener.\n *\n * Because event options are passed when adding listeners, we must take case\n * to add and remove the part as a listener when the event options change.\n */\nexport type {EventPart};\nclass EventPart extends AttributePart {\n  override readonly type = EVENT_PART;\n\n  constructor(\n    element: HTMLElement,\n    name: string,\n    strings: ReadonlyArray<string>,\n    parent: Disconnectable,\n    options: RenderOptions | undefined\n  ) {\n    super(element, name, strings, parent, options);\n\n    if (DEV_MODE && this.strings !== undefined) {\n      throw new Error(\n        `A \\`<${element.localName}>\\` has a \\`@${name}=...\\` listener with ` +\n          'invalid content. Event listeners in templates must have exactly ' +\n          'one expression and no surrounding text.'\n      );\n    }\n  }\n\n  // EventPart does not use the base _$setValue/_resolveValue implementation\n  // since the dirty checking is more complex\n  /** @internal */\n  override _$setValue(\n    newListener: unknown,\n    directiveParent: DirectiveParent = this\n  ) {\n    newListener =\n      resolveDirective(this, newListener, directiveParent, 0) ?? nothing;\n    if (newListener === noChange) {\n      return;\n    }\n    const oldListener = this._$committedValue;\n\n    // If the new value is nothing or any options change we have to remove the\n    // part as a listener.\n    const shouldRemoveListener =\n      (newListener === nothing && oldListener !== nothing) ||\n      (newListener as EventListenerWithOptions).capture !==\n        (oldListener as EventListenerWithOptions).capture ||\n      (newListener as EventListenerWithOptions).once !==\n        (oldListener as EventListenerWithOptions).once ||\n      (newListener as EventListenerWithOptions).passive !==\n        (oldListener as EventListenerWithOptions).passive;\n\n    // If the new value is not nothing and we removed the listener, we have\n    // to add the part as a listener.\n    const shouldAddListener =\n      newListener !== nothing &&\n      (oldListener === nothing || shouldRemoveListener);\n\n    debugLogEvent?.({\n      kind: 'commit event listener',\n      element: this.element,\n      name: this.name,\n      value: newListener,\n      options: this.options,\n      removeListener: shouldRemoveListener,\n      addListener: shouldAddListener,\n      oldListener,\n    });\n    if (shouldRemoveListener) {\n      this.element.removeEventListener(\n        this.name,\n        this,\n        oldListener as EventListenerWithOptions\n      );\n    }\n    if (shouldAddListener) {\n      // Beware: IE11 and Chrome 41 don't like using the listener as the\n      // options object. Figure out how to deal w/ this in IE11 - maybe\n      // patch addEventListener?\n      this.element.addEventListener(\n        this.name,\n        this,\n        newListener as EventListenerWithOptions\n      );\n    }\n    this._$committedValue = newListener;\n  }\n\n  handleEvent(event: Event) {\n    if (typeof this._$committedValue === 'function') {\n      this._$committedValue.call(this.options?.host ?? this.element, event);\n    } else {\n      (this._$committedValue as EventListenerObject).handleEvent(event);\n    }\n  }\n}\n\nexport type {ElementPart};\nclass ElementPart implements Disconnectable {\n  readonly type = ELEMENT_PART;\n\n  /** @internal */\n  __directive?: Directive;\n\n  // This is to ensure that every Part has a _$committedValue\n  _$committedValue: undefined;\n\n  /** @internal */\n  _$parent!: Disconnectable;\n\n  /** @internal */\n  _$disconnectableChildren?: Set<Disconnectable> = undefined;\n\n  options: RenderOptions | undefined;\n\n  constructor(\n    public element: Element,\n    parent: Disconnectable,\n    options: RenderOptions | undefined\n  ) {\n    this._$parent = parent;\n    this.options = options;\n  }\n\n  // See comment in Disconnectable interface for why this is a getter\n  get _$isConnected() {\n    return this._$parent._$isConnected;\n  }\n\n  _$setValue(value: unknown): void {\n    debugLogEvent?.({\n      kind: 'commit to element binding',\n      element: this.element,\n      value,\n      options: this.options,\n    });\n    resolveDirective(this, value);\n  }\n}\n\n/**\n * END USERS SHOULD NOT RELY ON THIS OBJECT.\n *\n * Private exports for use by other Lit packages, not intended for use by\n * external users.\n *\n * We currently do not make a mangled rollup build of the lit-ssr code. In order\n * to keep a number of (otherwise private) top-level exports  mangled in the\n * client side code, we export a _$LH object containing those members (or\n * helper methods for accessing private fields of those members), and then\n * re-export them for use in lit-ssr. This keeps lit-ssr agnostic to whether the\n * client-side code is being used in `dev` mode or `prod` mode.\n *\n * This has a unique name, to disambiguate it from private exports in\n * lit-element, which re-exports all of lit-html.\n *\n * @private\n */\nexport const _$LH = {\n  // Used in lit-ssr\n  _boundAttributeSuffix: boundAttributeSuffix,\n  _marker: marker,\n  _markerMatch: markerMatch,\n  _HTML_RESULT: HTML_RESULT,\n  _getTemplateHtml: getTemplateHtml,\n  // Used in hydrate\n  _TemplateInstance: TemplateInstance,\n  _isIterable: isIterable,\n  _resolveDirective: resolveDirective,\n  // Used in tests and private-ssr-support\n  _ChildPart: ChildPart,\n  _AttributePart: AttributePart,\n  _BooleanAttributePart: BooleanAttributePart,\n  _EventPart: EventPart,\n  _PropertyPart: PropertyPart,\n  _ElementPart: ElementPart,\n};\n\n// Apply polyfills if available\nconst polyfillSupport = DEV_MODE\n  ? global.litHtmlPolyfillSupportDevMode\n  : global.litHtmlPolyfillSupport;\npolyfillSupport?.(Template, ChildPart);\n\n// IMPORTANT: do not change the property name or the assignment expression.\n// This line will be used in regexes to search for lit-html usage.\n(global.litHtmlVersions ??= []).push('2.7.0');\nif (DEV_MODE && global.litHtmlVersions.length > 1) {\n  issueWarning!(\n    'multiple-versions',\n    `Multiple versions of Lit loaded. ` +\n      `Loading multiple versions is not recommended.`\n  );\n}\n\n/**\n * Renders a value, usually a lit-html TemplateResult, to the container.\n *\n * This example renders the text \"Hello, Zoe!\" inside a paragraph tag, appending\n * it to the container `document.body`.\n *\n * ```js\n * import {html, render} from 'lit';\n *\n * const name = \"Zoe\";\n * render(html`<p>Hello, ${name}!</p>`, document.body);\n * ```\n *\n * @param value Any [renderable\n *   value](https://lit.dev/docs/templates/expressions/#child-expressions),\n *   typically a {@linkcode TemplateResult} created by evaluating a template tag\n *   like {@linkcode html} or {@linkcode svg}.\n * @param container A DOM container to render to. The first render will append\n *   the rendered value to the container, and subsequent renders will\n *   efficiently update the rendered value if the same result type was\n *   previously rendered there.\n * @param options See {@linkcode RenderOptions} for options documentation.\n * @see\n * {@link https://lit.dev/docs/libraries/standalone-templates/#rendering-lit-html-templates| Rendering Lit HTML Templates}\n */\nexport const render = (\n  value: unknown,\n  container: HTMLElement | DocumentFragment,\n  options?: RenderOptions\n): RootPart => {\n  if (DEV_MODE && container == null) {\n    // Give a clearer error message than\n    //     Uncaught TypeError: Cannot read properties of null (reading\n    //     '_$litPart$')\n    // which reads like an internal Lit error.\n    throw new TypeError(`The container to render into may not be ${container}`);\n  }\n  const renderId = DEV_MODE ? debugLogRenderId++ : 0;\n  const partOwnerNode = options?.renderBefore ?? container;\n  // This property needs to remain unminified.\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  let part: ChildPart = (partOwnerNode as any)['_$litPart$'];\n  debugLogEvent?.({\n    kind: 'begin render',\n    id: renderId,\n    value,\n    container,\n    options,\n    part,\n  });\n  if (part === undefined) {\n    const endNode = options?.renderBefore ?? null;\n    // This property needs to remain unminified.\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    (partOwnerNode as any)['_$litPart$'] = part = new ChildPart(\n      container.insertBefore(createMarker(), endNode),\n      endNode,\n      undefined,\n      options ?? {}\n    );\n  }\n  part._$setValue(value);\n  debugLogEvent?.({\n    kind: 'end render',\n    id: renderId,\n    value,\n    container,\n    options,\n    part,\n  });\n  return part as RootPart;\n};\n\nif (ENABLE_EXTRA_SECURITY_HOOKS) {\n  render.setSanitizer = setSanitizer;\n  render.createSanitizer = createSanitizer;\n  if (DEV_MODE) {\n    render._testOnlyClearSanitizerFactoryDoNotCallOrElse =\n      _testOnlyClearSanitizerFactoryDoNotCallOrElse;\n  }\n}\n", "/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\n\n/**\n * The main LitElement module, which defines the {@linkcode LitElement} base\n * class and related APIs.\n *\n *  LitElement components can define a template and a set of observed\n * properties. Changing an observed property triggers a re-render of the\n * element.\n *\n *  Import {@linkcode LitElement} and {@linkcode html} from this module to\n * create a component:\n *\n *  ```js\n * import {LitElement, html} from 'lit-element';\n *\n * class MyElement extends LitElement {\n *\n *   // Declare observed properties\n *   static get properties() {\n *     return {\n *       adjective: {}\n *     }\n *   }\n *\n *   constructor() {\n *     this.adjective = 'awesome';\n *   }\n *\n *   // Define the element's template\n *   render() {\n *     return html`<p>your ${adjective} template here</p>`;\n *   }\n * }\n *\n * customElements.define('my-element', MyElement);\n * ```\n *\n * `LitElement` extends {@linkcode ReactiveElement} and adds lit-html\n * templating. The `ReactiveElement` class is provided for users that want to\n * build their own custom element base classes that don't use lit-html.\n *\n * @packageDocumentation\n */\nimport {PropertyValues, ReactiveElement} from '@lit/reactive-element';\nimport {render, RenderOptions, noChange, RootPart} from 'lit-html';\nexport * from '@lit/reactive-element';\nexport * from 'lit-html';\n\nimport {LitUnstable} from 'lit-html';\nimport {ReactiveUnstable} from '@lit/reactive-element';\n\n/**\n * Contains types that are part of the unstable debug API.\n *\n * Everything in this API is not stable and may change or be removed in the future,\n * even on patch releases.\n */\n// eslint-disable-next-line @typescript-eslint/no-namespace\nexport namespace Unstable {\n  /**\n   * When Lit is running in dev mode and `window.emitLitDebugLogEvents` is true,\n   * we will emit 'lit-debug' events to window, with live details about the update and render\n   * lifecycle. These can be useful for writing debug tooling and visualizations.\n   *\n   * Please be aware that running with window.emitLitDebugLogEvents has performance overhead,\n   * making certain operations that are normally very cheap (like a no-op render) much slower,\n   * because we must copy data and dispatch events.\n   */\n  // eslint-disable-next-line @typescript-eslint/no-namespace\n  export namespace DebugLog {\n    export type Entry =\n      | LitUnstable.DebugLog.Entry\n      | ReactiveUnstable.DebugLog.Entry;\n  }\n}\n\n// For backwards compatibility export ReactiveElement as UpdatingElement. Note,\n// IE transpilation requires exporting like this.\nexport const UpdatingElement = ReactiveElement;\n\nconst DEV_MODE = true;\n\nlet issueWarning: (code: string, warning: string) => void;\n\nif (DEV_MODE) {\n  // Ensure warnings are issued only 1x, even if multiple versions of Lit\n  // are loaded.\n  const issuedWarnings: Set<string | undefined> =\n    (globalThis.litIssuedWarnings ??= new Set());\n\n  // Issue a warning, if we haven't already.\n  issueWarning = (code: string, warning: string) => {\n    warning += ` See https://lit.dev/msg/${code} for more information.`;\n    if (!issuedWarnings.has(warning)) {\n      console.warn(warning);\n      issuedWarnings.add(warning);\n    }\n  };\n}\n\n/**\n * Base element class that manages element properties and attributes, and\n * renders a lit-html template.\n *\n * To define a component, subclass `LitElement` and implement a\n * `render` method to provide the component's template. Define properties\n * using the {@linkcode LitElement.properties properties} property or the\n * {@linkcode property} decorator.\n */\nexport class LitElement extends ReactiveElement {\n  /**\n   * Ensure this class is marked as `finalized` as an optimization ensuring\n   * it will not needlessly try to `finalize`.\n   *\n   * Note this property name is a string to prevent breaking Closure JS Compiler\n   * optimizations. See @lit/reactive-element for more information.\n   */\n  protected static override ['finalized'] = true;\n\n  // This property needs to remain unminified.\n  static ['_$litElement$'] = true;\n\n  /**\n   * @category rendering\n   */\n  readonly renderOptions: RenderOptions = {host: this};\n\n  private __childPart: RootPart | undefined = undefined;\n\n  /**\n   * @category rendering\n   */\n  protected override createRenderRoot() {\n    const renderRoot = super.createRenderRoot();\n    // When adoptedStyleSheets are shimmed, they are inserted into the\n    // shadowRoot by createRenderRoot. Adjust the renderBefore node so that\n    // any styles in Lit content render before adoptedStyleSheets. This is\n    // important so that adoptedStyleSheets have precedence over styles in\n    // the shadowRoot.\n    this.renderOptions.renderBefore ??= renderRoot!.firstChild as ChildNode;\n    return renderRoot;\n  }\n\n  /**\n   * Updates the element. This method reflects property values to attributes\n   * and calls `render` to render DOM via lit-html. Setting properties inside\n   * this method will *not* trigger another update.\n   * @param changedProperties Map of changed properties with old values\n   * @category updates\n   */\n  protected override update(changedProperties: PropertyValues) {\n    // Setting properties in `render` should not trigger an update. Since\n    // updates are allowed after super.update, it's important to call `render`\n    // before that.\n    const value = this.render();\n    if (!this.hasUpdated) {\n      this.renderOptions.isConnected = this.isConnected;\n    }\n    super.update(changedProperties);\n    this.__childPart = render(value, this.renderRoot, this.renderOptions);\n  }\n\n  /**\n   * Invoked when the component is added to the document's DOM.\n   *\n   * In `connectedCallback()` you should setup tasks that should only occur when\n   * the element is connected to the document. The most common of these is\n   * adding event listeners to nodes external to the element, like a keydown\n   * event handler added to the window.\n   *\n   * ```ts\n   * connectedCallback() {\n   *   super.connectedCallback();\n   *   addEventListener('keydown', this._handleKeydown);\n   * }\n   * ```\n   *\n   * Typically, anything done in `connectedCallback()` should be undone when the\n   * element is disconnected, in `disconnectedCallback()`.\n   *\n   * @category lifecycle\n   */\n  override connectedCallback() {\n    super.connectedCallback();\n    this.__childPart?.setConnected(true);\n  }\n\n  /**\n   * Invoked when the component is removed from the document's DOM.\n   *\n   * This callback is the main signal to the element that it may no longer be\n   * used. `disconnectedCallback()` should ensure that nothing is holding a\n   * reference to the element (such as event listeners added to nodes external\n   * to the element), so that it is free to be garbage collected.\n   *\n   * ```ts\n   * disconnectedCallback() {\n   *   super.disconnectedCallback();\n   *   window.removeEventListener('keydown', this._handleKeydown);\n   * }\n   * ```\n   *\n   * An element may be re-connected after being disconnected.\n   *\n   * @category lifecycle\n   */\n  override disconnectedCallback() {\n    super.disconnectedCallback();\n    this.__childPart?.setConnected(false);\n  }\n\n  /**\n   * Invoked on each update to perform rendering tasks. This method may return\n   * any value renderable by lit-html's `ChildPart` - typically a\n   * `TemplateResult`. Setting properties inside this method will *not* trigger\n   * the element to update.\n   * @category rendering\n   */\n  protected render(): unknown {\n    return noChange;\n  }\n}\n\n// Install hydration if available\nglobalThis.litElementHydrateSupport?.({LitElement});\n\n// Apply polyfills if available\nconst polyfillSupport = DEV_MODE\n  ? globalThis.litElementPolyfillSupportDevMode\n  : globalThis.litElementPolyfillSupport;\npolyfillSupport?.({LitElement});\n\n// DEV mode warnings\nif (DEV_MODE) {\n  /* eslint-disable @typescript-eslint/no-explicit-any */\n  // Note, for compatibility with closure compilation, this access\n  // needs to be as a string property index.\n  (LitElement as any)['finalize'] = function (this: typeof LitElement) {\n    const finalized = (ReactiveElement as any).finalize.call(this);\n    if (!finalized) {\n      return false;\n    }\n    const warnRemovedOrRenamed = (obj: any, name: string, renamed = false) => {\n      if (obj.hasOwnProperty(name)) {\n        const ctorName = (typeof obj === 'function' ? obj : obj.constructor)\n          .name;\n        issueWarning(\n          renamed ? 'renamed-api' : 'removed-api',\n          `\\`${name}\\` is implemented on class ${ctorName}. It ` +\n            `has been ${renamed ? 'renamed' : 'removed'} ` +\n            `in this version of LitElement.`\n        );\n      }\n    };\n    warnRemovedOrRenamed(this, 'render');\n    warnRemovedOrRenamed(this, 'getStyles', true);\n    warnRemovedOrRenamed((this as typeof LitElement).prototype, 'adoptStyles');\n    return true;\n  };\n  /* eslint-enable @typescript-eslint/no-explicit-any */\n}\n\n/**\n * END USERS SHOULD NOT RELY ON THIS OBJECT.\n *\n * Private exports for use by other Lit packages, not intended for use by\n * external users.\n *\n * We currently do not make a mangled rollup build of the lit-ssr code. In order\n * to keep a number of (otherwise private) top-level exports  mangled in the\n * client side code, we export a _$LE object containing those members (or\n * helper methods for accessing private fields of those members), and then\n * re-export them for use in lit-ssr. This keeps lit-ssr agnostic to whether the\n * client-side code is being used in `dev` mode or `prod` mode.\n *\n * This has a unique name, to disambiguate it from private exports in\n * lit-html, since this module re-exports all of lit-html.\n *\n * @private\n */\nexport const _$LE = {\n  _$attributeToProperty: (\n    el: LitElement,\n    name: string,\n    value: string | null\n  ) => {\n    // eslint-disable-next-line\n    (el as any)._$attributeToProperty(name, value);\n  },\n  // eslint-disable-next-line\n  _$changedProperties: (el: LitElement) => (el as any)._$changedProperties,\n};\n\n// IMPORTANT: do not change the property name or the assignment expression.\n// This line will be used in regexes to search for LitElement usage.\n(globalThis.litElementVersions ??= []).push('3.3.0');\nif (DEV_MODE && globalThis.litElementVersions.length > 1) {\n  issueWarning!(\n    'multiple-versions',\n    `Multiple versions of Lit loaded. Loading multiple versions ` +\n      `is not recommended.`\n  );\n}\n", "/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\n\n/**\n * @fileoverview\n *\n * This file exports a boolean const whose value will depend on what environment\n * the module is being imported from.\n */\n\nconst NODE_MODE = false;\n\n/**\n * A boolean that will be `true` in server environments like Node, and `false`\n * in browser environments. Note that your server environment or toolchain must\n * support the `\"node\"` export condition for this to be `true`.\n *\n * This can be used when authoring components to change behavior based on\n * whether or not the component is executing in an SSR context.\n */\nexport const isServer = NODE_MODE;\n", "import\"@lit/reactive-element\";import\"lit-html\";export*from\"lit-element/lit-element.js\";export*from\"lit-html/is-server.js\";\n//# sourceMappingURL=index.js.map\n", "/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\n\n/*\n * IMPORTANT: For compatibility with tsickle and the Closure JS compiler, all\n * property decorators (but not class decorators) in this file that have\n * an @ExportDecoratedItems annotation must be defined as a regular function,\n * not an arrow function.\n */\nimport {Constructor, ClassDescriptor} from './base.js';\n\n/**\n * Allow for custom element classes with private constructors\n */\ntype CustomElementClass = Omit<typeof HTMLElement, 'new'>;\n\nconst legacyCustomElement = (tagName: string, clazz: CustomElementClass) => {\n  customElements.define(tagName, clazz as CustomElementConstructor);\n  // Cast as any because TS doesn't recognize the return type as being a\n  // subtype of the decorated class when clazz is typed as\n  // `Constructor<HTMLElement>` for some reason.\n  // `Constructor<HTMLElement>` is helpful to make sure the decorator is\n  // applied to elements however.\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  return clazz as any;\n};\n\nconst standardCustomElement = (\n  tagName: string,\n  descriptor: ClassDescriptor\n) => {\n  const {kind, elements} = descriptor;\n  return {\n    kind,\n    elements,\n    // This callback is called once the class is otherwise fully defined\n    finisher(clazz: Constructor<HTMLElement>) {\n      customElements.define(tagName, clazz);\n    },\n  };\n};\n\n/**\n * Class decorator factory that defines the decorated class as a custom element.\n *\n * ```js\n * @customElement('my-element')\n * class MyElement extends LitElement {\n *   render() {\n *     return html``;\n *   }\n * }\n * ```\n * @category Decorator\n * @param tagName The tag name of the custom element to define.\n */\nexport const customElement =\n  (tagName: string) =>\n  (classOrDescriptor: CustomElementClass | ClassDescriptor) =>\n    typeof classOrDescriptor === 'function'\n      ? legacyCustomElement(tagName, classOrDescriptor)\n      : standardCustomElement(tagName, classOrDescriptor as ClassDescriptor);\n", "/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\n\n/*\n * IMPORTANT: For compatibility with tsickle and the Closure JS compiler, all\n * property decorators (but not class decorators) in this file that have\n * an @ExportDecoratedItems annotation must be defined as a regular function,\n * not an arrow function.\n */\nimport {PropertyDeclaration, ReactiveElement} from '../reactive-element.js';\nimport {ClassElement} from './base.js';\n\nconst standardProperty = (\n  options: PropertyDeclaration,\n  element: ClassElement\n) => {\n  // When decorating an accessor, pass it through and add property metadata.\n  // Note, the `hasOwnProperty` check in `createProperty` ensures we don't\n  // stomp over the user's accessor.\n  if (\n    element.kind === 'method' &&\n    element.descriptor &&\n    !('value' in element.descriptor)\n  ) {\n    return {\n      ...element,\n      finisher(clazz: typeof ReactiveElement) {\n        clazz.createProperty(element.key, options);\n      },\n    };\n  } else {\n    // createProperty() takes care of defining the property, but we still\n    // must return some kind of descriptor, so return a descriptor for an\n    // unused prototype field. The finisher calls createProperty().\n    return {\n      kind: 'field',\n      key: Symbol(),\n      placement: 'own',\n      descriptor: {},\n      // store the original key so subsequent decorators have access to it.\n      originalKey: element.key,\n      // When @babel/plugin-proposal-decorators implements initializers,\n      // do this instead of the initializer below. See:\n      // https://github.com/babel/babel/issues/9260 extras: [\n      //   {\n      //     kind: 'initializer',\n      //     placement: 'own',\n      //     initializer: descriptor.initializer,\n      //   }\n      // ],\n      initializer(this: {[key: string]: unknown}) {\n        if (typeof element.initializer === 'function') {\n          this[element.key as string] = element.initializer.call(this);\n        }\n      },\n      finisher(clazz: typeof ReactiveElement) {\n        clazz.createProperty(element.key, options);\n      },\n    };\n  }\n};\n\nconst legacyProperty = (\n  options: PropertyDeclaration,\n  proto: Object,\n  name: PropertyKey\n) => {\n  (proto.constructor as typeof ReactiveElement).createProperty(name, options);\n};\n\n/**\n * A property decorator which creates a reactive property that reflects a\n * corresponding attribute value. When a decorated property is set\n * the element will update and render. A {@linkcode PropertyDeclaration} may\n * optionally be supplied to configure property features.\n *\n * This decorator should only be used for public fields. As public fields,\n * properties should be considered as primarily settable by element users,\n * either via attribute or the property itself.\n *\n * Generally, properties that are changed by the element should be private or\n * protected fields and should use the {@linkcode state} decorator.\n *\n * However, sometimes element code does need to set a public property. This\n * should typically only be done in response to user interaction, and an event\n * should be fired informing the user; for example, a checkbox sets its\n * `checked` property when clicked and fires a `changed` event. Mutating public\n * properties should typically not be done for non-primitive (object or array)\n * properties. In other cases when an element needs to manage state, a private\n * property decorated via the {@linkcode state} decorator should be used. When\n * needed, state properties can be initialized via public properties to\n * facilitate complex interactions.\n *\n * ```ts\n * class MyElement {\n *   @property({ type: Boolean })\n *   clicked = false;\n * }\n * ```\n * @category Decorator\n * @ExportDecoratedItems\n */\nexport function property(options?: PropertyDeclaration) {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  return (protoOrDescriptor: Object | ClassElement, name?: PropertyKey): any =>\n    name !== undefined\n      ? legacyProperty(options!, protoOrDescriptor as Object, name)\n      : standardProperty(options!, protoOrDescriptor as ClassElement);\n}\n", "/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\n\n/*\n * IMPORTANT: For compatibility with tsickle and the Closure JS compiler, all\n * property decorators (but not class decorators) in this file that have\n * an @ExportDecoratedItems annotation must be defined as a regular function,\n * not an arrow function.\n */\n\nimport {property} from './property.js';\n\nexport interface InternalPropertyDeclaration<Type = unknown> {\n  /**\n   * A function that indicates if a property should be considered changed when\n   * it is set. The function should take the `newValue` and `oldValue` and\n   * return `true` if an update should be requested.\n   */\n  hasChanged?(value: Type, oldValue: Type): boolean;\n}\n\n/**\n * Declares a private or protected reactive property that still triggers\n * updates to the element when it changes. It does not reflect from the\n * corresponding attribute.\n *\n * Properties declared this way must not be used from HTML or HTML templating\n * systems, they're solely for properties internal to the element. These\n * properties may be renamed by optimization tools like closure compiler.\n * @category Decorator\n */\nexport function state(options?: InternalPropertyDeclaration) {\n  return property({\n    ...options,\n    state: true,\n  });\n}\n", "/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\n\nimport {ReactiveElement} from '../reactive-element.js';\n\nexport type Constructor<T> = {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  new (...args: any[]): T;\n};\n\n// From the TC39 Decorators proposal\nexport interface ClassDescriptor {\n  kind: 'class';\n  elements: ClassElement[];\n  finisher?: <T>(clazz: Constructor<T>) => void | Constructor<T>;\n}\n\n// From the TC39 Decorators proposal\nexport interface ClassElement {\n  kind: 'field' | 'method';\n  key: PropertyKey;\n  placement: 'static' | 'prototype' | 'own';\n  initializer?: Function;\n  extras?: ClassElement[];\n  finisher?: <T>(clazz: Constructor<T>) => void | Constructor<T>;\n  descriptor?: PropertyDescriptor;\n}\n\nexport const legacyPrototypeMethod = (\n  descriptor: PropertyDescriptor,\n  proto: Object,\n  name: PropertyKey\n) => {\n  Object.defineProperty(proto, name, descriptor);\n};\n\nexport const standardPrototypeMethod = (\n  descriptor: PropertyDescriptor,\n  element: ClassElement\n) => ({\n  kind: 'method',\n  placement: 'prototype',\n  key: element.key,\n  descriptor,\n});\n\n/**\n * Helper for decorating a property that is compatible with both TypeScript\n * and Babel decorators. The optional `finisher` can be used to perform work on\n * the class. The optional `descriptor` should return a PropertyDescriptor\n * to install for the given property.\n *\n * @param finisher {function} Optional finisher method; receives the element\n * constructor and property key as arguments and has no return value.\n * @param descriptor {function} Optional descriptor method; receives the\n * property key as an argument and returns a property descriptor to define for\n * the given property.\n * @returns {ClassElement|void}\n */\nexport const decorateProperty =\n  ({\n    finisher,\n    descriptor,\n  }: {\n    finisher?:\n      | ((ctor: typeof ReactiveElement, property: PropertyKey) => void)\n      | null;\n    descriptor?: (property: PropertyKey) => PropertyDescriptor;\n  }) =>\n  (\n    protoOrDescriptor: ReactiveElement | ClassElement,\n    name?: PropertyKey\n    // Note TypeScript requires the return type to be `void|any`\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  ): void | any => {\n    // TypeScript / Babel legacy mode\n    if (name !== undefined) {\n      const ctor = (protoOrDescriptor as ReactiveElement)\n        .constructor as typeof ReactiveElement;\n      if (descriptor !== undefined) {\n        Object.defineProperty(protoOrDescriptor, name, descriptor(name));\n      }\n      finisher?.(ctor, name!);\n      // Babel standard mode\n    } else {\n      // Note, the @property decorator saves `key` as `originalKey`\n      // so try to use it here.\n      const key =\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        (protoOrDescriptor as any).originalKey ??\n        (protoOrDescriptor as ClassElement).key;\n      const info: ClassElement =\n        descriptor != undefined\n          ? {\n              kind: 'method',\n              placement: 'prototype',\n              key,\n              descriptor: descriptor((protoOrDescriptor as ClassElement).key),\n            }\n          : {...(protoOrDescriptor as ClassElement), key};\n      if (finisher != undefined) {\n        info.finisher = function <ReactiveElement>(\n          ctor: Constructor<ReactiveElement>\n        ) {\n          finisher(ctor as unknown as typeof ReactiveElement, key);\n        };\n      }\n      return info;\n    }\n  };\n", "/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\n\n/*\n * IMPORTANT: For compatibility with tsickle and the Closure JS compiler, all\n * property decorators (but not class decorators) in this file that have\n * an @ExportDecoratedItems annotation must be defined as a regular function,\n * not an arrow function.\n */\n\nimport {ReactiveElement} from '../reactive-element.js';\nimport {decorateProperty} from './base.js';\n\n/**\n * Adds event listener options to a method used as an event listener in a\n * lit-html template.\n *\n * @param options An object that specifies event listener options as accepted by\n * `EventTarget#addEventListener` and `EventTarget#removeEventListener`.\n *\n * Current browsers support the `capture`, `passive`, and `once` options. See:\n * https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener#Parameters\n *\n * ```ts\n * class MyElement {\n *   clicked = false;\n *\n *   render() {\n *     return html`\n *       <div @click=${this._onClick}>\n *         <button></button>\n *       </div>\n *     `;\n *   }\n *\n *   @eventOptions({capture: true})\n *   _onClick(e) {\n *     this.clicked = true;\n *   }\n * }\n * ```\n * @category Decorator\n */\nexport function eventOptions(options: AddEventListenerOptions) {\n  return decorateProperty({\n    finisher: (ctor: typeof ReactiveElement, name: PropertyKey) => {\n      Object.assign(\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        ctor.prototype[name as keyof ReactiveElement] as any,\n        options\n      );\n    },\n  });\n}\n", "/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\n\n/*\n * IMPORTANT: For compatibility with tsickle and the Closure JS compiler, all\n * property decorators (but not class decorators) in this file that have\n * an @ExportDecoratedItems annotation must be defined as a regular function,\n * not an arrow function.\n */\n\nimport {ReactiveElement} from '../reactive-element.js';\nimport {decorateProperty} from './base.js';\n\n/**\n * A property decorator that converts a class property into a getter that\n * executes a querySelector on the element's renderRoot.\n *\n * @param selector A DOMString containing one or more selectors to match.\n * @param cache An optional boolean which when true performs the DOM query only\n *     once and caches the result.\n *\n * See: https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelector\n *\n * ```ts\n * class MyElement {\n *   @query('#first')\n *   first: HTMLDivElement;\n *\n *   render() {\n *     return html`\n *       <div id=\"first\"></div>\n *       <div id=\"second\"></div>\n *     `;\n *   }\n * }\n * ```\n * @category Decorator\n */\nexport function query(selector: string, cache?: boolean) {\n  return decorateProperty({\n    descriptor: (name: PropertyKey) => {\n      const descriptor = {\n        get(this: ReactiveElement) {\n          return this.renderRoot?.querySelector(selector) ?? null;\n        },\n        enumerable: true,\n        configurable: true,\n      };\n      if (cache) {\n        const key = typeof name === 'symbol' ? Symbol() : `__${name}`;\n        descriptor.get = function (this: ReactiveElement) {\n          if (\n            (this as unknown as {[key: string]: Element | null})[\n              key as string\n            ] === undefined\n          ) {\n            (this as unknown as {[key: string]: Element | null})[\n              key as string\n            ] = this.renderRoot?.querySelector(selector) ?? null;\n          }\n          return (this as unknown as {[key: string]: Element | null})[\n            key as string\n          ];\n        };\n      }\n      return descriptor;\n    },\n  });\n}\n", "/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\n\n/*\n * IMPORTANT: For compatibility with tsickle and the Closure JS compiler, all\n * property decorators (but not class decorators) in this file that have\n * an @ExportDecoratedItems annotation must be defined as a regular function,\n * not an arrow function.\n */\n\nimport {ReactiveElement} from '../reactive-element.js';\nimport {decorateProperty} from './base.js';\n\n/**\n * A property decorator that converts a class property into a getter\n * that executes a querySelectorAll on the element's renderRoot.\n *\n * @param selector A DOMString containing one or more selectors to match.\n *\n * See:\n * https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelectorAll\n *\n * ```ts\n * class MyElement {\n *   @queryAll('div')\n *   divs: NodeListOf<HTMLDivElement>;\n *\n *   render() {\n *     return html`\n *       <div id=\"first\"></div>\n *       <div id=\"second\"></div>\n *     `;\n *   }\n * }\n * ```\n * @category Decorator\n */\nexport function queryAll(selector: string) {\n  return decorateProperty({\n    descriptor: (_name: PropertyKey) => ({\n      get(this: ReactiveElement) {\n        return this.renderRoot?.querySelectorAll(selector) ?? [];\n      },\n      enumerable: true,\n      configurable: true,\n    }),\n  });\n}\n", "/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\n\n/*\n * IMPORTANT: For compatibility with tsickle and the Closure JS compiler, all\n * property decorators (but not class decorators) in this file that have\n * an @ExportDecoratedItems annotation must be defined as a regular function,\n * not an arrow function.\n */\n\nimport {ReactiveElement} from '../reactive-element.js';\nimport {decorateProperty} from './base.js';\n\n// Note, in the future, we may extend this decorator to support the use case\n// where the queried element may need to do work to become ready to interact\n// with (e.g. load some implementation code). If so, we might elect to\n// add a second argument defining a function that can be run to make the\n// queried element loaded/updated/ready.\n/**\n * A property decorator that converts a class property into a getter that\n * returns a promise that resolves to the result of a querySelector on the\n * element's renderRoot done after the element's `updateComplete` promise\n * resolves. When the queried property may change with element state, this\n * decorator can be used instead of requiring users to await the\n * `updateComplete` before accessing the property.\n *\n * @param selector A DOMString containing one or more selectors to match.\n *\n * See: https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelector\n *\n * ```ts\n * class MyElement {\n *   @queryAsync('#first')\n *   first: Promise<HTMLDivElement>;\n *\n *   render() {\n *     return html`\n *       <div id=\"first\"></div>\n *       <div id=\"second\"></div>\n *     `;\n *   }\n * }\n *\n * // external usage\n * async doSomethingWithFirst() {\n *  (await aMyElement.first).doSomething();\n * }\n * ```\n * @category Decorator\n */\nexport function queryAsync(selector: string) {\n  return decorateProperty({\n    descriptor: (_name: PropertyKey) => ({\n      async get(this: ReactiveElement) {\n        await this.updateComplete;\n        return this.renderRoot?.querySelector(selector);\n      },\n      enumerable: true,\n      configurable: true,\n    }),\n  });\n}\n", "/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\n\n/*\n * IMPORTANT: For compatibility with tsickle and the Closure JS compiler, all\n * property decorators (but not class decorators) in this file that have\n * an @ExportDecoratedItems annotation must be defined as a regular function,\n * not an arrow function.\n */\n\nimport {decorateProperty} from './base.js';\n\nimport type {ReactiveElement} from '../reactive-element.js';\nimport type {QueryAssignedNodesOptions} from './query-assigned-nodes.js';\n\nconst NODE_MODE = false;\nconst global = NODE_MODE ? globalThis : window;\n\n/**\n * A tiny module scoped polyfill for HTMLSlotElement.assignedElements.\n */\nconst slotAssignedElements =\n  global.HTMLSlotElement?.prototype.assignedElements != null\n    ? (slot: HTMLSlotElement, opts?: AssignedNodesOptions) =>\n        slot.assignedElements(opts)\n    : (slot: HTMLSlotElement, opts?: AssignedNodesOptions) =>\n        slot\n          .assignedNodes(opts)\n          .filter(\n            (node): node is Element => node.nodeType === Node.ELEMENT_NODE\n          );\n\n/**\n * Options for the {@linkcode queryAssignedElements} decorator. Extends the\n * options that can be passed into\n * [HTMLSlotElement.assignedElements](https://developer.mozilla.org/en-US/docs/Web/API/HTMLSlotElement/assignedElements).\n */\nexport interface QueryAssignedElementsOptions\n  extends QueryAssignedNodesOptions {\n  /**\n   * CSS selector used to filter the elements returned. For example, a selector\n   * of `\".item\"` will only include elements with the `item` class.\n   */\n  selector?: string;\n}\n\n/**\n * A property decorator that converts a class property into a getter that\n * returns the `assignedElements` of the given `slot`. Provides a declarative\n * way to use\n * [`HTMLSlotElement.assignedElements`](https://developer.mozilla.org/en-US/docs/Web/API/HTMLSlotElement/assignedElements).\n *\n * Can be passed an optional {@linkcode QueryAssignedElementsOptions} object.\n *\n * Example usage:\n * ```ts\n * class MyElement {\n *   @queryAssignedElements({ slot: 'list' })\n *   listItems!: Array<HTMLElement>;\n *   @queryAssignedElements()\n *   unnamedSlotEls!: Array<HTMLElement>;\n *\n *   render() {\n *     return html`\n *       <slot name=\"list\"></slot>\n *       <slot></slot>\n *     `;\n *   }\n * }\n * ```\n *\n * Note, the type of this property should be annotated as `Array<HTMLElement>`.\n *\n * @category Decorator\n */\nexport function queryAssignedElements(options?: QueryAssignedElementsOptions) {\n  const {slot, selector} = options ?? {};\n  return decorateProperty({\n    descriptor: (_name: PropertyKey) => ({\n      get(this: ReactiveElement) {\n        const slotSelector = `slot${slot ? `[name=${slot}]` : ':not([name])'}`;\n        const slotEl =\n          this.renderRoot?.querySelector<HTMLSlotElement>(slotSelector);\n        const elements =\n          slotEl != null ? slotAssignedElements(slotEl, options) : [];\n        if (selector) {\n          return elements.filter((node) => node.matches(selector));\n        }\n        return elements;\n      },\n      enumerable: true,\n      configurable: true,\n    }),\n  });\n}\n", "/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\n\n/*\n * IMPORTANT: For compatibility with tsickle and the Closure JS compiler, all\n * property decorators (but not class decorators) in this file that have\n * an @ExportDecoratedItems annotation must be defined as a regular function,\n * not an arrow function.\n */\n\nimport {decorateProperty} from './base.js';\nimport {queryAssignedElements} from './query-assigned-elements.js';\n\nimport type {ReactiveElement} from '../reactive-element.js';\n\n/**\n * Options for the {@linkcode queryAssignedNodes} decorator. Extends the options\n * that can be passed into [HTMLSlotElement.assignedNodes](https://developer.mozilla.org/en-US/docs/Web/API/HTMLSlotElement/assignedNodes).\n */\nexport interface QueryAssignedNodesOptions extends AssignedNodesOptions {\n  /**\n   * Name of the slot to query. Leave empty for the default slot.\n   */\n  slot?: string;\n}\n\n// TypeScript requires the decorator return type to be `void|any`.\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ntype TSDecoratorReturnType = void | any;\n\n/**\n * A property decorator that converts a class property into a getter that\n * returns the `assignedNodes` of the given `slot`.\n *\n * Can be passed an optional {@linkcode QueryAssignedNodesOptions} object.\n *\n * Example usage:\n * ```ts\n * class MyElement {\n *   @queryAssignedNodes({slot: 'list', flatten: true})\n *   listItems!: Array<Node>;\n *\n *   render() {\n *     return html`\n *       <slot name=\"list\"></slot>\n *     `;\n *   }\n * }\n * ```\n *\n * Note the type of this property should be annotated as `Array<Node>`.\n *\n * @category Decorator\n */\nexport function queryAssignedNodes(\n  options?: QueryAssignedNodesOptions\n): TSDecoratorReturnType;\n\n/**\n * A property decorator that converts a class property into a getter that\n * returns the `assignedNodes` of the given named `slot`.\n *\n * Example usage:\n * ```ts\n * class MyElement {\n *   @queryAssignedNodes('list', true, '.item')\n *   listItems!: Array<HTMLElement>;\n *\n *   render() {\n *     return html`\n *       <slot name=\"list\"></slot>\n *     `;\n *   }\n * }\n * ```\n *\n * Note the type of this property should be annotated as `Array<Node>` if used\n * without a `selector` or `Array<HTMLElement>` if a selector is provided.\n * Use {@linkcode queryAssignedElements @queryAssignedElements} to list only\n * elements, and optionally filter the element list using a CSS selector.\n *\n * @param slotName A string name of the slot.\n * @param flatten A boolean which when true flattens the assigned nodes,\n *     meaning any assigned nodes that are slot elements are replaced with their\n *     assigned nodes.\n * @param selector A CSS selector used to filter the elements returned.\n *\n * @category Decorator\n * @deprecated Prefer passing in a single options object, i.e. `{slot: 'list'}`.\n * If using `selector` please use `@queryAssignedElements`.\n * `@queryAssignedNodes('', false, '.item')` is functionally identical to\n * `@queryAssignedElements({slot: '', flatten: false, selector: '.item'})` or\n * `@queryAssignedElements({selector: '.item'})`.\n */\nexport function queryAssignedNodes(\n  slotName?: string,\n  flatten?: boolean,\n  selector?: string\n): TSDecoratorReturnType;\n\nexport function queryAssignedNodes(\n  slotOrOptions?: string | QueryAssignedNodesOptions,\n  flatten?: boolean,\n  selector?: string\n) {\n  // Normalize the overloaded arguments.\n  let slot = slotOrOptions;\n  let assignedNodesOptions: AssignedNodesOptions;\n  if (typeof slotOrOptions === 'object') {\n    slot = slotOrOptions.slot;\n    assignedNodesOptions = slotOrOptions;\n  } else {\n    assignedNodesOptions = {flatten};\n  }\n\n  // For backwards compatibility, queryAssignedNodes with a selector behaves\n  // exactly like queryAssignedElements with a selector.\n  if (selector) {\n    return queryAssignedElements({\n      slot: slot as string,\n      flatten,\n      selector,\n    });\n  }\n\n  return decorateProperty({\n    descriptor: (_name: PropertyKey) => ({\n      get(this: ReactiveElement) {\n        const slotSelector = `slot${slot ? `[name=${slot}]` : ':not([name])'}`;\n        const slotEl =\n          this.renderRoot?.querySelector<HTMLSlotElement>(slotSelector);\n        return slotEl?.assignedNodes(assignedNodesOptions) ?? [];\n      },\n      enumerable: true,\n      configurable: true,\n    }),\n  });\n}\n", "export*from\"@lit/reactive-element/decorators/custom-element.js\";export*from\"@lit/reactive-element/decorators/property.js\";export*from\"@lit/reactive-element/decorators/state.js\";export*from\"@lit/reactive-element/decorators/event-options.js\";export*from\"@lit/reactive-element/decorators/query.js\";export*from\"@lit/reactive-element/decorators/query-all.js\";export*from\"@lit/reactive-element/decorators/query-async.js\";export*from\"@lit/reactive-element/decorators/query-assigned-elements.js\";export*from\"@lit/reactive-element/decorators/query-assigned-nodes.js\";\n//# sourceMappingURL=decorators.js.map\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { EventDispatcher, EventHandler } from './EventDispatcher';\n\n/**\n * Helper class for Localization\n *\n *\n * @export\n * @class LocalizationHelper\n */\nexport class LocalizationHelper {\n  static _strings: any;\n\n  static _stringsEventDispatcher: EventDispatcher<any> = new EventDispatcher();\n\n  static _directionEventDispatcher: EventDispatcher<any> = new EventDispatcher();\n\n  private static mutationObserver;\n\n  public static get strings() {\n    return this._strings;\n  }\n\n  /**\n   * Set strings to be localized\n   *\n   * @static\n   * @memberof LocalizationHelper\n   */\n  public static set strings(value: any) {\n    this._strings = value;\n    this._stringsEventDispatcher.fire(null);\n  }\n\n  /**\n   * returns body dir attribute to determine rtl or ltr\n   *\n   * @static\n   * @returns {string} dir\n   * @memberof LocalizationHelper\n   */\n  public static getDocumentDirection() {\n    // Re-set the dir to ltr if the dir attribute is already loaded and the first two options\n    // are returning null values.\n    return document.body?.getAttribute('dir') || document.documentElement?.getAttribute('dir') || 'ltr';\n  }\n\n  /**\n   * Fires event when LocalizationHelper changes state\n   *\n   * @static\n   * @param {EventHandler<ProvidersChangedState>} event\n   * @memberof LocalizationHelper\n   */\n  public static onStringsUpdated(event: EventHandler<any>) {\n    this._stringsEventDispatcher.add(event);\n  }\n\n  public static removeOnStringsUpdated(event: EventHandler<any>) {\n    this._stringsEventDispatcher.remove(event);\n  }\n\n  public static onDirectionUpdated(event: EventHandler<any>) {\n    this._directionEventDispatcher.add(event);\n    this.initDirection();\n  }\n\n  public static removeOnDirectionUpdated(event: EventHandler<any>) {\n    this._directionEventDispatcher.remove(event);\n  }\n\n  private static _isDirectionInit = false;\n\n  /**\n   * Checks for direction setup and adds mutationObserver\n   *\n   * @private\n   * @static\n   * @returns\n   * @memberof LocalizationHelper\n   */\n  private static initDirection() {\n    if (this._isDirectionInit) {\n      return;\n    }\n    this._isDirectionInit = true;\n    this.mutationObserver = new MutationObserver(mutations => {\n      mutations.forEach(mutation => {\n        if (mutation.attributeName == 'dir') {\n          this._directionEventDispatcher.fire(null);\n        }\n      });\n    });\n    const options = { attributes: true, attributeFilter: ['dir'] };\n    this.mutationObserver.observe(document.body, options);\n    this.mutationObserver.observe(document.documentElement, options);\n  }\n\n  /**\n   * Provided helper method to determine localized or defaultString for specific string is returned\n   *\n   * @static updateStringsForTag\n   * @param {string} tagName\n   * @param  stringsObj\n   * @returns\n   * @memberof LocalizationHelper\n   */\n  public static updateStringsForTag(tagName: string, stringObj) {\n    tagName = tagName.toLowerCase();\n\n    if (tagName.startsWith('mgt-')) {\n      tagName = tagName.substring(4);\n    }\n\n    if (this._strings && stringObj) {\n      //check for top level strings, applied per component, overridden by specific component def\n      for (let prop of Object.entries(stringObj)) {\n        if (this._strings[prop[0]]) {\n          stringObj[prop[0]] = this._strings[prop[0]];\n        }\n      }\n      //strings defined component specific\n      if (this._strings['_components'] && this._strings['_components'][tagName]) {\n        let strings: any = this._strings['_components'][tagName];\n        for (let key of Object.keys(strings)) {\n          if (stringObj[key]) {\n            stringObj[key] = strings[key];\n          }\n        }\n      }\n    }\n\n    return stringObj;\n  }\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { LitElement, PropertyValues } from 'lit';\nimport { state } from 'lit/decorators.js';\nimport { ProviderState } from '../providers/IProvider';\nimport { Providers } from '../providers/Providers';\nimport { LocalizationHelper } from '../utils/LocalizationHelper';\nimport { PACKAGE_VERSION } from '../utils/version';\n\n/**\n * Defines media query based on component width\n *\n * @export\n * @enum {string}\n */\nexport enum ComponentMediaQuery {\n  /**\n   * devices with width < 768\n   */\n  mobile = '',\n\n  /**\n   * devices with width < 1200\n   */\n  tablet = 'tablet',\n\n  /**\n   * devices with width > 1200\n   */\n  desktop = 'desktop'\n}\n\n/**\n * BaseComponent extends LitElement adding mgt specific features to all components\n *\n * @export  MgtBaseComponent\n * @abstract\n * @class MgtBaseComponent\n * @extends {LitElement}\n */\nexport abstract class MgtBaseComponent extends LitElement {\n  public static get version() {\n    return PACKAGE_VERSION;\n  }\n\n  /**\n   * Gets or sets the direction of the component\n   *\n   * @protected\n   * @memberof MgtBaseComponent\n   */\n  @state() protected direction = 'ltr';\n\n  /**\n   * Gets the ComponentMediaQuery of the component\n   *\n   * @readonly\n   * @type {MgtElement.ComponentMediaQuery}\n   * @memberof MgtBaseComponent\n   */\n  public get mediaQuery(): ComponentMediaQuery {\n    if (this.offsetWidth < 768) {\n      return ComponentMediaQuery.mobile;\n    } else if (this.offsetWidth < 1200) {\n      return ComponentMediaQuery.tablet;\n    } else {\n      return ComponentMediaQuery.desktop;\n    }\n  }\n\n  /**\n   * A flag to check if the component is loading data state.\n   *\n   * @protected\n   * @memberof MgtBaseComponent\n   */\n  protected get isLoadingState(): boolean {\n    return this._isLoadingState;\n  }\n\n  /**\n   * A flag to check if the component has updated once.\n   *\n   * @readonly\n   * @protected\n   * @type {boolean}\n   * @memberof MgtBaseComponent\n   */\n  protected get isFirstUpdated(): boolean {\n    return this._isFirstUpdated;\n  }\n\n  /**\n   * returns component strings\n   *\n   * @readonly\n   * @protected\n   * @memberof MgtBaseComponent\n   */\n  protected get strings(): { [x: string]: string } {\n    return {};\n  }\n\n  /**\n   * determines if login component is in loading state\n   * @type {boolean}\n   */\n  private _isLoadingState: boolean = false;\n\n  private _isFirstUpdated = false;\n  private _currentLoadStatePromise: Promise<unknown>;\n\n  constructor() {\n    super();\n    this.handleLocalizationChanged = this.handleLocalizationChanged.bind(this);\n    this.handleDirectionChanged = this.handleDirectionChanged.bind(this);\n    this.handleProviderUpdates = this.handleProviderUpdates.bind(this);\n    this.handleActiveAccountUpdates = this.handleActiveAccountUpdates.bind(this);\n    this.handleDirectionChanged();\n    this.handleLocalizationChanged();\n  }\n\n  /**\n   * Invoked each time the custom element is appended into a document-connected element\n   *\n   * @memberof MgtBaseComponent\n   */\n  public connectedCallback() {\n    super.connectedCallback();\n    LocalizationHelper.onStringsUpdated(this.handleLocalizationChanged);\n    LocalizationHelper.onDirectionUpdated(this.handleDirectionChanged);\n  }\n\n  /**\n   * Invoked each time the custom element is removed from a document-connected element\n   *\n   * @memberof MgtBaseComponent\n   */\n  public disconnectedCallback() {\n    super.disconnectedCallback();\n    LocalizationHelper.removeOnStringsUpdated(this.handleLocalizationChanged);\n    LocalizationHelper.removeOnDirectionUpdated(this.handleDirectionChanged);\n    Providers.removeProviderUpdatedListener(this.handleProviderUpdates);\n    Providers.removeActiveAccountChangedListener(this.handleActiveAccountUpdates);\n  }\n\n  /**\n   * Invoked when the element is first updated. Implement to perform one time\n   * work on the element after update.\n   *\n   * Setting properties inside this method will trigger the element to update\n   * again after this update cycle completes.\n   *\n   * @param _changedProperties Map of changed properties with old values\n   */\n  protected firstUpdated(changedProperties): void {\n    super.firstUpdated(changedProperties);\n    this._isFirstUpdated = true;\n    Providers.onProviderUpdated(this.handleProviderUpdates);\n    Providers.onActiveAccountChanged(this.handleActiveAccountUpdates);\n    this.requestStateUpdate();\n  }\n\n  /**\n   * load state into the component.\n   * Override this function to provide additional loading logic.\n   */\n  protected loadState(): Promise<void> {\n    return Promise.resolve();\n  }\n\n  protected clearState(): void {}\n\n  /**\n   * helps facilitate creation of events across components\n   *\n   * @protected\n   * @param {string} eventName\n   * @param {*} [detail]\n   * @param {boolean} [bubbles=false]\n   * @param {boolean} [cancelable=false]\n   * @return {*}  {boolean}\n   * @memberof MgtBaseComponent\n   */\n  protected fireCustomEvent(\n    eventName: string,\n    detail?: any,\n    bubbles: boolean = false,\n    cancelable: boolean = false\n  ): boolean {\n    const event = new CustomEvent(eventName, {\n      bubbles,\n      cancelable,\n      detail\n    });\n    return this.dispatchEvent(event);\n  }\n\n  /**\n   * Invoked whenever the element is updated. Implement to perform\n   * post-updating tasks via DOM APIs, for example, focusing an element.\n   *\n   * Setting properties inside this method will trigger the element to update\n   * again after this update cycle completes.\n   *\n   * * @param changedProperties Map of changed properties with old values\n   */\n  protected updated(changedProperties: PropertyValues) {\n    super.updated(changedProperties);\n    const event = new CustomEvent('updated', {\n      bubbles: true,\n      cancelable: true\n    });\n    this.dispatchEvent(event);\n  }\n\n  /**\n   * Request to reload the state.\n   * Use reload instead of load to ensure loading events are fired.\n   *\n   * @protected\n   * @memberof MgtBaseComponent\n   */\n  protected async requestStateUpdate(force: boolean = false): Promise<unknown> {\n    // the component is still bootstraping - wait until first updated\n    if (!this._isFirstUpdated) {\n      return;\n    }\n\n    // Wait for the current load promise to complete (unless forced).\n    if (this.isLoadingState && !force) {\n      await this._currentLoadStatePromise;\n    }\n\n    const provider = Providers.globalProvider;\n\n    if (!provider) {\n      return Promise.resolve();\n    }\n\n    if (provider.state === ProviderState.SignedOut) {\n      // Signed out, clear the component state\n      this.clearState();\n      return;\n    } else if (provider.state === ProviderState.Loading) {\n      // The provider state is indeterminate. Do nothing.\n      return Promise.resolve();\n    } else {\n      // Signed in, load the internal component state\n      const loadStatePromise = new Promise<void>(async (resolve, reject) => {\n        try {\n          this.setLoadingState(true);\n          this.fireCustomEvent('loadingInitiated');\n\n          await this.loadState();\n\n          this.setLoadingState(false);\n          this.fireCustomEvent('loadingCompleted');\n          resolve();\n        } catch (e) {\n          // Loading failed. Clear any partially set data.\n          this.clearState();\n\n          this.setLoadingState(false);\n          this.fireCustomEvent('loadingFailed');\n          reject(e);\n        }\n\n        // Return the load state promise.\n        // If loading + forced, chain the promises.\n        // This is to account for the lack of a cancellation token concept.\n        return (this._currentLoadStatePromise =\n          this.isLoadingState && !!this._currentLoadStatePromise && force\n            ? this._currentLoadStatePromise.then(() => loadStatePromise)\n            : loadStatePromise);\n      });\n    }\n  }\n\n  private setLoadingState(value: boolean) {\n    if (this._isLoadingState === value) {\n      return;\n    }\n\n    this._isLoadingState = value;\n    this.requestUpdate('isLoadingState');\n  }\n\n  private handleProviderUpdates() {\n    this.requestStateUpdate();\n  }\n\n  private async handleActiveAccountUpdates() {\n    this.clearState();\n    this.requestStateUpdate();\n  }\n\n  private handleLocalizationChanged() {\n    LocalizationHelper.updateStringsForTag(this.tagName, this.strings);\n    this.requestUpdate();\n  }\n\n  private handleDirectionChanged() {\n    this.direction = LocalizationHelper.getDocumentDirection();\n  }\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { property } from 'lit/decorators.js';\nimport { MgtBaseComponent } from './baseComponent';\nimport { IProvider } from '../providers/IProvider';\nimport { GraphEndpoint } from '../IGraph';\n\n/**\n * Abstract implementation for provider component\n *\n * @export\n * @abstract\n * @class MgtBaseProvider\n * @extends {MgtBaseComponent}\n */\nexport abstract class MgtBaseProvider extends MgtBaseComponent {\n  /**\n   * The IProvider created by this component\n   *\n   * @memberof MgtBaseProvider\n   */\n  public get provider(): IProvider {\n    return this._provider;\n  }\n\n  public set provider(value: IProvider) {\n    if (this._provider) {\n      this.provider.removeStateChangedHandler(() => this.stateChangedHandler);\n    }\n    this._provider = value;\n    if (this._provider) {\n      this.provider.onStateChanged(() => this.stateChangedHandler);\n    }\n  }\n\n  /**\n   * Gets weather this provider can be used in this environment\n   *\n   * @readonly\n   * @type {boolean}\n   * @memberof MgtBaseProvider\n   */\n  public get isAvailable(): boolean {\n    return true;\n  }\n\n  /**\n   * Higher priority provider that should be initialized before attempting\n   * to initialize this provider. This provider will only be initialized\n   * if all higher priority providers are not available.\n   *\n   * @type {MgtBaseProvider}\n   * @memberof MgtBaseProvider\n   */\n  @property({\n    attribute: 'depends-on',\n    converter: newValue => {\n      return document.querySelector(newValue);\n    },\n    type: String\n  })\n  public dependsOn: MgtBaseProvider;\n\n  /**\n   * The base URL that should be used in the graph client config.\n   *\n   * @memberof MgtBaseProvider\n   */\n  @property({\n    attribute: 'base-url',\n    type: String\n  })\n  public baseUrl: GraphEndpoint;\n\n  private _provider: IProvider;\n\n  /**\n   * Invoked when the element is first updated. Implement to perform one time\n   * work on the element after update.\n   *\n   * Setting properties inside this method will trigger the element to update\n   * again after this update cycle completes.\n   *\n   * * @param _changedProperties Map of changed properties with old values\n   */\n  protected firstUpdated(changedProperties) {\n    super.firstUpdated(changedProperties);\n\n    let higherPriority = false;\n    if (this.dependsOn) {\n      let higherPriorityProvider = this.dependsOn;\n      while (higherPriorityProvider) {\n        if (higherPriorityProvider.isAvailable) {\n          higherPriority = true;\n          break;\n        }\n        higherPriorityProvider = higherPriorityProvider.dependsOn;\n      }\n    }\n\n    if (!higherPriority && this.isAvailable) {\n      this.initializeProvider();\n    }\n  }\n\n  /**\n   * method called to initialize the provider. Each derived class should provide\n   * their own implementation\n   *\n   * @protected\n   * @memberof MgtBaseProvider\n   */\n  // tslint:disable-next-line: no-empty\n  protected initializeProvider() {}\n\n  private stateChangedHandler() {\n    this.fireCustomEvent('onStateChanged', this.provider.state);\n  }\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * Crude implementation of equivalence between the two specified arguments.\n *\n * The primary intent of this function is for comparing data contexts, which\n * are expected to be object literals with potentially nested structures and\n * where leaf values are primitives.\n */\nexport function equals(o1: any, o2: any) {\n  return equalsInternal(o1, o2, new Set());\n}\n\n/**\n * Not exposed as it would undesirably leak implementation detail (`refs` argument).\n *\n * The `refs` argument is used to avoid infinite recursion due to circular references.\n *\n * @see equals\n */\nfunction equalsInternal(o1: any, o2: any, refs: Set<object>) {\n  const o1Label = Object.prototype.toString.call(o1);\n  const o2Label = Object.prototype.toString.call(o2);\n  if (o1Label === o2Label && o1Label === '[object Object]' && !refs.has(o1)) {\n    refs.add(o1);\n    for (const k in o1) {\n      if (!equalsInternal(o1[k], o2[k], refs)) {\n        return false;\n      }\n    }\n    for (const k in o2) {\n      if (!o1.hasOwnProperty(k)) {\n        return false;\n      }\n    }\n    return true;\n  }\n  if (o1Label === o2Label && o1Label === '[object Array]' && !refs.has(o1)) {\n    refs.add(o1);\n    if (o1.length !== o2.length) {\n      return false;\n    }\n    for (let i = 0; i < o1.length; i++) {\n      if (!equalsInternal(o1[i], o2[i], refs)) {\n        return false;\n      }\n    }\n    return true;\n  }\n  // Everything else requires strict equality (e.g. primitives, functions, dates)\n  return o1 === o2;\n}\n\n/**\n * Compares two arrays if the elements are equals\n * Should be used for arrays of primitive types\n *\n * @export\n * @template T the type of the elements in the array (should be primitive)\n * @param {T[]} arr1\n * @param {T[]} arr2\n * @returns true if both arrays contain the same items or if both arrays are null or empty\n */\nexport function arraysAreEqual<T>(arr1: T[], arr2: T[]) {\n  if (arr1 === arr2) {\n    return true;\n  }\n\n  if (!arr1 || !arr2) {\n    return false;\n  }\n\n  if (arr1.length !== arr2.length) {\n    return false;\n  }\n\n  if (arr1.length === 0) {\n    return true;\n  }\n\n  const setArr1 = new Set(arr1);\n\n  for (const i of arr2) {\n    if (!setArr1.has(i)) {\n      return false;\n    }\n  }\n\n  return true;\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * Helper class for Template Instantiation\n *\n * @export\n * @class TemplateHelper\n */\nexport class TemplateHelper {\n  /**\n   * Render a template into a HTMLElement with the appropriate data context\n   *\n   * Ex:\n   * ```\n   * <template>\n   *  <div>{{myObj.someStr}}</div>\n   *  <div data-for=\"key in myObj.list\">\n   *    <div>{{key.anotherStr}}</div>\n   *  </div>\n   * </template>\n   * ```\n   *\n   * @param root the root element to parent the rendered content\n   * @param template the template to render\n   * @param context the data context to be applied\n   */\n  public static renderTemplate(root: HTMLElement, template: HTMLTemplateElement, context: object) {\n    // inherit context from parent template\n    if ((template as any).$parentTemplateContext) {\n      context = { ...context, $parent: (template as any).$parentTemplateContext };\n    }\n\n    let rendered: Node;\n\n    if (template.content && template.content.childNodes.length) {\n      const templateContent = template.content.cloneNode(true);\n      rendered = this.renderNode(templateContent, root, context);\n    } else if (template.childNodes.length) {\n      const div = document.createElement('div');\n      // tslint:disable-next-line: prefer-for-of\n      for (let i = 0; i < template.childNodes.length; i++) {\n        div.appendChild(this.simpleCloneNode(template.childNodes[i]));\n      }\n      rendered = this.renderNode(div, root, context);\n    }\n\n    if (rendered) {\n      root.appendChild(rendered);\n    }\n  }\n\n  /**\n   * Set an alternative binding syntax. Default is {{ <value> }}\n   *\n   * @static\n   * @param {string} startStr start of binding syntax\n   * @param {string} endStr end of binding syntax\n   * @memberof TemplateHelper\n   */\n  public static setBindingSyntax(startStr: string, endStr: string) {\n    this._startExpression = startStr;\n    this._endExpression = endStr;\n\n    const start = this.escapeRegex(this._startExpression);\n    const end = this.escapeRegex(this._endExpression);\n\n    this._expression = new RegExp(`${start}\\\\s*([$\\\\w\\\\.,'\"\\\\s()\\\\[\\\\]]+)\\\\s*${end}`, 'g');\n  }\n\n  /**\n   * Global context containing data or functions available to\n   * all templates for binding\n   *\n   * @readonly\n   * @static\n   * @memberof TemplateHelper\n   */\n  public static get globalContext() {\n    return this._globalContext;\n  }\n\n  private static _globalContext = {};\n\n  private static get expression() {\n    if (!this._expression) {\n      this.setBindingSyntax('{{', '}}');\n    }\n\n    return this._expression;\n  }\n\n  private static _startExpression: string;\n  private static _endExpression: string;\n  private static _expression: RegExp;\n\n  private static escapeRegex(string) {\n    return string.replace(/[-\\/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\n  }\n\n  // simple implementation of deep cloneNode\n  // required for nested templates in polyfilled browsers\n  private static simpleCloneNode(node: ChildNode) {\n    if (!node) {\n      return null;\n    }\n\n    const clone = node.cloneNode(false);\n\n    // tslint:disable-next-line:prefer-for-of\n    for (let i = 0; i < node.childNodes.length; i++) {\n      const childClone = this.simpleCloneNode(node.childNodes[i]);\n      if (childClone) {\n        clone.appendChild(childClone);\n      }\n    }\n\n    return clone;\n  }\n\n  private static expandExpressionsAsString(str: string, context: object) {\n    return str.replace(this.expression, (match, p1) => {\n      const value = this.evalInContext(p1 || this.trimExpression(match), context);\n      if (value) {\n        if (typeof value === 'object') {\n          return JSON.stringify(value);\n        } else {\n          return (value as any).toString();\n        }\n      }\n      return '';\n    });\n  }\n\n  private static renderNode(node: Node, root: HTMLElement, context: object) {\n    if (node.nodeName === '#text') {\n      node.textContent = this.expandExpressionsAsString(node.textContent, context);\n      return node;\n    } else if (node.nodeName === 'TEMPLATE') {\n      (node as any).$parentTemplateContext = context;\n      return node;\n    }\n\n    // tslint:disable-next-line: prefer-const\n    let nodeElement = node as HTMLElement;\n\n    // replace attribute values\n    if (nodeElement.attributes) {\n      // tslint:disable-next-line: prefer-for-of\n      for (let i = 0; i < nodeElement.attributes.length; i++) {\n        const attribute = nodeElement.attributes[i];\n\n        if (attribute.name === 'data-props') {\n          const propsValue = this.trimExpression(attribute.value);\n          for (const prop of propsValue.split(',')) {\n            const keyValue = prop.trim().split(':');\n            if (keyValue.length === 2) {\n              const key = keyValue[0].trim();\n              const value = this.evalInContext(keyValue[1].trim(), context);\n\n              if (key.startsWith('@')) {\n                // event\n                if (typeof value === 'function') {\n                  nodeElement.addEventListener(key.substring(1), e => value(e, context, root));\n                }\n              } else {\n                nodeElement[key] = value;\n              }\n            }\n          }\n        } else {\n          nodeElement.setAttribute(attribute.name, this.expandExpressionsAsString(attribute.value, context));\n        }\n      }\n    }\n\n    // don't process nodes that will loop yet, but\n    // keep a reference of them\n    const loopChildren = [];\n\n    // list of children to remove (ex, when data-if == false)\n    const removeChildren = [];\n    let previousChildWasIfAndTrue = false;\n\n    // tslint:disable-next-line: prefer-for-of\n    for (let i = 0; i < node.childNodes.length; i++) {\n      const childNode = node.childNodes[i];\n      const childElement = childNode as HTMLElement;\n      let previousChildWasIfAndTrueSet = false;\n\n      if (childElement.dataset) {\n        let childWillBeRemoved = false;\n\n        if (childElement.dataset.if) {\n          const expression = childElement.dataset.if;\n          if (!this.evalBoolInContext(this.trimExpression(expression), context)) {\n            removeChildren.push(childElement);\n            childWillBeRemoved = true;\n          } else {\n            childElement.removeAttribute('data-if');\n            previousChildWasIfAndTrue = true;\n            previousChildWasIfAndTrueSet = true;\n          }\n        } else if (typeof childElement.dataset.else !== 'undefined') {\n          if (previousChildWasIfAndTrue) {\n            removeChildren.push(childElement);\n            childWillBeRemoved = true;\n          } else {\n            childElement.removeAttribute('data-else');\n          }\n        }\n\n        if (childElement.dataset.for && !childWillBeRemoved) {\n          loopChildren.push(childElement);\n        } else if (!childWillBeRemoved) {\n          this.renderNode(childNode, root, context);\n        }\n      } else {\n        this.renderNode(childNode, root, context);\n      }\n\n      // clear the flag if the current node wasn't data-if\n      // or if it was data-if but it wasn't true\n      if (!previousChildWasIfAndTrueSet && childNode.nodeName !== '#text') {\n        previousChildWasIfAndTrue = false;\n      }\n    }\n\n    // now handle nodes that need to be removed\n    for (const child of removeChildren) {\n      nodeElement.removeChild(child);\n    }\n\n    // now handle nodes that should loop\n    // tslint:disable-next-line: prefer-for-of\n    for (let i = 0; i < loopChildren.length; i++) {\n      const childElement = loopChildren[i] as HTMLElement;\n\n      const loopExpression = childElement.dataset.for;\n      const loopTokens = this.trimExpression(loopExpression).split(/\\s(in|of)\\s/i);\n\n      if (loopTokens.length === 3) {\n        // don't really care what's in the middle at this point\n        const itemName = loopTokens[0].trim();\n        const listKey = loopTokens[2].trim();\n\n        const list = this.evalInContext(listKey, context);\n        if (Array.isArray(list)) {\n          // first remove the child\n          // we will need to make copy of the child for\n          // each element in the list\n          childElement.removeAttribute('data-for');\n\n          for (let j = 0; j < list.length; j++) {\n            const newContext = {\n              $index: j,\n              ...context\n            };\n            newContext[itemName] = list[j];\n\n            const clone = childElement.cloneNode(true);\n            this.renderNode(clone, root, newContext);\n            nodeElement.insertBefore(clone, childElement);\n          }\n        }\n        nodeElement.removeChild(childElement);\n      }\n    }\n\n    return node;\n  }\n\n  private static evalBoolInContext(expression, context) {\n    context = { ...context, ...this.globalContext };\n    return new Function('with(this) { return !!(' + expression + ')}').call(context);\n  }\n\n  private static evalInContext(expression, context) {\n    context = { ...context, ...this.globalContext };\n    const func = new Function('with(this) { return ' + expression + ';}');\n    let result;\n    try {\n      result = func.call(context);\n      // tslint:disable-next-line: no-empty\n    } catch (e) {}\n    return result;\n  }\n\n  private static trimExpression(expression: string) {\n    expression = expression.trim();\n\n    if (expression.startsWith(this._startExpression) && expression.endsWith(this._endExpression)) {\n      expression = expression.substr(\n        this._startExpression.length,\n        expression.length - this._startExpression.length - this._endExpression.length\n      );\n      expression = expression.trim();\n    }\n\n    return expression;\n  }\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { html, PropertyValues, TemplateResult } from 'lit';\nimport { property } from 'lit/decorators.js';\n\nimport { equals } from '../utils/equals';\nimport { MgtBaseComponent } from './baseComponent';\nimport { TemplateContext } from '../utils/TemplateContext';\nimport { TemplateHelper } from '../utils/TemplateHelper';\n\n/**\n * Lookup for rendered component templates and contexts by slot name.\n */\ninterface RenderedTemplates {\n  [name: string]: {\n    /**\n     * Reference to the data context used to render the slot.\n     */\n    context: any;\n    /**\n     * Reference to the rendered DOM element corresponding to the slot.\n     */\n    slot: HTMLElement;\n  };\n}\n\n// tslint:disable: completed-docs\nexport interface TemplateRenderedData {\n  templateType: string;\n  context: Record<string, unknown>;\n  element: HTMLElement;\n}\n// tslint:enable: completed-docs\n\n/**\n * An abstract class that defines a templatable web component\n *\n * @export\n * @abstract\n * @class MgtTemplatedComponent\n * @extends {MgtBaseComponent}\n *\n * @fires {CustomEvent<MgtElement.TemplateRenderedData>} templateRendered - fires when a template is rendered\n */\nexport abstract class MgtTemplatedComponent extends MgtBaseComponent {\n  /**\n   * Additional data context to be used in template binding\n   * Use this to add event listeners or value converters\n   *\n   * @type {MgtElement.TemplateContext}\n   * @memberof MgtTemplatedComponent\n   */\n  @property({ attribute: false }) public templateContext: TemplateContext;\n\n  /**\n   * Holds all templates defined by developer\n   *\n   * @protected\n   * @memberof MgtTemplatedComponent\n   */\n  protected templates = {};\n\n  private _renderedSlots = false;\n  private _renderedTemplates: RenderedTemplates = {};\n  private _slotNamesAddedDuringRender = [];\n\n  constructor() {\n    super();\n\n    this.templateContext = this.templateContext || {};\n  }\n\n  /**\n   * Updates the element. This method reflects property values to attributes.\n   * It can be overridden to render and keep updated element DOM.\n   * Setting properties inside this method will *not* trigger\n   * another update.\n   *\n   * * @param _changedProperties Map of changed properties with old values\n   */\n  protected update(changedProperties) {\n    this.templates = this.getTemplates();\n    this._slotNamesAddedDuringRender = [];\n    super.update(changedProperties);\n  }\n\n  /**\n   * Invoked whenever the element is updated. Implement to perform\n   * post-updating tasks via DOM APIs, for example, focusing an element.\n   *\n   * Setting properties inside this method will trigger the element to update\n   * again after this update cycle completes.\n   *\n   * * @param changedProperties Map of changed properties with old values\n   */\n  protected updated(changedProperties: PropertyValues) {\n    super.updated(changedProperties);\n    this.removeUnusedSlottedElements();\n  }\n\n  /**\n   * Render a <template> by type and return content to render\n   *\n   * @param templateType type of template (indicated by the data-type attribute)\n   * @param context the data context that should be expanded in template\n   * @param slotName the slot name that will be used to host the new rendered template. set to a unique value if multiple templates of this type will be rendered. default is templateType\n   */\n  protected renderTemplate(templateType: string, context: object, slotName?: string): TemplateResult {\n    if (!this.hasTemplate(templateType)) {\n      return null;\n    }\n\n    slotName = slotName || templateType;\n    this._slotNamesAddedDuringRender.push(slotName);\n    this._renderedSlots = true;\n\n    const template = html`\n      <slot name=${slotName}></slot>\n    `;\n\n    const dataContext = { ...context, ...this.templateContext };\n\n    if (this._renderedTemplates.hasOwnProperty(slotName)) {\n      const { context: existingContext, slot } = this._renderedTemplates[slotName];\n      if (equals(existingContext, dataContext)) {\n        return template;\n      }\n      this.removeChild(slot);\n    }\n\n    const div = document.createElement('div');\n    div.slot = slotName;\n    div.dataset.generated = 'template';\n\n    TemplateHelper.renderTemplate(div, this.templates[templateType], dataContext);\n\n    this.appendChild(div);\n\n    this._renderedTemplates[slotName] = { context: dataContext, slot: div };\n\n    const templateRenderedData: TemplateRenderedData = { templateType, context: dataContext, element: div };\n    this.fireCustomEvent('templateRendered', templateRenderedData);\n\n    return template;\n  }\n\n  /**\n   * Check if a specific template has been provided.\n   *\n   * @protected\n   * @param {string} templateName\n   * @returns {boolean}\n   * @memberof MgtTemplatedComponent\n   */\n  protected hasTemplate(templateName: string): boolean {\n    return this.templates && this.templates[templateName];\n  }\n\n  private getTemplates() {\n    const templates: any = {};\n\n    // tslint:disable-next-line: prefer-for-of\n    for (let i = 0; i < this.children.length; i++) {\n      const child = this.children[i];\n      if (child.nodeName === 'TEMPLATE') {\n        const template = child as HTMLElement;\n        if (template.dataset.type) {\n          templates[template.dataset.type] = template;\n        } else {\n          templates.default = template;\n        }\n\n        (template as any).templateOrder = i;\n      }\n    }\n\n    return templates;\n  }\n\n  private removeUnusedSlottedElements() {\n    if (this._renderedSlots) {\n      for (let i = 0; i < this.children.length; i++) {\n        const child = this.children[i] as HTMLElement;\n        if (child.dataset && child.dataset.generated && !this._slotNamesAddedDuringRender.includes(child.slot)) {\n          this.removeChild(child);\n          delete this._renderedTemplates[child.slot];\n          i--;\n        }\n      }\n      this._renderedSlots = false;\n    }\n  }\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { AuthenticationProviderOptions } from '@microsoft/microsoft-graph-client';\nimport { createFromProvider } from '../Graph';\nimport { IProvider } from './IProvider';\n\n/**\n * Facilitates create of new custom provider\n *\n * @export\n * @class SimpleProvider\n * @extends {IProvider}\n */\nexport class SimpleProvider extends IProvider {\n  private _getAccessTokenHandler: (scopes: string[]) => Promise<string>;\n  private _loginHandler: () => Promise<void>;\n  private _logoutHandler: () => Promise<void>;\n\n  /**\n   * Name used for analytics\n   *\n   * @readonly\n   * @memberof IProvider\n   */\n  public get name() {\n    return 'MgtSimpleProvider';\n  }\n\n  constructor(\n    getAccessTokenHandler: (scopes: string[]) => Promise<string>,\n    loginHandler?: () => Promise<void>,\n    logoutHandler?: () => Promise<void>\n  ) {\n    super();\n\n    this._getAccessTokenHandler = getAccessTokenHandler;\n    this._loginHandler = loginHandler;\n    this._logoutHandler = logoutHandler;\n\n    this.graph = createFromProvider(this);\n  }\n\n  /**\n   * Invokes the getAccessToken function\n   *\n   * @param {AuthenticationProviderOptions} [options]\n   * @returns {Promise<string>}\n   * @memberof SimpleProvider\n   */\n  public getAccessToken(options?: AuthenticationProviderOptions): Promise<string> {\n    return this._getAccessTokenHandler(options?.scopes);\n  }\n\n  /**\n   * Invokes login function\n   *\n   * @returns {Promise<void>}\n   * @memberof SimpleProvider\n   */\n  public login(): Promise<void> {\n    return this._loginHandler();\n  }\n\n  /**\n   * Invokes logout function\n   *\n   * @returns {Promise<void>}\n   * @memberof SimpleProvider\n   */\n  public logout(): Promise<void> {\n    return this._logoutHandler();\n  }\n}\n", "const instanceOfAny = (object, constructors) => constructors.some((c) => object instanceof c);\n\nlet idbProxyableTypes;\nlet cursorAdvanceMethods;\n// This is a function to prevent it throwing up in node environments.\nfunction getIdbProxyableTypes() {\n    return (idbProxyableTypes ||\n        (idbProxyableTypes = [\n            IDBDatabase,\n            IDBObjectStore,\n            IDBIndex,\n            IDBCursor,\n            IDBTransaction,\n        ]));\n}\n// This is a function to prevent it throwing up in node environments.\nfunction getCursorAdvanceMethods() {\n    return (cursorAdvanceMethods ||\n        (cursorAdvanceMethods = [\n            IDBCursor.prototype.advance,\n            IDBCursor.prototype.continue,\n            IDBCursor.prototype.continuePrimaryKey,\n        ]));\n}\nconst cursorRequestMap = new WeakMap();\nconst transactionDoneMap = new WeakMap();\nconst transactionStoreNamesMap = new WeakMap();\nconst transformCache = new WeakMap();\nconst reverseTransformCache = new WeakMap();\nfunction promisifyRequest(request) {\n    const promise = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            request.removeEventListener('success', success);\n            request.removeEventListener('error', error);\n        };\n        const success = () => {\n            resolve(wrap(request.result));\n            unlisten();\n        };\n        const error = () => {\n            reject(request.error);\n            unlisten();\n        };\n        request.addEventListener('success', success);\n        request.addEventListener('error', error);\n    });\n    promise\n        .then((value) => {\n        // Since cursoring reuses the IDBRequest (*sigh*), we cache it for later retrieval\n        // (see wrapFunction).\n        if (value instanceof IDBCursor) {\n            cursorRequestMap.set(value, request);\n        }\n        // Catching to avoid \"Uncaught Promise exceptions\"\n    })\n        .catch(() => { });\n    // This mapping exists in reverseTransformCache but doesn't doesn't exist in transformCache. This\n    // is because we create many promises from a single IDBRequest.\n    reverseTransformCache.set(promise, request);\n    return promise;\n}\nfunction cacheDonePromiseForTransaction(tx) {\n    // Early bail if we've already created a done promise for this transaction.\n    if (transactionDoneMap.has(tx))\n        return;\n    const done = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            tx.removeEventListener('complete', complete);\n            tx.removeEventListener('error', error);\n            tx.removeEventListener('abort', error);\n        };\n        const complete = () => {\n            resolve();\n            unlisten();\n        };\n        const error = () => {\n            reject(tx.error || new DOMException('AbortError', 'AbortError'));\n            unlisten();\n        };\n        tx.addEventListener('complete', complete);\n        tx.addEventListener('error', error);\n        tx.addEventListener('abort', error);\n    });\n    // Cache it for later retrieval.\n    transactionDoneMap.set(tx, done);\n}\nlet idbProxyTraps = {\n    get(target, prop, receiver) {\n        if (target instanceof IDBTransaction) {\n            // Special handling for transaction.done.\n            if (prop === 'done')\n                return transactionDoneMap.get(target);\n            // Polyfill for objectStoreNames because of Edge.\n            if (prop === 'objectStoreNames') {\n                return target.objectStoreNames || transactionStoreNamesMap.get(target);\n            }\n            // Make tx.store return the only store in the transaction, or undefined if there are many.\n            if (prop === 'store') {\n                return receiver.objectStoreNames[1]\n                    ? undefined\n                    : receiver.objectStore(receiver.objectStoreNames[0]);\n            }\n        }\n        // Else transform whatever we get back.\n        return wrap(target[prop]);\n    },\n    set(target, prop, value) {\n        target[prop] = value;\n        return true;\n    },\n    has(target, prop) {\n        if (target instanceof IDBTransaction &&\n            (prop === 'done' || prop === 'store')) {\n            return true;\n        }\n        return prop in target;\n    },\n};\nfunction replaceTraps(callback) {\n    idbProxyTraps = callback(idbProxyTraps);\n}\nfunction wrapFunction(func) {\n    // Due to expected object equality (which is enforced by the caching in `wrap`), we\n    // only create one new func per func.\n    // Edge doesn't support objectStoreNames (booo), so we polyfill it here.\n    if (func === IDBDatabase.prototype.transaction &&\n        !('objectStoreNames' in IDBTransaction.prototype)) {\n        return function (storeNames, ...args) {\n            const tx = func.call(unwrap(this), storeNames, ...args);\n            transactionStoreNamesMap.set(tx, storeNames.sort ? storeNames.sort() : [storeNames]);\n            return wrap(tx);\n        };\n    }\n    // Cursor methods are special, as the behaviour is a little more different to standard IDB. In\n    // IDB, you advance the cursor and wait for a new 'success' on the IDBRequest that gave you the\n    // cursor. It's kinda like a promise that can resolve with many values. That doesn't make sense\n    // with real promises, so each advance methods returns a new promise for the cursor object, or\n    // undefined if the end of the cursor has been reached.\n    if (getCursorAdvanceMethods().includes(func)) {\n        return function (...args) {\n            // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n            // the original object.\n            func.apply(unwrap(this), args);\n            return wrap(cursorRequestMap.get(this));\n        };\n    }\n    return function (...args) {\n        // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n        // the original object.\n        return wrap(func.apply(unwrap(this), args));\n    };\n}\nfunction transformCachableValue(value) {\n    if (typeof value === 'function')\n        return wrapFunction(value);\n    // This doesn't return, it just creates a 'done' promise for the transaction,\n    // which is later returned for transaction.done (see idbObjectHandler).\n    if (value instanceof IDBTransaction)\n        cacheDonePromiseForTransaction(value);\n    if (instanceOfAny(value, getIdbProxyableTypes()))\n        return new Proxy(value, idbProxyTraps);\n    // Return the same value back if we're not going to transform it.\n    return value;\n}\nfunction wrap(value) {\n    // We sometimes generate multiple promises from a single IDBRequest (eg when cursoring), because\n    // IDB is weird and a single IDBRequest can yield many responses, so these can't be cached.\n    if (value instanceof IDBRequest)\n        return promisifyRequest(value);\n    // If we've already transformed this value before, reuse the transformed value.\n    // This is faster, but it also provides object equality.\n    if (transformCache.has(value))\n        return transformCache.get(value);\n    const newValue = transformCachableValue(value);\n    // Not all types are transformed.\n    // These may be primitive types, so they can't be WeakMap keys.\n    if (newValue !== value) {\n        transformCache.set(value, newValue);\n        reverseTransformCache.set(newValue, value);\n    }\n    return newValue;\n}\nconst unwrap = (value) => reverseTransformCache.get(value);\n\nexport { reverseTransformCache as a, instanceOfAny as i, replaceTraps as r, unwrap as u, wrap as w };\n", "import { w as wrap, r as replaceTraps } from './wrap-idb-value.js';\nexport { u as unwrap, w as wrap } from './wrap-idb-value.js';\n\n/**\n * Open a database.\n *\n * @param name Name of the database.\n * @param version Schema version.\n * @param callbacks Additional callbacks.\n */\nfunction openDB(name, version, { blocked, upgrade, blocking, terminated } = {}) {\n    const request = indexedDB.open(name, version);\n    const openPromise = wrap(request);\n    if (upgrade) {\n        request.addEventListener('upgradeneeded', (event) => {\n            upgrade(wrap(request.result), event.oldVersion, event.newVersion, wrap(request.transaction));\n        });\n    }\n    if (blocked)\n        request.addEventListener('blocked', () => blocked());\n    openPromise\n        .then((db) => {\n        if (terminated)\n            db.addEventListener('close', () => terminated());\n        if (blocking)\n            db.addEventListener('versionchange', () => blocking());\n    })\n        .catch(() => { });\n    return openPromise;\n}\n/**\n * Delete a database.\n *\n * @param name Name of the database.\n */\nfunction deleteDB(name, { blocked } = {}) {\n    const request = indexedDB.deleteDatabase(name);\n    if (blocked)\n        request.addEventListener('blocked', () => blocked());\n    return wrap(request).then(() => undefined);\n}\n\nconst readMethods = ['get', 'getKey', 'getAll', 'getAllKeys', 'count'];\nconst writeMethods = ['put', 'add', 'delete', 'clear'];\nconst cachedMethods = new Map();\nfunction getMethod(target, prop) {\n    if (!(target instanceof IDBDatabase &&\n        !(prop in target) &&\n        typeof prop === 'string')) {\n        return;\n    }\n    if (cachedMethods.get(prop))\n        return cachedMethods.get(prop);\n    const targetFuncName = prop.replace(/FromIndex$/, '');\n    const useIndex = prop !== targetFuncName;\n    const isWrite = writeMethods.includes(targetFuncName);\n    if (\n    // Bail if the target doesn't exist on the target. Eg, getAll isn't in Edge.\n    !(targetFuncName in (useIndex ? IDBIndex : IDBObjectStore).prototype) ||\n        !(isWrite || readMethods.includes(targetFuncName))) {\n        return;\n    }\n    const method = async function (storeName, ...args) {\n        // isWrite ? 'readwrite' : undefined gzipps better, but fails in Edge :(\n        const tx = this.transaction(storeName, isWrite ? 'readwrite' : 'readonly');\n        let target = tx.store;\n        if (useIndex)\n            target = target.index(args.shift());\n        // Must reject if op rejects.\n        // If it's a write operation, must reject if tx.done rejects.\n        // Must reject with op rejection first.\n        // Must resolve with op value.\n        // Must handle both promises (no unhandled rejections)\n        return (await Promise.all([\n            target[targetFuncName](...args),\n            isWrite && tx.done,\n        ]))[0];\n    };\n    cachedMethods.set(prop, method);\n    return method;\n}\nreplaceTraps((oldTraps) => ({\n    ...oldTraps,\n    get: (target, prop, receiver) => getMethod(target, prop) || oldTraps.get(target, prop, receiver),\n    has: (target, prop) => !!getMethod(target, prop) || oldTraps.has(target, prop),\n}));\n\nexport { deleteDB, openDB };\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { openDB } from 'idb';\nimport { Providers } from '../providers/Providers';\nimport { ProviderState } from '../providers/IProvider';\n\n/**\n * Localstorage key for storing names of cache databases\n *\n * @type {string}\n *\n */\nconst dbListKey: string = 'mgt-db-list';\n\n/**\n * Holds the cache options for cache store\n *\n * @export\n * @interface CacheConfig\n */\nexport interface CacheConfig {\n  /**\n   * Default global invalidation period\n   *\n   * @type {number}\n   * @memberof CacheConfig\n   */\n  defaultInvalidationPeriod: number;\n  /**\n   * Controls whether the cache is enabled globally\n   *\n   * @type {boolean}\n   * @memberof CacheConfig\n   */\n  isEnabled: boolean;\n  /**\n   * Cache options for groups store\n   *\n   * @type {CacheOptions}\n   * @memberof CacheConfig\n   */\n  groups: CacheOptions;\n  /**\n   * Cache options for people store\n   *\n   * @type {CacheOptions}\n   * @memberof CacheConfig\n   */\n  people: CacheOptions;\n  /**\n   * Cache options for photos store\n   *\n   * @type {CacheOptions}\n   * @memberof CacheConfig\n   */\n  photos: CacheOptions;\n  /**\n   * Cache options for presence store\n   *\n   * @type {CacheOptions}\n   * @memberof CacheConfig\n   */\n\n  presence: CacheOptions;\n  /**\n   * Cache options for users store\n   *\n   * @type {CacheOptions}\n   * @memberof CacheConfig\n   */\n  users: CacheOptions;\n\n  /**\n   * Cache options for a generic response store\n   *\n   * @type {CacheOptions}\n   * @memberof CacheConfig\n   */\n  response: CacheOptions;\n\n  /**\n   * Cache options for files store\n   *\n   * @type {CacheOptions}\n   * @memberof CacheConfig\n   */\n  files: CacheOptions;\n  /**\n   * Cache options for fileLists store\n   *\n   * @type {CacheOptions}\n   * @memberof CacheConfig\n   */\n  fileLists: CacheOptions;\n}\n\n/**\n * Options for each store\n *\n * @export\n * @interface CacheOptions\n */\nexport interface CacheOptions {\n  /**\n   * Defines the time (in ms) for objects in the store to expire\n   *\n   * @type {number}\n   * @memberof CacheOptions\n   */\n  invalidationPeriod: number;\n  /**\n   * Whether the store is enabled or not\n   *\n   * @type {boolean}\n   * @memberof CacheOptions\n   */\n  isEnabled: boolean;\n}\n\n/**\n * class in charge of managing all the caches and their stores\n *\n * @export\n * @class CacheService\n */\n// tslint:disable-next-line: max-classes-per-file\nexport class CacheService {\n  /**\n   *  Looks for existing cache, otherwise creates a new one\n   *\n   * @static\n   * @template T\n   * @param {CacheSchema} schema\n   * @param {string} storeName\n   * @returns {CacheStore<T>}\n   * @memberof CacheService\n   */\n  public static getCache<T extends CacheItem>(schema: CacheSchema, storeName: string): CacheStore<T> {\n    const key = `${schema.name}/${storeName}`;\n\n    if (!this.isInitialized) {\n      this.init();\n    }\n\n    if (!this.cacheStore.has(storeName)) {\n      this.cacheStore.set(key, new CacheStore<T>(schema, storeName));\n    }\n    return this.cacheStore.get(key) as CacheStore<T>;\n  }\n\n  /**\n   * Clears cache for a single user when ID is passed\n   *\n   * @static\n   * @param {string} id\n   * @memberof CacheService\n   */\n  public static clearCacheById(id: string) {\n    const oldDbArray: Array<string> = JSON.parse(localStorage.getItem(dbListKey));\n    if (oldDbArray) {\n      let newDbArray: Array<string> = [];\n      oldDbArray.forEach(async x => {\n        if (x.includes(id)) {\n          indexedDB.deleteDatabase(x);\n        } else {\n          newDbArray.push(x);\n        }\n      });\n      newDbArray.length > 0\n        ? localStorage.setItem(dbListKey, JSON.stringify(newDbArray))\n        : localStorage.removeItem(dbListKey);\n    }\n  }\n\n  private static cacheStore: Map<string, CacheStore<CacheItem>> = new Map();\n  private static isInitialized: boolean = false;\n\n  private static cacheConfig: CacheConfig = {\n    defaultInvalidationPeriod: 3600000,\n    groups: {\n      invalidationPeriod: null,\n      isEnabled: true\n    },\n    isEnabled: true,\n    people: {\n      invalidationPeriod: null,\n      isEnabled: true\n    },\n    photos: {\n      invalidationPeriod: null,\n      isEnabled: true\n    },\n    presence: {\n      invalidationPeriod: 300000,\n      isEnabled: true\n    },\n    users: {\n      invalidationPeriod: null,\n      isEnabled: true\n    },\n    response: {\n      invalidationPeriod: null,\n      isEnabled: true\n    },\n    files: {\n      invalidationPeriod: null,\n      isEnabled: true\n    },\n    fileLists: {\n      invalidationPeriod: null,\n      isEnabled: true\n    }\n  };\n\n  /**\n   * returns the cacheconfig object\n   *\n   * @readonly\n   * @static\n   * @type {CacheConfig}\n   * @memberof CacheService\n   */\n  public static get config(): CacheConfig {\n    return this.cacheConfig;\n  }\n\n  /**\n   * Checks for current sign in state and see if it has changed from signed-in to signed out\n   *\n   *\n   * @private\n   * @static\n   * @memberof CacheService\n   */\n  private static init() {\n    let previousState: ProviderState;\n    if (Providers.globalProvider) {\n      previousState = Providers.globalProvider.state;\n    }\n\n    Providers.onProviderUpdated(async () => {\n      if (previousState === ProviderState.SignedIn && Providers.globalProvider.state === ProviderState.SignedOut) {\n        const id = await Providers.getCacheId();\n        if (id !== null) {\n          this.clearCacheById(id);\n        }\n      }\n      previousState = Providers.globalProvider.state;\n    });\n    this.isInitialized = true;\n  }\n}\n\n/**\n * Represents organization for a cache\n *\n * @export\n * @interface CacheSchema\n */\nexport interface CacheSchema {\n  /**\n   * version number of cache, useful for upgrading\n   *\n   * @type {number}\n   * @memberof CacheSchema\n   */\n  version: number;\n  /**\n   * name of the cache\n   *\n   * @type {string}\n   * @memberof CacheSchema\n   */\n  name: string;\n  /**\n   * list of stores in the cache\n   *\n   * @type {{ [name: string]: CacheSchemaStore }}\n   * @memberof CacheSchema\n   */\n  stores: { [name: string]: string };\n}\n\n/**\n * item that is stored in cache\n *\n * @export\n * @interface CacheItem\n */\nexport interface CacheItem {\n  /**\n   * date and time that item was retrieved from api/stored in cache\n   *\n   * @type {number}\n   * @memberof CacheItem\n   */\n  timeCached?: number;\n}\n\n/**\n * Represents a store in the cache\n *\n * @class CacheStore\n * @template T\n */\n// tslint:disable-next-line: max-classes-per-file\nexport class CacheStore<T extends CacheItem> {\n  private schema: CacheSchema;\n  private store: string;\n\n  public constructor(schema: CacheSchema, store: string) {\n    if (!(store in schema.stores)) {\n      throw Error('\"store\" must be defined in the \"schema\"');\n    }\n\n    this.schema = schema;\n    this.store = store;\n  }\n\n  /**\n   * gets value from cache for the given key\n   *\n   * @param {string} key\n   * @returns {Promise<T>}\n   * @memberof Cache\n   */\n  public async getValue(key: string): Promise<T> {\n    if (!window.indexedDB) {\n      return null;\n    }\n    try {\n      const db = await this.getDb();\n      return db.get(this.store, key);\n    } catch (e) {\n      return null;\n    }\n  }\n\n  /**\n   * inserts value into cache for the given key\n   *\n   * @param {string} key\n   * @param {T} item\n   * @returns\n   * @memberof Cache\n   */\n  public async putValue(key: string, item: T) {\n    if (!window.indexedDB) {\n      return;\n    }\n    try {\n      await (await this.getDb()).put(this.store, { ...item, timeCached: Date.now() }, key);\n    } catch (e) {\n      return;\n    }\n  }\n\n  /**\n   * Clears the store of all stored values\n   *\n   * @returns\n   * @memberof Cache\n   */\n  public async clearStore() {\n    if (!window.indexedDB) {\n      return;\n    }\n    try {\n      (await this.getDb()).clear(this.store);\n    } catch (e) {\n      return;\n    }\n  }\n\n  /**\n   * Returns the name of the parent DB that the cache store belongs to\n   */\n  public async getDBName() {\n    const id = await Providers.getCacheId();\n    if (id) {\n      return `mgt-${this.schema.name}` + `-${id}`;\n    }\n  }\n\n  private async getDb() {\n    const dbName = await this.getDBName();\n    if (dbName) {\n      return openDB(dbName, this.schema.version, {\n        upgrade: (db, oldVersion, newVersion, transaction) => {\n          let dbArray: Array<string> = JSON.parse(localStorage.getItem(dbListKey)) || [];\n          if (!dbArray.includes(dbName)) {\n            dbArray.push(dbName);\n          }\n          localStorage.setItem(dbListKey, JSON.stringify(dbArray));\n          for (const storeName in this.schema.stores) {\n            if (this.schema.stores.hasOwnProperty(storeName)) {\n              db.objectStoreNames.contains(storeName) || db.createObjectStore(storeName);\n            }\n          }\n        }\n      });\n    }\n  }\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * A helper class for interacting with the Teams Client SDK.\n *\n * @export\n * @class TeamsHelper\n */\nexport class TeamsHelper {\n  /**\n   * Optional entry point to the teams library\n   * If this value is not set, the provider will attempt to use\n   * the microsoftTeams global variable.\n   *\n   * @static\n   * @type {*}\n   * @memberof TeamsHelper\n   */\n  public static get microsoftTeamsLib(): any {\n    // tslint:disable-next-line: no-string-literal\n    return this._microsoftTeamsLib || window['microsoftTeams'];\n  }\n  public static set microsoftTeamsLib(value: any) {\n    this._microsoftTeamsLib = value;\n  }\n\n  /**\n   * Gets whether the Teams provider can be used in the current context\n   * (Whether the app is running in Microsoft Teams)\n   *\n   * @readonly\n   * @static\n   * @memberof TeamsHelper\n   */\n  public static get isAvailable(): boolean {\n    if (!this.microsoftTeamsLib) {\n      return false;\n    }\n    if (window.parent === window.self && (window as any).nativeInterface) {\n      // In Teams mobile client\n      return true;\n    } else if (window.name === 'embedded-page-container' || window.name === 'extension-tab-frame') {\n      // In Teams web/desktop client\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Execute a deeplink against the Teams lib.\n   *\n   * @static\n   * @param {string} deeplink\n   * @param {(status: boolean, reason?: string) => void} [onComplete]\n   * @memberof TeamsHelper\n   */\n  public static executeDeepLink(deeplink: string, onComplete?: (status: boolean, reason?: string) => void): void {\n    const teams = this.microsoftTeamsLib;\n    teams.initialize();\n    teams.executeDeepLink(deeplink, onComplete);\n  }\n\n  private static _microsoftTeamsLib: any;\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * Template context object\n */\nexport interface TemplateContext {\n  [prop: string]: any;\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { GraphRequest } from '@microsoft/microsoft-graph-client';\nimport { IGraph } from '../IGraph';\n\n/**\n * A helper class to assist in getting multiple pages from a resource\n *\n * @export\n * @class GraphPageIterator\n * @template T\n */\nexport class GraphPageIterator<T> {\n  /**\n   * Gets all the items already fetched for this request\n   *\n   * @readonly\n   * @type {T[]}\n   * @memberof GraphPageIterator\n   */\n  public get value(): T[] {\n    return this._value;\n  }\n\n  /**\n   * Gets wheather this request has more pages\n   *\n   * @readonly\n   * @type {boolean}\n   * @memberof GraphPageIterator\n   */\n  public get hasNext(): boolean {\n    return !!this._nextLink;\n  }\n\n  /**\n   * Creates a new GraphPageIterator\n   *\n   * @static\n   * @template T - the type of entities expected from this request\n   * @param {IGraph} graph - the graph instance to use for making requests\n   * @param {GraphRequest} request - the initial request\n   * @param {string} [version] - optional version to use for the requests - by default uses the default version\n   * from the graph parameter\n   * @returns a GraphPageIterator\n   * @memberof GraphPageIterator\n   */\n  public static async create<T>(graph: IGraph, request: GraphRequest, version?: string) {\n    const response = await request.get();\n    if (response && response.value) {\n      const iterator = new GraphPageIterator<T>();\n      iterator._graph = graph;\n      iterator._value = response.value;\n      iterator._nextLink = response['@odata.nextLink'];\n      iterator._version = version || graph.version;\n      return iterator;\n    }\n\n    return null;\n  }\n\n  /**\n   * Creates a new GraphPageIterator from existing value\n   *\n   * @static\n   * @template T - the type of entities expected from this request\n   * @param {IGraph} graph - the graph instance to use for making requests\n   * @param value - the existing value\n   * @param nextLink - optional nextLink to use to get the next page\n   * from the graph parameter\n   * @returns a GraphPageIterator\n   * @memberof GraphPageIterator\n   */\n  public static createFromValue<T>(graph: IGraph, value, nextLink?) {\n    let iterator = new GraphPageIterator<T>();\n\n    // create iterator from values\n    iterator._graph = graph;\n    iterator._value = value;\n    iterator._nextLink = nextLink ? nextLink : null;\n    iterator._version = graph.version;\n\n    return iterator || null;\n  }\n\n  private _graph: IGraph;\n  private _nextLink: string;\n  private _version: string;\n  private _value: T[];\n\n  /**\n   * Gets the next page for this request\n   *\n   * @returns {Promise<T[]>}\n   * @memberof GraphPageIterator\n   */\n  public async next(): Promise<T[]> {\n    if (this._nextLink) {\n      const nextResource = this._nextLink.split(this._version)[1];\n      const response = await this._graph.api(nextResource).version(this._version).get();\n      if (response && response.value && response.value.length) {\n        this._value = this._value.concat(response.value);\n        this._nextLink = response['@odata.nextLink'];\n        return response.value;\n      }\n    }\n    return null;\n  }\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { HTMLTemplateResult, html } from 'lit';\nimport { customElementHelper } from '../components/customElementHelper';\n\n/**\n * stringsCache ensures that the same TemplateStringsArray object is returned on subsequent calls\n * This is needed as lit-html internally uses the TemplateStringsArray object as a cache key.\n * @type {WeakMap}\n */\nconst stringsCache = new WeakMap<TemplateStringsArray, TemplateStringsArray>();\n\n/**\n * Rewrites strings in an array using the supplied matcher RegExp\n * Assumes that the RegExp returns a group on matches\n *\n * @param strings The array of strings to be re-written\n * @param matcher A RegExp to be used for matching strings for replacement\n */\nconst rewriteStrings = (\n  strings: ReadonlyArray<string>,\n  matcher: RegExp,\n  replacement: string\n): ReadonlyArray<string> => {\n  const temp: string[] = [];\n  for (const s of strings) {\n    temp.push(s.replace(matcher, replacement));\n  }\n  return temp;\n};\n\n/**\n * Generates a template literal tag function that returns an HTMLTemplateResult.\n */\nconst tag = (strings: TemplateStringsArray, ...values: unknown[]): HTMLTemplateResult => {\n  // re-write <mgt-([a-z]+) if necessary\n  if (customElementHelper.isDisambiguated) {\n    let cached = stringsCache.get(strings);\n    if (!Boolean(cached)) {\n      const matcher = new RegExp('(</?)mgt-(?!' + customElementHelper.disambiguation + '-)');\n      const newPrefix = `$1${customElementHelper.prefix}-`;\n      cached = Object.assign(rewriteStrings(strings, matcher, newPrefix), {\n        raw: rewriteStrings(strings.raw, matcher, newPrefix)\n      });\n      stringsCache.set(strings, cached);\n    }\n    strings = cached;\n  }\n\n  return html(strings, ...values);\n};\n\n/**\n * Interprets a template literal and dynamically rewrites `<mgt-` tags with the\n * configured disambiguation if necessary.\n *\n * ```ts\n * const header = (title: string) => mgtHtml`<mgt-flyout>${title}</mgt-flyout>`;\n * ```\n *\n * The `mgtHtml` tag is a wrapper for the `html` tag from `lit` which provides for dynamic tag re-writing\n */\nexport const mgtHtml = tag;\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { customElement as litElement } from 'lit/decorators.js';\nimport { customElementHelper } from '../components/customElementHelper';\n\n/**\n * This is a wrapper decorator for `customElement` from `lit`\n * It adds the appropriate prefix to the provided tagName calls the wrapped decorator\n * This decorator should be used in place of the unwrapped version from lit in all cases.\n *\n * @param tagName the base name for the custom element tag\n */\nexport const customElement = (tagName: string): ((classOrDescriptor: unknown) => any) => {\n  const mgtTagName = `${customElementHelper.prefix}-${tagName}`;\n  const mgtElement = customElements.get(mgtTagName);\n  const unknownVersion = ' Unknown likely <3.0.0';\n  const version = element => (element as any).version || unknownVersion;\n  if (mgtElement) {\n    return (classOrDescriptor: CustomElementConstructor) => {\n      // tslint:disable-next-line: no-console\n      console.error(\n        `Tag name ${mgtTagName} is already defined using class ${mgtElement.name} version ${version(mgtElement)}\\n`,\n        `Currently registering class ${classOrDescriptor.name} with version ${version(classOrDescriptor)}\\n`,\n        'Please use the disambiguation feature to define a unique tag name for this component see: https://github.com/microsoftgraph/microsoft-graph-toolkit/tree/main/packages/mgt-components#disambiguation'\n      );\n      return classOrDescriptor;\n    };\n  }\n  return litElement(mgtTagName);\n};\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * Wrapper around the window.sessionStorage API. Use\n * this to set, get and clear session items.\n */\nexport class SessionCache {\n  private session: Storage;\n\n  constructor() {\n    this.session = window.sessionStorage;\n  }\n\n  setItem(key: string, value: string) {\n    this.session.setItem(key, value);\n  }\n\n  getItem(key: string): string {\n    return this.session.getItem(key);\n  }\n\n  clear() {\n    this.session.clear();\n  }\n}\n\n/**\n * Checks if a sessionStorage or a localStorage is available\n * for use in a browser.\n * @param storageType can be 'sessionStorage' or 'localStorage'.\n * @returns true if the storage is available for use.\n */\nexport function storageAvailable(storageType: string): boolean {\n  let storage: Storage;\n  try {\n    storage = window[storageType];\n    const x = '__storage_test__';\n    storage.setItem(x, x);\n    storage.removeItem(x);\n    return true;\n  } catch (e) {\n    return (\n      e instanceof DOMException &&\n      // everything except Firefox\n      (e.code === 22 ||\n        // Firefox\n        e.code === 1014 ||\n        // test name field too, because code might not be present\n        // everything except Firefox\n        e.name === 'QuotaExceededError' ||\n        // Firefox\n        e.name === 'NS_ERROR_DOM_QUOTA_REACHED') &&\n      // acknowledge QuotaExceededError only if there's something already stored\n      storage &&\n      storage.length !== 0\n    );\n  }\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport {\n  AuthenticationHandler,\n  Client,\n  Context,\n  HTTPMessageHandler,\n  Middleware,\n  RetryHandler,\n  RetryHandlerOptions,\n  TelemetryHandler\n} from '@microsoft/microsoft-graph-client';\nimport { SessionCache, storageAvailable } from '../utils/SessionCache';\nimport { MgtBaseComponent } from '../components/baseComponent';\nimport { Graph } from '../Graph';\nimport { chainMiddleware } from '../utils/GraphHelpers';\n\nimport { MockProvider } from './MockProvider';\n\n/**\n * MockGraph Instance\n *\n * @export\n * @class MockGraph\n * @extends {Graph}\n */\n// tslint:disable-next-line: max-classes-per-file\nexport class MockGraph extends Graph {\n  /**\n   * Creates a new MockGraph instance. Use this static method instead of the constructor.\n   *\n   * @static\n   * @param {MockProvider} provider\n   * @return {*}  {Promise<MockGraph>}\n   * @memberof MockGraph\n   */\n  public static async create(provider: MockProvider): Promise<MockGraph> {\n    const middleware: Middleware[] = [\n      new AuthenticationHandler(provider),\n      new RetryHandler(new RetryHandlerOptions()),\n      new TelemetryHandler(),\n      new MockMiddleware(),\n      new HTTPMessageHandler()\n    ];\n\n    return new MockGraph(\n      Client.initWithMiddleware({\n        middleware: chainMiddleware(...middleware),\n        customHosts: new Set<string>([new URL(await MockMiddleware.getBaseUrl()).hostname])\n      })\n    );\n  }\n\n  /**\n   * Returns an instance of the Graph in the context of the provided component.\n   *\n   * @param {MgtBaseComponent} component\n   * @returns\n   * @memberof Graph\n   */\n  public forComponent(component: MgtBaseComponent | string): MockGraph {\n    // The purpose of the forComponent pattern is to update the headers of any outgoing Graph requests.\n    // The MockGraph isn't making real Graph requests, so we can simply no-op and return the same instance.\n    return this;\n  }\n}\n\n/**\n * Implements Middleware for the Mock Client to escape\n * the graph url from the request\n *\n * @class MockMiddleware\n * @implements {Middleware}\n */\n// tslint:disable-next-line: max-classes-per-file\nclass MockMiddleware implements Middleware {\n  /**\n   * @private\n   * A member to hold next middleware in the middleware chain\n   */\n  private _nextMiddleware: Middleware;\n\n  private static _baseUrl: string;\n\n  private static _cache: SessionCache;\n  private static get _sessionCache(): SessionCache {\n    if (!this._cache && storageAvailable('sessionStorage')) {\n      this._cache = new SessionCache();\n    }\n    return this._cache;\n  }\n\n  // tslint:disable-next-line: completed-docs\n  public async execute(context: Context): Promise<void> {\n    try {\n      const baseUrl = await MockMiddleware.getBaseUrl();\n      context.request = baseUrl + encodeURIComponent(context.request as string);\n    } catch (error) {\n      // ignore error\n    }\n    return await this._nextMiddleware.execute(context);\n  }\n  /**\n   * Handles setting of next middleware\n   *\n   * @param {Middleware} next\n   * @memberof SdkVersionMiddleware\n   */\n  public setNext(next: Middleware): void {\n    this._nextMiddleware = next;\n  }\n\n  /**\n   * Gets the base url for the mock graph, either from the session cache or from the endpoint service\n   *\n   * @static\n   * @return {string} the base url for the mock graph to use.\n   * @memberof MockMiddleware\n   */\n  public static async getBaseUrl() {\n    if (!this._baseUrl) {\n      const sessionEndpoint = this._sessionCache?.getItem('endpointURL');\n      if (sessionEndpoint) {\n        this._baseUrl = sessionEndpoint;\n      } else {\n        try {\n          // get the url we should be using from the endpoint service\n          const response = await fetch('https://cdn.graph.office.net/en-us/graph/api/proxy/endpoint');\n          this._baseUrl = (await response.json()) + '?url=';\n        } catch {\n          // fallback to hardcoded value\n          this._baseUrl = 'https://proxy.apisandbox.msdn.microsoft.com/svc?url=';\n        }\n        this._sessionCache?.setItem('endpointURL', this._baseUrl);\n      }\n    }\n\n    return this._baseUrl;\n  }\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { IProvider, IProviderAccount, ProviderState } from '../providers/IProvider';\nimport { MockGraph } from './MockGraph';\n\n/**\n * Mock Provider access token for Microsoft Graph APIs\n *\n * @export\n * @class MockProvider\n * @extends {IProvider}\n */\nexport class MockProvider extends IProvider {\n  // tslint:disable-next-line: completed-docs\n  public provider: any;\n\n  private _mockGraphPromise: Promise<MockGraph>;\n\n  /**\n   * new instance of mock graph provider\n   *\n   * @memberof MockProvider\n   */\n  public graph: MockGraph;\n  constructor(signedIn: boolean = false, signedInAccounts: IProviderAccount[] = []) {\n    super();\n    this._mockGraphPromise = MockGraph.create(this);\n    const enableMultipleLogin = Boolean(signedInAccounts.length);\n    this.isMultipleAccountSupported = enableMultipleLogin;\n    this.isMultipleAccountDisabled = !enableMultipleLogin;\n    this._accounts = signedInAccounts;\n\n    this.initializeMockGraph(signedIn);\n  }\n\n  /**\n   * Indicates if the MockProvider is configured to support multi account mode\n   * This is only true if the Mock provider has been configured with signedInAccounts in the constructor\n   *\n   * @readonly\n   * @type {boolean}\n   * @memberof MockProvider\n   */\n  public get isMultiAccountSupportedAndEnabled(): boolean {\n    return !this.isMultipleAccountDisabled && this.isMultipleAccountSupported;\n  }\n\n  private _accounts: IProviderAccount[] = [];\n  /**\n   * Returns the array of accounts the MockProviders has been configured with\n   *\n   * @return {*}  {IProviderAccount[]}\n   * @memberof MockProvider\n   */\n  public getAllAccounts?(): IProviderAccount[] {\n    return this._accounts;\n  }\n\n  /**\n   * Returns the first account in the set of accounts the MockProvider has been configured with\n   *\n   * @return {*}  {IProviderAccount}\n   * @memberof MockProvider\n   */\n  public getActiveAccount?(): IProviderAccount {\n    if (this._accounts.length) {\n      return this._accounts[0];\n    }\n  }\n\n  /**\n   * sets Provider state to SignedIn\n   *\n   * @returns {Promise<void>}\n   * @memberof MockProvider\n   */\n  public async login(): Promise<void> {\n    this.setState(ProviderState.Loading);\n    await this._mockGraphPromise;\n    await new Promise(resolve => setTimeout(resolve, 3000));\n    this.setState(ProviderState.SignedIn);\n  }\n\n  /**\n   * sets Provider state to signed out\n   *\n   * @returns {Promise<void>}\n   * @memberof MockProvider\n   */\n  public async logout(): Promise<void> {\n    this.setState(ProviderState.Loading);\n    await this._mockGraphPromise;\n    await new Promise(resolve => setTimeout(resolve, 3000));\n    this.setState(ProviderState.SignedOut);\n  }\n\n  /**\n   * Promise returning token from graph.microsoft.com\n   *\n   * @returns {Promise<string>}\n   * @memberof MockProvider\n   */\n  public getAccessToken(): Promise<string> {\n    return Promise.resolve('{token:https://graph.microsoft.com/}');\n  }\n\n  /**\n   * Name used for analytics\n   *\n   * @readonly\n   * @memberof IProvider\n   */\n  public get name() {\n    return 'MgtMockProvider';\n  }\n\n  private async initializeMockGraph(signedIn: boolean = false) {\n    this.graph = await this._mockGraphPromise;\n\n    if (signedIn) {\n      this.setState(ProviderState.SignedIn);\n    } else {\n      this.setState(ProviderState.SignedOut);\n    }\n  }\n}\n", "/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nexport * from './IBatch';\nexport * from './IGraph';\nexport * from './Graph';\nexport * from './BetaGraph';\n\nexport * from './components/baseComponent';\nexport * from './components/baseProvider';\nexport * from './components/templatedComponent';\nexport * from './components/customElementHelper';\n\nexport * from './providers/IProvider';\nexport * from './providers/Providers';\nexport * from './providers/SimpleProvider';\n\nexport * from './utils/Cache';\nexport * from './utils/EventDispatcher';\nexport * from './utils/equals';\nexport * from './utils/GraphHelpers';\nexport * from './utils/TeamsHelper';\nexport * from './utils/TemplateContext';\nexport * from './utils/TemplateHelper';\nexport * from './utils/GraphPageIterator';\nexport * from './utils/LocalizationHelper';\nexport * from './utils/mgtHtml';\nexport * from './utils/CustomElement';\nexport { PACKAGE_VERSION } from './utils/version';\n\nexport * from './mock/MockProvider';\n"],
  "mappings": "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",
  "names": ["RequestMethod", "FeatureUsageFlag", "delay", "delay", "ChaosStrategy", "ResponseType", "DocumentType", "ContentType", "ContentTypeRegexStr", "path", "property", "_a", "state", "LoginType", "ProviderState", "_a", "ProvidersChangedState", "_a", "PACKAGE_VERSION", "PACKAGE_VERSION", "GRAPH_VERSION", "NODE_MODE", "global", "_a", "_b", "_a", "_b", "_c", "_d", "DEV_MODE", "NODE_MODE", "global", "debugLogEvent", "issueWarning", "trustedTypes", "emptyStringForBooleanAttribute", "polyfillSupport", "html", "tag", "strings", "DEV_MODE", "issueWarning", "polyfillSupport", "_a", "_b", "finalized", "_c", "NODE_MODE", "global", "_a", "_a", "_b", "ComponentMediaQuery", "PACKAGE_VERSION", "__awaiter", "__decorate", "__decorate", "wrap", "wrap", "target", "__awaiter", "tag", "customElement", "_a", "_c", "_b"]
}

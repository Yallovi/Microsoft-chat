"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function createCommonjsModule(t,o){return t(o={exports:{}},o.exports),o.exports}var o,s,check=function(t){return t&&t.Math==Math&&t},l=check("object"==typeof globalThis&&globalThis)||check("object"==typeof window&&window)||check("object"==typeof self&&self)||check("object"==typeof t&&t)||function(){return this}()||Function("return this")(),fails=function(t){try{return!!t()}catch(t){return!0}},h=!fails((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),v=!fails((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),m=Function.prototype.call,_=v?m.bind(m):function(){return m.apply(m,arguments)},R={}.propertyIsEnumerable,$=Object.getOwnPropertyDescriptor,B=$&&!R.call({1:2},1)?function propertyIsEnumerable(t){var o=$(this,t);return!!o&&o.enumerable}:R,q={f:B},createPropertyDescriptor=function(t,o){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:o}},j=Function.prototype,z=j.call,K=v&&j.bind.bind(z,z),W=v?K:function(t){return function(){return z.apply(t,arguments)}},Z=W({}.toString),te=W("".slice),classofRaw=function(t){return te(Z(t),8,-1)},ne=Object,ie=W("".split),se=fails((function(){return!ne("z").propertyIsEnumerable(0)}))?function(t){return"String"==classofRaw(t)?ie(t,""):ne(t)}:ne,isNullOrUndefined=function(t){return null==t},he=TypeError,requireObjectCoercible=function(t){if(isNullOrUndefined(t))throw he("Can't call method on "+t);return t},toIndexedObject=function(t){return se(requireObjectCoercible(t))},me="object"==typeof document&&document.all,_e={all:me,IS_HTMLDDA:void 0===me&&void 0!==me},Ce=_e.all,ke=_e.IS_HTMLDDA?function(t){return"function"==typeof t||t===Ce}:function(t){return"function"==typeof t},Se=_e.all,Ee=_e.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:ke(t)||t===Se}:function(t){return"object"==typeof t?null!==t:ke(t)},aFunction=function(t){return ke(t)?t:void 0},getBuiltIn=function(t,o){return arguments.length<2?aFunction(l[t]):l[t]&&l[t][o]},Pe=W({}.isPrototypeOf),Re="undefined"!=typeof navigator&&String(navigator.userAgent)||"",$e=l.process,De=l.Deno,Be=$e&&$e.versions||De&&De.version,je=Be&&Be.v8;je&&(s=(o=je.split("."))[0]>0&&o[0]<4?1:+(o[0]+o[1])),!s&&Re&&(!(o=Re.match(/Edge\/(\d+)/))||o[1]>=74)&&(o=Re.match(/Chrome\/(\d+)/))&&(s=+o[1]);var ze=s,Ye=!!Object.getOwnPropertySymbols&&!fails((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&ze&&ze<41})),Xe=Ye&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,et=Object,tt=Xe?function(t){return"symbol"==typeof t}:function(t){var o=getBuiltIn("Symbol");return ke(o)&&Pe(o.prototype,et(t))},rt=String,tryToString=function(t){try{return rt(t)}catch(t){return"Object"}},ot=TypeError,aCallable=function(t){if(ke(t))return t;throw ot(tryToString(t)+" is not a function")},getMethod$1=function(t,o){var s=t[o];return isNullOrUndefined(s)?void 0:aCallable(s)},nt=TypeError,ordinaryToPrimitive=function(t,o){var s,l;if("string"===o&&ke(s=t.toString)&&!Ee(l=_(s,t)))return l;if(ke(s=t.valueOf)&&!Ee(l=_(s,t)))return l;if("string"!==o&&ke(s=t.toString)&&!Ee(l=_(s,t)))return l;throw nt("Can't convert object to primitive value")},it=Object.defineProperty,defineGlobalProperty=function(t,o){try{it(l,t,{value:o,configurable:!0,writable:!0})}catch(s){l[t]=o}return o},st="__core-js_shared__",lt=l[st]||defineGlobalProperty(st,{}),ct=createCommonjsModule((function(t){(t.exports=function(t,o){return lt[t]||(lt[t]=void 0!==o?o:{})})("versions",[]).push({version:"3.28.0",mode:"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.28.0/LICENSE",source:"https://github.com/zloirock/core-js"})})),dt=Object,toObject=function(t){return dt(requireObjectCoercible(t))},ut=W({}.hasOwnProperty),ht=Object.hasOwn||function hasOwn(t,o){return ut(toObject(t),o)},pt=0,ft=Math.random(),gt=W(1..toString),uid=function(t){return"Symbol("+(void 0===t?"":t)+")_"+gt(++pt+ft,36)},vt=l.Symbol,mt=ct("wks"),bt=Xe?vt.for||vt:vt&&vt.withoutSetter||uid,wellKnownSymbol=function(t){return ht(mt,t)||(mt[t]=Ye&&ht(vt,t)?vt[t]:bt("Symbol."+t)),mt[t]},yt=TypeError,wt=wellKnownSymbol("toPrimitive"),toPrimitive=function(t,o){if(!Ee(t)||tt(t))return t;var s,l=getMethod$1(t,wt);if(l){if(void 0===o&&(o="default"),s=_(l,t,o),!Ee(s)||tt(s))return s;throw yt("Can't convert object to primitive value")}return void 0===o&&(o="number"),ordinaryToPrimitive(t,o)},toPropertyKey=function(t){var o=toPrimitive(t,"string");return tt(o)?o:o+""},_t=l.document,Ct=Ee(_t)&&Ee(_t.createElement),documentCreateElement=function(t){return Ct?_t.createElement(t):{}},kt=!h&&!fails((function(){return 7!=Object.defineProperty(documentCreateElement("div"),"a",{get:function(){return 7}}).a})),Tt=Object.getOwnPropertyDescriptor,St=h?Tt:function getOwnPropertyDescriptor(t,o){if(t=toIndexedObject(t),o=toPropertyKey(o),kt)try{return Tt(t,o)}catch(t){}if(ht(t,o))return createPropertyDescriptor(!_(q.f,t,o),t[o])},xt={f:St},Et=h&&fails((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),It=String,At=TypeError,anObject=function(t){if(Ee(t))return t;throw At(It(t)+" is not an object")},Pt=TypeError,Rt=Object.defineProperty,Ot=Object.getOwnPropertyDescriptor,$t="enumerable",Nt="configurable",Mt="writable",Dt=h?Et?function defineProperty(t,o,s){if(anObject(t),o=toPropertyKey(o),anObject(s),"function"==typeof t&&"prototype"===o&&"value"in s&&Mt in s&&!s[Mt]){var l=Ot(t,o);l&&l[Mt]&&(t[o]=s.value,s={configurable:Nt in s?s[Nt]:l[Nt],enumerable:$t in s?s[$t]:l[$t],writable:!1})}return Rt(t,o,s)}:Rt:function defineProperty(t,o,s){if(anObject(t),o=toPropertyKey(o),anObject(s),kt)try{return Rt(t,o,s)}catch(t){}if("get"in s||"set"in s)throw Pt("Accessors not supported");return"value"in s&&(t[o]=s.value),t},Lt={f:Dt},Ft=h?function(t,o,s){return Lt.f(t,o,createPropertyDescriptor(1,s))}:function(t,o,s){return t[o]=s,t},Ut=Function.prototype,Ht=h&&Object.getOwnPropertyDescriptor,Bt=ht(Ut,"name"),qt={EXISTS:Bt,PROPER:Bt&&"something"===function something(){}.name,CONFIGURABLE:Bt&&(!h||h&&Ht(Ut,"name").configurable)},jt=W(Function.toString);ke(lt.inspectSource)||(lt.inspectSource=function(t){return jt(t)});var zt,Vt,Gt,Kt=lt.inspectSource,Wt=l.WeakMap,Qt=ke(Wt)&&/native code/.test(String(Wt)),Yt=ct("keys"),sharedKey=function(t){return Yt[t]||(Yt[t]=uid(t))},Jt={},Xt="Object already initialized",Zt=l.TypeError,er=l.WeakMap;if(Qt||lt.state){var tr=lt.state||(lt.state=new er);tr.get=tr.get,tr.has=tr.has,tr.set=tr.set,zt=function(t,o){if(tr.has(t))throw Zt(Xt);return o.facade=t,tr.set(t,o),o},Vt=function(t){return tr.get(t)||{}},Gt=function(t){return tr.has(t)}}else{var rr=sharedKey("state");Jt[rr]=!0,zt=function(t,o){if(ht(t,rr))throw Zt(Xt);return o.facade=t,Ft(t,rr,o),o},Vt=function(t){return ht(t,rr)?t[rr]:{}},Gt=function(t){return ht(t,rr)}}var or={set:zt,get:Vt,has:Gt,enforce:function(t){return Gt(t)?Vt(t):zt(t,{})},getterFor:function(t){return function(o){var s;if(!Ee(o)||(s=Vt(o)).type!==t)throw Zt("Incompatible receiver, "+t+" required");return s}}},nr=createCommonjsModule((function(t){var o=qt.CONFIGURABLE,s=or.enforce,l=or.get,v=String,m=Object.defineProperty,_=W("".slice),R=W("".replace),$=W([].join),B=h&&!fails((function(){return 8!==m((function(){}),"length",{value:8}).length})),q=String(String).split("String"),j=t.exports=function(t,l,j){"Symbol("===_(v(l),0,7)&&(l="["+R(v(l),/^Symbol\(([^)]*)\)/,"$1")+"]"),j&&j.getter&&(l="get "+l),j&&j.setter&&(l="set "+l),(!ht(t,"name")||o&&t.name!==l)&&(h?m(t,"name",{value:l,configurable:!0}):t.name=l),B&&j&&ht(j,"arity")&&t.length!==j.arity&&m(t,"length",{value:j.arity});try{j&&ht(j,"constructor")&&j.constructor?h&&m(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var z=s(t);return ht(z,"source")||(z.source=$(q,"string"==typeof l?l:"")),t};Function.prototype.toString=j((function toString(){return ke(this)&&l(this).source||Kt(this)}),"toString")})),defineBuiltIn=function(t,o,s,l){l||(l={});var h=l.enumerable,v=void 0!==l.name?l.name:o;if(ke(s)&&nr(s,v,l),l.global)h?t[o]=s:defineGlobalProperty(o,s);else{try{l.unsafe?t[o]&&(h=!0):delete t[o]}catch(t){}h?t[o]=s:Lt.f(t,o,{value:s,enumerable:!1,configurable:!l.nonConfigurable,writable:!l.nonWritable})}return t},ir=Math.ceil,sr=Math.floor,ar=Math.trunc||function trunc(t){var o=+t;return(o>0?sr:ir)(o)},toIntegerOrInfinity=function(t){var o=+t;return o!=o||0===o?0:ar(o)},lr=Math.max,cr=Math.min,toAbsoluteIndex=function(t,o){var s=toIntegerOrInfinity(t);return s<0?lr(s+o,0):cr(s,o)},dr=Math.min,toLength=function(t){return t>0?dr(toIntegerOrInfinity(t),9007199254740991):0},lengthOfArrayLike=function(t){return toLength(t.length)},createMethod$7=function(t){return function(o,s,l){var h,v=toIndexedObject(o),m=lengthOfArrayLike(v),_=toAbsoluteIndex(l,m);if(t&&s!=s){for(;m>_;)if((h=v[_++])!=h)return!0}else for(;m>_;_++)if((t||_ in v)&&v[_]===s)return t||_||0;return!t&&-1}},ur={includes:createMethod$7(!0),indexOf:createMethod$7(!1)},hr=ur.indexOf,pr=W([].push),objectKeysInternal=function(t,o){var s,l=toIndexedObject(t),h=0,v=[];for(s in l)!ht(Jt,s)&&ht(l,s)&&pr(v,s);for(;o.length>h;)ht(l,s=o[h++])&&(~hr(v,s)||pr(v,s));return v},fr=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],gr=fr.concat("length","prototype"),vr={f:Object.getOwnPropertyNames||function getOwnPropertyNames(t){return objectKeysInternal(t,gr)}},mr={f:Object.getOwnPropertySymbols},br=W([].concat),yr=getBuiltIn("Reflect","ownKeys")||function ownKeys(t){var o=vr.f(anObject(t)),s=mr.f;return s?br(o,s(t)):o},copyConstructorProperties$1=function(t,o,s){for(var l=yr(o),h=Lt.f,v=xt.f,m=0;m<l.length;m++){var _=l[m];ht(t,_)||s&&ht(s,_)||h(t,_,v(o,_))}},wr=/#|\.prototype\./,isForced=function(t,o){var s=Cr[_r(t)];return s==Tr||s!=kr&&(ke(o)?fails(o):!!o)},_r=isForced.normalize=function(t){return String(t).replace(wr,".").toLowerCase()},Cr=isForced.data={},kr=isForced.NATIVE="N",Tr=isForced.POLYFILL="P",Sr=isForced,xr=xt.f,_export=function(t,o){var s,h,v,m,_,R=t.target,$=t.global,B=t.stat;if(s=$?l:B?l[R]||defineGlobalProperty(R,{}):(l[R]||{}).prototype)for(h in o){if(m=o[h],v=t.dontCallGetSet?(_=xr(s,h))&&_.value:s[h],!Sr($?h:R+(B?".":"#")+h,t.forced)&&void 0!==v){if(typeof m==typeof v)continue;copyConstructorProperties$1(m,v)}(t.sham||v&&v.sham)&&Ft(m,"sham",!0),defineBuiltIn(s,h,m,t)}},Er={};Er[wellKnownSymbol("toStringTag")]="z";var Ir,Ar="[object z]"===String(Er),Pr=wellKnownSymbol("toStringTag"),Rr=Object,Or="Arguments"==classofRaw(function(){return arguments}()),$r=Ar?classofRaw:function(t){var o,s,l;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(s=function(t,o){try{return t[o]}catch(t){}}(o=Rr(t),Pr))?s:Or?classofRaw(o):"Object"==(l=classofRaw(o))&&ke(o.callee)?"Arguments":l},Nr=String,toString_1=function(t){if("Symbol"===$r(t))throw TypeError("Cannot convert a Symbol value to a string");return Nr(t)},Mr=Object.keys||function keys(t){return objectKeysInternal(t,fr)},Dr=h&&!Et?Object.defineProperties:function defineProperties(t,o){anObject(t);for(var s,l=toIndexedObject(o),h=Mr(o),v=h.length,m=0;v>m;)Lt.f(t,s=h[m++],l[s]);return t},Lr={f:Dr},Fr=getBuiltIn("document","documentElement"),Ur="prototype",Hr="script",Br=sharedKey("IE_PROTO"),EmptyConstructor=function(){},scriptTag=function(t){return"<"+Hr+">"+t+"</"+Hr+">"},NullProtoObjectViaActiveX=function(t){t.write(scriptTag("")),t.close();var o=t.parentWindow.Object;return t=null,o},NullProtoObject=function(){try{Ir=new ActiveXObject("htmlfile")}catch(t){}var t,o,s;NullProtoObject="undefined"!=typeof document?document.domain&&Ir?NullProtoObjectViaActiveX(Ir):(o=documentCreateElement("iframe"),s="java"+Hr+":",o.style.display="none",Fr.appendChild(o),o.src=String(s),(t=o.contentWindow.document).open(),t.write(scriptTag("document.F=Object")),t.close(),t.F):NullProtoObjectViaActiveX(Ir);for(var l=fr.length;l--;)delete NullProtoObject[Ur][fr[l]];return NullProtoObject()};Jt[Br]=!0;var qr=Object.create||function create(t,o){var s;return null!==t?(EmptyConstructor[Ur]=anObject(t),s=new EmptyConstructor,EmptyConstructor[Ur]=null,s[Br]=t):s=NullProtoObject(),void 0===o?s:Lr.f(s,o)},createProperty=function(t,o,s){var l=toPropertyKey(o);l in t?Lt.f(t,l,createPropertyDescriptor(0,s)):t[l]=s},jr=Array,zr=Math.max,arraySliceSimple=function(t,o,s){for(var l=lengthOfArrayLike(t),h=toAbsoluteIndex(o,l),v=toAbsoluteIndex(void 0===s?l:s,l),m=jr(zr(v-h,0)),_=0;h<v;h++,_++)createProperty(m,_,t[h]);return m.length=_,m},Vr=vr.f,Gr="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Kr={f:function getOwnPropertyNames(t){return Gr&&"Window"==classofRaw(t)?function(t){try{return Vr(t)}catch(t){return arraySliceSimple(Gr)}}(t):Vr(toIndexedObject(t))}},defineBuiltInAccessor=function(t,o,s){return s.get&&nr(s.get,o,{getter:!0}),s.set&&nr(s.set,o,{setter:!0}),Lt.f(t,o,s)},Wr={f:wellKnownSymbol},Qr=l,Yr=Lt.f,wellKnownSymbolDefine=function(t){var o=Qr.Symbol||(Qr.Symbol={});ht(o,t)||Yr(o,t,{value:Wr.f(t)})},symbolDefineToPrimitive=function(){var t=getBuiltIn("Symbol"),o=t&&t.prototype,s=o&&o.valueOf,l=wellKnownSymbol("toPrimitive");o&&!o[l]&&defineBuiltIn(o,l,(function(t){return _(s,this)}),{arity:1})},Jr=Lt.f,Xr=wellKnownSymbol("toStringTag"),setToStringTag=function(t,o,s){t&&!s&&(t=t.prototype),t&&!ht(t,Xr)&&Jr(t,Xr,{configurable:!0,value:o})},functionUncurryThisClause=function(t){if("Function"===classofRaw(t))return W(t)},Zr=functionUncurryThisClause(functionUncurryThisClause.bind),functionBindContext=function(t,o){return aCallable(t),void 0===o?t:v?Zr(t,o):function(){return t.apply(o,arguments)}},eo=Array.isArray||function isArray(t){return"Array"==classofRaw(t)},noop=function(){},to=[],ro=getBuiltIn("Reflect","construct"),oo=/^\s*(?:class|function)\b/,no=W(oo.exec),io=!oo.exec(noop),so=function isConstructor(t){if(!ke(t))return!1;try{return ro(noop,to,t),!0}catch(t){return!1}},ao=function isConstructor(t){if(!ke(t))return!1;switch($r(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return io||!!no(oo,Kt(t))}catch(t){return!0}};ao.sham=!0;var lo=!ro||fails((function(){var t;return so(so.call)||!so(Object)||!so((function(){t=!0}))||t}))?ao:so,co=wellKnownSymbol("species"),uo=Array,arraySpeciesCreate=function(t,o){return new(function(t){var o;return eo(t)&&(o=t.constructor,(lo(o)&&(o===uo||eo(o.prototype))||Ee(o)&&null===(o=o[co]))&&(o=void 0)),void 0===o?uo:o}(t))(0===o?0:o)},ho=W([].push),createMethod$6=function(t){var o=1==t,s=2==t,l=3==t,h=4==t,v=6==t,m=7==t,_=5==t||v;return function(R,$,B,q){for(var j,z,K=toObject(R),W=se(K),Z=functionBindContext($,B),te=lengthOfArrayLike(W),ne=0,ie=q||arraySpeciesCreate,he=o?ie(R,te):s||m?ie(R,0):void 0;te>ne;ne++)if((_||ne in W)&&(z=Z(j=W[ne],ne,K),t))if(o)he[ne]=z;else if(z)switch(t){case 3:return!0;case 5:return j;case 6:return ne;case 2:ho(he,j)}else switch(t){case 4:return!1;case 7:ho(he,j)}return v?-1:l||h?h:he}},po={forEach:createMethod$6(0),map:createMethod$6(1),filter:createMethod$6(2),some:createMethod$6(3),every:createMethod$6(4),find:createMethod$6(5),findIndex:createMethod$6(6),filterReject:createMethod$6(7)},fo=po.forEach,go=sharedKey("hidden"),vo="Symbol",mo="prototype",bo=or.set,yo=or.getterFor(vo),wo=Object[mo],_o=l.Symbol,Co=_o&&_o[mo],ko=l.TypeError,To=l.QObject,So=xt.f,xo=Lt.f,Eo=Kr.f,Io=q.f,Ao=W([].push),Po=ct("symbols"),Ro=ct("op-symbols"),Oo=ct("wks"),$o=!To||!To[mo]||!To[mo].findChild,No=h&&fails((function(){return 7!=qr(xo({},"a",{get:function(){return xo(this,"a",{value:7}).a}})).a}))?function(t,o,s){var l=So(wo,o);l&&delete wo[o],xo(t,o,s),l&&t!==wo&&xo(wo,o,l)}:xo,wrap$1=function(t,o){var s=Po[t]=qr(Co);return bo(s,{type:vo,tag:t,description:o}),h||(s.description=o),s},Mo=function defineProperty(t,o,s){t===wo&&Mo(Ro,o,s),anObject(t);var l=toPropertyKey(o);return anObject(s),ht(Po,l)?(s.enumerable?(ht(t,go)&&t[go][l]&&(t[go][l]=!1),s=qr(s,{enumerable:createPropertyDescriptor(0,!1)})):(ht(t,go)||xo(t,go,createPropertyDescriptor(1,{})),t[go][l]=!0),No(t,l,s)):xo(t,l,s)},Do=function defineProperties(t,o){anObject(t);var s=toIndexedObject(o),l=Mr(s).concat($getOwnPropertySymbols(s));return fo(l,(function(o){h&&!_(Lo,s,o)||Mo(t,o,s[o])})),t},Lo=function propertyIsEnumerable(t){var o=toPropertyKey(t),s=_(Io,this,o);return!(this===wo&&ht(Po,o)&&!ht(Ro,o))&&(!(s||!ht(this,o)||!ht(Po,o)||ht(this,go)&&this[go][o])||s)},Fo=function getOwnPropertyDescriptor(t,o){var s=toIndexedObject(t),l=toPropertyKey(o);if(s!==wo||!ht(Po,l)||ht(Ro,l)){var h=So(s,l);return!h||!ht(Po,l)||ht(s,go)&&s[go][l]||(h.enumerable=!0),h}},Uo=function getOwnPropertyNames(t){var o=Eo(toIndexedObject(t)),s=[];return fo(o,(function(t){ht(Po,t)||ht(Jt,t)||Ao(s,t)})),s},$getOwnPropertySymbols=function(t){var o=t===wo,s=Eo(o?Ro:toIndexedObject(t)),l=[];return fo(s,(function(t){!ht(Po,t)||o&&!ht(wo,t)||Ao(l,Po[t])})),l};Ye||(_o=function Symbol(){if(Pe(Co,this))throw ko("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?toString_1(arguments[0]):void 0,o=uid(t),setter=function(t){this===wo&&_(setter,Ro,t),ht(this,go)&&ht(this[go],o)&&(this[go][o]=!1),No(this,o,createPropertyDescriptor(1,t))};return h&&$o&&No(wo,o,{configurable:!0,set:setter}),wrap$1(o,t)},Co=_o[mo],defineBuiltIn(Co,"toString",(function toString(){return yo(this).tag})),defineBuiltIn(_o,"withoutSetter",(function(t){return wrap$1(uid(t),t)})),q.f=Lo,Lt.f=Mo,Lr.f=Do,xt.f=Fo,vr.f=Kr.f=Uo,mr.f=$getOwnPropertySymbols,Wr.f=function(t){return wrap$1(wellKnownSymbol(t),t)},h&&(defineBuiltInAccessor(Co,"description",{configurable:!0,get:function description(){return yo(this).description}}),defineBuiltIn(wo,"propertyIsEnumerable",Lo,{unsafe:!0}))),_export({global:!0,constructor:!0,wrap:!0,forced:!Ye,sham:!Ye},{Symbol:_o}),fo(Mr(Oo),(function(t){wellKnownSymbolDefine(t)})),_export({target:vo,stat:!0,forced:!Ye},{useSetter:function(){$o=!0},useSimple:function(){$o=!1}}),_export({target:"Object",stat:!0,forced:!Ye,sham:!h},{create:function create(t,o){return void 0===o?qr(t):Do(qr(t),o)},defineProperty:Mo,defineProperties:Do,getOwnPropertyDescriptor:Fo}),_export({target:"Object",stat:!0,forced:!Ye},{getOwnPropertyNames:Uo}),symbolDefineToPrimitive(),setToStringTag(_o,vo),Jt[go]=!0;var Ho=Ye&&!!Symbol.for&&!!Symbol.keyFor,Bo=ct("string-to-symbol-registry"),qo=ct("symbol-to-string-registry");_export({target:"Symbol",stat:!0,forced:!Ho},{for:function(t){var o=toString_1(t);if(ht(Bo,o))return Bo[o];var s=getBuiltIn("Symbol")(o);return Bo[o]=s,qo[s]=o,s}});var jo=ct("symbol-to-string-registry");_export({target:"Symbol",stat:!0,forced:!Ho},{keyFor:function keyFor(t){if(!tt(t))throw TypeError(tryToString(t)+" is not a symbol");if(ht(jo,t))return jo[t]}});var zo=Function.prototype,Vo=zo.apply,Go=zo.call,Ko="object"==typeof Reflect&&Reflect.apply||(v?Go.bind(Vo):function(){return Go.apply(Vo,arguments)}),Wo=W([].slice),Qo=W([].push),getJsonReplacerFunction=function(t){if(ke(t))return t;if(eo(t)){for(var o=t.length,s=[],l=0;l<o;l++){var h=t[l];"string"==typeof h?Qo(s,h):"number"!=typeof h&&"Number"!=classofRaw(h)&&"String"!=classofRaw(h)||Qo(s,toString_1(h))}var v=s.length,m=!0;return function(t,o){if(m)return m=!1,o;if(eo(this))return o;for(var l=0;l<v;l++)if(s[l]===t)return o}}},Yo=String,Jo=getBuiltIn("JSON","stringify"),Xo=W(/./.exec),Zo=W("".charAt),en=W("".charCodeAt),tn=W("".replace),rn=W(1..toString),on=/[\uD800-\uDFFF]/g,nn=/^[\uD800-\uDBFF]$/,sn=/^[\uDC00-\uDFFF]$/,an=!Ye||fails((function(){var t=getBuiltIn("Symbol")();return"[null]"!=Jo([t])||"{}"!=Jo({a:t})||"{}"!=Jo(Object(t))})),ln=fails((function(){return'"\\udf06\\ud834"'!==Jo("\udf06\ud834")||'"\\udead"'!==Jo("\udead")})),stringifyWithSymbolsFix=function(t,o){var s=Wo(arguments),l=getJsonReplacerFunction(o);if(ke(l)||void 0!==t&&!tt(t))return s[1]=function(t,o){if(ke(l)&&(o=_(l,this,Yo(t),o)),!tt(o))return o},Ko(Jo,null,s)},fixIllFormed=function(t,o,s){var l=Zo(s,o-1),h=Zo(s,o+1);return Xo(nn,t)&&!Xo(sn,h)||Xo(sn,t)&&!Xo(nn,l)?"\\u"+rn(en(t,0),16):t};Jo&&_export({target:"JSON",stat:!0,arity:3,forced:an||ln},{stringify:function stringify(t,o,s){var l=Wo(arguments),h=Ko(an?stringifyWithSymbolsFix:Jo,null,l);return ln&&"string"==typeof h?tn(h,on,fixIllFormed):h}});var cn=!Ye||fails((function(){mr.f(1)}));_export({target:"Object",stat:!0,forced:cn},{getOwnPropertySymbols:function getOwnPropertySymbols(t){var o=mr.f;return o?o(toObject(t)):[]}});var dn=l.Symbol,un=dn&&dn.prototype;if(h&&ke(dn)&&(!("description"in un)||void 0!==dn().description)){var hn={},pn=function Symbol(){var t=arguments.length<1||void 0===arguments[0]?void 0:toString_1(arguments[0]),o=Pe(un,this)?new dn(t):void 0===t?dn():dn(t);return""===t&&(hn[o]=!0),o};copyConstructorProperties$1(pn,dn),pn.prototype=un,un.constructor=pn;var fn="Symbol(test)"==String(dn("test")),gn=W(un.valueOf),vn=W(un.toString),mn=/^Symbol\((.*)\)[^)]+$/,bn=W("".replace),yn=W("".slice);defineBuiltInAccessor(un,"description",{configurable:!0,get:function description(){var t=gn(this);if(ht(hn,t))return"";var o=vn(t),s=fn?yn(o,7,-1):bn(o,mn,"$1");return""===s?void 0:s}}),_export({global:!0,constructor:!0,forced:!0},{Symbol:pn})}wellKnownSymbolDefine("asyncIterator"),wellKnownSymbolDefine("hasInstance"),wellKnownSymbolDefine("isConcatSpreadable"),wellKnownSymbolDefine("iterator"),wellKnownSymbolDefine("match"),wellKnownSymbolDefine("matchAll"),wellKnownSymbolDefine("replace"),wellKnownSymbolDefine("search"),wellKnownSymbolDefine("species"),wellKnownSymbolDefine("split"),wellKnownSymbolDefine("toPrimitive"),symbolDefineToPrimitive(),wellKnownSymbolDefine("toStringTag"),setToStringTag(getBuiltIn("Symbol"),"Symbol"),wellKnownSymbolDefine("unscopables");var wn=String,_n=TypeError,aPossiblePrototype=function(t){if("object"==typeof t||ke(t))return t;throw _n("Can't set "+wn(t)+" as a prototype")},Cn=Object.setPrototypeOf||("__proto__"in{}?function(){var t,o=!1,s={};try{t=function(t,o,s){try{return W(aCallable(Object.getOwnPropertyDescriptor(t,o)[s]))}catch(t){}}(Object.prototype,"__proto__","set"),t(s,[]),o=s instanceof Array}catch(t){}return function setPrototypeOf(s,l){return anObject(s),aPossiblePrototype(l),o?t(s,l):s.__proto__=l,s}}():void 0),kn=Lt.f,proxyAccessor=function(t,o,s){s in t||kn(t,s,{configurable:!0,get:function(){return o[s]},set:function(t){o[s]=t}})},inheritIfRequired=function(t,o,s){var l,h;return Cn&&ke(l=o.constructor)&&l!==s&&Ee(h=l.prototype)&&h!==s.prototype&&Cn(t,h),t},normalizeStringArgument=function(t,o){return void 0===t?arguments.length<2?"":o:toString_1(t)},installErrorCause=function(t,o){Ee(o)&&"cause"in o&&Ft(t,"cause",o.cause)},Tn=Error,Sn=W("".replace),xn=String(Tn("zxcasd").stack),En=/\n\s*at [^:]*:[^\n]*/,In=En.test(xn),errorStackClear=function(t,o){if(In&&"string"==typeof t&&!Tn.prepareStackTrace)for(;o--;)t=Sn(t,En,"");return t},An=!fails((function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",createPropertyDescriptor(1,7)),7!==t.stack)})),Pn=Error.captureStackTrace,errorStackInstall=function(t,o,s,l){An&&(Pn?Pn(t,o):Ft(t,"stack",errorStackClear(s,l)))},wrapErrorConstructorWithCause=function(t,o,s,l){var v="stackTraceLimit",m=l?2:1,_=t.split("."),R=_[_.length-1],$=getBuiltIn.apply(null,_);if($){var B=$.prototype;if(ht(B,"cause")&&delete B.cause,!s)return $;var q=getBuiltIn("Error"),j=o((function(t,o){var s=normalizeStringArgument(l?o:t,void 0),h=l?new $(t):new $;return void 0!==s&&Ft(h,"message",s),errorStackInstall(h,j,h.stack,2),this&&Pe(B,this)&&inheritIfRequired(h,this,j),arguments.length>m&&installErrorCause(h,arguments[m]),h}));j.prototype=B,"Error"!==R?Cn?Cn(j,q):copyConstructorProperties$1(j,q,{name:!0}):h&&v in $&&(proxyAccessor(j,$,v),proxyAccessor(j,$,"prepareStackTrace")),copyConstructorProperties$1(j,$);try{B.name!==R&&Ft(B,"name",R),B.constructor=j}catch(t){}return j}},Rn="WebAssembly",On=l[Rn],$n=7!==Error("e",{cause:7}).cause,exportGlobalErrorCauseWrapper=function(t,o){var s={};s[t]=wrapErrorConstructorWithCause(t,o,$n),_export({global:!0,constructor:!0,arity:1,forced:$n},s)},exportWebAssemblyErrorCauseWrapper=function(t,o){if(On&&On[t]){var s={};s[t]=wrapErrorConstructorWithCause(Rn+"."+t,o,$n),_export({target:Rn,stat:!0,constructor:!0,arity:1,forced:$n},s)}};exportGlobalErrorCauseWrapper("Error",(function(t){return function Error(o){return Ko(t,this,arguments)}})),exportGlobalErrorCauseWrapper("EvalError",(function(t){return function EvalError(o){return Ko(t,this,arguments)}})),exportGlobalErrorCauseWrapper("RangeError",(function(t){return function RangeError(o){return Ko(t,this,arguments)}})),exportGlobalErrorCauseWrapper("ReferenceError",(function(t){return function ReferenceError(o){return Ko(t,this,arguments)}})),exportGlobalErrorCauseWrapper("SyntaxError",(function(t){return function SyntaxError(o){return Ko(t,this,arguments)}})),exportGlobalErrorCauseWrapper("TypeError",(function(t){return function TypeError(o){return Ko(t,this,arguments)}})),exportGlobalErrorCauseWrapper("URIError",(function(t){return function URIError(o){return Ko(t,this,arguments)}})),exportWebAssemblyErrorCauseWrapper("CompileError",(function(t){return function CompileError(o){return Ko(t,this,arguments)}})),exportWebAssemblyErrorCauseWrapper("LinkError",(function(t){return function LinkError(o){return Ko(t,this,arguments)}})),exportWebAssemblyErrorCauseWrapper("RuntimeError",(function(t){return function RuntimeError(o){return Ko(t,this,arguments)}}));var Nn=Error.prototype.toString,Mn=fails((function(){if(h){var t=qr(Object.defineProperty({},"name",{get:function(){return this===t}}));if("true"!==Nn.call(t))return!0}return"2: 1"!==Nn.call({message:1,name:2})||"Error"!==Nn.call({})}))?function toString(){var t=anObject(this),o=normalizeStringArgument(t.name,"Error"),s=normalizeStringArgument(t.message);return o?s?o+": "+s:o:s}:Nn,Dn=Error.prototype;Dn.toString!==Mn&&defineBuiltIn(Dn,"toString",Mn);var Ln=!fails((function(){function F(){}return F.prototype.constructor=null,Object.getPrototypeOf(new F)!==F.prototype})),Fn=sharedKey("IE_PROTO"),Un=Object,Hn=Un.prototype,Bn=Ln?Un.getPrototypeOf:function(t){var o=toObject(t);if(ht(o,Fn))return o[Fn];var s=o.constructor;return ke(s)&&o instanceof s?s.prototype:o instanceof Un?Hn:null},qn={},jn=wellKnownSymbol("iterator"),zn=Array.prototype,isArrayIteratorMethod=function(t){return void 0!==t&&(qn.Array===t||zn[jn]===t)},Vn=wellKnownSymbol("iterator"),getIteratorMethod=function(t){if(!isNullOrUndefined(t))return getMethod$1(t,Vn)||getMethod$1(t,"@@iterator")||qn[$r(t)]},Gn=TypeError,getIterator=function(t,o){var s=arguments.length<2?getIteratorMethod(t):o;if(aCallable(s))return anObject(_(s,t));throw Gn(tryToString(t)+" is not iterable")},iteratorClose=function(t,o,s){var l,h;anObject(t);try{if(!(l=getMethod$1(t,"return"))){if("throw"===o)throw s;return s}l=_(l,t)}catch(t){h=!0,l=t}if("throw"===o)throw s;if(h)throw l;return anObject(l),s},Kn=TypeError,Result=function(t,o){this.stopped=t,this.result=o},Wn=Result.prototype,iterate=function(t,o,s){var l,h,v,m,R,$,B,q=s&&s.that,j=!(!s||!s.AS_ENTRIES),z=!(!s||!s.IS_RECORD),K=!(!s||!s.IS_ITERATOR),W=!(!s||!s.INTERRUPTED),Z=functionBindContext(o,q),stop=function(t){return l&&iteratorClose(l,"normal",t),new Result(!0,t)},callFn=function(t){return j?(anObject(t),W?Z(t[0],t[1],stop):Z(t[0],t[1])):W?Z(t,stop):Z(t)};if(z)l=t.iterator;else if(K)l=t;else{if(!(h=getIteratorMethod(t)))throw Kn(tryToString(t)+" is not iterable");if(isArrayIteratorMethod(h)){for(v=0,m=lengthOfArrayLike(t);m>v;v++)if((R=callFn(t[v]))&&Pe(Wn,R))return R;return new Result(!1)}l=getIterator(t,h)}for($=z?t.next:l.next;!(B=_($,l)).done;){try{R=callFn(B.value)}catch(t){iteratorClose(l,"throw",t)}if("object"==typeof R&&R&&Pe(Wn,R))return R}return new Result(!1)},Qn=wellKnownSymbol("toStringTag"),Yn=Error,Jn=[].push,Xn=function AggregateError(t,o){var s,l=Pe(Zn,this);Cn?s=Cn(Yn(),l?Bn(this):Zn):(s=l?this:qr(Zn),Ft(s,Qn,"Error")),void 0!==o&&Ft(s,"message",normalizeStringArgument(o)),errorStackInstall(s,Xn,s.stack,1),arguments.length>2&&installErrorCause(s,arguments[2]);var h=[];return iterate(t,Jn,{that:h}),Ft(s,"errors",h),s};Cn?Cn(Xn,Yn):copyConstructorProperties$1(Xn,Yn,{name:!0});var Zn=Xn.prototype=qr(Yn.prototype,{constructor:createPropertyDescriptor(1,Xn),message:createPropertyDescriptor(1,""),name:createPropertyDescriptor(1,"AggregateError")});_export({global:!0,constructor:!0,arity:2},{AggregateError:Xn});var ti="AggregateError",ci=getBuiltIn(ti),vi=!fails((function(){return 1!==ci([1]).errors[0]}))&&fails((function(){return 7!==ci([1],ti,{cause:7}).cause}));_export({global:!0,constructor:!0,arity:2,forced:vi},{AggregateError:wrapErrorConstructorWithCause(ti,(function(t){return function AggregateError(o,s){return Ko(t,this,arguments)}}),vi,!0)});var yi=Lt.f,_i=wellKnownSymbol("unscopables"),ki=Array.prototype;null==ki[_i]&&yi(ki,_i,{configurable:!0,value:qr(null)});var addToUnscopables=function(t){ki[_i][t]=!0};_export({target:"Array",proto:!0},{at:function at(t){var o=toObject(this),s=lengthOfArrayLike(o),l=toIntegerOrInfinity(t),h=l>=0?l:s+l;return h<0||h>=s?void 0:o[h]}}),addToUnscopables("at");var xi=TypeError,doesNotExceedSafeInteger=function(t){if(t>9007199254740991)throw xi("Maximum allowed index exceeded");return t},Ei=wellKnownSymbol("species"),arrayMethodHasSpeciesSupport=function(t){return ze>=51||!fails((function(){var o=[];return(o.constructor={})[Ei]=function(){return{foo:1}},1!==o[t](Boolean).foo}))},Ai=wellKnownSymbol("isConcatSpreadable"),$i=ze>=51||!fails((function(){var t=[];return t[Ai]=!1,t.concat()[0]!==t})),isConcatSpreadable=function(t){if(!Ee(t))return!1;var o=t[Ai];return void 0!==o?!!o:eo(t)},Mi=!$i||!arrayMethodHasSpeciesSupport("concat");_export({target:"Array",proto:!0,arity:1,forced:Mi},{concat:function concat(t){var o,s,l,h,v,m=toObject(this),_=arraySpeciesCreate(m,0),R=0;for(o=-1,l=arguments.length;o<l;o++)if(isConcatSpreadable(v=-1===o?m:arguments[o]))for(h=lengthOfArrayLike(v),doesNotExceedSafeInteger(R+h),s=0;s<h;s++,R++)s in v&&createProperty(_,R,v[s]);else doesNotExceedSafeInteger(R+1),createProperty(_,R++,v);return _.length=R,_}});var Di=TypeError,deletePropertyOrThrow=function(t,o){if(!delete t[o])throw Di("Cannot delete property "+tryToString(o)+" of "+tryToString(t))},Li=Math.min,Fi=[].copyWithin||function copyWithin(t,o){var s=toObject(this),l=lengthOfArrayLike(s),h=toAbsoluteIndex(t,l),v=toAbsoluteIndex(o,l),m=arguments.length>2?arguments[2]:void 0,_=Li((void 0===m?l:toAbsoluteIndex(m,l))-v,l-h),R=1;for(v<h&&h<v+_&&(R=-1,v+=_-1,h+=_-1);_-- >0;)v in s?s[h]=s[v]:deletePropertyOrThrow(s,h),h+=R,v+=R;return s};_export({target:"Array",proto:!0},{copyWithin:Fi}),addToUnscopables("copyWithin");var arrayMethodIsStrict=function(t,o){var s=[][t];return!!s&&fails((function(){s.call(null,o||function(){return 1},1)}))},es=po.every,ts=arrayMethodIsStrict("every");_export({target:"Array",proto:!0,forced:!ts},{every:function every(t){return es(this,t,arguments.length>1?arguments[1]:void 0)}});var rs=function fill(t){for(var o=toObject(this),s=lengthOfArrayLike(o),l=arguments.length,h=toAbsoluteIndex(l>1?arguments[1]:void 0,s),v=l>2?arguments[2]:void 0,m=void 0===v?s:toAbsoluteIndex(v,s);m>h;)o[h++]=t;return o};_export({target:"Array",proto:!0},{fill:rs}),addToUnscopables("fill");var os=po.filter,ns=arrayMethodHasSpeciesSupport("filter");_export({target:"Array",proto:!0,forced:!ns},{filter:function filter(t){return os(this,t,arguments.length>1?arguments[1]:void 0)}});var ss=po.find,as="find",ls=!0;as in[]&&Array(1)[as]((function(){ls=!1})),_export({target:"Array",proto:!0,forced:ls},{find:function find(t){return ss(this,t,arguments.length>1?arguments[1]:void 0)}}),addToUnscopables(as);var cs=po.findIndex,ds="findIndex",us=!0;ds in[]&&Array(1)[ds]((function(){us=!1})),_export({target:"Array",proto:!0,forced:us},{findIndex:function findIndex(t){return cs(this,t,arguments.length>1?arguments[1]:void 0)}}),addToUnscopables(ds);var createMethod$5=function(t){var o=1==t;return function(s,l,h){for(var v,m=toObject(s),_=se(m),R=functionBindContext(l,h),$=lengthOfArrayLike(_);$-- >0;)if(R(v=_[$],$,m))switch(t){case 0:return v;case 1:return $}return o?-1:void 0}},hs={findLast:createMethod$5(0),findLastIndex:createMethod$5(1)},ps=hs.findLast;_export({target:"Array",proto:!0},{findLast:function findLast(t){return ps(this,t,arguments.length>1?arguments[1]:void 0)}}),addToUnscopables("findLast");var fs=hs.findLastIndex;_export({target:"Array",proto:!0},{findLastIndex:function findLastIndex(t){return fs(this,t,arguments.length>1?arguments[1]:void 0)}}),addToUnscopables("findLastIndex");var flattenIntoArray=function(t,o,s,l,h,v,m,_){for(var R,$,B=h,q=0,j=!!m&&functionBindContext(m,_);q<l;)q in s&&(R=j?j(s[q],q,o):s[q],v>0&&eo(R)?($=lengthOfArrayLike(R),B=flattenIntoArray(t,o,R,$,B,v-1)-1):(doesNotExceedSafeInteger(B+1),t[B]=R),B++),q++;return B},gs=flattenIntoArray;_export({target:"Array",proto:!0},{flat:function flat(){var t=arguments.length?arguments[0]:void 0,o=toObject(this),s=lengthOfArrayLike(o),l=arraySpeciesCreate(o,0);return l.length=gs(l,o,o,s,0,void 0===t?1:toIntegerOrInfinity(t)),l}}),_export({target:"Array",proto:!0},{flatMap:function flatMap(t){var o,s=toObject(this),l=lengthOfArrayLike(s);return aCallable(t),(o=arraySpeciesCreate(s,0)).length=gs(o,s,s,l,0,1,t,arguments.length>1?arguments[1]:void 0),o}});var vs=po.forEach,ms=arrayMethodIsStrict("forEach")?[].forEach:function forEach(t){return vs(this,t,arguments.length>1?arguments[1]:void 0)};_export({target:"Array",proto:!0,forced:[].forEach!=ms},{forEach:ms});var callWithSafeIterationClosing=function(t,o,s,l){try{return l?o(anObject(s)[0],s[1]):o(s)}catch(o){iteratorClose(t,"throw",o)}},bs=Array,ys=function from(t){var o=toObject(t),s=lo(this),l=arguments.length,h=l>1?arguments[1]:void 0,v=void 0!==h;v&&(h=functionBindContext(h,l>2?arguments[2]:void 0));var m,R,$,B,q,j,z=getIteratorMethod(o),K=0;if(!z||this===bs&&isArrayIteratorMethod(z))for(m=lengthOfArrayLike(o),R=s?new this(m):bs(m);m>K;K++)j=v?h(o[K],K):o[K],createProperty(R,K,j);else for(q=(B=getIterator(o,z)).next,R=s?new this:[];!($=_(q,B)).done;K++)j=v?callWithSafeIterationClosing(B,h,[$.value,K],!0):$.value,createProperty(R,K,j);return R.length=K,R},ws=wellKnownSymbol("iterator"),_s=!1;try{var Cs=0,ks={next:function(){return{done:!!Cs++}},return:function(){_s=!0}};ks[ws]=function(){return this},Array.from(ks,(function(){throw 2}))}catch(t){}var checkCorrectnessOfIteration=function(t,o){if(!o&&!_s)return!1;var s=!1;try{var l={};l[ws]=function(){return{next:function(){return{done:s=!0}}}},t(l)}catch(t){}return s},Ts=!checkCorrectnessOfIteration((function(t){Array.from(t)}));_export({target:"Array",stat:!0,forced:Ts},{from:ys});var Ss=ur.includes,xs=fails((function(){return!Array(1).includes()}));_export({target:"Array",proto:!0,forced:xs},{includes:function includes(t){return Ss(this,t,arguments.length>1?arguments[1]:void 0)}}),addToUnscopables("includes");var Es=ur.indexOf,Is=functionUncurryThisClause([].indexOf),As=!!Is&&1/Is([1],1,-0)<0,Ps=As||!arrayMethodIsStrict("indexOf");_export({target:"Array",proto:!0,forced:Ps},{indexOf:function indexOf(t){var o=arguments.length>1?arguments[1]:void 0;return As?Is(this,t,o)||0:Es(this,t,o)}}),_export({target:"Array",stat:!0},{isArray:eo});var Rs,Os,$s,Ns=wellKnownSymbol("iterator"),Ms=!1;[].keys&&("next"in($s=[].keys())?(Os=Bn(Bn($s)))!==Object.prototype&&(Rs=Os):Ms=!0);var Ds=!Ee(Rs)||fails((function(){var t={};return Rs[Ns].call(t)!==t}));Ds&&(Rs={}),ke(Rs[Ns])||defineBuiltIn(Rs,Ns,(function(){return this}));var Ls={IteratorPrototype:Rs,BUGGY_SAFARI_ITERATORS:Ms},Fs=Ls.IteratorPrototype,returnThis$1=function(){return this},iteratorCreateConstructor=function(t,o,s,l){var h=o+" Iterator";return t.prototype=qr(Fs,{next:createPropertyDescriptor(+!l,s)}),setToStringTag(t,h,!1),qn[h]=returnThis$1,t},Us=qt.PROPER,Hs=qt.CONFIGURABLE,Bs=Ls.IteratorPrototype,qs=Ls.BUGGY_SAFARI_ITERATORS,js=wellKnownSymbol("iterator"),zs="keys",Vs="values",Gs="entries",returnThis=function(){return this},iteratorDefine=function(t,o,s,l,h,v,m){iteratorCreateConstructor(s,o,l);var R,$,B,getIterationMethod=function(t){if(t===h&&W)return W;if(!qs&&t in z)return z[t];switch(t){case zs:return function keys(){return new s(this,t)};case Vs:return function values(){return new s(this,t)};case Gs:return function entries(){return new s(this,t)}}return function(){return new s(this)}},q=o+" Iterator",j=!1,z=t.prototype,K=z[js]||z["@@iterator"]||h&&z[h],W=!qs&&K||getIterationMethod(h),Z="Array"==o&&z.entries||K;if(Z&&(R=Bn(Z.call(new t)))!==Object.prototype&&R.next&&(Bn(R)!==Bs&&(Cn?Cn(R,Bs):ke(R[js])||defineBuiltIn(R,js,returnThis)),setToStringTag(R,q,!0)),Us&&h==Vs&&K&&K.name!==Vs&&(Hs?Ft(z,"name",Vs):(j=!0,W=function values(){return _(K,this)})),h)if($={values:getIterationMethod(Vs),keys:v?W:getIterationMethod(zs),entries:getIterationMethod(Gs)},m)for(B in $)(qs||j||!(B in z))&&defineBuiltIn(z,B,$[B]);else _export({target:o,proto:!0,forced:qs||j},$);return z[js]!==W&&defineBuiltIn(z,js,W,{name:h}),qn[o]=W,$},createIterResultObject=function(t,o){return{value:t,done:o}},Ks=Lt.f,Ws="Array Iterator",Qs=or.set,Ys=or.getterFor(Ws),Js=iteratorDefine(Array,"Array",(function(t,o){Qs(this,{type:Ws,target:toIndexedObject(t),index:0,kind:o})}),(function(){var t=Ys(this),o=t.target,s=t.kind,l=t.index++;return!o||l>=o.length?(t.target=void 0,createIterResultObject(void 0,!0)):createIterResultObject("keys"==s?l:"values"==s?o[l]:[l,o[l]],!1)}),"values"),Xs=qn.Arguments=qn.Array;if(addToUnscopables("keys"),addToUnscopables("values"),addToUnscopables("entries"),h&&"values"!==Xs.name)try{Ks(Xs,"name",{value:"values"})}catch(t){}var Zs=W([].join),ea=se!=Object||!arrayMethodIsStrict("join",",");_export({target:"Array",proto:!0,forced:ea},{join:function join(t){return Zs(toIndexedObject(this),void 0===t?",":t)}});var oa=Math.min,na=[].lastIndexOf,aa=!!na&&1/[1].lastIndexOf(1,-0)<0,la=arrayMethodIsStrict("lastIndexOf"),ca=aa||!la?function lastIndexOf(t){if(aa)return Ko(na,this,arguments)||0;var o=toIndexedObject(this),s=lengthOfArrayLike(o),l=s-1;for(arguments.length>1&&(l=oa(l,toIntegerOrInfinity(arguments[1]))),l<0&&(l=s+l);l>=0;l--)if(l in o&&o[l]===t)return l||0;return-1}:na;_export({target:"Array",proto:!0,forced:ca!==[].lastIndexOf},{lastIndexOf:ca});var ha=po.map,pa=arrayMethodHasSpeciesSupport("map");_export({target:"Array",proto:!0,forced:!pa},{map:function map(t){return ha(this,t,arguments.length>1?arguments[1]:void 0)}});var ga=Array,va=fails((function(){function F(){}return!(ga.of.call(F)instanceof F)}));_export({target:"Array",stat:!0,forced:va},{of:function of(){for(var t=0,o=arguments.length,s=new(lo(this)?this:ga)(o);o>t;)createProperty(s,t,arguments[t++]);return s.length=o,s}});var ma=TypeError,_a=Object.getOwnPropertyDescriptor,Ta=h&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}()?function(t,o){if(eo(t)&&!_a(t,"length").writable)throw ma("Cannot set read only .length");return t.length=o}:function(t,o){return t.length=o},$a=fails((function(){return 4294967297!==[].push.call({length:4294967296},1)}))||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}}();_export({target:"Array",proto:!0,arity:1,forced:$a},{push:function push(t){var o=toObject(this),s=lengthOfArrayLike(o),l=arguments.length;doesNotExceedSafeInteger(s+l);for(var h=0;h<l;h++)o[s]=arguments[h],s++;return Ta(o,s),s}});var Fa=TypeError,createMethod$4=function(t){return function(o,s,l,h){aCallable(s);var v=toObject(o),m=se(v),_=lengthOfArrayLike(v),R=t?_-1:0,$=t?-1:1;if(l<2)for(;;){if(R in m){h=m[R],R+=$;break}if(R+=$,t?R<0:_<=R)throw Fa("Reduce of empty array with no initial value")}for(;t?R>=0:_>R;R+=$)R in m&&(h=s(h,m[R],R,v));return h}},Ua={left:createMethod$4(!1),right:createMethod$4(!0)},qa="undefined"!=typeof process&&"process"==classofRaw(process),Ka=Ua.left,Wa=!qa&&ze>79&&ze<83||!arrayMethodIsStrict("reduce");_export({target:"Array",proto:!0,forced:Wa},{reduce:function reduce(t){var o=arguments.length;return Ka(this,t,o,o>1?arguments[1]:void 0)}});var el=Ua.right,tl=!qa&&ze>79&&ze<83||!arrayMethodIsStrict("reduceRight");_export({target:"Array",proto:!0,forced:tl},{reduceRight:function reduceRight(t){return el(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}});var rl=W([].reverse),ol=[1,2];_export({target:"Array",proto:!0,forced:String(ol)===String(ol.reverse())},{reverse:function reverse(){return eo(this)&&(this.length=this.length),rl(this)}});var nl=arrayMethodHasSpeciesSupport("slice"),il=wellKnownSymbol("species"),sl=Array,al=Math.max;_export({target:"Array",proto:!0,forced:!nl},{slice:function slice(t,o){var s,l,h,v=toIndexedObject(this),m=lengthOfArrayLike(v),_=toAbsoluteIndex(t,m),R=toAbsoluteIndex(void 0===o?m:o,m);if(eo(v)&&(s=v.constructor,(lo(s)&&(s===sl||eo(s.prototype))||Ee(s)&&null===(s=s[il]))&&(s=void 0),s===sl||void 0===s))return Wo(v,_,R);for(l=new(void 0===s?sl:s)(al(R-_,0)),h=0;_<R;_++,h++)_ in v&&createProperty(l,h,v[_]);return l.length=h,l}});var ll=po.some,cl=arrayMethodIsStrict("some");_export({target:"Array",proto:!0,forced:!cl},{some:function some(t){return ll(this,t,arguments.length>1?arguments[1]:void 0)}});var dl=Math.floor,mergeSort=function(t,o){var s=t.length,l=dl(s/2);return s<8?insertionSort(t,o):merge(t,mergeSort(arraySliceSimple(t,0,l),o),mergeSort(arraySliceSimple(t,l),o),o)},insertionSort=function(t,o){for(var s,l,h=t.length,v=1;v<h;){for(l=v,s=t[v];l&&o(t[l-1],s)>0;)t[l]=t[--l];l!==v++&&(t[l]=s)}return t},merge=function(t,o,s,l){for(var h=o.length,v=s.length,m=0,_=0;m<h||_<v;)t[m+_]=m<h&&_<v?l(o[m],s[_])<=0?o[m++]:s[_++]:m<h?o[m++]:s[_++];return t},ul=mergeSort,hl=Re.match(/firefox\/(\d+)/i),pl=!!hl&&+hl[1],fl=/MSIE|Trident/.test(Re),gl=Re.match(/AppleWebKit\/(\d+)\./),vl=!!gl&&+gl[1],ml=[],bl=W(ml.sort),yl=W(ml.push),wl=fails((function(){ml.sort(void 0)})),_l=fails((function(){ml.sort(null)})),Cl=arrayMethodIsStrict("sort"),kl=!fails((function(){if(ze)return ze<70;if(!(pl&&pl>3)){if(fl)return!0;if(vl)return vl<603;var t,o,s,l,h="";for(t=65;t<76;t++){switch(o=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:s=3;break;case 68:case 71:s=4;break;default:s=2}for(l=0;l<47;l++)ml.push({k:o+l,v:s})}for(ml.sort((function(t,o){return o.v-t.v})),l=0;l<ml.length;l++)o=ml[l].k.charAt(0),h.charAt(h.length-1)!==o&&(h+=o);return"DGBEFHACIJK"!==h}}));_export({target:"Array",proto:!0,forced:wl||!_l||!Cl||!kl},{sort:function sort(t){void 0!==t&&aCallable(t);var o=toObject(this);if(kl)return void 0===t?bl(o):bl(o,t);var s,l,h=[],v=lengthOfArrayLike(o);for(l=0;l<v;l++)l in o&&yl(h,o[l]);for(ul(h,function(t){return function(o,s){return void 0===s?-1:void 0===o?1:void 0!==t?+t(o,s)||0:toString_1(o)>toString_1(s)?1:-1}}(t)),s=lengthOfArrayLike(h),l=0;l<s;)o[l]=h[l++];for(;l<v;)deletePropertyOrThrow(o,l++);return o}});var Tl=wellKnownSymbol("species"),setSpecies=function(t){var o=getBuiltIn(t);h&&o&&!o[Tl]&&defineBuiltInAccessor(o,Tl,{configurable:!0,get:function(){return this}})};setSpecies("Array");var Sl=arrayMethodHasSpeciesSupport("splice"),xl=Math.max,El=Math.min;_export({target:"Array",proto:!0,forced:!Sl},{splice:function splice(t,o){var s,l,h,v,m,_,R=toObject(this),$=lengthOfArrayLike(R),B=toAbsoluteIndex(t,$),q=arguments.length;for(0===q?s=l=0:1===q?(s=0,l=$-B):(s=q-2,l=El(xl(toIntegerOrInfinity(o),0),$-B)),doesNotExceedSafeInteger($+s-l),h=arraySpeciesCreate(R,l),v=0;v<l;v++)(m=B+v)in R&&createProperty(h,v,R[m]);if(h.length=l,s<l){for(v=B;v<$-l;v++)_=v+s,(m=v+l)in R?R[_]=R[m]:deletePropertyOrThrow(R,_);for(v=$;v>$-l+s;v--)deletePropertyOrThrow(R,v-1)}else if(s>l)for(v=$-l;v>B;v--)_=v+s-1,(m=v+l-1)in R?R[_]=R[m]:deletePropertyOrThrow(R,_);for(v=0;v<s;v++)R[v+B]=arguments[v+2];return Ta(R,$-l+s),h}});var arrayToReversed=function(t,o){for(var s=lengthOfArrayLike(t),l=new o(s),h=0;h<s;h++)l[h]=t[s-h-1];return l},Il=Array;_export({target:"Array",proto:!0},{toReversed:function toReversed(){return arrayToReversed(toIndexedObject(this),Il)}}),addToUnscopables("toReversed");var Al,arrayFromConstructorAndList=function(t,o){for(var s=0,l=lengthOfArrayLike(o),h=new t(l);l>s;)h[s]=o[s++];return h},Pl=Array,Rl=W((Al="Array",l[Al].prototype).sort);_export({target:"Array",proto:!0},{toSorted:function toSorted(t){void 0!==t&&aCallable(t);var o=toIndexedObject(this),s=arrayFromConstructorAndList(Pl,o);return Rl(s,t)}}),addToUnscopables("toSorted");var Ol=Array,$l=Math.max,Nl=Math.min;_export({target:"Array",proto:!0},{toSpliced:function toSpliced(t,o){var s,l,h,v,m=toIndexedObject(this),_=lengthOfArrayLike(m),R=toAbsoluteIndex(t,_),$=arguments.length,B=0;for(0===$?s=l=0:1===$?(s=0,l=_-R):(s=$-2,l=Nl($l(toIntegerOrInfinity(o),0),_-R)),h=doesNotExceedSafeInteger(_+s-l),v=Ol(h);B<R;B++)v[B]=m[B];for(;B<R+s;B++)v[B]=arguments[B-R+2];for(;B<h;B++)v[B]=m[B+l-s];return v}}),addToUnscopables("toSpliced"),addToUnscopables("flat"),addToUnscopables("flatMap");var Ml=1!==[].unshift(0)||!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}}();_export({target:"Array",proto:!0,arity:1,forced:Ml},{unshift:function unshift(t){var o=toObject(this),s=lengthOfArrayLike(o),l=arguments.length;if(l){doesNotExceedSafeInteger(s+l);for(var h=s;h--;){var v=h+l;h in o?o[v]=o[h]:deletePropertyOrThrow(o,v)}for(var m=0;m<l;m++)o[m]=arguments[m]}return Ta(o,s+l)}});var Dl=RangeError,arrayWith=function(t,o,s,l){var h=lengthOfArrayLike(t),v=toIntegerOrInfinity(s),m=v<0?h+v:v;if(m>=h||m<0)throw Dl("Incorrect index");for(var _=new o(h),R=0;R<h;R++)_[R]=R===m?l:t[R];return _},Ll=Array;_export({target:"Array",proto:!0},{with:function(t,o){return arrayWith(toIndexedObject(this),Ll,t,o)}});var Fl="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,defineBuiltIns=function(t,o,s){for(var l in o)defineBuiltIn(t,l,o[l],s);return t},Ul=TypeError,anInstance=function(t,o){if(Pe(o,t))return t;throw Ul("Incorrect invocation")},Hl=RangeError,toIndex=function(t){if(void 0===t)return 0;var o=toIntegerOrInfinity(t),s=toLength(o);if(o!==s)throw Hl("Wrong length or index");return s},Bl=Array,ql=Math.abs,jl=Math.pow,zl=Math.floor,Vl=Math.log,Gl=Math.LN2,ieee754_pack=function(t,o,s){var l,h,v,m=Bl(s),_=8*s-o-1,R=(1<<_)-1,$=R>>1,B=23===o?jl(2,-24)-jl(2,-77):0,q=t<0||0===t&&1/t<0?1:0,j=0;for((t=ql(t))!=t||t===1/0?(h=t!=t?1:0,l=R):(l=zl(Vl(t)/Gl),t*(v=jl(2,-l))<1&&(l--,v*=2),(t+=l+$>=1?B/v:B*jl(2,1-$))*v>=2&&(l++,v/=2),l+$>=R?(h=0,l=R):l+$>=1?(h=(t*v-1)*jl(2,o),l+=$):(h=t*jl(2,$-1)*jl(2,o),l=0));o>=8;)m[j++]=255&h,h/=256,o-=8;for(l=l<<o|h,_+=o;_>0;)m[j++]=255&l,l/=256,_-=8;return m[--j]|=128*q,m},ieee754_unpack=function(t,o){var s,l=t.length,h=8*l-o-1,v=(1<<h)-1,m=v>>1,_=h-7,R=l-1,$=t[R--],B=127&$;for($>>=7;_>0;)B=256*B+t[R--],_-=8;for(s=B&(1<<-_)-1,B>>=-_,_+=o;_>0;)s=256*s+t[R--],_-=8;if(0===B)B=1-m;else{if(B===v)return s?NaN:$?-1/0:1/0;s+=jl(2,o),B-=m}return($?-1:1)*s*jl(2,B-o)},Kl=vr.f,Wl=qt.PROPER,Ql=qt.CONFIGURABLE,Yl="ArrayBuffer",Jl="DataView",Xl="prototype",Zl="Wrong index",tc=or.getterFor(Yl),rc=or.getterFor(Jl),oc=or.set,nc=l[Yl],ic=nc,sc=ic&&ic[Xl],ac=l[Jl],cc=ac&&ac[Xl],dc=Object.prototype,uc=l.Array,hc=l.RangeError,pc=W(rs),fc=W([].reverse),gc=ieee754_pack,vc=ieee754_unpack,packInt8=function(t){return[255&t]},packInt16=function(t){return[255&t,t>>8&255]},packInt32=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},unpackInt32=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},packFloat32=function(t){return gc(t,23,4)},packFloat64=function(t){return gc(t,52,8)},addGetter=function(t,o,s){defineBuiltInAccessor(t[Xl],o,{configurable:!0,get:function(){return s(this)[o]}})},get$1=function(t,o,s,l){var h=toIndex(s),v=rc(t);if(h+o>v.byteLength)throw hc(Zl);var m=v.bytes,_=h+v.byteOffset,R=arraySliceSimple(m,_,_+o);return l?R:fc(R)},set$2=function(t,o,s,l,h,v){var m=toIndex(s),_=rc(t);if(m+o>_.byteLength)throw hc(Zl);for(var R=_.bytes,$=m+_.byteOffset,B=l(+h),q=0;q<o;q++)R[$+q]=B[v?q:o-q-1]};if(Fl){var mc=Wl&&nc.name!==Yl;if(fails((function(){nc(1)}))&&fails((function(){new nc(-1)}))&&!fails((function(){return new nc,new nc(1.5),new nc(NaN),1!=nc.length||mc&&!Ql})))mc&&Ql&&Ft(nc,"name",Yl);else{(ic=function ArrayBuffer(t){return anInstance(this,sc),new nc(toIndex(t))})[Xl]=sc;for(var bc,yc=Kl(nc),wc=0;yc.length>wc;)(bc=yc[wc++])in ic||Ft(ic,bc,nc[bc]);sc.constructor=ic}Cn&&Bn(cc)!==dc&&Cn(cc,dc);var _c=new ac(new ic(2)),Cc=W(cc.setInt8);_c.setInt8(0,2147483648),_c.setInt8(1,2147483649),!_c.getInt8(0)&&_c.getInt8(1)||defineBuiltIns(cc,{setInt8:function setInt8(t,o){Cc(this,t,o<<24>>24)},setUint8:function setUint8(t,o){Cc(this,t,o<<24>>24)}},{unsafe:!0})}else sc=(ic=function ArrayBuffer(t){anInstance(this,sc);var o=toIndex(t);oc(this,{type:Yl,bytes:pc(uc(o),0),byteLength:o}),h||(this.byteLength=o,this.detached=!1)})[Xl],cc=(ac=function DataView(t,o,s){anInstance(this,cc),anInstance(t,sc);var l=tc(t),v=l.byteLength,m=toIntegerOrInfinity(o);if(m<0||m>v)throw hc("Wrong offset");if(m+(s=void 0===s?v-m:toLength(s))>v)throw hc("Wrong length");oc(this,{type:Jl,buffer:t,byteLength:s,byteOffset:m,bytes:l.bytes}),h||(this.buffer=t,this.byteLength=s,this.byteOffset=m)})[Xl],h&&(addGetter(ic,"byteLength",tc),addGetter(ac,"buffer",rc),addGetter(ac,"byteLength",rc),addGetter(ac,"byteOffset",rc)),defineBuiltIns(cc,{getInt8:function getInt8(t){return get$1(this,1,t)[0]<<24>>24},getUint8:function getUint8(t){return get$1(this,1,t)[0]},getInt16:function getInt16(t){var o=get$1(this,2,t,arguments.length>1?arguments[1]:void 0);return(o[1]<<8|o[0])<<16>>16},getUint16:function getUint16(t){var o=get$1(this,2,t,arguments.length>1?arguments[1]:void 0);return o[1]<<8|o[0]},getInt32:function getInt32(t){return unpackInt32(get$1(this,4,t,arguments.length>1?arguments[1]:void 0))},getUint32:function getUint32(t){return unpackInt32(get$1(this,4,t,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function getFloat32(t){return vc(get$1(this,4,t,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function getFloat64(t){return vc(get$1(this,8,t,arguments.length>1?arguments[1]:void 0),52)},setInt8:function setInt8(t,o){set$2(this,1,t,packInt8,o)},setUint8:function setUint8(t,o){set$2(this,1,t,packInt8,o)},setInt16:function setInt16(t,o){set$2(this,2,t,packInt16,o,arguments.length>2?arguments[2]:void 0)},setUint16:function setUint16(t,o){set$2(this,2,t,packInt16,o,arguments.length>2?arguments[2]:void 0)},setInt32:function setInt32(t,o){set$2(this,4,t,packInt32,o,arguments.length>2?arguments[2]:void 0)},setUint32:function setUint32(t,o){set$2(this,4,t,packInt32,o,arguments.length>2?arguments[2]:void 0)},setFloat32:function setFloat32(t,o){set$2(this,4,t,packFloat32,o,arguments.length>2?arguments[2]:void 0)},setFloat64:function setFloat64(t,o){set$2(this,8,t,packFloat64,o,arguments.length>2?arguments[2]:void 0)}});setToStringTag(ic,Yl),setToStringTag(ac,Jl);var kc={ArrayBuffer:ic,DataView:ac},xc="ArrayBuffer",Ec=kc[xc],Ac=l[xc];_export({global:!0,constructor:!0,forced:Ac!==Ec},{ArrayBuffer:Ec}),setSpecies(xc);var Oc,Nc,Mc,Dc=or.enforce,Lc=or.get,qc=l.Int8Array,jc=qc&&qc.prototype,zc=l.Uint8ClampedArray,Kc=zc&&zc.prototype,Qc=qc&&Bn(qc),Jc=jc&&Bn(jc),td=Object.prototype,rd=l.TypeError,od=wellKnownSymbol("toStringTag"),sd=uid("TYPED_ARRAY_TAG"),ld="TypedArrayConstructor",cd=Fl&&!!Cn&&"Opera"!==$r(l.opera),pd=!1,bd={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},yd={BigInt64Array:8,BigUint64Array:8},getTypedArrayConstructor$4=function(t){var o=Bn(t);if(Ee(o)){var s=Lc(o);return s&&ht(s,ld)?s[ld]:getTypedArrayConstructor$4(o)}},isTypedArray=function(t){if(!Ee(t))return!1;var o=$r(t);return ht(bd,o)||ht(yd,o)};for(Oc in bd)(Mc=(Nc=l[Oc])&&Nc.prototype)?Dc(Mc)[ld]=Nc:cd=!1;for(Oc in yd)(Mc=(Nc=l[Oc])&&Nc.prototype)&&(Dc(Mc)[ld]=Nc);if((!cd||!ke(Qc)||Qc===Function.prototype)&&(Qc=function TypedArray(){throw rd("Incorrect invocation")},cd))for(Oc in bd)l[Oc]&&Cn(l[Oc],Qc);if((!cd||!Jc||Jc===td)&&(Jc=Qc.prototype,cd))for(Oc in bd)l[Oc]&&Cn(l[Oc].prototype,Jc);if(cd&&Bn(Kc)!==Jc&&Cn(Kc,Jc),h&&!ht(Jc,od))for(Oc in pd=!0,defineBuiltInAccessor(Jc,od,{configurable:!0,get:function(){return Ee(this)?this[sd]:void 0}}),bd)l[Oc]&&Ft(l[Oc],sd,Oc);var wd={NATIVE_ARRAY_BUFFER_VIEWS:cd,TYPED_ARRAY_TAG:pd&&sd,aTypedArray:function(t){if(isTypedArray(t))return t;throw rd("Target is not a typed array")},aTypedArrayConstructor:function(t){if(ke(t)&&(!Cn||Pe(Qc,t)))return t;throw rd(tryToString(t)+" is not a typed array constructor")},exportTypedArrayMethod:function(t,o,s,v){if(h){if(s)for(var m in bd){var _=l[m];if(_&&ht(_.prototype,t))try{delete _.prototype[t]}catch(s){try{_.prototype[t]=o}catch(t){}}}Jc[t]&&!s||defineBuiltIn(Jc,t,s?o:cd&&jc[t]||o,v)}},exportTypedArrayStaticMethod:function(t,o,s){var v,m;if(h){if(Cn){if(s)for(v in bd)if((m=l[v])&&ht(m,t))try{delete m[t]}catch(t){}if(Qc[t]&&!s)return;try{return defineBuiltIn(Qc,t,s?o:cd&&Qc[t]||o)}catch(t){}}for(v in bd)!(m=l[v])||m[t]&&!s||defineBuiltIn(m,t,o)}},getTypedArrayConstructor:getTypedArrayConstructor$4,isView:function isView(t){if(!Ee(t))return!1;var o=$r(t);return"DataView"===o||ht(bd,o)||ht(yd,o)},isTypedArray:isTypedArray,TypedArray:Qc,TypedArrayPrototype:Jc};_export({target:"ArrayBuffer",stat:!0,forced:!wd.NATIVE_ARRAY_BUFFER_VIEWS},{isView:wd.isView});var _d=TypeError,aConstructor=function(t){if(lo(t))return t;throw _d(tryToString(t)+" is not a constructor")},kd=wellKnownSymbol("species"),speciesConstructor=function(t,o){var s,l=anObject(t).constructor;return void 0===l||isNullOrUndefined(s=anObject(l)[kd])?o:aConstructor(s)},xd=kc.ArrayBuffer,Ed=kc.DataView,Id=Ed.prototype,Ad=functionUncurryThisClause(xd.prototype.slice),Pd=functionUncurryThisClause(Id.getUint8),Od=functionUncurryThisClause(Id.setUint8),$d=fails((function(){return!new xd(2).slice(1,void 0).byteLength}));_export({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:$d},{slice:function slice(t,o){if(Ad&&void 0===o)return Ad(anObject(this),t);for(var s=anObject(this).byteLength,l=toAbsoluteIndex(t,s),h=toAbsoluteIndex(void 0===o?s:o,s),v=new(speciesConstructor(this,xd))(toLength(h-l)),m=new Ed(this),_=new Ed(v),R=0;l<h;)Od(_,R++,Pd(m,l++));return v}}),_export({global:!0,constructor:!0,forced:!Fl},{DataView:kc.DataView});var Md=fails((function(){return 120!==new Date(16e11).getYear()})),Dd=W(Date.prototype.getFullYear);_export({target:"Date",proto:!0,forced:Md},{getYear:function getYear(){return Dd(this)-1900}});var Ld=Date,Fd=W(Ld.prototype.getTime);_export({target:"Date",stat:!0},{now:function now(){return Fd(new Ld)}});var Ud=Date.prototype,Hd=W(Ud.getTime),Bd=W(Ud.setFullYear);_export({target:"Date",proto:!0},{setYear:function setYear(t){Hd(this);var o=toIntegerOrInfinity(t);return Bd(this,0<=o&&o<=99?o+1900:o)}}),_export({target:"Date",proto:!0},{toGMTString:Date.prototype.toUTCString});var Vd=RangeError,Kd=function repeat(t){var o=toString_1(requireObjectCoercible(this)),s="",l=toIntegerOrInfinity(t);if(l<0||l==1/0)throw Vd("Wrong number of repetitions");for(;l>0;(l>>>=1)&&(o+=o))1&l&&(s+=o);return s},Jd=W(Kd),Xd=W("".slice),eu=Math.ceil,createMethod$3=function(t){return function(o,s,l){var h,v,m=toString_1(requireObjectCoercible(o)),_=toLength(s),R=m.length,$=void 0===l?" ":toString_1(l);return _<=R||""==$?m:((v=Jd($,eu((h=_-R)/$.length))).length>h&&(v=Xd(v,0,h)),t?m+v:v+m)}},tu={start:createMethod$3(!1),end:createMethod$3(!0)},ru=tu.start,ou=RangeError,nu=isFinite,iu=Math.abs,su=Date.prototype,au=su.toISOString,lu=W(su.getTime),cu=W(su.getUTCDate),du=W(su.getUTCFullYear),uu=W(su.getUTCHours),hu=W(su.getUTCMilliseconds),pu=W(su.getUTCMinutes),fu=W(su.getUTCMonth),gu=W(su.getUTCSeconds),vu=fails((function(){return"0385-07-25T07:06:39.999Z"!=au.call(new Date(-50000000000001))}))||!fails((function(){au.call(new Date(NaN))}))?function toISOString(){if(!nu(lu(this)))throw ou("Invalid time value");var t=this,o=du(t),s=hu(t),l=o<0?"-":o>9999?"+":"";return l+ru(iu(o),l?6:4,0)+"-"+ru(fu(t)+1,2,0)+"-"+ru(cu(t),2,0)+"T"+ru(uu(t),2,0)+":"+ru(pu(t),2,0)+":"+ru(gu(t),2,0)+"."+ru(s,3,0)+"Z"}:au;_export({target:"Date",proto:!0,forced:Date.prototype.toISOString!==vu},{toISOString:vu});var mu=fails((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}));_export({target:"Date",proto:!0,arity:1,forced:mu},{toJSON:function toJSON(t){var o=toObject(this),s=toPrimitive(o,"number");return"number"!=typeof s||isFinite(s)?o.toISOString():null}});var bu=TypeError,yu=wellKnownSymbol("toPrimitive"),wu=Date.prototype;ht(wu,yu)||defineBuiltIn(wu,yu,(function(t){if(anObject(this),"string"===t||"default"===t)t="string";else if("number"!==t)throw bu("Incorrect hint");return ordinaryToPrimitive(this,t)}));var _u=Date.prototype,Cu="Invalid Date",ku="toString",Tu=W(_u[ku]),Su=W(_u.getTime);String(new Date(NaN))!=Cu&&defineBuiltIn(_u,ku,(function toString(){var t=Su(this);return t==t?Tu(this):Cu}));var xu=W("".charAt),Eu=W("".charCodeAt),Iu=W(/./.exec),Au=W(1..toString),Pu=W("".toUpperCase),Ru=/[\w*+\-./@]/,hex$1=function(t,o){for(var s=Au(t,16);s.length<o;)s="0"+s;return s};_export({global:!0},{escape:function escape(t){for(var o,s,l=toString_1(t),h="",v=l.length,m=0;m<v;)o=xu(l,m++),Iu(Ru,o)?h+=o:h+=(s=Eu(o,0))<256?"%"+hex$1(s,2):"%u"+Pu(hex$1(s,4));return h}});var Ou=Function,$u=W([].concat),Nu=W([].join),Mu={},construct=function(t,o,s){if(!ht(Mu,o)){for(var l=[],h=0;h<o;h++)l[h]="a["+h+"]";Mu[o]=Ou("C,a","return new C("+Nu(l,",")+")")}return Mu[o](t,s)},Du=v?Ou.bind:function bind(t){var o=aCallable(this),s=o.prototype,l=Wo(arguments,1),h=function bound(){var s=$u(l,Wo(arguments));return this instanceof h?construct(o,s.length,s):o.apply(t,s)};return Ee(s)&&(h.prototype=s),h};_export({target:"Function",proto:!0,forced:Function.bind!==Du},{bind:Du});var Lu=wellKnownSymbol("hasInstance"),Fu=Function.prototype;Lu in Fu||Lt.f(Fu,Lu,{value:nr((function(t){if(!ke(this)||!Ee(t))return!1;var o=this.prototype;if(!Ee(o))return t instanceof this;for(;t=Bn(t);)if(o===t)return!0;return!1}),Lu)});var Uu=qt.EXISTS,Hu=Function.prototype,Bu=W(Hu.toString),qu=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,ju=W(qu.exec);h&&!Uu&&defineBuiltInAccessor(Hu,"name",{configurable:!0,get:function(){try{return ju(qu,Bu(this))[1]}catch(t){return""}}}),_export({global:!0,forced:l.globalThis!==l},{globalThis:l}),setToStringTag(l.JSON,"JSON",!0);var zu=fails((function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}})),Vu=Object.isExtensible,Gu=fails((function(){Vu(1)}))||zu?function isExtensible(t){return!!Ee(t)&&((!zu||"ArrayBuffer"!=classofRaw(t))&&(!Vu||Vu(t)))}:Vu,Ku=!fails((function(){return Object.isExtensible(Object.preventExtensions({}))})),Wu=createCommonjsModule((function(t){var o=Lt.f,s=!1,l=uid("meta"),h=0,setMetadata=function(t){o(t,l,{value:{objectID:"O"+h++,weakData:{}}})},v=t.exports={enable:function(){v.enable=function(){},s=!0;var t=vr.f,o=W([].splice),h={};h[l]=1,t(h).length&&(vr.f=function(s){for(var h=t(s),v=0,m=h.length;v<m;v++)if(h[v]===l){o(h,v,1);break}return h},_export({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:Kr.f}))},fastKey:function(t,o){if(!Ee(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!ht(t,l)){if(!Gu(t))return"F";if(!o)return"E";setMetadata(t)}return t[l].objectID},getWeakData:function(t,o){if(!ht(t,l)){if(!Gu(t))return!0;if(!o)return!1;setMetadata(t)}return t[l].weakData},onFreeze:function(t){return Ku&&s&&Gu(t)&&!ht(t,l)&&setMetadata(t),t}};Jt[l]=!0}));Wu.enable,Wu.fastKey,Wu.getWeakData,Wu.onFreeze;var collection=function(t,o,s){var h=-1!==t.indexOf("Map"),v=-1!==t.indexOf("Weak"),m=h?"set":"add",_=l[t],R=_&&_.prototype,$=_,B={},fixMethod=function(t){var o=W(R[t]);defineBuiltIn(R,t,"add"==t?function add(t){return o(this,0===t?0:t),this}:"delete"==t?function(t){return!(v&&!Ee(t))&&o(this,0===t?0:t)}:"get"==t?function get(t){return v&&!Ee(t)?void 0:o(this,0===t?0:t)}:"has"==t?function has(t){return!(v&&!Ee(t))&&o(this,0===t?0:t)}:function set(t,s){return o(this,0===t?0:t,s),this})};if(Sr(t,!ke(_)||!(v||R.forEach&&!fails((function(){(new _).entries().next()})))))$=s.getConstructor(o,t,h,m),Wu.enable();else if(Sr(t,!0)){var q=new $,j=q[m](v?{}:-0,1)!=q,z=fails((function(){q.has(1)})),K=checkCorrectnessOfIteration((function(t){new _(t)})),Z=!v&&fails((function(){for(var t=new _,o=5;o--;)t[m](o,o);return!t.has(-0)}));K||(($=o((function(t,o){anInstance(t,R);var s=inheritIfRequired(new _,t,$);return isNullOrUndefined(o)||iterate(o,s[m],{that:s,AS_ENTRIES:h}),s}))).prototype=R,R.constructor=$),(z||Z)&&(fixMethod("delete"),fixMethod("has"),h&&fixMethod("get")),(Z||j)&&fixMethod(m),v&&R.clear&&delete R.clear}return B[t]=$,_export({global:!0,constructor:!0,forced:$!=_},B),setToStringTag($,t),v||s.setStrong($,t,h),$},Qu=Wu.fastKey,Yu=or.set,Ju=or.getterFor,Xu={getConstructor:function(t,o,s,l){var v=t((function(t,v){anInstance(t,m),Yu(t,{type:o,index:qr(null),first:void 0,last:void 0,size:0}),h||(t.size=0),isNullOrUndefined(v)||iterate(v,t[l],{that:t,AS_ENTRIES:s})})),m=v.prototype,_=Ju(o),define=function(t,o,s){var l,v,m=_(t),R=getEntry(t,o);return R?R.value=s:(m.last=R={index:v=Qu(o,!0),key:o,value:s,previous:l=m.last,next:void 0,removed:!1},m.first||(m.first=R),l&&(l.next=R),h?m.size++:t.size++,"F"!==v&&(m.index[v]=R)),t},getEntry=function(t,o){var s,l=_(t),h=Qu(o);if("F"!==h)return l.index[h];for(s=l.first;s;s=s.next)if(s.key==o)return s};return defineBuiltIns(m,{clear:function clear(){for(var t=_(this),o=t.index,s=t.first;s;)s.removed=!0,s.previous&&(s.previous=s.previous.next=void 0),delete o[s.index],s=s.next;t.first=t.last=void 0,h?t.size=0:this.size=0},delete:function(t){var o=this,s=_(o),l=getEntry(o,t);if(l){var v=l.next,m=l.previous;delete s.index[l.index],l.removed=!0,m&&(m.next=v),v&&(v.previous=m),s.first==l&&(s.first=v),s.last==l&&(s.last=m),h?s.size--:o.size--}return!!l},forEach:function forEach(t){for(var o,s=_(this),l=functionBindContext(t,arguments.length>1?arguments[1]:void 0);o=o?o.next:s.first;)for(l(o.value,o.key,this);o&&o.removed;)o=o.previous},has:function has(t){return!!getEntry(this,t)}}),defineBuiltIns(m,s?{get:function get(t){var o=getEntry(this,t);return o&&o.value},set:function set(t,o){return define(this,0===t?0:t,o)}}:{add:function add(t){return define(this,t=0===t?0:t,t)}}),h&&defineBuiltInAccessor(m,"size",{configurable:!0,get:function(){return _(this).size}}),v},setStrong:function(t,o,s){var l=o+" Iterator",h=Ju(o),v=Ju(l);iteratorDefine(t,o,(function(t,o){Yu(this,{type:l,target:t,state:h(t),kind:o,last:void 0})}),(function(){for(var t=v(this),o=t.kind,s=t.last;s&&s.removed;)s=s.previous;return t.target&&(t.last=s=s?s.next:t.state.first)?createIterResultObject("keys"==o?s.key:"values"==o?s.value:[s.key,s.value],!1):(t.target=void 0,createIterResultObject(void 0,!0))}),s?"entries":"values",!s,!0),setSpecies(o)}};collection("Map",(function(t){return function Map(){return t(this,arguments.length?arguments[0]:void 0)}}),Xu);var Zu=Math.log,rh=Math.log1p||function log1p(t){var o=+t;return o>-1e-8&&o<1e-8?o-o*o/2:Zu(1+o)},sh=Math.acosh,lh=Math.log,vh=Math.sqrt,yh=Math.LN2,wh=!sh||710!=Math.floor(sh(Number.MAX_VALUE))||sh(1/0)!=1/0;_export({target:"Math",stat:!0,forced:wh},{acosh:function acosh(t){var o=+t;return o<1?NaN:o>94906265.62425156?lh(o)+yh:rh(o-1+vh(o-1)*vh(o+1))}});var _h=Math.asinh,Ch=Math.log,xh=Math.sqrt;var Eh=!(_h&&1/_h(0)>0);_export({target:"Math",stat:!0,forced:Eh},{asinh:function asinh(t){var o=+t;return isFinite(o)&&0!=o?o<0?-asinh(-o):Ch(o+xh(o*o+1)):o}});var Ih=Math.atanh,Ah=Math.log,Ph=!(Ih&&1/Ih(-0)<0);_export({target:"Math",stat:!0,forced:Ph},{atanh:function atanh(t){var o=+t;return 0==o?o:Ah((1+o)/(1-o))/2}});var Oh=Math.sign||function sign(t){var o=+t;return 0==o||o!=o?o:o<0?-1:1},Nh=Math.abs,Mh=Math.pow;_export({target:"Math",stat:!0},{cbrt:function cbrt(t){var o=+t;return Oh(o)*Mh(Nh(o),1/3)}});var Dh=Math.floor,Lh=Math.log,Fh=Math.LOG2E;_export({target:"Math",stat:!0},{clz32:function clz32(t){var o=t>>>0;return o?31-Dh(Lh(o+.5)*Fh):32}});var Uh=Math.expm1,zh=Math.exp,Gh=!Uh||Uh(10)>22025.465794806718||Uh(10)<22025.465794806718||-2e-17!=Uh(-2e-17)?function expm1(t){var o=+t;return 0==o?o:o>-1e-6&&o<1e-6?o+o*o/2:zh(o)-1}:Uh,Kh=Math.cosh,Qh=Math.abs,Yh=Math.E,Jh=!Kh||Kh(710)===1/0;_export({target:"Math",stat:!0,forced:Jh},{cosh:function cosh(t){var o=Gh(Qh(t)-1)+1;return(o+1/(o*Yh*Yh))*(Yh/2)}}),_export({target:"Math",stat:!0,forced:Gh!=Math.expm1},{expm1:Gh});var ep=Math.abs,tp=Math.pow,rp=tp(2,-52),op=tp(2,-23),np=tp(2,127)*(2-op),ip=tp(2,-126),sp=Math.fround||function fround(t){var o,s,l=+t,h=ep(l),v=Oh(l);return h<ip?v*function(t){return t+1/rp-1/rp}(h/ip/op)*ip*op:(s=(o=(1+op/rp)*h)-(o-h))>np||s!=s?v*(1/0):v*s};_export({target:"Math",stat:!0},{fround:sp});var ap=Math.hypot,lp=Math.abs,cp=Math.sqrt,dp=!!ap&&ap(1/0,NaN)!==1/0;_export({target:"Math",stat:!0,arity:2,forced:dp},{hypot:function hypot(t,o){for(var s,l,h=0,v=0,m=arguments.length,_=0;v<m;)_<(s=lp(arguments[v++]))?(h=h*(l=_/s)*l+1,_=s):h+=s>0?(l=s/_)*l:s;return _===1/0?1/0:_*cp(h)}});var up=Math.imul,hp=fails((function(){return-5!=up(4294967295,5)||2!=up.length}));_export({target:"Math",stat:!0,forced:hp},{imul:function imul(t,o){var s=65535,l=+t,h=+o,v=s&l,m=s&h;return 0|v*m+((s&l>>>16)*m+v*(s&h>>>16)<<16>>>0)}});var pp=Math.log,fp=Math.LOG10E,gp=Math.log10||function log10(t){return pp(t)*fp};_export({target:"Math",stat:!0},{log10:gp}),_export({target:"Math",stat:!0},{log1p:rh});var vp=Math.log,mp=Math.LN2;_export({target:"Math",stat:!0},{log2:function log2(t){return vp(t)/mp}}),_export({target:"Math",stat:!0},{sign:Oh});var bp=Math.abs,yp=Math.exp,wp=Math.E,_p=fails((function(){return-2e-17!=Math.sinh(-2e-17)}));_export({target:"Math",stat:!0,forced:_p},{sinh:function sinh(t){var o=+t;return bp(o)<1?(Gh(o)-Gh(-o))/2:(yp(o-1)-yp(-o-1))*(wp/2)}});var Cp=Math.exp;_export({target:"Math",stat:!0},{tanh:function tanh(t){var o=+t,s=Gh(o),l=Gh(-o);return s==1/0?1:l==1/0?-1:(s-l)/(Cp(o)+Cp(-o))}}),setToStringTag(Math,"Math",!0),_export({target:"Math",stat:!0},{trunc:ar});var kp=W(1..valueOf),Tp="\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff",Sp=W("".replace),xp=RegExp("^["+Tp+"]+"),Ep=RegExp("(^|[^"+Tp+"])["+Tp+"]+$"),createMethod$2=function(t){return function(o){var s=toString_1(requireObjectCoercible(o));return 1&t&&(s=Sp(s,xp,"")),2&t&&(s=Sp(s,Ep,"$1")),s}},Ip={start:createMethod$2(1),end:createMethod$2(2),trim:createMethod$2(3)},Ap=vr.f,Pp=xt.f,Rp=Lt.f,Op=Ip.trim,$p="Number",Np=l[$p];Qr[$p];var Mp=Np.prototype,Dp=l.TypeError,Lp=W("".slice),Fp=W("".charCodeAt),toNumeric=function(t){var o=toPrimitive(t,"number");return"bigint"==typeof o?o:toNumber(o)},toNumber=function(t){var o,s,l,h,v,m,_,R,$=toPrimitive(t,"number");if(tt($))throw Dp("Cannot convert a Symbol value to a number");if("string"==typeof $&&$.length>2)if($=Op($),43===(o=Fp($,0))||45===o){if(88===(s=Fp($,2))||120===s)return NaN}else if(48===o){switch(Fp($,1)){case 66:case 98:l=2,h=49;break;case 79:case 111:l=8,h=55;break;default:return+$}for(m=(v=Lp($,2)).length,_=0;_<m;_++)if((R=Fp(v,_))<48||R>h)return NaN;return parseInt(v,l)}return+$},Up=Sr($p,!Np(" 0o1")||!Np("0b1")||Np("+0x1")),calledWithNew=function(t){return Pe(Mp,t)&&fails((function(){kp(t)}))},Hp=function Number(t){var o=arguments.length<1?0:Np(toNumeric(t));return calledWithNew(this)?inheritIfRequired(Object(o),this,Hp):o};Hp.prototype=Mp,Up&&(Mp.constructor=Hp),_export({global:!0,constructor:!0,wrap:!0,forced:Up},{Number:Hp});Up&&function(t,o){for(var s,l=h?Ap(o):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),v=0;l.length>v;v++)ht(o,s=l[v])&&!ht(t,s)&&Rp(t,s,Pp(o,s))}(Qr[$p],Np),_export({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{EPSILON:Math.pow(2,-52)});var Bp=l.isFinite,qp=Number.isFinite||function isFinite(t){return"number"==typeof t&&Bp(t)};_export({target:"Number",stat:!0},{isFinite:qp});var jp=Math.floor,zp=Number.isInteger||function isInteger(t){return!Ee(t)&&isFinite(t)&&jp(t)===t};_export({target:"Number",stat:!0},{isInteger:zp}),_export({target:"Number",stat:!0},{isNaN:function isNaN(t){return t!=t}});var Vp=Math.abs;_export({target:"Number",stat:!0},{isSafeInteger:function isSafeInteger(t){return zp(t)&&Vp(t)<=9007199254740991}}),_export({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MAX_SAFE_INTEGER:9007199254740991}),_export({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MIN_SAFE_INTEGER:-9007199254740991});var Gp=Ip.trim,Kp=W("".charAt),Wp=l.parseFloat,Qp=l.Symbol,Yp=Qp&&Qp.iterator,Jp=1/Wp(Tp+"-0")!=-1/0||Yp&&!fails((function(){Wp(Object(Yp))}))?function parseFloat(t){var o=Gp(toString_1(t)),s=Wp(o);return 0===s&&"-"==Kp(o,0)?-0:s}:Wp;_export({target:"Number",stat:!0,forced:Number.parseFloat!=Jp},{parseFloat:Jp});var Xp=Ip.trim,Zp=l.parseInt,tf=l.Symbol,rf=tf&&tf.iterator,nf=/^[+-]?0x/i,sf=W(nf.exec),af=8!==Zp(Tp+"08")||22!==Zp(Tp+"0x16")||rf&&!fails((function(){Zp(Object(rf))}))?function parseInt(t,o){var s=Xp(toString_1(t));return Zp(s,o>>>0||(sf(nf,s)?16:10))}:Zp;_export({target:"Number",stat:!0,forced:Number.parseInt!=af},{parseInt:af});var cf=RangeError,df=String,pf=isFinite,bf=Math.abs,yf=Math.floor,wf=Math.pow,_f=Math.round,Cf=W(1..toExponential),Tf=W(Kd),xf=W("".slice),If="-6.9000e-11"===Cf(-69e-12,4)&&"1.25e+0"===Cf(1.255,2)&&"1.235e+4"===Cf(12345,3)&&"3e+1"===Cf(25,0),Af=!If||!(fails((function(){Cf(1,1/0)}))&&fails((function(){Cf(1,-1/0)})))||!!fails((function(){Cf(1/0,1/0),Cf(NaN,1/0)}));_export({target:"Number",proto:!0,forced:Af},{toExponential:function toExponential(t){var o=kp(this);if(void 0===t)return Cf(o);var s=toIntegerOrInfinity(t);if(!pf(o))return String(o);if(s<0||s>20)throw cf("Incorrect fraction digits");if(If)return Cf(o,s);var l="",h="",v=0,m="",_="";if(o<0&&(l="-",o=-o),0===o)v=0,h=Tf("0",s+1);else{var R=gp(o);v=yf(R);var $=0,B=wf(10,v-s);2*o>=(2*($=_f(o/B))+1)*B&&($+=1),$>=wf(10,s+1)&&($/=10,v+=1),h=df($)}return 0!==s&&(h=xf(h,0,1)+"."+xf(h,1)),0===v?(m="+",_="0"):(m=v>0?"+":"-",_=df(bf(v))),l+(h+="e"+m+_)}});var Of=RangeError,Nf=String,Df=Math.floor,Lf=W(Kd),Uf=W("".slice),Hf=W(1..toFixed),pow$1=function(t,o,s){return 0===o?s:o%2==1?pow$1(t,o-1,s*t):pow$1(t*t,o/2,s)},multiply=function(t,o,s){for(var l=-1,h=s;++l<6;)h+=o*t[l],t[l]=h%1e7,h=Df(h/1e7)},divide=function(t,o){for(var s=6,l=0;--s>=0;)l+=t[s],t[s]=Df(l/o),l=l%o*1e7},dataToString=function(t){for(var o=6,s="";--o>=0;)if(""!==s||0===o||0!==t[o]){var l=Nf(t[o]);s=""===s?l:s+Lf("0",7-l.length)+l}return s},Bf=fails((function(){return"0.000"!==Hf(8e-5,3)||"1"!==Hf(.9,0)||"1.25"!==Hf(1.255,2)||"1000000000000000128"!==Hf(0xde0b6b3a7640080,0)}))||!fails((function(){Hf({})}));_export({target:"Number",proto:!0,forced:Bf},{toFixed:function toFixed(t){var o,s,l,h,v=kp(this),m=toIntegerOrInfinity(t),_=[0,0,0,0,0,0],R="",$="0";if(m<0||m>20)throw Of("Incorrect fraction digits");if(v!=v)return"NaN";if(v<=-1e21||v>=1e21)return Nf(v);if(v<0&&(R="-",v=-v),v>1e-21)if(o=function(t){for(var o=0,s=t;s>=4096;)o+=12,s/=4096;for(;s>=2;)o+=1,s/=2;return o}(v*pow$1(2,69,1))-69,s=o<0?v*pow$1(2,-o,1):v/pow$1(2,o,1),s*=4503599627370496,(o=52-o)>0){for(multiply(_,0,s),l=m;l>=7;)multiply(_,1e7,0),l-=7;for(multiply(_,pow$1(10,l,1),0),l=o-1;l>=23;)divide(_,1<<23),l-=23;divide(_,1<<l),multiply(_,1,1),divide(_,2),$=dataToString(_)}else multiply(_,0,s),multiply(_,1<<-o,0),$=dataToString(_)+Lf("0",m);return $=m>0?R+((h=$.length)<=m?"0."+Lf("0",m-h)+$:Uf($,0,h-m)+"."+Uf($,h-m)):R+$}});var qf=W(1..toPrecision),jf=fails((function(){return"1"!==qf(1,void 0)}))||!fails((function(){qf({})}));_export({target:"Number",proto:!0,forced:jf},{toPrecision:function toPrecision(t){return void 0===t?qf(kp(this)):qf(kp(this),t)}});var zf=Object.assign,Vf=Object.defineProperty,Zf=W([].concat),eg=!zf||fails((function(){if(h&&1!==zf({b:1},zf(Vf({},"a",{enumerable:!0,get:function(){Vf(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},o={},s=Symbol(),l="abcdefghijklmnopqrst";return t[s]=7,l.split("").forEach((function(t){o[t]=t})),7!=zf({},t)[s]||Mr(zf({},o)).join("")!=l}))?function assign(t,o){for(var s=toObject(t),l=arguments.length,v=1,m=mr.f,R=q.f;l>v;)for(var $,B=se(arguments[v++]),j=m?Zf(Mr(B),m(B)):Mr(B),z=j.length,K=0;z>K;)$=j[K++],h&&!_(R,B,$)||(s[$]=B[$]);return s}:zf;_export({target:"Object",stat:!0,arity:2,forced:Object.assign!==eg},{assign:eg}),_export({target:"Object",stat:!0,sham:!h},{create:qr});var tg=!fails((function(){if(!(vl&&vl<535)){var t=Math.random();__defineSetter__.call(null,t,(function(){})),delete l[t]}}));h&&_export({target:"Object",proto:!0,forced:tg},{__defineGetter__:function __defineGetter__(t,o){Lt.f(toObject(this),t,{get:aCallable(o),enumerable:!0,configurable:!0})}});var rg=Lr.f;_export({target:"Object",stat:!0,forced:Object.defineProperties!==rg,sham:!h},{defineProperties:rg});var og=Lt.f;_export({target:"Object",stat:!0,forced:Object.defineProperty!==og,sham:!h},{defineProperty:og}),h&&_export({target:"Object",proto:!0,forced:tg},{__defineSetter__:function __defineSetter__(t,o){Lt.f(toObject(this),t,{set:aCallable(o),enumerable:!0,configurable:!0})}});var ng=q.f,ig=W(ng),sg=W([].push),createMethod$1=function(t){return function(o){for(var s,l=toIndexedObject(o),v=Mr(l),m=v.length,_=0,R=[];m>_;)s=v[_++],h&&!ig(l,s)||sg(R,t?[s,l[s]]:l[s]);return R}},ag={entries:createMethod$1(!0),values:createMethod$1(!1)},lg=ag.entries;_export({target:"Object",stat:!0},{entries:function entries(t){return lg(t)}});var cg=Wu.onFreeze,dg=Object.freeze,ug=fails((function(){dg(1)}));_export({target:"Object",stat:!0,forced:ug,sham:!Ku},{freeze:function freeze(t){return dg&&Ee(t)?dg(cg(t)):t}}),_export({target:"Object",stat:!0},{fromEntries:function fromEntries(t){var o={};return iterate(t,(function(t,s){createProperty(o,t,s)}),{AS_ENTRIES:!0}),o}});var hg=xt.f,pg=!h||fails((function(){hg(1)}));_export({target:"Object",stat:!0,forced:pg,sham:!h},{getOwnPropertyDescriptor:function getOwnPropertyDescriptor(t,o){return hg(toIndexedObject(t),o)}}),_export({target:"Object",stat:!0,sham:!h},{getOwnPropertyDescriptors:function getOwnPropertyDescriptors(t){for(var o,s,l=toIndexedObject(t),h=xt.f,v=yr(l),m={},_=0;v.length>_;)void 0!==(s=h(l,o=v[_++]))&&createProperty(m,o,s);return m}});var fg=Kr.f,gg=fails((function(){return!Object.getOwnPropertyNames(1)}));_export({target:"Object",stat:!0,forced:gg},{getOwnPropertyNames:fg});var vg=fails((function(){Bn(1)}));_export({target:"Object",stat:!0,forced:vg,sham:!Ln},{getPrototypeOf:function getPrototypeOf(t){return Bn(toObject(t))}}),_export({target:"Object",stat:!0},{hasOwn:ht});var mg=Object.is||function is(t,o){return t===o?0!==t||1/t==1/o:t!=t&&o!=o};_export({target:"Object",stat:!0},{is:mg}),_export({target:"Object",stat:!0,forced:Object.isExtensible!==Gu},{isExtensible:Gu});var bg=Object.isFrozen,yg=zu||fails((function(){bg(1)}));_export({target:"Object",stat:!0,forced:yg},{isFrozen:function isFrozen(t){return!Ee(t)||(!(!zu||"ArrayBuffer"!=classofRaw(t))||!!bg&&bg(t))}});var wg=Object.isSealed,_g=zu||fails((function(){wg(1)}));_export({target:"Object",stat:!0,forced:_g},{isSealed:function isSealed(t){return!Ee(t)||(!(!zu||"ArrayBuffer"!=classofRaw(t))||!!wg&&wg(t))}});var Cg=fails((function(){Mr(1)}));_export({target:"Object",stat:!0,forced:Cg},{keys:function keys(t){return Mr(toObject(t))}});var kg=xt.f;h&&_export({target:"Object",proto:!0,forced:tg},{__lookupGetter__:function __lookupGetter__(t){var o,s=toObject(this),l=toPropertyKey(t);do{if(o=kg(s,l))return o.get}while(s=Bn(s))}});var xg=xt.f;h&&_export({target:"Object",proto:!0,forced:tg},{__lookupSetter__:function __lookupSetter__(t){var o,s=toObject(this),l=toPropertyKey(t);do{if(o=xg(s,l))return o.set}while(s=Bn(s))}});var Eg=Wu.onFreeze,Ig=Object.preventExtensions,Ag=fails((function(){Ig(1)}));_export({target:"Object",stat:!0,forced:Ag,sham:!Ku},{preventExtensions:function preventExtensions(t){return Ig&&Ee(t)?Ig(Eg(t)):t}});var Pg=Object.getPrototypeOf,Dg=Object.setPrototypeOf,Fg=Object.prototype,Hg="__proto__";if(h&&Pg&&Dg&&!(Hg in Fg))try{defineBuiltInAccessor(Fg,Hg,{configurable:!0,get:function __proto__(){return Pg(toObject(this))},set:function __proto__(t){var o=requireObjectCoercible(this);(Ee(t)||null===t)&&Ee(o)&&Dg(o,t)}})}catch(t){}var Bg=Wu.onFreeze,qg=Object.seal,jg=fails((function(){qg(1)}));_export({target:"Object",stat:!0,forced:jg,sham:!Ku},{seal:function seal(t){return qg&&Ee(t)?qg(Bg(t)):t}}),_export({target:"Object",stat:!0},{setPrototypeOf:Cn});var zg=Ar?{}.toString:function toString(){return"[object "+$r(this)+"]"};Ar||defineBuiltIn(Object.prototype,"toString",zg,{unsafe:!0});var Gg=ag.values;_export({target:"Object",stat:!0},{values:function values(t){return Gg(t)}}),_export({global:!0,forced:parseFloat!=Jp},{parseFloat:Jp}),_export({global:!0,forced:parseInt!=af},{parseInt:af});var Kg,ev,tv,rv,ov=TypeError,validateArgumentsLength=function(t,o){if(t<o)throw ov("Not enough arguments");return t},nv=/(?:ipad|iphone|ipod).*applewebkit/i.test(Re),iv=l.setImmediate,sv=l.clearImmediate,av=l.process,lv=l.Dispatch,cv=l.Function,dv=l.MessageChannel,uv=l.String,hv=0,pv={},fv="onreadystatechange";fails((function(){Kg=l.location}));var run=function(t){if(ht(pv,t)){var o=pv[t];delete pv[t],o()}},runner=function(t){return function(){run(t)}},eventListener=function(t){run(t.data)},globalPostMessageDefer=function(t){l.postMessage(uv(t),Kg.protocol+"//"+Kg.host)};iv&&sv||(iv=function setImmediate(t){validateArgumentsLength(arguments.length,1);var o=ke(t)?t:cv(t),s=Wo(arguments,1);return pv[++hv]=function(){Ko(o,void 0,s)},ev(hv),hv},sv=function clearImmediate(t){delete pv[t]},qa?ev=function(t){av.nextTick(runner(t))}:lv&&lv.now?ev=function(t){lv.now(runner(t))}:dv&&!nv?(rv=(tv=new dv).port2,tv.port1.onmessage=eventListener,ev=functionBindContext(rv.postMessage,rv)):l.addEventListener&&ke(l.postMessage)&&!l.importScripts&&Kg&&"file:"!==Kg.protocol&&!fails(globalPostMessageDefer)?(ev=globalPostMessageDefer,l.addEventListener("message",eventListener,!1)):ev=fv in documentCreateElement("script")?function(t){Fr.appendChild(documentCreateElement("script"))[fv]=function(){Fr.removeChild(this),run(t)}}:function(t){setTimeout(runner(t),0)});var gv={set:iv,clear:sv},Queue=function(){this.head=null,this.tail=null};Queue.prototype={add:function(t){var o={item:t,next:null},s=this.tail;s?s.next=o:this.head=o,this.tail=o},get:function(){var t=this.head;if(t)return null===(this.head=t.next)&&(this.tail=null),t.item}};var vv,mv,bv,yv,wv,_v=Queue,Cv=/ipad|iphone|ipod/i.test(Re)&&"undefined"!=typeof Pebble,kv=/web0s(?!.*chrome)/i.test(Re),Tv=xt.f,Sv=gv.set,xv=l.MutationObserver||l.WebKitMutationObserver,Ev=l.document,Iv=l.process,Av=l.Promise,Pv=Tv(l,"queueMicrotask"),Rv=Pv&&Pv.value;if(!Rv){var Ov=new _v,flush=function(){var t,o;for(qa&&(t=Iv.domain)&&t.exit();o=Ov.get();)try{o()}catch(t){throw Ov.head&&vv(),t}t&&t.enter()};nv||qa||kv||!xv||!Ev?!Cv&&Av&&Av.resolve?((yv=Av.resolve(void 0)).constructor=Av,wv=functionBindContext(yv.then,yv),vv=function(){wv(flush)}):qa?vv=function(){Iv.nextTick(flush)}:(Sv=functionBindContext(Sv,l),vv=function(){Sv(flush)}):(mv=!0,bv=Ev.createTextNode(""),new xv(flush).observe(bv,{characterData:!0}),vv=function(){bv.data=mv=!mv}),Rv=function(t){Ov.head||vv(),Ov.add(t)}}var $v=Rv,perform=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},Nv=l.Promise,Mv="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,Dv=!Mv&&!qa&&"object"==typeof window&&"object"==typeof document;Nv&&Nv.prototype;var Lv,Fv,Uv,Hv=wellKnownSymbol("species"),Bv=!1,qv=ke(l.PromiseRejectionEvent),jv=Sr("Promise",(function(){var t=Kt(Nv),o=t!==String(Nv);if(!o&&66===ze)return!0;if(!ze||ze<51||!/native code/.test(t)){var s=new Nv((function(t){t(1)})),FakePromise=function(t){t((function(){}),(function(){}))};if((s.constructor={})[Hv]=FakePromise,!(Bv=s.then((function(){}))instanceof FakePromise))return!0}return!o&&(Dv||Mv)&&!qv})),zv={CONSTRUCTOR:jv,REJECTION_EVENT:qv,SUBCLASSING:Bv},Vv=TypeError,PromiseCapability=function(t){var o,s;this.promise=new t((function(t,l){if(void 0!==o||void 0!==s)throw Vv("Bad Promise constructor");o=t,s=l})),this.resolve=aCallable(o),this.reject=aCallable(s)},Gv={f:function(t){return new PromiseCapability(t)}},Kv=gv.set,Wv="Promise",Qv=zv.CONSTRUCTOR,Yv=zv.REJECTION_EVENT,Jv=zv.SUBCLASSING,Xv=or.getterFor(Wv),Zv=or.set,em=Nv&&Nv.prototype,tm=Nv,rm=em,om=l.TypeError,nm=l.document,im=l.process,sm=Gv.f,am=sm,lm=!!(nm&&nm.createEvent&&l.dispatchEvent),cm="unhandledrejection",isThenable=function(t){var o;return!(!Ee(t)||!ke(o=t.then))&&o},callReaction=function(t,o){var s,l,h,v=o.value,m=1==o.state,R=m?t.ok:t.fail,$=t.resolve,B=t.reject,q=t.domain;try{R?(m||(2===o.rejection&&onHandleUnhandled(o),o.rejection=1),!0===R?s=v:(q&&q.enter(),s=R(v),q&&(q.exit(),h=!0)),s===t.promise?B(om("Promise-chain cycle")):(l=isThenable(s))?_(l,s,$,B):$(s)):B(v)}catch(t){q&&!h&&q.exit(),B(t)}},notify=function(t,o){t.notified||(t.notified=!0,$v((function(){for(var s,l=t.reactions;s=l.get();)callReaction(s,t);t.notified=!1,o&&!t.rejection&&onUnhandled(t)})))},dispatchEvent=function(t,o,s){var h,v;lm?((h=nm.createEvent("Event")).promise=o,h.reason=s,h.initEvent(t,!1,!0),l.dispatchEvent(h)):h={promise:o,reason:s},!Yv&&(v=l["on"+t])?v(h):t===cm&&function(t,o){try{1==arguments.length?console.error(t):console.error(t,o)}catch(t){}}("Unhandled promise rejection",s)},onUnhandled=function(t){_(Kv,l,(function(){var o,s=t.facade,l=t.value;if(isUnhandled(t)&&(o=perform((function(){qa?im.emit("unhandledRejection",l,s):dispatchEvent(cm,s,l)})),t.rejection=qa||isUnhandled(t)?2:1,o.error))throw o.value}))},isUnhandled=function(t){return 1!==t.rejection&&!t.parent},onHandleUnhandled=function(t){_(Kv,l,(function(){var o=t.facade;qa?im.emit("rejectionHandled",o):dispatchEvent("rejectionhandled",o,t.value)}))},bind=function(t,o,s){return function(l){t(o,l,s)}},internalReject=function(t,o,s){t.done||(t.done=!0,s&&(t=s),t.value=o,t.state=2,notify(t,!0))},internalResolve=function(t,o,s){if(!t.done){t.done=!0,s&&(t=s);try{if(t.facade===o)throw om("Promise can't be resolved itself");var l=isThenable(o);l?$v((function(){var s={done:!1};try{_(l,o,bind(internalResolve,s,t),bind(internalReject,s,t))}catch(o){internalReject(s,o,t)}})):(t.value=o,t.state=1,notify(t,!1))}catch(o){internalReject({done:!1},o,t)}}};if(Qv&&(rm=(tm=function Promise(t){anInstance(this,rm),aCallable(t),_(Lv,this);var o=Xv(this);try{t(bind(internalResolve,o),bind(internalReject,o))}catch(t){internalReject(o,t)}}).prototype,(Lv=function Promise(t){Zv(this,{type:Wv,done:!1,notified:!1,parent:!1,reactions:new _v,rejection:!1,state:0,value:void 0})}).prototype=defineBuiltIn(rm,"then",(function then(t,o){var s=Xv(this),l=sm(speciesConstructor(this,tm));return s.parent=!0,l.ok=!ke(t)||t,l.fail=ke(o)&&o,l.domain=qa?im.domain:void 0,0==s.state?s.reactions.add(l):$v((function(){callReaction(l,s)})),l.promise})),Fv=function(){var t=new Lv,o=Xv(t);this.promise=t,this.resolve=bind(internalResolve,o),this.reject=bind(internalReject,o)},Gv.f=sm=function(t){return t===tm||undefined===t?new Fv(t):am(t)},ke(Nv)&&em!==Object.prototype)){Uv=em.then,Jv||defineBuiltIn(em,"then",(function then(t,o){var s=this;return new tm((function(t,o){_(Uv,s,t,o)})).then(t,o)}),{unsafe:!0});try{delete em.constructor}catch(t){}Cn&&Cn(em,rm)}_export({global:!0,constructor:!0,wrap:!0,forced:Qv},{Promise:tm}),setToStringTag(tm,Wv,!1),setSpecies(Wv);var dm=zv.CONSTRUCTOR||!checkCorrectnessOfIteration((function(t){Nv.all(t).then(void 0,(function(){}))}));_export({target:"Promise",stat:!0,forced:dm},{all:function all(t){var o=this,s=Gv.f(o),l=s.resolve,h=s.reject,v=perform((function(){var s=aCallable(o.resolve),v=[],m=0,R=1;iterate(t,(function(t){var $=m++,B=!1;R++,_(s,o,t).then((function(t){B||(B=!0,v[$]=t,--R||l(v))}),h)})),--R||l(v)}));return v.error&&h(v.value),s.promise}});var um=zv.CONSTRUCTOR,hm=Nv&&Nv.prototype;if(_export({target:"Promise",proto:!0,forced:um,real:!0},{catch:function(t){return this.then(void 0,t)}}),ke(Nv)){var pm=getBuiltIn("Promise").prototype.catch;hm.catch!==pm&&defineBuiltIn(hm,"catch",pm,{unsafe:!0})}_export({target:"Promise",stat:!0,forced:dm},{race:function race(t){var o=this,s=Gv.f(o),l=s.reject,h=perform((function(){var h=aCallable(o.resolve);iterate(t,(function(t){_(h,o,t).then(s.resolve,l)}))}));return h.error&&l(h.value),s.promise}}),_export({target:"Promise",stat:!0,forced:zv.CONSTRUCTOR},{reject:function reject(t){var o=Gv.f(this);return _(o.reject,void 0,t),o.promise}});var promiseResolve=function(t,o){if(anObject(t),Ee(o)&&o.constructor===t)return o;var s=Gv.f(t);return(0,s.resolve)(o),s.promise},fm=zv.CONSTRUCTOR;getBuiltIn("Promise"),_export({target:"Promise",stat:!0,forced:fm},{resolve:function resolve(t){return promiseResolve(this,t)}}),_export({target:"Promise",stat:!0,forced:dm},{allSettled:function allSettled(t){var o=this,s=Gv.f(o),l=s.resolve,h=s.reject,v=perform((function(){var s=aCallable(o.resolve),h=[],v=0,m=1;iterate(t,(function(t){var R=v++,$=!1;m++,_(s,o,t).then((function(t){$||($=!0,h[R]={status:"fulfilled",value:t},--m||l(h))}),(function(t){$||($=!0,h[R]={status:"rejected",reason:t},--m||l(h))}))})),--m||l(h)}));return v.error&&h(v.value),s.promise}});var gm="No one promise resolved";_export({target:"Promise",stat:!0,forced:dm},{any:function any(t){var o=this,s=getBuiltIn("AggregateError"),l=Gv.f(o),h=l.resolve,v=l.reject,m=perform((function(){var l=aCallable(o.resolve),m=[],R=0,$=1,B=!1;iterate(t,(function(t){var q=R++,j=!1;$++,_(l,o,t).then((function(t){j||B||(B=!0,h(t))}),(function(t){j||B||(j=!0,m[q]=t,--$||v(new s(m,gm)))}))})),--$||v(new s(m,gm))}));return m.error&&v(m.value),l.promise}});var vm=Nv&&Nv.prototype,mm=!!Nv&&fails((function(){vm.finally.call({then:function(){}},(function(){}))}));if(_export({target:"Promise",proto:!0,real:!0,forced:mm},{finally:function(t){var o=speciesConstructor(this,getBuiltIn("Promise")),s=ke(t);return this.then(s?function(s){return promiseResolve(o,t()).then((function(){return s}))}:t,s?function(s){return promiseResolve(o,t()).then((function(){throw s}))}:t)}}),ke(Nv)){var bm=getBuiltIn("Promise").prototype.finally;vm.finally!==bm&&defineBuiltIn(vm,"finally",bm,{unsafe:!0})}var ym=!fails((function(){Reflect.apply((function(){}))}));_export({target:"Reflect",stat:!0,forced:ym},{apply:function apply(t,o,s){return Ko(aCallable(t),o,anObject(s))}});var wm=getBuiltIn("Reflect","construct"),_m=Object.prototype,Cm=[].push,km=fails((function(){function F(){}return!(wm((function(){}),[],F)instanceof F)})),Tm=!fails((function(){wm((function(){}))})),Sm=km||Tm;_export({target:"Reflect",stat:!0,forced:Sm,sham:Sm},{construct:function construct(t,o){aConstructor(t),anObject(o);var s=arguments.length<3?t:aConstructor(arguments[2]);if(Tm&&!km)return wm(t,o,s);if(t==s){switch(o.length){case 0:return new t;case 1:return new t(o[0]);case 2:return new t(o[0],o[1]);case 3:return new t(o[0],o[1],o[2]);case 4:return new t(o[0],o[1],o[2],o[3])}var l=[null];return Ko(Cm,l,o),new(Ko(Du,t,l))}var h=s.prototype,v=qr(Ee(h)?h:_m),m=Ko(t,v,o);return Ee(m)?m:v}});var xm=fails((function(){Reflect.defineProperty(Lt.f({},1,{value:1}),1,{value:2})}));_export({target:"Reflect",stat:!0,forced:xm,sham:!h},{defineProperty:function defineProperty(t,o,s){anObject(t);var l=toPropertyKey(o);anObject(s);try{return Lt.f(t,l,s),!0}catch(t){return!1}}});var Em=xt.f;_export({target:"Reflect",stat:!0},{deleteProperty:function deleteProperty(t,o){var s=Em(anObject(t),o);return!(s&&!s.configurable)&&delete t[o]}});var isDataDescriptor=function(t){return void 0!==t&&(ht(t,"value")||ht(t,"writable"))};_export({target:"Reflect",stat:!0},{get:function get(t,o){var s,l,h=arguments.length<3?t:arguments[2];return anObject(t)===h?t[o]:(s=xt.f(t,o))?isDataDescriptor(s)?s.value:void 0===s.get?void 0:_(s.get,h):Ee(l=Bn(t))?get(l,o,h):void 0}}),_export({target:"Reflect",stat:!0,sham:!h},{getOwnPropertyDescriptor:function getOwnPropertyDescriptor(t,o){return xt.f(anObject(t),o)}}),_export({target:"Reflect",stat:!0,sham:!Ln},{getPrototypeOf:function getPrototypeOf(t){return Bn(anObject(t))}}),_export({target:"Reflect",stat:!0},{has:function has(t,o){return o in t}}),_export({target:"Reflect",stat:!0},{isExtensible:function isExtensible(t){return anObject(t),Gu(t)}}),_export({target:"Reflect",stat:!0},{ownKeys:yr}),_export({target:"Reflect",stat:!0,sham:!Ku},{preventExtensions:function preventExtensions(t){anObject(t);try{var o=getBuiltIn("Object","preventExtensions");return o&&o(t),!0}catch(t){return!1}}});var Im=fails((function(){var Constructor=function(){},t=Lt.f(new Constructor,"a",{configurable:!0});return!1!==Reflect.set(Constructor.prototype,"a",1,t)}));_export({target:"Reflect",stat:!0,forced:Im},{set:function set(t,o,s){var l,h,v,m=arguments.length<4?t:arguments[3],R=xt.f(anObject(t),o);if(!R){if(Ee(h=Bn(t)))return set(h,o,s,m);R=createPropertyDescriptor(0)}if(isDataDescriptor(R)){if(!1===R.writable||!Ee(m))return!1;if(l=xt.f(m,o)){if(l.get||l.set||!1===l.writable)return!1;l.value=s,Lt.f(m,o,l)}else Lt.f(m,o,createPropertyDescriptor(0,s))}else{if(void 0===(v=R.set))return!1;_(v,m,s)}return!0}}),Cn&&_export({target:"Reflect",stat:!0},{setPrototypeOf:function setPrototypeOf(t,o){anObject(t),aPossiblePrototype(o);try{return Cn(t,o),!0}catch(t){return!1}}}),_export({global:!0},{Reflect:{}}),setToStringTag(l.Reflect,"Reflect",!0);var Am=wellKnownSymbol("match"),isRegexp=function(t){var o;return Ee(t)&&(void 0!==(o=t[Am])?!!o:"RegExp"==classofRaw(t))},regexpFlags=function(){var t=anObject(this),o="";return t.hasIndices&&(o+="d"),t.global&&(o+="g"),t.ignoreCase&&(o+="i"),t.multiline&&(o+="m"),t.dotAll&&(o+="s"),t.unicode&&(o+="u"),t.unicodeSets&&(o+="v"),t.sticky&&(o+="y"),o},Pm=RegExp.prototype,regexpGetFlags=function(t){var o=t.flags;return void 0!==o||"flags"in Pm||ht(t,"flags")||!Pe(Pm,t)?o:_(regexpFlags,t)},Rm=l.RegExp,Om=fails((function(){var t=Rm("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),$m=Om||fails((function(){return!Rm("a","y").sticky})),Nm=Om||fails((function(){var t=Rm("^r","gy");return t.lastIndex=2,null!=t.exec("str")})),Mm={BROKEN_CARET:Nm,MISSED_STICKY:$m,UNSUPPORTED_Y:Om},Dm=l.RegExp,Lm=fails((function(){var t=Dm(".","s");return!(t.dotAll&&t.exec("\n")&&"s"===t.flags)})),Fm=l.RegExp,Um=fails((function(){var t=Fm("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")})),Hm=vr.f,Bm=or.enforce,qm=wellKnownSymbol("match"),jm=l.RegExp,zm=jm.prototype,Vm=l.SyntaxError,Gm=W(zm.exec),Km=W("".charAt),Wm=W("".replace),Qm=W("".indexOf),Ym=W("".slice),Jm=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,Xm=/a/g,Zm=/a/g,eb=new jm(Xm)!==Xm,tb=Mm.MISSED_STICKY,rb=Mm.UNSUPPORTED_Y,ob=h&&(!eb||tb||Lm||Um||fails((function(){return Zm[qm]=!1,jm(Xm)!=Xm||jm(Zm)==Zm||"/a/i"!=jm(Xm,"i")})));if(Sr("RegExp",ob)){for(var nb=function RegExp(t,o){var s,l,h,v,m,_,R=Pe(zm,this),$=isRegexp(t),B=void 0===o,q=[],j=t;if(!R&&$&&B&&t.constructor===nb)return t;if(($||Pe(zm,t))&&(t=t.source,B&&(o=regexpGetFlags(j))),t=void 0===t?"":toString_1(t),o=void 0===o?"":toString_1(o),j=t,Lm&&"dotAll"in Xm&&(l=!!o&&Qm(o,"s")>-1)&&(o=Wm(o,/s/g,"")),s=o,tb&&"sticky"in Xm&&(h=!!o&&Qm(o,"y")>-1)&&rb&&(o=Wm(o,/y/g,"")),Um&&(v=function(t){for(var o,s=t.length,l=0,h="",v=[],m={},_=!1,R=!1,$=0,B="";l<=s;l++){if("\\"===(o=Km(t,l)))o+=Km(t,++l);else if("]"===o)_=!1;else if(!_)switch(!0){case"["===o:_=!0;break;case"("===o:Gm(Jm,Ym(t,l+1))&&(l+=2,R=!0),h+=o,$++;continue;case">"===o&&R:if(""===B||ht(m,B))throw new Vm("Invalid capture group name");m[B]=!0,v[v.length]=[B,$],R=!1,B="";continue}R?B+=o:h+=o}return[h,v]}(t),t=v[0],q=v[1]),m=inheritIfRequired(jm(t,o),R?this:zm,nb),(l||h||q.length)&&(_=Bm(m),l&&(_.dotAll=!0,_.raw=nb(function(t){for(var o,s=t.length,l=0,h="",v=!1;l<=s;l++)"\\"!==(o=Km(t,l))?v||"."!==o?("["===o?v=!0:"]"===o&&(v=!1),h+=o):h+="[\\s\\S]":h+=o+Km(t,++l);return h}(t),s)),h&&(_.sticky=!0),q.length&&(_.groups=q)),t!==j)try{Ft(m,"source",""===j?"(?:)":j)}catch(t){}return m},ab=Hm(jm),cb=0;ab.length>cb;)proxyAccessor(nb,jm,ab[cb++]);zm.constructor=nb,nb.prototype=zm,defineBuiltIn(l,"RegExp",nb,{constructor:!0})}setSpecies("RegExp");var db=or.get,ub=RegExp.prototype,hb=TypeError;h&&Lm&&defineBuiltInAccessor(ub,"dotAll",{configurable:!0,get:function dotAll(){if(this!==ub){if("RegExp"===classofRaw(this))return!!db(this).dotAll;throw hb("Incompatible receiver, RegExp required")}}});var pb=or.get,fb=ct("native-string-replace",String.prototype.replace),gb=RegExp.prototype.exec,vb=gb,mb=W("".charAt),bb=W("".indexOf),yb=W("".replace),wb=W("".slice),_b=function(){var t=/a/,o=/b*/g;return _(gb,t,"a"),_(gb,o,"a"),0!==t.lastIndex||0!==o.lastIndex}(),kb=Mm.BROKEN_CARET,Tb=void 0!==/()??/.exec("")[1];(_b||Tb||kb||Lm||Um)&&(vb=function exec(t){var o,s,l,h,v,m,R,$=this,B=pb($),q=toString_1(t),j=B.raw;if(j)return j.lastIndex=$.lastIndex,o=_(vb,j,q),$.lastIndex=j.lastIndex,o;var z=B.groups,K=kb&&$.sticky,W=_(regexpFlags,$),Z=$.source,te=0,ne=q;if(K&&(W=yb(W,"y",""),-1===bb(W,"g")&&(W+="g"),ne=wb(q,$.lastIndex),$.lastIndex>0&&(!$.multiline||$.multiline&&"\n"!==mb(q,$.lastIndex-1))&&(Z="(?: "+Z+")",ne=" "+ne,te++),s=new RegExp("^(?:"+Z+")",W)),Tb&&(s=new RegExp("^"+Z+"$(?!\\s)",W)),_b&&(l=$.lastIndex),h=_(gb,K?s:$,ne),K?h?(h.input=wb(h.input,te),h[0]=wb(h[0],te),h.index=$.lastIndex,$.lastIndex+=h[0].length):$.lastIndex=0:_b&&h&&($.lastIndex=$.global?h.index+h[0].length:l),Tb&&h&&h.length>1&&_(fb,h[0],s,(function(){for(v=1;v<arguments.length-2;v++)void 0===arguments[v]&&(h[v]=void 0)})),h&&z)for(h.groups=m=qr(null),v=0;v<z.length;v++)m[(R=z[v])[0]]=h[R[1]];return h});var Sb=vb;_export({target:"RegExp",proto:!0,forced:/./.exec!==Sb},{exec:Sb});var xb=l.RegExp,Eb=xb.prototype,Ib=h&&fails((function(){var t=!0;try{xb(".","d")}catch(o){t=!1}var o={},s="",l=t?"dgimsy":"gimsy",addGetter=function(t,l){Object.defineProperty(o,t,{get:function(){return s+=l,!0}})},h={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var v in t&&(h.hasIndices="d"),h)addGetter(v,h[v]);return Object.getOwnPropertyDescriptor(Eb,"flags").get.call(o)!==l||s!==l}));Ib&&defineBuiltInAccessor(Eb,"flags",{configurable:!0,get:regexpFlags});var Ab=Mm.MISSED_STICKY,Pb=or.get,Rb=RegExp.prototype,Ob=TypeError;h&&Ab&&defineBuiltInAccessor(Rb,"sticky",{configurable:!0,get:function sticky(){if(this!==Rb){if("RegExp"===classofRaw(this))return!!Pb(this).sticky;throw Ob("Incompatible receiver, RegExp required")}}});var Mb,Db,Lb=(Mb=!1,(Db=/[ac]/).exec=function(){return Mb=!0,/./.exec.apply(this,arguments)},!0===Db.test("abc")&&Mb),Fb=/./.test;_export({target:"RegExp",proto:!0,forced:!Lb},{test:function(t){var o=anObject(this),s=toString_1(t),l=o.exec;if(!ke(l))return _(Fb,o,s);var h=_(l,o,s);return null!==h&&(anObject(h),!0)}});var Ub=qt.PROPER,Bb="toString",qb=RegExp.prototype[Bb],zb=fails((function(){return"/a/b"!=qb.call({source:"a",flags:"b"})})),Gb=Ub&&qb.name!=Bb;(zb||Gb)&&defineBuiltIn(RegExp.prototype,Bb,(function toString(){var t=anObject(this);return"/"+toString_1(t.source)+"/"+toString_1(regexpGetFlags(t))}),{unsafe:!0}),collection("Set",(function(t){return function Set(){return t(this,arguments.length?arguments[0]:void 0)}}),Xu);var Kb=W("".charAt),Wb=fails((function(){return"\ud842"!=="ð ®·".at(-2)}));_export({target:"String",proto:!0,forced:Wb},{at:function at(t){var o=toString_1(requireObjectCoercible(this)),s=o.length,l=toIntegerOrInfinity(t),h=l>=0?l:s+l;return h<0||h>=s?void 0:Kb(o,h)}});var Qb=W("".charAt),Yb=W("".charCodeAt),Jb=W("".slice),createMethod=function(t){return function(o,s){var l,h,v=toString_1(requireObjectCoercible(o)),m=toIntegerOrInfinity(s),_=v.length;return m<0||m>=_?t?"":void 0:(l=Yb(v,m))<55296||l>56319||m+1===_||(h=Yb(v,m+1))<56320||h>57343?t?Qb(v,m):l:t?Jb(v,m,m+2):h-56320+(l-55296<<10)+65536}},Xb={codeAt:createMethod(!1),charAt:createMethod(!0)},Zb=Xb.codeAt;_export({target:"String",proto:!0},{codePointAt:function codePointAt(t){return Zb(this,t)}});var ey=TypeError,notARegexp=function(t){if(isRegexp(t))throw ey("The method doesn't accept regular expressions");return t},ty=wellKnownSymbol("match"),correctIsRegexpLogic=function(t){var o=/./;try{"/./"[t](o)}catch(s){try{return o[ty]=!1,"/./"[t](o)}catch(t){}}return!1},ry=xt.f,oy=functionUncurryThisClause("".endsWith),ny=functionUncurryThisClause("".slice),iy=Math.min,sy=correctIsRegexpLogic("endsWith"),ay=!sy&&!!function(){var t=ry(String.prototype,"endsWith");return t&&!t.writable}();_export({target:"String",proto:!0,forced:!ay&&!sy},{endsWith:function endsWith(t){var o=toString_1(requireObjectCoercible(this));notARegexp(t);var s=arguments.length>1?arguments[1]:void 0,l=o.length,h=void 0===s?l:iy(toLength(s),l),v=toString_1(t);return oy?oy(o,v,h):ny(o,h-v.length,h)===v}});var ly=RangeError,cy=String.fromCharCode,dy=String.fromCodePoint,uy=W([].join),hy=!!dy&&1!=dy.length;_export({target:"String",stat:!0,arity:1,forced:hy},{fromCodePoint:function fromCodePoint(t){for(var o,s=[],l=arguments.length,h=0;l>h;){if(o=+arguments[h++],toAbsoluteIndex(o,1114111)!==o)throw ly(o+" is not a valid code point");s[h]=o<65536?cy(o):cy(55296+((o-=65536)>>10),o%1024+56320)}return uy(s,"")}});var py=W("".indexOf);_export({target:"String",proto:!0,forced:!correctIsRegexpLogic("includes")},{includes:function includes(t){return!!~py(toString_1(requireObjectCoercible(this)),toString_1(notARegexp(t)),arguments.length>1?arguments[1]:void 0)}});var fy=Xb.charAt,gy="String Iterator",vy=or.set,my=or.getterFor(gy);iteratorDefine(String,"String",(function(t){vy(this,{type:gy,string:toString_1(t),index:0})}),(function next(){var t,o=my(this),s=o.string,l=o.index;return l>=s.length?createIterResultObject(void 0,!0):(t=fy(s,l),o.index+=t.length,createIterResultObject(t,!1))}));var by=wellKnownSymbol("species"),yy=RegExp.prototype,fixRegexpWellKnownSymbolLogic=function(t,o,s,l){var h=wellKnownSymbol(t),v=!fails((function(){var o={};return o[h]=function(){return 7},7!=""[t](o)})),m=v&&!fails((function(){var o=!1,s=/a/;return"split"===t&&((s={}).constructor={},s.constructor[by]=function(){return s},s.flags="",s[h]=/./[h]),s.exec=function(){return o=!0,null},s[h](""),!o}));if(!v||!m||s){var _=functionUncurryThisClause(/./[h]),R=o(h,""[t],(function(t,o,s,l,h){var m=functionUncurryThisClause(t),R=o.exec;return R===Sb||R===yy.exec?v&&!h?{done:!0,value:_(o,s,l)}:{done:!0,value:m(s,o,l)}:{done:!1}}));defineBuiltIn(String.prototype,t,R[0]),defineBuiltIn(yy,h,R[1])}l&&Ft(yy[h],"sham",!0)},wy=Xb.charAt,advanceStringIndex=function(t,o,s){return o+(s?wy(t,o).length:1)},_y=TypeError,regexpExecAbstract=function(t,o){var s=t.exec;if(ke(s)){var l=_(s,t,o);return null!==l&&anObject(l),l}if("RegExp"===classofRaw(t))return _(Sb,t,o);throw _y("RegExp#exec called on incompatible receiver")};fixRegexpWellKnownSymbolLogic("match",(function(t,o,s){return[function match(o){var s=requireObjectCoercible(this),l=isNullOrUndefined(o)?void 0:getMethod$1(o,t);return l?_(l,o,s):new RegExp(o)[t](toString_1(s))},function(t){var l=anObject(this),h=toString_1(t),v=s(o,l,h);if(v.done)return v.value;if(!l.global)return regexpExecAbstract(l,h);var m=l.unicode;l.lastIndex=0;for(var _,R=[],$=0;null!==(_=regexpExecAbstract(l,h));){var B=toString_1(_[0]);R[$]=B,""===B&&(l.lastIndex=advanceStringIndex(h,toLength(l.lastIndex),m)),$++}return 0===$?null:R}]}));var Cy=wellKnownSymbol("matchAll"),ky="RegExp String",Ty=ky+" Iterator",Sy=or.set,xy=or.getterFor(Ty),Ey=RegExp.prototype,Iy=TypeError,Ay=functionUncurryThisClause("".indexOf),Py=functionUncurryThisClause("".matchAll),Ry=!!Py&&!fails((function(){Py("a",/./)})),Oy=iteratorCreateConstructor((function RegExpStringIterator(t,o,s,l){Sy(this,{type:Ty,regexp:t,string:o,global:s,unicode:l,done:!1})}),ky,(function next(){var t=xy(this);if(t.done)return createIterResultObject(void 0,!0);var o=t.regexp,s=t.string,l=regexpExecAbstract(o,s);return null===l?(t.done=!0,createIterResultObject(void 0,!0)):t.global?(""===toString_1(l[0])&&(o.lastIndex=advanceStringIndex(s,toLength(o.lastIndex),t.unicode)),createIterResultObject(l,!1)):(t.done=!0,createIterResultObject(l,!1))})),$matchAll=function(t){var o,s,l,h=anObject(this),v=toString_1(t),m=speciesConstructor(h,RegExp),_=toString_1(regexpGetFlags(h));return o=new m(m===RegExp?h.source:h,_),s=!!~Ay(_,"g"),l=!!~Ay(_,"u"),o.lastIndex=toLength(h.lastIndex),new Oy(o,v,s,l)};_export({target:"String",proto:!0,forced:Ry},{matchAll:function matchAll(t){var o,s,l,h=requireObjectCoercible(this);if(isNullOrUndefined(t)){if(Ry)return Py(h,t)}else{if(isRegexp(t)&&(o=toString_1(requireObjectCoercible(regexpGetFlags(t))),!~Ay(o,"g")))throw Iy("`.matchAll` does not allow non-global regexes");if(Ry)return Py(h,t);if(l=getMethod$1(t,Cy))return _(l,t,h)}return s=toString_1(h),new RegExp(t,"g")[Cy](s)}}),Cy in Ey||defineBuiltIn(Ey,Cy,$matchAll);var $y=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(Re),Ny=tu.end;_export({target:"String",proto:!0,forced:$y},{padEnd:function padEnd(t){return Ny(this,t,arguments.length>1?arguments[1]:void 0)}});var My=tu.start;_export({target:"String",proto:!0,forced:$y},{padStart:function padStart(t){return My(this,t,arguments.length>1?arguments[1]:void 0)}});var Dy=W([].push),Ly=W([].join);_export({target:"String",stat:!0},{raw:function raw(t){var o=toIndexedObject(toObject(t).raw),s=lengthOfArrayLike(o);if(!s)return"";for(var l=arguments.length,h=[],v=0;;){if(Dy(h,toString_1(o[v++])),v===s)return Ly(h,"");v<l&&Dy(h,toString_1(arguments[v]))}}}),_export({target:"String",proto:!0},{repeat:Kd});var Fy=Math.floor,Uy=W("".charAt),Hy=W("".replace),By=W("".slice),qy=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,jy=/\$([$&'`]|\d{1,2})/g,getSubstitution=function(t,o,s,l,h,v){var m=s+t.length,_=l.length,R=jy;return void 0!==h&&(h=toObject(h),R=qy),Hy(v,R,(function(v,R){var $;switch(Uy(R,0)){case"$":return"$";case"&":return t;case"`":return By(o,0,s);case"'":return By(o,m);case"<":$=h[By(R,1,-1)];break;default:var B=+R;if(0===B)return v;if(B>_){var q=Fy(B/10);return 0===q?v:q<=_?void 0===l[q-1]?Uy(R,1):l[q-1]+Uy(R,1):v}$=l[B-1]}return void 0===$?"":$}))},zy=wellKnownSymbol("replace"),Vy=Math.max,Gy=Math.min,Ky=W([].concat),Wy=W([].push),Qy=W("".indexOf),Yy=W("".slice),Jy="$0"==="a".replace(/./,"$0"),Xy=!!/./[zy]&&""===/./[zy]("a","$0"),Zy=!fails((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}));fixRegexpWellKnownSymbolLogic("replace",(function(t,o,s){var l=Xy?"$":"$0";return[function replace(t,s){var l=requireObjectCoercible(this),h=isNullOrUndefined(t)?void 0:getMethod$1(t,zy);return h?_(h,t,l,s):_(o,toString_1(l),t,s)},function(t,h){var v=anObject(this),m=toString_1(t);if("string"==typeof h&&-1===Qy(h,l)&&-1===Qy(h,"$<")){var _=s(o,v,m,h);if(_.done)return _.value}var R=ke(h);R||(h=toString_1(h));var $=v.global;if($){var B=v.unicode;v.lastIndex=0}for(var q=[];;){var j=regexpExecAbstract(v,m);if(null===j)break;if(Wy(q,j),!$)break;""===toString_1(j[0])&&(v.lastIndex=advanceStringIndex(m,toLength(v.lastIndex),B))}for(var z,K="",W=0,Z=0;Z<q.length;Z++){for(var te=toString_1((j=q[Z])[0]),ne=Vy(Gy(toIntegerOrInfinity(j.index),m.length),0),ie=[],se=1;se<j.length;se++)Wy(ie,void 0===(z=j[se])?z:String(z));var he=j.groups;if(R){var me=Ky([te],ie,ne,m);void 0!==he&&Wy(me,he);var _e=toString_1(Ko(h,void 0,me))}else _e=getSubstitution(te,m,ne,ie,he,h);ne>=W&&(K+=Yy(m,W,ne)+_e,W=ne+te.length)}return K+Yy(m,W)}]}),!Zy||!Jy||Xy);var ew=wellKnownSymbol("replace"),tw=TypeError,rw=W("".indexOf);W("".replace);var ow=W("".slice),nw=Math.max,stringIndexOf=function(t,o,s){return s>t.length?-1:""===o?s:rw(t,o,s)};_export({target:"String",proto:!0},{replaceAll:function replaceAll(t,o){var s,l,h,v,m,R,$,B,q=requireObjectCoercible(this),j=0,z=0,K="";if(!isNullOrUndefined(t)){if(isRegexp(t)&&(s=toString_1(requireObjectCoercible(regexpGetFlags(t))),!~rw(s,"g")))throw tw("`.replaceAll` does not allow non-global regexes");if(l=getMethod$1(t,ew))return _(l,t,q,o)}for(h=toString_1(q),v=toString_1(t),(m=ke(o))||(o=toString_1(o)),R=v.length,$=nw(1,R),j=stringIndexOf(h,v,0);-1!==j;)B=m?toString_1(o(v,j,h)):getSubstitution(v,h,j,[],void 0,o),K+=ow(h,z,j)+B,z=j+R,j=stringIndexOf(h,v,j+$);return z<h.length&&(K+=ow(h,z)),K}}),fixRegexpWellKnownSymbolLogic("search",(function(t,o,s){return[function search(o){var s=requireObjectCoercible(this),l=isNullOrUndefined(o)?void 0:getMethod$1(o,t);return l?_(l,o,s):new RegExp(o)[t](toString_1(s))},function(t){var l=anObject(this),h=toString_1(t),v=s(o,l,h);if(v.done)return v.value;var m=l.lastIndex;mg(m,0)||(l.lastIndex=0);var _=regexpExecAbstract(l,h);return mg(l.lastIndex,m)||(l.lastIndex=m),null===_?-1:_.index}]}));var iw=Mm.UNSUPPORTED_Y,sw=4294967295,aw=Math.min,lw=[].push,cw=W(/./.exec),dw=W(lw),uw=W("".slice),hw=!fails((function(){var t=/(?:)/,o=t.exec;t.exec=function(){return o.apply(this,arguments)};var s="ab".split(t);return 2!==s.length||"a"!==s[0]||"b"!==s[1]}));fixRegexpWellKnownSymbolLogic("split",(function(t,o,s){var l;return l="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,s){var l=toString_1(requireObjectCoercible(this)),h=void 0===s?sw:s>>>0;if(0===h)return[];if(void 0===t)return[l];if(!isRegexp(t))return _(o,l,t,h);for(var v,m,R,$=[],B=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),q=0,j=new RegExp(t.source,B+"g");(v=_(Sb,j,l))&&!((m=j.lastIndex)>q&&(dw($,uw(l,q,v.index)),v.length>1&&v.index<l.length&&Ko(lw,$,arraySliceSimple(v,1)),R=v[0].length,q=m,$.length>=h));)j.lastIndex===v.index&&j.lastIndex++;return q===l.length?!R&&cw(j,"")||dw($,""):dw($,uw(l,q)),$.length>h?arraySliceSimple($,0,h):$}:"0".split(void 0,0).length?function(t,s){return void 0===t&&0===s?[]:_(o,this,t,s)}:o,[function split(o,s){var h=requireObjectCoercible(this),v=isNullOrUndefined(o)?void 0:getMethod$1(o,t);return v?_(v,o,h,s):_(l,toString_1(h),o,s)},function(t,h){var v=anObject(this),m=toString_1(t),_=s(l,v,m,h,l!==o);if(_.done)return _.value;var R=speciesConstructor(v,RegExp),$=v.unicode,B=(v.ignoreCase?"i":"")+(v.multiline?"m":"")+(v.unicode?"u":"")+(iw?"g":"y"),q=new R(iw?"^(?:"+v.source+")":v,B),j=void 0===h?sw:h>>>0;if(0===j)return[];if(0===m.length)return null===regexpExecAbstract(q,m)?[m]:[];for(var z=0,K=0,W=[];K<m.length;){q.lastIndex=iw?0:K;var Z,te=regexpExecAbstract(q,iw?uw(m,K):m);if(null===te||(Z=aw(toLength(q.lastIndex+(iw?K:0)),m.length))===z)K=advanceStringIndex(m,K,$);else{if(dw(W,uw(m,z,K)),W.length===j)return W;for(var ne=1;ne<=te.length-1;ne++)if(dw(W,te[ne]),W.length===j)return W;K=z=Z}}return dw(W,uw(m,z)),W}]}),!hw,iw);var pw=xt.f,fw=functionUncurryThisClause("".startsWith),gw=functionUncurryThisClause("".slice),vw=Math.min,mw=correctIsRegexpLogic("startsWith"),bw=!mw&&!!function(){var t=pw(String.prototype,"startsWith");return t&&!t.writable}();_export({target:"String",proto:!0,forced:!bw&&!mw},{startsWith:function startsWith(t){var o=toString_1(requireObjectCoercible(this));notARegexp(t);var s=toLength(vw(arguments.length>1?arguments[1]:void 0,o.length)),l=toString_1(t);return fw?fw(o,l,s):gw(o,s,s+l.length)===l}});var yw=W("".slice),ww=Math.max,_w=Math.min,Cw=!"".substr||"b"!=="ab".substr(-1);_export({target:"String",proto:!0,forced:Cw},{substr:function substr(t,o){var s,l,h=toString_1(requireObjectCoercible(this)),v=h.length,m=toIntegerOrInfinity(t);return m===1/0&&(m=0),m<0&&(m=ww(v+m,0)),(s=void 0===o?v:toIntegerOrInfinity(o))<=0||s===1/0||m>=(l=_w(m+s,v))?"":yw(h,m,l)}});var kw=qt.PROPER,stringTrimForced=function(t){return fails((function(){return!!Tp[t]()||"âÂá "!=="âÂá "[t]()||kw&&Tp[t].name!==t}))},Tw=Ip.trim;_export({target:"String",proto:!0,forced:stringTrimForced("trim")},{trim:function trim(){return Tw(this)}});var Sw=Ip.end,xw=stringTrimForced("trimEnd")?function trimEnd(){return Sw(this)}:"".trimEnd;_export({target:"String",proto:!0,name:"trimEnd",forced:"".trimRight!==xw},{trimRight:xw}),_export({target:"String",proto:!0,name:"trimEnd",forced:"".trimEnd!==xw},{trimEnd:xw});var Ew=Ip.start,Iw=stringTrimForced("trimStart")?function trimStart(){return Ew(this)}:"".trimStart;_export({target:"String",proto:!0,name:"trimStart",forced:"".trimLeft!==Iw},{trimLeft:Iw}),_export({target:"String",proto:!0,name:"trimStart",forced:"".trimStart!==Iw},{trimStart:Iw});var Aw=/"/g,Pw=W("".replace),createHtml=function(t,o,s,l){var h=toString_1(requireObjectCoercible(t)),v="<"+o;return""!==s&&(v+=" "+s+'="'+Pw(toString_1(l),Aw,"&quot;")+'"'),v+">"+h+"</"+o+">"},stringHtmlForced=function(t){return fails((function(){var o=""[t]('"');return o!==o.toLowerCase()||o.split('"').length>3}))};_export({target:"String",proto:!0,forced:stringHtmlForced("anchor")},{anchor:function anchor(t){return createHtml(this,"a","name",t)}}),_export({target:"String",proto:!0,forced:stringHtmlForced("big")},{big:function big(){return createHtml(this,"big","","")}}),_export({target:"String",proto:!0,forced:stringHtmlForced("blink")},{blink:function blink(){return createHtml(this,"blink","","")}}),_export({target:"String",proto:!0,forced:stringHtmlForced("bold")},{bold:function bold(){return createHtml(this,"b","","")}}),_export({target:"String",proto:!0,forced:stringHtmlForced("fixed")},{fixed:function fixed(){return createHtml(this,"tt","","")}}),_export({target:"String",proto:!0,forced:stringHtmlForced("fontcolor")},{fontcolor:function fontcolor(t){return createHtml(this,"font","color",t)}}),_export({target:"String",proto:!0,forced:stringHtmlForced("fontsize")},{fontsize:function fontsize(t){return createHtml(this,"font","size",t)}}),_export({target:"String",proto:!0,forced:stringHtmlForced("italics")},{italics:function italics(){return createHtml(this,"i","","")}}),_export({target:"String",proto:!0,forced:stringHtmlForced("link")},{link:function link(t){return createHtml(this,"a","href",t)}}),_export({target:"String",proto:!0,forced:stringHtmlForced("small")},{small:function small(){return createHtml(this,"small","","")}}),_export({target:"String",proto:!0,forced:stringHtmlForced("strike")},{strike:function strike(){return createHtml(this,"strike","","")}}),_export({target:"String",proto:!0,forced:stringHtmlForced("sub")},{sub:function sub(){return createHtml(this,"sub","","")}}),_export({target:"String",proto:!0,forced:stringHtmlForced("sup")},{sup:function sup(){return createHtml(this,"sup","","")}});var Rw=wd.NATIVE_ARRAY_BUFFER_VIEWS,Ow=l.ArrayBuffer,$w=l.Int8Array,Nw=!Rw||!fails((function(){$w(1)}))||!fails((function(){new $w(-1)}))||!checkCorrectnessOfIteration((function(t){new $w,new $w(null),new $w(1.5),new $w(t)}),!0)||fails((function(){return 1!==new $w(new Ow(2),1,void 0).length})),Mw=RangeError,Dw=RangeError,toOffset=function(t,o){var s=function(t){var o=toIntegerOrInfinity(t);if(o<0)throw Mw("The argument can't be less than 0");return o}(t);if(s%o)throw Dw("Wrong offset");return s},isBigIntArray=function(t){var o=$r(t);return"BigInt64Array"==o||"BigUint64Array"==o},Lw=TypeError,toBigInt=function(t){var o=toPrimitive(t,"number");if("number"==typeof o)throw Lw("Can't convert number to bigint");return BigInt(o)},Fw=wd.aTypedArrayConstructor,Uw=function from(t){var o,s,l,h,v,m,R,$,B=aConstructor(this),q=toObject(t),j=arguments.length,z=j>1?arguments[1]:void 0,K=void 0!==z,W=getIteratorMethod(q);if(W&&!isArrayIteratorMethod(W))for($=(R=getIterator(q,W)).next,q=[];!(m=_($,R)).done;)q.push(m.value);for(K&&j>2&&(z=functionBindContext(z,arguments[2])),s=lengthOfArrayLike(q),l=new(Fw(B))(s),h=isBigIntArray(l),o=0;s>o;o++)v=K?z(q[o],o):q[o],l[o]=h?toBigInt(v):+v;return l},Hw=createCommonjsModule((function(t){var o=vr.f,s=po.forEach,v=or.get,m=or.set,R=or.enforce,$=Lt.f,B=xt.f,q=Math.round,j=l.RangeError,z=kc.ArrayBuffer,K=z.prototype,W=kc.DataView,Z=wd.NATIVE_ARRAY_BUFFER_VIEWS,te=wd.TYPED_ARRAY_TAG,ne=wd.TypedArray,ie=wd.TypedArrayPrototype,se=wd.aTypedArrayConstructor,he=wd.isTypedArray,me="BYTES_PER_ELEMENT",_e="Wrong length",fromList=function(t,o){se(t);for(var s=0,l=o.length,h=new t(l);l>s;)h[s]=o[s++];return h},addGetter=function(t,o){defineBuiltInAccessor(t,o,{configurable:!0,get:function(){return v(this)[o]}})},isArrayBuffer=function(t){var o;return Pe(K,t)||"ArrayBuffer"==(o=$r(t))||"SharedArrayBuffer"==o},isTypedArrayIndex=function(t,o){return he(t)&&!tt(o)&&o in t&&zp(+o)&&o>=0},Ce=function getOwnPropertyDescriptor(t,o){return o=toPropertyKey(o),isTypedArrayIndex(t,o)?createPropertyDescriptor(2,t[o]):B(t,o)},ke=function defineProperty(t,o,s){return o=toPropertyKey(o),!(isTypedArrayIndex(t,o)&&Ee(s)&&ht(s,"value"))||ht(s,"get")||ht(s,"set")||s.configurable||ht(s,"writable")&&!s.writable||ht(s,"enumerable")&&!s.enumerable?$(t,o,s):(t[o]=s.value,t)};h?(Z||(xt.f=Ce,Lt.f=ke,addGetter(ie,"buffer"),addGetter(ie,"byteOffset"),addGetter(ie,"byteLength"),addGetter(ie,"length")),_export({target:"Object",stat:!0,forced:!Z},{getOwnPropertyDescriptor:Ce,defineProperty:ke}),t.exports=function(t,h,B){var K=t.match(/\d+/)[0]/8,se=t+(B?"Clamped":"")+"Array",Ce="get"+t,ke="set"+t,Se=l[se],Pe=Se,Re=Pe&&Pe.prototype,$e={},addElement=function(t,o){$(t,o,{get:function(){return function(t,o){var s=v(t);return s.view[Ce](o*K+s.byteOffset,!0)}(this,o)},set:function(t){return function(t,o,s){var l=v(t);B&&(s=(s=q(s))<0?0:s>255?255:255&s),l.view[ke](o*K+l.byteOffset,s,!0)}(this,o,t)},enumerable:!0})};Z?Nw&&(Pe=h((function(t,o,s,l){return anInstance(t,Re),inheritIfRequired(Ee(o)?isArrayBuffer(o)?void 0!==l?new Se(o,toOffset(s,K),l):void 0!==s?new Se(o,toOffset(s,K)):new Se(o):he(o)?fromList(Pe,o):_(Uw,Pe,o):new Se(toIndex(o)),t,Pe)})),Cn&&Cn(Pe,ne),s(o(Se),(function(t){t in Pe||Ft(Pe,t,Se[t])})),Pe.prototype=Re):(Pe=h((function(t,o,s,l){anInstance(t,Re);var h,v,R,$=0,B=0;if(Ee(o)){if(!isArrayBuffer(o))return he(o)?fromList(Pe,o):_(Uw,Pe,o);h=o,B=toOffset(s,K);var q=o.byteLength;if(void 0===l){if(q%K)throw j(_e);if((v=q-B)<0)throw j(_e)}else if((v=toLength(l)*K)+B>q)throw j(_e);R=v/K}else R=toIndex(o),h=new z(v=R*K);for(m(t,{buffer:h,byteOffset:B,byteLength:v,length:R,view:new W(h)});$<R;)addElement(t,$++)})),Cn&&Cn(Pe,ne),Re=Pe.prototype=qr(ie)),Re.constructor!==Pe&&Ft(Re,"constructor",Pe),R(Re).TypedArrayConstructor=Pe,te&&Ft(Re,te,se);var De=Pe!=Se;$e[se]=Pe,_export({global:!0,constructor:!0,forced:De,sham:!Z},$e),me in Pe||Ft(Pe,me,K),me in Re||Ft(Re,me,K),setSpecies(se)}):t.exports=function(){}}));Hw("Float32",(function(t){return function Float32Array(o,s,l){return t(this,o,s,l)}})),Hw("Float64",(function(t){return function Float64Array(o,s,l){return t(this,o,s,l)}})),Hw("Int8",(function(t){return function Int8Array(o,s,l){return t(this,o,s,l)}})),Hw("Int16",(function(t){return function Int16Array(o,s,l){return t(this,o,s,l)}})),Hw("Int32",(function(t){return function Int32Array(o,s,l){return t(this,o,s,l)}})),Hw("Uint8",(function(t){return function Uint8Array(o,s,l){return t(this,o,s,l)}})),Hw("Uint8",(function(t){return function Uint8ClampedArray(o,s,l){return t(this,o,s,l)}}),!0),Hw("Uint16",(function(t){return function Uint16Array(o,s,l){return t(this,o,s,l)}})),Hw("Uint32",(function(t){return function Uint32Array(o,s,l){return t(this,o,s,l)}}));var Bw=wd.aTypedArray;(0,wd.exportTypedArrayMethod)("at",(function at(t){var o=Bw(this),s=lengthOfArrayLike(o),l=toIntegerOrInfinity(t),h=l>=0?l:s+l;return h<0||h>=s?void 0:o[h]}));var qw=W(Fi),jw=wd.aTypedArray;(0,wd.exportTypedArrayMethod)("copyWithin",(function copyWithin(t,o){return qw(jw(this),t,o,arguments.length>2?arguments[2]:void 0)}));var zw=po.every,Vw=wd.aTypedArray;(0,wd.exportTypedArrayMethod)("every",(function every(t){return zw(Vw(this),t,arguments.length>1?arguments[1]:void 0)}));var Gw=wd.aTypedArray,Kw=wd.exportTypedArrayMethod,Ww=W("".slice);Kw("fill",(function fill(t){var o=arguments.length;Gw(this);var s="Big"===Ww($r(this),0,3)?toBigInt(t):+t;return _(rs,this,s,o>1?arguments[1]:void 0,o>2?arguments[2]:void 0)}),fails((function(){var t=0;return new Int8Array(2).fill({valueOf:function(){return t++}}),1!==t})));var Qw=wd.aTypedArrayConstructor,Yw=wd.getTypedArrayConstructor,typedArraySpeciesConstructor=function(t){return Qw(speciesConstructor(t,Yw(t)))},typedArrayFromSpeciesAndList=function(t,o){return arrayFromConstructorAndList(typedArraySpeciesConstructor(t),o)},Jw=po.filter,Xw=wd.aTypedArray;(0,wd.exportTypedArrayMethod)("filter",(function filter(t){var o=Jw(Xw(this),t,arguments.length>1?arguments[1]:void 0);return typedArrayFromSpeciesAndList(this,o)}));var Zw=po.find,e_=wd.aTypedArray;(0,wd.exportTypedArrayMethod)("find",(function find(t){return Zw(e_(this),t,arguments.length>1?arguments[1]:void 0)}));var t_=po.findIndex,r_=wd.aTypedArray;(0,wd.exportTypedArrayMethod)("findIndex",(function findIndex(t){return t_(r_(this),t,arguments.length>1?arguments[1]:void 0)}));var o_=hs.findLast,n_=wd.aTypedArray;(0,wd.exportTypedArrayMethod)("findLast",(function findLast(t){return o_(n_(this),t,arguments.length>1?arguments[1]:void 0)}));var i_=hs.findLastIndex,s_=wd.aTypedArray;(0,wd.exportTypedArrayMethod)("findLastIndex",(function findLastIndex(t){return i_(s_(this),t,arguments.length>1?arguments[1]:void 0)}));var a_=po.forEach,l_=wd.aTypedArray;(0,wd.exportTypedArrayMethod)("forEach",(function forEach(t){a_(l_(this),t,arguments.length>1?arguments[1]:void 0)})),(0,wd.exportTypedArrayStaticMethod)("from",Uw,Nw);var c_=ur.includes,d_=wd.aTypedArray;(0,wd.exportTypedArrayMethod)("includes",(function includes(t){return c_(d_(this),t,arguments.length>1?arguments[1]:void 0)}));var u_=ur.indexOf,h_=wd.aTypedArray;(0,wd.exportTypedArrayMethod)("indexOf",(function indexOf(t){return u_(h_(this),t,arguments.length>1?arguments[1]:void 0)}));var p_=wellKnownSymbol("iterator"),f_=l.Uint8Array,g_=W(Js.values),v_=W(Js.keys),m_=W(Js.entries),b_=wd.aTypedArray,y_=wd.exportTypedArrayMethod,w_=f_&&f_.prototype,C_=!fails((function(){w_[p_].call([1])})),k_=!!w_&&w_.values&&w_[p_]===w_.values&&"values"===w_.values.name,T_=function values(){return g_(b_(this))};y_("entries",(function entries(){return m_(b_(this))}),C_),y_("keys",(function keys(){return v_(b_(this))}),C_),y_("values",T_,C_||!k_,{name:"values"}),y_(p_,T_,C_||!k_,{name:"values"});var S_=wd.aTypedArray,x_=wd.exportTypedArrayMethod,E_=W([].join);x_("join",(function join(t){return E_(S_(this),t)}));var I_=wd.aTypedArray;(0,wd.exportTypedArrayMethod)("lastIndexOf",(function lastIndexOf(t){var o=arguments.length;return Ko(ca,I_(this),o>1?[t,arguments[1]]:[t])}));var A_=po.map,P_=wd.aTypedArray;(0,wd.exportTypedArrayMethod)("map",(function map(t){return A_(P_(this),t,arguments.length>1?arguments[1]:void 0,(function(t,o){return new(typedArraySpeciesConstructor(t))(o)}))}));var R_=wd.aTypedArrayConstructor;(0,wd.exportTypedArrayStaticMethod)("of",(function of(){for(var t=0,o=arguments.length,s=new(R_(this))(o);o>t;)s[t]=arguments[t++];return s}),Nw);var O_=Ua.left,$_=wd.aTypedArray;(0,wd.exportTypedArrayMethod)("reduce",(function reduce(t){var o=arguments.length;return O_($_(this),t,o,o>1?arguments[1]:void 0)}));var N_=Ua.right,M_=wd.aTypedArray;(0,wd.exportTypedArrayMethod)("reduceRight",(function reduceRight(t){var o=arguments.length;return N_(M_(this),t,o,o>1?arguments[1]:void 0)}));var D_=wd.aTypedArray,L_=wd.exportTypedArrayMethod,F_=Math.floor;L_("reverse",(function reverse(){for(var t,o=this,s=D_(o).length,l=F_(s/2),h=0;h<l;)t=o[h],o[h++]=o[--s],o[s]=t;return o}));var U_=l.RangeError,H_=l.Int8Array,B_=H_&&H_.prototype,q_=B_&&B_.set,j_=wd.aTypedArray,z_=wd.exportTypedArrayMethod,V_=!fails((function(){var t=new Uint8ClampedArray(2);return _(q_,t,{length:1,0:3},1),3!==t[1]})),G_=V_&&wd.NATIVE_ARRAY_BUFFER_VIEWS&&fails((function(){var t=new H_(2);return t.set(1),t.set("2",1),0!==t[0]||2!==t[1]}));z_("set",(function set(t){j_(this);var o=toOffset(arguments.length>1?arguments[1]:void 0,1),s=toObject(t);if(V_)return _(q_,this,s,o);var l=this.length,h=lengthOfArrayLike(s),v=0;if(h+o>l)throw U_("Wrong length");for(;v<h;)this[o+v]=s[v++]}),!V_||G_);var K_=wd.aTypedArray;(0,wd.exportTypedArrayMethod)("slice",(function slice(t,o){for(var s=Wo(K_(this),t,o),l=typedArraySpeciesConstructor(this),h=0,v=s.length,m=new l(v);v>h;)m[h]=s[h++];return m}),fails((function(){new Int8Array(1).slice()})));var W_=po.some,Q_=wd.aTypedArray;(0,wd.exportTypedArrayMethod)("some",(function some(t){return W_(Q_(this),t,arguments.length>1?arguments[1]:void 0)}));var Y_=wd.aTypedArray,J_=wd.exportTypedArrayMethod,X_=l.Uint16Array,Z_=X_&&functionUncurryThisClause(X_.prototype.sort),eC=!(!Z_||fails((function(){Z_(new X_(2),null)}))&&fails((function(){Z_(new X_(2),{})}))),tC=!!Z_&&!fails((function(){if(ze)return ze<74;if(pl)return pl<67;if(fl)return!0;if(vl)return vl<602;var t,o,s=new X_(516),l=Array(516);for(t=0;t<516;t++)o=t%4,s[t]=515-t,l[t]=t-2*o+3;for(Z_(s,(function(t,o){return(t/4|0)-(o/4|0)})),t=0;t<516;t++)if(s[t]!==l[t])return!0}));J_("sort",(function sort(t){return void 0!==t&&aCallable(t),tC?Z_(this,t):ul(Y_(this),function(t){return function(o,s){return void 0!==t?+t(o,s)||0:s!=s?-1:o!=o?1:0===o&&0===s?1/o>0&&1/s<0?1:-1:o>s}}(t))}),!tC||eC);var rC=wd.aTypedArray;(0,wd.exportTypedArrayMethod)("subarray",(function subarray(t,o){var s=rC(this),l=s.length,h=toAbsoluteIndex(t,l);return new(typedArraySpeciesConstructor(s))(s.buffer,s.byteOffset+h*s.BYTES_PER_ELEMENT,toLength((void 0===o?l:toAbsoluteIndex(o,l))-h))}));var oC=l.Int8Array,nC=wd.aTypedArray,iC=wd.exportTypedArrayMethod,sC=[].toLocaleString,aC=!!oC&&fails((function(){sC.call(new oC(1))}));iC("toLocaleString",(function toLocaleString(){return Ko(sC,aC?Wo(nC(this)):nC(this),Wo(arguments))}),fails((function(){return[1,2].toLocaleString()!=new oC([1,2]).toLocaleString()}))||!fails((function(){oC.prototype.toLocaleString.call([1,2])})));var lC=wd.aTypedArray,cC=wd.getTypedArrayConstructor;(0,wd.exportTypedArrayMethod)("toReversed",(function toReversed(){return arrayToReversed(lC(this),cC(this))}));var dC=wd.aTypedArray,uC=wd.getTypedArrayConstructor,hC=wd.exportTypedArrayMethod,pC=W(wd.TypedArrayPrototype.sort);hC("toSorted",(function toSorted(t){void 0!==t&&aCallable(t);var o=dC(this),s=arrayFromConstructorAndList(uC(o),o);return pC(s,t)}));var fC=wd.exportTypedArrayMethod,gC=l.Uint8Array,vC=gC&&gC.prototype||{},mC=[].toString,bC=W([].join);fails((function(){mC.call({})}))&&(mC=function toString(){return bC(this)});var yC=vC.toString!=mC;fC("toString",mC,yC);var wC=wd.aTypedArray,_C=wd.getTypedArrayConstructor,CC=wd.exportTypedArrayMethod,kC=!!function(){try{new Int8Array(1).with(2,{valueOf:function(){throw 8}})}catch(t){return 8===t}}();CC("with",{with:function(t,o){var s=wC(this),l=toIntegerOrInfinity(t),h=isBigIntArray(s)?toBigInt(o):+o;return arrayWith(s,_C(s),l,h)}}.with,!kC);var TC=String.fromCharCode,SC=W("".charAt),xC=W(/./.exec),EC=W("".slice),IC=/^[\da-f]{2}$/i,AC=/^[\da-f]{4}$/i;_export({global:!0},{unescape:function unescape(t){for(var o,s,l=toString_1(t),h="",v=l.length,m=0;m<v;){if("%"===(o=SC(l,m++)))if("u"===SC(l,m)){if(s=EC(l,m+1,m+5),xC(AC,s)){h+=TC(parseInt(s,16)),m+=5;continue}}else if(s=EC(l,m,m+2),xC(IC,s)){h+=TC(parseInt(s,16)),m+=2;continue}h+=o}return h}});var PC=Wu.getWeakData,RC=or.set,OC=or.getterFor,$C=po.find,NC=po.findIndex,MC=W([].splice),DC=0,uncaughtFrozenStore=function(t){return t.frozen||(t.frozen=new UncaughtFrozenStore)},UncaughtFrozenStore=function(){this.entries=[]},findUncaughtFrozen=function(t,o){return $C(t.entries,(function(t){return t[0]===o}))};UncaughtFrozenStore.prototype={get:function(t){var o=findUncaughtFrozen(this,t);if(o)return o[1]},has:function(t){return!!findUncaughtFrozen(this,t)},set:function(t,o){var s=findUncaughtFrozen(this,t);s?s[1]=o:this.entries.push([t,o])},delete:function(t){var o=NC(this.entries,(function(o){return o[0]===t}));return~o&&MC(this.entries,o,1),!!~o}};var LC,FC={getConstructor:function(t,o,s,l){var h=t((function(t,h){anInstance(t,v),RC(t,{type:o,id:DC++,frozen:void 0}),isNullOrUndefined(h)||iterate(h,t[l],{that:t,AS_ENTRIES:s})})),v=h.prototype,m=OC(o),define=function(t,o,s){var l=m(t),h=PC(anObject(o),!0);return!0===h?uncaughtFrozenStore(l).set(o,s):h[l.id]=s,t};return defineBuiltIns(v,{delete:function(t){var o=m(this);if(!Ee(t))return!1;var s=PC(t);return!0===s?uncaughtFrozenStore(o).delete(t):s&&ht(s,o.id)&&delete s[o.id]},has:function has(t){var o=m(this);if(!Ee(t))return!1;var s=PC(t);return!0===s?uncaughtFrozenStore(o).has(t):s&&ht(s,o.id)}}),defineBuiltIns(v,s?{get:function get(t){var o=m(this);if(Ee(t)){var s=PC(t);return!0===s?uncaughtFrozenStore(o).get(t):s?s[o.id]:void 0}},set:function set(t,o){return define(this,t,o)}}:{add:function add(t){return define(this,t,!0)}}),h}},UC=or.enforce,HC=Object,BC=Array.isArray,qC=HC.isExtensible,jC=HC.isFrozen,zC=HC.isSealed,VC=HC.freeze,GC=HC.seal,KC={},WC={},QC=!l.ActiveXObject&&"ActiveXObject"in l,wrapper=function(t){return function WeakMap(){return t(this,arguments.length?arguments[0]:void 0)}},YC=collection("WeakMap",wrapper,FC),JC=YC.prototype,XC=W(JC.set);if(Qt)if(QC){LC=FC.getConstructor(wrapper,"WeakMap",!0),Wu.enable();var ZC=W(JC.delete),ek=W(JC.has),tk=W(JC.get);defineBuiltIns(JC,{delete:function(t){if(Ee(t)&&!qC(t)){var o=UC(this);return o.frozen||(o.frozen=new LC),ZC(this,t)||o.frozen.delete(t)}return ZC(this,t)},has:function has(t){if(Ee(t)&&!qC(t)){var o=UC(this);return o.frozen||(o.frozen=new LC),ek(this,t)||o.frozen.has(t)}return ek(this,t)},get:function get(t){if(Ee(t)&&!qC(t)){var o=UC(this);return o.frozen||(o.frozen=new LC),ek(this,t)?tk(this,t):o.frozen.get(t)}return tk(this,t)},set:function set(t,o){if(Ee(t)&&!qC(t)){var s=UC(this);s.frozen||(s.frozen=new LC),ek(this,t)?XC(this,t,o):s.frozen.set(t,o)}else XC(this,t,o);return this}})}else Ku&&fails((function(){var t=VC([]);return XC(new YC,t,1),!jC(t)}))&&defineBuiltIns(JC,{set:function set(t,o){var s;return BC(t)&&(jC(t)?s=KC:zC(t)&&(s=WC)),XC(this,t,o),s==KC&&VC(t),s==WC&&GC(t),this}});collection("WeakSet",(function(t){return function WeakSet(){return t(this,arguments.length?arguments[0]:void 0)}}),FC);for(var rk="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ok={},nk=0;nk<66;nk++)ok[rk.charAt(nk)]=nk;var ik={itoc:rk,ctoi:ok},sk=ik.ctoi,ak=/[^\d+/a-z]/i,lk=/[\t\n\f\r ]+/g,ck=/[=]{1,2}$/,dk=getBuiltIn("atob"),uk=String.fromCharCode,hk=W("".charAt),pk=W("".replace),fk=W(ak.exec),gk=fails((function(){return""!==dk(" ")})),vk=!fails((function(){dk("a")})),mk=!gk&&!vk&&!fails((function(){dk()})),bk=!gk&&!vk&&1!==dk.length;_export({global:!0,bind:!0,enumerable:!0,forced:gk||vk||mk||bk},{atob:function atob(t){if(validateArgumentsLength(arguments.length,1),mk||bk)return _(dk,l,t);var o,s,h=pk(toString_1(t),lk,""),v="",m=0,R=0;if(h.length%4==0&&(h=pk(h,ck,"")),h.length%4==1||fk(ak,h))throw new(getBuiltIn("DOMException"))("The string is not correctly encoded","InvalidCharacterError");for(;o=hk(h,m++);)ht(sk,o)&&(s=R%4?64*s+sk[o]:sk[o],R++%4&&(v+=uk(255&s>>(-2*R&6))));return v}});var yk=ik.itoc,wk=getBuiltIn("btoa"),_k=W("".charAt),Ck=W("".charCodeAt),kk=!!wk&&!fails((function(){wk()})),Tk=!!wk&&fails((function(){return"bnVsbA=="!==wk(null)})),Sk=!!wk&&1!==wk.length;_export({global:!0,bind:!0,enumerable:!0,forced:kk||Tk||Sk},{btoa:function btoa(t){if(validateArgumentsLength(arguments.length,1),kk||Tk||Sk)return _(wk,l,toString_1(t));for(var o,s,h=toString_1(t),v="",m=0,R=yk;_k(h,m)||(R="=",m%1);){if((s=Ck(h,m+=3/4))>255)throw new(getBuiltIn("DOMException"))("The string contains characters outside of the Latin1 range","InvalidCharacterError");v+=_k(R,63&(o=o<<8|s)>>8-m%1*8)}return v}});var xk={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Ek=documentCreateElement("span").classList,Ik=Ek&&Ek.constructor&&Ek.constructor.prototype,Ak=Ik===Object.prototype?void 0:Ik,handlePrototype$1=function(t){if(t&&t.forEach!==ms)try{Ft(t,"forEach",ms)}catch(o){t.forEach=ms}};for(var Pk in xk)xk[Pk]&&handlePrototype$1(l[Pk]&&l[Pk].prototype);handlePrototype$1(Ak);var Rk=wellKnownSymbol("iterator"),Ok=wellKnownSymbol("toStringTag"),$k=Js.values,handlePrototype=function(t,o){if(t){if(t[Rk]!==$k)try{Ft(t,Rk,$k)}catch(o){t[Rk]=$k}if(t[Ok]||Ft(t,Ok,o),xk[o])for(var s in Js)if(t[s]!==Js[s])try{Ft(t,s,Js[s])}catch(o){t[s]=Js[s]}}};for(var Nk in xk)handlePrototype(l[Nk]&&l[Nk].prototype,Nk);handlePrototype(Ak,"DOMTokenList");var Mk={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}},Dk=Lt.f,Lk="DOMException",Fk="DATA_CLONE_ERR",Uk=getBuiltIn("Error"),Hk=getBuiltIn(Lk)||function(){try{var t=getBuiltIn("MessageChannel")||function(t){try{if(qa)return Function('return require("'+t+'")')()}catch(t){}}("worker_threads").MessageChannel;(new t).port1.postMessage(new WeakMap)}catch(t){if(t.name==Fk&&25==t.code)return t.constructor}}(),Bk=Hk&&Hk.prototype,qk=Uk.prototype,jk=or.set,zk=or.getterFor(Lk),Vk="stack"in Uk(Lk),codeFor=function(t){return ht(Mk,t)&&Mk[t].m?Mk[t].c:0},Gk=function DOMException(){anInstance(this,Kk);var t=arguments.length,o=normalizeStringArgument(t<1?void 0:arguments[0]),s=normalizeStringArgument(t<2?void 0:arguments[1],"Error"),l=codeFor(s);if(jk(this,{type:Lk,name:s,message:o,code:l}),h||(this.name=s,this.message=o,this.code=l),Vk){var v=Uk(o);v.name=Lk,Dk(this,"stack",createPropertyDescriptor(1,errorStackClear(v.stack,1)))}},Kk=Gk.prototype=qr(qk),createGetterDescriptor=function(t){return{enumerable:!0,configurable:!0,get:t}},getterFor=function(t){return createGetterDescriptor((function(){return zk(this)[t]}))};h&&(defineBuiltInAccessor(Kk,"code",getterFor("code")),defineBuiltInAccessor(Kk,"message",getterFor("message")),defineBuiltInAccessor(Kk,"name",getterFor("name"))),Dk(Kk,"constructor",createPropertyDescriptor(1,Gk));var Wk=fails((function(){return!(new Hk instanceof Uk)})),Qk=Wk||fails((function(){return qk.toString!==Mn||"2: 1"!==String(new Hk(1,2))})),Yk=Wk||fails((function(){return 25!==new Hk(1,"DataCloneError").code}));Wk||25!==Hk[Fk]||Bk[Fk];_export({global:!0,constructor:!0,forced:Wk},{DOMException:Wk?Gk:Hk});var Jk=getBuiltIn(Lk),Xk=Jk.prototype;for(var Zk in Qk&&Hk===Jk&&defineBuiltIn(Xk,"toString",Mn),Yk&&h&&Hk===Jk&&defineBuiltInAccessor(Xk,"code",createGetterDescriptor((function(){return codeFor(anObject(this).name)}))),Mk)if(ht(Mk,Zk)){var eT=Mk[Zk],tT=eT.s,rT=createPropertyDescriptor(6,eT.c);ht(Jk,tT)||Dk(Jk,tT,rT),ht(Xk,tT)||Dk(Xk,tT,rT)}var oT=Lt.f,nT="DOMException",iT=getBuiltIn("Error"),sT=getBuiltIn(nT),aT=function DOMException(){anInstance(this,lT);var t=arguments.length,o=normalizeStringArgument(t<1?void 0:arguments[0]),s=normalizeStringArgument(t<2?void 0:arguments[1],"Error"),l=new sT(o,s),h=iT(o);return h.name=nT,oT(l,"stack",createPropertyDescriptor(1,errorStackClear(h.stack,1))),inheritIfRequired(l,this,aT),l},lT=aT.prototype=sT.prototype,cT="stack"in iT(nT),dT="stack"in new sT(1,2),uT=sT&&h&&Object.getOwnPropertyDescriptor(l,nT),hT=!(!uT||uT.writable&&uT.configurable),pT=cT&&!hT&&!dT;_export({global:!0,constructor:!0,forced:pT},{DOMException:pT?aT:sT});var fT=getBuiltIn(nT),gT=fT.prototype;if(gT.constructor!==fT)for(var vT in oT(gT,"constructor",createPropertyDescriptor(1,fT)),Mk)if(ht(Mk,vT)){var mT=Mk[vT],bT=mT.s;ht(fT,bT)||oT(fT,bT,createPropertyDescriptor(6,mT.c))}var yT="DOMException";setToStringTag(getBuiltIn(yT),yT);var wT=gv.clear;_export({global:!0,bind:!0,enumerable:!0,forced:l.clearImmediate!==wT},{clearImmediate:wT});var _T="function"==typeof Bun&&Bun&&"string"==typeof Bun.version,CT=l.Function,kT=/MSIE .\./.test(Re)||_T&&function(){var t=l.Bun.version.split(".");return t.length<3||0==t[0]&&(t[1]<3||3==t[1]&&0==t[2])}(),schedulersFix=function(t,o){var s=o?2:1;return kT?function(l,h){var v=validateArgumentsLength(arguments.length,1)>s,m=ke(l)?l:CT(l),_=v?Wo(arguments,s):[],R=v?function(){Ko(m,this,_)}:m;return o?t(R,h):t(R)}:t},TT=gv.set,ST=l.setImmediate?schedulersFix(TT,!1):TT;_export({global:!0,bind:!0,enumerable:!0,forced:l.setImmediate!==ST},{setImmediate:ST});var xT=l.process;_export({global:!0,enumerable:!0,dontCallGetSet:!0},{queueMicrotask:function queueMicrotask(t){validateArgumentsLength(arguments.length,1),aCallable(t);var o=qa&&xT.domain;$v(o?o.bind(t):t)}});var ET=TypeError,IT=Object.defineProperty,AT=l.self!==l;try{if(h){var PT=Object.getOwnPropertyDescriptor(l,"self");!AT&&PT&&PT.get&&PT.enumerable||defineBuiltInAccessor(l,"self",{get:function self(){return l},set:function self(t){if(this!==l)throw ET("Illegal invocation");IT(l,"self",{value:t,writable:!0,configurable:!0,enumerable:!0})},configurable:!0,enumerable:!0})}else _export({global:!0,simple:!0,forced:AT},{self:l})}catch(t){}var RT,OT=Map.prototype,$T={Map:Map,set:W(OT.set),get:W(OT.get),has:W(OT.has),remove:W(OT.delete),proto:OT},NT=Set.prototype,MT={Set:Set,add:W(NT.add),has:W(NT.has),remove:W(NT.delete),proto:NT,$has:NT.has,$keys:NT.keys},DT=l.structuredClone,LT=!!DT&&!fails((function(){if(Mv&&ze>92||qa&&ze>94||Dv&&ze>97)return!1;var t=new ArrayBuffer(8),o=DT(t,{transfer:[t]});return 0!=t.byteLength||8!=o.byteLength})),FT=l.Object,UT=l.Array,HT=l.Date,BT=l.Error,qT=l.EvalError,jT=l.RangeError,zT=l.ReferenceError,VT=l.SyntaxError,GT=l.TypeError,KT=l.URIError,WT=l.PerformanceMark,QT=l.WebAssembly,YT=QT&&QT.CompileError||BT,JT=QT&&QT.LinkError||BT,XT=QT&&QT.RuntimeError||BT,ZT=getBuiltIn("DOMException"),eS=$T.Map,tS=$T.has,rS=$T.get,oS=$T.set,nS=MT.Set,iS=MT.add,sS=getBuiltIn("Object","keys"),aS=W([].push),lS=W((!0).valueOf),cS=W(1..valueOf),dS=W("".valueOf),uS=W(HT.prototype.getTime),hS=uid("structuredClone"),pS="DataCloneError",fS="Transferring",checkBasicSemantic=function(t){return!fails((function(){var o=new l.Set([7]),s=t(o),h=t(FT(7));return s==o||!s.has(7)||"object"!=typeof h||7!=h}))&&t},checkErrorsCloning=function(t,o){return!fails((function(){var s=new o,l=t({a:s,b:s});return!(l&&l.a===l.b&&l.a instanceof o&&l.a.stack===s.stack)}))},gS=l.structuredClone,vS=!checkErrorsCloning(gS,BT)||!checkErrorsCloning(gS,ZT)||(RT=gS,!!fails((function(){var t=RT(new l.AggregateError([1],hS,{cause:3}));return"AggregateError"!=t.name||1!=t.errors[0]||t.message!=hS||3!=t.cause}))),mS=!gS&&checkBasicSemantic((function(t){return new WT(hS,{detail:t}).detail})),bS=checkBasicSemantic(gS)||mS,throwUncloneable=function(t){throw new ZT("Uncloneable type: "+t,pS)},throwUnpolyfillable=function(t,o){throw new ZT((o||"Cloning")+" of "+t+" cannot be properly polyfilled in this engine",pS)},structuredCloneInternal=function(t,o){if(tt(t)&&throwUncloneable("Symbol"),!Ee(t))return t;if(o){if(tS(o,t))return rS(o,t)}else o=new eS;var s,h,v,m,_,R,$,B,q,j,z=$r(t),K=!1;switch(z){case"Array":v=UT(lengthOfArrayLike(t)),K=!0;break;case"Object":v={},K=!0;break;case"Map":v=new eS,K=!0;break;case"Set":v=new nS,K=!0;break;case"RegExp":v=new RegExp(t.source,regexpGetFlags(t));break;case"Error":switch(h=t.name){case"AggregateError":v=getBuiltIn("AggregateError")([]);break;case"EvalError":v=qT();break;case"RangeError":v=jT();break;case"ReferenceError":v=zT();break;case"SyntaxError":v=VT();break;case"TypeError":v=GT();break;case"URIError":v=KT();break;case"CompileError":v=YT();break;case"LinkError":v=JT();break;case"RuntimeError":v=XT();break;default:v=BT()}K=!0;break;case"DOMException":v=new ZT(t.message,t.name),K=!0;break;case"DataView":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":s=l[z],Ee(s)||throwUnpolyfillable(z),v=new s(structuredCloneInternal(t.buffer,o),t.byteOffset,"DataView"===z?t.byteLength:t.length);break;case"DOMQuad":try{v=new DOMQuad(structuredCloneInternal(t.p1,o),structuredCloneInternal(t.p2,o),structuredCloneInternal(t.p3,o),structuredCloneInternal(t.p4,o))}catch(o){bS?v=bS(t):throwUnpolyfillable(z)}break;case"FileList":if(m=function(){var t;try{t=new l.DataTransfer}catch(o){try{t=new l.ClipboardEvent("").clipboardData}catch(t){}}return t&&t.items&&t.files?t:null}()){for(_=0,R=lengthOfArrayLike(t);_<R;_++)m.items.add(structuredCloneInternal(t[_],o));v=m.files}else bS?v=bS(t):throwUnpolyfillable(z);break;case"ImageData":try{v=new ImageData(structuredCloneInternal(t.data,o),t.width,t.height,{colorSpace:t.colorSpace})}catch(o){bS?v=bS(t):throwUnpolyfillable(z)}break;default:if(bS)v=bS(t);else switch(z){case"BigInt":v=FT(t.valueOf());break;case"Boolean":v=FT(lS(t));break;case"Number":v=FT(cS(t));break;case"String":v=FT(dS(t));break;case"Date":v=new HT(uS(t));break;case"ArrayBuffer":(s=l.DataView)||"function"==typeof t.slice||throwUnpolyfillable(z);try{if("function"==typeof t.slice)v=t.slice(0);else for(R=t.byteLength,v=new ArrayBuffer(R),q=new s(t),j=new s(v),_=0;_<R;_++)j.setUint8(_,q.getUint8(_))}catch(t){throw new ZT("ArrayBuffer is detached",pS)}break;case"SharedArrayBuffer":v=t;break;case"Blob":try{v=t.slice(0,t.size,t.type)}catch(t){throwUnpolyfillable(z)}break;case"DOMPoint":case"DOMPointReadOnly":s=l[z];try{v=s.fromPoint?s.fromPoint(t):new s(t.x,t.y,t.z,t.w)}catch(t){throwUnpolyfillable(z)}break;case"DOMRect":case"DOMRectReadOnly":s=l[z];try{v=s.fromRect?s.fromRect(t):new s(t.x,t.y,t.width,t.height)}catch(t){throwUnpolyfillable(z)}break;case"DOMMatrix":case"DOMMatrixReadOnly":s=l[z];try{v=s.fromMatrix?s.fromMatrix(t):new s(t)}catch(t){throwUnpolyfillable(z)}break;case"AudioData":case"VideoFrame":ke(t.clone)||throwUnpolyfillable(z);try{v=t.clone()}catch(t){throwUncloneable(z)}break;case"File":try{v=new File([t],t.name,t)}catch(t){throwUnpolyfillable(z)}break;case"CropTarget":case"CryptoKey":case"FileSystemDirectoryHandle":case"FileSystemFileHandle":case"FileSystemHandle":case"GPUCompilationInfo":case"GPUCompilationMessage":case"ImageBitmap":case"RTCCertificate":case"WebAssembly.Module":throwUnpolyfillable(z);default:throwUncloneable(z)}}if(oS(o,t,v),K)switch(z){case"Array":case"Object":for($=sS(t),_=0,R=lengthOfArrayLike($);_<R;_++)B=$[_],createProperty(v,B,structuredCloneInternal(t[B],o));break;case"Map":t.forEach((function(t,s){oS(v,structuredCloneInternal(s,o),structuredCloneInternal(t,o))}));break;case"Set":t.forEach((function(t){iS(v,structuredCloneInternal(t,o))}));break;case"Error":Ft(v,"message",structuredCloneInternal(t.message,o)),ht(t,"cause")&&Ft(v,"cause",structuredCloneInternal(t.cause,o)),"AggregateError"==h&&(v.errors=structuredCloneInternal(t.errors,o));case"DOMException":An&&Ft(v,"stack",structuredCloneInternal(t.stack,o))}return v},tryToTransfer=function(t,o){if(!Ee(t))throw GT("Transfer option cannot be converted to a sequence");var s=[];iterate(t,(function(t){aS(s,anObject(t))}));var h,v,m,_,R,$,B=0,q=lengthOfArrayLike(s);if(LT)for(_=gS(s,{transfer:s});B<q;)oS(o,s[B],_[B++]);else for(;B<q;){if(h=s[B++],tS(o,h))throw new ZT("Duplicate transferable",pS);switch(v=$r(h)){case"ImageBitmap":m=l.OffscreenCanvas,lo(m)||throwUnpolyfillable(v,fS);try{($=new m(h.width,h.height)).getContext("bitmaprenderer").transferFromImageBitmap(h),R=$.transferToImageBitmap()}catch(t){}break;case"AudioData":case"VideoFrame":ke(h.clone)&&ke(h.close)||throwUnpolyfillable(v,fS);try{R=h.clone(),h.close()}catch(t){}break;case"ArrayBuffer":ke(h.transfer)||throwUnpolyfillable(v,fS),R=h.transfer();break;case"MediaSourceHandle":case"MessagePort":case"OffscreenCanvas":case"ReadableStream":case"TransformStream":case"WritableStream":throwUnpolyfillable(v,fS)}if(void 0===R)throw new ZT("This object cannot be transferred: "+v,pS);oS(o,h,R)}};_export({global:!0,enumerable:!0,sham:!LT,forced:vS},{structuredClone:function structuredClone(t){var o,s=validateArgumentsLength(arguments.length,1)>1&&!isNullOrUndefined(arguments[1])?anObject(arguments[1]):void 0,l=s?s.transfer:void 0;return void 0!==l&&(o=new eS,tryToTransfer(l,o)),structuredCloneInternal(t,o)}});var yS=schedulersFix(l.setInterval,!0);_export({global:!0,bind:!0,forced:l.setInterval!==yS},{setInterval:yS});var wS=schedulersFix(l.setTimeout,!0);_export({global:!0,bind:!0,forced:l.setTimeout!==wS},{setTimeout:wS});var _S=wellKnownSymbol("iterator"),CS=!fails((function(){var t=new URL("b?a=1&b=2&c=3","http://a"),o=t.searchParams,s="";return t.pathname="c%20d",o.forEach((function(t,l){o.delete("b"),s+=l+t})),!o.sort||"http://a/c%20d?a=1&c=3"!==t.href||"3"!==o.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!o[_S]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://ÑÐµÑÑ").host||"#%D0%B1"!==new URL("http://a#Ð±").hash||"a1c3"!==s||"x"!==new URL("http://x",void 0).host})),kS=2147483647,TS=/[^\0-\u007E]/,SS=/[.\u3002\uFF0E\uFF61]/g,xS="Overflow: input needs wider integers to process",ES=RangeError,IS=W(SS.exec),AS=Math.floor,PS=String.fromCharCode,RS=W("".charCodeAt),OS=W([].join),$S=W([].push),NS=W("".replace),MS=W("".split),DS=W("".toLowerCase),digitToBasic=function(t){return t+22+75*(t<26)},adapt=function(t,o,s){var l=0;for(t=s?AS(t/700):t>>1,t+=AS(t/o);t>455;)t=AS(t/35),l+=36;return AS(l+36*t/(t+38))},encode=function(t){var o=[];t=function(t){for(var o=[],s=0,l=t.length;s<l;){var h=RS(t,s++);if(h>=55296&&h<=56319&&s<l){var v=RS(t,s++);56320==(64512&v)?$S(o,((1023&h)<<10)+(1023&v)+65536):($S(o,h),s--)}else $S(o,h)}return o}(t);var s,l,h=t.length,v=128,m=0,_=72;for(s=0;s<t.length;s++)(l=t[s])<128&&$S(o,PS(l));var R=o.length,$=R;for(R&&$S(o,"-");$<h;){var B=kS;for(s=0;s<t.length;s++)(l=t[s])>=v&&l<B&&(B=l);var q=$+1;if(B-v>AS((kS-m)/q))throw ES(xS);for(m+=(B-v)*q,v=B,s=0;s<t.length;s++){if((l=t[s])<v&&++m>kS)throw ES(xS);if(l==v){for(var j=m,z=36;;){var K=z<=_?1:z>=_+26?26:z-_;if(j<K)break;var W=j-K,Z=36-K;$S(o,PS(digitToBasic(K+W%Z))),j=AS(W/Z),z+=36}$S(o,PS(digitToBasic(j))),_=adapt(m,q,$==R),m=0,$++}}m++,v++}return OS(o,"")},LS=wellKnownSymbol("iterator"),FS="URLSearchParams",US=FS+"Iterator",HS=or.set,BS=or.getterFor(FS),qS=or.getterFor(US),jS=Object.getOwnPropertyDescriptor,safeGetBuiltIn=function(t){if(!h)return l[t];var o=jS(l,t);return o&&o.value},zS=safeGetBuiltIn("fetch"),VS=safeGetBuiltIn("Request"),GS=safeGetBuiltIn("Headers"),KS=VS&&VS.prototype,WS=GS&&GS.prototype,QS=l.RegExp,YS=l.TypeError,JS=l.decodeURIComponent,XS=l.encodeURIComponent,ZS=W("".charAt),ex=W([].join),tx=W([].push),rx=W("".replace),ox=W([].shift),nx=W([].splice),ix=W("".split),sx=W("".slice),ax=/\+/g,lx=Array(4),percentSequence=function(t){return lx[t-1]||(lx[t-1]=QS("((?:%[\\da-f]{2}){"+t+"})","gi"))},percentDecode=function(t){try{return JS(t)}catch(o){return t}},deserialize=function(t){var o=rx(t,ax," "),s=4;try{return JS(o)}catch(t){for(;s;)o=rx(o,percentSequence(s--),percentDecode);return o}},cx=/[!'()~]|%20/g,dx={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},replacer=function(t){return dx[t]},serialize=function(t){return rx(XS(t),cx,replacer)},ux=iteratorCreateConstructor((function Iterator(t,o){HS(this,{type:US,iterator:getIterator(BS(t).entries),kind:o})}),"Iterator",(function next(){var t=qS(this),o=t.kind,s=t.iterator.next(),l=s.value;return s.done||(s.value="keys"===o?l.key:"values"===o?l.value:[l.key,l.value]),s}),!0),URLSearchParamsState=function(t){this.entries=[],this.url=null,void 0!==t&&(Ee(t)?this.parseObject(t):this.parseQuery("string"==typeof t?"?"===ZS(t,0)?sx(t,1):t:toString_1(t)))};URLSearchParamsState.prototype={type:FS,bindURL:function(t){this.url=t,this.update()},parseObject:function(t){var o,s,l,h,v,m,R,$=getIteratorMethod(t);if($)for(s=(o=getIterator(t,$)).next;!(l=_(s,o)).done;){if(v=(h=getIterator(anObject(l.value))).next,(m=_(v,h)).done||(R=_(v,h)).done||!_(v,h).done)throw YS("Expected sequence with length 2");tx(this.entries,{key:toString_1(m.value),value:toString_1(R.value)})}else for(var B in t)ht(t,B)&&tx(this.entries,{key:B,value:toString_1(t[B])})},parseQuery:function(t){if(t)for(var o,s,l=ix(t,"&"),h=0;h<l.length;)(o=l[h++]).length&&(s=ix(o,"="),tx(this.entries,{key:deserialize(ox(s)),value:deserialize(ex(s,"="))}))},serialize:function(){for(var t,o=this.entries,s=[],l=0;l<o.length;)t=o[l++],tx(s,serialize(t.key)+"="+serialize(t.value));return ex(s,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var hx=function URLSearchParams(){anInstance(this,px),HS(this,new URLSearchParamsState(arguments.length>0?arguments[0]:void 0))},px=hx.prototype;if(defineBuiltIns(px,{append:function append(t,o){validateArgumentsLength(arguments.length,2);var s=BS(this);tx(s.entries,{key:toString_1(t),value:toString_1(o)}),s.updateURL()},delete:function(t){validateArgumentsLength(arguments.length,1);for(var o=BS(this),s=o.entries,l=toString_1(t),h=0;h<s.length;)s[h].key===l?nx(s,h,1):h++;o.updateURL()},get:function get(t){validateArgumentsLength(arguments.length,1);for(var o=BS(this).entries,s=toString_1(t),l=0;l<o.length;l++)if(o[l].key===s)return o[l].value;return null},getAll:function getAll(t){validateArgumentsLength(arguments.length,1);for(var o=BS(this).entries,s=toString_1(t),l=[],h=0;h<o.length;h++)o[h].key===s&&tx(l,o[h].value);return l},has:function has(t){validateArgumentsLength(arguments.length,1);for(var o=BS(this).entries,s=toString_1(t),l=0;l<o.length;)if(o[l++].key===s)return!0;return!1},set:function set(t,o){validateArgumentsLength(arguments.length,1);for(var s,l=BS(this),h=l.entries,v=!1,m=toString_1(t),_=toString_1(o),R=0;R<h.length;R++)(s=h[R]).key===m&&(v?nx(h,R--,1):(v=!0,s.value=_));v||tx(h,{key:m,value:_}),l.updateURL()},sort:function sort(){var t=BS(this);ul(t.entries,(function(t,o){return t.key>o.key?1:-1})),t.updateURL()},forEach:function forEach(t){for(var o,s=BS(this).entries,l=functionBindContext(t,arguments.length>1?arguments[1]:void 0),h=0;h<s.length;)l((o=s[h++]).value,o.key,this)},keys:function keys(){return new ux(this,"keys")},values:function values(){return new ux(this,"values")},entries:function entries(){return new ux(this,"entries")}},{enumerable:!0}),defineBuiltIn(px,LS,px.entries,{name:"entries"}),defineBuiltIn(px,"toString",(function toString(){return BS(this).serialize()}),{enumerable:!0}),setToStringTag(hx,FS),_export({global:!0,constructor:!0,forced:!CS},{URLSearchParams:hx}),!CS&&ke(GS)){var fx=W(WS.has),gx=W(WS.set),wrapRequestOptions=function(t){if(Ee(t)){var o,s=t.body;if($r(s)===FS)return o=t.headers?new GS(t.headers):new GS,fx(o,"content-type")||gx(o,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),qr(t,{body:createPropertyDescriptor(0,toString_1(s)),headers:createPropertyDescriptor(0,o)})}return t};if(ke(zS)&&_export({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function fetch(t){return zS(t,arguments.length>1?wrapRequestOptions(arguments[1]):{})}}),ke(VS)){var vx=function Request(t){return anInstance(this,KS),new VS(t,arguments.length>1?wrapRequestOptions(arguments[1]):{})};KS.constructor=vx,vx.prototype=KS,_export({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:vx})}}var mx,bx={URLSearchParams:hx,getState:BS},yx=Xb.codeAt,wx=or.set,_x=or.getterFor("URL"),Cx=bx.URLSearchParams,kx=bx.getState,Tx=l.URL,Sx=l.TypeError,xx=l.parseInt,Ex=Math.floor,Ix=Math.pow,Ax=W("".charAt),Px=W(/./.exec),Rx=W([].join),Ox=W(1..toString),$x=W([].pop),Nx=W([].push),Mx=W("".replace),Dx=W([].shift),Lx=W("".split),Fx=W("".slice),Ux=W("".toLowerCase),Hx=W([].unshift),Bx="Invalid scheme",qx="Invalid host",jx="Invalid port",zx=/[a-z]/i,Vx=/[\d+-.a-z]/i,Gx=/\d/,Kx=/^0x/i,Wx=/^[0-7]+$/,Qx=/^\d+$/,Yx=/^[\da-f]+$/i,Jx=/[\0\t\n\r #%/:<>?@[\\\]^|]/,Xx=/[\0\t\n\r #/:<>?@[\\\]^|]/,Zx=/^[\u0000-\u0020]+/,eE=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,tE=/[\t\n\r]/g,serializeHost=function(t){var o,s,l,h;if("number"==typeof t){for(o=[],s=0;s<4;s++)Hx(o,t%256),t=Ex(t/256);return Rx(o,".")}if("object"==typeof t){for(o="",l=function(t){for(var o=null,s=1,l=null,h=0,v=0;v<8;v++)0!==t[v]?(h>s&&(o=l,s=h),l=null,h=0):(null===l&&(l=v),++h);return h>s&&(o=l,s=h),o}(t),s=0;s<8;s++)h&&0===t[s]||(h&&(h=!1),l===s?(o+=s?":":"::",h=!0):(o+=Ox(t[s],16),s<7&&(o+=":")));return"["+o+"]"}return t},rE={},oE=eg({},rE,{" ":1,'"':1,"<":1,">":1,"`":1}),nE=eg({},oE,{"#":1,"?":1,"{":1,"}":1}),iE=eg({},nE,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),percentEncode=function(t,o){var s=yx(t,0);return s>32&&s<127&&!ht(o,t)?t:encodeURIComponent(t)},sE={ftp:21,file:null,http:80,https:443,ws:80,wss:443},isWindowsDriveLetter=function(t,o){var s;return 2==t.length&&Px(zx,Ax(t,0))&&(":"==(s=Ax(t,1))||!o&&"|"==s)},startsWithWindowsDriveLetter=function(t){var o;return t.length>1&&isWindowsDriveLetter(Fx(t,0,2))&&(2==t.length||"/"===(o=Ax(t,2))||"\\"===o||"?"===o||"#"===o)},isSingleDot=function(t){return"."===t||"%2e"===Ux(t)},aE={},lE={},cE={},dE={},uE={},hE={},pE={},fE={},gE={},vE={},mE={},bE={},yE={},wE={},_E={},CE={},kE={},TE={},SE={},xE={},EE={},URLState=function(t,o,s){var l,h,v,m=toString_1(t);if(o){if(h=this.parse(m))throw Sx(h);this.searchParams=null}else{if(void 0!==s&&(l=new URLState(s,!0)),h=this.parse(m,null,l))throw Sx(h);(v=kx(new Cx)).bindURL(this),this.searchParams=v}};URLState.prototype={type:"URL",parse:function(t,o,s){var l,h,v,m,_,R=this,$=o||aE,B=0,q="",j=!1,z=!1,K=!1;for(t=toString_1(t),o||(R.scheme="",R.username="",R.password="",R.host=null,R.port=null,R.path=[],R.query=null,R.fragment=null,R.cannotBeABaseURL=!1,t=Mx(t,Zx,""),t=Mx(t,eE,"$1")),t=Mx(t,tE,""),l=ys(t);B<=l.length;){switch(h=l[B],$){case aE:if(!h||!Px(zx,h)){if(o)return Bx;$=cE;continue}q+=Ux(h),$=lE;break;case lE:if(h&&(Px(Vx,h)||"+"==h||"-"==h||"."==h))q+=Ux(h);else{if(":"!=h){if(o)return Bx;q="",$=cE,B=0;continue}if(o&&(R.isSpecial()!=ht(sE,q)||"file"==q&&(R.includesCredentials()||null!==R.port)||"file"==R.scheme&&!R.host))return;if(R.scheme=q,o)return void(R.isSpecial()&&sE[R.scheme]==R.port&&(R.port=null));q="","file"==R.scheme?$=wE:R.isSpecial()&&s&&s.scheme==R.scheme?$=dE:R.isSpecial()?$=fE:"/"==l[B+1]?($=uE,B++):(R.cannotBeABaseURL=!0,Nx(R.path,""),$=SE)}break;case cE:if(!s||s.cannotBeABaseURL&&"#"!=h)return Bx;if(s.cannotBeABaseURL&&"#"==h){R.scheme=s.scheme,R.path=arraySliceSimple(s.path),R.query=s.query,R.fragment="",R.cannotBeABaseURL=!0,$=EE;break}$="file"==s.scheme?wE:hE;continue;case dE:if("/"!=h||"/"!=l[B+1]){$=hE;continue}$=gE,B++;break;case uE:if("/"==h){$=vE;break}$=TE;continue;case hE:if(R.scheme=s.scheme,h==mx)R.username=s.username,R.password=s.password,R.host=s.host,R.port=s.port,R.path=arraySliceSimple(s.path),R.query=s.query;else if("/"==h||"\\"==h&&R.isSpecial())$=pE;else if("?"==h)R.username=s.username,R.password=s.password,R.host=s.host,R.port=s.port,R.path=arraySliceSimple(s.path),R.query="",$=xE;else{if("#"!=h){R.username=s.username,R.password=s.password,R.host=s.host,R.port=s.port,R.path=arraySliceSimple(s.path),R.path.length--,$=TE;continue}R.username=s.username,R.password=s.password,R.host=s.host,R.port=s.port,R.path=arraySliceSimple(s.path),R.query=s.query,R.fragment="",$=EE}break;case pE:if(!R.isSpecial()||"/"!=h&&"\\"!=h){if("/"!=h){R.username=s.username,R.password=s.password,R.host=s.host,R.port=s.port,$=TE;continue}$=vE}else $=gE;break;case fE:if($=gE,"/"!=h||"/"!=Ax(q,B+1))continue;B++;break;case gE:if("/"!=h&&"\\"!=h){$=vE;continue}break;case vE:if("@"==h){j&&(q="%40"+q),j=!0,v=ys(q);for(var W=0;W<v.length;W++){var Z=v[W];if(":"!=Z||K){var te=percentEncode(Z,iE);K?R.password+=te:R.username+=te}else K=!0}q=""}else if(h==mx||"/"==h||"?"==h||"#"==h||"\\"==h&&R.isSpecial()){if(j&&""==q)return"Invalid authority";B-=ys(q).length+1,q="",$=mE}else q+=h;break;case mE:case bE:if(o&&"file"==R.scheme){$=CE;continue}if(":"!=h||z){if(h==mx||"/"==h||"?"==h||"#"==h||"\\"==h&&R.isSpecial()){if(R.isSpecial()&&""==q)return qx;if(o&&""==q&&(R.includesCredentials()||null!==R.port))return;if(m=R.parseHost(q))return m;if(q="",$=kE,o)return;continue}"["==h?z=!0:"]"==h&&(z=!1),q+=h}else{if(""==q)return qx;if(m=R.parseHost(q))return m;if(q="",$=yE,o==bE)return}break;case yE:if(!Px(Gx,h)){if(h==mx||"/"==h||"?"==h||"#"==h||"\\"==h&&R.isSpecial()||o){if(""!=q){var ne=xx(q,10);if(ne>65535)return jx;R.port=R.isSpecial()&&ne===sE[R.scheme]?null:ne,q=""}if(o)return;$=kE;continue}return jx}q+=h;break;case wE:if(R.scheme="file","/"==h||"\\"==h)$=_E;else{if(!s||"file"!=s.scheme){$=TE;continue}if(h==mx)R.host=s.host,R.path=arraySliceSimple(s.path),R.query=s.query;else if("?"==h)R.host=s.host,R.path=arraySliceSimple(s.path),R.query="",$=xE;else{if("#"!=h){startsWithWindowsDriveLetter(Rx(arraySliceSimple(l,B),""))||(R.host=s.host,R.path=arraySliceSimple(s.path),R.shortenPath()),$=TE;continue}R.host=s.host,R.path=arraySliceSimple(s.path),R.query=s.query,R.fragment="",$=EE}}break;case _E:if("/"==h||"\\"==h){$=CE;break}s&&"file"==s.scheme&&!startsWithWindowsDriveLetter(Rx(arraySliceSimple(l,B),""))&&(isWindowsDriveLetter(s.path[0],!0)?Nx(R.path,s.path[0]):R.host=s.host),$=TE;continue;case CE:if(h==mx||"/"==h||"\\"==h||"?"==h||"#"==h){if(!o&&isWindowsDriveLetter(q))$=TE;else if(""==q){if(R.host="",o)return;$=kE}else{if(m=R.parseHost(q))return m;if("localhost"==R.host&&(R.host=""),o)return;q="",$=kE}continue}q+=h;break;case kE:if(R.isSpecial()){if($=TE,"/"!=h&&"\\"!=h)continue}else if(o||"?"!=h)if(o||"#"!=h){if(h!=mx&&($=TE,"/"!=h))continue}else R.fragment="",$=EE;else R.query="",$=xE;break;case TE:if(h==mx||"/"==h||"\\"==h&&R.isSpecial()||!o&&("?"==h||"#"==h)){if(".."===(_=Ux(_=q))||"%2e."===_||".%2e"===_||"%2e%2e"===_?(R.shortenPath(),"/"==h||"\\"==h&&R.isSpecial()||Nx(R.path,"")):isSingleDot(q)?"/"==h||"\\"==h&&R.isSpecial()||Nx(R.path,""):("file"==R.scheme&&!R.path.length&&isWindowsDriveLetter(q)&&(R.host&&(R.host=""),q=Ax(q,0)+":"),Nx(R.path,q)),q="","file"==R.scheme&&(h==mx||"?"==h||"#"==h))for(;R.path.length>1&&""===R.path[0];)Dx(R.path);"?"==h?(R.query="",$=xE):"#"==h&&(R.fragment="",$=EE)}else q+=percentEncode(h,nE);break;case SE:"?"==h?(R.query="",$=xE):"#"==h?(R.fragment="",$=EE):h!=mx&&(R.path[0]+=percentEncode(h,rE));break;case xE:o||"#"!=h?h!=mx&&("'"==h&&R.isSpecial()?R.query+="%27":R.query+="#"==h?"%23":percentEncode(h,rE)):(R.fragment="",$=EE);break;case EE:h!=mx&&(R.fragment+=percentEncode(h,oE))}B++}},parseHost:function(t){var o,s,l;if("["==Ax(t,0)){if("]"!=Ax(t,t.length-1))return qx;if(o=function(t){var o,s,l,h,v,m,_,R=[0,0,0,0,0,0,0,0],$=0,B=null,q=0,chr=function(){return Ax(t,q)};if(":"==chr()){if(":"!=Ax(t,1))return;q+=2,B=++$}for(;chr();){if(8==$)return;if(":"!=chr()){for(o=s=0;s<4&&Px(Yx,chr());)o=16*o+xx(chr(),16),q++,s++;if("."==chr()){if(0==s)return;if(q-=s,$>6)return;for(l=0;chr();){if(h=null,l>0){if(!("."==chr()&&l<4))return;q++}if(!Px(Gx,chr()))return;for(;Px(Gx,chr());){if(v=xx(chr(),10),null===h)h=v;else{if(0==h)return;h=10*h+v}if(h>255)return;q++}R[$]=256*R[$]+h,2!=++l&&4!=l||$++}if(4!=l)return;break}if(":"==chr()){if(q++,!chr())return}else if(chr())return;R[$++]=o}else{if(null!==B)return;q++,B=++$}}if(null!==B)for(m=$-B,$=7;0!=$&&m>0;)_=R[$],R[$--]=R[B+m-1],R[B+--m]=_;else if(8!=$)return;return R}(Fx(t,1,-1)),!o)return qx;this.host=o}else if(this.isSpecial()){if(t=function(t){var o,s,l=[],h=MS(NS(DS(t),SS,"."),".");for(o=0;o<h.length;o++)s=h[o],$S(l,IS(TS,s)?"xn--"+encode(s):s);return OS(l,".")}(t),Px(Jx,t))return qx;if(o=function(t){var o,s,l,h,v,m,_,R=Lx(t,".");if(R.length&&""==R[R.length-1]&&R.length--,(o=R.length)>4)return t;for(s=[],l=0;l<o;l++){if(""==(h=R[l]))return t;if(v=10,h.length>1&&"0"==Ax(h,0)&&(v=Px(Kx,h)?16:8,h=Fx(h,8==v?1:2)),""===h)m=0;else{if(!Px(10==v?Qx:8==v?Wx:Yx,h))return t;m=xx(h,v)}Nx(s,m)}for(l=0;l<o;l++)if(m=s[l],l==o-1){if(m>=Ix(256,5-o))return null}else if(m>255)return null;for(_=$x(s),l=0;l<s.length;l++)_+=s[l]*Ix(256,3-l);return _}(t),null===o)return qx;this.host=o}else{if(Px(Xx,t))return qx;for(o="",s=ys(t),l=0;l<s.length;l++)o+=percentEncode(s[l],rE);this.host=o}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"==this.scheme},includesCredentials:function(){return""!=this.username||""!=this.password},isSpecial:function(){return ht(sE,this.scheme)},shortenPath:function(){var t=this.path,o=t.length;!o||"file"==this.scheme&&1==o&&isWindowsDriveLetter(t[0],!0)||t.length--},serialize:function(){var t=this,o=t.scheme,s=t.username,l=t.password,h=t.host,v=t.port,m=t.path,_=t.query,R=t.fragment,$=o+":";return null!==h?($+="//",t.includesCredentials()&&($+=s+(l?":"+l:"")+"@"),$+=serializeHost(h),null!==v&&($+=":"+v)):"file"==o&&($+="//"),$+=t.cannotBeABaseURL?m[0]:m.length?"/"+Rx(m,"/"):"",null!==_&&($+="?"+_),null!==R&&($+="#"+R),$},setHref:function(t){var o=this.parse(t);if(o)throw Sx(o);this.searchParams.update()},getOrigin:function(){var t=this.scheme,o=this.port;if("blob"==t)try{return new IE(t.path[0]).origin}catch(t){return"null"}return"file"!=t&&this.isSpecial()?t+"://"+serializeHost(this.host)+(null!==o?":"+o:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(t){this.parse(toString_1(t)+":",aE)},getUsername:function(){return this.username},setUsername:function(t){var o=ys(toString_1(t));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var s=0;s<o.length;s++)this.username+=percentEncode(o[s],iE)}},getPassword:function(){return this.password},setPassword:function(t){var o=ys(toString_1(t));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var s=0;s<o.length;s++)this.password+=percentEncode(o[s],iE)}},getHost:function(){var t=this.host,o=this.port;return null===t?"":null===o?serializeHost(t):serializeHost(t)+":"+o},setHost:function(t){this.cannotBeABaseURL||this.parse(t,mE)},getHostname:function(){var t=this.host;return null===t?"":serializeHost(t)},setHostname:function(t){this.cannotBeABaseURL||this.parse(t,bE)},getPort:function(){var t=this.port;return null===t?"":toString_1(t)},setPort:function(t){this.cannotHaveUsernamePasswordPort()||(""==(t=toString_1(t))?this.port=null:this.parse(t,yE))},getPathname:function(){var t=this.path;return this.cannotBeABaseURL?t[0]:t.length?"/"+Rx(t,"/"):""},setPathname:function(t){this.cannotBeABaseURL||(this.path=[],this.parse(t,kE))},getSearch:function(){var t=this.query;return t?"?"+t:""},setSearch:function(t){""==(t=toString_1(t))?this.query=null:("?"==Ax(t,0)&&(t=Fx(t,1)),this.query="",this.parse(t,xE)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var t=this.fragment;return t?"#"+t:""},setHash:function(t){""!=(t=toString_1(t))?("#"==Ax(t,0)&&(t=Fx(t,1)),this.fragment="",this.parse(t,EE)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var IE=function URL(t){var o=anInstance(this,AE),s=validateArgumentsLength(arguments.length,1)>1?arguments[1]:void 0,l=wx(o,new URLState(t,!1,s));h||(o.href=l.serialize(),o.origin=l.getOrigin(),o.protocol=l.getProtocol(),o.username=l.getUsername(),o.password=l.getPassword(),o.host=l.getHost(),o.hostname=l.getHostname(),o.port=l.getPort(),o.pathname=l.getPathname(),o.search=l.getSearch(),o.searchParams=l.getSearchParams(),o.hash=l.getHash())},AE=IE.prototype,accessorDescriptor=function(t,o){return{get:function(){return _x(this)[t]()},set:o&&function(t){return _x(this)[o](t)},configurable:!0,enumerable:!0}};if(h&&(defineBuiltInAccessor(AE,"href",accessorDescriptor("serialize","setHref")),defineBuiltInAccessor(AE,"origin",accessorDescriptor("getOrigin")),defineBuiltInAccessor(AE,"protocol",accessorDescriptor("getProtocol","setProtocol")),defineBuiltInAccessor(AE,"username",accessorDescriptor("getUsername","setUsername")),defineBuiltInAccessor(AE,"password",accessorDescriptor("getPassword","setPassword")),defineBuiltInAccessor(AE,"host",accessorDescriptor("getHost","setHost")),defineBuiltInAccessor(AE,"hostname",accessorDescriptor("getHostname","setHostname")),defineBuiltInAccessor(AE,"port",accessorDescriptor("getPort","setPort")),defineBuiltInAccessor(AE,"pathname",accessorDescriptor("getPathname","setPathname")),defineBuiltInAccessor(AE,"search",accessorDescriptor("getSearch","setSearch")),defineBuiltInAccessor(AE,"searchParams",accessorDescriptor("getSearchParams")),defineBuiltInAccessor(AE,"hash",accessorDescriptor("getHash","setHash"))),defineBuiltIn(AE,"toJSON",(function toJSON(){return _x(this).serialize()}),{enumerable:!0}),defineBuiltIn(AE,"toString",(function toString(){return _x(this).serialize()}),{enumerable:!0}),Tx){var PE=Tx.createObjectURL,RE=Tx.revokeObjectURL;PE&&defineBuiltIn(IE,"createObjectURL",functionBindContext(PE,Tx)),RE&&defineBuiltIn(IE,"revokeObjectURL",functionBindContext(RE,Tx))}setToStringTag(IE,"URL"),_export({global:!0,constructor:!0,forced:!CS,sham:!h},{URL:IE}),_export({target:"URL",proto:!0,enumerable:!0},{toJSON:function toJSON(){return _(URL.prototype.toString,this)}}),createCommonjsModule((function(t){var o=function(t){var o,s=Object.prototype,l=s.hasOwnProperty,h=Object.defineProperty||function(t,o,s){t[o]=s.value},v="function"==typeof Symbol?Symbol:{},m=v.iterator||"@@iterator",_=v.asyncIterator||"@@asyncIterator",R=v.toStringTag||"@@toStringTag";function define(t,o,s){return Object.defineProperty(t,o,{value:s,enumerable:!0,configurable:!0,writable:!0}),t[o]}try{define({},"")}catch(t){define=function(t,o,s){return t[o]=s}}function wrap(t,o,s,l){var v=o&&o.prototype instanceof Generator?o:Generator,m=Object.create(v.prototype),_=new Context(l||[]);return h(m,"_invoke",{value:makeInvokeMethod(t,s,_)}),m}function tryCatch(t,o,s){try{return{type:"normal",arg:t.call(o,s)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var $="suspendedStart",B="suspendedYield",q="executing",j="completed",z={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var K={};define(K,m,(function(){return this}));var W=Object.getPrototypeOf,Z=W&&W(W(values([])));Z&&Z!==s&&l.call(Z,m)&&(K=Z);var te=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(K);function defineIteratorMethods(t){["next","throw","return"].forEach((function(o){define(t,o,(function(t){return this._invoke(o,t)}))}))}function AsyncIterator(t,o){function invoke(s,h,v,m){var _=tryCatch(t[s],t,h);if("throw"!==_.type){var R=_.arg,$=R.value;return $&&"object"==typeof $&&l.call($,"__await")?o.resolve($.__await).then((function(t){invoke("next",t,v,m)}),(function(t){invoke("throw",t,v,m)})):o.resolve($).then((function(t){R.value=t,v(R)}),(function(t){return invoke("throw",t,v,m)}))}m(_.arg)}var s;h(this,"_invoke",{value:function enqueue(t,l){function callInvokeWithMethodAndArg(){return new o((function(o,s){invoke(t,l,o,s)}))}return s=s?s.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,o,s){var l=$;return function invoke(h,v){if(l===q)throw new Error("Generator is already running");if(l===j){if("throw"===h)throw v;return doneResult()}for(s.method=h,s.arg=v;;){var m=s.delegate;if(m){var _=maybeInvokeDelegate(m,s);if(_){if(_===z)continue;return _}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if(l===$)throw l=j,s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);l=q;var R=tryCatch(t,o,s);if("normal"===R.type){if(l=s.done?j:B,R.arg===z)continue;return{value:R.arg,done:s.done}}"throw"===R.type&&(l=j,s.method="throw",s.arg=R.arg)}}}function maybeInvokeDelegate(t,s){var l=s.method,h=t.iterator[l];if(h===o)return s.delegate=null,"throw"===l&&t.iterator.return&&(s.method="return",s.arg=o,maybeInvokeDelegate(t,s),"throw"===s.method)||"return"!==l&&(s.method="throw",s.arg=new TypeError("The iterator does not provide a '"+l+"' method")),z;var v=tryCatch(h,t.iterator,s.arg);if("throw"===v.type)return s.method="throw",s.arg=v.arg,s.delegate=null,z;var m=v.arg;return m?m.done?(s[t.resultName]=m.value,s.next=t.nextLoc,"return"!==s.method&&(s.method="next",s.arg=o),s.delegate=null,z):m:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,z)}function pushTryEntry(t){var o={tryLoc:t[0]};1 in t&&(o.catchLoc=t[1]),2 in t&&(o.finallyLoc=t[2],o.afterLoc=t[3]),this.tryEntries.push(o)}function resetTryEntry(t){var o=t.completion||{};o.type="normal",delete o.arg,t.completion=o}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var s=t[m];if(s)return s.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var h=-1,v=function next(){for(;++h<t.length;)if(l.call(t,h))return next.value=t[h],next.done=!1,next;return next.value=o,next.done=!0,next};return v.next=v}}return{next:doneResult}}function doneResult(){return{value:o,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,h(te,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),h(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,R,"GeneratorFunction"),t.isGeneratorFunction=function(t){var o="function"==typeof t&&t.constructor;return!!o&&(o===GeneratorFunction||"GeneratorFunction"===(o.displayName||o.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,R,"GeneratorFunction")),t.prototype=Object.create(te),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,_,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(o,s,l,h,v){void 0===v&&(v=Promise);var m=new AsyncIterator(wrap(o,s,l,h),v);return t.isGeneratorFunction(s)?m:m.next().then((function(t){return t.done?t.value:m.next()}))},defineIteratorMethods(te),define(te,R,"Generator"),define(te,m,(function(){return this})),define(te,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var o=Object(t),s=[];for(var l in o)s.push(l);return s.reverse(),function next(){for(;s.length;){var t=s.pop();if(t in o)return next.value=t,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=o,this.done=!1,this.delegate=null,this.method="next",this.arg=o,this.tryEntries.forEach(resetTryEntry),!t)for(var s in this)"t"===s.charAt(0)&&l.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=o)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var s=this;function handle(l,h){return m.type="throw",m.arg=t,s.next=l,h&&(s.method="next",s.arg=o),!!h}for(var h=this.tryEntries.length-1;h>=0;--h){var v=this.tryEntries[h],m=v.completion;if("root"===v.tryLoc)return handle("end");if(v.tryLoc<=this.prev){var _=l.call(v,"catchLoc"),R=l.call(v,"finallyLoc");if(_&&R){if(this.prev<v.catchLoc)return handle(v.catchLoc,!0);if(this.prev<v.finallyLoc)return handle(v.finallyLoc)}else if(_){if(this.prev<v.catchLoc)return handle(v.catchLoc,!0)}else{if(!R)throw new Error("try statement without catch or finally");if(this.prev<v.finallyLoc)return handle(v.finallyLoc)}}}},abrupt:function(t,o){for(var s=this.tryEntries.length-1;s>=0;--s){var h=this.tryEntries[s];if(h.tryLoc<=this.prev&&l.call(h,"finallyLoc")&&this.prev<h.finallyLoc){var v=h;break}}v&&("break"===t||"continue"===t)&&v.tryLoc<=o&&o<=v.finallyLoc&&(v=null);var m=v?v.completion:{};return m.type=t,m.arg=o,v?(this.method="next",this.next=v.finallyLoc,z):this.complete(m)},complete:function(t,o){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&o&&(this.next=o),z},finish:function(t){for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o];if(s.finallyLoc===t)return this.complete(s.completion,s.afterLoc),resetTryEntry(s),z}},catch:function(t){for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o];if(s.tryLoc===t){var l=s.completion;if("throw"===l.type){var h=l.arg;resetTryEntry(s)}return h}}throw new Error("illegal catch attempt")},delegateYield:function(t,s,l){return this.delegate={iterator:values(t),resultName:s,nextLoc:l},"next"===this.method&&(this.arg=o),z}},t}(t.exports);try{regeneratorRuntime=o}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=o:Function("r","regeneratorRuntime = r")(o)}}));var OE="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==OE&&OE,$E={searchParams:"URLSearchParams"in OE,iterable:"Symbol"in OE&&"iterator"in Symbol,blob:"FileReader"in OE&&"Blob"in OE&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in OE,arrayBuffer:"ArrayBuffer"in OE};if($E.arrayBuffer)var NE=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],ME=ArrayBuffer.isView||function(t){return t&&NE.indexOf(Object.prototype.toString.call(t))>-1};function normalizeName(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(t)||""===t)throw new TypeError('Invalid character in header field name: "'+t+'"');return t.toLowerCase()}function normalizeValue(t){return"string"!=typeof t&&(t=String(t)),t}function iteratorFor(t){var o={next:function(){var o=t.shift();return{done:void 0===o,value:o}}};return $E.iterable&&(o[Symbol.iterator]=function(){return o}),o}function Headers$1(t){this.map={},t instanceof Headers$1?t.forEach((function(t,o){this.append(o,t)}),this):Array.isArray(t)?t.forEach((function(t){this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(o){this.append(o,t[o])}),this)}function consumed(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function fileReaderReady(t){return new Promise((function(o,s){t.onload=function(){o(t.result)},t.onerror=function(){s(t.error)}}))}function readBlobAsArrayBuffer(t){var o=new FileReader,s=fileReaderReady(o);return o.readAsArrayBuffer(t),s}function bufferClone(t){if(t.slice)return t.slice(0);var o=new Uint8Array(t.byteLength);return o.set(new Uint8Array(t)),o.buffer}function Body(){return this.bodyUsed=!1,this._initBody=function(t){this.bodyUsed=this.bodyUsed,this._bodyInit=t,t?"string"==typeof t?this._bodyText=t:$E.blob&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:$E.formData&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:$E.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():$E.arrayBuffer&&$E.blob&&function isDataView(t){return t&&DataView.prototype.isPrototypeOf(t)}(t)?(this._bodyArrayBuffer=bufferClone(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):$E.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||ME(t))?this._bodyArrayBuffer=bufferClone(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):$E.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},$E.blob&&(this.blob=function(){var t=consumed(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var t=consumed(this);return t||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}return this.blob().then(readBlobAsArrayBuffer)}),this.text=function(){var t=consumed(this);if(t)return t;if(this._bodyBlob)return function readBlobAsText(t){var o=new FileReader,s=fileReaderReady(o);return o.readAsText(t),s}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function readArrayBufferAsText(t){for(var o=new Uint8Array(t),s=new Array(o.length),l=0;l<o.length;l++)s[l]=String.fromCharCode(o[l]);return s.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},$E.formData&&(this.formData=function(){return this.text().then(decode)}),this.json=function(){return this.text().then(JSON.parse)},this}Headers$1.prototype.append=function(t,o){t=normalizeName(t),o=normalizeValue(o);var s=this.map[t];this.map[t]=s?s+", "+o:o},Headers$1.prototype.delete=function(t){delete this.map[normalizeName(t)]},Headers$1.prototype.get=function(t){return t=normalizeName(t),this.has(t)?this.map[t]:null},Headers$1.prototype.has=function(t){return this.map.hasOwnProperty(normalizeName(t))},Headers$1.prototype.set=function(t,o){this.map[normalizeName(t)]=normalizeValue(o)},Headers$1.prototype.forEach=function(t,o){for(var s in this.map)this.map.hasOwnProperty(s)&&t.call(o,this.map[s],s,this)},Headers$1.prototype.keys=function(){var t=[];return this.forEach((function(o,s){t.push(s)})),iteratorFor(t)},Headers$1.prototype.values=function(){var t=[];return this.forEach((function(o){t.push(o)})),iteratorFor(t)},Headers$1.prototype.entries=function(){var t=[];return this.forEach((function(o,s){t.push([s,o])})),iteratorFor(t)},$E.iterable&&(Headers$1.prototype[Symbol.iterator]=Headers$1.prototype.entries);var DE=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function Request$1(t,o){if(!(this instanceof Request$1))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var s=(o=o||{}).body;if(t instanceof Request$1){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,o.headers||(this.headers=new Headers$1(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,s||null==t._bodyInit||(s=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=o.credentials||this.credentials||"same-origin",!o.headers&&this.headers||(this.headers=new Headers$1(o.headers)),this.method=function normalizeMethod(t){var o=t.toUpperCase();return DE.indexOf(o)>-1?o:t}(o.method||this.method||"GET"),this.mode=o.mode||this.mode||null,this.signal=o.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&s)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(s),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==o.cache&&"no-cache"!==o.cache)){var l=/([?&])_=[^&]*/;if(l.test(this.url))this.url=this.url.replace(l,"$1_="+(new Date).getTime());else{this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}}function decode(t){var o=new FormData;return t.trim().split("&").forEach((function(t){if(t){var s=t.split("="),l=s.shift().replace(/\+/g," "),h=s.join("=").replace(/\+/g," ");o.append(decodeURIComponent(l),decodeURIComponent(h))}})),o}function Response(t,o){if(!(this instanceof Response))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');o||(o={}),this.type="default",this.status=void 0===o.status?200:o.status,this.ok=this.status>=200&&this.status<300,this.statusText=void 0===o.statusText?"":""+o.statusText,this.headers=new Headers$1(o.headers),this.url=o.url||"",this._initBody(t)}Request$1.prototype.clone=function(){return new Request$1(this,{body:this._bodyInit})},Body.call(Request$1.prototype),Body.call(Response.prototype),Response.prototype.clone=function(){return new Response(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Headers$1(this.headers),url:this.url})},Response.error=function(){var t=new Response(null,{status:0,statusText:""});return t.type="error",t};var LE=[301,302,303,307,308];Response.redirect=function(t,o){if(-1===LE.indexOf(o))throw new RangeError("Invalid status code");return new Response(null,{status:o,headers:{location:t}})};var FE=OE.DOMException;try{new FE}catch(t){FE=function(t,o){this.message=t,this.name=o;var s=Error(t);this.stack=s.stack},FE.prototype=Object.create(Error.prototype),FE.prototype.constructor=FE}function fetch$1(t,o){return new Promise((function(s,l){var h=new Request$1(t,o);if(h.signal&&h.signal.aborted)return l(new FE("Aborted","AbortError"));var v=new XMLHttpRequest;function abortXhr(){v.abort()}v.onload=function(){var t,o,l={status:v.status,statusText:v.statusText,headers:(t=v.getAllResponseHeaders()||"",o=new Headers$1,t.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(t){return 0===t.indexOf("\n")?t.substr(1,t.length):t})).forEach((function(t){var s=t.split(":"),l=s.shift().trim();if(l){var h=s.join(":").trim();o.append(l,h)}})),o)};l.url="responseURL"in v?v.responseURL:l.headers.get("X-Request-URL");var h="response"in v?v.response:v.responseText;setTimeout((function(){s(new Response(h,l))}),0)},v.onerror=function(){setTimeout((function(){l(new TypeError("Network request failed"))}),0)},v.ontimeout=function(){setTimeout((function(){l(new TypeError("Network request failed"))}),0)},v.onabort=function(){setTimeout((function(){l(new FE("Aborted","AbortError"))}),0)},v.open(h.method,function fixUrl(t){try{return""===t&&OE.location.href?OE.location.href:t}catch(o){return t}}(h.url),!0),"include"===h.credentials?v.withCredentials=!0:"omit"===h.credentials&&(v.withCredentials=!1),"responseType"in v&&($E.blob?v.responseType="blob":$E.arrayBuffer&&h.headers.get("Content-Type")&&-1!==h.headers.get("Content-Type").indexOf("application/octet-stream")&&(v.responseType="arraybuffer")),!o||"object"!=typeof o.headers||o.headers instanceof Headers$1?h.headers.forEach((function(t,o){v.setRequestHeader(o,t)})):Object.getOwnPropertyNames(o.headers).forEach((function(t){v.setRequestHeader(t,normalizeValue(o.headers[t]))})),h.signal&&(h.signal.addEventListener("abort",abortXhr),v.onreadystatechange=function(){4===v.readyState&&h.signal.removeEventListener("abort",abortXhr)}),v.send(void 0===h._bodyInit?null:h._bodyInit)}))}fetch$1.polyfill=!0,OE.fetch||(OE.fetch=fetch$1,OE.Headers=Headers$1,OE.Request=Request$1,OE.Response=Response)
/**
@license @nocompile
Copyright (c) 2018 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/,function(){var o;function ba(t){var o=0;return function(){return o<t.length?{done:!1,value:t[o++]}:{done:!0}}}var s="function"==typeof Object.defineProperties?Object.defineProperty:function(t,o,s){return t==Array.prototype||t==Object.prototype||(t[o]=s.value),t};var l,h=function da(o){o=["object"==typeof globalThis&&globalThis,o,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof t&&t];for(var s=0;s<o.length;++s){var l=o[s];if(l&&l.Math==Math)return l}throw Error("Cannot find global object")}(this);function fa(t,o){if(o)e:{var l=h;t=t.split(".");for(var v=0;v<t.length-1;v++){var m=t[v];if(!(m in l))break e;l=l[m]}(o=o(v=l[t=t[t.length-1]]))!=v&&null!=o&&s(l,t,{configurable:!0,writable:!0,value:o})}}function ja(t){return(t={next:t})[Symbol.iterator]=function(){return this},t}function ka(t){var o="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return o?o.call(t):{next:ba(t)}}function w(t){if(!(t instanceof Array)){t=ka(t);for(var o,s=[];!(o=t.next()).done;)s.push(o.value);t=s}return t}if(fa("Symbol",(function(t){function c(t,o){this.g=t,s(this,"description",{configurable:!0,writable:!0,value:o})}if(t)return t;c.prototype.toString=function(){return this.g};var o=0;return function b(t){if(this instanceof b)throw new TypeError("Symbol is not a constructor");return new c("jscomp_symbol_"+(t||"")+"_"+o++,t)}})),fa("Symbol.iterator",(function(t){if(t)return t;t=Symbol("Symbol.iterator");for(var o="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),l=0;l<o.length;l++){var v=h[o[l]];"function"==typeof v&&"function"!=typeof v.prototype[t]&&s(v.prototype,t,{configurable:!0,writable:!0,value:function(){return ja(ba(this))}})}return t})),"function"==typeof Object.setPrototypeOf)l=Object.setPrototypeOf;else{var v;e:{var m={};try{m.__proto__={a:!0},v=m.a;break e}catch(t){}v=!1}l=v?function(t,o){if(t.__proto__=o,t.__proto__!==o)throw new TypeError(t+" is not extensible");return t}:null}var _=l;function ra(){this.u=!1,this.h=null,this.Oa=void 0,this.g=1,this.ea=0,this.i=null}function ua(t){if(t.u)throw new TypeError("Generator is already running");t.u=!0}function wa(t,o){t.i={ab:o,fb:!0},t.g=t.ea}function ya(t,o){return t.g=3,{value:o}}function za(t){this.g=new ra,this.h=t}function Ba(t,o,s,l){try{var h=o.call(t.g.h,s);if(!(h instanceof Object))throw new TypeError("Iterator result "+h+" is not an object");if(!h.done)return t.g.u=!1,h;var v=h.value}catch(o){return t.g.h=null,wa(t.g,o),Ca(t)}return t.g.h=null,l.call(t.g,v),Ca(t)}function Ca(t){for(;t.g.g;)try{var o=t.h(t.g);if(o)return t.g.u=!1,{value:o.value,done:!1}}catch(o){t.g.Oa=void 0,wa(t.g,o)}if(t.g.u=!1,t.g.i){if(o=t.g.i,t.g.i=null,o.fb)throw o.ab;return{value:o.return,done:!0}}return{value:void 0,done:!0}}function Da(t){this.next=function(o){return ua(t.g),t.g.h?o=Ba(t,t.g.h.next,o,t.g.O):(t.g.O(o),o=Ca(t)),o},this.throw=function(o){return ua(t.g),t.g.h?o=Ba(t,t.g.h.throw,o,t.g.O):(wa(t.g,o),o=Ca(t)),o},this.return=function(o){return function Aa(t,o){ua(t.g);var s=t.g.h;return s?Ba(t,"return"in s?s.return:function(t){return{value:t,done:!0}},o,t.g.return):(t.g.return(o),Ca(t))}(t,o)},this[Symbol.iterator]=function(){return this}}function Ea(t,o){return o=new Da(new za(o)),_&&t.prototype&&_(o,t.prototype),o}ra.prototype.O=function(t){this.Oa=t},ra.prototype.return=function(t){this.i={return:t},this.g=this.ea},Array.from||(Array.from=function(t){return[].slice.call(t)}),Object.assign||(Object.assign=function(t){for(var o,s=[].slice.call(arguments,1),l=0;l<s.length;l++)if(o=s[l])for(var h=t,v=Object.keys(o),m=0;m<v.length;m++){var _=v[m];h[_]=o[_]}return t});var R=setTimeout;function Ga(){}function A(t){if(!(this instanceof A))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this.N=0,this.Ha=!1,this.I=void 0,this.ba=[],Ia(t,this)}function Ja(t,o){for(;3===t.N;)t=t.I;0===t.N?t.ba.push(o):(t.Ha=!0,$((function(){var s=1===t.N?o.hb:o.ib;if(null===s)(1===t.N?La:Ma)(o.promise,t.I);else{try{var l=s(t.I)}catch(t){return void Ma(o.promise,t)}La(o.promise,l)}})))}function La(t,o){try{if(o===t)throw new TypeError("A promise cannot be resolved with itself.");if(o&&("object"==typeof o||"function"==typeof o)){var s=o.then;if(o instanceof A)return t.N=3,t.I=o,void Na(t);if("function"==typeof s)return void Ia(function Ha(t,o){return function(){t.apply(o,arguments)}}(s,o),t)}t.N=1,t.I=o,Na(t)}catch(o){Ma(t,o)}}function Ma(t,o){t.N=2,t.I=o,Na(t)}function Na(t){2===t.N&&0===t.ba.length&&$((function(){t.Ha||"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t.I)}));for(var o=0,s=t.ba.length;o<s;o++)Ja(t,t.ba[o]);t.ba=null}function Oa(t,o,s){this.hb="function"==typeof t?t:null,this.ib="function"==typeof o?o:null,this.promise=s}function Ia(t,o){var s=!1;try{t((function(t){s||(s=!0,La(o,t))}),(function(t){s||(s=!0,Ma(o,t))}))}catch(t){s||(s=!0,Ma(o,t))}}function Qa(t){return t&&"object"==typeof t&&t.constructor===A?t:new A((function(o){o(t)}))}A.prototype.catch=function(t){return this.then(null,t)},A.prototype.then=function(t,o){var s=new this.constructor(Ga);return Ja(this,new Oa(t,o,s)),s},A.prototype.finally=function(t){var o=this.constructor;return this.then((function(s){return o.resolve(t()).then((function(){return s}))}),(function(s){return o.resolve(t()).then((function(){return o.reject(s)}))}))};var $="function"==typeof setImmediate&&function(t){setImmediate(t)}||function(t){R(t,0)};if(!window.Promise){window.Promise=A,A.prototype.then=A.prototype.then,A.all=function Pa(t){return new A((function(o,s){function d(t,v){try{if(v&&("object"==typeof v||"function"==typeof v)){var m=v.then;if("function"==typeof m)return void m.call(v,(function(o){d(t,o)}),s)}l[t]=v,0==--h&&o(l)}catch(t){s(t)}}if(!t||void 0===t.length)return s(new TypeError("Promise.all accepts an array"));var l=Array.prototype.slice.call(t);if(0===l.length)return o([]);for(var h=l.length,v=0;v<l.length;v++)d(v,l[v])}))},A.race=function Sa(t){return new A((function(o,s){if(!t||void 0===t.length)return s(new TypeError("Promise.race accepts an array"));for(var l=0,h=t.length;l<h;l++)Qa(t[l]).then(o,s)}))},A.resolve=Qa,A.reject=function Ra(t){return new A((function(o,s){s(t)}))};var B=document.createTextNode(""),q=[];new MutationObserver((function(){for(var t=q.length,o=0;o<t;o++)q[o]();q.splice(0,t)})).observe(B,{characterData:!0}),$=function(t){q.push(t),B.textContent=0<B.textContent.length?"":"a"}}!function(o,s){if(!(s in o)){var l=typeof t==typeof l?window:t,h=0,v=String(Math.random()),m="__symbol@@"+v,_=o.getOwnPropertyNames,R=o.getOwnPropertyDescriptor,$=o.create,B=o.keys,q=o.freeze||o,j=o.defineProperty,z=o.defineProperties,K=R(o,"getOwnPropertyNames"),W=o.prototype,Z=W.hasOwnProperty,te=W.propertyIsEnumerable,ne=W.toString,y=function(t,o,s){Z.call(t,m)||j(t,m,{enumerable:!1,configurable:!1,writable:!1,value:{}}),t[m]["@@"+o]=s},X=function(t,o){var s=$(t);return _(o).forEach((function(t){sa.call(o,t)&&Va(s,t,o[t])})),s},x=function(){},ta=function(t){return t!=m&&!Z.call(se,t)},ia=function(t){return t!=m&&Z.call(se,t)},sa=function(t){var o=String(t);return ia(o)?Z.call(this,o)&&!!this[m]&&this[m]["@@"+o]:te.call(this,t)},n=function(t){return j(W,t,{enumerable:!1,configurable:!0,get:x,set:function(o){me(this,t,{enumerable:!1,configurable:!0,writable:!0,value:o}),y(this,t,!0)}}),se[t]=j(o(t),"constructor",he),q(se[t])},ie=function G(t){if(this instanceof G)throw new TypeError("Symbol is not a constructor");return n("__symbol:".concat(t||"",v,++h))},se=$(null),he={value:ie},ib=function(t){return se[t]},Va=function(t,o,s){var l=String(o);if(ia(l)){if(o=me,s.enumerable){var h=$(s);h.enumerable=!1}else h=s;o(t,l,h),y(t,l,!!s.enumerable)}else j(t,o,s);return t},jb=function(t){return _(t).filter(ia).map(ib)};K.value=Va,j(o,"defineProperty",K),K.value=jb,j(o,s,K),K.value=function(t){return _(t).filter(ta)},j(o,"getOwnPropertyNames",K),K.value=function(t,o){var s=jb(o);return s.length?B(o).concat(s).forEach((function(s){sa.call(o,s)&&Va(t,s,o[s])})):z(t,o),t},j(o,"defineProperties",K),K.value=sa,j(W,"propertyIsEnumerable",K),K.value=ie,j(l,"Symbol",K),K.value=function(t){return(t="__symbol:".concat("__symbol:",t,v))in W?se[t]:n(t)},j(ie,"for",K),K.value=function(t){if(ta(t))throw new TypeError(t+" is not a symbol");if(Z.call(se,t)&&("__symbol:"===(t=t.slice(10)).slice(0,10)&&(t=t.slice(10))!==v))return 0<(t=t.slice(0,t.length-v.length)).length?t:void 0},j(ie,"keyFor",K),K.value=function(t,o){var s=R(t,o);return s&&ia(o)&&(s.enumerable=sa.call(t,o)),s},j(o,"getOwnPropertyDescriptor",K),K.value=function(t,o){return 1===arguments.length||void 0===o?$(t):X(t,o)},j(o,"create",K),K.value=function(){var t=ne.call(this);return"[object String]"===t&&ia(this)?"[object Symbol]":t},j(W,"toString",K);try{if(!0!==$(j({},"__symbol:",{get:function(){return j(this,"__symbol:",{value:!0})["__symbol:"]}}))["__symbol:"])throw"IE11";var me=j}catch(t){me=function(t,o,s){var l=R(W,o);delete W[o],j(t,o,s),j(W,o,l)}}}}(Object,"getOwnPropertySymbols"),function(t,o){var s,l=t.defineProperty,h=t.prototype,v=h.toString;"iterator match replace search split hasInstance isConcatSpreadable unscopables species toPrimitive toStringTag".split(" ").forEach((function(m){m in o||(l(o,m,{value:o(m)}),"toStringTag"===m&&((s=t.getOwnPropertyDescriptor(h,"toString")).value=function(){var t=v.call(this),s=null==this?this:this[o.toStringTag];return null==s?t:"[object "+s+"]"},l(h,"toString",s)))}))}(Object,Symbol),function(t,o,s){function d(){return this}o[t]||(o[t]=function(){var o=0,s=this,l={next:function(){var t=s.length<=o;return t?{done:t}:{done:t,value:s[o++]}}};return l[t]=d,l}),s[t]||(s[t]=function(){var o=String.fromCodePoint,s=this,l=0,h=s.length,v={next:function(){var t=h<=l,v=t?"":o(s.codePointAt(l));return l+=v.length,t?{done:t}:{done:t,value:v}}};return v[t]=d,v})}(Symbol.iterator,Array.prototype,String.prototype);var j=Object.prototype.toString;Object.prototype.toString=function(){return void 0===this?"[object Undefined]":null===this?"[object Null]":j.call(this)},Object.keys=function(t){return Object.getOwnPropertyNames(t).filter((function(o){return(o=Object.getOwnPropertyDescriptor(t,o))&&o.enumerable}))},String.prototype[Symbol.iterator]&&String.prototype.codePointAt||(String.prototype[Symbol.iterator]=function Xa(){var t,o=this;return Ea(Xa,(function(s){if(1==s.g&&(t=0),3!=s.g)return t<o.length?s=ya(s,o[t]):(s.g=0,s=void 0),s;t++,s.g=2}))}),Set.prototype[Symbol.iterator]||(Set.prototype[Symbol.iterator]=function Ya(){var t,o,s=this;return Ea(Ya,(function(l){if(1==l.g&&(t=[],s.forEach((function(o){t.push(o)})),o=0),3!=l.g)return o<t.length?l=ya(l,t[o]):(l.g=0,l=void 0),l;o++,l.g=2}))}),Map.prototype[Symbol.iterator]||(Map.prototype[Symbol.iterator]=function Za(){var t,o,s=this;return Ea(Za,(function(l){if(1==l.g&&(t=[],s.forEach((function(o,s){t.push([s,o])})),o=0),3!=l.g)return o<t.length?l=ya(l,t[o]):(l.g=0,l=void 0),l;o++,l.g=2}))});var z=document.createEvent("Event");if(z.initEvent("foo",!0,!0),z.preventDefault(),!z.defaultPrevented){var K=Event.prototype.preventDefault;Event.prototype.preventDefault=function(){this.cancelable&&(K.call(this),Object.defineProperty(this,"defaultPrevented",{get:function(){return!0},configurable:!0}))}}var W=/Trident/.test(navigator.userAgent);if(!window.Event||W&&"function"!=typeof window.Event){var Z=window.Event;if(window.Event=function(t,o){o=o||{};var s=document.createEvent("Event");return s.initEvent(t,!!o.bubbles,!!o.cancelable),s},Z){for(var te in Z)window.Event[te]=Z[te];window.Event.prototype=Z.prototype}}if((!window.CustomEvent||W&&"function"!=typeof window.CustomEvent)&&(window.CustomEvent=function(t,o){o=o||{};var s=document.createEvent("CustomEvent");return s.initCustomEvent(t,!!o.bubbles,!!o.cancelable,o.detail),s},window.CustomEvent.prototype=window.Event.prototype),!window.MouseEvent||W&&"function"!=typeof window.MouseEvent){var ne=window.MouseEvent;if(window.MouseEvent=function(t,o){o=o||{};var s=document.createEvent("MouseEvent");return s.initMouseEvent(t,!!o.bubbles,!!o.cancelable,o.view||window,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,o.relatedTarget),s},ne)for(var ie in ne)window.MouseEvent[ie]=ne[ie];window.MouseEvent.prototype=ne.prototype}var se,he=function(){function a(){l++}var t=!1,o=!1,s={get capture(){return t=!0},get once(){return o=!0}},l=0,h=document.createElement("div");h.addEventListener("click",a,s);var v=t&&o;return v&&(h.dispatchEvent(new Event("click")),h.dispatchEvent(new Event("click")),v=1==l),h.removeEventListener("click",a,s),v}(),me=null!==(se=window.EventTarget)&&void 0!==se?se:window.Node;if(!he&&"addEventListener"in me.prototype){var lb=function(t){if(!t||"object"!=typeof t&&"function"!=typeof t){var o=!!t;t=!1}else o=!!t.capture,t=!!t.once;return{capture:o,once:t}},_e=me.prototype.addEventListener,Ce=me.prototype.removeEventListener,ke=new WeakMap,Se=new WeakMap,sb=function(t,o,s){var l=s?ke:Se;return void 0===(s=l.get(t))&&l.set(t,s=new Map),void 0===(t=s.get(o))&&s.set(o,t=new WeakMap),t};me.prototype.addEventListener=function(t,o,s){var l=this;if(null!=o){var h=(s=lb(s)).capture;s=s.once;var v=sb(this,t,h);if(!v.has(o)){var m=s?function(s){return v.delete(o),Ce.call(l,t,m,h),"function"==typeof o?o.call(l,s):"function"==typeof(null==o?void 0:o.handleEvent)?o.handleEvent(s):void 0}:null;v.set(o,m),_e.call(this,t,null!=m?m:o,h)}}},me.prototype.removeEventListener=function(t,o,s){if(null!=o){s=lb(s).capture;var l=sb(this,t,s),h=l.get(o);void 0!==h&&(l.delete(o),Ce.call(this,t,null!=h?h:o,s))}}}Object.getOwnPropertyDescriptor(Node.prototype,"baseURI")||Object.defineProperty(Node.prototype,"baseURI",{get:function(){var t=(this.ownerDocument||this).querySelector("base[href]");return t&&t.href||window.location.href},configurable:!0,enumerable:!0});var Ee,Pe,Re=Element.prototype,$e=null!==(Ee=Object.getOwnPropertyDescriptor(Re,"attributes"))&&void 0!==Ee?Ee:Object.getOwnPropertyDescriptor(Node.prototype,"attributes"),De=null!==(Pe=null==$e?void 0:$e.get)&&void 0!==Pe?Pe:function(){return this.attributes},Be=Array.prototype.map;Re.hasOwnProperty("getAttributeNames")||(Re.getAttributeNames=function(){return Be.call(De.call(this),(function(t){return t.name}))});var je,ze=Element.prototype;ze.hasOwnProperty("matches")||(ze.matches=null!==(je=ze.webkitMatchesSelector)&&void 0!==je?je:ze.msMatchesSelector);var Ye=Node.prototype.appendChild;function Cb(t){(t=t.prototype).hasOwnProperty("append")||Object.defineProperty(t,"append",{configurable:!0,enumerable:!0,writable:!0,value:function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];for(s=(o=ka(o)).next();!s.done;s=o.next())s=s.value,Ye.call(this,"string"==typeof s?document.createTextNode(s):s)}})}Cb(Document),Cb(DocumentFragment),Cb(Element);var Xe,et,tt=Node.prototype.insertBefore,rt=null!==(et=null===(Xe=Object.getOwnPropertyDescriptor(Node.prototype,"firstChild"))||void 0===Xe?void 0:Xe.get)&&void 0!==et?et:function(){return this.firstChild};function Hb(t){(t=t.prototype).hasOwnProperty("prepend")||Object.defineProperty(t,"prepend",{configurable:!0,enumerable:!0,writable:!0,value:function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];s=rt.call(this);for(var l=(o=ka(o)).next();!l.done;l=o.next())l=l.value,tt.call(this,"string"==typeof l?document.createTextNode(l):l,s)}})}Hb(Document),Hb(DocumentFragment),Hb(Element);var ot,nt,it=Node.prototype.appendChild,st=Node.prototype.removeChild,lt=null!==(nt=null===(ot=Object.getOwnPropertyDescriptor(Node.prototype,"firstChild"))||void 0===ot?void 0:ot.get)&&void 0!==nt?nt:function(){return this.firstChild};function Nb(t){(t=t.prototype).hasOwnProperty("replaceChildren")||Object.defineProperty(t,"replaceChildren",{configurable:!0,enumerable:!0,writable:!0,value:function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];for(;null!==(s=lt.call(this));)st.call(this,s);for(s=(o=ka(o)).next();!s.done;s=o.next())s=s.value,it.call(this,"string"==typeof s?document.createTextNode(s):s)}})}Nb(Document),Nb(DocumentFragment),Nb(Element);var ct,dt,ut,ht,pt=Node.prototype.insertBefore,ft=null!==(dt=null===(ct=Object.getOwnPropertyDescriptor(Node.prototype,"parentNode"))||void 0===ct?void 0:ct.get)&&void 0!==dt?dt:function(){return this.parentNode},gt=null!==(ht=null===(ut=Object.getOwnPropertyDescriptor(Node.prototype,"nextSibling"))||void 0===ut?void 0:ut.get)&&void 0!==ht?ht:function(){return this.nextSibling};function Vb(t){(t=t.prototype).hasOwnProperty("after")||Object.defineProperty(t,"after",{configurable:!0,enumerable:!0,writable:!0,value:function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];if(null!==(s=ft.call(this)))for(var l=gt.call(this),h=(o=ka(o)).next();!h.done;h=o.next())h=h.value,pt.call(s,"string"==typeof h?document.createTextNode(h):h,l)}})}Vb(CharacterData),Vb(Element);var vt,mt,bt=Node.prototype.insertBefore,yt=null!==(mt=null===(vt=Object.getOwnPropertyDescriptor(Node.prototype,"parentNode"))||void 0===vt?void 0:vt.get)&&void 0!==mt?mt:function(){return this.parentNode};function $b(t){(t=t.prototype).hasOwnProperty("before")||Object.defineProperty(t,"before",{configurable:!0,enumerable:!0,writable:!0,value:function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];if(null!==(s=yt.call(this)))for(var l=(o=ka(o)).next();!l.done;l=o.next())l=l.value,bt.call(s,"string"==typeof l?document.createTextNode(l):l,this)}})}$b(CharacterData),$b(Element);var wt,_t,Ct=Node.prototype.removeChild,kt=null!==(_t=null===(wt=Object.getOwnPropertyDescriptor(Node.prototype,"parentNode"))||void 0===wt?void 0:wt.get)&&void 0!==_t?_t:function(){return this.parentNode};function ec(t){(t=t.prototype).hasOwnProperty("remove")||Object.defineProperty(t,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=kt.call(this);t&&Ct.call(t,this)}})}ec(CharacterData),ec(Element);var Tt,St,xt=Node.prototype.insertBefore,Et=Node.prototype.removeChild,It=null!==(St=null===(Tt=Object.getOwnPropertyDescriptor(Node.prototype,"parentNode"))||void 0===Tt?void 0:Tt.get)&&void 0!==St?St:function(){return this.parentNode};function lc(t){(t=t.prototype).hasOwnProperty("replaceWith")||Object.defineProperty(t,"replaceWith",{configurable:!0,enumerable:!0,writable:!0,value:function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];if(null!==(s=It.call(this))){for(var l=(o=ka(o)).next();!l.done;l=o.next())l=l.value,xt.call(s,"string"==typeof l?document.createTextNode(l):l,this);Et.call(s,this)}}})}lc(CharacterData),lc(Element);var At=window.Element.prototype,Pt=window.HTMLElement.prototype,Rt=window.SVGElement.prototype;!Pt.hasOwnProperty("classList")||At.hasOwnProperty("classList")||Rt.hasOwnProperty("classList")||Object.defineProperty(At,"classList",Object.getOwnPropertyDescriptor(Pt,"classList"));var Ot=document.createElement("style");Ot.textContent="body {transition: opacity ease-in 0.2s; } \nbody[unresolved] {opacity: 0; display: block; overflow: hidden; position: relative; } \n";var $t=document.querySelector("head");$t.insertBefore(Ot,$t.firstChild);var Nt=window;Nt.WebComponents=Nt.WebComponents||{flags:{}};var Mt=document.querySelector('script[src*="webcomponents-bundle"]'),Dt=/wc-(.+)/,Lt={};if(!Lt.noOpts){if(location.search.slice(1).split("&").forEach((function(t){var o;(t=t.split("="))[0]&&(o=t[0].match(Dt))&&(Lt[o[1]]=t[1]||!0)})),Mt)for(var Ft=0,Ut=void 0;Ut=Mt.attributes[Ft];Ft++)"src"!==Ut.name&&(Lt[Ut.name]=Ut.value||!0);var Ht={};Lt.log&&Lt.log.split&&Lt.log.split(",").forEach((function(t){Ht[t]=!0})),Lt.log=Ht}Nt.WebComponents.flags=Lt;var Bt=Lt.shadydom;if(Bt){Nt.ShadyDOM=Nt.ShadyDOM||{},Nt.ShadyDOM.force=Bt;var qt=Lt.noPatch;Nt.ShadyDOM.noPatch="true"===qt||qt}var jt=Lt.register||Lt.ce;function Bc(){}function D(t){return t.__shady||(t.__shady=new Bc),t.__shady}function L(t){return t&&t.__shady}jt&&window.customElements&&(Nt.customElements.forcePolyfill=jt),function(){function a(){}function b(t,o){if(!t.childNodes.length)return[];switch(t.nodeType){case Node.DOCUMENT_NODE:return z.call(t,o);case Node.DOCUMENT_FRAGMENT_NODE:return K.call(t,o);default:return j.call(t,o)}}var t="undefined"==typeof HTMLTemplateElement,o=!(document.createDocumentFragment().cloneNode()instanceof DocumentFragment),s=!1;/Trident/.test(navigator.userAgent)&&function(){function p(t,s){if(t instanceof DocumentFragment)for(var l;l=t.firstChild;)o.call(this,l,s);else o.call(this,t,s);return t}s=!0;var t=Node.prototype.cloneNode;Node.prototype.cloneNode=function(o){return o=t.call(this,o),this instanceof DocumentFragment&&(o.__proto__=DocumentFragment.prototype),o},DocumentFragment.prototype.querySelectorAll=HTMLElement.prototype.querySelectorAll,DocumentFragment.prototype.querySelector=HTMLElement.prototype.querySelector,Object.defineProperties(DocumentFragment.prototype,{nodeType:{get:function(){return Node.DOCUMENT_FRAGMENT_NODE},configurable:!0},localName:{get:function(){},configurable:!0},nodeName:{get:function(){return"#document-fragment"},configurable:!0}});var o=Node.prototype.insertBefore;Node.prototype.insertBefore=p;var l=Node.prototype.appendChild;Node.prototype.appendChild=function(t){return t instanceof DocumentFragment?p.call(this,t,null):l.call(this,t),t};var h=Node.prototype.removeChild,v=Node.prototype.replaceChild;Node.prototype.replaceChild=function(t,o){return t instanceof DocumentFragment?(p.call(this,t,o),h.call(this,o)):v.call(this,t,o),o},Document.prototype.createDocumentFragment=function(){var t=this.createElement("df");return t.__proto__=DocumentFragment.prototype,t};var m=Document.prototype.importNode;Document.prototype.importNode=function(t,o){return o=m.call(this,t,o||!1),t instanceof DocumentFragment&&(o.__proto__=DocumentFragment.prototype),o}}();var l=Node.prototype.cloneNode,h=Document.prototype.createElement,v=Document.prototype.importNode,m=Node.prototype.removeChild,_=Node.prototype.appendChild,R=Node.prototype.replaceChild,$=DOMParser.prototype.parseFromString,B=Object.getOwnPropertyDescriptor(window.HTMLElement.prototype,"innerHTML")||{get:function(){return this.innerHTML},set:function(t){this.innerHTML=t}},q=Object.getOwnPropertyDescriptor(window.Node.prototype,"childNodes")||{get:function(){return this.childNodes}},j=Element.prototype.querySelectorAll,z=Document.prototype.querySelectorAll,K=DocumentFragment.prototype.querySelectorAll,W=function(){if(!t){var s=document.createElement("template"),l=document.createElement("template");return l.content.appendChild(document.createElement("div")),s.content.appendChild(l),0===(s=s.cloneNode(!0)).content.childNodes.length||0===s.content.firstChild.content.childNodes.length||o}}();if(t){var Z=document.implementation.createHTMLDocument("template"),te=!0,ne=document.createElement("style");ne.textContent="template{display:none;}";var ie=document.head;ie.insertBefore(ne,ie.firstElementChild),a.prototype=Object.create(HTMLElement.prototype);var se=!document.createElement("div").hasOwnProperty("innerHTML");a.Z=function(t){if(!t.content&&t.namespaceURI===document.documentElement.namespaceURI){t.content=Z.createDocumentFragment();for(var o;o=t.firstChild;)_.call(t.content,o);if(se)t.__proto__=a.prototype;else if(t.cloneNode=function(t){return a.va(this,t)},te)try{n(t),J(t)}catch(t){te=!1}a.bootstrap(t.content)}};var he={option:["select"],thead:["table"],col:["colgroup","table"],tr:["tbody","table"],th:["tr","tbody","table"],td:["tr","tbody","table"]},n=function(t){Object.defineProperty(t,"innerHTML",{get:function(){return xa(this)},set:function(t){var o=he[(/<([a-z][^/\0>\x20\t\r\n\f]+)/i.exec(t)||["",""])[1].toLowerCase()];if(o)for(var s=0;s<o.length;s++)t="<"+o[s]+">"+t+"</"+o[s]+">";for(Z.body.innerHTML=t,a.bootstrap(Z);this.content.firstChild;)m.call(this.content,this.content.firstChild);if(t=Z.body,o)for(s=0;s<o.length;s++)t=t.lastChild;for(;t.firstChild;)_.call(this.content,t.firstChild)},configurable:!0})},J=function(t){Object.defineProperty(t,"outerHTML",{get:function(){return"<template>"+this.innerHTML+"</template>"},set:function(t){if(!this.parentNode)throw Error("Failed to set the 'outerHTML' property on 'Element': This element has no parent node.");for(Z.body.innerHTML=t,t=this.ownerDocument.createDocumentFragment();Z.body.firstChild;)_.call(t,Z.body.firstChild);R.call(this.parentNode,t,this)},configurable:!0})};n(a.prototype),J(a.prototype),a.bootstrap=function(t){for(var o,s=0,l=(t=b(t,"template")).length;s<l&&(o=t[s]);s++)a.Z(o)},document.addEventListener("DOMContentLoaded",(function(){a.bootstrap(document)})),Document.prototype.createElement=function(){var t=h.apply(this,arguments);return"template"===t.localName&&a.Z(t),t},DOMParser.prototype.parseFromString=function(){var t=$.apply(this,arguments);return a.bootstrap(t),t},Object.defineProperty(HTMLElement.prototype,"innerHTML",{get:function(){return xa(this)},set:function(t){B.set.call(this,t),a.bootstrap(this)},configurable:!0,enumerable:!0});var me=/[&\u00A0"]/g,_e=/[&\u00A0<>]/g,ib=function(t){switch(t){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"Â ":return"&nbsp;"}};ne=function(t){for(var o={},s=0;s<t.length;s++)o[t[s]]=!0;return o};var Ce=ne("area base br col command embed hr img input keygen link meta param source track wbr".split(" ")),ke=ne("style script xmp iframe noembed noframes plaintext noscript".split(" ")),xa=function(t,o){"template"===t.localName&&(t=t.content);for(var s,l="",h=o?o(t):q.get.call(t),v=0,m=h.length;v<m&&(s=h[v]);v++){e:{var _=s,R=t,$=o;switch(_.nodeType){case Node.ELEMENT_NODE:for(var B=_.localName,j="<"+B,z=_.attributes,K=0;R=z[K];K++)j+=" "+R.name+'="'+R.value.replace(me,ib)+'"';j+=">",_=Ce[B]?j:j+xa(_,$)+"</"+B+">";break e;case Node.TEXT_NODE:_=_.data,_=R&&ke[R.localName]?_:_.replace(_e,ib);break e;case Node.COMMENT_NODE:_="\x3c!--"+_.data+"--\x3e";break e;default:throw window.console.error(_),Error("not implemented")}}l+=_}return l}}if(t||W){a.va=function(t,o){var s=l.call(t,!1);return this.Z&&this.Z(s),o&&(_.call(s.content,l.call(t.content,!0)),I(s.content,t.content)),s};var I=function(t,o){if(o.querySelectorAll&&0!==(o=b(o,"template")).length)for(var s,l,h=0,v=(t=b(t,"template")).length;h<v;h++)l=o[h],s=t[h],a&&a.Z&&a.Z(l),R.call(s.parentNode,Se.call(l,!0),s)},Se=Node.prototype.cloneNode=function(t){if(!s&&o&&this instanceof DocumentFragment){if(!t)return this.ownerDocument.createDocumentFragment();var h=Ee.call(this.ownerDocument,this,!0)}else h=this.nodeType===Node.ELEMENT_NODE&&"template"===this.localName&&this.namespaceURI==document.documentElement.namespaceURI?a.va(this,t):l.call(this,t);return t&&I(h,this),h},Ee=Document.prototype.importNode=function(t,o){if(o=o||!1,"template"===t.localName)return a.va(t,o);var s=v.call(this,t,o);if(o){I(s,t),t=b(s,'script:not([type]),script[type="application/javascript"],script[type="text/javascript"]');for(var l,m=0;m<t.length;m++){l=t[m],(o=h.call(document,"script")).textContent=l.textContent;for(var _,$=l.attributes,B=0;B<$.length;B++)_=$[B],o.setAttribute(_.name,_.value);R.call(l.parentNode,o,l)}}return s}}t&&(window.HTMLTemplateElement=a)}(),Bc.prototype.toJSON=function(){return{}};var zt=window.ShadyDOM||{};zt.cb=!(!Element.prototype.attachShadow||!Node.prototype.getRootNode);var Vt,Gt=Object.getOwnPropertyDescriptor(Node.prototype,"firstChild");zt.D=!!(Gt&&Gt.configurable&&Gt.get),zt.Ba=zt.force||!zt.cb,zt.J=zt.noPatch||!1,zt.ha=zt.preferPerformance,zt.Da="on-demand"===zt.J;var Kt=zt.querySelectorImplementation;function Fc(){return Document.prototype.msElementsFromPoint?"msElementsFromPoint":"elementsFromPoint"}function Gc(t){return(t=L(t))&&void 0!==t.firstChild}function O(t){return t instanceof ShadowRoot}function Hc(t){return(t=(t=L(t))&&t.root)&&Ic(t)}Vt=-1<["native","selectorEngine"].indexOf(Kt)?Kt:void 0,zt.wb=Vt,zt.Ra=navigator.userAgent.match("Trident");var Wt=Element.prototype,Qt=Wt.matches||Wt.matchesSelector||Wt.mozMatchesSelector||Wt.msMatchesSelector||Wt.oMatchesSelector||Wt.webkitMatchesSelector,Yt=document.createTextNode(""),Jt=0,Xt=[];function Pc(t){Xt.push(t),Yt.textContent=Jt++}new MutationObserver((function(){for(;Xt.length;)try{Xt.shift()()}catch(t){throw Yt.textContent=Jt++,t}})).observe(Yt,{characterData:!0});var Zt=document.contains?function(t,o){return t.__shady_native_contains(o)}:function(t,o){return t===o||t.documentElement&&t.documentElement.__shady_native_contains(o)};function Rc(t,o){for(;o;){if(o==t)return!0;o=o.__shady_parentNode}return!1}function Sc(t){for(var o=t.length-1;0<=o;o--){var s=t[o],l=s.getAttribute("id")||s.getAttribute("name");l&&"length"!==l&&isNaN(l)&&(t[l]=s)}return t.item=function(o){return t[o]},t.namedItem=function(o){if("length"!==o&&isNaN(o)&&t[o])return t[o];for(var s=ka(t),l=s.next();!l.done;l=s.next())if(((l=l.value).getAttribute("id")||l.getAttribute("name"))==o)return l;return null},t}function Tc(t){var o=[];for(t=t.__shady_native_firstChild;t;t=t.__shady_native_nextSibling)o.push(t);return o}function Uc(t){var o=[];for(t=t.__shady_firstChild;t;t=t.__shady_nextSibling)o.push(t);return o}function Vc(t,o,s){if(s.configurable=!0,s.value)t[o]=s.value;else try{Object.defineProperty(t,o,s)}catch(t){}}function P(t,o,s,l){for(var h in s=void 0===s?"":s,o)l&&0<=l.indexOf(h)||Vc(t,s+h,o[h])}function Wc(t,o){for(var s in o)s in t&&Vc(t,s,o[s])}function Q(t){var o={};return Object.getOwnPropertyNames(t).forEach((function(s){o[s]=Object.getOwnPropertyDescriptor(t,s)})),o}function Xc(t,o){for(var s,l=Object.getOwnPropertyNames(o),h=0;h<l.length;h++)t[s=l[h]]=o[s]}function Yc(t){return t instanceof Node?t:document.createTextNode(""+t)}function Zc(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];if(1===o.length)return Yc(o[0]);s=document.createDocumentFragment();for(var l=(o=ka(o)).next();!l.done;l=o.next())s.appendChild(Yc(l.value));return s}function $c(t){var o;for(o=void 0===o?1:o;0<o;o--)t=t.reduce((function(t,o){return Array.isArray(o)?t.push.apply(t,w(o)):t.push(o),t}),[]);return t}var er,tr=[];function dd(t){er||(er=!0,Pc(ed)),tr.push(t)}function ed(){er=!1;for(var t=!!tr.length;tr.length;)tr.shift()();return t}function fd(){this.g=!1,this.addedNodes=[],this.removedNodes=[],this.qa=new Set}ed.list=tr,fd.prototype.flush=function(){if(this.g){this.g=!1;var t=this.takeRecords();t.length&&this.qa.forEach((function(o){o(t)}))}},fd.prototype.takeRecords=function(){if(this.addedNodes.length||this.removedNodes.length){var t=[{addedNodes:this.addedNodes,removedNodes:this.removedNodes}];return this.addedNodes=[],this.removedNodes=[],t}return[]};var rr=/[&\u00A0"]/g,or=/[&\u00A0<>]/g;function md(t){switch(t){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"Â ":return"&nbsp;"}}function nd(t){for(var o={},s=0;s<t.length;s++)o[t[s]]=!0;return o}var nr=nd("area base br col command embed hr img input keygen link meta param source track wbr".split(" ")),ir=nd("style script xmp iframe noembed noframes plaintext noscript".split(" "));function qd(t,o){"template"===t.localName&&(t=t.content);for(var s="",l=o?o(t):t.childNodes,h=0,v=l.length,m=void 0;h<v&&(m=l[h]);h++){e:{var _=m,R=t,$=o;switch(_.nodeType){case Node.ELEMENT_NODE:for(var B,q="<"+(R=_.localName),j=_.attributes,z=0;B=j[z];z++)q+=" "+B.name+'="'+B.value.replace(rr,md)+'"';q+=">",_=nr[R]?q:q+qd(_,$)+"</"+R+">";break e;case Node.TEXT_NODE:_=_.data,_=R&&ir[R.localName]?_:_.replace(or,md);break e;case Node.COMMENT_NODE:_="\x3c!--"+_.data+"--\x3e";break e;default:throw window.console.error(_),Error("not implemented")}}s+=_}return s}var sr=zt.D,ar={querySelector:function(t){return this.__shady_native_querySelector(t)},querySelectorAll:function(t){return this.__shady_native_querySelectorAll(t)}},lr={};function ud(t){lr[t]=function(o){return o["__shady_native_"+t]}}function vd(t,o){for(var s in P(t,o,"__shady_native_"),o)ud(s)}function S(t,o){o=void 0===o?[]:o;for(var s=0;s<o.length;s++){var l=o[s],h=Object.getOwnPropertyDescriptor(t,l);h&&(Object.defineProperty(t,"__shady_native_"+l,h),h.value?ar[l]||(ar[l]=h.value):ud(l))}}var cr=document.createTreeWalker(document,NodeFilter.SHOW_ALL,null,!1),dr=document.createTreeWalker(document,NodeFilter.SHOW_ELEMENT,null,!1),ur=document.implementation.createHTMLDocument("inert");function zd(t){for(var o;o=t.__shady_native_firstChild;)t.__shady_native_removeChild(o)}var hr=["firstElementChild","lastElementChild","children","childElementCount"],pr=["querySelector","querySelectorAll","append","prepend","replaceChildren"];var fr=Q({get childNodes(){return this.__shady_childNodes},get firstChild(){return this.__shady_firstChild},get lastChild(){return this.__shady_lastChild},get childElementCount(){return this.__shady_childElementCount},get children(){return this.__shady_children},get firstElementChild(){return this.__shady_firstElementChild},get lastElementChild(){return this.__shady_lastElementChild},get shadowRoot(){return this.__shady_shadowRoot}}),gr=Q({get textContent(){return this.__shady_textContent},set textContent(t){this.__shady_textContent=t},get innerHTML(){return this.__shady_innerHTML},set innerHTML(t){this.__shady_innerHTML=t}}),vr=Q({get parentElement(){return this.__shady_parentElement},get parentNode(){return this.__shady_parentNode},get nextSibling(){return this.__shady_nextSibling},get previousSibling(){return this.__shady_previousSibling},get nextElementSibling(){return this.__shady_nextElementSibling},get previousElementSibling(){return this.__shady_previousElementSibling},get className(){return this.__shady_className},set className(t){this.__shady_className=t}});function Gd(t){for(var o in t){var s=t[o];s&&(s.enumerable=!1)}}Gd(fr),Gd(gr),Gd(vr);var mr=zt.D||!0===zt.J,br=mr?function(){}:function(t){var o=D(t);o.Ta||(o.Ta=!0,Wc(t,vr))},yr=mr?function(){}:function(t){var o=D(t);o.Sa||(o.Sa=!0,Wc(t,fr),window.customElements&&window.customElements.polyfillWrapFlushCallback&&!zt.J||Wc(t,gr))},wr="__eventWrappers"+Date.now(),_r=function(){var t=Object.getOwnPropertyDescriptor(Event.prototype,"composed");return t?function(o){return t.get.call(o)}:null}(),Cr=function(){function a(){}var t=!1,o={get capture(){return t=!0,!1}};return window.addEventListener("test",a,o),window.removeEventListener("test",a,o),t}();function Nd(t){if(null===t||"object"!=typeof t&&"function"!=typeof t)var o=!!t,s=!1;else{o=!!t.capture,s=!!t.once;var l=t.U}return{Pa:l,capture:o,once:s,Na:Cr?t:o}}var kr={blur:!0,focus:!0,focusin:!0,focusout:!0,click:!0,dblclick:!0,mousedown:!0,mouseenter:!0,mouseleave:!0,mousemove:!0,mouseout:!0,mouseover:!0,mouseup:!0,wheel:!0,beforeinput:!0,input:!0,keydown:!0,keyup:!0,compositionstart:!0,compositionupdate:!0,compositionend:!0,touchstart:!0,touchend:!0,touchmove:!0,touchcancel:!0,pointerover:!0,pointerenter:!0,pointerdown:!0,pointermove:!0,pointerup:!0,pointercancel:!0,pointerout:!0,pointerleave:!0,gotpointercapture:!0,lostpointercapture:!0,dragstart:!0,drag:!0,dragenter:!0,dragleave:!0,dragover:!0,drop:!0,dragend:!0,DOMActivate:!0,DOMFocusIn:!0,DOMFocusOut:!0,keypress:!0},Tr={DOMAttrModified:!0,DOMAttributeNameChanged:!0,DOMCharacterDataModified:!0,DOMElementNameChanged:!0,DOMNodeInserted:!0,DOMNodeInsertedIntoDocument:!0,DOMNodeRemoved:!0,DOMNodeRemovedFromDocument:!0,DOMSubtreeModified:!0};function Qd(t){return t instanceof Node?t.__shady_getRootNode():t}function Rd(t,o){var s=[],l=t;for(t=Qd(t);l;)s.push(l),l=l.__shady_assignedSlot?l.__shady_assignedSlot:l.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&l.host&&(o||l!==t)?l.host:l.__shady_parentNode;return s[s.length-1]===document&&s.push(window),s}function Td(t,o){if(!O)return t;t=Rd(t,!0);for(var s,l,h=0,v=void 0,m=void 0;h<o.length;h++)if((l=Qd(s=o[h]))!==v&&(m=t.indexOf(l),v=l),!O(l)||-1<m)return s}var Sr={get composed(){return void 0===this.__composed&&(_r?this.__composed="focusin"===this.type||"focusout"===this.type||_r(this):!1!==this.isTrusted&&(this.__composed=kr[this.type])),this.__composed||!1},composedPath:function(){return this.__composedPath||(this.__composedPath=Rd(this.__target,this.composed)),this.__composedPath},get target(){return Td(this.currentTarget||this.__previousCurrentTarget,this.composedPath())},get relatedTarget(){return this.__relatedTarget?(this.__relatedTargetComposedPath||(this.__relatedTargetComposedPath=Rd(this.__relatedTarget,!0)),Td(this.currentTarget||this.__previousCurrentTarget,this.__relatedTargetComposedPath)):null},stopPropagation:function(){Event.prototype.stopPropagation.call(this),this.ua=!0},stopImmediatePropagation:function(){Event.prototype.stopImmediatePropagation.call(this),this.ua=this.__immediatePropagationStopped=!0}},xr=zt.D&&Object.getOwnPropertyDescriptor(Event.prototype,"eventPhase");function Wd(t){function b(o,s){return(o=new t(o,s)).__composed=s&&!!s.composed,o}return b.__proto__=t,b.prototype=t.prototype,b}xr&&(Object.defineProperty(Sr,"eventPhase",{get:function(){return this.currentTarget===this.target?Event.AT_TARGET:this.__shady_native_eventPhase},enumerable:!0,configurable:!0}),Object.defineProperty(Sr,"__shady_native_eventPhase",xr));var Er={focus:!0,blur:!0};function Yd(t){return t.__target!==t.target||t.__relatedTarget!==t.relatedTarget}function Zd(t,o,s){if(s=o.__handlers&&o.__handlers[t.type]&&o.__handlers[t.type][s])for(var l,h=0;(l=s[h])&&(!Yd(t)||t.target!==t.relatedTarget)&&(l.call(o,t),!t.__immediatePropagationStopped);h++);}var Ir=new Event("e").hasOwnProperty("currentTarget");function ae(t){var o=(t=Ir?Object.create(t):t).composedPath(),s=o.map((function(t){return Td(t,o)})),l=t.bubbles,h=Object.getOwnPropertyDescriptor(t,"currentTarget");Object.defineProperty(t,"currentTarget",{configurable:!0,enumerable:!0,get:function(){return R}});var v=Event.CAPTURING_PHASE,m=Object.getOwnPropertyDescriptor(t,"eventPhase");Object.defineProperty(t,"eventPhase",{configurable:!0,enumerable:!0,get:function(){return v}});try{for(var _=o.length-1;0<=_;_--){var R=o[_];if(v=R===s[_]?Event.AT_TARGET:Event.CAPTURING_PHASE,Zd(t,R,"capture"),t.ua)return}for(_=0;_<o.length;_++){var $=(R=o[_])===s[_];if(($||l)&&(v=$?Event.AT_TARGET:Event.BUBBLING_PHASE,Zd(t,R,"bubble"),t.ua))break}}finally{Ir||(h?Object.defineProperty(t,"currentTarget",h):delete t.currentTarget,m?Object.defineProperty(t,"eventPhase",m):delete t.eventPhase)}}function be(t,o,s,l){for(var h=0;h<t.length;h++){var v=t[h],m=v.type,_=v.capture;if(o===v.node&&s===m&&l===_)return h}return-1}function ce(t){return ed(),!zt.ha&&this instanceof Node&&!Zt(document,this)?(t.__target||de(t,this),ae(t)):this.__shady_native_dispatchEvent(t)}function ee(t,o,s){var l=this,h=Nd(s),v=h.capture,m=h.once,_=h.Pa;if(h=h.Na,o){var R=typeof o;if(("function"===R||"object"===R)&&("object"!==R||o.handleEvent&&"function"==typeof o.handleEvent)){if(Tr[t])return this.__shady_native_addEventListener(t,o,h);var $=_||this;if(_=o[wr]){if(-1<be(_,$,t,v))return}else o[wr]=[];_=function(h){if(m&&l.__shady_removeEventListener(t,o,s),h.__target||de(h),$!==l){var _=Object.getOwnPropertyDescriptor(h,"currentTarget");Object.defineProperty(h,"currentTarget",{get:function(){return $},configurable:!0});var B=Object.getOwnPropertyDescriptor(h,"eventPhase");Object.defineProperty(h,"eventPhase",{configurable:!0,enumerable:!0,get:function(){return v?Event.CAPTURING_PHASE:Event.BUBBLING_PHASE}})}if(h.__previousCurrentTarget=h.currentTarget,(!O($)&&"slot"!==$.localName||-1!=h.composedPath().indexOf($))&&(h.composed||-1<h.composedPath().indexOf($)))if(Yd(h)&&h.target===h.relatedTarget)h.eventPhase===Event.BUBBLING_PHASE&&h.stopImmediatePropagation();else if(h.eventPhase===Event.CAPTURING_PHASE||h.bubbles||h.target===$||$ instanceof Window){var q="function"===R?o.call($,h):o.handleEvent&&o.handleEvent(h);return $!==l&&(_?(Object.defineProperty(h,"currentTarget",_),_=null):delete h.currentTarget,B?(Object.defineProperty(h,"eventPhase",B),B=null):delete h.eventPhase),q}},o[wr].push({node:$,type:t,capture:v,ub:_}),this.__handlers=this.__handlers||{},this.__handlers[t]=this.__handlers[t]||{capture:[],bubble:[]},this.__handlers[t][v?"capture":"bubble"].push(_),Er[t]||this.__shady_native_addEventListener(t,_,h)}}}function fe(t,o,s){if(o){var l=Nd(s);s=l.capture;var h=l.Pa;if(l=l.Na,Tr[t])return this.__shady_native_removeEventListener(t,o,l);var v=h||this;h=void 0;var m=null;try{m=o[wr]}catch(t){}m&&(-1<(v=be(m,v,t,s))&&(h=m.splice(v,1)[0].ub,m.length||(o[wr]=void 0))),this.__shady_native_removeEventListener(t,h||o,l),h&&this.__handlers&&this.__handlers[t]&&(-1<(o=(t=this.__handlers[t][s?"capture":"bubble"]).indexOf(h))&&t.splice(o,1))}}var Ar=Q(Sr);function de(t,o){if(o=void 0===o?t.target:o,t.__target=o,t.__relatedTarget=t.relatedTarget,zt.D){if(!(o=Object.getPrototypeOf(t)).hasOwnProperty("__shady_patchedProto")){var s=Object.create(o);s.__shady_sourceProto=o,P(s,Ar),o.__shady_patchedProto=s}t.__proto__=o.__shady_patchedProto}else P(t,Ar)}var Pr=Wd(Event),Rr=Wd(CustomEvent),Or=Wd(MouseEvent);var $r=Object.getOwnPropertyNames(Element.prototype).filter((function(t){return"on"===t.substring(0,2)})),Nr=Object.getOwnPropertyNames(HTMLElement.prototype).filter((function(t){return"on"===t.substring(0,2)}));function oe(t){return{set:function(o){var s=D(this),l=t.substring(2);s.T||(s.T={}),s.T[t]&&this.removeEventListener(l,s.T[t]),this.__shady_addEventListener(l,o),s.T[t]=o},get:function(){var o=L(this);return o&&o.T&&o.T[t]},configurable:!0}}function pe(t,o){return{index:t,ia:[],pa:o}}function qe(t,o,s,l){var h=0,v=0,m=0,_=0,R=Math.min(o-h,l-v);if(0==h&&0==v)e:{for(m=0;m<R;m++)if(t[m]!==s[m])break e;m=R}if(o==t.length&&l==s.length){_=t.length;for(var $=s.length,B=0;B<R-m&&re(t[--_],s[--$]);)B++;_=B}if(v+=m,l-=_,0==(o-=_)-(h+=m)&&0==l-v)return[];if(h==o){for(o=pe(h,0);v<l;)o.ia.push(s[v++]);return[o]}if(v==l)return[pe(h,o-h)];for(l=l-(m=v)+1,_=o-(R=h)+1,o=Array(l),$=0;$<l;$++)o[$]=Array(_),o[$][0]=$;for($=0;$<_;$++)o[0][$]=$;for($=1;$<l;$++)for(B=1;B<_;B++)if(t[R+B-1]===s[m+$-1])o[$][B]=o[$-1][B-1];else{var q=o[$-1][B]+1,j=o[$][B-1]+1;o[$][B]=q<j?q:j}for(R=o.length-1,m=o[0].length-1,l=o[R][m],t=[];0<R||0<m;)0==R?(t.push(2),m--):0==m?(t.push(3),R--):(_=o[R-1][m-1],(q=($=o[R-1][m])<(B=o[R][m-1])?$<_?$:_:B<_?B:_)==_?(_==l?t.push(0):(t.push(1),l=_),R--,m--):q==$?(t.push(3),R--,l=$):(t.push(2),m--,l=B));for(t.reverse(),o=void 0,R=[],m=0;m<t.length;m++)switch(t[m]){case 0:o&&(R.push(o),o=void 0),h++,v++;break;case 1:o||(o=pe(h,0)),o.pa++,h++,o.ia.push(s[v]),v++;break;case 2:o||(o=pe(h,0)),o.pa++,h++;break;case 3:o||(o=pe(h,0)),o.ia.push(s[v]),v++}return o&&R.push(o),R}function re(t,o){return t===o}var Mr=Q({dispatchEvent:ce,addEventListener:ee,removeEventListener:fe}),Dr=null;function ue(){return Dr||(Dr=window.ShadyCSS&&window.ShadyCSS.ScopingShim),Dr||null}function ve(t,o,s){var l=ue();return!(!l||"class"!==o)&&(l.setElementClass(t,s),!0)}function we(t,o){var s=ue();s&&s.unscopeNode(t,o)}function xe(t,o){var s=ue();if(!s)return!0;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE){for(s=!0,t=t.__shady_firstChild;t;t=t.__shady_nextSibling)s=s&&xe(t,o);return s}return t.nodeType!==Node.ELEMENT_NODE||s.currentScopeForNode(t)===o}function ye(t){if(t.nodeType!==Node.ELEMENT_NODE)return"";var o=ue();return o?o.currentScopeForNode(t):""}function Ae(t,o){if(t)for(t.nodeType===Node.ELEMENT_NODE&&o(t),t=t.__shady_firstChild;t;t=t.__shady_nextSibling)t.nodeType===Node.ELEMENT_NODE&&Ae(t,o)}var Lr=window.document,Fr=zt.ha,Ur=Object.getOwnPropertyDescriptor(Node.prototype,"isConnected"),Hr=Ur&&Ur.get;function Fe(t){for(var o;o=t.__shady_firstChild;)t.__shady_removeChild(o)}function Ge(t){var o=L(t);if(o&&void 0!==o.ta)for(o=t.__shady_firstChild;o;o=o.__shady_nextSibling)Ge(o);(t=L(t))&&(t.ta=void 0)}function He(t){var o=t;if(t&&"slot"===t.localName){var s=L(t);(s=s&&s.aa)&&(o=s.length?s[0]:He(t.__shady_nextSibling))}return o}function Ie(t,o,s){if(t=(t=L(t))&&t.ga){if(o)if(o.nodeType===Node.DOCUMENT_FRAGMENT_NODE)for(var l=0,h=o.childNodes.length;l<h;l++)t.addedNodes.push(o.childNodes[l]);else t.addedNodes.push(o);s&&t.removedNodes.push(s),function gd(t){t.g||(t.g=!0,Pc((function(){t.flush()})))}(t)}}var Br=Q({get parentNode(){var t=L(this);return void 0!==(t=t&&t.parentNode)?t:this.__shady_native_parentNode},get firstChild(){var t=L(this);return void 0!==(t=t&&t.firstChild)?t:this.__shady_native_firstChild},get lastChild(){var t=L(this);return void 0!==(t=t&&t.lastChild)?t:this.__shady_native_lastChild},get nextSibling(){var t=L(this);return void 0!==(t=t&&t.nextSibling)?t:this.__shady_native_nextSibling},get previousSibling(){var t=L(this);return void 0!==(t=t&&t.previousSibling)?t:this.__shady_native_previousSibling},get childNodes(){if(Gc(this)){var t=L(this);if(!t.childNodes){t.childNodes=[];for(var o=this.__shady_firstChild;o;o=o.__shady_nextSibling)t.childNodes.push(o)}var s=t.childNodes}else s=this.__shady_native_childNodes;return s.item=function(t){return s[t]},s},get parentElement(){var t=L(this);return(t=t&&t.parentNode)&&t.nodeType!==Node.ELEMENT_NODE&&(t=null),void 0!==t?t:this.__shady_native_parentElement},get isConnected(){if(Hr&&Hr.call(this))return!0;if(this.nodeType==Node.DOCUMENT_FRAGMENT_NODE)return!1;var t=this.ownerDocument;if(null===t||Zt(t,this))return!0;for(t=this;t&&!(t instanceof Document);)t=t.__shady_parentNode||(O(t)?t.host:void 0);return!!(t&&t instanceof Document)},get textContent(){if(Gc(this)){for(var t=[],o=this.__shady_firstChild;o;o=o.__shady_nextSibling)o.nodeType!==Node.COMMENT_NODE&&t.push(o.__shady_textContent);return t.join("")}return this.__shady_native_textContent},set textContent(t){switch(null==t&&(t=""),this.nodeType){case Node.ELEMENT_NODE:case Node.DOCUMENT_FRAGMENT_NODE:if(!Gc(this)&&zt.D){var o=this.__shady_firstChild;(o!=this.__shady_lastChild||o&&o.nodeType!=Node.TEXT_NODE)&&Fe(this),this.__shady_native_textContent=t}else Fe(this),(0<t.length||this.nodeType===Node.ELEMENT_NODE)&&this.__shady_insertBefore(document.createTextNode(t));break;default:this.nodeValue=t}},insertBefore:function(t,o){if(this.ownerDocument!==Lr&&t.ownerDocument!==Lr)return this.__shady_native_insertBefore(t,o),t;if(t===this)throw Error("Failed to execute 'appendChild' on 'Node': The new child element contains the parent.");if(o){var s=L(o);if(void 0!==(s=s&&s.parentNode)&&s!==this||void 0===s&&o.__shady_native_parentNode!==this)throw Error("Failed to execute 'insertBefore' on 'Node': The node before which the new node is to be inserted is not a child of this node.")}if(o===t)return t;Ie(this,t);var l=[],h=(s=Je(this))?s.host.localName:ye(this),v=t.__shady_parentNode;if(v){var m=ye(t),_=!!s||!Je(t)||Fr&&void 0!==this.__noInsertionPoint;v.__shady_removeChild(t,_)}v=!0;var R=(!Fr||void 0===t.__noInsertionPoint&&void 0===this.__noInsertionPoint)&&!xe(t,h),$=s&&!t.__noInsertionPoint&&(!Fr||t.nodeType===Node.DOCUMENT_FRAGMENT_NODE);return($||R)&&(R&&(m=m||ye(t)),Ae(t,(function(t){if($&&"slot"===t.localName&&l.push(t),R){var o=m;ue()&&(o&&we(t,o),(o=ue())&&o.scopeNode(t,h))}}))),l.length&&(Ke(s),s.i.push.apply(s.i,w(l)),Le(s)),Gc(this)&&(function Me(t,o,s){Jf(o,2);var l=D(o);if(void 0!==l.firstChild&&(l.childNodes=null),t.nodeType===Node.DOCUMENT_FRAGMENT_NODE)for(t=t.__shady_native_firstChild;t;t=t.__shady_native_nextSibling)Kf(t,o,l,s);else Kf(t,o,l,s)}(t,this,o),(_=L(this)).root?(v=!1,Hc(this)&&Le(_.root)):s&&"slot"===this.localName&&(v=!1,Le(s))),v?(s=O(this)?this.host:this,o?(o=He(o),s.__shady_native_insertBefore(t,o)):s.__shady_native_appendChild(t)):t.ownerDocument!==this.ownerDocument&&this.ownerDocument.adoptNode(t),t},appendChild:function(t){if(this!=t||!O(t))return this.__shady_insertBefore(t)},removeChild:function(t,o){if(o=void 0!==o&&o,this.ownerDocument!==Lr)return this.__shady_native_removeChild(t);if(t.__shady_parentNode!==this)throw Error("The node to be removed is not a child of this node: "+t);Ie(this,null,t);var s=Je(t),l=s&&function Ne(t,o){if(t.g){ff(t);var s,l=t.h;for(s in l)for(var h=l[s],v=0;v<h.length;v++){var m=h[v];if(Rc(o,m)){h.splice(v,1);var _=t.g.indexOf(m);if(0<=_&&(t.g.splice(_,1),(_=L(m.__shady_parentNode))&&_.ka&&_.ka--),v--,_=(m=L(m)).aa)for(var R=0;R<_.length;R++){var $=_[R],B=$.__shady_native_parentNode;B&&B.__shady_native_removeChild($)}m.aa=[],m.assignedNodes=[],_=!0}}return _}}(s,t),h=L(this);if(Gc(this)&&(function Oe(t,o){var s=D(t);o=D(o),t===o.firstChild&&(o.firstChild=s.nextSibling),t===o.lastChild&&(o.lastChild=s.previousSibling),t=s.previousSibling;var l=s.nextSibling;t&&(D(t).nextSibling=l),l&&(D(l).previousSibling=t),s.parentNode=s.previousSibling=s.nextSibling=void 0,void 0!==o.childNodes&&(o.childNodes=null)}(t,this),Hc(this))){Le(h.root);var v=!0}if(ue()&&!o&&s&&t.nodeType!==Node.TEXT_NODE){var m=ye(t);Ae(t,(function(t){we(t,m)}))}return Ge(t),s&&((o="slot"===this.localName)&&(v=!0),(l||o)&&Le(s)),v||(v=O(this)?this.host:this,(!h.root&&"slot"!==t.localName||v===t.__shady_native_parentNode)&&v.__shady_native_removeChild(t)),t},replaceChild:function(t,o){return this.__shady_insertBefore(t,o),this.__shady_removeChild(o),t},cloneNode:function(t){if("template"==this.localName)return this.__shady_native_cloneNode(t);var o=this.__shady_native_cloneNode(!1);if(t&&o.nodeType!==Node.ATTRIBUTE_NODE){t=this.__shady_firstChild;for(var s;t;t=t.__shady_nextSibling)s=t.__shady_cloneNode(!0),o.__shady_appendChild(s)}return o},getRootNode:function(t){if(this&&this.nodeType){var o=D(this),s=o.ta;return void 0===s&&(O(this)?(s=this,o.ta=s):(s=(s=this.__shady_parentNode)?s.__shady_getRootNode(t):this,document.documentElement.__shady_native_contains(this)&&(o.ta=s))),s}},contains:function(t){return Rc(this,t)}}),qr=Q({get assignedSlot(){var t=this.__shady_parentNode;return(t=t&&t.__shady_shadowRoot)&&Qe(t),(t=L(this))&&t.assignedSlot||null}}),jr=new Map;function Te(t,o,s,l){for(l=void 0===l||l;o<t.length;o++)if("\\"===t[o]&&o<t.length-1&&"\n"!==t[o+1])o++;else{if(-1!==s.indexOf(t[o]))return o;if(l&&jr.has(t[o])){var h=jr.get(t[o]);o=Te(t,o+1,[h.end],h.sa)}}return t.length}function Ve(t,o,s){var l=[];return We(t,o,s,l),l}function We(t,o,s,l){for(t=t.__shady_firstChild;t;t=t.__shady_nextSibling){var h;if(h=t.nodeType===Node.ELEMENT_NODE){var v=o,m=s,_=l,R=v(h=t);R&&_.push(h),m&&m(R)?h=R:(We(h,v,m,_),h=void 0)}if(h)break}}[["(",{end:")",sa:!0}],["[",{end:"]",sa:!0}],['"',{end:'"',sa:!1}],["'",{end:"'",sa:!1}]].forEach((function(t){var o=ka(t);t=o.next().value,o=o.next().value,jr.set(t,o)}));var zr={get firstElementChild(){var t=L(this);if(t&&void 0!==t.firstChild){for(t=this.__shady_firstChild;t&&t.nodeType!==Node.ELEMENT_NODE;)t=t.__shady_nextSibling;return t}return this.__shady_native_firstElementChild},get lastElementChild(){var t=L(this);if(t&&void 0!==t.lastChild){for(t=this.__shady_lastChild;t&&t.nodeType!==Node.ELEMENT_NODE;)t=t.__shady_previousSibling;return t}return this.__shady_native_lastElementChild},get children(){return Gc(this)?Sc(Array.prototype.filter.call(Uc(this),(function(t){return t.nodeType===Node.ELEMENT_NODE}))):this.__shady_native_children},get childElementCount(){var t=this.__shady_children;return t?t.length:0}},Vr=Q((zr.append=function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];this.__shady_insertBefore(Zc.apply(null,w(o)),null)},zr.prepend=function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];this.__shady_insertBefore(Zc.apply(null,w(o)),this.__shady_firstChild)},zr.replaceChildren=function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];for(;null!==(s=this.__shady_firstChild);)this.__shady_removeChild(s);this.__shady_insertBefore(Zc.apply(null,w(o)),null)},zr));function Ze(t,o){function c(o,s){return(o===t||-1===s.indexOf(":scope"))&&Qt.call(o,s)}var s=function Ue(t){function b(){if(0<s.length){for(;" "===s[s.length-1];)s.pop();o.push({La:s.filter((function(t,o){return 0==o%2})),Za:s.filter((function(t,o){return 1==o%2}))}),s.length=0}}for(var o=[],s=[],l=0;l<t.length;){var h=s[s.length-1],v=Te(t,l,[","," ",">","+","~"]),m=v===l?t[l]:t.substring(l,v);","===m?b():-1!==[void 0," ",">","+","~"].indexOf(h)&&" "===m||(" "===h&&-1!==[">","+","~"].indexOf(m)?s[s.length-1]=m:s.push(m)),l=v+(v===l?1:0)}return b(),o}(o);if(1>s.length)return[];for(o=$c(Ve(t,(function(){return!0})).map((function(t){return $c(s.map((function(o){var s=o.La,l=s.length-1;return c(t,s[l])?{target:t,da:o,fa:t,index:l}:[]})))})));o.some((function(t){return 0<t.index}));)o=$c(o.map((function(t){if(0>=t.index)return t;var o=t.target,s=t.fa,l=t.da;t=t.index-1;var h=l.Za[t],v=l.La[t];if(" "===h){for(h=[],s=s.__shady_parentElement;s;s=s.__shady_parentElement)c(s,v)&&h.push({target:o,da:l,fa:s,index:t});return h}if(">"===h)return c(s=s.__shady_parentElement,v)?{target:o,da:l,fa:s,index:t}:[];if("+"===h)return(s=s.__shady_previousElementSibling)&&c(s,v)?{target:o,da:l,fa:s,index:t}:[];if("~"===h){for(h=[],s=s.__shady_previousElementSibling;s;s=s.__shady_previousElementSibling)c(s,v)&&h.push({target:o,da:l,fa:s,index:t});return h}throw Error("Unrecognized combinator: '"+h+"'.")})));return function ad(t){for(var o=[],s=new Set,l=(t=ka(t)).next();!l.done;l=t.next())l=l.value,s.has(l)||(o.push(l),s.add(l));return o}(o.map((function(t){return t.target})))}var Gr=zt.querySelectorImplementation,Kr=Q({querySelector:function(t){if("native"===Gr){for(var o=Array.prototype.slice.call((this instanceof ShadowRoot?this.host:this).__shady_native_querySelectorAll(t)),s=this.__shady_getRootNode(),l=(o=ka(o)).next();!l.done;l=o.next())if((l=l.value).__shady_getRootNode()==s)return l;return null}if("selectorEngine"===Gr)return Ze(this,t)[0]||null;if(void 0===Gr)return Ve(this,(function(o){return Qt.call(o,t)}),(function(t){return!!t}))[0]||null;throw Error("Unrecognized value of ShadyDOM.querySelectorImplementation: '"+Gr+"'")},querySelectorAll:function(t,o){if(o||"native"===Gr){o=Array.prototype.slice.call((this instanceof ShadowRoot?this.host:this).__shady_native_querySelectorAll(t));var s=this.__shady_getRootNode();return Sc(o.filter((function(t){return t.__shady_getRootNode()==s})))}if("selectorEngine"===Gr)return Sc(Ze(this,t));if(void 0===Gr)return Sc(Ve(this,(function(o){return Qt.call(o,t)})));throw Error("Unrecognized value of ShadyDOM.querySelectorImplementation: '"+Gr+"'")}}),Wr=zt.ha&&!zt.J?Xc({},Vr):Vr;Xc(Vr,Kr);var Qr=Q({after:function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];if(null!==(s=this.__shady_parentNode)){var l=this.__shady_nextSibling;s.__shady_insertBefore(Zc.apply(null,w(o)),l)}},before:function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];null!==(s=this.__shady_parentNode)&&s.__shady_insertBefore(Zc.apply(null,w(o)),this)},remove:function(){var t=this.__shady_parentNode;null!==t&&t.__shady_removeChild(this)},replaceWith:function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];if(null!==(s=this.__shady_parentNode)){var l=this.__shady_nextSibling;s.__shady_removeChild(this),s.__shady_insertBefore(Zc.apply(null,w(o)),l)}}}),Yr=window.document;function ef(t,o){if("slot"===o)Hc(t=t.__shady_parentNode)&&Le(L(t).root);else if("slot"===t.localName&&"name"===o&&(o=Je(t))){if(o.g){ff(o);var s=t.Ua,l=gf(t);if(l!==s){var h=(s=o.h[s]).indexOf(t);0<=h&&s.splice(h,1),(s=o.h[l]||(o.h[l]=[])).push(t),1<s.length&&(o.h[l]=hf(s))}}Le(o)}}var Jr=Q({get previousElementSibling(){var t=L(this);if(t&&void 0!==t.previousSibling){for(t=this.__shady_previousSibling;t&&t.nodeType!==Node.ELEMENT_NODE;)t=t.__shady_previousSibling;return t}return this.__shady_native_previousElementSibling},get nextElementSibling(){var t=L(this);if(t&&void 0!==t.nextSibling){for(t=this.__shady_nextSibling;t&&t.nodeType!==Node.ELEMENT_NODE;)t=t.__shady_nextSibling;return t}return this.__shady_native_nextElementSibling},get slot(){return this.getAttribute("slot")},set slot(t){this.__shady_setAttribute("slot",t)},get className(){return this.getAttribute("class")||""},set className(t){this.__shady_setAttribute("class",t)},setAttribute:function(t,o){this.ownerDocument!==Yr?this.__shady_native_setAttribute(t,o):ve(this,t,o)||(this.__shady_native_setAttribute(t,o),ef(this,t))},removeAttribute:function(t){this.ownerDocument!==Yr?this.__shady_native_removeAttribute(t):ve(this,t,"")?""===this.getAttribute(t)&&this.__shady_native_removeAttribute(t):(this.__shady_native_removeAttribute(t),ef(this,t))}});zt.ha||$r.forEach((function(t){Jr[t]=oe(t)}));var Xr=Q({attachShadow:function(t){if(!this)throw Error("Must provide a host.");if(!t)throw Error("Not enough arguments.");if(t.shadyUpgradeFragment&&!zt.Ra){var o=t.shadyUpgradeFragment;if(o.__proto__=ShadowRoot.prototype,kf(o,this,t),lf(o,o),t=o.__noInsertionPoint?null:o.querySelectorAll("slot"),o.__noInsertionPoint=void 0,t&&t.length){var s=o;Ke(s),s.i.push.apply(s.i,w(t)),Le(o)}o.host.__shady_native_appendChild(o)}else o=new mf(mo,this,t);return this.__CE_shadowRoot=o},get shadowRoot(){var t=L(this);return t&&t.lb||null}});Xc(Jr,Xr);var Zr=document.implementation.createHTMLDocument("inert"),eo=Q({get innerHTML(){return Gc(this)?qd("template"===this.localName?this.content:this,Uc):this.__shady_native_innerHTML},set innerHTML(t){if("template"===this.localName)this.__shady_native_innerHTML=t;else{Fe(this);var o=this.localName||"div";for(o=this.namespaceURI&&this.namespaceURI!==Zr.namespaceURI?Zr.createElementNS(this.namespaceURI,o):Zr.createElement(o),zt.D?o.__shady_native_innerHTML=t:o.innerHTML=t;t=o.__shady_firstChild;)this.__shady_insertBefore(t)}}}),to=Q({blur:function(){var t=L(this);(t=(t=t&&t.root)&&t.activeElement)?t.__shady_blur():this.__shady_native_blur()}});zt.ha||Nr.forEach((function(t){to[t]=oe(t)}));var ro=Q({assignedNodes:function(t){if("slot"===this.localName){var o=this.__shady_getRootNode();return o&&O(o)&&Qe(o),(o=L(this))&&(t&&t.flatten?o.aa:o.assignedNodes)||[]}},addEventListener:function(t,o,s){if("slot"!==this.localName||"slotchange"===t)ee.call(this,t,o,s);else{"object"!=typeof s&&(s={capture:!!s});var l=this.__shady_parentNode;if(!l)throw Error("ShadyDOM cannot attach event to slot unless it has a `parentNode`");s.U=this,l.__shady_addEventListener(t,o,s)}},removeEventListener:function(t,o,s){if("slot"!==this.localName||"slotchange"===t)fe.call(this,t,o,s);else{"object"!=typeof s&&(s={capture:!!s});var l=this.__shady_parentNode;if(!l)throw Error("ShadyDOM cannot attach event to slot unless it has a `parentNode`");s.U=this,l.__shady_removeEventListener(t,o,s)}}}),oo=Q({getElementById:function(t){return""===t?null:Ve(this,(function(o){return o.id==t}),(function(t){return!!t}))[0]||null}});function uf(t,o){for(var s;o&&!t.has(s=o.__shady_getRootNode());)o=s.host;return o}var no="__shady_native_"+Fc(),io=Q({get activeElement(){var t=zt.D?document.__shady_native_activeElement:document.activeElement;if(!t||!t.nodeType)return null;var o=!!O(this);if(!(this===document||o&&this.host!==t&&this.host.__shady_native_contains(t)))return null;for(o=Je(t);o&&o!==this;)o=Je(t=o.host);return this===document?o?null:t:o===this?t:null},elementsFromPoint:function(t,o){if(t=document[no](t,o),this===document&&zt.useNativeDocumentEFP)return t;t=[].slice.call(t),o=function vf(t){var o=new Set;for(o.add(t);O(t)&&t.host;)t=t.host.__shady_getRootNode(),o.add(t);return o}(this);for(var s=new Set,l=0;l<t.length;l++)s.add(uf(o,t[l]));var h=[];return s.forEach((function(t){return h.push(t)})),h},elementFromPoint:function(t,o){return this===document&&zt.useNativeDocumentEFP?this.__shady_native_elementFromPoint(t,o):this.__shady_elementsFromPoint(t,o)[0]||null}}),so=window.document,ao=Q({importNode:function(t,o){if(t.ownerDocument!==so||"template"===t.localName)return this.__shady_native_importNode(t,o);var s=this.__shady_native_importNode(t,!1);if(o)for(t=t.__shady_firstChild;t;t=t.__shady_nextSibling)o=this.__shady_importNode(t,!0),s.__shady_appendChild(o);return s}}),lo=Q({dispatchEvent:ce,addEventListener:ee.bind(window),removeEventListener:fe.bind(window)}),co={};Object.getOwnPropertyDescriptor(HTMLElement.prototype,"parentElement")&&(co.parentElement=Br.parentElement),Object.getOwnPropertyDescriptor(HTMLElement.prototype,"contains")&&(co.contains=Br.contains),Object.getOwnPropertyDescriptor(HTMLElement.prototype,"children")&&(co.children=Vr.children),Object.getOwnPropertyDescriptor(HTMLElement.prototype,"innerHTML")&&(co.innerHTML=eo.innerHTML),Object.getOwnPropertyDescriptor(HTMLElement.prototype,"className")&&(co.className=Jr.className);var uo={EventTarget:[Mr],Node:[Br,window.EventTarget?null:Mr],Text:[qr],Comment:[qr],CDATASection:[qr],ProcessingInstruction:[qr],Element:[Jr,Vr,Qr,qr,!zt.D||"innerHTML"in Element.prototype?eo:null,window.HTMLSlotElement?null:ro],HTMLElement:[to,co],HTMLSlotElement:[ro],DocumentFragment:[Wr,oo],Document:[ao,Wr,oo,io],Window:[lo],CharacterData:[Qr],XMLHttpRequest:[window.EventTarget?null:Mr]},ho=zt.D?null:["innerHTML","textContent"];function Ef(t,o,s,l){o.forEach((function(o){return t&&o&&P(t,o,s,l)}))}function Ff(t){var o,s=t?null:ho;for(o in uo)Ef(window[o]&&window[o].prototype,uo[o],t,s)}function Gf(t){return t.__shady_protoIsPatched=!0,Ef(t,uo.EventTarget),Ef(t,uo.Node),Ef(t,uo.Element),Ef(t,uo.HTMLElement),Ef(t,uo.HTMLSlotElement),t}["Text","Comment","CDATASection","ProcessingInstruction"].forEach((function(t){var o=window[t],s=Object.create(o.prototype);s.__shady_protoIsPatched=!0,Ef(s,uo.EventTarget),Ef(s,uo.Node),uo[t]&&Ef(s,uo[t]),o.prototype.__shady_patchedProto=s}));var po=zt.Da,fo=zt.D;function Jf(t,o){if(po&&!t.__shady_protoIsPatched&&!O(t)){var s=Object.getPrototypeOf(t),l=s.hasOwnProperty("__shady_patchedProto")&&s.__shady_patchedProto;l||(Gf(l=Object.create(s)),s.__shady_patchedProto=l),Object.setPrototypeOf(t,l)}fo||(1===o?br(t):2===o&&yr(t))}function Kf(t,o,s,l){Jf(t,1),l=l||null;var h=D(t),v=l?D(l):null;h.previousSibling=l?v.previousSibling:o.__shady_lastChild,(v=L(h.previousSibling))&&(v.nextSibling=t),(v=L(h.nextSibling=l))&&(v.previousSibling=t),h.parentNode=o,l?l===s.firstChild&&(s.firstChild=t):(s.lastChild=t,s.firstChild||(s.firstChild=t)),s.childNodes=null}function lf(t,o){var s=D(t);if(o||void 0===s.firstChild){s.childNodes=null;var l=s.firstChild=t.__shady_native_firstChild;for(s.lastChild=t.__shady_native_lastChild,Jf(t,2),s=l,l=void 0;s;s=s.__shady_native_nextSibling){var h=D(s);h.parentNode=o||t,h.nextSibling=s.__shady_native_nextSibling,h.previousSibling=l||null,l=s,Jf(s,1)}}}var go=Q({addEventListener:function(t,o,s){"object"!=typeof s&&(s={capture:!!s}),s.U=s.U||this,this.host.__shady_addEventListener(t,o,s)},removeEventListener:function(t,o,s){"object"!=typeof s&&(s={capture:!!s}),s.U=s.U||this,this.host.__shady_removeEventListener(t,o,s)}});function Mf(t,o){P(t,go,o),P(t,io,o),P(t,eo,o),P(t,Vr,o),zt.J&&!o?(P(t,Br,o),P(t,oo,o)):zt.D||(P(t,vr),P(t,fr),P(t,gr))}var vo,mo={},bo=zt.deferConnectionCallbacks&&"loading"===document.readyState;function Pf(t){var o=[];do{o.unshift(t)}while(t=t.__shady_parentNode);return o}function mf(t,o,s){if(t!==mo)throw new TypeError("Illegal constructor");this.g=null,kf(this,o,s)}function kf(t,o,s){if(t.host=o,t.mode=s&&s.mode,lf(t.host),(o=D(t.host)).root=t,o.lb="closed"!==t.mode?t:null,(o=D(t)).firstChild=o.lastChild=o.parentNode=o.nextSibling=o.previousSibling=null,zt.preferPerformance)for(;o=t.host.__shady_native_firstChild;)t.host.__shady_native_removeChild(o);else Le(t)}function Le(t){t.Y||(t.Y=!0,dd((function(){return Qe(t)})))}function Qe(t){var o;if(o=t.Y){for(var s;t;)t.Y&&(s=t),O(t=(o=t).host.__shady_getRootNode())&&(o=L(o.host))&&0<o.ka||(t=void 0);o=s}(s=o)&&s._renderSelf()}function Qf(t,o,s){var l=D(o),h=l.xa;l.xa=null,s||(s=(t=t.h[o.__shady_slot||"__catchall"])&&t[0]),s?(D(s).assignedNodes.push(o),l.assignedSlot=s):l.assignedSlot=void 0,h!==l.assignedSlot&&l.assignedSlot&&(D(l.assignedSlot).Aa=!0)}function Rf(t,o,s){for(var l=0,h=void 0;l<s.length&&(h=s[l]);l++)if("slot"==h.localName){var v=L(h).assignedNodes;v&&v.length&&Rf(t,o,v)}else o.push(s[l])}function Sf(t,o){o.__shady_native_dispatchEvent(new Event("slotchange")),(o=L(o)).assignedSlot&&Sf(t,o.assignedSlot)}function Ke(t){t.i=t.i||[],t.g=t.g||[],t.h=t.h||{}}function ff(t){if(t.i&&t.i.length){for(var o,s=t.i,l=0;l<s.length;l++){var h=s[l];lf(h);var v=h.__shady_parentNode;lf(v),(v=L(v)).ka=(v.ka||0)+1,v=gf(h),t.h[v]?((o=o||{})[v]=!0,t.h[v].push(h)):t.h[v]=[h],t.g.push(h)}if(o)for(var m in o)t.h[m]=hf(t.h[m]);t.i=[]}}function gf(t){var o=t.name||t.getAttribute("name")||"__catchall";return t.Ua=o}function hf(t){return t.sort((function(t,o){t=Pf(t);for(var s=Pf(o),l=0;l<t.length;l++){o=t[l];var h=s[l];if(o!==h)return(t=Uc(o.__shady_parentNode)).indexOf(o)-t.indexOf(h)}}))}function Ic(t){return ff(t),!(!t.g||!t.g.length)}if(mf.prototype._renderSelf=function(){var t=bo;if(bo=!0,this.Y=!1,this.g){ff(this);for(var o,s=0;s<this.g.length;s++){var l=L(o=this.g[s]),h=l.assignedNodes;if(l.assignedNodes=[],l.aa=[],l.Ja=h)for(l=0;l<h.length;l++){var v=L(h[l]);v.xa=v.assignedSlot,v.assignedSlot===o&&(v.assignedSlot=null)}}for(s=this.host.__shady_firstChild;s;s=s.__shady_nextSibling)Qf(this,s);for(s=0;s<this.g.length;s++){if(!(h=L(o=this.g[s])).assignedNodes.length)for(l=o.__shady_firstChild;l;l=l.__shady_nextSibling)Qf(this,l,o);if((l=(l=L(o.__shady_parentNode))&&l.root)&&(Ic(l)||l.Y)&&l._renderSelf(),Rf(this,h.aa,h.assignedNodes),l=h.Ja){for(v=0;v<l.length;v++)L(l[v]).xa=null;h.Ja=null,l.length>h.assignedNodes.length&&(h.Aa=!0)}h.Aa&&(h.Aa=!1,Sf(this,o))}for(o=this.g,s=[],h=0;h<o.length;h++)(v=L(l=o[h].__shady_parentNode))&&v.root||!(0>s.indexOf(l))||s.push(l);for(o=0;o<s.length;o++){for(h=(v=s[o])===this?this.host:v,l=[],v=v.__shady_firstChild;v;v=v.__shady_nextSibling)if("slot"==v.localName)for(var m=L(v).aa,_=0;_<m.length;_++)l.push(m[_]);else l.push(v);v=Tc(h),m=qe(l,l.length,v,v.length);for(var R=_=0,$=void 0;_<m.length&&($=m[_]);_++){for(var B=0,q=void 0;B<$.ia.length&&(q=$.ia[B]);B++)q.__shady_native_parentNode===h&&h.__shady_native_removeChild(q),v.splice($.index+R,1);R-=$.pa}for(R=0,$=void 0;R<m.length&&($=m[R]);R++)for(_=v[$.index],B=$.index;B<$.index+$.pa;B++)q=l[B],h.__shady_native_insertBefore(q,_),v.splice(B,0,q)}}if(!zt.preferPerformance&&!this.Ia)for(s=this.host.__shady_firstChild;s;s=s.__shady_nextSibling)o=L(s),s.__shady_native_parentNode!==this.host||"slot"!==s.localName&&o.assignedSlot||this.host.__shady_native_removeChild(s);this.Ia=!0,bo=t,vo&&vo()},function(t){t.__proto__=DocumentFragment.prototype,Mf(t,"__shady_"),Mf(t),Object.defineProperties(t,{nodeType:{value:Node.DOCUMENT_FRAGMENT_NODE,configurable:!0},nodeName:{value:"#document-fragment",configurable:!0},nodeValue:{value:null,configurable:!0}}),["localName","namespaceURI","prefix"].forEach((function(o){Object.defineProperty(t,o,{value:void 0,configurable:!0})})),["ownerDocument","baseURI","isConnected"].forEach((function(o){Object.defineProperty(t,o,{get:function(){return this.host[o]},configurable:!0})}))}(mf.prototype),window.customElements&&window.customElements.define&&zt.Ba&&!zt.preferPerformance){var yo=new Map;vo=function(){var t=[];yo.forEach((function(o,s){t.push([s,o])})),yo.clear();for(var o=0;o<t.length;o++){var s=t[o][0];t[o][1]?s.__shadydom_connectedCallback():s.__shadydom_disconnectedCallback()}},bo&&document.addEventListener("readystatechange",(function(){bo=!1,vo()}),{once:!0});var wo=window.customElements.define,Wf=function(t,o){var s=o.prototype.connectedCallback,l=o.prototype.disconnectedCallback;wo.call(window.customElements,t,function(t,o,s){var l=0,h="__isConnected"+l++;return(o||s)&&(t.prototype.connectedCallback=t.prototype.__shadydom_connectedCallback=function(){bo?yo.set(this,!0):this[h]||(this[h]=!0,o&&o.call(this))},t.prototype.disconnectedCallback=t.prototype.__shadydom_disconnectedCallback=function(){bo?this.isConnected||yo.set(this,!1):this[h]&&(this[h]=!1,s&&s.call(this))}),t}(o,s,l)),o.prototype.connectedCallback=s,o.prototype.disconnectedCallback=l};window.customElements.define=Wf,Object.defineProperty(window.CustomElementRegistry.prototype,"define",{value:Wf,configurable:!0})}function Je(t){if(O(t=t.__shady_getRootNode()))return t}function Xf(t){this.node=t}function Yf(t){Object.defineProperty(Xf.prototype,t,{get:function(){return this.node["__shady_"+t]},set:function(o){this.node["__shady_"+t]=o},configurable:!0})}(o=Xf.prototype).addEventListener=function(t,o,s){return this.node.__shady_addEventListener(t,o,s)},o.removeEventListener=function(t,o,s){return this.node.__shady_removeEventListener(t,o,s)},o.appendChild=function(t){return this.node.__shady_appendChild(t)},o.insertBefore=function(t,o){return this.node.__shady_insertBefore(t,o)},o.removeChild=function(t){return this.node.__shady_removeChild(t)},o.replaceChild=function(t,o){return this.node.__shady_replaceChild(t,o)},o.cloneNode=function(t){return this.node.__shady_cloneNode(t)},o.getRootNode=function(t){return this.node.__shady_getRootNode(t)},o.contains=function(t){return this.node.__shady_contains(t)},o.dispatchEvent=function(t){return this.node.__shady_dispatchEvent(t)},o.setAttribute=function(t,o){this.node.__shady_setAttribute(t,o)},o.getAttribute=function(t){return this.node.__shady_native_getAttribute(t)},o.hasAttribute=function(t){return this.node.__shady_native_hasAttribute(t)},o.removeAttribute=function(t){this.node.__shady_removeAttribute(t)},o.attachShadow=function(t){return this.node.__shady_attachShadow(t)},o.focus=function(){this.node.__shady_native_focus()},o.blur=function(){this.node.__shady_blur()},o.importNode=function(t,o){if(this.node.nodeType===Node.DOCUMENT_NODE)return this.node.__shady_importNode(t,o)},o.getElementById=function(t){if(this.node.nodeType===Node.DOCUMENT_NODE)return this.node.__shady_getElementById(t)},o.elementsFromPoint=function(t,o){return this.node.__shady_elementsFromPoint(t,o)},o.elementFromPoint=function(t,o){return this.node.__shady_elementFromPoint(t,o)},o.querySelector=function(t){return this.node.__shady_querySelector(t)},o.querySelectorAll=function(t,o){return this.node.__shady_querySelectorAll(t,o)},o.assignedNodes=function(t){if("slot"===this.node.localName)return this.node.__shady_assignedNodes(t)},o.append=function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];return this.node.__shady_append.apply(this.node,w(o))},o.prepend=function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];return this.node.__shady_prepend.apply(this.node,w(o))},o.after=function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];return this.node.__shady_after.apply(this.node,w(o))},o.before=function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];return this.node.__shady_before.apply(this.node,w(o))},o.remove=function(){return this.node.__shady_remove()},o.replaceWith=function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];return this.node.__shady_replaceWith.apply(this.node,w(o))},h.Object.defineProperties(Xf.prototype,{activeElement:{configurable:!0,enumerable:!0,get:function(){if(O(this.node)||this.node.nodeType===Node.DOCUMENT_NODE)return this.node.__shady_activeElement}},_activeElement:{configurable:!0,enumerable:!0,get:function(){return this.activeElement}},host:{configurable:!0,enumerable:!0,get:function(){if(O(this.node))return this.node.host}},parentNode:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_parentNode}},firstChild:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_firstChild}},lastChild:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_lastChild}},nextSibling:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_nextSibling}},previousSibling:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_previousSibling}},childNodes:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_childNodes}},parentElement:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_parentElement}},firstElementChild:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_firstElementChild}},lastElementChild:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_lastElementChild}},nextElementSibling:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_nextElementSibling}},previousElementSibling:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_previousElementSibling}},children:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_children}},childElementCount:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_childElementCount}},shadowRoot:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_shadowRoot}},assignedSlot:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_assignedSlot}},isConnected:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_isConnected}},innerHTML:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_innerHTML},set:function(t){this.node.__shady_innerHTML=t}},textContent:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_textContent},set:function(t){this.node.__shady_textContent=t}},slot:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_slot},set:function(t){this.node.__shady_slot=t}},className:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_className},set:function(t){this.node.__shady_className=t}}}),$r.forEach((function(t){return Yf(t)})),Nr.forEach((function(t){return Yf(t)}));var _o=new WeakMap;function $f(t){if(O(t)||t instanceof Xf)return t;var o=_o.get(t);return o||(o=new Xf(t),_o.set(t,o)),o}if(zt.Ba){var Co=zt.D?function(t){return t}:function(t){return yr(t),br(t),t},ko={inUse:zt.Ba,patch:Co,isShadyRoot:O,enqueue:dd,flush:ed,flushInitial:function(t){!t.Ia&&t.Y&&Qe(t)},settings:zt,filterMutations:function jd(t,o){var s=o.getRootNode();return t.map((function(t){var o=s===t.target.getRootNode();if(o&&t.addedNodes){if(o=[].slice.call(t.addedNodes).filter((function(t){return s===t.getRootNode()})),o.length)return t=Object.create(t),Object.defineProperty(t,"addedNodes",{value:o,configurable:!0}),t}else if(o)return t})).filter((function(t){return t}))},observeChildren:function hd(t,o){var s=D(t);s.ga||(s.ga=new fd),s.ga.qa.add(o);var l=s.ga;return{Va:o,X:l,Wa:t,takeRecords:function(){return l.takeRecords()}}},unobserveChildren:function id(t){var o=t&&t.X;o&&(o.qa.delete(t.Va),o.qa.size||(D(t.Wa).ga=null))},deferConnectionCallbacks:zt.deferConnectionCallbacks,preferPerformance:zt.preferPerformance,handlesDynamicScoping:!0,wrap:zt.J?$f:Co,wrapIfNeeded:!0===zt.J?$f:function(t){return t},Wrapper:Xf,composedPath:function Sd(t){return t.__composedPath||(t.__composedPath=Rd(t.target,!0)),t.__composedPath},noPatch:zt.J,patchOnDemand:zt.Da,nativeMethods:ar,nativeTree:lr,patchElementProto:Gf,querySelectorImplementation:zt.querySelectorImplementation};window.ShadyDOM=ko,function Cd(){var t=["dispatchEvent","addEventListener","removeEventListener"];window.EventTarget?(S(window.EventTarget.prototype,t),void 0===window.__shady_native_addEventListener&&S(Window.prototype,t)):(S(Node.prototype,t),S(Window.prototype,t),S(XMLHttpRequest.prototype,t)),sr?S(Node.prototype,"parentNode firstChild lastChild previousSibling nextSibling childNodes parentElement textContent".split(" ")):vd(Node.prototype,{parentNode:{get:function(){return cr.currentNode=this,cr.parentNode()}},firstChild:{get:function(){return cr.currentNode=this,cr.firstChild()}},lastChild:{get:function(){return cr.currentNode=this,cr.lastChild()}},previousSibling:{get:function(){return cr.currentNode=this,cr.previousSibling()}},nextSibling:{get:function(){return cr.currentNode=this,cr.nextSibling()}},childNodes:{get:function(){var t=[];cr.currentNode=this;for(var o=cr.firstChild();o;)t.push(o),o=cr.nextSibling();return t}},parentElement:{get:function(){return dr.currentNode=this,dr.parentNode()}},textContent:{get:function(){switch(this.nodeType){case Node.ELEMENT_NODE:case Node.DOCUMENT_FRAGMENT_NODE:for(var t,o=document.createTreeWalker(this,NodeFilter.SHOW_TEXT,null,!1),s="";t=o.nextNode();)s+=t.nodeValue;return s;default:return this.nodeValue}},set:function(t){switch(null==t&&(t=""),this.nodeType){case Node.ELEMENT_NODE:case Node.DOCUMENT_FRAGMENT_NODE:zd(this),(0<t.length||this.nodeType===Node.ELEMENT_NODE)&&this.__shady_native_insertBefore(document.createTextNode(t),void 0);break;default:this.nodeValue=t}}}}),S(Node.prototype,"appendChild insertBefore removeChild replaceChild cloneNode contains".split(" ")),S(HTMLElement.prototype,["parentElement","contains"]),t={firstElementChild:{get:function(){return dr.currentNode=this,dr.firstChild()}},lastElementChild:{get:function(){return dr.currentNode=this,dr.lastChild()}},children:{get:function(){var t=[];dr.currentNode=this;for(var o=dr.firstChild();o;)t.push(o),o=dr.nextSibling();return Sc(t)}},childElementCount:{get:function(){return this.children?this.children.length:0}}},sr?(S(Element.prototype,hr),S(Element.prototype,["previousElementSibling","nextElementSibling","innerHTML","className"]),S(HTMLElement.prototype,["children","innerHTML","className"])):(vd(Element.prototype,t),vd(Element.prototype,{previousElementSibling:{get:function(){return dr.currentNode=this,dr.previousSibling()}},nextElementSibling:{get:function(){return dr.currentNode=this,dr.nextSibling()}},innerHTML:{get:function(){return qd(this,Tc)},set:function(t){var o="template"===this.localName?this.content:this;zd(o);var s=this.localName||"div";for((s=this.namespaceURI&&this.namespaceURI!==ur.namespaceURI?ur.createElementNS(this.namespaceURI,s):ur.createElement(s)).innerHTML=t,t="template"===this.localName?s.content:s;s=t.__shady_native_firstChild;)o.__shady_native_insertBefore(s,void 0)}},className:{get:function(){return this.getAttribute("class")||""},set:function(t){this.setAttribute("class",t)}}})),S(Element.prototype,"setAttribute getAttribute hasAttribute removeAttribute focus blur".split(" ")),S(Element.prototype,pr),S(HTMLElement.prototype,["focus","blur"]),window.HTMLTemplateElement&&S(window.HTMLTemplateElement.prototype,["innerHTML"]),sr?S(DocumentFragment.prototype,hr):vd(DocumentFragment.prototype,t),S(DocumentFragment.prototype,pr),sr?(S(Document.prototype,hr),S(Document.prototype,["activeElement"])):vd(Document.prototype,t),S(Document.prototype,["importNode","getElementById","elementFromPoint",Fc()]),S(Document.prototype,pr)}(),Ff("__shady_"),Object.defineProperty(document,"_activeElement",io.activeElement),P(Window.prototype,lo,"__shady_"),zt.J?zt.Da&&P(Element.prototype,Xr):(Ff(),function le(){if(!_r&&Object.getOwnPropertyDescriptor(Event.prototype,"isTrusted")){var a=function(){var t=new MouseEvent("click",{bubbles:!0,cancelable:!0,composed:!0});this.__shady_dispatchEvent(t)};Element.prototype.click?Element.prototype.click=a:HTMLElement.prototype.click&&(HTMLElement.prototype.click=a)}}()),function ge(){for(var t in Er)window.__shady_native_addEventListener(t,(function(t){t.__target||(de(t),ae(t))}),!0)}(),window.Event=Pr,window.CustomEvent=Rr,window.MouseEvent=Or,window.ShadowRoot=mf}var To=window.Document.prototype.createElement,So=window.Document.prototype.createElementNS,xo=window.Document.prototype.importNode,Eo=window.Document.prototype.prepend,Io=window.Document.prototype.append,Ao=window.DocumentFragment.prototype.prepend,Po=window.DocumentFragment.prototype.append,Ro=window.Node.prototype.cloneNode,Oo=window.Node.prototype.appendChild,$o=window.Node.prototype.insertBefore,No=window.Node.prototype.removeChild,Mo=window.Node.prototype.replaceChild,Do=Object.getOwnPropertyDescriptor(window.Node.prototype,"textContent"),Lo=window.Element.prototype.attachShadow,Fo=Object.getOwnPropertyDescriptor(window.Element.prototype,"innerHTML"),Uo=window.Element.prototype.getAttribute,Ho=window.Element.prototype.setAttribute,Bo=window.Element.prototype.removeAttribute,qo=window.Element.prototype.getAttributeNS,jo=window.Element.prototype.setAttributeNS,zo=window.Element.prototype.removeAttributeNS,Vo=window.Element.prototype.insertAdjacentElement,Go=window.Element.prototype.insertAdjacentHTML,Ko=window.Element.prototype.prepend,Wo=window.Element.prototype.append,Qo=window.Element.prototype.before,Yo=window.Element.prototype.after,Jo=window.Element.prototype.replaceWith,Xo=window.Element.prototype.remove,Zo=window.HTMLElement,en=Object.getOwnPropertyDescriptor(window.HTMLElement.prototype,"innerHTML"),tn=window.HTMLElement.prototype.insertAdjacentElement,rn=window.HTMLElement.prototype.insertAdjacentHTML,on=new Set;function Jg(t){var o=on.has(t);return t=/^[a-z][.0-9_a-z]*-[-.0-9_a-z]*$/.test(t),!o&&t}"annotation-xml color-profile font-face font-face-src font-face-uri font-face-format font-face-name missing-glyph".split(" ").forEach((function(t){return on.add(t)}));var nn=document.contains?document.contains.bind(document):document.documentElement.contains.bind(document.documentElement);function T(t){var o=t.isConnected;if(void 0!==o)return o;if(nn(t))return!0;for(;t&&!(t.__CE_isImportDocument||t instanceof Document);)t=t.parentNode||(window.ShadowRoot&&t instanceof ShadowRoot?t.host:void 0);return!(!t||!(t.__CE_isImportDocument||t instanceof Document))}function Lg(t){var o=t.children;if(o)return Array.prototype.slice.call(o);for(o=[],t=t.firstChild;t;t=t.nextSibling)t.nodeType===Node.ELEMENT_NODE&&o.push(t);return o}function Mg(t,o){for(;o&&o!==t&&!o.nextSibling;)o=o.parentNode;return o&&o!==t?o.nextSibling:null}function Ng(t,o,s){for(var l=t;l;){if(l.nodeType===Node.ELEMENT_NODE){var h=l;o(h);var v=h.localName;if("link"===v&&"import"===h.getAttribute("rel")){if(l=h.import,void 0===s&&(s=new Set),l instanceof Node&&!s.has(l))for(s.add(l),l=l.firstChild;l;l=l.nextSibling)Ng(l,o,s);l=Mg(t,h);continue}if("template"===v){l=Mg(t,h);continue}if(h=h.__CE_shadowRoot)for(h=h.firstChild;h;h=h.nextSibling)Ng(h,o,s)}l=l.firstChild?l.firstChild:Mg(t,l)}}function Og(){var t=!(null==an||!an.noDocumentConstructionObserver),o=!(null==an||!an.shadyDomFastWalk);this.ca=[],this.g=[],this.W=!1,this.shadyDomFastWalk=o,this.sb=!t}function Qg(t,o,s,l){var h=window.ShadyDOM;if(t.shadyDomFastWalk&&h&&h.inUse){if(o.nodeType===Node.ELEMENT_NODE&&s(o),o.querySelectorAll)for(t=h.nativeMethods.querySelectorAll.call(o,"*"),o=0;o<t.length;o++)s(t[o])}else Ng(o,s,l)}function Tg(t,o){t.W&&Qg(t,o,(function(o){return Ug(t,o)}))}function Ug(t,o){if(t.W&&!o.__CE_patched){o.__CE_patched=!0;for(var s=0;s<t.ca.length;s++)t.ca[s](o);for(s=0;s<t.g.length;s++)t.g[s](o)}}function Vg(t,o){var s=[];for(Qg(t,o,(function(t){return s.push(t)})),o=0;o<s.length;o++){var l=s[o];1===l.__CE_state?t.connectedCallback(l):Wg(t,l)}}function Xg(t,o){var s=[];for(Qg(t,o,(function(t){return s.push(t)})),o=0;o<s.length;o++){var l=s[o];1===l.__CE_state&&t.disconnectedCallback(l)}}function Yg(t,o,s){var l=(s=void 0===s?{}:s).tb,h=s.upgrade||function(o){return Wg(t,o)},v=[];for(Qg(t,o,(function(o){if(t.W&&Ug(t,o),"link"===o.localName&&"import"===o.getAttribute("rel")){var s=o.import;s instanceof Node&&(s.__CE_isImportDocument=!0,s.__CE_registry=document.__CE_registry),s&&"complete"===s.readyState?s.__CE_documentLoadHandled=!0:o.addEventListener("load",(function(){var s=o.import;if(!s.__CE_documentLoadHandled){s.__CE_documentLoadHandled=!0;var v=new Set;l&&(l.forEach((function(t){return v.add(t)})),v.delete(s)),Yg(t,s,{tb:v,upgrade:h})}}))}else v.push(o)}),l),o=0;o<v.length;o++)h(v[o])}function Wg(t,o){try{var s=o.ownerDocument,l=s.__CE_registry,h=l&&(s.defaultView||s.__CE_isImportDocument)?Zg(l,o.localName):void 0;if(h&&void 0===o.__CE_state){h.constructionStack.push(o);try{try{if(new h.constructorFunction!==o)throw Error("The custom element constructor did not produce the element being upgraded.")}finally{h.constructionStack.pop()}}catch(t){throw o.__CE_state=2,t}if(o.__CE_state=1,o.__CE_definition=h,h.attributeChangedCallback&&o.hasAttributes()){var v=h.observedAttributes;for(h=0;h<v.length;h++){var m=v[h],_=o.getAttribute(m);null!==_&&t.attributeChangedCallback(o,m,null,_,null)}}T(o)&&t.connectedCallback(o)}}catch(t){$g(t)}}function ah(t,o,s,l){var h=o.__CE_registry;if(h&&(null===l||"http://www.w3.org/1999/xhtml"===l)&&(h=Zg(h,s)))try{var v=new h.constructorFunction;if(void 0===v.__CE_state||void 0===v.__CE_definition)throw Error("Failed to construct '"+s+"': The returned value was not constructed with the HTMLElement constructor.");if("http://www.w3.org/1999/xhtml"!==v.namespaceURI)throw Error("Failed to construct '"+s+"': The constructed element's namespace must be the HTML namespace.");if(v.hasAttributes())throw Error("Failed to construct '"+s+"': The constructed element must not have any attributes.");if(null!==v.firstChild)throw Error("Failed to construct '"+s+"': The constructed element must not have any children.");if(null!==v.parentNode)throw Error("Failed to construct '"+s+"': The constructed element must not have a parent node.");if(v.ownerDocument!==o)throw Error("Failed to construct '"+s+"': The constructed element's owner document is incorrect.");if(v.localName!==s)throw Error("Failed to construct '"+s+"': The constructed element's local name is incorrect.");return v}catch(h){return $g(h),o=null===l?To.call(o,s):So.call(o,l,s),Object.setPrototypeOf(o,HTMLUnknownElement.prototype),o.__CE_state=2,o.__CE_definition=void 0,Ug(t,o),o}return Ug(t,o=null===l?To.call(o,s):So.call(o,l,s)),o}function $g(t){var o="",s="",l=0,h=0;t instanceof Error?(o=t.message,s=t.sourceURL||t.fileName||"",l=t.line||t.lineNumber||0,h=t.column||t.columnNumber||0):o="Uncaught "+String(t);var v=void 0;void 0===ErrorEvent.prototype.initErrorEvent?v=new ErrorEvent("error",{cancelable:!0,message:o,filename:s,lineno:l,colno:h,error:t}):((v=document.createEvent("ErrorEvent")).initErrorEvent("error",!1,!0,o,s,l),v.preventDefault=function(){Object.defineProperty(this,"defaultPrevented",{configurable:!0,get:function(){return!0}})}),void 0===v.error&&Object.defineProperty(v,"error",{configurable:!0,enumerable:!0,get:function(){return t}}),window.dispatchEvent(v),v.defaultPrevented||console.error(t)}function bh(){var t=this;this.I=void 0,this.Ka=new Promise((function(o){t.g=o}))}function ch(t){var o=document;this.X=void 0,this.S=t,this.g=o,Yg(this.S,this.g),"loading"===this.g.readyState&&(this.X=new MutationObserver(this.h.bind(this)),this.X.observe(this.g,{childList:!0,subtree:!0}))}function dh(t){t.X&&t.X.disconnect()}function U(t){this.ma=new Map,this.na=new Map,this.Fa=new Map,this.wa=!1,this.za=new Map,this.la=function(t){return t()},this.V=!1,this.oa=[],this.S=t,this.Ga=t.sb?new ch(t):void 0}function eh(t,o){if(!Jg(o))throw new SyntaxError("The element name '"+o+"' is not valid.");if(Zg(t,o))throw Error("A custom element with name '"+o+"' has already been defined.");if(t.wa)throw Error("A custom element is already being defined.")}function gh(t,o,s){var l;t.wa=!0;try{var h=s.prototype;if(!(h instanceof Object))throw new TypeError("The custom element constructor's prototype is not an object.");var f=function(t){var o=h[t];if(void 0!==o&&!(o instanceof Function))throw Error("The '"+t+"' callback must be a function.");return o},v=f("connectedCallback"),m=f("disconnectedCallback"),_=f("adoptedCallback"),R=(l=f("attributeChangedCallback"))&&s.observedAttributes||[]}catch(t){throw t}finally{t.wa=!1}return s={localName:o,constructorFunction:s,connectedCallback:v,disconnectedCallback:m,adoptedCallback:_,attributeChangedCallback:l,observedAttributes:R,constructionStack:[]},t.na.set(o,s),t.Fa.set(s.constructorFunction,s),s}function fh(t){if(!1!==t.V){t.V=!1;for(var o=[],s=t.oa,l=new Map,h=0;h<s.length;h++)l.set(s[h],[]);for(Yg(t.S,document,{upgrade:function(s){if(void 0===s.__CE_state){var h=s.localName,v=l.get(h);v?v.push(s):t.na.has(h)&&o.push(s)}}}),h=0;h<o.length;h++)Wg(t.S,o[h]);for(h=0;h<s.length;h++){for(var v=s[h],m=l.get(v),_=0;_<m.length;_++)Wg(t.S,m[_]);(v=t.za.get(v))&&v.resolve(void 0)}s.length=0}}function Zg(t,o){var s=t.na.get(o);if(s)return s;if(s=t.ma.get(o)){t.ma.delete(o);try{return gh(t,o,s())}catch(t){$g(t)}}}function hh(t,o,s){function d(o){return function(s){for(var l=[],h=0;h<arguments.length;++h)l[h]=arguments[h];h=[];for(var v=[],m=0;m<l.length;m++){var _=l[m];if(_ instanceof Element&&T(_)&&v.push(_),_ instanceof DocumentFragment)for(_=_.firstChild;_;_=_.nextSibling)h.push(_);else h.push(_)}for(o.apply(this,l),l=0;l<v.length;l++)Xg(t,v[l]);if(T(this))for(l=0;l<h.length;l++)(v=h[l])instanceof Element&&Vg(t,v)}}void 0!==s.prepend&&(o.prepend=d(s.prepend)),void 0!==s.append&&(o.append=d(s.append))}function kh(t){function b(o,s){Object.defineProperty(o,"innerHTML",{enumerable:s.enumerable,configurable:!0,get:s.get,set:function(o){var l=this,h=void 0;if(T(this)&&(h=[],Qg(t,this,(function(t){t!==l&&h.push(t)}))),s.set.call(this,o),h)for(var v=0;v<h.length;v++){var m=h[v];1===m.__CE_state&&t.disconnectedCallback(m)}return this.ownerDocument.__CE_registry?Yg(t,this):Tg(t,this),o}})}function c(o,s){o.insertAdjacentElement=function(o,l){var h=T(l);return o=s.call(this,o,l),h&&Xg(t,l),T(o)&&Vg(t,l),o}}function d(o,s){function g(o,s){for(var l=[];o!==s;o=o.nextSibling)l.push(o);for(s=0;s<l.length;s++)Yg(t,l[s])}o.insertAdjacentHTML=function(t,o){if("beforebegin"===(t=t.toLowerCase())){var l=this.previousSibling;s.call(this,t,o),g(l||this.parentNode.firstChild,this)}else if("afterbegin"===t)l=this.firstChild,s.call(this,t,o),g(this.firstChild,l);else if("beforeend"===t)l=this.lastChild,s.call(this,t,o),g(l||this.firstChild,null);else{if("afterend"!==t)throw new SyntaxError("The value provided ("+String(t)+") is not one of 'beforebegin', 'afterbegin', 'beforeend', or 'afterend'.");l=this.nextSibling,s.call(this,t,o),g(this.nextSibling,l)}}}Lo&&(Element.prototype.attachShadow=function(o){if(o=Lo.call(this,o),t.W&&!o.__CE_patched){o.__CE_patched=!0;for(var s=0;s<t.ca.length;s++)t.ca[s](o)}return this.__CE_shadowRoot=o}),Fo&&Fo.get?b(Element.prototype,Fo):en&&en.get?b(HTMLElement.prototype,en):function Sg(t,o){t.W=!0,t.g.push(o)}(t,(function(t){b(t,{enumerable:!0,configurable:!0,get:function(){return Ro.call(this,!0).innerHTML},set:function(t){var o="template"===this.localName,s=o?this.content:this,l=So.call(document,this.namespaceURI,this.localName);for(l.innerHTML=t;0<s.childNodes.length;)No.call(s,s.childNodes[0]);for(t=o?l.content:l;0<t.childNodes.length;)Oo.call(s,t.childNodes[0])}})})),Element.prototype.setAttribute=function(o,s){if(1!==this.__CE_state)return Ho.call(this,o,s);var l=Uo.call(this,o);Ho.call(this,o,s),s=Uo.call(this,o),t.attributeChangedCallback(this,o,l,s,null)},Element.prototype.setAttributeNS=function(o,s,l){if(1!==this.__CE_state)return jo.call(this,o,s,l);var h=qo.call(this,o,s);jo.call(this,o,s,l),l=qo.call(this,o,s),t.attributeChangedCallback(this,s,h,l,o)},Element.prototype.removeAttribute=function(o){if(1!==this.__CE_state)return Bo.call(this,o);var s=Uo.call(this,o);Bo.call(this,o),null!==s&&t.attributeChangedCallback(this,o,s,null,null)},Element.prototype.removeAttributeNS=function(o,s){if(1!==this.__CE_state)return zo.call(this,o,s);var l=qo.call(this,o,s);zo.call(this,o,s);var h=qo.call(this,o,s);l!==h&&t.attributeChangedCallback(this,s,l,h,o)},tn?c(HTMLElement.prototype,tn):Vo&&c(Element.prototype,Vo),rn?d(HTMLElement.prototype,rn):Go&&d(Element.prototype,Go),hh(t,Element.prototype,{prepend:Ko,append:Wo}),function jh(t){function b(o){return function(s){for(var l=[],h=0;h<arguments.length;++h)l[h]=arguments[h];h=[];for(var v=[],m=0;m<l.length;m++){var _=l[m];if(_ instanceof Element&&T(_)&&v.push(_),_ instanceof DocumentFragment)for(_=_.firstChild;_;_=_.nextSibling)h.push(_);else h.push(_)}for(o.apply(this,l),l=0;l<v.length;l++)Xg(t,v[l]);if(T(this))for(l=0;l<h.length;l++)(v=h[l])instanceof Element&&Vg(t,v)}}var o=Element.prototype;void 0!==Qo&&(o.before=b(Qo)),void 0!==Yo&&(o.after=b(Yo)),void 0!==Jo&&(o.replaceWith=function(o){for(var s=[],l=0;l<arguments.length;++l)s[l]=arguments[l];l=[];for(var h=[],v=0;v<s.length;v++){var m=s[v];if(m instanceof Element&&T(m)&&h.push(m),m instanceof DocumentFragment)for(m=m.firstChild;m;m=m.nextSibling)l.push(m);else l.push(m)}for(v=T(this),Jo.apply(this,s),s=0;s<h.length;s++)Xg(t,h[s]);if(v)for(Xg(t,this),s=0;s<l.length;s++)(h=l[s])instanceof Element&&Vg(t,h)}),void 0!==Xo&&(o.remove=function(){var o=T(this);Xo.call(this),o&&Xg(t,this)})}(t)}Og.prototype.connectedCallback=function(t){var o=t.__CE_definition;if(o.connectedCallback)try{o.connectedCallback.call(t)}catch(t){$g(t)}},Og.prototype.disconnectedCallback=function(t){var o=t.__CE_definition;if(o.disconnectedCallback)try{o.disconnectedCallback.call(t)}catch(t){$g(t)}},Og.prototype.attributeChangedCallback=function(t,o,s,l,h){var v=t.__CE_definition;if(v.attributeChangedCallback&&-1<v.observedAttributes.indexOf(o))try{v.attributeChangedCallback.call(t,o,s,l,h)}catch(t){$g(t)}},bh.prototype.resolve=function(t){if(this.I)throw Error("Already resolved.");this.I=t,this.g(t)},ch.prototype.h=function(t){var o=this.g.readyState;for("interactive"!==o&&"complete"!==o||dh(this),o=0;o<t.length;o++)for(var s=t[o].addedNodes,l=0;l<s.length;l++)Yg(this.S,s[l])},(o=U.prototype).jb=function(t,o){var s=this;if(!(o instanceof Function))throw new TypeError("Custom element constructor getters must be functions.");eh(this,t),this.ma.set(t,o),this.oa.push(t),this.V||(this.V=!0,this.la((function(){return fh(s)})))},o.define=function(t,o){var s=this;if(!(o instanceof Function))throw new TypeError("Custom element constructors must be functions.");eh(this,t),gh(this,t,o),this.oa.push(t),this.V||(this.V=!0,this.la((function(){return fh(s)})))},o.upgrade=function(t){Yg(this.S,t)},o.get=function(t){if(t=Zg(this,t))return t.constructorFunction},o.whenDefined=function(t){if(!Jg(t))return Promise.reject(new SyntaxError("'"+t+"' is not a valid custom element name."));var o=this.za.get(t);if(o)return o.Ka;o=new bh,this.za.set(t,o);var s=this.na.has(t)||this.ma.has(t);return t=-1===this.oa.indexOf(t),s&&t&&o.resolve(void 0),o.Ka},o.polyfillWrapFlushCallback=function(t){this.Ga&&dh(this.Ga);var o=this.la;this.la=function(s){return t((function(){return o(s)}))}},U.prototype.define=U.prototype.define,U.prototype.upgrade=U.prototype.upgrade,U.prototype.get=U.prototype.get,U.prototype.whenDefined=U.prototype.whenDefined,U.prototype.polyfillDefineLazy=U.prototype.jb,U.prototype.polyfillWrapFlushCallback=U.prototype.polyfillWrapFlushCallback;var sn={};var an=window.customElements;function oh(){var t=new Og;!function mh(t){function b(){var o=this.constructor,s=document.__CE_registry.Fa.get(o);if(!s)throw Error("Failed to construct a custom element: The constructor was not registered with `customElements`.");var l=s.constructionStack;if(0===l.length)return l=To.call(document,s.localName),Object.setPrototypeOf(l,o.prototype),l.__CE_state=1,l.__CE_definition=s,Ug(t,l),l;var h=l.length-1,v=l[h];if(v===sn)throw Error("Failed to construct '"+s.localName+"': This element was already constructed.");return l[h]=sn,Object.setPrototypeOf(v,o.prototype),Ug(t,v),v}b.prototype=Zo.prototype,Object.defineProperty(HTMLElement.prototype,"constructor",{writable:!0,configurable:!0,enumerable:!1,value:b}),window.HTMLElement=b}(t),function ih(t){Document.prototype.createElement=function(o){return ah(t,this,o,null)},Document.prototype.importNode=function(o,s){return o=xo.call(this,o,!!s),this.__CE_registry?Yg(t,o):Tg(t,o),o},Document.prototype.createElementNS=function(o,s){return ah(t,this,s,o)},hh(t,Document.prototype,{prepend:Eo,append:Io})}(t),hh(t,DocumentFragment.prototype,{prepend:Ao,append:Po}),function nh(t){function b(o,s){Object.defineProperty(o,"textContent",{enumerable:s.enumerable,configurable:!0,get:s.get,set:function(o){if(this.nodeType===Node.TEXT_NODE)s.set.call(this,o);else{var l=void 0;if(this.firstChild){var h=this.childNodes,v=h.length;if(0<v&&T(this)){l=Array(v);for(var m=0;m<v;m++)l[m]=h[m]}}if(s.set.call(this,o),l)for(o=0;o<l.length;o++)Xg(t,l[o])}}})}Node.prototype.insertBefore=function(o,s){if(o instanceof DocumentFragment){var l=Lg(o);if(o=$o.call(this,o,s),T(this))for(s=0;s<l.length;s++)Vg(t,l[s]);return o}return l=o instanceof Element&&T(o),s=$o.call(this,o,s),l&&Xg(t,o),T(this)&&Vg(t,o),s},Node.prototype.appendChild=function(o){if(o instanceof DocumentFragment){var s=Lg(o);if(o=Oo.call(this,o),T(this))for(var l=0;l<s.length;l++)Vg(t,s[l]);return o}return s=o instanceof Element&&T(o),l=Oo.call(this,o),s&&Xg(t,o),T(this)&&Vg(t,o),l},Node.prototype.cloneNode=function(o){return o=Ro.call(this,!!o),this.ownerDocument.__CE_registry?Yg(t,o):Tg(t,o),o},Node.prototype.removeChild=function(o){var s=o instanceof Element&&T(o),l=No.call(this,o);return s&&Xg(t,o),l},Node.prototype.replaceChild=function(o,s){if(o instanceof DocumentFragment){var l=Lg(o);if(o=Mo.call(this,o,s),T(this))for(Xg(t,s),s=0;s<l.length;s++)Vg(t,l[s]);return o}l=o instanceof Element&&T(o);var h=Mo.call(this,o,s),v=T(this);return v&&Xg(t,s),l&&Xg(t,o),v&&Vg(t,o),h},Do&&Do.get?b(Node.prototype,Do):function Rg(t,o){t.W=!0,t.ca.push(o)}(t,(function(t){b(t,{enumerable:!0,configurable:!0,get:function(){for(var t=[],o=this.firstChild;o;o=o.nextSibling)o.nodeType!==Node.COMMENT_NODE&&t.push(o.textContent);return t.join("")},set:function(t){for(;this.firstChild;)No.call(this,this.firstChild);null!=t&&""!==t&&Oo.call(this,document.createTextNode(t))}})}))}(t),kh(t),window.CustomElementRegistry=U,t=new U(t),document.__CE_registry=t,Object.defineProperty(window,"customElements",{configurable:!0,enumerable:!0,value:t})}function ph(){this.end=this.start=0,this.rules=this.parent=this.previous=null,this.cssText=this.parsedCssText="",this.atRule=!1,this.type=0,this.parsedSelector=this.selector=this.keyframesName=""}function qh(t){var o=t=t.replace(fn,"").replace(gn,""),s=new ph;s.start=0,s.end=o.length;for(var l=s,h=0,v=o.length;h<v;h++)if("{"===o[h]){l.rules||(l.rules=[]);var m=l,_=m.rules[m.rules.length-1]||null;(l=new ph).start=h+1,l.parent=m,l.previous=_,m.rules.push(l)}else"}"===o[h]&&(l.end=h+1,l=l.parent||s);return th(s,t)}function th(t,o){var s=o.substring(t.start,t.end-1);if(t.parsedCssText=t.cssText=s.trim(),t.parent&&(s=function uh(t){return t.replace(/\\([0-9a-f]{1,6})\s/gi,(function(t,o){for(o=6-(t=o).length;o--;)t="0"+t;return"\\"+t}))}(s=o.substring(t.previous?t.previous.end:t.parent.start,t.start-1)),s=(s=s.replace(_n," ")).substring(s.lastIndexOf(";")+1),s=t.parsedSelector=t.selector=s.trim(),t.atRule=0===s.indexOf("@"),t.atRule?0===s.indexOf("@media")?t.type=hn:s.match(wn)&&(t.type=un,t.keyframesName=t.selector.split(_n).pop()):t.type=0===s.indexOf("--")?pn:dn),s=t.rules)for(var l=0,h=s.length,v=void 0;l<h&&(v=s[l]);l++)th(v,o);return t}function Bh(t,o,s){s=void 0===s?"":s;var l="";if(t.cssText||t.rules){var h,v=t.rules;if((h=v)&&(h=!((h=v[0])&&h.selector&&0===h.selector.indexOf("--"))),h){h=0;for(var m=v.length,_=void 0;h<m&&(_=v[h]);h++)l=Bh(_,o,l)}else o?o=t.cssText:o=(o=(o=t.cssText).replace(vn,"").replace(mn,"")).replace(bn,"").replace(yn,""),(l=o.trim())&&(l="  "+l+"\n")}return l&&(t.selector&&(s+=t.selector+" {\n"),s+=l,t.selector&&(s+="}\n\n")),s}an&&!an.forcePolyfill&&"function"==typeof an.define&&"function"==typeof an.get||oh(),window.__CE_installPolyfill=oh;var ln,cn,dn=1,un=7,hn=4,pn=1e3,fn=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//gim,gn=/@import[^;]*;/gim,vn=/(?:^[^;\-\s}]+)?--[^;{}]*?:[^{};]*?(?:[;\n]|$)/gim,mn=/(?:^[^;\-\s}]+)?--[^;{}]*?:[^{};]*?{[^}]*?}(?:[;\n]|$)?/gim,bn=/@apply\s*\(?[^);]*\)?\s*(?:[;\n]|$)?/gim,yn=/[^;:]*?:[^;]*?var\([^;]*\)(?:[;\n]|$)?/gim,wn=/^@[^\s]*keyframes/,_n=/\s+/g,Cn=!(window.ShadyDOM&&window.ShadyDOM.inUse);function Hh(t){ln=(!t||!t.shimcssproperties)&&(Cn||!(navigator.userAgent.match(/AppleWebKit\/601|Edge\/15/)||!window.CSS||!CSS.supports||!CSS.supports("box-shadow","0 0 0 var(--foo)")))}window.ShadyCSS&&void 0!==window.ShadyCSS.cssBuild&&(cn=window.ShadyCSS.cssBuild);var kn=!(!window.ShadyCSS||!window.ShadyCSS.disableRuntime);window.ShadyCSS&&void 0!==window.ShadyCSS.nativeCss?ln=window.ShadyCSS.nativeCss:window.ShadyCSS?(Hh(window.ShadyCSS),window.ShadyCSS=void 0):Hh(window.WebComponents&&window.WebComponents.flags);var Tn=ln,Sn=/(?:^|[;\s{]\s*)(--[\w-]*?)\s*:\s*(?:((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};{])+)|\{([^}]*)\}(?:(?=[;\s}])|$))/gi,xn=/(?:^|\W+)@apply\s*\(?([^);\n]*)\)?/gi,En=/(--[\w-]+)\s*([:,;)]|$)/gi,In=/(animation\s*:)|(animation-name\s*:)/,An=/@media\s(.*)/,Pn=/\{[^}]*\}/g,Rn=new Set;function Rh(t,o){return t?("string"==typeof t&&(t=qh(t)),o&&Sh(t,o),Bh(t,Tn)):""}function Th(t){return!t.__cssRules&&t.textContent&&(t.__cssRules=qh(t.textContent)),t.__cssRules||null}function Vh(t){return!!t.parent&&t.parent.type===un}function Sh(t,o,s,l){if(t){var h=!1,v=t.type;if(l&&v===hn){var m=t.selector.match(An);m&&(window.matchMedia(m[1]).matches||(h=!0))}if(v===dn?o(t):s&&v===un?s(t):v===pn&&(h=!0),(t=t.rules)&&!h)for(h=0,v=t.length,m=void 0;h<v&&(m=t[h]);h++)Sh(m,o,s,l)}}function Wh(t,o,s,l){var h=document.createElement("style");return o&&h.setAttribute("scope",o),h.textContent=t,Xh(h,s,l),h}var On=null;function Zh(t){t=document.createComment(" Shady DOM styles for "+t+" ");var o=document.head;return o.insertBefore(t,(On?On.nextSibling:null)||o.firstChild),On=t}function Xh(t,o,s){(o=o||document.head).insertBefore(t,s&&s.nextSibling||o.firstChild),On?t.compareDocumentPosition(On)===Node.DOCUMENT_POSITION_PRECEDING&&(On=t):On=t}function $h(t,o){for(var s=0,l=t.length;o<l;o++)if("("===t[o])s++;else if(")"===t[o]&&0==--s)return o;return-1}function ai(t,o){var s=t.indexOf("var(");if(-1===s)return o(t,"","","");var l=$h(t,s+3),h=t.substring(s+4,l);return s=t.substring(0,s),t=ai(t.substring(l+1),o),-1===(l=h.indexOf(","))?o(s,h.trim(),"",t):o(s,h.substring(0,l).trim(),h.substring(l+1).trim(),t)}function bi(t,o){Cn?t.setAttribute("class",o):window.ShadyDOM.nativeMethods.setAttribute.call(t,"class",o)}var $n=window.ShadyDOM&&window.ShadyDOM.wrap||function(t){return t};function di(t){var o=t.localName,s="";return o?-1<o.indexOf("-")||(s=o,o=t.getAttribute&&t.getAttribute("is")||""):(o=t.is,s=t.extends),{is:o,ja:s}}function ei(t){for(var o=[],s="",l=0;0<=l&&l<t.length;l++)if("("===t[l]){var h=$h(t,l);s+=t.slice(l,h+1),l=h}else","===t[l]?(o.push(s),s=""):s+=t[l];return s&&o.push(s),o}function fi(t){if(void 0!==cn)return cn;if(void 0===t.__cssBuild){var o=t.getAttribute("css-build");if(o)t.__cssBuild=o;else{if(""!==(o=(o="template"===t.localName?t.content.firstChild:t.firstChild)instanceof Comment&&"css-build"===(o=o.textContent.trim().split(":"))[0]?o[1]:"")){var s="template"===t.localName?t.content.firstChild:t.firstChild;s.parentNode.removeChild(s)}t.__cssBuild=o}}return t.__cssBuild||""}function gi(t){return!(""===(t=void 0===t?"":t)||!Tn)&&(Cn?"shadow"===t:"shady"===t)}function hi(){}function ji(t,o,s){var l;if(o.nodeType===Node.ELEMENT_NODE&&s(o),l="template"===o.localName?(o.content||o._content||o).childNodes:o.children||o.childNodes)for(o=0;o<l.length;o++)ji(t,l[o],s)}function li(t,o,s){if(o)if(t.classList)s?(t.classList.remove("style-scope"),t.classList.remove(o)):(t.classList.add("style-scope"),t.classList.add(o));else if(t.getAttribute){var l=t.getAttribute("class");s?l&&bi(t,o=l.replace("style-scope","").replace(o,"")):bi(t,(l?l+" ":"")+"style-scope "+o)}}function mi(t,o,s){ji(qn,t,(function(t){li(t,o,!0),li(t,s)}))}function ni(t,o){ji(qn,t,(function(t){li(t,o||"",!0)}))}function oi(t,o,s,l,h){var v=qn;return""===(h=void 0===h?"":h)&&(Cn||"shady"===(void 0===l?"":l)?h=Rh(o,s):h=function pi(t,o,s,l,h){var v=qi(s,l);return s=s?"."+s:"",Rh(o,(function(o){o.i||(o.selector=o.G=ri(t,o,t.h,s,v),o.i=!0),h&&h(o,s,v)}))}(v,o,(t=di(t)).is,t.ja,s)+"\n\n"),h.trim()}function qi(t,o){return o?"[is="+t+"]":t}function ri(t,o,s,l,h){var v=ei(o.selector);if(!Vh(o)){o=0;for(var m=v.length,_=void 0;o<m&&(_=v[o]);o++)v[o]=s.call(t,_,l,h)}return v.filter((function(t){return!!t})).join(",")}function si(t){return t.replace(Nn,(function(t,o,s){return-1<s.indexOf("+")?s=s.replace(/\+/g,"___"):-1<s.indexOf("___")&&(s=s.replace(/___/g,"+")),":"+o+"("+s+")"}))}function Ci(t,o){t=t.split(/(\[.+?\])/);for(var s=[],l=0;l<t.length;l++)if(1==l%2)s.push(t[l]);else{var h=t[l];""===h&&l===t.length-1||((h=h.split(":"))[0]+=o,s.push(h.join(":")))}return s.join("")}function Gi(t){":root"===t.selector&&(t.selector="html")}hi.prototype.h=function(t,o,s){var l=!1;t=t.trim();var h=Nn.test(t);h&&(t=t.replace(Nn,(function(t,o,s){return":"+o+"("+s.replace(/\s/g,"")+")"})),t=si(t));var v=Bn.test(t);if(v){var m=function ui(t){for(var o,s=[];o=t.match(Bn);){var l=o.index,h=$h(t,l);if(-1===h)throw Error(o.input+" selector missing ')'");o=t.slice(l,h+1),t=t.replace(o,"î"),s.push(o)}return{Ea:t,matches:s}}(t);t=m.Ea,m=m.matches}return t=(t=t.replace(Ln,":host $1")).replace(Mn,(function(t,h,v){return l||(t=function zi(t,o,s,l){var h=t.indexOf("::slotted");if(0<=t.indexOf(":host")?t=function Bi(t,o){var s=t.match(Fn);return(s=s&&s[2].trim()||"")?s[0].match(Dn)?t.replace(Fn,(function(t,s,l){return o+l})):s.split(Dn)[0]===o?s:"should_not_match":t.replace(":host",o)}(t,l):0!==h&&(t=s?Ci(t,s):t),s=!1,0<=h&&(o="",s=!0),s){var v=!0;s&&(t=t.replace(Un,(function(t,o){return" > "+o})))}return{value:t,Ya:o,stop:v}}(v,h,o,s),l=l||t.stop,h=t.Ya,v=t.value),h+v})),v&&(t=function wi(t,o){var s=t.split("î");return o.reduce((function(t,o,l){return t+o+s[l+1]}),s[0])}(t,m)),h&&(t=si(t)),t.replace(Hn,(function(t,o,s,l){return'[dir="'+s+'"] '+o+l+", "+o+'[dir="'+s+'"]'+l}))},hi.prototype.i=function(t){return t.match(":host")?"":t.match("::slotted")?this.h(t,":not(.style-scope)"):Ci(t.trim(),":not(.style-scope)")},h.Object.defineProperties(hi.prototype,{g:{configurable:!0,enumerable:!0,get:function(){return"style-scope"}}});var Nn=/:(nth[-\w]+)\(([^)]+)\)/,Mn=/(^|[\s>+~]+)((?:\[.+?\]|[^\s>+~=[])+)/g,Dn=/[[.:#*]/,Ln=/^(::slotted)/,Fn=/(:host)(?:\(((?:\([^)(]*\)|[^)(]*)+?)\))/,Un=/(?:::slotted)(?:\(((?:\([^)(]*\)|[^)(]*)+?)\))/,Hn=/(.*):dir\((?:(ltr|rtl))\)(.*)/,Bn=/:(?:matches|any|-(?:webkit|moz)-any)/,qn=new hi;function Hi(t,o,s,l,h){this.M=t||null,this.h=o||null,this.Ca=s||[],this.K=null,this.cssBuild=h||"",this.ja=l||"",this.g=this.L=this.R=null}function Ii(t){return t?t.__styleInfo:null}function Ji(t,o){return t.__styleInfo=o}function Ki(t){var o=this.matches||this.matchesSelector||this.mozMatchesSelector||this.msMatchesSelector||this.oMatchesSelector||this.webkitMatchesSelector;return o&&o.call(this,t)}Hi.prototype.i=function(){return this.M},Hi.prototype._getStyleRules=Hi.prototype.i;var jn=/:host\s*>\s*/,zn=navigator.userAgent.match("Trident");function Ni(){}function Pi(t){if(!t.F){var o={},s={};Qi(t,s)&&(o.P=s,t.rules=null),o.cssText=t.parsedCssText.replace(Pn,"").replace(Sn,""),t.F=o}}function Qi(t,o){var s=t.F;if(!s){s=t.parsedCssText;for(var l;t=Sn.exec(s);)"inherit"===(l=(t[2]||t[3]).trim())&&"unset"===l||(o[t[1].trim()]=l),l=!0;return l}if(s.P)return Object.assign(o,s.P),!0}function Ri(t,o,s){return o&&(o=0<=o.indexOf(";")?Si(t,o,s):ai(o,(function(o,l,h,v){return l?((l=Ri(t,s[l],s))&&"initial"!==l?"apply-shim-inherit"===l&&(l="inherit"):l=Ri(t,s[h]||h,s)||h,o+(l||"")+v):o+v}))),o&&o.trim()||""}function Si(t,o,s){o=o.split(";");for(var l,h,v=0;v<o.length;v++)if(l=o[v]){if(xn.lastIndex=0,h=xn.exec(l))l=Ri(t,s[h[1]],s);else if(-1!==(h=l.indexOf(":"))){var m=l.substring(h);m=Ri(t,m=m.trim(),s)||m,l=l.substring(0,h)+m}o[v]=l&&l.lastIndexOf(";")===l.length-1?l.slice(0,-1):l||""}return o.join(";")}function Vi(t,o,s){var l={},h={};return Sh(o,(function(o){!function Ui(t,o,s,l){if(o.F||Pi(o),o.F.P){var h=di(t);t=h.is,h=h.ja,h=t?qi(t,h):"html";var v=o.parsedSelector,m=!!v.match(jn)||"html"===h&&-1<v.indexOf("html"),_=0===v.indexOf(":host")&&!m;"shady"===s&&(_=!(m=v===h+" > *."+h||-1!==v.indexOf("html"))&&0===v.indexOf(h)),(m||_)&&(s=h,_&&(o.G||(o.G=ri(qn,o,qn.h,t?"."+t:"",h)),s=o.G||h),m&&"html"===h&&(s=o.G||o.O),l({Ea:s,gb:_,vb:m}))}}(t,o,s,(function(s){Ki.call(t._element||t,s.Ea)&&(s.gb?Qi(o,l):Qi(o,h))}))}),null,!0),{mb:h,eb:l}}function Wi(t,o,s,l){var h=di(o),v=qi(h.is,h.ja),m=new RegExp("(?:^|[^.#[:])"+(o.extends?"\\"+v.slice(0,-1)+"\\]":v)+"($|[.:[\\s>+~])"),_=Ii(o);h=_.M,_=_.cssBuild;var R=function Xi(t,o){t=t.h;var s={};if(!Cn&&t)for(var l=0,h=t[l];l<t.length;h=t[++l]){var v=h,m=o;v.u=new RegExp("\\b"+v.keyframesName+"(?!\\B|-)","g"),v.g=v.keyframesName+"-"+m,v.G=v.G||v.selector,v.selector=v.G.replace(v.keyframesName,v.g),s[h.keyframesName]=Yi(h)}return s}(h,l);return oi(o,h,(function(o){var h="";if(o.F||Pi(o),o.F.cssText&&(h=Si(t,o.F.cssText,s)),o.cssText=h,!Cn&&!Vh(o)&&o.cssText){var _=h=o.cssText;if(null==o.Ma&&(o.Ma=In.test(h)),o.Ma)if(null==o.ra)for(var $ in o.ra=[],R)h!==(_=(_=R[$])(h))&&(h=_,o.ra.push($));else{for($=0;$<o.ra.length;++$)h=(_=R[o.ra[$]])(h);_=h}o.cssText=_,o.G=o.G||o.selector,h="."+l,_=0;for(var B=($=ei(o.G)).length,q=void 0;_<B&&(q=$[_]);_++)$[_]=q.match(m)?q.replace(v,h):h+" "+q;o.selector=$.join(",")}}),_)}function Yi(t){return function(o){return o.replace(t.u,t.g)}}function Zi(t,o){var s=Vn,l=Th(t);t.textContent=Rh(l,(function(t){var l=t.cssText=t.parsedCssText;t.F&&t.F.cssText&&(l=l.replace(vn,"").replace(mn,""),t.cssText=Si(s,l,o))}))}h.Object.defineProperties(Ni.prototype,{g:{configurable:!0,enumerable:!0,get:function(){return"x-scope"}}});var Vn=new Ni,Gn={},Kn=window.customElements;if(Kn&&!Cn&&!kn){var Wn=Kn.define;Kn.define=function(t,o,s){Gn[t]||(Gn[t]=Zh(t)),Wn.call(Kn,t,o,s)}}function dj(){this.cache={}}function ej(){}dj.prototype.store=function(t,o,s,l){var h=this.cache[t]||[];h.push({P:o,styleElement:s,L:l}),100<h.length&&h.shift(),this.cache[t]=h};var Qn=new RegExp(qn.g+"\\s*([^\\s]*)");function gj(t){return(t=(t.classList&&t.classList.value?t.classList.value:t.getAttribute("class")||"").match(Qn))?t[1]:""}function hj(t){var o=$n(t).getRootNode();return o===t||o===t.ownerDocument?"":(t=o.host)?di(t).is:""}function ij(t){for(var o=0;o<t.length;o++){var s=t[o];if(s.target!==document.documentElement&&s.target!==document.head)for(var l=0;l<s.addedNodes.length;l++){var h=s.addedNodes[l];if(h.nodeType===Node.ELEMENT_NODE){var v=h.getRootNode(),m=gj(h);if(m&&v===h.ownerDocument&&("style"!==h.localName&&"template"!==h.localName||""===fi(h)))ni(h,m);else if(v instanceof ShadowRoot)for((v=hj(h))!==m&&mi(h,m,v),h=window.ShadyDOM.nativeMethods.querySelectorAll.call(h,":not(."+qn.g+")"),m=0;m<h.length;m++){var _=hj(v=h[m]);_&&li(v,_)}}}}}if(!(Cn||window.ShadyDOM&&window.ShadyDOM.handlesDynamicScoping)){var Yn=new MutationObserver(ij),kj=function(t){Yn.observe(t,{childList:!0,subtree:!0})};if(window.customElements&&!window.customElements.polyfillWrapFlushCallback)kj(document);else{var lj=function(){kj(document.body)};window.HTMLImports?window.HTMLImports.whenReady(lj):requestAnimationFrame((function(){if("loading"===document.readyState){var a=function(){lj(),document.removeEventListener("readystatechange",a)};document.addEventListener("readystatechange",a)}else lj()}))}ej=function(){ij(Yn.takeRecords())}}var Jn={},Xn=Promise.resolve();function oj(t){(t=Jn[t])&&(t._applyShimCurrentVersion=t._applyShimCurrentVersion||0,t._applyShimValidatingVersion=t._applyShimValidatingVersion||0,t._applyShimNextVersion=(t._applyShimNextVersion||0)+1)}function pj(t){return t._applyShimCurrentVersion===t._applyShimNextVersion}var Zn={},ti=new dj;function Y(){this.ea={},this.i=document.documentElement;var t=new ph;t.rules=[],this.u=Ji(this.i,new Hi(t)),this.O=!1,this.g=this.h=null}function uj(t){var o=di(t),s=o.is;o=o.ja;var l=Gn[s]||null,h=Jn[s];if(h)return Ji(t,o=new Hi(s=h._styleAst,l,h.g,o,h=fi(h))),o}function tj(t){if(!t.h&&window.ShadyCSS&&window.ShadyCSS.ApplyShim){t.h=window.ShadyCSS.ApplyShim,t.h.invalidCallback=oj;var o=!0}else o=!1;return function vj(t){!t.g&&window.ShadyCSS&&window.ShadyCSS.CustomStyleInterface&&(t.g=window.ShadyCSS.CustomStyleInterface,t.g.transformCallback=function(o){t.Qa(o)},t.g.validateCallback=function(){requestAnimationFrame((function(){(t.g.enqueued||t.O)&&t.flushCustomStyles()}))})}(t),o}function yj(t,o,s){var l=di(o).is;if(s.K){var h,v=s.K;for(h in v)null===h?o.style.removeProperty(h):o.style.setProperty(h,v[h])}!(v=Jn[l])&&o!==t.i||v&&""!==fi(v)||!v||!v._style||pj(v)||((pj(v)||v._applyShimValidatingVersion!==v._applyShimNextVersion)&&(tj(t),t.h&&t.h.transformRules(v._styleAst,l),v._style.textContent=oi(o,s.M),function qj(t){t._applyShimValidatingVersion=t._applyShimNextVersion,t._validating||(t._validating=!0,Xn.then((function(){t._applyShimCurrentVersion=t._applyShimNextVersion,t._validating=!1})))}(v)),Cn&&(t=o.shadowRoot)&&(t=t.querySelector("style"))&&(t.textContent=oi(o,s.M)),s.M=v._styleAst)}function zj(t,o){return(o=$n(o).getRootNode().host)?Ii(o)||uj(o)?o:zj(t,o):t.i}function xj(t,o,s){var l=zj(t,o),h=Ii(l),v=h.R;for(var m in l===t.i||v||(xj(t,l,h),v=h.R),t=Object.create(v||null),l=Vi(o,s.M,s.cssBuild),o=function Ti(t,o){var s={},l=[];return Sh(t,(function(t){t.F||Pi(t);var h=t.G||t.parsedSelector;o&&t.F.P&&h&&Ki.call(o,h)&&(Qi(t,s),t=t.index,h=parseInt(t/32,10),l[h]=(l[h]||0)|1<<t%32)}),null,!0),{P:s,key:l}}(h.M,o).P,Object.assign(t,l.eb,o,l.mb),o=s.K)((h=o[m])||0===h)&&(t[m]=h);for(m=Vn,o=Object.getOwnPropertyNames(t),h=0;h<o.length;h++)t[l=o[h]]=Ri(m,t[l],t);s.R=t}(o=Y.prototype).flush=function(){ej()},o.bb=function(t){return Th(t)},o.qb=function(t){return Rh(t)},o.prepareTemplate=function(t,o,s){this.prepareTemplateDom(t,o),this.prepareTemplateStyles(t,o,s)},o.prepareTemplateStyles=function(t,o,s){if(!t._prepared&&!kn){Cn||Gn[o]||(Gn[o]=Zh(o)),t._prepared=!0,t.name=o,t.extends=s,Jn[o]=t;var l=fi(t),h=gi(l);s={is:o,extends:s};for(var v=[],m=t.content.querySelectorAll("style"),_=0;_<m.length;_++){var R=m[_];if(R.hasAttribute("shady-unscoped")){if(!Cn){var $=R.textContent;if(!Rn.has($)){Rn.add($);var B=document.createElement("style");B.setAttribute("shady-unscoped",""),B.textContent=$,document.head.appendChild(B)}R.parentNode.removeChild(R)}}else v.push(R.textContent),R.parentNode.removeChild(R)}v=v.join("").trim()+(Zn[o]||""),tj(this),h||((m=!l)&&(m=xn.test(v)||Sn.test(v),xn.lastIndex=0,Sn.lastIndex=0),_=qh(v),m&&Tn&&this.h&&this.h.transformRules(_,o),t._styleAst=_),m=[],Tn||(m=function Oi(t){var o={},s=[],l=0;for(var h in Sh(t,(function(t){Pi(t),t.index=l++,t=t.F.cssText;for(var s;s=En.exec(t);){var h=s[1];":"!==s[2]&&(o[h]=!0)}}),(function(t){s.push(t)})),t.h=s,t=[],o)t.push(h);return t}(t._styleAst)),m.length&&!Tn||(_=Cn?t.content:null,o=Gn[o]||null,l=(l=oi(s,t._styleAst,null,l,h?v:"")).length?Wh(l,s.is,_,o):null,t._style=l),t.g=m}},o.kb=function(t,o){Zn[o]=t.join(" ")},o.prepareTemplateDom=function(t,o){if(!kn){var s=fi(t);Cn||"shady"===s||t._domPrepared||(t._domPrepared=!0,function ii(t,o){ji(qn,t,(function(t){li(t,o||"")}))}(t.content,o))}},o.flushCustomStyles=function(){if(!kn){var t=tj(this);if(this.g){var o=this.g.processStyles();if((t||this.g.enqueued)&&!gi(this.u.cssBuild)){if(Tn){if(!this.u.cssBuild)for(t=0;t<o.length;t++){var s=this.g.getStyleForCustomStyle(o[t]);if(s&&Tn&&this.h){var l=Th(s);tj(this),this.h.transformRules(l),s.textContent=Rh(l)}}}else{for(function wj(t,o){o=o.map((function(o){return t.g.getStyleForCustomStyle(o)})).filter((function(t){return!!t})),o.sort((function(t,o){return(t=o.compareDocumentPosition(t))&Node.DOCUMENT_POSITION_FOLLOWING?1:t&Node.DOCUMENT_POSITION_PRECEDING?-1:0})),t.u.M.rules=o.map((function(t){return Th(t)}))}(this,o),xj(this,this.i,this.u),t=0;t<o.length;t++)(s=this.g.getStyleForCustomStyle(o[t]))&&Zi(s,this.u.R);this.O&&this.styleDocument()}this.g.enqueued=!1}}}},o.styleElement=function(t,o){if(kn){if(o){Ii(t)||Ji(t,new Hi(null));var s=Ii(t);s.K=s.K||{},Object.assign(s.K,o),yj(this,t,s)}}else if(s=Ii(t)||uj(t))if(t!==this.i&&(this.O=!0),o&&(s.K=s.K||{},Object.assign(s.K,o)),Tn)yj(this,t,s);else if(this.flush(),xj(this,t,s),s.Ca&&s.Ca.length){var l;o=di(t).is;e:{if(l=ti.cache[o])for(var h=l.length-1;0<=h;h--){var v=l[h];t:{for(var m=s.Ca,_=0;_<m.length;_++){var R=m[_];if(v.P[R]!==s.R[R]){m=!1;break t}}m=!0}if(m){l=v;break e}}l=void 0}m=l?l.styleElement:null,h=s.L,(v=l&&l.L)||(v=o+"-"+(v=this.ea[o]=(this.ea[o]||0)+1)),s.L=v,v=s.L,_=Vn,_=m?m.textContent||"":Wi(_,t,s.R,v);var $=(R=Ii(t)).g;$&&!Cn&&$!==m&&($._useCount--,0>=$._useCount&&$.parentNode&&$.parentNode.removeChild($)),Cn?R.g?(R.g.textContent=_,m=R.g):_&&(m=Wh(_,v,t.shadowRoot,R.h)):m?m.parentNode||(zn&&-1<_.indexOf("@media")&&(m.textContent=_),Xh(m,null,R.h)):_&&(m=Wh(_,v,null,R.h)),m&&(m._useCount=m._useCount||0,R.g!=m&&m._useCount++,R.g=m),v=m,Cn||(m=s.L,R=_=t.getAttribute("class")||"",h&&(R=_.replace(new RegExp("\\s*x-scope\\s*"+h+"\\s*","g")," ")),_!==(R+=(R?" ":"")+"x-scope "+m)&&bi(t,R)),l||ti.store(o,s.R,v,s.L)}},o.styleDocument=function(t){this.styleSubtree(this.i,t)},o.styleSubtree=function(t,o){var s=$n(t),l=s.shadowRoot,h=t===this.i;if((l||h)&&this.styleElement(t,o),t=h?s:l)for(t=Array.from(t.querySelectorAll("*")).filter((function(t){return $n(t).shadowRoot})),o=0;o<t.length;o++)this.styleSubtree(t[o])},o.Qa=function(t){var o=this,s=fi(t);if(s!==this.u.cssBuild&&(this.u.cssBuild=s),!gi(s)){var l=Th(t);Sh(l,(function(t){if(Cn)Gi(t);else{var l=qn;t.selector=t.parsedSelector,Gi(t),t.selector=t.G=ri(l,t,l.i,void 0,void 0)}Tn&&""===s&&(tj(o),o.h&&o.h.transformRule(t))})),Tn?t.textContent=Rh(l):this.u.M.rules.push(l)}},o.getComputedStyleValue=function(t,o){var s;return Tn||(s=(Ii(t)||Ii(zj(this,t))).R[o]),(s=s||window.getComputedStyle(t).getPropertyValue(o))?s.trim():""},o.pb=function(t,o){var s=$n(t).getRootNode();if(o=o?("string"==typeof o?o:String(o)).split(/\s/):[],!(s=s.host&&s.host.localName)){var l=t.getAttribute("class");if(l){l=l.split(/\s/);for(var h=0;h<l.length;h++)if(l[h]===qn.g){s=l[h+1];break}}}s&&o.push(qn.g,s),Tn||(s=Ii(t))&&s.L&&o.push(Vn.g,s.L),bi(t,o.join(" "))},o.Xa=function(t){return Ii(t)},o.ob=function(t,o){li(t,o)},o.rb=function(t,o){li(t,o,!0)},o.nb=function(t){return hj(t)},o.$a=function(t){return gj(t)},Y.prototype.flush=Y.prototype.flush,Y.prototype.prepareTemplate=Y.prototype.prepareTemplate,Y.prototype.styleElement=Y.prototype.styleElement,Y.prototype.styleDocument=Y.prototype.styleDocument,Y.prototype.styleSubtree=Y.prototype.styleSubtree,Y.prototype.getComputedStyleValue=Y.prototype.getComputedStyleValue,Y.prototype.setElementClass=Y.prototype.pb,Y.prototype._styleInfoForNode=Y.prototype.Xa,Y.prototype.transformCustomStyleForDocument=Y.prototype.Qa,Y.prototype.getStyleAst=Y.prototype.bb,Y.prototype.styleAstToString=Y.prototype.qb,Y.prototype.flushCustomStyles=Y.prototype.flushCustomStyles,Y.prototype.scopeNode=Y.prototype.ob,Y.prototype.unscopeNode=Y.prototype.rb,Y.prototype.scopeForNode=Y.prototype.nb,Y.prototype.currentScopeForNode=Y.prototype.$a,Y.prototype.prepareAdoptedCssText=Y.prototype.kb,Object.defineProperties(Y.prototype,{nativeShadow:{get:function(){return Cn}},nativeCss:{get:function(){return Tn}}});var ci,vi,yi=new Y;window.ShadyCSS&&(ci=window.ShadyCSS.ApplyShim,vi=window.ShadyCSS.CustomStyleInterface),window.ShadyCSS={ScopingShim:yi,prepareTemplate:function(t,o,s){yi.flushCustomStyles(),yi.prepareTemplate(t,o,s)},prepareTemplateDom:function(t,o){yi.prepareTemplateDom(t,o)},prepareTemplateStyles:function(t,o,s){yi.flushCustomStyles(),yi.prepareTemplateStyles(t,o,s)},styleSubtree:function(t,o){yi.flushCustomStyles(),yi.styleSubtree(t,o)},styleElement:function(t){yi.flushCustomStyles(),yi.styleElement(t)},styleDocument:function(t){yi.flushCustomStyles(),yi.styleDocument(t)},flushCustomStyles:function(){yi.flushCustomStyles()},getComputedStyleValue:function(t,o){return yi.getComputedStyleValue(t,o)},nativeCss:Tn,nativeShadow:Cn,cssBuild:cn,disableRuntime:kn},ci&&(window.ShadyCSS.ApplyShim=ci),vi&&(window.ShadyCSS.CustomStyleInterface=vi),function(t){function b(t){return""==t&&(f.call(this),this.m=!0),t.toLowerCase()}function c(t){var o=t.charCodeAt(0);return 32<o&&127>o&&-1==[34,35,60,62,63,96].indexOf(o)?t:encodeURIComponent(t)}function d(t){var o=t.charCodeAt(0);return 32<o&&127>o&&-1==[34,35,60,62,96].indexOf(o)?t:encodeURIComponent(t)}function e(t,o,s){var _=o||"scheme start",R=0,$="",B=!1,q=!1;e:for(;(null!=t[R-1]||0==R)&&!this.m;){var j=t[R];switch(_){case"scheme start":if(!j||!v.test(j)){if(o)break e;$="",_="no scheme";continue}$+=j.toLowerCase(),_="scheme";break;case"scheme":if(j&&m.test(j))$+=j.toLowerCase();else{if(":"!=j){if(o)break e;$="",R=0,_="no scheme";continue}if(this.l=$,$="",o)break e;void 0!==l[this.l]&&(this.H=!0),_="file"==this.l?"relative":this.H&&s&&s.l==this.l?"relative or authority":this.H?"authority first slash":"scheme data"}break;case"scheme data":"?"==j?(this.A="?",_="query"):"#"==j?(this.C="#",_="fragment"):null!=j&&"\t"!=j&&"\n"!=j&&"\r"!=j&&(this.ya+=c(j));break;case"no scheme":if(s&&void 0!==l[s.l]){_="relative";continue}f.call(this),this.m=!0;break;case"relative or authority":if("/"!=j||"/"!=t[R+1]){_="relative";continue}_="authority ignore slashes";break;case"relative":if(this.H=!0,"file"!=this.l&&(this.l=s.l),null==j){this.o=s.o,this.v=s.v,this.s=s.s.slice(),this.A=s.A,this.B=s.B,this.j=s.j;break e}if("/"==j||"\\"==j)_="relative slash";else if("?"==j)this.o=s.o,this.v=s.v,this.s=s.s.slice(),this.A="?",this.B=s.B,this.j=s.j,_="query";else{if("#"!=j){_=t[R+1];var z=t[R+2];("file"!=this.l||!v.test(j)||":"!=_&&"|"!=_||null!=z&&"/"!=z&&"\\"!=z&&"?"!=z&&"#"!=z)&&(this.o=s.o,this.v=s.v,this.B=s.B,this.j=s.j,this.s=s.s.slice(),this.s.pop()),_="relative path";continue}this.o=s.o,this.v=s.v,this.s=s.s.slice(),this.A=s.A,this.C="#",this.B=s.B,this.j=s.j,_="fragment"}break;case"relative slash":if("/"!=j&&"\\"!=j){"file"!=this.l&&(this.o=s.o,this.v=s.v,this.B=s.B,this.j=s.j),_="relative path";continue}_="file"==this.l?"file host":"authority ignore slashes";break;case"authority first slash":if("/"!=j){_="authority ignore slashes";continue}_="authority second slash";break;case"authority second slash":if(_="authority ignore slashes","/"!=j)continue;break;case"authority ignore slashes":if("/"!=j&&"\\"!=j){_="authority";continue}break;case"authority":if("@"==j){for(B&&($+="%40"),B=!0,j=0;j<$.length;j++)"\t"==(z=$[j])||"\n"==z||"\r"==z||(":"==z&&null===this.j?this.j="":(z=c(z),null!==this.j?this.j+=z:this.B+=z));$=""}else{if(null==j||"/"==j||"\\"==j||"?"==j||"#"==j){R-=$.length,$="",_="host";continue}$+=j}break;case"file host":if(null==j||"/"==j||"\\"==j||"?"==j||"#"==j){2!=$.length||!v.test($[0])||":"!=$[1]&&"|"!=$[1]?(0!=$.length&&(this.o=b.call(this,$),$=""),_="relative path start"):_="relative path";continue}"\t"==j||"\n"==j||"\r"==j||($+=j);break;case"host":case"hostname":if(":"!=j||q){if(null==j||"/"==j||"\\"==j||"?"==j||"#"==j){if(this.o=b.call(this,$),$="",_="relative path start",o)break e;continue}"\t"!=j&&"\n"!=j&&"\r"!=j&&("["==j?q=!0:"]"==j&&(q=!1),$+=j)}else if(this.o=b.call(this,$),$="",_="port","hostname"==o)break e;break;case"port":if(/[0-9]/.test(j))$+=j;else{if(null==j||"/"==j||"\\"==j||"?"==j||"#"==j||o){if(""!=$&&(($=parseInt($,10))!=l[this.l]&&(this.v=$+""),$=""),o)break e;_="relative path start";continue}"\t"==j||"\n"==j||"\r"==j||(f.call(this),this.m=!0)}break;case"relative path start":if(_="relative path","/"!=j&&"\\"!=j)continue;break;case"relative path":null!=j&&"/"!=j&&"\\"!=j&&(o||"?"!=j&&"#"!=j)?"\t"!=j&&"\n"!=j&&"\r"!=j&&($+=c(j)):((z=h[$.toLowerCase()])&&($=z),".."==$?(this.s.pop(),"/"!=j&&"\\"!=j&&this.s.push("")):"."==$&&"/"!=j&&"\\"!=j?this.s.push(""):"."!=$&&("file"==this.l&&0==this.s.length&&2==$.length&&v.test($[0])&&"|"==$[1]&&($=$[0]+":"),this.s.push($)),$="","?"==j?(this.A="?",_="query"):"#"==j&&(this.C="#",_="fragment"));break;case"query":o||"#"!=j?null!=j&&"\t"!=j&&"\n"!=j&&"\r"!=j&&(this.A+=d(j)):(this.C="#",_="fragment");break;case"fragment":null!=j&&"\t"!=j&&"\n"!=j&&"\r"!=j&&(this.C+=j)}R++}}function f(){this.B=this.ya=this.l="",this.j=null,this.v=this.o="",this.s=[],this.C=this.A="",this.H=this.m=!1}function g(t,o){void 0===o||o instanceof g||(o=new g(String(o))),this.g=t,f.call(this),e.call(this,this.g.replace(/^[ \t\r\n\f]+|[ \t\r\n\f]+$/g,""),null,o)}var o=!1;try{var s=new URL("b","http://a");s.pathname="c%20d",o="http://a/c%20d"===s.href}catch(t){}if(!o){var l=Object.create(null);l.ftp=21,l.file=0,l.gopher=70,l.http=80,l.https=443,l.ws=80,l.wss=443;var h=Object.create(null);h["%2e"]=".",h[".%2e"]="..",h["%2e."]="..",h["%2e%2e"]="..";var v=/[a-zA-Z]/,m=/[a-zA-Z0-9+\-.]/;g.prototype={toString:function(){return this.href},get href(){if(this.m)return this.g;var t="";return""==this.B&&null==this.j||(t=this.B+(null!=this.j?":"+this.j:"")+"@"),this.protocol+(this.H?"//"+t+this.host:"")+this.pathname+this.A+this.C},set href(t){f.call(this),e.call(this,t)},get protocol(){return this.l+":"},set protocol(t){this.m||e.call(this,t+":","scheme start")},get host(){return this.m?"":this.v?this.o+":"+this.v:this.o},set host(t){!this.m&&this.H&&e.call(this,t,"host")},get hostname(){return this.o},set hostname(t){!this.m&&this.H&&e.call(this,t,"hostname")},get port(){return this.v},set port(t){!this.m&&this.H&&e.call(this,t,"port")},get pathname(){return this.m?"":this.H?"/"+this.s.join("/"):this.ya},set pathname(t){!this.m&&this.H&&(this.s=[],e.call(this,t,"relative path start"))},get search(){return this.m||!this.A||"?"==this.A?"":this.A},set search(t){!this.m&&this.H&&(this.A="?","?"==t[0]&&(t=t.slice(1)),e.call(this,t,"query"))},get hash(){return this.m||!this.C||"#"==this.C?"":this.C},set hash(t){this.m||(t?(this.C="#","#"==t[0]&&(t=t.slice(1)),e.call(this,t,"fragment")):this.C="")},get origin(){var t;if(this.m||!this.l)return"";switch(this.l){case"data":case"file":case"javascript":case"mailto":return"null"}return(t=this.host)?this.l+"://"+t:""}};var _=t.URL;_&&(g.createObjectURL=function(t){return _.createObjectURL.apply(_,arguments)},g.revokeObjectURL=function(t){_.revokeObjectURL(t)}),t.URL=g}}(window);var _i=window.customElements,ki=!1,xi=null;function Fj(){window.HTMLTemplateElement.bootstrap&&window.HTMLTemplateElement.bootstrap(window.document),xi&&xi(),ki=!0,window.WebComponents.ready=!0,document.dispatchEvent(new CustomEvent("WebComponentsReady",{bubbles:!0}))}_i.polyfillWrapFlushCallback&&_i.polyfillWrapFlushCallback((function(t){xi=t,ki&&t()})),"complete"!==document.readyState?(window.addEventListener("load",Fj),window.addEventListener("DOMContentLoaded",(function(){window.removeEventListener("load",Fj),Fj()}))):Fj()}.call(t);class BatchResponse{}const UE=new Set,HE="https://graph.microsoft.com";function __decorate$z(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m}function __awaiter$K(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))}var BE;[HE,"https://graph.microsoft.us","https://dod-graph.microsoft.us","https://graph.microsoft.de","https://microsoftgraph.chinacloudapi.cn"].forEach((t=>UE.add(t))),function(t){t.GET="GET",t.PATCH="PATCH",t.POST="POST",t.PUT="PUT",t.DELETE="DELETE"}(BE||(BE={}));class BatchRequestContent{constructor(t){if(this.requests=new Map,void 0!==t){const o=BatchRequestContent.requestLimit;if(t.length>o){const t=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${o}`);throw t.name="Limit Exceeded Error",t}for(const o of t)this.addRequest(o)}}static validateDependencies(t){if(0===t.size){const t=new Error("Empty requests map, Please provide at least one request.");throw t.name="Empty Requests Error",t}return(t=>{const o=t.entries();let s=o.next();for(;!s.done;){const t=s.value[1];if(void 0!==t.dependsOn&&t.dependsOn.length>0)return!1;s=o.next()}return!0})(t)||(t=>{const o=t.entries();let s=o.next();const l=s.value[1];if(void 0!==l.dependsOn&&l.dependsOn.length>0)return!1;let h=s;for(s=o.next();!s.done;){const t=s.value[1];if(void 0===t.dependsOn||1!==t.dependsOn.length||t.dependsOn[0]!==h.value[1].id)return!1;h=s,s=o.next()}return!0})(t)||(t=>{const o=t.entries();let s=o.next();const l=s.value[1];let h;if(void 0===l.dependsOn||0===l.dependsOn.length)h=l.id;else{if(1!==l.dependsOn.length)return!1;{const o=l.dependsOn[0];if(o===l.id||!t.has(o))return!1;h=o}}for(s=o.next();!s.done;){const t=s.value[1];if((void 0===t.dependsOn||0===t.dependsOn.length)&&h!==t.id)return!1;if(void 0!==t.dependsOn&&0!==t.dependsOn.length){if(1===t.dependsOn.length&&(t.id===h||t.dependsOn[0]!==h))return!1;if(t.dependsOn.length>1)return!1}s=o.next()}return!0})(t)}static getRequestData(t){return __awaiter$K(this,void 0,void 0,(function*(){const o={url:""},s=new RegExp("^https?://");o.url=s.test(t.url)?"/"+t.url.split(/.*?\/\/.*?\//)[1]:t.url,o.method=t.method;const l={};return t.headers.forEach(((t,o)=>{l[o]=t})),Object.keys(l).length&&(o.headers=l),t.method!==BE.PATCH&&t.method!==BE.POST&&t.method!==BE.PUT||(o.body=yield BatchRequestContent.getRequestBody(t)),o}))}static getRequestBody(t){return __awaiter$K(this,void 0,void 0,(function*(){let o,s=!1;try{const l=t.clone();o=yield l.json(),s=!0}catch(t){}if(!s)try{if("undefined"!=typeof Blob){const s=yield t.blob(),l=new FileReader;o=yield new Promise((t=>{l.addEventListener("load",(()=>{const o=l.result,s=new RegExp("^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$").exec(o);t(s[4])}),!1),l.readAsDataURL(s)}))}else if("undefined"!=typeof Buffer){o=(yield t.buffer()).toString("base64")}s=!0}catch(t){}return o}))}addRequest(t){const o=BatchRequestContent.requestLimit;if(""===t.id){const t=new Error("Id for a request is empty, Please provide an unique id");throw t.name="Empty Id For Request",t}if(this.requests.size===o){const t=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${o}`);throw t.name="Limit Exceeded Error",t}if(this.requests.has(t.id)){const o=new Error(`Adding request with duplicate id ${t.id}, Make the id of the requests unique`);throw o.name="Duplicate RequestId Error",o}return this.requests.set(t.id,t),t.id}removeRequest(t){const o=this.requests.delete(t),s=this.requests.entries();let l=s.next();for(;!l.done;){const o=l.value[1].dependsOn;if(void 0!==o){const s=o.indexOf(t);-1!==s&&o.splice(s,1),0===o.length&&delete l.value[1].dependsOn}l=s.next()}return o}getContent(){return __awaiter$K(this,void 0,void 0,(function*(){const t=[],o={requests:t},s=this.requests.entries();let l=s.next();if(l.done){const t=new Error("No requests added yet, Please add at least one request.");throw t.name="Empty Payload",t}if(!BatchRequestContent.validateDependencies(this.requests)){const t=new Error("Invalid dependency found, Dependency should be:\n1. Parallel - no individual request states a dependency in the dependsOn property.\n2. Serial - all individual requests depend on the previous individual request.\n3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.");throw t.name="Invalid Dependency",t}for(;!l.done;){const o=l.value[1],h=yield BatchRequestContent.getRequestData(o.request);if(void 0!==h.body&&(void 0===h.headers||void 0===h.headers["content-type"])){const t=new Error(`Content-type header is not mentioned for request #${o.id}, For request having body, Content-type header should be mentioned`);throw t.name="Invalid Content-type header",t}h.id=o.id,void 0!==o.dependsOn&&o.dependsOn.length>0&&(h.dependsOn=o.dependsOn),t.push(h),l=s.next()}return o.requests=t,o}))}addDependency(t,o){if(!this.requests.has(t)){const o=new Error(`Dependent ${t} does not exists, Please check the id`);throw o.name="Invalid Dependent",o}if(void 0!==o&&!this.requests.has(o)){const t=new Error(`Dependency ${o} does not exists, Please check the id`);throw t.name="Invalid Dependency",t}if(void 0!==o){const s=this.requests.get(t);if(void 0===s.dependsOn&&(s.dependsOn=[]),-1!==s.dependsOn.indexOf(o)){const s=new Error(`Dependency ${o} is already added for the request ${t}`);throw s.name="Duplicate Dependency",s}s.dependsOn.push(o)}else{const s=this.requests.entries();let l,h=s.next();for(;!h.done&&h.value[1].id!==t;)l=h,h=s.next();if(void 0===l){const t=new Error(`Can't add dependency ${o}, There is only a dependent request in the batch`);throw t.name="Invalid Dependency Addition",t}{const o=l.value[0];if(void 0===h.value[1].dependsOn&&(h.value[1].dependsOn=[]),-1!==h.value[1].dependsOn.indexOf(o)){const s=new Error(`Dependency ${o} is already added for the request ${t}`);throw s.name="Duplicate Dependency",s}h.value[1].dependsOn.push(o)}}}removeDependency(t,o){const s=this.requests.get(t);if(void 0===s||void 0===s.dependsOn||0===s.dependsOn.length)return!1;if(void 0!==o){const t=s.dependsOn.indexOf(o);return-1!==t&&(s.dependsOn.splice(t,1),!0)}return delete s.dependsOn,!0}}BatchRequestContent.requestLimit=20;const qE=new Set(["graph.microsoft.com","graph.microsoft.us","dod-graph.microsoft.us","graph.microsoft.de","microsoftgraph.chinacloudapi.cn","canary.graph.microsoft.com"]);class GraphClientError extends Error{constructor(t){super(t),Object.setPrototypeOf(this,GraphClientError.prototype)}static setGraphClientError(t){let o;return t instanceof Error?o=t:(o=new GraphClientError,o.customError=t),o}}const jE=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],serializeContent=t=>{const o=t&&t.constructor&&t.constructor.name;if("Buffer"===o||"Blob"===o||"File"===o||"FormData"===o||"string"==typeof t)return t;if("ArrayBuffer"===o)t=Buffer.from(t);else if("Int8Array"===o||"Int16Array"===o||"Int32Array"===o||"Uint8Array"===o||"Uint16Array"===o||"Uint32Array"===o||"Uint8ClampedArray"===o||"Float32Array"===o||"Float64Array"===o||"DataView"===o)t=Buffer.from(t.buffer);else try{t=JSON.stringify(t)}catch(t){throw new Error("Unable to stringify the content")}return t},isGraphURL=t=>isValidEndpoint(t),isCustomHost=(t,o)=>(o.forEach((t=>isCustomHostValid(t))),isValidEndpoint(t,o)),isValidEndpoint=(t,o=qE)=>{if(-1!==(t=t.toLowerCase()).indexOf("https://")){const s=(t=t.replace("https://","")).indexOf(":"),l=t.indexOf("/");let h="";if(-1!==l)return-1!==s&&s<l?(h=t.substring(0,s),o.has(h)):(h=t.substring(0,l),o.has(h))}return!1},isCustomHostValid=t=>{if(-1!==t.indexOf("/"))throw new GraphClientError("Please add only hosts or hostnames to the CustomHosts config. If the url is `http://example.com:3000/`, host is `example:3000`")};class MiddlewareControl{constructor(t=[]){this.middlewareOptions=new Map;for(const o of t){const t=o.constructor;this.middlewareOptions.set(t,o)}}getMiddlewareOptions(t){return this.middlewareOptions.get(t)}setMiddlewareOptions(t,o){this.middlewareOptions.set(t,o)}}const getRequestHeader=(t,o,s)=>{let l=null;if("undefined"!=typeof Request&&t instanceof Request)l=t.headers.get(s);else if(void 0!==o&&void 0!==o.headers)if("undefined"!=typeof Headers&&o.headers instanceof Headers)l=o.headers.get(s);else if(o.headers instanceof Array){const t=o.headers;for(let o=0,h=t.length;o<h;o++)if(t[o][0]===s){l=t[o][1];break}}else void 0!==o.headers[s]&&(l=o.headers[s]);return l},setRequestHeader=(t,o,s,l)=>{if("undefined"!=typeof Request&&t instanceof Request)t.headers.set(s,l);else if(void 0!==o)if(void 0===o.headers)o.headers=new Headers({[s]:l});else if("undefined"!=typeof Headers&&o.headers instanceof Headers)o.headers.set(s,l);else if(o.headers instanceof Array){let t=0;const h=o.headers.length;for(;t<h;t++){const h=o.headers[t];if(h[0]===s){h[1]=l;break}}t===h&&o.headers.push([s,l])}else Object.assign(o.headers,{[s]:l})},appendRequestHeader=(t,o,s,l)=>{"undefined"!=typeof Request&&t instanceof Request?t.headers.append(s,l):void 0!==o&&(void 0===o.headers?o.headers=new Headers({[s]:l}):"undefined"!=typeof Headers&&o.headers instanceof Headers?o.headers.append(s,l):o.headers instanceof Array?o.headers.push([s,l]):void 0===o.headers?o.headers={[s]:l}:void 0===o.headers[s]?o.headers[s]=l:o.headers[s]+=`, ${l}`)};class AuthenticationHandlerOptions{constructor(t,o){this.authenticationProvider=t,this.authenticationProviderOptions=o}}var zE;!function(t){t[t.NONE=0]="NONE",t[t.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",t[t.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",t[t.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"}(zE||(zE={}));class TelemetryHandlerOptions{constructor(){this.featureUsage=zE.NONE}static updateFeatureUsageFlag(t,o){let s;t.middlewareControl instanceof MiddlewareControl?s=t.middlewareControl.getMiddlewareOptions(TelemetryHandlerOptions):t.middlewareControl=new MiddlewareControl,void 0===s&&(s=new TelemetryHandlerOptions,t.middlewareControl.setMiddlewareOptions(TelemetryHandlerOptions,s)),s.setFeatureUsage(o)}setFeatureUsage(t){this.featureUsage=this.featureUsage|t}getFeatureUsage(){return this.featureUsage.toString(16)}}class AuthenticationHandler{constructor(t){this.authenticationProvider=t}execute(t){return __awaiter$K(this,void 0,void 0,(function*(){const o="string"==typeof t.request?t.request:t.request.url;if(isGraphURL(o)||t.customHosts&&isCustomHost(o,t.customHosts)){let o,s,l;t.middlewareControl instanceof MiddlewareControl&&(o=t.middlewareControl.getMiddlewareOptions(AuthenticationHandlerOptions)),o&&(s=o.authenticationProvider,l=o.authenticationProviderOptions),s||(s=this.authenticationProvider);const h=`Bearer ${yield s.getAccessToken(l)}`;appendRequestHeader(t.request,t.options,AuthenticationHandler.AUTHORIZATION_HEADER,h),TelemetryHandlerOptions.updateFeatureUsageFlag(t,zE.AUTHENTICATION_HANDLER_ENABLED)}else t.options.headers&&delete t.options.headers[AuthenticationHandler.AUTHORIZATION_HEADER];return yield this.nextMiddleware.execute(t)}))}setNext(t){this.nextMiddleware=t}}AuthenticationHandler.AUTHORIZATION_HEADER="Authorization";class HTTPMessageHandler{execute(t){return __awaiter$K(this,void 0,void 0,(function*(){t.response=yield fetch(t.request,t.options)}))}}class RetryHandlerOptions{constructor(t=RetryHandlerOptions.DEFAULT_DELAY,o=RetryHandlerOptions.DEFAULT_MAX_RETRIES,s=RetryHandlerOptions.defaultShouldRetry){if(t>RetryHandlerOptions.MAX_DELAY&&o>RetryHandlerOptions.MAX_MAX_RETRIES){const t=new Error(`Delay and MaxRetries should not be more than ${RetryHandlerOptions.MAX_DELAY} and ${RetryHandlerOptions.MAX_MAX_RETRIES}`);throw t.name="MaxLimitExceeded",t}if(t>RetryHandlerOptions.MAX_DELAY){const t=new Error(`Delay should not be more than ${RetryHandlerOptions.MAX_DELAY}`);throw t.name="MaxLimitExceeded",t}if(o>RetryHandlerOptions.MAX_MAX_RETRIES){const t=new Error(`MaxRetries should not be more than ${RetryHandlerOptions.MAX_MAX_RETRIES}`);throw t.name="MaxLimitExceeded",t}if(t<0&&o<0){const t=new Error("Delay and MaxRetries should not be negative");throw t.name="MinExpectationNotMet",t}if(t<0){const t=new Error("Delay should not be negative");throw t.name="MinExpectationNotMet",t}if(o<0){const t=new Error("MaxRetries should not be negative");throw t.name="MinExpectationNotMet",t}this.delay=Math.min(t,RetryHandlerOptions.MAX_DELAY),this.maxRetries=Math.min(o,RetryHandlerOptions.MAX_MAX_RETRIES),this.shouldRetry=s}getMaxDelay(){return RetryHandlerOptions.MAX_DELAY}}RetryHandlerOptions.DEFAULT_DELAY=3,RetryHandlerOptions.DEFAULT_MAX_RETRIES=3,RetryHandlerOptions.MAX_DELAY=180,RetryHandlerOptions.MAX_MAX_RETRIES=10,RetryHandlerOptions.defaultShouldRetry=()=>!0;class RetryHandler{constructor(t=new RetryHandlerOptions){this.options=t}isRetry(t){return-1!==RetryHandler.RETRY_STATUS_CODES.indexOf(t.status)}isBuffered(t,o){const s="string"==typeof t?o.method:t.method;if(s===BE.PUT||s===BE.PATCH||s===BE.POST){if("application/octet-stream"===getRequestHeader(t,o,"Content-Type"))return!1}return!0}getDelay(t,o,s){const getRandomness=()=>Number(Math.random().toFixed(3)),l=void 0!==t.headers?t.headers.get(RetryHandler.RETRY_AFTER_HEADER):null;let h;return h=null!==l?Number.isNaN(Number(l))?Math.round((new Date(l).getTime()-Date.now())/1e3):Number(l):o>=2?this.getExponentialBackOffTime(o)+s+getRandomness():s+getRandomness(),Math.min(h,this.options.getMaxDelay()+getRandomness())}getExponentialBackOffTime(t){return Math.round(.5*(Math.pow(2,t)-1))}sleep(t){return __awaiter$K(this,void 0,void 0,(function*(){const o=1e3*t;return new Promise((t=>setTimeout(t,o)))}))}getOptions(t){let o;return t.middlewareControl instanceof MiddlewareControl&&(o=t.middlewareControl.getMiddlewareOptions(this.options.constructor)),void 0===o&&(o=Object.assign(new RetryHandlerOptions,this.options)),o}executeWithRetry(t,o,s){return __awaiter$K(this,void 0,void 0,(function*(){if(yield this.nextMiddleware.execute(t),o<s.maxRetries&&this.isRetry(t.response)&&this.isBuffered(t.request,t.options)&&s.shouldRetry(s.delay,o,t.request,t.options,t.response)){++o,setRequestHeader(t.request,t.options,RetryHandler.RETRY_ATTEMPT_HEADER,o.toString());const l=this.getDelay(t.response,o,s.delay);return yield this.sleep(l),yield this.executeWithRetry(t,o,s)}}))}execute(t){return __awaiter$K(this,void 0,void 0,(function*(){const o=this.getOptions(t);return TelemetryHandlerOptions.updateFeatureUsageFlag(t,zE.RETRY_HANDLER_ENABLED),yield this.executeWithRetry(t,0,o)}))}setNext(t){this.nextMiddleware=t}}RetryHandler.RETRY_STATUS_CODES=[429,503,504],RetryHandler.RETRY_ATTEMPT_HEADER="Retry-Attempt",RetryHandler.RETRY_AFTER_HEADER="Retry-After";class RedirectHandlerOptions{constructor(t=RedirectHandlerOptions.DEFAULT_MAX_REDIRECTS,o=RedirectHandlerOptions.defaultShouldRedirect){if(t>RedirectHandlerOptions.MAX_MAX_REDIRECTS){const t=new Error(`MaxRedirects should not be more than ${RedirectHandlerOptions.MAX_MAX_REDIRECTS}`);throw t.name="MaxLimitExceeded",t}if(t<0){const t=new Error("MaxRedirects should not be negative");throw t.name="MinExpectationNotMet",t}this.maxRedirects=t,this.shouldRedirect=o}}RedirectHandlerOptions.DEFAULT_MAX_REDIRECTS=5,RedirectHandlerOptions.MAX_MAX_REDIRECTS=20,RedirectHandlerOptions.defaultShouldRedirect=()=>!0;class RedirectHandler$1{constructor(t=new RedirectHandlerOptions){this.options=t}isRedirect(t){return-1!==RedirectHandler$1.REDIRECT_STATUS_CODES.indexOf(t.status)}hasLocationHeader(t){return t.headers.has(RedirectHandler$1.LOCATION_HEADER)}getLocationHeader(t){return t.headers.get(RedirectHandler$1.LOCATION_HEADER)}isRelativeURL(t){return-1===t.indexOf("://")}shouldDropAuthorizationHeader(t,o){const s=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,l=s.exec(t);let h,v;null!==l&&(h=l[0]);const m=s.exec(o);return null!==m&&(v=m[0]),void 0!==h&&void 0!==v&&h!==v}updateRequestUrl(t,o){return __awaiter$K(this,void 0,void 0,(function*(){var s,l;o.request="string"==typeof o.request?t:yield(s=t,l=o.request,__awaiter$K(void 0,void 0,void 0,(function*(){const t=l.headers.get("Content-Type")?yield l.blob():yield Promise.resolve(void 0),{method:o,headers:h,referrer:v,referrerPolicy:m,mode:_,credentials:R,cache:$,redirect:B,integrity:q,keepalive:j,signal:z}=l;return new Request(s,{method:o,headers:h,body:t,referrer:v,referrerPolicy:m,mode:_,credentials:R,cache:$,redirect:B,integrity:q,keepalive:j,signal:z})})))}))}getOptions(t){let o;return t.middlewareControl instanceof MiddlewareControl&&(o=t.middlewareControl.getMiddlewareOptions(RedirectHandlerOptions)),void 0===o&&(o=Object.assign(new RedirectHandlerOptions,this.options)),o}executeWithRedirect(t,o,s){return __awaiter$K(this,void 0,void 0,(function*(){yield this.nextMiddleware.execute(t);const l=t.response;if(o<s.maxRedirects&&this.isRedirect(l)&&this.hasLocationHeader(l)&&s.shouldRedirect(l)){if(++o,l.status===RedirectHandler$1.STATUS_CODE_SEE_OTHER)t.options.method=BE.GET,delete t.options.body;else{const o=this.getLocationHeader(l);!this.isRelativeURL(o)&&this.shouldDropAuthorizationHeader(l.url,o)&&delete t.options.headers[RedirectHandler$1.AUTHORIZATION_HEADER],yield this.updateRequestUrl(o,t)}yield this.executeWithRedirect(t,o,s)}}))}execute(t){return __awaiter$K(this,void 0,void 0,(function*(){const o=this.getOptions(t);return t.options.redirect=RedirectHandler$1.MANUAL_REDIRECT,TelemetryHandlerOptions.updateFeatureUsageFlag(t,zE.REDIRECT_HANDLER_ENABLED),yield this.executeWithRedirect(t,0,o)}))}setNext(t){this.nextMiddleware=t}}RedirectHandler$1.REDIRECT_STATUS_CODES=[301,302,303,307,308],RedirectHandler$1.STATUS_CODE_SEE_OTHER=303,RedirectHandler$1.LOCATION_HEADER="Location",RedirectHandler$1.AUTHORIZATION_HEADER="Authorization",RedirectHandler$1.MANUAL_REDIRECT="manual";class TelemetryHandler{execute(t){return __awaiter$K(this,void 0,void 0,(function*(){const o="string"==typeof t.request?t.request:t.request.url;if(isGraphURL(o)||t.customHosts&&isCustomHost(o,t.customHosts)){let o=getRequestHeader(t.request,t.options,TelemetryHandler.CLIENT_REQUEST_ID_HEADER);o||(o=(()=>{let t="";for(let o=0;o<32;o++)8!==o&&12!==o&&16!==o&&20!==o||(t+="-"),t+=Math.floor(16*Math.random()).toString(16);return t})(),setRequestHeader(t.request,t.options,TelemetryHandler.CLIENT_REQUEST_ID_HEADER,o));let s,l=`${TelemetryHandler.PRODUCT_NAME}/3.0.2`;if(t.middlewareControl instanceof MiddlewareControl&&(s=t.middlewareControl.getMiddlewareOptions(TelemetryHandlerOptions)),s){const t=s.getFeatureUsage();l+=` (${TelemetryHandler.FEATURE_USAGE_STRING}=${t})`}appendRequestHeader(t.request,t.options,TelemetryHandler.SDK_VERSION_HEADER,l)}else delete t.options.headers[TelemetryHandler.CLIENT_REQUEST_ID_HEADER],delete t.options.headers[TelemetryHandler.SDK_VERSION_HEADER];return yield this.nextMiddleware.execute(t)}))}setNext(t){this.nextMiddleware=t}}var VE,GE,KE,WE,QE;TelemetryHandler.CLIENT_REQUEST_ID_HEADER="client-request-id",TelemetryHandler.SDK_VERSION_HEADER="SdkVersion",TelemetryHandler.PRODUCT_NAME="graph-js",TelemetryHandler.FEATURE_USAGE_STRING="featureUsage",function(t){t[t.MANUAL=0]="MANUAL",t[t.RANDOM=1]="RANDOM"}(VE||(VE={})),function(t){t.ARRAYBUFFER="arraybuffer",t.BLOB="blob",t.DOCUMENT="document",t.JSON="json",t.RAW="raw",t.STREAM="stream",t.TEXT="text"}(GE||(GE={})),function(t){t.TEXT_HTML="text/html",t.TEXT_XML="text/xml",t.APPLICATION_XML="application/xml",t.APPLICATION_XHTML="application/xhtml+xml"}(KE||(KE={})),function(t){t.TEXT_PLAIN="text/plain",t.APPLICATION_JSON="application/json"}(WE||(WE={})),function(t){t.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",t.IMAGE="^image\\/.+"}(QE||(QE={}));class GraphResponseHandler{static parseDocumentResponse(t,o){return"undefined"!=typeof DOMParser?new Promise(((s,l)=>{t.text().then((t=>{try{const l=(new DOMParser).parseFromString(t,o);s(l)}catch(t){l(t)}}))})):Promise.resolve(t.body)}static convertResponse(t,o){return __awaiter$K(this,void 0,void 0,(function*(){if(204===t.status)return Promise.resolve();let s;const l=t.headers.get("Content-type");switch(o){case GE.ARRAYBUFFER:s=yield t.arrayBuffer();break;case GE.BLOB:s=yield t.blob();break;case GE.DOCUMENT:s=yield GraphResponseHandler.parseDocumentResponse(t,KE.TEXT_XML);break;case GE.JSON:s=yield t.json();break;case GE.STREAM:s=yield Promise.resolve(t.body);break;case GE.TEXT:s=yield t.text();break;default:if(null!==l){const o=l.split(";")[0];s=new RegExp(QE.DOCUMENT).test(o)?yield GraphResponseHandler.parseDocumentResponse(t,o):new RegExp(QE.IMAGE).test(o)?t.blob():o===WE.TEXT_PLAIN?yield t.text():o===WE.APPLICATION_JSON?yield t.json():Promise.resolve(t.body)}else s=Promise.resolve(t.body)}return s}))}static getResponse(t,o,s){return __awaiter$K(this,void 0,void 0,(function*(){if(o===GE.RAW)return Promise.resolve(t);{const l=yield GraphResponseHandler.convertResponse(t,o);if(!t.ok)throw l;if("function"!=typeof s)return l;s(null,l)}}))}}class CustomAuthenticationProvider{constructor(t){this.provider=t}getAccessToken(){return __awaiter$K(this,void 0,void 0,(function*(){return new Promise(((t,o)=>{this.provider(((s,l)=>__awaiter$K(this,void 0,void 0,(function*(){if(l)t(l);else{if(!s){s=new GraphClientError("Access token is undefined or empty.\t\t\t\t\t\tPlease provide a valid token.\t\t\t\t\t\tFor more help - https://github.com/microsoftgraph/msgraph-sdk-javascript/blob/dev/docs/CustomAuthenticationProvider.md")}const t=yield GraphClientError.setGraphClientError(s);o(t)}}))))}))}))}}class GraphError extends Error{constructor(t=-1,o,s){super(o||s&&s.message),Object.setPrototypeOf(this,GraphError.prototype),this.statusCode=t,this.code=null,this.requestId=null,this.date=new Date,this.body=null,this.stack=s?s.stack:this.stack}}class GraphErrorHandler{static constructError(t,o){const s=new GraphError(o,"",t);return void 0!==t.name&&(s.code=t.name),s.body=t.toString(),s.date=new Date,s}static constructErrorFromResponse(t,o){const s=t.error,l=new GraphError(o,s.message);return l.code=s.code,void 0!==s.innerError&&(l.requestId=s.innerError["request-id"],l.date=new Date(s.innerError.date)),l.body=JSON.stringify(s),l}static getError(t=null,o=-1,s){return __awaiter$K(this,void 0,void 0,(function*(){let l;if(t&&t.error?l=GraphErrorHandler.constructErrorFromResponse(t,o):t instanceof Error?l=GraphErrorHandler.constructError(t,o):(l=new GraphError(o),l.body=t),"function"!=typeof s)return l;s(l,null)}))}}class GraphRequest{constructor(t,o,s){this.parsePath=t=>{if(-1!==t.indexOf("https://")){const o=(t=t.replace("https://","")).indexOf("/");-1!==o&&(this.urlComponents.host="https://"+t.substring(0,o),t=t.substring(o+1,t.length));const s=t.indexOf("/");-1!==s&&(this.urlComponents.version=t.substring(0,s),t=t.substring(s+1,t.length))}"/"===t.charAt(0)&&(t=t.substr(1));const o=t.indexOf("?");if(-1===o)this.urlComponents.path=t;else{this.urlComponents.path=t.substr(0,o);const s=t.substring(o+1,t.length).split("&");for(const t of s)this.parseQueryParameter(t)}},this.httpClient=t,this.config=o,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{},otherURLQueryOptions:[]},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(s)}addCsvQueryParameter(t,o,s){this.urlComponents.oDataQueryParams[t]=this.urlComponents.oDataQueryParams[t]?this.urlComponents.oDataQueryParams[t]+",":"";let l=[];s.length>1&&"string"==typeof o?l=Array.prototype.slice.call(s):"string"==typeof o?l.push(o):l=l.concat(o),this.urlComponents.oDataQueryParams[t]+=l.join(",")}buildFullUrl(){const t=(t=>{const removePostSlash=t=>t.replace(/\/+$/,""),removePreSlash=t=>t.replace(/^\/+/,"");return Array.prototype.slice.call(t).reduce(((t,o)=>[removePostSlash(t),removePreSlash(o)].join("/")))})([this.urlComponents.host,this.urlComponents.version,this.urlComponents.path])+this.createQueryString();return this.config.debugLogging&&console.log(t),t}createQueryString(){const t=this.urlComponents,o=[];if(0!==Object.keys(t.oDataQueryParams).length)for(const s in t.oDataQueryParams)Object.prototype.hasOwnProperty.call(t.oDataQueryParams,s)&&o.push(s+"="+t.oDataQueryParams[s]);if(0!==Object.keys(t.otherURLQueryParams).length)for(const s in t.otherURLQueryParams)Object.prototype.hasOwnProperty.call(t.otherURLQueryParams,s)&&o.push(s+"="+t.otherURLQueryParams[s]);if(0!==t.otherURLQueryOptions.length)for(const s of t.otherURLQueryOptions)o.push(s);return o.length>0?"?"+o.join("&"):""}parseQueryParameter(t){if("string"==typeof t)if("?"===t.charAt(0)&&(t=t.substring(1)),-1!==t.indexOf("&")){const o=t.split("&");for(const t of o)this.parseQueryParamenterString(t)}else this.parseQueryParamenterString(t);else if(t.constructor===Object)for(const o in t)Object.prototype.hasOwnProperty.call(t,o)&&this.setURLComponentsQueryParamater(o,t[o]);return this}parseQueryParamenterString(t){if(this.isValidQueryKeyValuePair(t)){const o=t.indexOf("="),s=t.substring(0,o),l=t.substring(o+1);this.setURLComponentsQueryParamater(s,l)}else this.urlComponents.otherURLQueryOptions.push(t)}setURLComponentsQueryParamater(t,o){if(-1!==jE.indexOf(t)){const s=this.urlComponents.oDataQueryParams[t],l=s&&("$expand"===t||"$select"===t||"$orderby"===t);this.urlComponents.oDataQueryParams[t]=l?s+","+o:o}else this.urlComponents.otherURLQueryParams[t]=o}isValidQueryKeyValuePair(t){const o=t.indexOf("=");if(-1===o)return!1;return!(-1!==t.indexOf("(")&&t.indexOf("(")<o)}updateRequestOptions(t){const o=Object.assign({},t.headers);if(void 0!==this.config.fetchOptions){const o=Object.assign({},this.config.fetchOptions);Object.assign(t,o),void 0!==typeof this.config.fetchOptions.headers&&(t.headers=Object.assign({},this.config.fetchOptions.headers))}Object.assign(t,this._options),void 0!==t.headers&&Object.assign(o,t.headers),Object.assign(o,this._headers),t.headers=o}send(t,o,s){var l;return __awaiter$K(this,void 0,void 0,(function*(){let h;const v=new MiddlewareControl(this._middlewareOptions);this.updateRequestOptions(o);const m=null===(l=this.config)||void 0===l?void 0:l.customHosts;try{h=(yield this.httpClient.sendRequest({request:t,options:o,middlewareControl:v,customHosts:m})).response;return yield GraphResponseHandler.getResponse(h,this._responseType,s)}catch(t){if(t instanceof GraphClientError)throw t;let o;h&&(o=h.status);throw yield GraphErrorHandler.getError(t,o,s)}}))}setHeaderContentType(){if(!this._headers)return void this.header("Content-Type","application/json");const t=Object.keys(this._headers);for(const o of t)if("content-type"===o.toLowerCase())return;this.header("Content-Type","application/json")}header(t,o){return this._headers[t]=o,this}headers(t){for(const o in t)Object.prototype.hasOwnProperty.call(t,o)&&(this._headers[o]=t[o]);return this}option(t,o){return this._options[t]=o,this}options(t){for(const o in t)Object.prototype.hasOwnProperty.call(t,o)&&(this._options[o]=t[o]);return this}middlewareOptions(t){return this._middlewareOptions=t,this}version(t){return this.urlComponents.version=t,this}responseType(t){return this._responseType=t,this}select(t){return this.addCsvQueryParameter("$select",t,arguments),this}expand(t){return this.addCsvQueryParameter("$expand",t,arguments),this}orderby(t){return this.addCsvQueryParameter("$orderby",t,arguments),this}filter(t){return this.urlComponents.oDataQueryParams.$filter=t,this}search(t){return this.urlComponents.oDataQueryParams.$search=t,this}top(t){return this.urlComponents.oDataQueryParams.$top=t,this}skip(t){return this.urlComponents.oDataQueryParams.$skip=t,this}skipToken(t){return this.urlComponents.oDataQueryParams.$skipToken=t,this}count(t=!0){return this.urlComponents.oDataQueryParams.$count=t.toString(),this}query(t){return this.parseQueryParameter(t)}get(t){return __awaiter$K(this,void 0,void 0,(function*(){const o=this.buildFullUrl(),s={method:BE.GET};return yield this.send(o,s,t)}))}post(t,o){return __awaiter$K(this,void 0,void 0,(function*(){const s=this.buildFullUrl(),l={method:BE.POST,body:serializeContent(t)};return"FormData"===(t&&t.constructor&&t.constructor.name)?l.headers={}:(this.setHeaderContentType(),l.headers=this._headers),yield this.send(s,l,o)}))}create(t,o){return __awaiter$K(this,void 0,void 0,(function*(){return yield this.post(t,o)}))}put(t,o){return __awaiter$K(this,void 0,void 0,(function*(){const s=this.buildFullUrl();this.setHeaderContentType();const l={method:BE.PUT,body:serializeContent(t)};return yield this.send(s,l,o)}))}patch(t,o){return __awaiter$K(this,void 0,void 0,(function*(){const s=this.buildFullUrl();this.setHeaderContentType();const l={method:BE.PATCH,body:serializeContent(t)};return yield this.send(s,l,o)}))}update(t,o){return __awaiter$K(this,void 0,void 0,(function*(){return yield this.patch(t,o)}))}delete(t){return __awaiter$K(this,void 0,void 0,(function*(){const o=this.buildFullUrl(),s={method:BE.DELETE};return yield this.send(o,s,t)}))}del(t){return __awaiter$K(this,void 0,void 0,(function*(){return yield this.delete(t)}))}getStream(t){return __awaiter$K(this,void 0,void 0,(function*(){const o=this.buildFullUrl(),s={method:BE.GET};return this.responseType(GE.STREAM),yield this.send(o,s,t)}))}putStream(t,o){return __awaiter$K(this,void 0,void 0,(function*(){const s=this.buildFullUrl(),l={method:BE.PUT,headers:{"Content-Type":"application/octet-stream"},body:t};return yield this.send(s,l,o)}))}}class HTTPClient{constructor(...t){if(!t||!t.length){const t=new Error;throw t.name="InvalidMiddlewareChain",t.message="Please provide a default middleware chain or custom middleware chain",t}this.setMiddleware(...t)}setMiddleware(...t){t.length>1?this.parseMiddleWareArray(t):this.middleware=t[0]}parseMiddleWareArray(t){t.forEach(((o,s)=>{s<t.length-1&&o.setNext(t[s+1])})),this.middleware=t[0]}sendRequest(t){return __awaiter$K(this,void 0,void 0,(function*(){if("string"==typeof t.request&&void 0===t.options){const t=new Error;throw t.name="InvalidRequestOptions",t.message="Unable to execute the middleware, Please provide valid options for a request",t}return yield this.middleware.execute(t),t}))}}class HTTPClientFactory{static createWithAuthenticationProvider(t){const o=new AuthenticationHandler(t),s=new RetryHandler(new RetryHandlerOptions),l=new TelemetryHandler,h=new HTTPMessageHandler;if(o.setNext(s),"object"==typeof process&&"function"==typeof require){const t=new RedirectHandler$1(new RedirectHandlerOptions);s.setNext(t),t.setNext(l)}else s.setNext(l);return l.setNext(h),HTTPClientFactory.createWithMiddleware(o)}static createWithMiddleware(...t){return new HTTPClient(...t)}}class Client{constructor(t){this.config={baseUrl:"https://graph.microsoft.com/",debugLogging:!1,defaultVersion:"v1.0"},(()=>{if("undefined"==typeof Promise&&"undefined"==typeof fetch){const t=new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw t.name="PolyFillNotAvailable",t}if("undefined"==typeof Promise){const t=new Error("Library cannot function without Promise. So, please provide polyfill for it.");throw t.name="PolyFillNotAvailable",t}if("undefined"==typeof fetch){const t=new Error("Library cannot function without fetch. So, please provide polyfill for it.");throw t.name="PolyFillNotAvailable",t}})();for(const o in t)Object.prototype.hasOwnProperty.call(t,o)&&(this.config[o]=t[o]);let o;if(void 0!==t.authProvider&&void 0!==t.middleware){const t=new Error;throw t.name="AmbiguityInInitialization",t.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",t}if(void 0!==t.authProvider)o=HTTPClientFactory.createWithAuthenticationProvider(t.authProvider);else{if(void 0===t.middleware){const t=new Error;throw t.name="InvalidMiddlewareChain",t.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",t}o=new HTTPClient(...[].concat(t.middleware))}this.httpClient=o}static init(t){const o={};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(o[s]="authProvider"===s?new CustomAuthenticationProvider(t[s]):t[s]);return Client.initWithMiddleware(o)}static initWithMiddleware(t){return new Client(t)}api(t){return new GraphRequest(this.httpClient,this.config,t)}}class EventDispatcher{constructor(){this.eventHandlers=[]}fire(t){for(const o of this.eventHandlers)o(t)}add(t){this.eventHandlers.push(t)}remove(t){for(let o=0;o<this.eventHandlers.length;o++)this.eventHandlers[o]===t&&(this.eventHandlers.splice(o,1),o--)}}class IProvider{get isMultiAccountSupportedAndEnabled(){return!1}set baseURL(t){if(!validateBaseURL(t))throw new Error(`${t} is not a valid Graph URL endpoint.`);this._baseURL=t}get baseURL(){return this._baseURL}get isMultiAccountSupported(){return this.isMultipleAccountSupported}get state(){return this._state}get isIncrementalConsentDisabled(){return this._isIncrementalConsentDisabled}set isIncrementalConsentDisabled(t){this._isIncrementalConsentDisabled=t}get name(){return"MgtIProvider"}constructor(){this.isMultipleAccountDisabled=!0,this._loginChangedDispatcher=new EventDispatcher,this._activeAccountChangedDispatcher=new EventDispatcher,this._baseURL=HE,this._isIncrementalConsentDisabled=!1,this.isMultipleAccountSupported=!1,this._state=exports.ProviderState.Loading}setState(t){t!==this._state&&(this._state=t,this._loginChangedDispatcher.fire({}))}onStateChanged(t){this._loginChangedDispatcher.add(t)}removeStateChangedHandler(t){this._loginChangedDispatcher.remove(t)}setActiveAccount(t){this.fireActiveAccountChanged()}onActiveAccountChanged(t){this._activeAccountChangedDispatcher.add(t)}removeActiveAccountChangedHandler(t){this._activeAccountChangedDispatcher.remove(t)}fireActiveAccountChanged(){this._activeAccountChangedDispatcher.fire({})}getAccessTokenForScopes(...t){return this.getAccessToken({scopes:t})}}var YE,JE;exports.LoginType=void 0,(YE=exports.LoginType||(exports.LoginType={}))[YE.Popup=0]="Popup",YE[YE.Redirect=1]="Redirect",exports.ProviderState=void 0,(JE=exports.ProviderState||(exports.ProviderState={}))[JE.Loading=0]="Loading",JE[JE.SignedOut=1]="SignedOut",JE[JE.SignedIn=2]="SignedIn";var XE,__awaiter$J=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};class Providers{static get globalProvider(){return this._globalProvider}static set globalProvider(t){t!==this._globalProvider&&(this._globalProvider&&(this._globalProvider.removeStateChangedHandler(this.handleProviderStateChanged),this._globalProvider.isMultiAccountSupportedAndEnabled&&this._globalProvider.removeActiveAccountChangedHandler(this.handleActiveAccountChanged)),t&&(t.onStateChanged(this.handleProviderStateChanged),t.isMultiAccountSupportedAndEnabled&&t.onActiveAccountChanged(this.handleActiveAccountChanged)),this._globalProvider=t,this._eventDispatcher.fire(exports.ProvidersChangedState.ProviderChanged))}static onProviderUpdated(t){this._eventDispatcher.add(t)}static removeProviderUpdatedListener(t){this._eventDispatcher.remove(t)}static onActiveAccountChanged(t){this._activeAccountChangedDispatcher.add(t)}static removeActiveAccountChangedListener(t){this._activeAccountChangedDispatcher.remove(t)}static me(){return this.client?(this._mePromise||(this._mePromise=this.getMe()),this._mePromise):(this._mePromise=null,null)}static getMe(){return __awaiter$J(this,void 0,void 0,(function*(){try{const t=yield this.client.api("me").get();if(t&&t.id)return t}catch(t){}return null}))}static getCacheId(){return __awaiter$J(this,void 0,void 0,(function*(){if(this._cacheId)return this._cacheId;if(Providers.globalProvider&&Providers.globalProvider.state==exports.ProviderState.SignedIn&&!this._cacheId){if(this.client)try{this._cacheId=yield this.createCacheId()}catch(t){}}return this._cacheId}))}static unsetCacheId(){this._cacheId=null,this._mePromise=null}static createCacheId(){return __awaiter$J(this,void 0,void 0,(function*(){if(Providers.globalProvider.isMultiAccountSupportedAndEnabled){const t=this.createCacheIdWithAccountDetails();if(t)return t}return yield this.createCacheIdWithUserDetails()}))}static createCacheIdWithUserDetails(){return __awaiter$J(this,void 0,void 0,(function*(){const t=yield this.me();return t&&t.id?t.id+"-"+t.userPrincipalName:null}))}static createCacheIdWithAccountDetails(){const t=Providers.globalProvider.getActiveAccount();return t.tenantId&&t.id?t.tenantId+t.id:null}static get client(){return Providers.globalProvider&&Providers.globalProvider.state===exports.ProviderState.SignedIn?Providers.globalProvider.graph.client:null}static handleProviderStateChanged(){Providers.globalProvider&&Providers.globalProvider.state===exports.ProviderState.SignedIn||(Providers._mePromise=null),Providers._eventDispatcher.fire(exports.ProvidersChangedState.ProviderStateChanged)}static handleActiveAccountChanged(){Providers.unsetCacheId(),Providers._activeAccountChangedDispatcher.fire(null)}}function prepScopes(...t){const o={scopes:t};return Providers.globalProvider.isIncrementalConsentDisabled?[]:[new AuthenticationHandlerOptions(void 0,o)]}function chainMiddleware(...t){const o=t[0];let s=o;for(let o=1;o<t.length;++o){const l=t[o];s.setNext&&s.setNext(l),s=l}return o}function validateBaseURL(t){try{const o=new URL(t).origin;if(UE.has(o))return o}catch(t){return}}Providers._eventDispatcher=new EventDispatcher,Providers._activeAccountChangedDispatcher=new EventDispatcher,exports.ProvidersChangedState=void 0,(XE=exports.ProvidersChangedState||(exports.ProvidersChangedState={}))[XE.ProviderChanged=0]="ProviderChanged",XE[XE.ProviderStateChanged=1]="ProviderStateChanged";var __awaiter$I=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};class BatchRequest{constructor(t,o,s,l){"/"!==s.charAt(0)&&(s="/"+s),this.resource=s,this.method=l,this.index=t,this.id=o}}class Batch{constructor(t){this.graph=t,this.allRequests=[],this.requestsQueue=[],this.scopes=[],this.nextIndex=0,this.retryAfter=0}get hasRequests(){return this.requestsQueue.length>0}get(t,o,s,l){const h=this.nextIndex++,v=new BatchRequest(h,t,o,"GET");v.headers=l,this.allRequests.push(v),this.requestsQueue.push(h),s&&(this.scopes=this.scopes.concat(s))}executeNext(){return __awaiter$I(this,void 0,void 0,(function*(){const t=new Map;var o;if(this.retryAfter&&(yield(o=1e3*this.retryAfter,new Promise((t=>{setTimeout(t,o)}))),this.retryAfter=0),!this.hasRequests)return t;const s=this.requestsQueue.splice(0,20),l=new BatchRequestContent;for(const t of s.map((t=>this.allRequests[t])))l.addRequest({id:t.index.toString(),request:new Request(Batch.baseUrl+t.resource,{method:t.method,headers:t.headers})});const h=this.scopes.length?prepScopes(...this.scopes):[],v=this.graph.api("$batch").middlewareOptions(h),m=yield l.getContent(),_=yield v.post(m);for(const o of _.responses){const s=new BatchResponse,l=this.allRequests[o.id];s.id=l.id,s.index=l.index,s.headers=o.headers,200===o.status?(o.headers["Content-Type"].includes("image/jpeg")?s.content="data:image/jpeg;base64,"+o.body:o.headers["Content-Type"].includes("image/pjpeg")?s.content="data:image/pjpeg;base64,"+o.body:o.headers["Content-Type"].includes("image/png")?s.content="data:image/png;base64,"+o.body:s.content=o.body,t.set(l.id,s)):429===o.status&&(this.requestsQueue.unshift(o.id),this.retryAfter=Math.max(this.retryAfter,parseInt(o.headers["Retry-After"],10)||1))}return t}))}executeAll(){return __awaiter$I(this,void 0,void 0,(function*(){const t=new Map;for(;this.hasRequests;){const o=yield this.executeNext();for(const[s,l]of o)t.set(s,l)}return t}))}}Batch.baseUrl="https://graph.microsoft.com";class ComponentMiddlewareOptions{constructor(t){this.componentName="string"==typeof t?t:t.tagName.toLowerCase()}}var __awaiter$H=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};class SdkVersionMiddleware{constructor(t,o){this._packageVersion=t,this._providerName=o}execute(t){var o;return __awaiter$H(this,void 0,void 0,(function*(){try{if("string"==typeof t.request)if(validateBaseURL(t.request)){const o=[],s=t.middlewareControl.getMiddlewareOptions(ComponentMiddlewareOptions);if(s){const t=`${s.componentName}/${this._packageVersion}`;o.push(t)}if(this._providerName){const t=`${this._providerName}/${this._packageVersion}`;o.push(t)}const l=`mgt/${this._packageVersion}`;o.push(l),o.push(getRequestHeader(t.request,t.options,"SdkVersion"));const h=o.join(", ");setRequestHeader(t.request,t.options,"SdkVersion",h)}else null===(o=null==t?void 0:t.options)||void 0===o||delete o.headers.SdkVersion}catch(t){}return yield this._nextMiddleware.execute(t)}))}setNext(t){this._nextMiddleware=t}}const ZE="3.0.0-preview.1-next.mgt-chat.97255fa";const eI=new class CustomElementHelper{constructor(){this.defaultPrefix="mgt",this._disambiguation=""}withDisambiguation(t){return t&&!this._disambiguation&&(this._disambiguation=t),this}get prefix(){return this._disambiguation?`${this.defaultPrefix}-${this._disambiguation}`:this.defaultPrefix}get disambiguation(){return this._disambiguation}get isDisambiguated(){return Boolean(this._disambiguation)}normalize(t){return this.isDisambiguated?t.toUpperCase().replace(this.prefix.toUpperCase(),this.defaultPrefix.toUpperCase()):t}};class Graph{get client(){return this._client}get componentName(){return this._componentName}get version(){return this._version}constructor(t,o="v1.0"){this._client=t,this._version=o}forComponent(t){const o=new Graph(this._client,this._version);return o.setComponent(t),o}api(t){let o=this._client.api(t).version(this._version);return this._componentName&&(o.middlewareOptions=t=>{const s=o;return s._middlewareOptions=s._middlewareOptions.concat(t),o},o=o.middlewareOptions([new ComponentMiddlewareOptions(this._componentName)])),o}createBatch(){return new Batch(this)}setComponent(t){this._componentName=t instanceof Element?eI.normalize(t.tagName):t}}function createFromProvider(t,o,s){const l=[new AuthenticationHandler(t),new RetryHandler(new RetryHandlerOptions),new TelemetryHandler,new SdkVersionMiddleware(ZE,t.name),new HTTPMessageHandler];let h=t.baseURL?t.baseURL:HE;const v=Client.initWithMiddleware({middleware:chainMiddleware(...l),baseUrl:h}),m=new Graph(v,o);return s?m.forComponent(s):m}class BetaGraph extends Graph{static fromGraph(t){const o=new BetaGraph(t.client);return o.setComponent(t.componentName),o}constructor(t,o="beta"){super(t,o)}forComponent(t){const o=new BetaGraph(this.client);return this.setComponent(t),o}}
/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const tI=window,rI=tI.ShadowRoot&&(void 0===tI.ShadyCSS||tI.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,oI=Symbol(),nI=new WeakMap;class o$5{constructor(t,o,s){if(this._$cssResult$=!0,s!==oI)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t,this.t=o}get styleSheet(){let t=this.o;const o=this.t;if(rI&&void 0===t){const s=void 0!==o&&1===o.length;s&&(t=nI.get(o)),void 0===t&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),s&&nI.set(o,t))}return t}toString(){return this.cssText}}const i$4=(t,...o)=>{const s=1===t.length?t[0]:o.reduce(((o,s,l)=>o+(t=>{if(!0===t._$cssResult$)return t.cssText;if("number"==typeof t)return t;throw Error("Value passed to 'css' function must be a 'css' function result: "+t+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(s)+t[l+1]),t[0]);return new o$5(s,t,oI)},iI=rI?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let o="";for(const s of t.cssRules)o+=s.cssText;return(t=>new o$5("string"==typeof t?t:t+"",void 0,oI))(o)})(t):t
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */;var sI;const aI=window,lI=aI.trustedTypes,cI=lI?lI.emptyScript:"",dI=aI.reactiveElementPolyfillSupport,uI={toAttribute(t,o){switch(o){case Boolean:t=t?cI:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,o){let s=t;switch(o){case Boolean:s=null!==t;break;case Number:s=null===t?null:Number(t);break;case Object:case Array:try{s=JSON.parse(t)}catch(t){s=null}}return s}},a$2=(t,o)=>o!==t&&(o==o||t==t),hI={attribute:!0,type:String,converter:uI,reflect:!1,hasChanged:a$2};class d$2 extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this.u()}static addInitializer(t){var o;this.finalize(),(null!==(o=this.h)&&void 0!==o?o:this.h=[]).push(t)}static get observedAttributes(){this.finalize();const t=[];return this.elementProperties.forEach(((o,s)=>{const l=this._$Ep(s,o);void 0!==l&&(this._$Ev.set(l,s),t.push(l))})),t}static createProperty(t,o=hI){if(o.state&&(o.attribute=!1),this.finalize(),this.elementProperties.set(t,o),!o.noAccessor&&!this.prototype.hasOwnProperty(t)){const s="symbol"==typeof t?Symbol():"__"+t,l=this.getPropertyDescriptor(t,s,o);void 0!==l&&Object.defineProperty(this.prototype,t,l)}}static getPropertyDescriptor(t,o,s){return{get(){return this[o]},set(l){const h=this[t];this[o]=l,this.requestUpdate(t,h,s)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)||hI}static finalize(){if(this.hasOwnProperty("finalized"))return!1;this.finalized=!0;const t=Object.getPrototypeOf(this);if(t.finalize(),void 0!==t.h&&(this.h=[...t.h]),this.elementProperties=new Map(t.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const t=this.properties,o=[...Object.getOwnPropertyNames(t),...Object.getOwnPropertySymbols(t)];for(const s of o)this.createProperty(s,t[s])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(t){const o=[];if(Array.isArray(t)){const s=new Set(t.flat(1/0).reverse());for(const t of s)o.unshift(iI(t))}else void 0!==t&&o.push(iI(t));return o}static _$Ep(t,o){const s=o.attribute;return!1===s?void 0:"string"==typeof s?s:"string"==typeof t?t.toLowerCase():void 0}u(){var t;this._$E_=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this._$Eg(),this.requestUpdate(),null===(t=this.constructor.h)||void 0===t||t.forEach((t=>t(this)))}addController(t){var o,s;(null!==(o=this._$ES)&&void 0!==o?o:this._$ES=[]).push(t),void 0!==this.renderRoot&&this.isConnected&&(null===(s=t.hostConnected)||void 0===s||s.call(t))}removeController(t){var o;null===(o=this._$ES)||void 0===o||o.splice(this._$ES.indexOf(t)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach(((t,o)=>{this.hasOwnProperty(o)&&(this._$Ei.set(o,this[o]),delete this[o])}))}createRenderRoot(){var t;const o=null!==(t=this.shadowRoot)&&void 0!==t?t:this.attachShadow(this.constructor.shadowRootOptions);return((t,o)=>{rI?t.adoptedStyleSheets=o.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet)):o.forEach((o=>{const s=document.createElement("style"),l=tI.litNonce;void 0!==l&&s.setAttribute("nonce",l),s.textContent=o.cssText,t.appendChild(s)}))})(o,this.constructor.elementStyles),o}connectedCallback(){var t;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(t=this._$ES)||void 0===t||t.forEach((t=>{var o;return null===(o=t.hostConnected)||void 0===o?void 0:o.call(t)}))}enableUpdating(t){}disconnectedCallback(){var t;null===(t=this._$ES)||void 0===t||t.forEach((t=>{var o;return null===(o=t.hostDisconnected)||void 0===o?void 0:o.call(t)}))}attributeChangedCallback(t,o,s){this._$AK(t,s)}_$EO(t,o,s=hI){var l;const h=this.constructor._$Ep(t,s);if(void 0!==h&&!0===s.reflect){const v=(void 0!==(null===(l=s.converter)||void 0===l?void 0:l.toAttribute)?s.converter:uI).toAttribute(o,s.type);this._$El=t,null==v?this.removeAttribute(h):this.setAttribute(h,v),this._$El=null}}_$AK(t,o){var s;const l=this.constructor,h=l._$Ev.get(t);if(void 0!==h&&this._$El!==h){const t=l.getPropertyOptions(h),v="function"==typeof t.converter?{fromAttribute:t.converter}:void 0!==(null===(s=t.converter)||void 0===s?void 0:s.fromAttribute)?t.converter:uI;this._$El=h,this[h]=v.fromAttribute(o,t.type),this._$El=null}}requestUpdate(t,o,s){let l=!0;void 0!==t&&(((s=s||this.constructor.getPropertyOptions(t)).hasChanged||a$2)(this[t],o)?(this._$AL.has(t)||this._$AL.set(t,o),!0===s.reflect&&this._$El!==t&&(void 0===this._$EC&&(this._$EC=new Map),this._$EC.set(t,s))):l=!1),!this.isUpdatePending&&l&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(t){Promise.reject(t)}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var t;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach(((t,o)=>this[o]=t)),this._$Ei=void 0);let o=!1;const s=this._$AL;try{o=this.shouldUpdate(s),o?(this.willUpdate(s),null===(t=this._$ES)||void 0===t||t.forEach((t=>{var o;return null===(o=t.hostUpdate)||void 0===o?void 0:o.call(t)})),this.update(s)):this._$Ek()}catch(t){throw o=!1,this._$Ek(),t}o&&this._$AE(s)}willUpdate(t){}_$AE(t){var o;null===(o=this._$ES)||void 0===o||o.forEach((t=>{var o;return null===(o=t.hostUpdated)||void 0===o?void 0:o.call(t)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(t){return!0}update(t){void 0!==this._$EC&&(this._$EC.forEach(((t,o)=>this._$EO(o,this[o],t))),this._$EC=void 0),this._$Ek()}updated(t){}firstUpdated(t){}}
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
var pI;d$2.finalized=!0,d$2.elementProperties=new Map,d$2.elementStyles=[],d$2.shadowRootOptions={mode:"open"},null==dI||dI({ReactiveElement:d$2}),(null!==(sI=aI.reactiveElementVersions)&&void 0!==sI?sI:aI.reactiveElementVersions=[]).push("1.6.1");const fI=window,gI=fI.trustedTypes,vI=gI?gI.createPolicy("lit-html",{createHTML:t=>t}):void 0,mI=`lit$${(Math.random()+"").slice(9)}$`,bI="?"+mI,yI=`<${bI}>`,wI=document,r$2=(t="")=>wI.createComment(t),d$1=t=>null===t||"object"!=typeof t&&"function"!=typeof t,_I=Array.isArray,c$3=t=>_I(t)||"function"==typeof(null==t?void 0:t[Symbol.iterator]),CI=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,kI=/-->/g,TI=/>/g,SI=RegExp(">|[ \t\n\f\r](?:([^\\s\"'>=/]+)([ \t\n\f\r]*=[ \t\n\f\r]*(?:[^ \t\n\f\r\"'`<>=]|(\"|')|))|$)","g"),xI=/'/g,EI=/"/g,II=/^(?:script|style|textarea|title)$/i,AI=Symbol.for("lit-noChange"),PI=Symbol.for("lit-nothing"),RI=new WeakMap,OI=wI.createTreeWalker(wI,129,null,!1),E$1=(t,o)=>{const s=t.length-1,l=[];let h,v=2===o?"<svg>":"",m=CI;for(let o=0;o<s;o++){const s=t[o];let _,R,$=-1,B=0;for(;B<s.length&&(m.lastIndex=B,R=m.exec(s),null!==R);)B=m.lastIndex,m===CI?"!--"===R[1]?m=kI:void 0!==R[1]?m=TI:void 0!==R[2]?(II.test(R[2])&&(h=RegExp("</"+R[2],"g")),m=SI):void 0!==R[3]&&(m=SI):m===SI?">"===R[0]?(m=null!=h?h:CI,$=-1):void 0===R[1]?$=-2:($=m.lastIndex-R[2].length,_=R[1],m=void 0===R[3]?SI:'"'===R[3]?EI:xI):m===EI||m===xI?m=SI:m===kI||m===TI?m=CI:(m=SI,h=void 0);const q=m===SI&&t[o+1].startsWith("/>")?" ":"";v+=m===CI?s+yI:$>=0?(l.push(_),s.slice(0,$)+"$lit$"+s.slice($)+mI+q):s+mI+(-2===$?(l.push(void 0),o):q)}const _=v+(t[s]||"<?>")+(2===o?"</svg>":"");if(!Array.isArray(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return[void 0!==vI?vI.createHTML(_):_,l]};class C$1{constructor({strings:t,_$litType$:o},s){let l;this.parts=[];let h=0,v=0;const m=t.length-1,_=this.parts,[R,$]=E$1(t,o);if(this.el=C$1.createElement(R,s),OI.currentNode=this.el.content,2===o){const t=this.el.content,o=t.firstChild;o.remove(),t.append(...o.childNodes)}for(;null!==(l=OI.nextNode())&&_.length<m;){if(1===l.nodeType){if(l.hasAttributes()){const t=[];for(const o of l.getAttributeNames())if(o.endsWith("$lit$")||o.startsWith(mI)){const s=$[v++];if(t.push(o),void 0!==s){const t=l.getAttribute(s.toLowerCase()+"$lit$").split(mI),o=/([.?@])?(.*)/.exec(s);_.push({type:1,index:h,name:o[2],strings:t,ctor:"."===o[1]?M$1:"?"===o[1]?k$1:"@"===o[1]?H$1:S$1})}else _.push({type:6,index:h})}for(const o of t)l.removeAttribute(o)}if(II.test(l.tagName)){const t=l.textContent.split(mI),o=t.length-1;if(o>0){l.textContent=gI?gI.emptyScript:"";for(let s=0;s<o;s++)l.append(t[s],r$2()),OI.nextNode(),_.push({type:2,index:++h});l.append(t[o],r$2())}}}else if(8===l.nodeType)if(l.data===bI)_.push({type:2,index:h});else{let t=-1;for(;-1!==(t=l.data.indexOf(mI,t+1));)_.push({type:7,index:h}),t+=mI.length-1}h++}}static createElement(t,o){const s=wI.createElement("template");return s.innerHTML=t,s}}function P$1(t,o,s=t,l){var h,v,m,_;if(o===AI)return o;let R=void 0!==l?null===(h=s._$Co)||void 0===h?void 0:h[l]:s._$Cl;const $=d$1(o)?void 0:o._$litDirective$;return(null==R?void 0:R.constructor)!==$&&(null===(v=null==R?void 0:R._$AO)||void 0===v||v.call(R,!1),void 0===$?R=void 0:(R=new $(t),R._$AT(t,s,l)),void 0!==l?(null!==(m=(_=s)._$Co)&&void 0!==m?m:_._$Co=[])[l]=R:s._$Cl=R),void 0!==R&&(o=P$1(t,R._$AS(t,o.values),R,l)),o}class V$1{constructor(t,o){this.u=[],this._$AN=void 0,this._$AD=t,this._$AM=o}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}v(t){var o;const{el:{content:s},parts:l}=this._$AD,h=(null!==(o=null==t?void 0:t.creationScope)&&void 0!==o?o:wI).importNode(s,!0);OI.currentNode=h;let v=OI.nextNode(),m=0,_=0,R=l[0];for(;void 0!==R;){if(m===R.index){let o;2===R.type?o=new N$1(v,v.nextSibling,this,t):1===R.type?o=new R.ctor(v,R.name,R.strings,this,t):6===R.type&&(o=new I$1(v,this,t)),this.u.push(o),R=l[++_]}m!==(null==R?void 0:R.index)&&(v=OI.nextNode(),m++)}return h}p(t){let o=0;for(const s of this.u)void 0!==s&&(void 0!==s.strings?(s._$AI(t,s,o),o+=s.strings.length-2):s._$AI(t[o])),o++}}class N$1{constructor(t,o,s,l){var h;this.type=2,this._$AH=PI,this._$AN=void 0,this._$AA=t,this._$AB=o,this._$AM=s,this.options=l,this._$Cm=null===(h=null==l?void 0:l.isConnected)||void 0===h||h}get _$AU(){var t,o;return null!==(o=null===(t=this._$AM)||void 0===t?void 0:t._$AU)&&void 0!==o?o:this._$Cm}get parentNode(){let t=this._$AA.parentNode;const o=this._$AM;return void 0!==o&&11===t.nodeType&&(t=o.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,o=this){t=P$1(this,t,o),d$1(t)?t===PI||null==t||""===t?(this._$AH!==PI&&this._$AR(),this._$AH=PI):t!==this._$AH&&t!==AI&&this.g(t):void 0!==t._$litType$?this.$(t):void 0!==t.nodeType?this.T(t):c$3(t)?this.k(t):this.g(t)}O(t,o=this._$AB){return this._$AA.parentNode.insertBefore(t,o)}T(t){this._$AH!==t&&(this._$AR(),this._$AH=this.O(t))}g(t){this._$AH!==PI&&d$1(this._$AH)?this._$AA.nextSibling.data=t:this.T(wI.createTextNode(t)),this._$AH=t}$(t){var o;const{values:s,_$litType$:l}=t,h="number"==typeof l?this._$AC(t):(void 0===l.el&&(l.el=C$1.createElement(l.h,this.options)),l);if((null===(o=this._$AH)||void 0===o?void 0:o._$AD)===h)this._$AH.p(s);else{const t=new V$1(h,this),o=t.v(this.options);t.p(s),this.T(o),this._$AH=t}}_$AC(t){let o=RI.get(t.strings);return void 0===o&&RI.set(t.strings,o=new C$1(t)),o}k(t){_I(this._$AH)||(this._$AH=[],this._$AR());const o=this._$AH;let s,l=0;for(const h of t)l===o.length?o.push(s=new N$1(this.O(r$2()),this.O(r$2()),this,this.options)):s=o[l],s._$AI(h),l++;l<o.length&&(this._$AR(s&&s._$AB.nextSibling,l),o.length=l)}_$AR(t=this._$AA.nextSibling,o){var s;for(null===(s=this._$AP)||void 0===s||s.call(this,!1,!0,o);t&&t!==this._$AB;){const o=t.nextSibling;t.remove(),t=o}}setConnected(t){var o;void 0===this._$AM&&(this._$Cm=t,null===(o=this._$AP)||void 0===o||o.call(this,t))}}class S$1{constructor(t,o,s,l,h){this.type=1,this._$AH=PI,this._$AN=void 0,this.element=t,this.name=o,this._$AM=l,this.options=h,s.length>2||""!==s[0]||""!==s[1]?(this._$AH=Array(s.length-1).fill(new String),this.strings=s):this._$AH=PI}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(t,o=this,s,l){const h=this.strings;let v=!1;if(void 0===h)t=P$1(this,t,o,0),v=!d$1(t)||t!==this._$AH&&t!==AI,v&&(this._$AH=t);else{const l=t;let m,_;for(t=h[0],m=0;m<h.length-1;m++)_=P$1(this,l[s+m],o,m),_===AI&&(_=this._$AH[m]),v||(v=!d$1(_)||_!==this._$AH[m]),_===PI?t=PI:t!==PI&&(t+=(null!=_?_:"")+h[m+1]),this._$AH[m]=_}v&&!l&&this.j(t)}j(t){t===PI?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=t?t:"")}}class M$1 extends S$1{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===PI?void 0:t}}const $I=gI?gI.emptyScript:"";class k$1 extends S$1{constructor(){super(...arguments),this.type=4}j(t){t&&t!==PI?this.element.setAttribute(this.name,$I):this.element.removeAttribute(this.name)}}class H$1 extends S$1{constructor(t,o,s,l,h){super(t,o,s,l,h),this.type=5}_$AI(t,o=this){var s;if((t=null!==(s=P$1(this,t,o,0))&&void 0!==s?s:PI)===AI)return;const l=this._$AH,h=t===PI&&l!==PI||t.capture!==l.capture||t.once!==l.once||t.passive!==l.passive,v=t!==PI&&(l===PI||h);h&&this.element.removeEventListener(this.name,this,l),v&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){var o,s;"function"==typeof this._$AH?this._$AH.call(null!==(s=null===(o=this.options)||void 0===o?void 0:o.host)&&void 0!==s?s:this.element,t):this._$AH.handleEvent(t)}}class I$1{constructor(t,o,s){this.element=t,this.type=6,this._$AN=void 0,this._$AM=o,this.options=s}get _$AU(){return this._$AM._$AU}_$AI(t){P$1(this,t)}}const NI={P:"$lit$",A:mI,M:bI,C:1,L:E$1,R:V$1,D:c$3,V:P$1,I:N$1,H:S$1,N:k$1,U:H$1,B:M$1,F:I$1},MI=fI.litHtmlPolyfillSupport;
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
var DI;null==MI||MI(C$1,N$1),(null!==(pI=fI.litHtmlVersions)&&void 0!==pI?pI:fI.litHtmlVersions=[]).push("2.6.1");const LI=window,FI=LI.trustedTypes,UI=FI?FI.createPolicy("lit-html",{createHTML:t=>t}):void 0,HI=`lit$${(Math.random()+"").slice(9)}$`,BI="?"+HI,qI=`<${BI}>`,jI=document,r$1=(t="")=>jI.createComment(t),d=t=>null===t||"object"!=typeof t&&"function"!=typeof t,zI=Array.isArray,VI=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,GI=/-->/g,KI=/>/g,WI=RegExp(">|[ \t\n\f\r](?:([^\\s\"'>=/]+)([ \t\n\f\r]*=[ \t\n\f\r]*(?:[^ \t\n\f\r\"'`<>=]|(\"|')|))|$)","g"),QI=/'/g,YI=/"/g,JI=/^(?:script|style|textarea|title)$/i,XI=(t=>(o,...s)=>({_$litType$:t,strings:o,values:s}))(1),ZI=Symbol.for("lit-noChange"),eA=Symbol.for("lit-nothing"),tA=new WeakMap,rA=jI.createTreeWalker(jI,129,null,!1),E=(t,o)=>{const s=t.length-1,l=[];let h,v=2===o?"<svg>":"",m=VI;for(let o=0;o<s;o++){const s=t[o];let _,R,$=-1,B=0;for(;B<s.length&&(m.lastIndex=B,R=m.exec(s),null!==R);)B=m.lastIndex,m===VI?"!--"===R[1]?m=GI:void 0!==R[1]?m=KI:void 0!==R[2]?(JI.test(R[2])&&(h=RegExp("</"+R[2],"g")),m=WI):void 0!==R[3]&&(m=WI):m===WI?">"===R[0]?(m=null!=h?h:VI,$=-1):void 0===R[1]?$=-2:($=m.lastIndex-R[2].length,_=R[1],m=void 0===R[3]?WI:'"'===R[3]?YI:QI):m===YI||m===QI?m=WI:m===GI||m===KI?m=VI:(m=WI,h=void 0);const q=m===WI&&t[o+1].startsWith("/>")?" ":"";v+=m===VI?s+qI:$>=0?(l.push(_),s.slice(0,$)+"$lit$"+s.slice($)+HI+q):s+HI+(-2===$?(l.push(void 0),o):q)}const _=v+(t[s]||"<?>")+(2===o?"</svg>":"");if(!Array.isArray(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return[void 0!==UI?UI.createHTML(_):_,l]};class C{constructor({strings:t,_$litType$:o},s){let l;this.parts=[];let h=0,v=0;const m=t.length-1,_=this.parts,[R,$]=E(t,o);if(this.el=C.createElement(R,s),rA.currentNode=this.el.content,2===o){const t=this.el.content,o=t.firstChild;o.remove(),t.append(...o.childNodes)}for(;null!==(l=rA.nextNode())&&_.length<m;){if(1===l.nodeType){if(l.hasAttributes()){const t=[];for(const o of l.getAttributeNames())if(o.endsWith("$lit$")||o.startsWith(HI)){const s=$[v++];if(t.push(o),void 0!==s){const t=l.getAttribute(s.toLowerCase()+"$lit$").split(HI),o=/([.?@])?(.*)/.exec(s);_.push({type:1,index:h,name:o[2],strings:t,ctor:"."===o[1]?M:"?"===o[1]?k:"@"===o[1]?H:S})}else _.push({type:6,index:h})}for(const o of t)l.removeAttribute(o)}if(JI.test(l.tagName)){const t=l.textContent.split(HI),o=t.length-1;if(o>0){l.textContent=FI?FI.emptyScript:"";for(let s=0;s<o;s++)l.append(t[s],r$1()),rA.nextNode(),_.push({type:2,index:++h});l.append(t[o],r$1())}}}else if(8===l.nodeType)if(l.data===BI)_.push({type:2,index:h});else{let t=-1;for(;-1!==(t=l.data.indexOf(HI,t+1));)_.push({type:7,index:h}),t+=HI.length-1}h++}}static createElement(t,o){const s=jI.createElement("template");return s.innerHTML=t,s}}function P(t,o,s=t,l){var h,v,m,_;if(o===ZI)return o;let R=void 0!==l?null===(h=s._$Co)||void 0===h?void 0:h[l]:s._$Cl;const $=d(o)?void 0:o._$litDirective$;return(null==R?void 0:R.constructor)!==$&&(null===(v=null==R?void 0:R._$AO)||void 0===v||v.call(R,!1),void 0===$?R=void 0:(R=new $(t),R._$AT(t,s,l)),void 0!==l?(null!==(m=(_=s)._$Co)&&void 0!==m?m:_._$Co=[])[l]=R:s._$Cl=R),void 0!==R&&(o=P(t,R._$AS(t,o.values),R,l)),o}class V{constructor(t,o){this.u=[],this._$AN=void 0,this._$AD=t,this._$AM=o}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}v(t){var o;const{el:{content:s},parts:l}=this._$AD,h=(null!==(o=null==t?void 0:t.creationScope)&&void 0!==o?o:jI).importNode(s,!0);rA.currentNode=h;let v=rA.nextNode(),m=0,_=0,R=l[0];for(;void 0!==R;){if(m===R.index){let o;2===R.type?o=new N(v,v.nextSibling,this,t):1===R.type?o=new R.ctor(v,R.name,R.strings,this,t):6===R.type&&(o=new I(v,this,t)),this.u.push(o),R=l[++_]}m!==(null==R?void 0:R.index)&&(v=rA.nextNode(),m++)}return h}p(t){let o=0;for(const s of this.u)void 0!==s&&(void 0!==s.strings?(s._$AI(t,s,o),o+=s.strings.length-2):s._$AI(t[o])),o++}}class N{constructor(t,o,s,l){var h;this.type=2,this._$AH=eA,this._$AN=void 0,this._$AA=t,this._$AB=o,this._$AM=s,this.options=l,this._$Cm=null===(h=null==l?void 0:l.isConnected)||void 0===h||h}get _$AU(){var t,o;return null!==(o=null===(t=this._$AM)||void 0===t?void 0:t._$AU)&&void 0!==o?o:this._$Cm}get parentNode(){let t=this._$AA.parentNode;const o=this._$AM;return void 0!==o&&11===t.nodeType&&(t=o.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,o=this){t=P(this,t,o),d(t)?t===eA||null==t||""===t?(this._$AH!==eA&&this._$AR(),this._$AH=eA):t!==this._$AH&&t!==ZI&&this.g(t):void 0!==t._$litType$?this.$(t):void 0!==t.nodeType?this.T(t):(t=>zI(t)||"function"==typeof(null==t?void 0:t[Symbol.iterator]))(t)?this.k(t):this.g(t)}O(t,o=this._$AB){return this._$AA.parentNode.insertBefore(t,o)}T(t){this._$AH!==t&&(this._$AR(),this._$AH=this.O(t))}g(t){this._$AH!==eA&&d(this._$AH)?this._$AA.nextSibling.data=t:this.T(jI.createTextNode(t)),this._$AH=t}$(t){var o;const{values:s,_$litType$:l}=t,h="number"==typeof l?this._$AC(t):(void 0===l.el&&(l.el=C.createElement(l.h,this.options)),l);if((null===(o=this._$AH)||void 0===o?void 0:o._$AD)===h)this._$AH.p(s);else{const t=new V(h,this),o=t.v(this.options);t.p(s),this.T(o),this._$AH=t}}_$AC(t){let o=tA.get(t.strings);return void 0===o&&tA.set(t.strings,o=new C(t)),o}k(t){zI(this._$AH)||(this._$AH=[],this._$AR());const o=this._$AH;let s,l=0;for(const h of t)l===o.length?o.push(s=new N(this.O(r$1()),this.O(r$1()),this,this.options)):s=o[l],s._$AI(h),l++;l<o.length&&(this._$AR(s&&s._$AB.nextSibling,l),o.length=l)}_$AR(t=this._$AA.nextSibling,o){var s;for(null===(s=this._$AP)||void 0===s||s.call(this,!1,!0,o);t&&t!==this._$AB;){const o=t.nextSibling;t.remove(),t=o}}setConnected(t){var o;void 0===this._$AM&&(this._$Cm=t,null===(o=this._$AP)||void 0===o||o.call(this,t))}}class S{constructor(t,o,s,l,h){this.type=1,this._$AH=eA,this._$AN=void 0,this.element=t,this.name=o,this._$AM=l,this.options=h,s.length>2||""!==s[0]||""!==s[1]?(this._$AH=Array(s.length-1).fill(new String),this.strings=s):this._$AH=eA}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(t,o=this,s,l){const h=this.strings;let v=!1;if(void 0===h)t=P(this,t,o,0),v=!d(t)||t!==this._$AH&&t!==ZI,v&&(this._$AH=t);else{const l=t;let m,_;for(t=h[0],m=0;m<h.length-1;m++)_=P(this,l[s+m],o,m),_===ZI&&(_=this._$AH[m]),v||(v=!d(_)||_!==this._$AH[m]),_===eA?t=eA:t!==eA&&(t+=(null!=_?_:"")+h[m+1]),this._$AH[m]=_}v&&!l&&this.j(t)}j(t){t===eA?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=t?t:"")}}class M extends S{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===eA?void 0:t}}const oA=FI?FI.emptyScript:"";class k extends S{constructor(){super(...arguments),this.type=4}j(t){t&&t!==eA?this.element.setAttribute(this.name,oA):this.element.removeAttribute(this.name)}}class H extends S{constructor(t,o,s,l,h){super(t,o,s,l,h),this.type=5}_$AI(t,o=this){var s;if((t=null!==(s=P(this,t,o,0))&&void 0!==s?s:eA)===ZI)return;const l=this._$AH,h=t===eA&&l!==eA||t.capture!==l.capture||t.once!==l.once||t.passive!==l.passive,v=t!==eA&&(l===eA||h);h&&this.element.removeEventListener(this.name,this,l),v&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){var o,s;"function"==typeof this._$AH?this._$AH.call(null!==(s=null===(o=this.options)||void 0===o?void 0:o.host)&&void 0!==s?s:this.element,t):this._$AH.handleEvent(t)}}class I{constructor(t,o,s){this.element=t,this.type=6,this._$AN=void 0,this._$AM=o,this.options=s}get _$AU(){return this._$AM._$AU}_$AI(t){P(this,t)}}const nA=LI.litHtmlPolyfillSupport;null==nA||nA(C,N),(null!==(DI=LI.litHtmlVersions)&&void 0!==DI?DI:LI.litHtmlVersions=[]).push("2.6.1");
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
var iA,sA;class s$1 extends d$2{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var t,o;const s=super.createRenderRoot();return null!==(t=(o=this.renderOptions).renderBefore)&&void 0!==t||(o.renderBefore=s.firstChild),s}update(t){const o=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=((t,o,s)=>{var l,h;const v=null!==(l=null==s?void 0:s.renderBefore)&&void 0!==l?l:o;let m=v._$litPart$;if(void 0===m){const t=null!==(h=null==s?void 0:s.renderBefore)&&void 0!==h?h:null;v._$litPart$=m=new N(o.insertBefore(r$1(),t),t,void 0,null!=s?s:{})}return m._$AI(t),m})(o,this.renderRoot,this.renderOptions)}connectedCallback(){var t;super.connectedCallback(),null===(t=this._$Do)||void 0===t||t.setConnected(!0)}disconnectedCallback(){var t;super.disconnectedCallback(),null===(t=this._$Do)||void 0===t||t.setConnected(!1)}render(){return ZI}}s$1.finalized=!0,s$1._$litElement$=!0,null===(iA=globalThis.litElementHydrateSupport)||void 0===iA||iA.call(globalThis,{LitElement:s$1});const aA=globalThis.litElementPolyfillSupport;null==aA||aA({LitElement:s$1}),(null!==(sA=globalThis.litElementVersions)&&void 0!==sA?sA:globalThis.litElementVersions=[]).push("3.2.2");
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const i$1=(t,o)=>"method"===o.kind&&o.descriptor&&!("value"in o.descriptor)?{...o,finisher(s){s.createProperty(o.key,t)}}:{kind:"field",key:Symbol(),placement:"own",descriptor:{},originalKey:o.key,initializer(){"function"==typeof o.initializer&&(this[o.key]=o.initializer.call(this))},finisher(s){s.createProperty(o.key,t)}};
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function e$1(t){return(o,s)=>void 0!==s?((t,o,s)=>{o.constructor.createProperty(s,t)})(t,o,s):i$1(t,o)
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */}function t$1(t){return e$1({...t,state:!0})}
/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var lA;null===(lA=window.HTMLSlotElement)||void 0===lA||lA.prototype.assignedElements;class LocalizationHelper{static get strings(){return this._strings}static set strings(t){this._strings=t,this._stringsEventDispatcher.fire(null)}static getDocumentDirection(){var t,o;return(null===(t=document.body)||void 0===t?void 0:t.getAttribute("dir"))||(null===(o=document.documentElement)||void 0===o?void 0:o.getAttribute("dir"))||"ltr"}static onStringsUpdated(t){this._stringsEventDispatcher.add(t)}static removeOnStringsUpdated(t){this._stringsEventDispatcher.remove(t)}static onDirectionUpdated(t){this._directionEventDispatcher.add(t),this.initDirection()}static removeOnDirectionUpdated(t){this._directionEventDispatcher.remove(t)}static initDirection(){if(this._isDirectionInit)return;this._isDirectionInit=!0,this.mutationObserver=new MutationObserver((t=>{t.forEach((t=>{"dir"==t.attributeName&&this._directionEventDispatcher.fire(null)}))}));const t={attributes:!0,attributeFilter:["dir"]};this.mutationObserver.observe(document.body,t),this.mutationObserver.observe(document.documentElement,t)}static updateStringsForTag(t,o){if((t=t.toLowerCase()).startsWith("mgt-")&&(t=t.substring(4)),this._strings&&o){for(let t of Object.entries(o))this._strings[t[0]]&&(o[t[0]]=this._strings[t[0]]);if(this._strings._components&&this._strings._components[t]){let s=this._strings._components[t];for(let t of Object.keys(s))o[t]&&(o[t]=s[t])}}return o}}LocalizationHelper._stringsEventDispatcher=new EventDispatcher,LocalizationHelper._directionEventDispatcher=new EventDispatcher,LocalizationHelper._isDirectionInit=!1;var cA,__decorate$y=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},__metadata$w=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)},__awaiter$G=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};exports.ComponentMediaQuery=void 0,(cA=exports.ComponentMediaQuery||(exports.ComponentMediaQuery={})).mobile="",cA.tablet="tablet",cA.desktop="desktop";class MgtBaseComponent extends s$1{static get version(){return ZE}get mediaQuery(){return this.offsetWidth<768?exports.ComponentMediaQuery.mobile:this.offsetWidth<1200?exports.ComponentMediaQuery.tablet:exports.ComponentMediaQuery.desktop}get isLoadingState(){return this._isLoadingState}get isFirstUpdated(){return this._isFirstUpdated}get strings(){return{}}constructor(){super(),this.direction="ltr",this._isLoadingState=!1,this._isFirstUpdated=!1,this.handleLocalizationChanged=this.handleLocalizationChanged.bind(this),this.handleDirectionChanged=this.handleDirectionChanged.bind(this),this.handleProviderUpdates=this.handleProviderUpdates.bind(this),this.handleActiveAccountUpdates=this.handleActiveAccountUpdates.bind(this),this.handleDirectionChanged(),this.handleLocalizationChanged()}connectedCallback(){super.connectedCallback(),LocalizationHelper.onStringsUpdated(this.handleLocalizationChanged),LocalizationHelper.onDirectionUpdated(this.handleDirectionChanged)}disconnectedCallback(){super.disconnectedCallback(),LocalizationHelper.removeOnStringsUpdated(this.handleLocalizationChanged),LocalizationHelper.removeOnDirectionUpdated(this.handleDirectionChanged),Providers.removeProviderUpdatedListener(this.handleProviderUpdates),Providers.removeActiveAccountChangedListener(this.handleActiveAccountUpdates)}firstUpdated(t){super.firstUpdated(t),this._isFirstUpdated=!0,Providers.onProviderUpdated(this.handleProviderUpdates),Providers.onActiveAccountChanged(this.handleActiveAccountUpdates),this.requestStateUpdate()}loadState(){return Promise.resolve()}clearState(){}fireCustomEvent(t,o,s=!1,l=!1){const h=new CustomEvent(t,{bubbles:s,cancelable:l,detail:o});return this.dispatchEvent(h)}updated(t){super.updated(t);const o=new CustomEvent("updated",{bubbles:!0,cancelable:!0});this.dispatchEvent(o)}requestStateUpdate(t=!1){return __awaiter$G(this,void 0,void 0,(function*(){if(!this._isFirstUpdated)return;this.isLoadingState&&!t&&(yield this._currentLoadStatePromise);const o=Providers.globalProvider;if(!o)return Promise.resolve();if(o.state!==exports.ProviderState.SignedOut){if(o.state===exports.ProviderState.Loading)return Promise.resolve();{const o=new Promise(((s,l)=>__awaiter$G(this,void 0,void 0,(function*(){try{this.setLoadingState(!0),this.fireCustomEvent("loadingInitiated"),yield this.loadState(),this.setLoadingState(!1),this.fireCustomEvent("loadingCompleted"),s()}catch(t){this.clearState(),this.setLoadingState(!1),this.fireCustomEvent("loadingFailed"),l(t)}return this._currentLoadStatePromise=this.isLoadingState&&this._currentLoadStatePromise&&t?this._currentLoadStatePromise.then((()=>o)):o}))))}}else this.clearState()}))}setLoadingState(t){this._isLoadingState!==t&&(this._isLoadingState=t,this.requestUpdate("isLoadingState"))}handleProviderUpdates(){this.requestStateUpdate()}handleActiveAccountUpdates(){return __awaiter$G(this,void 0,void 0,(function*(){this.clearState(),this.requestStateUpdate()}))}handleLocalizationChanged(){LocalizationHelper.updateStringsForTag(this.tagName,this.strings),this.requestUpdate()}handleDirectionChanged(){this.direction=LocalizationHelper.getDocumentDirection()}}__decorate$y([t$1(),__metadata$w("design:type",Object)],MgtBaseComponent.prototype,"direction",void 0);var __decorate$x=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},__metadata$v=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)};class MgtBaseProvider extends MgtBaseComponent{get provider(){return this._provider}set provider(t){this._provider&&this.provider.removeStateChangedHandler((()=>this.stateChangedHandler)),this._provider=t,this._provider&&this.provider.onStateChanged((()=>this.stateChangedHandler))}get isAvailable(){return!0}firstUpdated(t){super.firstUpdated(t);let o=!1;if(this.dependsOn){let t=this.dependsOn;for(;t;){if(t.isAvailable){o=!0;break}t=t.dependsOn}}!o&&this.isAvailable&&this.initializeProvider()}initializeProvider(){}stateChangedHandler(){this.fireCustomEvent("onStateChanged",this.provider.state)}}function equals(t,o){return equalsInternal(t,o,new Set)}function equalsInternal(t,o,s){const l=Object.prototype.toString.call(t),h=Object.prototype.toString.call(o);if(l===h&&"[object Object]"===l&&!s.has(t)){s.add(t);for(const l in t)if(!equalsInternal(t[l],o[l],s))return!1;for(const s in o)if(!t.hasOwnProperty(s))return!1;return!0}if(l===h&&"[object Array]"===l&&!s.has(t)){if(s.add(t),t.length!==o.length)return!1;for(let l=0;l<t.length;l++)if(!equalsInternal(t[l],o[l],s))return!1;return!0}return t===o}function arraysAreEqual(t,o){if(t===o)return!0;if(!t||!o)return!1;if(t.length!==o.length)return!1;if(0===t.length)return!0;const s=new Set(t);for(const t of o)if(!s.has(t))return!1;return!0}__decorate$x([e$1({attribute:"depends-on",converter:t=>document.querySelector(t),type:String}),__metadata$v("design:type",MgtBaseProvider)],MgtBaseProvider.prototype,"dependsOn",void 0),__decorate$x([e$1({attribute:"base-url",type:String}),__metadata$v("design:type",String)],MgtBaseProvider.prototype,"baseUrl",void 0);class TemplateHelper{static renderTemplate(t,o,s){let l;if(o.$parentTemplateContext&&(s=Object.assign(Object.assign({},s),{$parent:o.$parentTemplateContext})),o.content&&o.content.childNodes.length){const h=o.content.cloneNode(!0);l=this.renderNode(h,t,s)}else if(o.childNodes.length){const h=document.createElement("div");for(let t=0;t<o.childNodes.length;t++)h.appendChild(this.simpleCloneNode(o.childNodes[t]));l=this.renderNode(h,t,s)}l&&t.appendChild(l)}static setBindingSyntax(t,o){this._startExpression=t,this._endExpression=o;const s=this.escapeRegex(this._startExpression),l=this.escapeRegex(this._endExpression);this._expression=new RegExp(`${s}\\s*([$\\w\\.,'"\\s()\\[\\]]+)\\s*${l}`,"g")}static get globalContext(){return this._globalContext}static get expression(){return this._expression||this.setBindingSyntax("{{","}}"),this._expression}static escapeRegex(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}static simpleCloneNode(t){if(!t)return null;const o=t.cloneNode(!1);for(let s=0;s<t.childNodes.length;s++){const l=this.simpleCloneNode(t.childNodes[s]);l&&o.appendChild(l)}return o}static expandExpressionsAsString(t,o){return t.replace(this.expression,((t,s)=>{const l=this.evalInContext(s||this.trimExpression(t),o);return l?"object"==typeof l?JSON.stringify(l):l.toString():""}))}static renderNode(t,o,s){if("#text"===t.nodeName)return t.textContent=this.expandExpressionsAsString(t.textContent,s),t;if("TEMPLATE"===t.nodeName)return t.$parentTemplateContext=s,t;let l=t;if(l.attributes)for(let t=0;t<l.attributes.length;t++){const h=l.attributes[t];if("data-props"===h.name){const t=this.trimExpression(h.value);for(const h of t.split(",")){const t=h.trim().split(":");if(2===t.length){const h=t[0].trim(),v=this.evalInContext(t[1].trim(),s);h.startsWith("@")?"function"==typeof v&&l.addEventListener(h.substring(1),(t=>v(t,s,o))):l[h]=v}}}else l.setAttribute(h.name,this.expandExpressionsAsString(h.value,s))}const h=[],v=[];let m=!1;for(let l=0;l<t.childNodes.length;l++){const _=t.childNodes[l],R=_;let $=!1;if(R.dataset){let t=!1;if(R.dataset.if){const o=R.dataset.if;this.evalBoolInContext(this.trimExpression(o),s)?(R.removeAttribute("data-if"),m=!0,$=!0):(v.push(R),t=!0)}else void 0!==R.dataset.else&&(m?(v.push(R),t=!0):R.removeAttribute("data-else"));R.dataset.for&&!t?h.push(R):t||this.renderNode(_,o,s)}else this.renderNode(_,o,s);$||"#text"===_.nodeName||(m=!1)}for(const t of v)l.removeChild(t);for(let t=0;t<h.length;t++){const v=h[t],m=v.dataset.for,_=this.trimExpression(m).split(/\s(in|of)\s/i);if(3===_.length){const t=_[0].trim(),h=_[2].trim(),m=this.evalInContext(h,s);if(Array.isArray(m)){v.removeAttribute("data-for");for(let h=0;h<m.length;h++){const _=Object.assign({$index:h},s);_[t]=m[h];const R=v.cloneNode(!0);this.renderNode(R,o,_),l.insertBefore(R,v)}}l.removeChild(v)}}return t}static evalBoolInContext(t,o){return o=Object.assign(Object.assign({},o),this.globalContext),new Function("with(this) { return !!("+t+")}").call(o)}static evalInContext(t,o){o=Object.assign(Object.assign({},o),this.globalContext);const s=new Function("with(this) { return "+t+";}");let l;try{l=s.call(o)}catch(t){}return l}static trimExpression(t){return(t=t.trim()).startsWith(this._startExpression)&&t.endsWith(this._endExpression)&&(t=(t=t.substr(this._startExpression.length,t.length-this._startExpression.length-this._endExpression.length)).trim()),t}}TemplateHelper._globalContext={};var __decorate$w=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},__metadata$u=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)};class MgtTemplatedComponent extends MgtBaseComponent{constructor(){super(),this.templates={},this._renderedSlots=!1,this._renderedTemplates={},this._slotNamesAddedDuringRender=[],this.templateContext=this.templateContext||{}}update(t){this.templates=this.getTemplates(),this._slotNamesAddedDuringRender=[],super.update(t)}updated(t){super.updated(t),this.removeUnusedSlottedElements()}renderTemplate(t,o,s){if(!this.hasTemplate(t))return null;s=s||t,this._slotNamesAddedDuringRender.push(s),this._renderedSlots=!0;const l=XI`
      <slot name=${s}></slot>
    `,h=Object.assign(Object.assign({},o),this.templateContext);if(this._renderedTemplates.hasOwnProperty(s)){const{context:t,slot:o}=this._renderedTemplates[s];if(equals(t,h))return l;this.removeChild(o)}const v=document.createElement("div");v.slot=s,v.dataset.generated="template",TemplateHelper.renderTemplate(v,this.templates[t],h),this.appendChild(v),this._renderedTemplates[s]={context:h,slot:v};const m={templateType:t,context:h,element:v};return this.fireCustomEvent("templateRendered",m),l}hasTemplate(t){return this.templates&&this.templates[t]}getTemplates(){const t={};for(let o=0;o<this.children.length;o++){const s=this.children[o];if("TEMPLATE"===s.nodeName){const l=s;l.dataset.type?t[l.dataset.type]=l:t.default=l,l.templateOrder=o}}return t}removeUnusedSlottedElements(){if(this._renderedSlots){for(let t=0;t<this.children.length;t++){const o=this.children[t];o.dataset&&o.dataset.generated&&!this._slotNamesAddedDuringRender.includes(o.slot)&&(this.removeChild(o),delete this._renderedTemplates[o.slot],t--)}this._renderedSlots=!1}}}__decorate$w([e$1({attribute:!1}),__metadata$u("design:type",Object)],MgtTemplatedComponent.prototype,"templateContext",void 0);const instanceOfAny=(t,o)=>o.some((o=>t instanceof o));let dA,uA;const hA=new WeakMap,pA=new WeakMap,fA=new WeakMap,gA=new WeakMap,vA=new WeakMap;let mA={get(t,o,s){if(t instanceof IDBTransaction){if("done"===o)return pA.get(t);if("objectStoreNames"===o)return t.objectStoreNames||fA.get(t);if("store"===o)return s.objectStoreNames[1]?void 0:s.objectStore(s.objectStoreNames[0])}return wrap(t[o])},set:(t,o,s)=>(t[o]=s,!0),has:(t,o)=>t instanceof IDBTransaction&&("done"===o||"store"===o)||o in t};function wrapFunction(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function getCursorAdvanceMethods(){return uA||(uA=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(t)?function(...o){return t.apply(unwrap(this),o),wrap(hA.get(this))}:function(...o){return wrap(t.apply(unwrap(this),o))}:function(o,...s){const l=t.call(unwrap(this),o,...s);return fA.set(l,o.sort?o.sort():[o]),wrap(l)}}function transformCachableValue(t){return"function"==typeof t?wrapFunction(t):(t instanceof IDBTransaction&&function cacheDonePromiseForTransaction(t){if(pA.has(t))return;const o=new Promise(((o,s)=>{const unlisten=()=>{t.removeEventListener("complete",complete),t.removeEventListener("error",error),t.removeEventListener("abort",error)},complete=()=>{o(),unlisten()},error=()=>{s(t.error||new DOMException("AbortError","AbortError")),unlisten()};t.addEventListener("complete",complete),t.addEventListener("error",error),t.addEventListener("abort",error)}));pA.set(t,o)}(t),instanceOfAny(t,function getIdbProxyableTypes(){return dA||(dA=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(t,mA):t)}function wrap(t){if(t instanceof IDBRequest)return function promisifyRequest(t){const o=new Promise(((o,s)=>{const unlisten=()=>{t.removeEventListener("success",success),t.removeEventListener("error",error)},success=()=>{o(wrap(t.result)),unlisten()},error=()=>{s(t.error),unlisten()};t.addEventListener("success",success),t.addEventListener("error",error)}));return o.then((o=>{o instanceof IDBCursor&&hA.set(o,t)})).catch((()=>{})),vA.set(o,t),o}(t);if(gA.has(t))return gA.get(t);const o=transformCachableValue(t);return o!==t&&(gA.set(t,o),vA.set(o,t)),o}const unwrap=t=>vA.get(t);const bA=["get","getKey","getAll","getAllKeys","count"],yA=["put","add","delete","clear"],wA=new Map;function getMethod(t,o){if(!(t instanceof IDBDatabase)||o in t||"string"!=typeof o)return;if(wA.get(o))return wA.get(o);const s=o.replace(/FromIndex$/,""),l=o!==s,h=yA.includes(s);if(!(s in(l?IDBIndex:IDBObjectStore).prototype)||!h&&!bA.includes(s))return;const method=async function(t,...o){const v=this.transaction(t,h?"readwrite":"readonly");let m=v.store;return l&&(m=m.index(o.shift())),(await Promise.all([m[s](...o),h&&v.done]))[0]};return wA.set(o,method),method}!function replaceTraps(t){mA=t(mA)}((t=>({...t,get:(o,s,l)=>getMethod(o,s)||t.get(o,s,l),has:(o,s)=>!!getMethod(o,s)||t.has(o,s)})));var __awaiter$F=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};const _A="mgt-db-list";class CacheService{static getCache(t,o){const s=`${t.name}/${o}`;return this.isInitialized||this.init(),this.cacheStore.has(o)||this.cacheStore.set(s,new CacheStore(t,o)),this.cacheStore.get(s)}static clearCacheById(t){const o=JSON.parse(localStorage.getItem(_A));if(o){let s=[];o.forEach((o=>__awaiter$F(this,void 0,void 0,(function*(){o.includes(t)?indexedDB.deleteDatabase(o):s.push(o)})))),s.length>0?localStorage.setItem(_A,JSON.stringify(s)):localStorage.removeItem(_A)}}static get config(){return this.cacheConfig}static init(){let t;Providers.globalProvider&&(t=Providers.globalProvider.state),Providers.onProviderUpdated((()=>__awaiter$F(this,void 0,void 0,(function*(){if(t===exports.ProviderState.SignedIn&&Providers.globalProvider.state===exports.ProviderState.SignedOut){const t=yield Providers.getCacheId();null!==t&&this.clearCacheById(t)}t=Providers.globalProvider.state})))),this.isInitialized=!0}}CacheService.cacheStore=new Map,CacheService.isInitialized=!1,CacheService.cacheConfig={defaultInvalidationPeriod:36e5,groups:{invalidationPeriod:null,isEnabled:!0},isEnabled:!0,people:{invalidationPeriod:null,isEnabled:!0},photos:{invalidationPeriod:null,isEnabled:!0},presence:{invalidationPeriod:3e5,isEnabled:!0},users:{invalidationPeriod:null,isEnabled:!0},response:{invalidationPeriod:null,isEnabled:!0},files:{invalidationPeriod:null,isEnabled:!0},fileLists:{invalidationPeriod:null,isEnabled:!0}};class CacheStore{constructor(t,o){if(!(o in t.stores))throw Error('"store" must be defined in the "schema"');this.schema=t,this.store=o}getValue(t){return __awaiter$F(this,void 0,void 0,(function*(){if(!window.indexedDB)return null;try{return(yield this.getDb()).get(this.store,t)}catch(t){return null}}))}putValue(t,o){return __awaiter$F(this,void 0,void 0,(function*(){if(window.indexedDB)try{yield(yield this.getDb()).put(this.store,Object.assign(Object.assign({},o),{timeCached:Date.now()}),t)}catch(t){return}}))}clearStore(){return __awaiter$F(this,void 0,void 0,(function*(){if(window.indexedDB)try{(yield this.getDb()).clear(this.store)}catch(t){return}}))}getDBName(){return __awaiter$F(this,void 0,void 0,(function*(){const t=yield Providers.getCacheId();if(t)return`mgt-${this.schema.name}-${t}`}))}getDb(){return __awaiter$F(this,void 0,void 0,(function*(){const t=yield this.getDBName();if(t)return function openDB(t,o,{blocked:s,upgrade:l,blocking:h,terminated:v}={}){const m=indexedDB.open(t,o),_=wrap(m);return l&&m.addEventListener("upgradeneeded",(t=>{l(wrap(m.result),t.oldVersion,t.newVersion,wrap(m.transaction))})),s&&m.addEventListener("blocked",(()=>s())),_.then((t=>{v&&t.addEventListener("close",(()=>v())),h&&t.addEventListener("versionchange",(()=>h()))})).catch((()=>{})),_}(t,this.schema.version,{upgrade:(o,s,l,h)=>{let v=JSON.parse(localStorage.getItem(_A))||[];v.includes(t)||v.push(t),localStorage.setItem(_A,JSON.stringify(v));for(const t in this.schema.stores)this.schema.stores.hasOwnProperty(t)&&(o.objectStoreNames.contains(t)||o.createObjectStore(t))}})}))}}class TeamsHelper{static get microsoftTeamsLib(){return this._microsoftTeamsLib||window.microsoftTeams}static set microsoftTeamsLib(t){this._microsoftTeamsLib=t}static get isAvailable(){return!!this.microsoftTeamsLib&&(!(window.parent!==window.self||!window.nativeInterface)||("embedded-page-container"===window.name||"extension-tab-frame"===window.name))}static executeDeepLink(t,o){const s=this.microsoftTeamsLib;s.initialize(),s.executeDeepLink(t,o)}}var __awaiter$E=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};class GraphPageIterator{get value(){return this._value}get hasNext(){return!!this._nextLink}static create(t,o,s){return __awaiter$E(this,void 0,void 0,(function*(){const l=yield o.get();if(l&&l.value){const o=new GraphPageIterator;return o._graph=t,o._value=l.value,o._nextLink=l["@odata.nextLink"],o._version=s||t.version,o}return null}))}static createFromValue(t,o,s){let l=new GraphPageIterator;return l._graph=t,l._value=o,l._nextLink=s||null,l._version=t.version,l||null}next(){return __awaiter$E(this,void 0,void 0,(function*(){if(this._nextLink){const t=this._nextLink.split(this._version)[1],o=yield this._graph.api(t).version(this._version).get();if(o&&o.value&&o.value.length)return this._value=this._value.concat(o.value),this._nextLink=o["@odata.nextLink"],o.value}return null}))}}const CA=new WeakMap,rewriteStrings=(t,o,s)=>{const l=[];for(const h of t)l.push(h.replace(o,s));return l},mgtHtml=(t,...o)=>{if(eI.isDisambiguated){let o=CA.get(t);if(!Boolean(o)){const s=new RegExp("(</?)mgt-(?!"+eI.disambiguation+"-)"),l=`$1${eI.prefix}-`;o=Object.assign(rewriteStrings(t,s,l),{raw:rewriteStrings(t.raw,s,l)}),CA.set(t,o)}t=o}return XI(t,...o)},customElement=t=>{const o=`${eI.prefix}-${t}`,s=customElements.get(o),version=t=>t.version||" Unknown likely <3.0.0";return s?t=>(console.error(`Tag name ${o} is already defined using class ${s.name} version ${version(s)}\n`,`Currently registering class ${t.name} with version ${version(t)}\n`,"Please use the disambiguation feature to define a unique tag name for this component see: https://github.com/microsoftgraph/microsoft-graph-toolkit/tree/main/packages/mgt-components#disambiguation"),t):(t=>o=>"function"==typeof o?((t,o)=>(customElements.define(t,o),o))(t,o):((t,o)=>{const{kind:s,elements:l}=o;return{kind:s,elements:l,finisher(o){customElements.define(t,o)}}})(t,o))(o)};class SessionCache{constructor(){this.session=window.sessionStorage}setItem(t,o){this.session.setItem(t,o)}getItem(t){return this.session.getItem(t)}clear(){this.session.clear()}}var __awaiter$D=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};class MockGraph extends Graph{static create(t){return __awaiter$D(this,void 0,void 0,(function*(){const o=[new AuthenticationHandler(t),new RetryHandler(new RetryHandlerOptions),new TelemetryHandler,new MockMiddleware,new HTTPMessageHandler];return new MockGraph(Client.initWithMiddleware({middleware:chainMiddleware(...o),customHosts:new Set([new URL(yield MockMiddleware.getBaseUrl()).hostname])}))}))}forComponent(t){return this}}class MockMiddleware{static get _sessionCache(){return!this._cache&&function storageAvailable(t){let o;try{o=window[t];const s="__storage_test__";return o.setItem(s,s),o.removeItem(s),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&o&&0!==o.length}}("sessionStorage")&&(this._cache=new SessionCache),this._cache}execute(t){return __awaiter$D(this,void 0,void 0,(function*(){try{const o=yield MockMiddleware.getBaseUrl();t.request=o+encodeURIComponent(t.request)}catch(t){}return yield this._nextMiddleware.execute(t)}))}setNext(t){this._nextMiddleware=t}static getBaseUrl(){var t,o;return __awaiter$D(this,void 0,void 0,(function*(){if(!this._baseUrl){const s=null===(t=this._sessionCache)||void 0===t?void 0:t.getItem("endpointURL");if(s)this._baseUrl=s;else{try{const t=yield fetch("https://cdn.graph.office.net/en-us/graph/api/proxy/endpoint");this._baseUrl=(yield t.json())+"?url="}catch(t){this._baseUrl="https://proxy.apisandbox.msdn.microsoft.com/svc?url="}null===(o=this._sessionCache)||void 0===o||o.setItem("endpointURL",this._baseUrl)}}return this._baseUrl}))}}var __awaiter$C=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};class MockProvider extends IProvider{constructor(t=!1,o=[]){super(),this._accounts=[],this._mockGraphPromise=MockGraph.create(this);const s=Boolean(o.length);this.isMultipleAccountSupported=s,this.isMultipleAccountDisabled=!s,this._accounts=o,this.initializeMockGraph(t)}get isMultiAccountSupportedAndEnabled(){return!this.isMultipleAccountDisabled&&this.isMultipleAccountSupported}getAllAccounts(){return this._accounts}getActiveAccount(){if(this._accounts.length)return this._accounts[0]}login(){return __awaiter$C(this,void 0,void 0,(function*(){this.setState(exports.ProviderState.Loading),yield this._mockGraphPromise,yield new Promise((t=>setTimeout(t,3e3))),this.setState(exports.ProviderState.SignedIn)}))}logout(){return __awaiter$C(this,void 0,void 0,(function*(){this.setState(exports.ProviderState.Loading),yield this._mockGraphPromise,yield new Promise((t=>setTimeout(t,3e3))),this.setState(exports.ProviderState.SignedOut)}))}getAccessToken(){return Promise.resolve("{token:https://graph.microsoft.com/}")}get name(){return"MgtMockProvider"}initializeMockGraph(t=!1){return __awaiter$C(this,void 0,void 0,(function*(){this.graph=yield this._mockGraphPromise,t?this.setState(exports.ProviderState.SignedIn):this.setState(exports.ProviderState.SignedOut)}))}}const kA=[i$4`
.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--selected-person-background-color:#f0f0f0}.mgt-dark{--selected-person-background-color:#4f4f4f}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--dropdown-item-selected-background:#deecf9;--arrow-fill:#000000}.mgt-dark{--dropdown-item-selected-background:#333d47;--arrow-fill:#605e5c}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--button-color:var(--neutral-foreground-rest, #1a1a1a);--popup-color:var(--neutral-foreground-rest, #1a1a1a)}.mgt-dark{--button-color:#f3f2f1;--popup-color:#f3f2f1}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--event-background-color:#ffffff;background-color:transparent}.mgt-dark{--event-background-color:#161514;background-color:transparent!important}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--presence-background-color:#ffffff;--presence-icon-color:#ffffff;--line1-color:#000000;--line2-color:var(--neutral-foreground-hint, #717171);--line3-color:var(--neutral-foreground-hint, #717171);--line4-color:var(--neutral-foreground-hint, #717171);--initials-color:black;--initials-background-color:white}.mgt-dark{--presence-background-color:#000000;--presence-icon-color:#000000;--line1-color:#ffffff;--line2-color:#c8c6c4;--line3-color:#c8c6c4;--line4-color:#c8c6c4;--initials-color:white;--initials-background-color:black}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--presence-background-color:#ffffff;--presence-icon-color:#ffffff;--line1-color:#000000;--line2-color:var(--neutral-foreground-hint, #717171);--line3-color:var(--neutral-foreground-hint, #717171);--line4-color:var(--neutral-foreground-hint, #717171);--initials-color:black;--initials-background-color:white}.mgt-dark{--presence-background-color:#000000;--presence-icon-color:#000000;--line1-color:#ffffff;--line2-color:#c8c6c4;--line3-color:#c8c6c4;--line4-color:#c8c6c4;--initials-color:white;--initials-background-color:black}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--person-card-contact-link-color:#023b8f;--person-card-contact-link-hover-color:#106ebe}.mgt-dark{--person-card-contact-link-color:#ffffff;--person-card-contact-link-hover-color:#f3f2f1}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--person-card-active-org-member-color:#023b8f}.mgt-dark{--person-card-active-org-member-color:#ffffff}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--token-overflow-color:#023b8f}.mgt-dark{--token-overflow-color:#f3f2f1}.mgt-light{--person-card-background-color:#ffffff;--person-card-display-name-color:#000000;--person-card-title-color:var(--neutral-foreground-hint, #717171);--person-card-subtitle-color:var(--neutral-foreground-hint, #717171);--person-card-nav-back-arrow-color:#023b8f;--person-card-nav-back-arrow-color:#000000;--person-card-show-more-color:#023b8f;--person-card-show-more-hover-color:#106ebe}.mgt-dark{--person-card-background-color:#000000;--person-card-display-name-color:#ffffff;--person-card-title-color:#c8c6c4;--person-card-subtitle-color:#c8c6c4;--person-card-nav-back-arrow-color:#106ebe;--person-card-nav-back-arrow-color:#ffffff;--person-card-show-more-color:#ffffff;--person-card-show-more-hover-color:#f3f2f1}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--task-border:1px solid #e1dfdd;--task-complete-border:2px dotted #e1dfdd;--task-new-add-button-disabled-background:#ebebeb;--task-icon-color:#000000}.mgt-dark{--task-border:1px solid #717171;--task-complete-border:2px dotted #717171;--task-new-add-button-disabled-background:#4f4f4f;--task-icon-color:#ffffff}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{background-color:#fff}.mgt-dark{background-color:#424242}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--file-item-background-color--hover:#f7f7f7;--file-item-background-color--active:#fbfbfb;--file-list-background-color:#ffffff;--file-upload-button-background-color:#f3f2f1;--file-upload-dialog-background-color:rgba(0, 0, 0, 0.1);--file-upload-dialog-content-background-color:white;--file-upload-dialog-content-color:#323130;--file-upload-dialog-primarybutton-color:white;--file-upload-dialog-primarybutton-background-color:#006cbe}.mgt-dark{--file-item-background-color--hover:#0078d4;--file-item-background-color--active:#238ada;--file-list-background-color:#424242;--file-upload-button-background-color:#006cbe;--file-upload-dialog-background-color:rgba(0, 0, 0, 0.3);--file-upload-dialog-content-background-color:#787878;--file-upload-dialog-content-color:#000;--file-upload-dialog-primarybutton-color:white;--file-upload-dialog-primarybutton-background-color:#006cbe}
`],TA=document.createElement("style");TA.type="text/css",TA.appendChild(document.createTextNode("\n@font-face {\n    font-family: 'FabricMDL2Icons';\n    src: url('https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.woff2') format('woff2'),\n    url(https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.woff) format(\"woff\"),\n    url(https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.ttf) format(\"truetype\");;\n}\n")),document.head.appendChild(TA);const SA=document.createElement("style");SA.innerHTML=kA.toString(),document.head.appendChild(SA);
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const xA=1,EA=2,e=t=>(...o)=>({_$litDirective$:t,values:o});class i{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,o,s){this._$Ct=t,this._$AM=o,this._$Ci=s}_$AS(t,o){return this.update(t,o)}update(t,o){return this.render(...o)}}
/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const IA=e(class extends i{constructor(t){var o;if(super(t),t.type!==xA||"class"!==t.name||(null===(o=t.strings)||void 0===o?void 0:o.length)>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(t){return" "+Object.keys(t).filter((o=>t[o])).join(" ")+" "}update(t,[o]){var s,l;if(void 0===this.nt){this.nt=new Set,void 0!==t.strings&&(this.st=new Set(t.strings.join(" ").split(/\s/).filter((t=>""!==t))));for(const t in o)o[t]&&!(null===(s=this.st)||void 0===s?void 0:s.has(t))&&this.nt.add(t);return this.render(o)}const h=t.element.classList;this.nt.forEach((t=>{t in o||(h.remove(t),this.nt.delete(t))}));for(const t in o){const s=!!o[t];s===this.nt.has(t)||(null===(l=this.st)||void 0===l?void 0:l.has(t))||(s?(h.add(t),this.nt.add(t)):(h.remove(t),this.nt.delete(t)))}return AI}});function getRelativeDisplayDate(t){const o=new Date,s=new Date(o.getFullYear(),o.getMonth(),o.getDate());if(t>=s)return t.toLocaleString("default",{hour:"numeric",minute:"numeric"});const l=new Date(s);if(l.setDate(o.getDate()-o.getDay()),t>=l)return t.toLocaleString("default",{hour:"numeric",minute:"numeric",weekday:"short"});const h=new Date(l);return h.setDate(l.getDate()-7),t>=h?t.toLocaleString("default",{day:"numeric",month:"numeric",weekday:"short"}):t.toLocaleString("default",{day:"numeric",month:"numeric",year:"numeric"})}function getShortDateString(t){const o=t.getMonth(),s=t.getDate();return`${function getMonthString(t){switch(t){case 0:return"January";case 1:return"February";case 2:return"March";case 3:return"April";case 4:return"May";case 5:return"June";case 6:return"July";case 7:return"August";case 8:return"September";case 9:return"October";case 10:return"November";case 11:return"December";default:return"Month"}}(o)} ${s}`}function debounce(t,o){let s;return function(){clearTimeout(s),s=setTimeout((()=>t.apply(this,arguments)),o)}}function blobToBase64(t){return new Promise(((o,s)=>{const l=new FileReader;l.onerror=s,l.onload=t=>{o(l.result)},l.readAsDataURL(t)}))}function extractEmailAddress(t){return t.startsWith("[")?t.match(/([a-zA-Z0-9+._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9_-]+)/gi).toString():t}function isValidEmail(t){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t)}function formatBytes(t,o=2){if(0===t)return"0 Bytes";const s=o<0?0:o,l=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,l)).toFixed(s))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][l]}const AA={presence:{name:"presence",stores:{presence:"presence"},version:1},users:{name:"users",stores:{users:"users",usersQuery:"usersQuery",userFilters:"userFilters"},version:2},photos:{name:"photos",stores:{contacts:"contacts",users:"users",groups:"groups",teams:"teams"},version:1},people:{name:"people",stores:{contacts:"contacts",groupPeople:"groupPeople",peopleQuery:"peopleQuery"},version:2},groups:{name:"groups",stores:{groups:"groups",groupsQuery:"groupsQuery"},version:4},get:{name:"responses",stores:{responses:"responses"},version:1},files:{name:"files",stores:{driveFiles:"driveFiles",groupFiles:"groupFiles",siteFiles:"siteFiles",userFiles:"userFiles",insightFiles:"insightFiles",fileQueries:"fileQueries"},version:1},fileLists:{name:"file-lists",stores:{fileLists:"fileLists",insightfileLists:"insightfileLists"},version:1}};var PA,RA,__awaiter$B=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};exports.PersonType=void 0,(PA=exports.PersonType||(exports.PersonType={}))[PA.any=0]="any",PA.person="person",PA.group="group",exports.UserType=void 0,(RA=exports.UserType||(exports.UserType={})).any="any",RA.user="user",RA.contact="contact";const getPeopleInvalidationTime=()=>CacheService.config.people.invalidationPeriod||CacheService.config.defaultInvalidationPeriod,getIsPeopleCacheEnabled=()=>CacheService.config.people.isEnabled&&CacheService.config.isEnabled;function findPeople(t,o,s=10,l=exports.UserType.any,h=""){return __awaiter$B(this,void 0,void 0,(function*(){let v;const m=`${o}:${s}:${l}`;if(getIsPeopleCacheEnabled()){v=CacheService.getCache(AA.people,AA.people.stores.peopleQuery);const t=getIsPeopleCacheEnabled()?yield v.getValue(m):null;if(t&&getPeopleInvalidationTime()>Date.now()-t.timeCached)return t.results.map((t=>JSON.parse(t)))}let _,R="personType/class eq 'Person'";l!==exports.UserType.any&&(l===exports.UserType.user?R+="and personType/subclass eq 'OrganizationUser'":R+="and (personType/subclass eq 'ImplicitContact' or personType/subclass eq 'PersonalContact')"),""!==h&&(R+=`${R} and ${h}`);try{let h=t.api("/me/people").search('"'+o+'"').top(s).filter(R).middlewareOptions(prepScopes("people.read"));if(l!==exports.UserType.contact&&(h=h.header("X-PeopleQuery-QuerySources","Mailbox,Directory")),_=yield h.get(),getIsPeopleCacheEnabled()&&_){const t={maxResults:s,results:null};t.results=_.value.map((t=>JSON.stringify(t))),v.putValue(m,t)}}catch(t){}return _?_.value:null}))}function getPeople(t,o=exports.UserType.any,s=""){return __awaiter$B(this,void 0,void 0,(function*(){let l;const h=s||`*:${o}`;if(getIsPeopleCacheEnabled()){l=CacheService.getCache(AA.people,AA.people.stores.peopleQuery);const t=yield l.getValue(h);if(t&&getPeopleInvalidationTime()>Date.now()-t.timeCached)return t.results.map((t=>JSON.parse(t)))}let v,m="personType/class eq 'Person'";o!==exports.UserType.any&&(o===exports.UserType.user?m+="and personType/subclass eq 'OrganizationUser'":m+="and (personType/subclass eq 'ImplicitContact' or personType/subclass eq 'PersonalContact')"),s&&(m+=` and ${s}`);try{let s=t.api("/me/people").middlewareOptions(prepScopes("people.read")).filter(m);o!=exports.UserType.contact&&(s=s.header("X-PeopleQuery-QuerySources","Mailbox,Directory")),v=yield s.get(),getIsPeopleCacheEnabled()&&v&&l.putValue(h,{maxResults:10,results:v.value.map((t=>JSON.stringify(t)))})}catch(t){}return v?v.value:null}))}function getEmailFromGraphEntity(t){const o=t,s=t,l=t;return s.mail?extractEmailAddress(s.mail):o.scoredEmailAddresses&&o.scoredEmailAddresses.length?extractEmailAddress(o.scoredEmailAddresses[0].address):l.emailAddresses&&l.emailAddresses.length?extractEmailAddress(l.emailAddresses[0].address):null}function findContactsByEmail(t,o){return __awaiter$B(this,void 0,void 0,(function*(){let s;if(getIsPeopleCacheEnabled()){s=CacheService.getCache(AA.people,AA.people.stores.contacts);const t=yield s.getValue(o);if(t&&getPeopleInvalidationTime()>Date.now()-t.timeCached)return JSON.parse(t.person)}const l=`${o.replace(/#/g,"%2523")}`,h=yield t.api("/me/contacts").filter(`emailAddresses/any(a:a/address eq '${l}')`).middlewareOptions(prepScopes("contacts.read")).get();return getIsPeopleCacheEnabled()&&h&&s.putValue(o,{person:JSON.stringify(h.value)}),h?h.value:null}))}var __awaiter$A=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};const getUserInvalidationTime=()=>CacheService.config.users.invalidationPeriod||CacheService.config.defaultInvalidationPeriod,getIsUsersCacheEnabled=()=>CacheService.config.users.isEnabled&&CacheService.config.isEnabled;function getMe(t,o){return __awaiter$A(this,void 0,void 0,(function*(){let s;if(getIsUsersCacheEnabled()){s=CacheService.getCache(AA.users,AA.users.stores.users);const t=yield s.getValue("me");if(t&&getUserInvalidationTime()>Date.now()-t.timeCached){const s=JSON.parse(t.user),l=o?o.filter((t=>!Object.keys(s).includes(t))):null;if(!l||l.length<=1)return s}}let l="me";o&&(l=l+"?$select="+o.toString());const h=t.api(l).middlewareOptions(prepScopes("user.read")).get();return getIsUsersCacheEnabled()&&s.putValue("me",{user:JSON.stringify(yield h)}),h}))}function getUser(t,o,s){return __awaiter$A(this,void 0,void 0,(function*(){let l;if(getIsUsersCacheEnabled()){l=CacheService.getCache(AA.users,AA.users.stores.users);const t=yield l.getValue(o);if(t&&getUserInvalidationTime()>Date.now()-t.timeCached){const o=t.user?JSON.parse(t.user):null,l=s&&o?s.filter((t=>!Object.keys(o).includes(t))):null;if(!l||l.length<=1)return o}}let h,v=`/users/${o}`;s&&(v=v+"?$select="+s.toString());try{h=yield t.api(v).middlewareOptions(prepScopes("user.readbasic.all")).get()}catch(t){}return getIsUsersCacheEnabled()&&l.putValue(o,{user:JSON.stringify(h)}),h}))}function getUsersForUserIds(t,o,s="",l="",h){return __awaiter$A(this,void 0,void 0,(function*(){if(!o||0===o.length)return[];const v=t.createBatch(),m={},_={},R=[];let $;s=s.toLowerCase(),getIsUsersCacheEnabled()&&($=CacheService.getCache(AA.users,AA.users.stores.users));for(const h of o){m[h]=null;let o=`/users/${h}`,B=null;if(getIsUsersCacheEnabled()&&(B=yield $.getValue(h)),(null==B?void 0:B.user)&&getUserInvalidationTime()>Date.now()-B.timeCached)if(B=JSON.parse(null==B?void 0:B.user),s){if(B){const t=B.displayName;t&&t.toLowerCase().includes(s)&&(_[h]=B)}}else B?m[h]=B:(v.get(h,o,["user.readbasic.all"]),R.push(h));else if(""!==h)if("me"===h.toString())m[h]=yield getMe(t);else{let t=`/users/${h}`;l&&(t+=`${t}?$filter=${l}`),v.get(h,t,["user.readbasic.all"]),R.push(h)}}try{if(v.hasRequests){const t=yield v.executeAll();for(const l of o){const o=t.get(l);if(o&&o.content){const t=o.content;if(s){(null==t?void 0:t.displayName.toLowerCase()).contains(s)&&(_[l]=t)}else m[l]=t;getIsUsersCacheEnabled()&&$.putValue(l,{user:JSON.stringify(t)})}else{const t=h.find((t=>Object.values(t).includes(l)));t&&(m[l]=t)}}return s&&Object.keys(_).length?Promise.all(Object.values(_)):Promise.all(Object.values(m))}}catch(s){try{return o.filter((t=>R.includes(t))).forEach((o=>m[o]=getUser(t,o))),getIsUsersCacheEnabled()&&o.filter((t=>R.includes(t))).forEach((t=>__awaiter$A(this,void 0,void 0,(function*(){return $.putValue(t,{user:JSON.stringify(yield m[t])})})))),Promise.all(Object.values(m))}catch(t){return[]}}}))}function findUsers(t,o,s=10,l=""){return __awaiter$A(this,void 0,void 0,(function*(){const h={maxResults:s,results:null};let v;if(getIsUsersCacheEnabled()){v=CacheService.getCache(AA.users,AA.users.stores.usersQuery);const t=yield v.getValue(o);if(t&&getUserInvalidationTime()>Date.now()-t.timeCached)return t.results.map((t=>JSON.parse(t)))}let m,_=`${o.replace(/#/g,"%2523")}`,R=t.api("users").header("ConsistencyLevel","eventual").count(!0).search(`"displayName:${_}" OR "mail:${_}"`);""!==l&&R.filter(l);try{m=yield R.top(s).middlewareOptions(prepScopes("User.ReadBasic.All")).get()}catch(t){}return getIsUsersCacheEnabled()&&m&&(h.results=m.value.map((t=>JSON.stringify(t))),v.putValue(o,h)),m?m.value:null}))}function findGroupMembers(t,o,s,l=10,h=exports.PersonType.person,v=!1,m="",_=""){return __awaiter$A(this,void 0,void 0,(function*(){const R={maxResults:l,results:null};let $;const B=`${s||"*"}:${o||"*"}:${h}:${v}:${m}`;if(getIsUsersCacheEnabled()){$=CacheService.getCache(AA.users,AA.users.stores.usersQuery);const t=yield $.getValue(B);if(t&&getUserInvalidationTime()>Date.now()-t.timeCached)return t.results.map((t=>JSON.parse(t)))}let q="";o&&(q=`startswith(displayName,'${o}') or startswith(givenName,'${o}') or startswith(surname,'${o}') or startswith(mail,'${o}') or startswith(userPrincipalName,'${o}')`);let j=`/groups/${s}/${v?"transitiveMembers":"members"}`;h===exports.PersonType.person?j+="/microsoft.graph.user":h===exports.PersonType.group&&(j+="/microsoft.graph.group",o&&(q=`startswith(displayName,'${o}') or startswith(mail,'${o}')`)),m&&(q+=o?` and ${m}`:m),_&&(q+=o?` and ${_}`:_);const z=yield t.api(j).count(!0).top(l).filter(q).header("ConsistencyLevel","eventual").middlewareOptions(prepScopes("user.read.all","people.read")).get();return getIsUsersCacheEnabled()&&z&&(R.results=z.value.map((t=>JSON.stringify(t))),$.putValue(B,R)),z?z.value:null}))}function findUsersFromGroupIds(t,o,s,l=10,h=exports.PersonType.person,v=!1,m=""){return __awaiter$A(this,void 0,void 0,(function*(){const _=[];for(let R=0;R<s.length;R++){const $=s[R];try{const s=yield findGroupMembers(t,o,$,l,h,v,m);_.push(...s)}catch(t){continue}}return _}))}var __awaiter$z=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};const getPhotoInvalidationTime=()=>CacheService.config.photos.invalidationPeriod||CacheService.config.defaultInvalidationPeriod,getIsPhotosCacheEnabled=()=>CacheService.config.photos.isEnabled&&CacheService.config.isEnabled;function getPhotoForResource(t,o,s){return __awaiter$z(this,void 0,void 0,(function*(){try{const l=yield t.api(`${o}/photo/$value`).responseType(GE.RAW).middlewareOptions(prepScopes(...s)).get();if(404===l.status)return{eTag:null,photo:null};if(!l.ok)return null;const h=l.headers.get("eTag");return{eTag:h,photo:yield blobToBase64(yield l.blob())}}catch(t){return null}}))}function getContactPhoto(t,o){return __awaiter$z(this,void 0,void 0,(function*(){let s,l;return getIsPhotosCacheEnabled()&&(s=CacheService.getCache(AA.photos,AA.photos.stores.contacts),l=yield s.getValue(o),l&&getPhotoInvalidationTime()>Date.now()-l.timeCached)?l.photo:(l=yield getPhotoForResource(t,`me/contacts/${o}`,["contacts.read"]),getIsPhotosCacheEnabled()&&l&&s.putValue(o,l),l?l.photo:null)}))}function getUserPhoto(t,o){return __awaiter$z(this,void 0,void 0,(function*(){let s,l;if(getIsPhotosCacheEnabled()){if(s=CacheService.getCache(AA.photos,AA.photos.stores.users),l=yield s.getValue(o),l&&getPhotoInvalidationTime()>Date.now()-l.timeCached)return l.photo;if(l)try{const s=yield t.api(`users/${o}/photo`).get();s&&(s["@odata.mediaEtag"]!==l.eTag||null===s["@odata.mediaEtag"]&&null===s.eTag)&&(l=null)}catch(t){return null}}return l=l||(yield getPhotoForResource(t,`users/${o}`,["user.readbasic.all"])),getIsPhotosCacheEnabled()&&l&&s.putValue(o,l),l?l.photo:null}))}function getPersonImage(t,o,s=!0){return __awaiter$z(this,void 0,void 0,(function*(){if("personType"in o&&"OrganizationUser"!==o.personType.subclass){if("PersonalContact"===o.personType.subclass&&s){const s=getEmailFromGraphEntity(o),l=yield findContactsByEmail(t,s);if(l&&l.length&&l[0].id)return yield getContactPhoto(t,l[0].id)}return null}if(o.userPrincipalName||o.id){const s=o.userPrincipalName||o.id;return yield getUserPhoto(t,s)}if(o.id){const s=yield getUserPhoto(t,o.id);if(s)return s}const l=getEmailFromGraphEntity(o);if(l){const o=yield findUsers(t,l,1);if(o&&o.length)return yield getUserPhoto(t,o[0].id);if(s){const o=yield findContactsByEmail(t,l);if(o&&o.length)return yield getContactPhoto(t,o[0].id)}}return null}))}function storePhotoInCache(t,o,s){return __awaiter$z(this,void 0,void 0,(function*(){CacheService.getCache(AA.photos,o).putValue(t,s)}))}var __awaiter$y=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};const getPresenceInvalidationTime=()=>CacheService.config.presence.invalidationPeriod||CacheService.config.defaultInvalidationPeriod,getIsPresenceCacheEnabled=()=>CacheService.config.presence.isEnabled&&CacheService.config.isEnabled;function getUserPresence(t,o){return __awaiter$y(this,void 0,void 0,(function*(){let s;if(getIsPresenceCacheEnabled()){s=CacheService.getCache(AA.presence,AA.presence.stores.presence);const t=yield s.getValue(o||"me");if(t&&getPresenceInvalidationTime()>Date.now()-t.timeCached)return JSON.parse(t.presence)}const l=o?["presence.read.all"]:["presence.read"],h=o?`/users/${o}/presence`:"/me/presence",v=yield t.api(h).middlewareOptions(prepScopes(...l)).get();return getIsPresenceCacheEnabled()&&s.putValue(o||"me",{presence:JSON.stringify(v)}),v}))}var OA,$A,__awaiter$x=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};function getUserWithPhoto(t,o,s){return __awaiter$x(this,void 0,void 0,(function*(){let l,h,v=null,m=null;const _=o?`users/${o}`:"me",R=_+(s?`?$select=${s.toString()}`:""),$=o?["user.readbasic.all"]:["user.read"];if(getIsUsersCacheEnabled()){const t=CacheService.getCache(AA.users,AA.users.stores.users);if(h=yield t.getValue(o||"me"),h&&getUserInvalidationTime()>Date.now()-h.timeCached){if(m=h.user?JSON.parse(h.user):null,null!==m&&s){s.filter((t=>!Object.keys(m).includes(t))).length>=1&&(m=null,h=null)}}else h=null}if(getIsPhotosCacheEnabled())if(l=yield function getPhotoFromCache(t,o){return __awaiter$z(this,void 0,void 0,(function*(){const s=CacheService.getCache(AA.photos,o);return yield s.getValue(t)}))}(o||"me",AA.photos.stores.users),l&&getPhotoInvalidationTime()>Date.now()-l.timeCached)v=l.photo;else if(l)try{const s=yield t.api(`${_}/photo`).get();s&&s["@odata.mediaEtag"]&&s["@odata.mediaEtag"]===l.eTag?(storePhotoInCache(o||"me",AA.photos.stores.users,l),v=l.photo):l=null}catch(t){"ErrorItemNotFound"!==t.code&&"ImageNotFound"!==t.code||storePhotoInCache(o||"me",AA.photos.stores.users,{eTag:null,photo:null})}if(l||h)if(l){if(!h)try{const s=yield t.api(R).middlewareOptions(prepScopes(...$)).get();if(s){if(getIsUsersCacheEnabled()){CacheService.getCache(AA.users,AA.users.stores.users).putValue(o||"me",{user:JSON.stringify(s)})}m=s}}catch(t){}}else try{const s=yield getPhotoForResource(t,_,$);s&&(getIsPhotosCacheEnabled()&&storePhotoInCache(o||"me",AA.photos.stores.users,{eTag:s.eTag,photo:s.photo}),v=s.photo)}catch(t){}else{let l;const h=t.createBatch();o?(h.get("user",`/users/${o}${s?"?$select="+s.toString():""}`,["user.readbasic.all"]),h.get("photo",`users/${o}/photo/$value`,["user.readbasic.all"])):(h.get("user","me",["user.read"]),h.get("photo","me/photo/$value",["user.read"]));const _=yield h.executeAll(),R=_.get("photo");R&&(l=R.headers.ETag,v=R.content);const $=_.get("user");if($&&(m=$.content),getIsUsersCacheEnabled()){CacheService.getCache(AA.users,AA.users.stores.users).putValue(o||"me",{user:JSON.stringify(m)})}getIsPhotosCacheEnabled()&&storePhotoInCache(o||"me",AA.photos.stores.users,{eTag:l,photo:v})}return m&&(m.personImage=v),m}))}function getSvg(t,o){switch(t){case $A.ArrowRight:return XI`
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M8 7L4.46481 10.5359L4.46481 7L4.46481 3.46413L8 7Z" />
        </svg>
      `;case $A.ArrowDown:return XI`
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M6 9L2.46447 5.46447H6H9.53553L6 9Z" />
        </svg>
      `;case $A.TeamSeparator:return XI`
        <svg width="6" height="10" viewBox="0 0 6 10" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M5.70711 5L1.49999 9.20711L0.792886 8.50001L4.29289 5L0.792887 1.49999L1.49999 0.792885L5.70711 5Z"
            fill=${o}
          />
        </svg>
      `;case $A.Search:return XI`
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M7.30887 8.01596C6.53903 8.63179 5.56252 9.00004 4.5 9.00004C2.01472 9.00004 0 6.98531 0 4.50002C0 2.01473 2.01472 0 4.5 0C6.98528 0 9 2.01473 9 4.50002C9 5.56252 8.63177 6.53901 8.01597 7.30885L11.8536 11.1464C12.0488 11.3417 12.0488 11.6583 11.8536 11.8536C11.6583 12.0488 11.3417 12.0488 11.1464 11.8536L7.30887 8.01596ZM8 4.50002C8 2.56701 6.433 1 4.5 1C2.567 1 1 2.56701 1 4.50002C1 6.43302 2.567 8.00003 4.5 8.00003C6.433 8.00003 8 6.43302 8 4.50002Z" fill="#212121"/>
        </svg>`;case $A.SkypeArrow:return XI`
        <svg viewBox="0 0 12 10" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M3.95184 0.480534C4.23385 0.10452 4.70926 -0.0724722 5.1685 0.0275755C5.62775 0.127623 5.98645 0.486329 6.0865 0.945575C6.18655 1.40482 6.00956 1.88023 5.63354 2.16224L4.07196 3.72623H10.7988C11.4622 3.72623 12 4.26403 12 4.92744C12 5.59086 11.4622 6.12866 10.7988 6.12866H4.07196L5.63114 7.68784C6.0955 8.15225 6.0955 8.90515 5.63114 9.36955C5.51655 9.48381 5.38119 9.57514 5.23234 9.63862C5.09341 9.69857 4.94399 9.73042 4.79269 9.73232C4.63498 9.73233 4.4789 9.70046 4.33382 9.63862C4.18765 9.57669 4.05593 9.48507 3.94703 9.36955L0.343377 5.7659C-0.114459 5.29881 -0.114459 4.55128 0.343377 4.08419L3.95184 0.480534Z"
            fill="#B4009E"
          />
        </svg>
      `;case $A.SmallEmail:return XI`
        <svg width="17" height="14" viewBox="0 0 17 14" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M13.608 0.833496C14.9887 0.833496 16.108 1.95278 16.108 3.3335V11.3335C16.108 12.7142 14.9887 13.8335 13.608 13.8335H2.60803C1.22732 13.8335 0.108032 12.7142 0.108032 11.3335V3.3335C0.108032 1.95278 1.22732 0.833496 2.60803 0.833496H13.608ZM15.108 4.7945L8.36154 8.76446C8.23115 8.84117 8.07464 8.85395 7.93554 8.80281L7.85452 8.76446L1.10803 4.7965V11.3335C1.10803 12.1619 1.77961 12.8335 2.60803 12.8335H13.608C14.4365 12.8335 15.108 12.1619 15.108 11.3335V4.7945ZM13.608 1.8335H2.60803C1.77961 1.8335 1.10803 2.50507 1.10803 3.3335V3.6355L8.10803 7.75341L15.108 3.6345V3.3335C15.108 2.50507 14.4365 1.8335 13.608 1.8335Z" fill="#023B8F"/>
        </svg>
      `;case $A.SmallEmailHovered:return XI`
      <svg width="17" height="14" viewBox="0 0 17 14" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M16 3.373V10.5C16 11.8807 14.8807 13 13.5 13H2.5C1.11929 13 -7.62939e-05 11.8807 -7.62939e-05 10.5V3.373L7.74649 7.93097C7.90297 8.02301 8.09704 8.02301 8.25351 7.93097L16 3.373ZM13.5 0C14.7871 0 15.847 0.972604 15.9848 2.22293L8 6.91991L0.0151832 2.22293C0.15304 0.972604 1.21294 0 2.5 0H13.5Z" fill="#023B8F"/>
      </svg>
      `;case $A.SmallChat:return XI`
        <svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M8.38599 0.833496C12.8043 0.833496 16.386 4.41522 16.386 8.8335C16.386 13.2518 12.8043 16.8335 8.38599 16.8335C7.11277 16.8335 5.8819 16.5353 4.77267 15.9728L4.65199 15.9085L1.00708 16.8186C0.697255 16.8959 0.41221 16.6704 0.387296 16.3773L0.387128 16.2959L0.400919 16.2122L1.31099 12.5685L1.24768 12.4488C0.792589 11.5521 0.510317 10.5757 0.418733 9.56176L0.393362 9.17984L0.385986 8.8335C0.385986 4.41522 3.96771 0.833496 8.38599 0.833496ZM8.38599 1.8335C4.51999 1.8335 1.38599 4.9675 1.38599 8.8335C1.38599 10.0505 1.69653 11.2213 2.27951 12.2584C2.32645 12.3419 2.34809 12.4365 2.34291 12.5308L2.32873 12.6247L1.57299 15.6455L4.59703 14.8918C4.65892 14.8764 4.72261 14.8731 4.78472 14.8814L4.87629 14.9026L4.963 14.941C5.9996 15.5233 7.16969 15.8335 8.38599 15.8335C12.252 15.8335 15.386 12.6995 15.386 8.8335C15.386 4.9675 12.252 1.8335 8.38599 1.8335ZM8.88599 9.8335C9.16213 9.8335 9.38599 10.0574 9.38599 10.3335C9.38599 10.579 9.20911 10.7831 8.97586 10.8254L8.88599 10.8335H5.88599C5.60984 10.8335 5.38599 10.6096 5.38599 10.3335C5.38599 10.088 5.56286 9.88389 5.79611 9.84155L5.88599 9.8335H8.88599ZM10.886 6.8335C11.1621 6.8335 11.386 7.05735 11.386 7.3335C11.386 7.57896 11.2091 7.7831 10.9759 7.82544L10.886 7.8335L5.88599 7.8335C5.60984 7.8335 5.38599 7.60964 5.38599 7.3335C5.38599 7.08804 5.56286 6.88389 5.79611 6.84155L5.88599 6.8335L10.886 6.8335Z" fill="#023B8F"/>
        </svg>
      `;case $A.SmallChatHovered:return XI`
      <svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M8 0C12.4183 0 16 3.58172 16 8C16 12.4183 12.4183 16 8 16C6.72679 16 5.49591 15.7018 4.38669 15.1393L4.266 15.075L0.621091 15.9851C0.311269 16.0625 0.0262241 15.8369 0.00130987 15.5438L0.00114131 15.4624L0.0149329 15.3787L0.925 11.735L0.86169 11.6153C0.406602 10.7186 0.124331 9.74223 0.0327466 8.72826L0.00737596 8.34634L0 8C0 3.58172 3.58172 0 8 0ZM8.5 9H5.5L5.41012 9.00806C5.17688 9.05039 5 9.25454 5 9.5C5 9.74546 5.17688 9.94961 5.41012 9.99194L5.5 10H8.5L8.58988 9.99194C8.82312 9.94961 9 9.74546 9 9.5C9 9.25454 8.82312 9.05039 8.58988 9.00806L8.5 9ZM10.5 6H5.5L5.41012 6.00806C5.17688 6.05039 5 6.25454 5 6.5C5 6.74546 5.17688 6.94961 5.41012 6.99194L5.5 7H10.5L10.5899 6.99194C10.8231 6.94961 11 6.74546 11 6.5C11 6.25454 10.8231 6.05039 10.5899 6.00806L10.5 6Z" fill="#023B8F"/>
      </svg>
      `;case $A.Video:return XI`
        <svg width="17" height="13" viewBox="0 0 17 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M2.72095 0.833496C1.34024 0.833496 0.220947 1.95278 0.220947 3.3335V10.3335C0.220947 11.7142 1.34024 12.8335 2.72095 12.8335H9.72095C11.1017 12.8335 12.2209 11.7142 12.2209 10.3335V9.33348L14.6209 11.1335C15.2802 11.6279 16.2209 11.1575 16.2209 10.3335V3.33348C16.2209 2.50944 15.2802 2.03905 14.6209 2.53348L12.2209 4.33348V3.3335C12.2209 1.95278 11.1017 0.833496 9.72095 0.833496H2.72095ZM12.2209 5.58348L15.2209 3.33348V10.3335L12.2209 8.08348V5.58348ZM11.2209 3.3335V10.3335C11.2209 11.1619 10.5494 11.8335 9.72095 11.8335H2.72095C1.89252 11.8335 1.22095 11.1619 1.22095 10.3335V3.3335C1.22095 2.50507 1.89252 1.8335 2.72095 1.8335H9.72095C10.5494 1.8335 11.2209 2.50507 11.2209 3.3335Z" fill="#023B8F"/>
        </svg>
      `;case $A.VideoHovered:return XI`
      <svg width="17" height="13" viewBox="0 0 17 13" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M11 2.5C11 1.11929 9.88071 0 8.5 0H2.5C1.11929 0 0 1.11929 0 2.5V9.5C0 10.8807 1.11929 12 2.5 12H8.5C9.88071 12 11 10.8807 11 9.5V2.5ZM12 3.93082V8.08149L14.7642 10.4319C15.2512 10.8461 16 10.4999 16 9.86055V2.19315C16 1.55685 15.2575 1.20962 14.7692 1.61756L12 3.93082Z" fill="#023B8F"/>
      </svg>
      `;case $A.ExpandDown:return XI`
        <svg width="15" height="8" viewBox="0 0 15 8" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M14 1L7.5 7L1 1" stroke="#3078CD" />
        </svg>
      `;case $A.Overview:return XI`
        <svg width="16" height="13" viewBox="0 0 16 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M3.5 10.5C2.67157 10.5 2 9.82843 2 9V4C2 3.17157 2.67157 2.5 3.5 2.5H12.5C13.3284 2.5 14 3.17157 14 4V9C14 9.82843 13.3284 10.5 12.5 10.5H3.5ZM3.5 3.5C3.22386 3.5 3 3.72386 3 4V5.5H13V4C13 3.72386 12.7761 3.5 12.5 3.5H3.5ZM5 6.5H3V9C3 9.27614 3.22386 9.5 3.5 9.5H5V6.5ZM6 9.5H12.5C12.7761 9.5 13 9.27614 13 9V6.5H6V9.5ZM0 3C0 1.61929 1.11929 0.5 2.5 0.5H13.5C14.8807 0.5 16 1.61929 16 3V10C16 11.3807 14.8807 12.5 13.5 12.5H2.5C1.11929 12.5 0 11.3807 0 10V3ZM2.5 1.5C1.67157 1.5 1 2.17157 1 3V10C1 10.8284 1.67157 11.5 2.5 11.5H13.5C14.3284 11.5 15 10.8284 15 10V3C15 2.17157 14.3284 1.5 13.5 1.5H2.5Z" fill="#717171"/>
        </svg>
      `;case $A.Send:return XI`
        <svg xmlns="http://www.w3.org/2000/svg">
          <path
            d="M4.27144 8.99999L1.72572 2.45387C1.54854 1.99826 1.9928 1.56256 2.43227 1.71743L2.50153 1.74688L16.0015 8.49688C16.3902 8.69122 16.4145 9.22336 16.0744 9.45992L16.0015 9.50311L2.50153 16.2531C2.0643 16.4717 1.58932 16.0697 1.70282 15.6178L1.72572 15.5461L4.27144 8.99999L1.72572 2.45387L4.27144 8.99999ZM3.3028 3.4053L5.25954 8.43705L10.2302 8.43749C10.515 8.43749 10.7503 8.64911 10.7876 8.92367L10.7927 8.99999C10.7927 9.28476 10.5811 9.52011 10.3065 9.55736L10.2302 9.56249L5.25954 9.56205L3.3028 14.5947L14.4922 8.99999L3.3028 3.4053Z"
          />
        </svg>
      `;case $A.Contact:return XI`
        <svg width="16" height="12" viewBox="0 0 16 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M6 4.5C6 5.32843 5.32843 6 4.5 6C3.67157 6 3 5.32843 3 4.5C3 3.67157 3.67157 3 4.5 3C5.32843 3 6 3.67157 6 4.5ZM2 7.69879C2 7.17479 2.42479 6.75 2.94879 6.75H6.05121C6.57521 6.75 7 7.17479 7 7.69879C7 8.54603 6.42338 9.28454 5.60144 9.49003L5.54243 9.50478C4.85801 9.67589 4.14199 9.67589 3.45757 9.50478L3.39856 9.49003C2.57661 9.28454 2 8.54603 2 7.69879ZM9.5 4C9.22386 4 9 4.22386 9 4.5C9 4.77614 9.22386 5 9.5 5H12.5C12.7761 5 13 4.77614 13 4.5C13 4.22386 12.7761 4 12.5 4H9.5ZM9.5 7C9.22386 7 9 7.22386 9 7.5C9 7.77614 9.22386 8 9.5 8H12.5C12.7761 8 13 7.77614 13 7.5C13 7.22386 12.7761 7 12.5 7H9.5ZM0 1.75C0 0.783502 0.783502 0 1.75 0H14.25C15.2165 0 16 0.783502 16 1.75V10.25C16 11.2165 15.2165 12 14.25 12H1.75C0.783501 12 0 11.2165 0 10.25V1.75ZM1.75 1C1.33579 1 1 1.33579 1 1.75V10.25C1 10.6642 1.33579 11 1.75 11H14.25C14.6642 11 15 10.6642 15 10.25V1.75C15 1.33579 14.6642 1 14.25 1H1.75Z" fill="#717171"/>
        </svg>
      `;case $A.Call:return XI`
        <svg width="13" height="17" viewBox="0 0 13 17" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M3.9292 0.399388L3.2125 0.615419C1.90898 1.00834 0.951582 2.1215 0.758116 3.46915C0.461142 5.53787 1.12537 7.95591 2.72582 10.728C4.32291 13.4942 6.0808 15.2768 8.01603 16.0565C9.28562 16.5681 10.7369 16.2927 11.7308 15.3515L12.2736 14.8374C13.0011 14.1485 13.1065 13.0275 12.5202 12.215L11.1636 10.3349C10.788 9.81423 10.1226 9.59039 9.50865 9.7781L7.45794 10.4051L7.40494 10.4154C7.17877 10.4485 6.65754 9.95942 6.00741 8.83335C5.32726 7.65531 5.1863 6.96648 5.37408 6.7889L6.41743 5.81598C7.19937 5.08681 7.43039 3.94078 6.99201 2.96562L6.33055 1.49424C5.91866 0.578005 4.89102 0.109471 3.9292 0.399388ZM5.41847 1.90427L6.07993 3.37564C6.34277 3.96031 6.20426 4.64744 5.73543 5.08463L4.68953 6.05994C4.02044 6.69268 4.24206 7.77567 5.14138 9.33335C5.98759 10.799 6.75958 11.5233 7.58908 11.3977L7.71341 11.3711L9.80102 10.7344C10.0057 10.6718 10.2275 10.7464 10.3527 10.92L11.7093 12.8001C12.0024 13.2064 11.9497 13.7669 11.586 14.1113L11.0432 14.6254C10.3333 15.2977 9.29663 15.4944 8.38977 15.129C6.6917 14.4448 5.08689 12.8175 3.59185 10.228C2.09375 7.63319 1.48745 5.42604 1.74797 3.61125C1.88616 2.64864 2.57001 1.85352 3.5011 1.57287L4.2178 1.35684C4.69871 1.21188 5.21253 1.44615 5.41847 1.90427Z" fill="#023B8F"/>
        </svg>
      `;case $A.CallHovered:return XI`
      <svg width="13" height="17" viewBox="0 0 13 17" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M3.98706 1.06589C4.89545 0.792081 5.86254 1.19479 6.31418 2.01224L6.38841 2.16075L7.04987 3.63213C7.46246 4.54992 7.28209 5.61908 6.60754 6.3496L6.47529 6.48248L5.43194 7.45541C5.24417 7.63298 5.38512 8.32181 6.06527 9.49986C6.67716 10.5597 7.17487 11.0552 7.41986 11.0823L7.4628 11.082L7.5158 11.0716L9.56651 10.4446C10.1332 10.2713 10.7438 10.4487 11.1298 10.8865L11.2215 11.0014L12.5781 12.8815C13.1299 13.6462 13.0689 14.6842 12.4533 15.378L12.3314 15.5039L11.7886 16.018C10.7948 16.9592 9.34348 17.2346 8.07389 16.7231C6.13867 15.9433 4.38077 14.1607 2.78368 11.3945C1.18323 8.62242 0.519004 6.20438 0.815977 4.13565C0.99977 2.85539 1.87301 1.78674 3.07748 1.3462L3.27036 1.28192L3.98706 1.06589Z" fill="#023B8F"/>
      </svg>
      `;case $A.Confirmation:return XI`
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M7.03212 13.9072L3.56056 10.0017C3.28538 9.69214 2.81132 9.66425 2.50174 9.93944C2.19215 10.2146 2.16426 10.6887 2.43945 10.9983L6.43945 15.4983C6.72614 15.8208 7.2252 15.8355 7.53034 15.5303L18.0303 5.03033C18.3232 4.73744 18.3232 4.26256 18.0303 3.96967C17.7374 3.67678 17.2626 3.67678 16.9697 3.96967L7.03212 13.9072Z" fill="#009E00"/>
      </svg>
      `;case $A.Copy:return XI`
        <svg width="13" height="14" viewBox="0 0 13 14" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M12.625 5.50293V14H3.875V11.375H0.375V0H6.24707L8.87207 2.625H9.74707L12.625 5.50293ZM10 5.25H11.1279L10 4.12207V5.25ZM3.875 2.625H7.62793L5.87793 0.875H1.25V10.5H3.875V2.625ZM11.75 6.125H9.125V3.5H4.75V13.125H11.75V6.125Z"
          />
        </svg>
      `;case $A.Phone:return XI`
        <svg width="15" height="15" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2048 2048" fill="none">
            <path d="M1607 1213q44 0 84 16t72 48l220 220q31 31 47 71t17 85q0 44-16 84t-48 72l-14 14q-54 54-99 96t-94 70-109 44-143 15q-125 0-257-39t-262-108-256-164-237-207-206-238-162-256T38 775 0 523q0-83 14-142t43-108 70-93 96-99l16-16q31-31 71-48t85-17q44 0 84 17t72 48l220 220q31 31 47 71t17 85q0 44-15 78t-37 63-48 51-49 45-37 44-15 49q0 38 27 65l551 551q27 27 65 27 26 0 48-15t45-37 45-48 51-49 62-37 79-15zm-83 707q72 0 120-13t88-39 76-64 85-86q27-27 27-65 0-18-14-42t-38-52-51-55-56-54-51-47-37-35q-27-27-66-27-26 0-48 15t-44 37-45 48-52 49-62 37-79 15q-44 0-84-16t-72-48L570 927q-31-31-47-71t-17-85q0-44 15-78t37-63 48-51 49-46 37-44 15-48q0-39-27-66-13-13-34-36t-47-51-54-56-56-52-51-37-43-15q-38 0-65 27l-85 85q-37 37-64 76t-40 87-14 120q0 112 36 231t101 238 153 234 192 219 219 190 234 150 236 99 226 36z" fill="${o}"></path>
        </svg>
      `;case $A.CellPhone:return XI`
        <svg width="10" height="16" viewBox="0 0 10 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M4 12C3.72386 12 3.5 12.2239 3.5 12.5C3.5 12.7761 3.72386 13 4 13H6C6.27614 13 6.5 12.7761 6.5 12.5C6.5 12.2239 6.27614 12 6 12H4ZM2 0C0.89543 0 0 0.895431 0 2V14C0 15.1046 0.895431 16 2 16H8C9.10457 16 10 15.1046 10 14V2C10 0.89543 9.10457 0 8 0H2ZM1 2C1 1.44772 1.44772 1 2 1H8C8.55228 1 9 1.44772 9 2V14C9 14.5523 8.55228 15 8 15H2C1.44772 15 1 14.5523 1 14V2Z" fill="#717171"/>
        </svg>
      `;case $A.Chat:return XI`
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M8 0C12.4183 0 16 3.58172 16 8C16 12.4183 12.4183 16 8 16C6.72679 16 5.49591 15.7018 4.38669 15.1393L4.266 15.075L0.621091 15.9851C0.311269 16.0625 0.0262241 15.8369 0.00130987 15.5438L0.00114131 15.4624L0.0149329 15.3787L0.925 11.735L0.86169 11.6153C0.406602 10.7186 0.124331 9.74223 0.0327466 8.72826L0.00737596 8.34634L0 8C0 3.58172 3.58172 0 8 0ZM8 1C4.13401 1 1 4.13401 1 8C1 9.21704 1.31054 10.3878 1.89352 11.4249C1.94046 11.5084 1.9621 11.603 1.95692 11.6973L1.94274 11.7912L1.187 14.812L4.21104 14.0583C4.27294 14.0429 4.33662 14.0396 4.39873 14.0479L4.4903 14.0691L4.57701 14.1075C5.61362 14.6898 6.7837 15 8 15C11.866 15 15 11.866 15 8C15 4.13401 11.866 1 8 1ZM8.5 9C8.77614 9 9 9.22386 9 9.5C9 9.74546 8.82312 9.94961 8.58988 9.99194L8.5 10H5.5C5.22386 10 5 9.77614 5 9.5C5 9.25454 5.17688 9.05039 5.41012 9.00806L5.5 9H8.5ZM10.5 6C10.7761 6 11 6.22386 11 6.5C11 6.74546 10.8231 6.94961 10.5899 6.99194L10.5 7L5.5 7C5.22386 7 5 6.77614 5 6.5C5 6.25454 5.17688 6.05039 5.41012 6.00806L5.5 6L10.5 6Z" fill="#717171"/>
        </svg>
      `;case $A.Department:return XI`
        <svg width="17" height="14" viewBox="0 0 17 14" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M4 1.5V3H2C0.895431 3 0 3.89543 0 5V12C0 13.1046 0.895432 14 2 14H14.0026C15.1071 14 16.0026 13.1046 16.0026 12V5C16.0026 3.89543 15.1071 3 14.0026 3H12V1.5C12 0.671573 11.3284 0 10.5 0H5.5C4.67157 0 4 0.671573 4 1.5ZM5.5 1H10.5C10.7761 1 11 1.22386 11 1.5V3H5V1.5C5 1.22386 5.22386 1 5.5 1ZM2 4H14.0026C14.5549 4 15.0026 4.44772 15.0026 5V7H12L12 6.50073C12 6.22459 11.7761 6.00073 11.5 6.00073C11.2239 6.00073 11 6.22459 11 6.50074L11 7H5V6.50073C5 6.22459 4.77614 6.00073 4.5 6.00073C4.22386 6.00073 4 6.22459 4 6.50073V7H1V5C1 4.44772 1.44772 4 2 4ZM11 8L11 8.5C11 8.77615 11.2239 9 11.5 9C11.7762 9 12 8.77614 12 8.5L12 8H15.0026V12C15.0026 12.5523 14.5549 13 14.0026 13H2C1.44772 13 1 12.5523 1 12V8H4V8.5C4 8.77614 4.22386 9 4.5 9C4.77614 9 5 8.77614 5 8.5V8H11Z" fill="#717171"/>
        </svg>
      `;case $A.Email:return XI`
        <svg width="16" height="13" viewBox="0 0 16 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M13.5 0C14.8807 0 16 1.11929 16 2.5V10.5C16 11.8807 14.8807 13 13.5 13H2.5C1.11929 13 0 11.8807 0 10.5V2.5C0 1.11929 1.11929 0 2.5 0H13.5ZM15 3.961L8.25351 7.93097C8.12311 8.00767 7.96661 8.02045 7.82751 7.96932L7.74649 7.93097L1 3.963V10.5C1 11.3284 1.67157 12 2.5 12H13.5C14.3284 12 15 11.3284 15 10.5V3.961ZM13.5 1H2.5C1.67157 1 1 1.67157 1 2.5V2.802L8 6.91991L15 2.801V2.5C15 1.67157 14.3284 1 13.5 1Z" fill="#717171"/>
        </svg>
      `;case $A.OfficeLocation:return XI`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M5.84303 4.56789C9.24344 1.16748 14.7566 1.16748 18.157 4.56789C21.5574 7.9683 21.5574 13.4815 18.157 16.8819L16.97 18.0558C16.0952 18.9144 14.96 20.0184 13.5642 21.3679C12.6919 22.2113 11.3081 22.2112 10.436 21.3677L6.9449 17.9718C6.50614 17.541 6.13887 17.1777 5.84303 16.8819C2.44262 13.4815 2.44262 7.9683 5.84303 4.56789ZM17.0963 5.62855C14.2817 2.81392 9.71832 2.81392 6.90369 5.62855C4.08907 8.44317 4.08907 13.0066 6.90369 15.8212L8.39077 17.2887C9.20967 18.0901 10.2391 19.0905 11.4788 20.2895C11.7695 20.5706 12.2308 20.5707 12.5215 20.2896L15.9164 16.9881C16.3854 16.5278 16.7787 16.1388 17.0963 15.8212C19.911 13.0066 19.911 8.44317 17.0963 5.62855ZM12 7.99854C13.6577 7.99854 15.0016 9.34238 15.0016 11.0001C15.0016 12.6578 13.6577 14.0016 12 14.0016C10.3423 14.0016 8.99847 12.6578 8.99847 11.0001C8.99847 9.34238 10.3423 7.99854 12 7.99854ZM12 9.49854C11.1707 9.49854 10.4985 10.1708 10.4985 11.0001C10.4985 11.8294 11.1707 12.5016 12 12.5016C12.8293 12.5016 13.5016 11.8294 13.5016 11.0001C13.5016 10.1708 12.8293 9.49854 12 9.49854Z" fill="#212121" />
        </svg>
      `;case $A.Birthday:return XI`
        <svg width="14" height="13" viewBox="0 0 14 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M5.81357 0.667333C6.07581 0.320242 6.48151 0 7 0C7.51849 0 7.92419 0.320242 8.18643 0.667333C8.45471 1.0224 8.63508 1.47991 8.69561 1.93392C8.75552 2.3832 8.70532 2.89341 8.42852 3.3086C8.134 3.75039 7.63965 4 7 4C6.36035 4 5.866 3.75039 5.57148 3.3086C5.29468 2.89341 5.24448 2.3832 5.30439 1.93392C5.36492 1.47991 5.54529 1.0224 5.81357 0.667333ZM6.40353 2.7539C6.484 2.87461 6.63965 3 7 3C7.36035 3 7.516 2.87461 7.59647 2.7539C7.69468 2.60659 7.74448 2.3668 7.70439 2.06608C7.66492 1.77009 7.54529 1.4776 7.38857 1.27017C7.22581 1.05476 7.08151 1 7 1C6.91849 1 6.77419 1.05476 6.61143 1.27017C6.45471 1.4776 6.33508 1.77009 6.29561 2.06608C6.25552 2.3668 6.30532 2.60659 6.40353 2.7539ZM1 7C1 5.89543 1.89543 5 3 5H11C12.1046 5 13 5.89543 13 7V12H13.5C13.7761 12 14 12.2239 14 12.5C14 12.7761 13.7761 13 13.5 13H0.5C0.223858 13 0 12.7761 0 12.5C0 12.2239 0.223858 12 0.5 12H1V7ZM2 12H12V9.01931C11.9109 9.10285 11.8174 9.18842 11.7208 9.27412C11.4006 9.55804 11.0346 9.85319 10.6715 10.0802C10.3274 10.2953 9.90815 10.5 9.5 10.5C8.77182 10.5 8.30806 9.98986 8.00471 9.65617C7.9834 9.63273 7.96289 9.61016 7.94312 9.58869C7.5876 9.20261 7.35769 9 7 9C6.64231 9 6.4124 9.20261 6.05688 9.58869C6.03711 9.61016 6.0166 9.63273 5.99529 9.65617C5.69194 9.98986 5.22818 10.5 4.5 10.5C4.10587 10.5 3.69263 10.2897 3.35907 10.0789C3.00198 9.85313 2.63516 9.55951 2.31117 9.27666C2.20329 9.18247 2.09896 9.08844 2 8.9971V12ZM2 7.59993C2.05039 7.65198 2.11363 7.71652 2.1873 7.7902C2.38843 7.99132 2.6649 8.25801 2.96883 8.52334C3.27484 8.79049 3.59802 9.04687 3.89343 9.23362C4.21237 9.43525 4.41413 9.5 4.5 9.5C4.75817 9.5 4.93171 9.33433 5.32125 8.91131L5.32447 8.90781C5.65956 8.5439 6.16039 8 7 8C7.83961 8 8.34044 8.5439 8.67553 8.90781L8.67875 8.91131C9.06828 9.33433 9.24183 9.5 9.5 9.5C9.6106 9.5 9.82569 9.42967 10.1414 9.23229C10.4381 9.04681 10.7573 8.79196 11.0573 8.52588C11.3554 8.26163 11.6238 7.99594 11.8184 7.7955C11.89 7.72165 11.9513 7.65703 12 7.60506V7C12 6.44772 11.5523 6 11 6H3C2.44772 6 2 6.44772 2 7V7.59993Z" fill="#717171"/>
        </svg>
      `;case $A.Person:return XI`
        <svg width="14" height="16" viewBox="0 0 14 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M7 0C4.79086 0 3 1.79086 3 4C3 6.20914 4.79086 8 7 8C9.20914 8 11 6.20914 11 4C11 1.79086 9.20914 0 7 0ZM4 4C4 2.34315 5.34315 1 7 1C8.65685 1 10 2.34315 10 4C10 5.65685 8.65685 7 7 7C5.34315 7 4 5.65685 4 4ZM2.00873 9C0.903151 9 0 9.88687 0 11C0 12.6912 0.83281 13.9663 2.13499 14.7966C3.41697 15.614 5.14526 16 7 16C8.85474 16 10.583 15.614 11.865 14.7966C13.1672 13.9663 14 12.6912 14 11C14 9.89557 13.1045 9.00001 12 9.00001L2.00873 9ZM1 11C1 10.4467 1.44786 10 2.00873 10L12 10C12.5522 10 13 10.4478 13 11C13 12.3088 12.3777 13.2837 11.3274 13.9534C10.2568 14.636 8.73511 15 7 15C5.26489 15 3.74318 14.636 2.67262 13.9534C1.62226 13.2837 1 12.3088 1 11Z" fill="#717171"/>
        </svg>
      `;case $A.Messages:return XI`
        <svg width="16" height="13" viewBox="0 0 16 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M13.5 0C14.8807 0 16 1.11929 16 2.5V10.5C16 11.8807 14.8807 13 13.5 13H2.5C1.11929 13 0 11.8807 0 10.5V2.5C0 1.11929 1.11929 0 2.5 0H13.5ZM15 3.961L8.25351 7.93097C8.12311 8.00767 7.96661 8.02045 7.82751 7.96932L7.74649 7.93097L1 3.963V10.5C1 11.3284 1.67157 12 2.5 12H13.5C14.3284 12 15 11.3284 15 10.5V3.961ZM13.5 1H2.5C1.67157 1 1 1.67157 1 2.5V2.802L8 6.91991L15 2.801V2.5C15 1.67157 14.3284 1 13.5 1Z" fill="#717171"/>
        </svg>
      `;case $A.Organization:return XI`
        <svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M7.99992 0C6.34271 0 4.99927 1.34344 4.99927 3.00066C4.99927 4.48754 6.08073 5.72183 7.49999 5.95985V7.5H4.5C3.67157 7.5 3 8.17157 3 9V10.0416C1.5811 10.2799 0.5 11.514 0.5 13.0007C0.5 14.6579 1.84344 16.0013 3.50066 16.0013C5.15787 16.0013 6.50131 14.6579 6.50131 13.0007C6.50131 11.5136 5.41954 10.2791 4 10.0414V9C4 8.72386 4.22386 8.5 4.5 8.5H11.5C11.7761 8.5 12 8.72386 12 9V10.0416C10.5811 10.2799 9.5 11.514 9.5 13.0007C9.5 14.6579 10.8434 16.0013 12.5007 16.0013C14.1579 16.0013 15.5013 14.6579 15.5013 13.0007C15.5013 11.5136 14.4195 10.2791 13 10.0414V9C13 8.17157 12.3284 7.5 11.5 7.5H8.49999V5.95983C9.91918 5.72176 11.0006 4.48749 11.0006 3.00066C11.0006 1.34344 9.65714 0 7.99992 0ZM5.99927 3.00066C5.99927 1.89572 6.89499 1 7.99992 1C9.10485 1 10.0006 1.89572 10.0006 3.00066C10.0006 4.10559 9.10485 5.00131 7.99992 5.00131C6.89499 5.00131 5.99927 4.10559 5.99927 3.00066ZM1.5 13.0007C1.5 11.8957 2.39572 11 3.50066 11C4.60559 11 5.50131 11.8957 5.50131 13.0007C5.50131 14.1056 4.60559 15.0013 3.50066 15.0013C2.39572 15.0013 1.5 14.1056 1.5 13.0007ZM12.5007 11C13.6056 11 14.5013 11.8957 14.5013 13.0007C14.5013 14.1056 13.6056 15.0013 12.5007 15.0013C11.3957 15.0013 10.5 14.1056 10.5 13.0007C10.5 11.8957 11.3957 11 12.5007 11Z" fill="#717171"/>
        </svg>
      `;case $A.ExpandRight:return XI`
        <svg width="8" height="13" viewBox="0 0 8 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M1 12L6.5 6.5L1 1" stroke="#B8B8B8" stroke-width="2" />
        </svg>
      `;case $A.Profile:return XI`
        <svg width="14" height="16" viewBox="0 0 14 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M7 0C4.79086 0 3 1.79086 3 4C3 6.20914 4.79086 8 7 8C9.20914 8 11 6.20914 11 4C11 1.79086 9.20914 0 7 0ZM4 4C4 2.34315 5.34315 1 7 1C8.65685 1 10 2.34315 10 4C10 5.65685 8.65685 7 7 7C5.34315 7 4 5.65685 4 4ZM2.00873 9C0.903151 9 0 9.88687 0 11C0 12.6912 0.83281 13.9663 2.13499 14.7966C3.41697 15.614 5.14526 16 7 16C8.85474 16 10.583 15.614 11.865 14.7966C13.1672 13.9663 14 12.6912 14 11C14 9.89557 13.1045 9.00001 12 9.00001L2.00873 9ZM1 11C1 10.4467 1.44786 10 2.00873 10L12 10C12.5522 10 13 10.4478 13 11C13 12.3088 12.3777 13.2837 11.3274 13.9534C10.2568 14.636 8.73511 15 7 15C5.26489 15 3.74318 14.636 2.67262 13.9534C1.62226 13.2837 1 12.3088 1 11Z" fill="#717171"/>
        </svg>
      `;case $A.File:return XI`
        <svg width="28" height="28" viewBox="0 0 20 28" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            opacity="0.64"
            d="M19.613 6.993L13.018 0.421C12.7473 0.15221 12.3815 0.000947397 12 0H1.4C0.628 0 0 0.615 0 1.372V24.642C0 25.391 0.622 26 1.386 26H18.6C19.372 26 20 25.385 20 24.628V7.923C20 7.577 19.86 7.237 19.613 6.993Z"
            fill="#605E5C"
          />
          <path
            d="M19 24.628C19 24.83 18.816 25 18.6 25H1.386C1.173 25 1 24.84 1 24.642V1.372C1 1.17 1.184 1 1.4 1H12V6.6C12 7.372 12.628 8 13.4 8H19V24.628Z"
            fill="white"
          />
          <path d="M18.204 6.99994L13 1.81494V6.59994C13 6.81994 13.18 6.99994 13.4 6.99994H18.204Z" fill="white" />
        </svg>
      `;case $A.Files:return XI`
        <svg width="17" height="15" viewBox="0 0 17 15" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M14.9956 4.07309V4C14.9956 2.61929 13.8763 1.5 12.4956 1.5H7.66418L6.06391 0.299946C5.80428 0.105247 5.48851 0 5.16399 0H2.5C1.11916 0 -0.000181445 1.11949 2.20615e-08 2.50033L0.0011832 11.4978C0.00135142 12.7772 0.962583 13.8321 2.2023 13.9798C2.2867 13.9945 2.37375 14.0021 2.46289 14.0021H13.1798C13.8981 14.0021 14.5156 13.4929 14.6524 12.7877L16.0097 5.78769C16.1587 5.01967 15.696 4.29703 14.9956 4.07309ZM2.5 1H5.16399C5.27216 1 5.37742 1.03508 5.46396 1.09998L7.19756 2.40002C7.2841 2.46492 7.38936 2.5 7.49753 2.5H12.4956C13.324 2.5 13.9956 3.17157 13.9956 4V4.00214H3.824C3.10596 4.00214 2.48863 4.511 2.35158 5.21583L1.05351 11.8916C1.01941 11.7661 1.0012 11.634 1.00118 11.4976L1 2.5002C0.999891 1.67169 1.6715 1 2.5 1ZM3.33319 5.4067C3.37888 5.17176 3.58465 5.00214 3.824 5.00214H14.5372C14.8515 5.00214 15.0879 5.28874 15.028 5.59732L13.6706 12.5973C13.6251 12.8324 13.4192 13.0021 13.1798 13.0021H2.46289C2.14845 13.0021 1.91206 12.7154 1.97208 12.4067L3.33319 5.4067Z" fill="#717171"/>
        </svg>
      `;case $A.Back:return XI`
        <svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M16 8.5H1.95312L8.10156 14.6484L7.39844 15.3516L0.046875 8L7.39844 0.648438L8.10156 1.35156L1.95312 7.5H16V8.5Z"
          />
        </svg>
      `;case $A.Close:return XI`
        <svg width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M5.73838 5.032L9.70337 1.067L8.99638 0.360001L5.03137 4.325L1.06637 0.360001L0.359375 1.067L4.32438 5.032L0.359375 8.997L1.06637 9.704L5.03137 5.739L8.99638 9.704L9.70337 8.997L5.73838 5.032Z" fill="black"/>
        </svg>
     `;case $A.Upload:return XI`
        <svg class="upload-icon" width="21" height="12" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M4.5 2C4.08579 2 3.75 2.33579 3.75 2.75C3.75 3.16421 4.08579 3.5 4.5 3.5H15C15.4142 3.5 15.75 3.16421 15.75 2.75C15.75 2.33579 15.4142 2 15 2H4.5ZM10.4963 17.3493C10.4466 17.7154 10.1328 17.9976 9.75311 17.9976C9.3389 17.9976 9.00311 17.6618 9.00311 17.2476L9.00249 7.05856L6.02995 10.026L5.94578 10.0986C5.65202 10.3162 5.23537 10.2917 4.96929 10.0253C4.67661 9.73215 4.67695 9.25728 4.97005 8.96459L9.25962 4.67989C9.33377 4.61512 9.42089 4.56485 9.5169 4.53385L9.59777 4.51072C9.64749 4.50019 9.69837 4.4947 9.74849 4.4947L9.80855 4.49661L9.87781 4.50451L9.99828 4.53462L10.0895 4.57254L10.1259 4.59371L10.2169 4.6523L10.2875 4.71481L14.5303 8.96546L14.6029 9.04964C14.8205 9.34345 14.7959 9.7601 14.5294 10.0261L14.4452 10.0987C14.1514 10.3162 13.7347 10.2917 13.4687 10.0251L10.5025 7.05456L10.5031 17.2476L10.4963 17.3493Z" fill="#ffffff"/>
        </svg>
      `;case $A.FileCloud:return XI`
        <svg width="16" height="16"  xmlns="http://www.w3.org/2000/svg">
          <path
            d="m8,0c2.8166,0 4.4145,1.9233 4.6469,4.246l0.071,0c1.8127,0 3.2821,1.5119 3.2821,3.377c0,0.0953 -0.0038,0.1897 -0.0114,0.283c-0.322,-0.4017 -0.6967,-0.7591 -1.1138,-1.062c-0.3104,-0.9329 -1.1627,-1.598 -2.1568,-1.598l-0.0711,0c-0.5137,0 -0.9439,-0.3893 -0.9951,-0.9005c-0.2021,-2.0206 -1.5433,-3.3455 -3.6518,-3.3455c-2.1139,0 -3.4489,1.3159 -3.6518,3.3455c-0.0511,0.5112 -0.4813,0.9005 -0.9951,0.9005l-0.071,0c-1.2539,0 -2.2821,1.0579 -2.2821,2.377c0,1.3191 1.0282,2.377 2.2821,2.377l2.6655,0c-0.087,0.323 -0.1466,0.6572 -0.1762,1l-2.4893,0c-1.8127,0 -3.2821,-1.5119 -3.2821,-3.377c0,-1.8029 1.3731,-3.2758 3.102,-3.372l0.2511,-0.005c0.2338,-2.338 1.8303,-4.246 4.6469,-4.246zm3.5,16c2.4853,0 4.5,-2.0147 4.5,-4.5c0,-2.4853 -2.0147,-4.5 -4.5,-4.5c-2.4853,0 -4.5,2.0147 -4.5,4.5c0,2.4853 2.0147,4.5 4.5,4.5zm0,-7c0.2761,0 0.5,0.2239 0.5,0.5l0,1.5l1.5,0c0.2761,0 0.5,0.2239 0.5,0.5c0,0.2761 -0.2239,0.5 -0.5,0.5l-1.5,0l0,1.5c0,0.2761 -0.2239,0.5 -0.5,0.5c-0.2761,0 -0.5,-0.2239 -0.5,-0.5l0,-1.5l-1.5,0c-0.2761,0 -0.5,-0.2239 -0.5,-0.5c0,-0.2761 0.2239,-0.5 0.5,-0.5l1.5,0l0,-1.5c0,-0.2761 0.2239,-0.5 0.5,-0.5z" fill="#0078D4"
          />
        </svg>
      `;case $A.DragFile:return XI`
        <svg width="13" height="16" xmlns="http://www.w3.org/2000/svg">
          <path
            d="m0,1.00189c0,-0.8451 0.983,-1.3091 1.636,-0.772l11.006,9.0622c0.724,0.5964 0.302,1.772 -0.636,1.772l-5.592,0c-0.435,0 -0.849,0.1892 -1.134,0.5185l-3.524,4.0725c-0.606,0.7003 -1.756,0.2717 -1.756,-0.6544l0,-13.9988zm12.006,9.0622l-11.006,-9.0622l0,13.9988l3.524,-4.0724c0.475,-0.5488 1.164,-0.8642 1.89,-0.8642l5.592,0z"
          />
        </svg>
      `;case $A.Cancel:return XI`
        <svg class="cancel-icon" width="10" height="10" xmlns="http://www.w3.org/2000/svg">
          <path
          d="m5.52795,4.92946l4.37418,4.36141l-0.57055,0.56806l-4.38052,-4.35509l-4.38052,4.35509l-0.57055,-0.56806l4.37418,-4.36141l-4.37418,-4.36141l0.57055,-0.56806l4.38052,4.35509l4.38052,-4.35509l0.57055,0.56806l-4.37418,4.36141z"
          />
        </svg>
      `;case $A.Success:return XI`
        <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
          <path fill="#009E00" d="m6.322,12c3.492,0 6.323,-2.6863 6.323,-6c0,-3.3137 -2.831,-6 -6.323,-6c-3.491,0 -6.322,2.6863 -6.322,6c0,3.3137 2.831,6 6.322,6z"/>
          <path fill="white" d="m9.629,3.7509c-0.131,-0.125 -0.31,-0.1952 -0.496,-0.1952c-0.187,0 -0.365,0.0702 -0.497,0.1952l-3.267,3.1l-1.393,-1.3222c-0.177,-0.1695 -0.436,-0.2361 -0.68,-0.1746c-0.243,0.0615 -0.433,0.2418 -0.497,0.4725c-0.065,0.2307 0.005,0.4767 0.184,0.6449l1.807,1.7154c0.019,0.0331 0.041,0.0646 0.066,0.094c0.289,0.2562 0.738,0.2562 1.027,0c0.024,-0.0294 0.047,-0.0609 0.065,-0.0941l3.681,-3.4931c0.275,-0.2603 0.275,-0.6824 0,-0.9428z"/>
        </svg>
      `;case $A.Fail:return XI`
        <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
          <path fill="#EF355D" d="m6,12c3.314,0 6,-2.6863 6,-6c0,-3.3137 -2.686,-6 -6,-6c-3.314,0 -6,2.6863 -6,6c0,3.3137 2.686,6 6,6z"/>
          <path fill="white" d="m6.943,6.0004l1.544,-1.5444c0.169,-0.1683 0.236,-0.4142 0.174,-0.6448c-0.061,-0.2306 -0.241,-0.4107 -0.472,-0.4722c-0.231,-0.0616 -0.477,0.0049 -0.645,0.1742l-1.544,1.5443l-1.545,-1.5443c-0.26,-0.259 -0.681,-0.2583 -0.941,0.0014c-0.26,0.2598 -0.26,0.6808 -0.001,0.9414l1.544,1.5444l-1.544,1.5444c-0.259,0.2606 -0.259,0.6815 0.001,0.9413c0.26,0.2598 0.681,0.2604 0.941,0.0015l1.545,-1.5444l1.544,1.5444c0.261,0.2589 0.682,0.2583 0.942,-0.0015c0.259,-0.2598 0.26,-0.6807 0.001,-0.9413l-1.544,-1.5444z" />
        </svg>
      `;case $A.SelectAccount:return XI`
    <svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 17 17" fill="none">
      <path fill=${o} d="M6.22176 13.9567C3.55468 13.653 2 11.8026 2 10V9.5C2 8.67157 2.67157 8 3.5 8H5.59971C5.43777 8.31679 5.30564 8.65136 5.20703 9H3.5C3.22386 9 3 9.22386 3 9.5V10C3 11.1281 3.88187 12.333 5.50235 12.7996C5.69426 13.216 5.93668 13.6043 6.22176 13.9567ZM9.62596 5.06907C9.70657 4.81036 9.75 4.53525 9.75 4.25C9.75 2.73122 8.51878 1.5 7 1.5C5.48122 1.5 4.25 2.73122 4.25 4.25C4.25 5.53662 5.13357 6.61687 6.32704 6.91706C6.64202 6.55055 7.00446 6.226 7.40482 5.95294C7.27488 5.98371 7.13934 6 7 6C6.0335 6 5.25 5.2165 5.25 4.25C5.25 3.2835 6.0335 2.5 7 2.5C7.9665 2.5 8.75 3.2835 8.75 4.25C8.75 4.73141 8.55561 5.16743 8.24104 5.48382C8.67558 5.28783 9.14016 5.14664 9.62596 5.06907ZM10.5 15C12.9853 15 15 12.9853 15 10.5C15 8.01472 12.9853 6 10.5 6C8.01472 6 6 8.01472 6 10.5C6 12.9853 8.01472 15 10.5 15ZM10.5 8C10.7761 8 11 8.22386 11 8.5V10H12.5C12.7761 10 13 10.2239 13 10.5C13 10.7761 12.7761 11 12.5 11H11V12.5C11 12.7761 10.7761 13 10.5 13C10.2239 13 10 12.7761 10 12.5V11H8.5C8.22386 11 8 10.7761 8 10.5C8 10.2239 8.22386 10 8.5 10H10V8.5C10 8.22386 10.2239 8 10.5 8Z"/>
    </svg>
  `}}function isWindowSegmentAware(){return void 0!==window.getWindowSegments}exports.ViewType=void 0,(OA=exports.ViewType||(exports.ViewType={}))[OA.image=2]="image",OA[OA.oneline=3]="oneline",OA[OA.twolines=4]="twolines",OA[OA.threelines=5]="threelines",OA[OA.fourlines=6]="fourlines",function(t){t[t.ArrowRight=0]="ArrowRight",t[t.ArrowDown=1]="ArrowDown",t[t.TeamSeparator=2]="TeamSeparator",t[t.Search=3]="Search",t[t.SkypeArrow=4]="SkypeArrow",t[t.SmallEmail=5]="SmallEmail",t[t.SmallEmailHovered=6]="SmallEmailHovered",t[t.SmallChat=7]="SmallChat",t[t.SmallChatHovered=8]="SmallChatHovered",t[t.Video=9]="Video",t[t.VideoHovered=10]="VideoHovered",t[t.ExpandDown=11]="ExpandDown",t[t.Overview=12]="Overview",t[t.Send=13]="Send",t[t.Contact=14]="Contact",t[t.Copy=15]="Copy",t[t.Phone=16]="Phone",t[t.CellPhone=17]="CellPhone",t[t.Chat=18]="Chat",t[t.Call=19]="Call",t[t.CallHovered=20]="CallHovered",t[t.Confirmation=21]="Confirmation",t[t.Department=22]="Department",t[t.Email=23]="Email",t[t.OfficeLocation=24]="OfficeLocation",t[t.Person=25]="Person",t[t.Messages=26]="Messages",t[t.Organization=27]="Organization",t[t.ExpandRight=28]="ExpandRight",t[t.Profile=29]="Profile",t[t.Birthday=30]="Birthday",t[t.File=31]="File",t[t.Files=32]="Files",t[t.Back=33]="Back",t[t.Close=34]="Close",t[t.Upload=35]="Upload",t[t.FileCloud=36]="FileCloud",t[t.DragFile=37]="DragFile",t[t.Cancel=38]="Cancel",t[t.Success=39]="Success",t[t.Fail=40]="Fail",t[t.SelectAccount=41]="SelectAccount"}($A||($A={}));const NA=[i$4`
.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.root .scout-top{position:fixed;top:0;left:0}.root .scout-bottom{position:fixed;bottom:0;right:0}.root .flyout{display:none;position:fixed;z-index:9999999;opacity:0;box-shadow:var(--box-shadow,0 3.2px 7.2px 0 rgba(0,0,0,.132));border-radius:8px}.root .flyout.small{overflow-y:auto;overflow-x:hidden}.root.visible .flyout{display:inline-block;animation-name:fadeIn;animation-duration:.3s;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;transition:top .3s ease,bottom .3s ease,left .3s ease}.root.visible .flyout.small{overflow-y:auto;overflow-x:hidden}@keyframes fadeIn{from{opacity:0;margin-top:-10px;margin-bottom:-10px}to{opacity:1;margin-top:0;margin-bottom:0}}
`];var __decorate$v=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},__metadata$t=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)};let MA=class MgtFlyout extends MgtBaseComponent{static get styles(){return NA}get isOpen(){return this._isOpen}set isOpen(t){const o=this._isOpen;o!==t&&(this._isOpen=t,window.requestAnimationFrame((()=>{this.setupWindowEvents(this.isOpen);const t=this._flyout;!this.isOpen&&t&&(t.style.width=null,t.style.setProperty("--mgt-flyout-set-width",null),t.style.setProperty("--mgt-flyout-set-height",null),t.style.maxHeight=null,t.style.top=null,t.style.left=null,t.style.bottom=null)})),this.requestUpdate("isOpen",o),this.dispatchEvent(new Event(t?"opened":"closed")))}get _flyout(){return this.renderRoot.querySelector(".flyout")}get _anchor(){return this.renderRoot.querySelector(".anchor")}get _topScout(){return this.renderRoot.querySelector(".scout-top")}get _bottomScout(){return this.renderRoot.querySelector(".scout-bottom")}constructor(){super(),this._edgePadding=24,this._renderedOnce=!1,this._isOpen=!1,this._smallView=!1,this.avoidHidingAnchor=!0,this.handleWindowEvent=this.handleWindowEvent.bind(this),this.handleResize=this.handleResize.bind(this),this.handleKeyUp=this.handleKeyUp.bind(this),this.addEventListener("expanded",(()=>{window.requestAnimationFrame((()=>{this.updateFlyout()}))}))}open(){this.isOpen=!0}close(){this.isOpen=!1}disconnectedCallback(){this.setupWindowEvents(!1),super.disconnectedCallback()}updated(t){super.updated(t),window.requestAnimationFrame((()=>{this.updateFlyout()}))}render(){const t={dir:this.direction,root:!0,visible:this.isOpen},o=this.renderAnchor();let s=null;return this._windowHeight=window.innerHeight&&document.documentElement.clientHeight?Math.min(window.innerHeight,document.documentElement.clientHeight):window.innerHeight||document.documentElement.clientHeight,this._windowHeight<250&&(this._smallView=!0),(this.isOpen||this._renderedOnce)&&(this._renderedOnce=!0,s=XI`
        <div class=${this._smallView?"flyout small":"flyout"} @wheel=${this.handleFlyoutWheel}>
          ${this.renderFlyout()}
        </div>
      `),XI`
      <div class=${IA(t)}>
        <div class="anchor">
          ${o}
        </div>
        <div class="scout-top"></div>
        <div class="scout-bottom"></div>
        ${s}
      </div>
    `}renderAnchor(){return XI`
      <slot></slot>
    `}renderFlyout(){return XI`
      <slot name="flyout"></slot>
    `}updateFlyout(){if(!this.isOpen)return;const t=this._anchor,o=this._flyout;if(o&&t){const s=window.innerWidth&&document.documentElement.clientWidth?Math.min(window.innerWidth,document.documentElement.clientWidth):window.innerWidth||document.documentElement.clientWidth;this._windowHeight=window.innerHeight&&document.documentElement.clientHeight?Math.min(window.innerHeight,document.documentElement.clientHeight):window.innerHeight||document.documentElement.clientHeight;let l,h,v,m=0,_=0;const R=o.getBoundingClientRect(),$=t.getBoundingClientRect(),B=this._topScout.getBoundingClientRect(),q=this._bottomScout.getBoundingClientRect(),j={height:this._windowHeight,left:0,top:0,width:s};if(isWindowSegmentAware()){const t=function getSegmentAwareWindow(){return isWindowSegmentAware()?window:null}().getWindowSegments();let o;const s=$.left+$.width/2,l=$.top+$.height/2;for(const h of t)if(s>=h.left&&l>=h.top){o=h;break}o&&(j.left=o.left,j.top=o.top,j.width=o.width,j.height=o.height)}R.width+2*this._edgePadding>j.width?R.width>j.width?(v=j.width,m=0):m=(j.width-R.width)/2:m=$.left+R.width+this._edgePadding>j.width?$.left-($.left+R.width+this._edgePadding-j.width):$.left<this._edgePadding?this._edgePadding:$.left;const z=j.height-($.top+$.height),K=$.top;this.avoidHidingAnchor?z<=R.height?K<R.height?K>z?(l=j.height-$.top,h=K):(_=$.bottom,h=z):(l=j.height-$.top,h=K):(_=$.bottom,h=z):R.height+2*this._edgePadding>j.height?R.height>=j.height?(h=j.height,_=0):_=(j.height-R.height)/2:_=$.top+$.height+R.height+this._edgePadding>j.height?j.height-R.height-this._edgePadding:Math.max($.top+$.height,this._edgePadding),0===B.top&&0===B.left||(m-=B.left,void 0!==l?l+=q.top-this._windowHeight:_-=B.top),"rtl"===this.direction?m>100&&this.offsetLeft>100&&(o.style.left=j.width-m+R.left-R.width-30+"px"):o.style.left=`${m+j.left}px`,void 0!==l?(o.style.top="unset",o.style.bottom=`${l}px`):(o.style.bottom="unset",o.style.top=`${_+j.top}px`),v&&(o.style.width=`${v}px`,o.style.setProperty("--mgt-flyout-set-width",`${v}px`),window.requestAnimationFrame((()=>this.updateFlyout()))),h?(o.style.maxHeight=`${h}px`,o.style.setProperty("--mgt-flyout-set-height",`${h}px`)):(o.style.maxHeight=null,o.style.setProperty("--mgt-flyout-set-height","unset"))}}setupWindowEvents(t){t&&this.isLightDismiss?(window.addEventListener("wheel",this.handleWindowEvent),window.addEventListener("pointerdown",this.handleWindowEvent),window.addEventListener("resize",this.handleResize),window.addEventListener("keyup",this.handleKeyUp)):(window.removeEventListener("wheel",this.handleWindowEvent),window.removeEventListener("pointerdown",this.handleWindowEvent),window.removeEventListener("resize",this.handleResize),window.removeEventListener("keyup",this.handleKeyUp))}handleWindowEvent(t){const o=this._flyout;if(o)if(t.composedPath){const s=t.composedPath();if(s.includes(o)||"pointerdown"===t.type&&s.includes(this))return}else{let s=t.target;for(;s;)if(s=s.parentElement,s===o||"pointerdown"===t.type&&s===this)return}this.close()}handleResize(t){this.close()}handleKeyUp(t){"Escape"===t.key&&this.close()}handleFlyoutWheel(t){t.preventDefault()}};var DA;__decorate$v([e$1({attribute:"light-dismiss",type:Boolean}),__metadata$t("design:type",Boolean)],MA.prototype,"isLightDismiss",void 0),__decorate$v([e$1({attribute:null,type:Boolean}),__metadata$t("design:type",Boolean)],MA.prototype,"avoidHidingAnchor",void 0),__decorate$v([e$1({attribute:"isOpen",type:Boolean}),__metadata$t("design:type",Boolean),__metadata$t("design:paramtypes",[Boolean])],MA.prototype,"isOpen",null),MA=__decorate$v([customElement("flyout"),__metadata$t("design:paramtypes",[])],MA),exports.PersonCardInteraction=void 0,(DA=exports.PersonCardInteraction||(exports.PersonCardInteraction={}))[DA.none=0]="none",DA[DA.hover=1]="hover",DA[DA.click=2]="click";const LA=[i$4`
:host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\e70d"}.ms-Icon--ChevronUp::before{content:"\\\e70e"}.ms-Icon--Contact::before{content:"\\\e77b"}.ms-Icon--AddFriend::before{content:"\\\e8fa"}.ms-Icon--OutlookLogoInverse::before{content:"\\\eb6d"}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--presence-background-color:#ffffff;--presence-icon-color:#ffffff;--line1-color:#000000;--line2-color:var(--neutral-foreground-hint, #717171);--line3-color:var(--neutral-foreground-hint, #717171);--line4-color:var(--neutral-foreground-hint, #717171);--initials-color:black;--initials-background-color:white}.mgt-dark{--presence-background-color:#000000;--presence-icon-color:#000000;--line1-color:#ffffff;--line2-color:#c8c6c4;--line3-color:#c8c6c4;--line4-color:#c8c6c4;--initials-color:white;--initials-background-color:black}.flyout{--mgt-flyout-border-radius:2px}:host([hidden]){display:none}:host{display:block;font-family:var(--font-family,var(--default-font-family))}:host :focus-visible{outline-offset:var(--focus-offset,11px)}:host .root{display:block}:host svg,mgt-person svg{width:var(--avatar-size,var(--avatar-size,40px));height:var(--avatar-size,var(--avatar-size,40px))}:host .person-root,mgt-person .person-root{position:relative;display:flex;align-items:center;color:var(--color,var(--color-sub1,var(--neutral-foreground-rest,#1a1a1a)));flex-direction:var(--person-flex-direction,row)}:host .person-root.clickable,mgt-person .person-root.clickable{cursor:pointer}:host .person-root.vertical,mgt-person .person-root.vertical{text-align:center;display:block}:host .person-root .user-avatar,mgt-person .person-root .user-avatar{position:relative;width:var(--avatar-size,var(--avatar-size,40px));height:var(--avatar-size,var(--avatar-size,40px));display:flex;justify-content:center;align-items:center;flex-shrink:0;cursor:var(--avatar-cursor,inherit)}:host .person-root .user-avatar .user-presence,mgt-person .person-root .user-avatar .user-presence{position:absolute;left:calc(var(--avatar-size,var(--avatar-size,40px)) * .72 - 2px);top:calc(var(--avatar-size,var(--avatar-size,40px)) * .72 - 2px);width:calc(var(--avatar-size,var(--avatar-size,40px)) * .28);height:calc(var(--avatar-size,var(--avatar-size,40px)) * .28);border:1px solid var(--presence-background-color,#fff);border-radius:50%}:host .person-root .user-avatar .user-presence .presence-oof-offline-wrapper,mgt-person .person-root .user-avatar .user-presence .presence-oof-offline-wrapper{background-color:var(--presence-background-color,#fff);border-color:#b4009e}:host .person-root .user-avatar .user-presence .presence-oof-offline-wrapper .presence-oof-offline svg,mgt-person .person-root .user-avatar .user-presence .presence-oof-offline-wrapper .presence-oof-offline svg{color:#b4009e;width:calc(var(--avatar-size,var(--avatar-size,40px)) * .14);margin-inline-start:calc(var(--avatar-size,var(--avatar-size,40px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence.presence-offline,mgt-person .person-root .user-avatar .user-presence.presence-offline{background-color:#8a8886;border-color:var(--presence-background-color,#fff)}:host .person-root .user-avatar .user-presence.presence-available,mgt-person .person-root .user-avatar .user-presence.presence-available{background-color:#13a10e;border-color:var(--presence-background-color,#fff)}:host .person-root .user-avatar .user-presence.presence-oof-offline,mgt-person .person-root .user-avatar .user-presence.presence-oof-offline{background-color:var(--presence-background-color,#fff);border-color:var(--presence-background-color,#fff)}:host .person-root .user-avatar .user-presence.presence-oof-available,mgt-person .person-root .user-avatar .user-presence.presence-oof-available{background-color:var(--presence-background-color,#fff);border-color:var(--presence-background-color,#fff)}:host .person-root .user-avatar .user-presence.presence-away,mgt-person .person-root .user-avatar .user-presence.presence-away{background-color:#fa4;border-color:var(--presence-background-color,#fff)}:host .person-root .user-avatar .user-presence.presence-dnd,mgt-person .person-root .user-avatar .user-presence.presence-dnd{background-color:#c50f1f;border-color:var(--presence-background-color,#fff)}:host .person-root .user-avatar .user-presence.presence-oof-dnd,mgt-person .person-root .user-avatar .user-presence.presence-oof-dnd{background-color:var(--presence-background-color,#fff);border-color:var(--presence-background-color,#fff)}:host .person-root .user-avatar .user-presence.presence-busy,mgt-person .person-root .user-avatar .user-presence.presence-busy{background-color:#c50f1f;border-color:var(--presence-background-color,#fff)}:host .person-root .user-avatar .user-presence.presence-oof-busy,mgt-person .person-root .user-avatar .user-presence.presence-oof-busy{background-color:var(--presence-background-color,#fff);border-color:var(--presence-background-color,#fff)}:host .person-root .user-avatar .user-presence .presence-basic,mgt-person .person-root .user-avatar .user-presence .presence-basic{width:calc(var(--avatar-size,var(--avatar-size,40px)) * .28 - 4px);height:calc(var(--avatar-size,var(--avatar-size,40px)) * .28 - 4px);border-style:solid;border-width:2px;border-radius:50%;margin:0;font-size:calc(var(--avatar-size,var(--avatar-size,40px)) * .14);vertical-align:top;display:flex;align-items:center}:host .person-root .user-avatar .user-presence .presence-basic.presence-offline,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-offline{background-color:var(--presence-background-color,#fff);border-color:#8a8886}:host .person-root .user-avatar .user-presence .presence-basic.presence-available,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-available{background-color:#13a10e;border-color:#13a10e}:host .person-root .user-avatar .user-presence .presence-basic.presence-oof-available,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-oof-available{background-color:var(--presence-background-color,#fff);border-color:#13a10e}:host .person-root .user-avatar .user-presence .presence-basic.presence-away,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-away{background-color:#fa4;border-color:#fa4}:host .person-root .user-avatar .user-presence .presence-basic.presence-dnd,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-dnd{background-color:#c50f1f;border-color:#c50f1f}:host .person-root .user-avatar .user-presence .presence-basic.presence-oof-dnd,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-oof-dnd{background-color:var(--presence-background-color,#fff);border-color:#c50f1f}:host .person-root .user-avatar .user-presence .presence-basic.presence-busy,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-busy{background-color:#c50f1f;border-color:#c50f1f}:host .person-root .user-avatar .user-presence .presence-basic.presence-oof-busy,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-oof-busy{background-color:var(--presence-background-color,#fff);border-color:#c50f1f}:host .person-root .user-avatar .user-presence .presence-offline::before,mgt-person .person-root .user-avatar .user-presence .presence-offline::before{content:"\uf13d";color:#8a8886;font-weight:700;margin-inline-start:calc(var(--avatar-size,var(--avatar-size,40px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-available::before,mgt-person .person-root .user-avatar .user-presence .presence-available::before{content:"\uef80";color:var(--presence-icon-color,#fff);margin-inline-start:calc(var(--avatar-size,var(--avatar-size,40px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-oof-available::before,mgt-person .person-root .user-avatar .user-presence .presence-oof-available::before{content:"\uef80";color:#13a10e;margin-inline-start:calc(var(--avatar-size,var(--avatar-size,40px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-away::before,mgt-person .person-root .user-avatar .user-presence .presence-away::before{content:"\uef81";color:var(--presence-icon-color,#fff);margin-inline-start:calc(var(--avatar-size,var(--avatar-size,40px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-dnd::before,mgt-person .person-root .user-avatar .user-presence .presence-dnd::before{content:"\uef82";color:var(--presence-icon-color,#fff);margin-inline-start:calc(var(--avatar-size,var(--avatar-size,40px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-oof-dnd::before,mgt-person .person-root .user-avatar .user-presence .presence-oof-dnd::before{content:"\uef82";color:#c50f1f;margin-inline-start:calc(var(--avatar-size,var(--avatar-size,40px)) * .07 - 2px)}:host .person-root .user-avatar.initials,mgt-person .person-root .user-avatar.initials{color:var(--initials-color,#000);border-radius:var(--avatar-border-radius,50%);font-weight:400}:host .person-root .user-avatar.initials .contact-icon,:host .person-root .user-avatar.initials .initials-text,mgt-person .person-root .user-avatar.initials .contact-icon,mgt-person .person-root .user-avatar.initials .initials-text{cursor:var(--avatar-cursor,inherit);margin-top:-1px;font-size:calc(var(--avatar-size,var(--avatar-size,40px)) * .4)}:host .person-root .user-avatar.initials .contact-icon svg,:host .person-root .user-avatar.initials .initials-text svg,mgt-person .person-root .user-avatar.initials .contact-icon svg,mgt-person .person-root .user-avatar.initials .initials-text svg{height:30px;width:30px}:host .person-root .user-avatar.initials .contact-icon,mgt-person .person-root .user-avatar.initials .contact-icon{display:inline}:host .person-root .user-avatar.small,mgt-person .person-root .user-avatar.small{width:var(--avatar-size-s,var(--avatar-size,24px));height:var(--avatar-size-s,var(--avatar-size,24px))}:host .person-root .user-avatar.small .contact-icon,:host .person-root .user-avatar.small .initials-text,mgt-person .person-root .user-avatar.small .contact-icon,mgt-person .person-root .user-avatar.small .initials-text{font-size:calc(var(--avatar-size-s,var(--avatar-size,24px)) * .4)}:host .person-root .user-avatar.small .user-presence,mgt-person .person-root .user-avatar.small .user-presence{left:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 8px);top:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 8px);width:6px;height:6px}:host .person-root .user-avatar.small .user-presence__people,mgt-person .person-root .user-avatar.small .user-presence__people{left:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 6px);border:0;width:6px;height:6px}:host .person-root .user-avatar.small .user-presence .presence-basic,mgt-person .person-root .user-avatar.small .user-presence .presence-basic{width:2px;height:2px;border-radius:50%;padding:0;font-size:calc(var(--avatar-size-s,var(--avatar-size,24px)) * .14)}:host .person-root .user-avatar.small .user-presence .presence-basic .presence-oof-offline svg,mgt-person .person-root .user-avatar.small .user-presence .presence-basic .presence-oof-offline svg{width:calc(var(--avatar-size-s,var(--avatar-size,24px)) * .14);margin-inline-start:calc(var(--avatar-size-s,var(--avatar-size,24px)) * .07 - 2px)}:host .person-root .user-avatar.small .user-presence .presence-available::before,:host .person-root .user-avatar.small .user-presence .presence-away::before,:host .person-root .user-avatar.small .user-presence .presence-dnd::before,:host .person-root .user-avatar.small .user-presence .presence-offline::before,:host .person-root .user-avatar.small .user-presence .presence-oof-available::before,:host .person-root .user-avatar.small .user-presence .presence-oof-away::before,:host .person-root .user-avatar.small .user-presence .presence-oof-dnd::before,:host .person-root .user-avatar.small .user-presence .presence-oof-offline::before,mgt-person .person-root .user-avatar.small .user-presence .presence-available::before,mgt-person .person-root .user-avatar.small .user-presence .presence-away::before,mgt-person .person-root .user-avatar.small .user-presence .presence-dnd::before,mgt-person .person-root .user-avatar.small .user-presence .presence-offline::before,mgt-person .person-root .user-avatar.small .user-presence .presence-oof-available::before,mgt-person .person-root .user-avatar.small .user-presence .presence-oof-away::before,mgt-person .person-root .user-avatar.small .user-presence .presence-oof-dnd::before,mgt-person .person-root .user-avatar.small .user-presence .presence-oof-offline::before{margin-inline-start:calc(var(--avatar-size-s,var(--avatar-size,24px)) * .07 - 2px)}:host .person-root .user-avatar.threeLines,mgt-person .person-root .user-avatar.threeLines{width:var(--avatar-size-3-lines,var(--avatar-size,56px));height:var(--avatar-size-3-lines,var(--avatar-size,56px))}:host .person-root .user-avatar.threeLines .contact-icon,:host .person-root .user-avatar.threeLines .initials-text,mgt-person .person-root .user-avatar.threeLines .contact-icon,mgt-person .person-root .user-avatar.threeLines .initials-text{font-size:calc(var(--avatar-size-3-lines,var(--avatar-size,56px)) * .4)}:host .person-root .user-avatar.threeLines .user-presence,mgt-person .person-root .user-avatar.threeLines .user-presence{left:calc(var(--avatar-size-3-lines,var(--avatar-size,56px)) - 18px);top:calc(var(--avatar-size-3-lines,var(--avatar-size,56px)) - 18px);width:16px;height:16px}:host .person-root .user-avatar.threeLines .user-presence .presence-basic,mgt-person .person-root .user-avatar.threeLines .user-presence .presence-basic{width:12px;height:12px;border-radius:50%;padding:0;font-size:calc(var(--avatar-size-3-lines,var(--avatar-size,56px)) * .14)}:host .person-root .user-avatar.threeLines .user-presence .presence-basic .presence-oof-offline svg,mgt-person .person-root .user-avatar.threeLines .user-presence .presence-basic .presence-oof-offline svg{width:calc(var(--avatar-size-3-lines,var(--avatar-size,56px)) * .14);margin-inline-start:calc(var(--avatar-size-3-lines,var(--avatar-size,56px)) * .07 - 2px)}:host .person-root .user-avatar.threeLines .user-presence .presence-available::before,:host .person-root .user-avatar.threeLines .user-presence .presence-away::before,:host .person-root .user-avatar.threeLines .user-presence .presence-dnd::before,:host .person-root .user-avatar.threeLines .user-presence .presence-offline::before,:host .person-root .user-avatar.threeLines .user-presence .presence-oof-available::before,:host .person-root .user-avatar.threeLines .user-presence .presence-oof-away::before,:host .person-root .user-avatar.threeLines .user-presence .presence-oof-dnd::before,:host .person-root .user-avatar.threeLines .user-presence .presence-oof-offline::before,mgt-person .person-root .user-avatar.threeLines .user-presence .presence-available::before,mgt-person .person-root .user-avatar.threeLines .user-presence .presence-away::before,mgt-person .person-root .user-avatar.threeLines .user-presence .presence-dnd::before,mgt-person .person-root .user-avatar.threeLines .user-presence .presence-offline::before,mgt-person .person-root .user-avatar.threeLines .user-presence .presence-oof-available::before,mgt-person .person-root .user-avatar.threeLines .user-presence .presence-oof-away::before,mgt-person .person-root .user-avatar.threeLines .user-presence .presence-oof-dnd::before,mgt-person .person-root .user-avatar.threeLines .user-presence .presence-oof-offline::before{margin-inline-start:calc(var(--avatar-size-3-lines,var(--avatar-size,56px)) * .07 - var(--user-presence-margin-offset,2px))}:host .person-root .user-avatar.fourLines,:host .person-root .user-avatar.vertical,mgt-person .person-root .user-avatar.fourLines,mgt-person .person-root .user-avatar.vertical{width:var(--avatar-size-4-lines,var(--avatar-size,72px));height:var(--avatar-size-4-lines,var(--avatar-size,72px))}:host .person-root .user-avatar.fourLines .contact-icon,:host .person-root .user-avatar.fourLines .initials-text,:host .person-root .user-avatar.vertical .contact-icon,:host .person-root .user-avatar.vertical .initials-text,mgt-person .person-root .user-avatar.fourLines .contact-icon,mgt-person .person-root .user-avatar.fourLines .initials-text,mgt-person .person-root .user-avatar.vertical .contact-icon,mgt-person .person-root .user-avatar.vertical .initials-text{font-size:calc(var(--avatar-size-4-lines,var(--avatar-size,72px)) * .4)}:host .person-root .user-avatar.fourLines .user-presence,:host .person-root .user-avatar.vertical .user-presence,mgt-person .person-root .user-avatar.fourLines .user-presence,mgt-person .person-root .user-avatar.vertical .user-presence{left:calc(var(--avatar-size-4-lines,var(--avatar-size,72px)) - 22px);top:calc(var(--avatar-size-4-lines,var(--avatar-size,72px)) - 22px);width:20px;height:20px}:host .person-root .user-avatar.fourLines .user-presence .presence-basic,:host .person-root .user-avatar.vertical .user-presence .presence-basic,mgt-person .person-root .user-avatar.fourLines .user-presence .presence-basic,mgt-person .person-root .user-avatar.vertical .user-presence .presence-basic{width:16px;height:16px;border-radius:50%;padding:0;font-size:calc(var(--avatar-size-4-lines,var(--avatar-size,72px)) * .14)}:host .person-root .user-avatar.fourLines .user-presence .presence-basic .presence-oof-offline svg,:host .person-root .user-avatar.vertical .user-presence .presence-basic .presence-oof-offline svg,mgt-person .person-root .user-avatar.fourLines .user-presence .presence-basic .presence-oof-offline svg,mgt-person .person-root .user-avatar.vertical .user-presence .presence-basic .presence-oof-offline svg{width:calc(var(--avatar-size-4-lines,var(--avatar-size,72px)) * .14);margin-inline-start:calc(var(--avatar-size-4-lines,var(--avatar-size,72px)) * .07 - 2px)}:host .person-root .user-avatar.fourLines .user-presence .presence-available::before,:host .person-root .user-avatar.fourLines .user-presence .presence-away::before,:host .person-root .user-avatar.fourLines .user-presence .presence-dnd::before,:host .person-root .user-avatar.fourLines .user-presence .presence-offline::before,:host .person-root .user-avatar.fourLines .user-presence .presence-oof-available::before,:host .person-root .user-avatar.fourLines .user-presence .presence-oof-away::before,:host .person-root .user-avatar.fourLines .user-presence .presence-oof-dnd::before,:host .person-root .user-avatar.fourLines .user-presence .presence-oof-offline::before,:host .person-root .user-avatar.vertical .user-presence .presence-available::before,:host .person-root .user-avatar.vertical .user-presence .presence-away::before,:host .person-root .user-avatar.vertical .user-presence .presence-dnd::before,:host .person-root .user-avatar.vertical .user-presence .presence-offline::before,:host .person-root .user-avatar.vertical .user-presence .presence-oof-available::before,:host .person-root .user-avatar.vertical .user-presence .presence-oof-away::before,:host .person-root .user-avatar.vertical .user-presence .presence-oof-dnd::before,:host .person-root .user-avatar.vertical .user-presence .presence-oof-offline::before,mgt-person .person-root .user-avatar.fourLines .user-presence .presence-available::before,mgt-person .person-root .user-avatar.fourLines .user-presence .presence-away::before,mgt-person .person-root .user-avatar.fourLines .user-presence .presence-dnd::before,mgt-person .person-root .user-avatar.fourLines .user-presence .presence-offline::before,mgt-person .person-root .user-avatar.fourLines .user-presence .presence-oof-available::before,mgt-person .person-root .user-avatar.fourLines .user-presence .presence-oof-away::before,mgt-person .person-root .user-avatar.fourLines .user-presence .presence-oof-dnd::before,mgt-person .person-root .user-avatar.fourLines .user-presence .presence-oof-offline::before,mgt-person .person-root .user-avatar.vertical .user-presence .presence-available::before,mgt-person .person-root .user-avatar.vertical .user-presence .presence-away::before,mgt-person .person-root .user-avatar.vertical .user-presence .presence-dnd::before,mgt-person .person-root .user-avatar.vertical .user-presence .presence-offline::before,mgt-person .person-root .user-avatar.vertical .user-presence .presence-oof-available::before,mgt-person .person-root .user-avatar.vertical .user-presence .presence-oof-away::before,mgt-person .person-root .user-avatar.vertical .user-presence .presence-oof-dnd::before,mgt-person .person-root .user-avatar.vertical .user-presence .presence-oof-offline::before{margin-inline-start:calc(var(--avatar-size-4-lines,var(--avatar-size,72px)) * .07 - 2px)}:host .person-root .user-avatar.vertical,mgt-person .person-root .user-avatar.vertical{margin-inline-start:auto}:host .person-root .user-avatar .img-wrapper,mgt-person .person-root .user-avatar .img-wrapper{height:100%;width:100%;display:flex;overflow:hidden;border:var(--avatar-border,0);border-radius:var(--avatar-border-radius,50%);position:relative}:host .person-root .user-avatar .img-wrapper img,mgt-person .person-root .user-avatar .img-wrapper img{position:absolute;display:block;inset:-100%;margin:auto;height:100%;width:100%;object-fit:cover;object-position:top}:host .person-root .user-avatar .img-wrapper img:focus(),mgt-person .person-root .user-avatar .img-wrapper img:focus(){outline:0}:host .person-root .user-avatar.pinkRed10,mgt-person .person-root .user-avatar.pinkRed10{background-color:var(var(--initials-background-color,#fff),#750b1c)}:host .person-root .user-avatar.red20,mgt-person .person-root .user-avatar.red20{background-color:var(var(--initials-background-color,#fff),#a4262c)}:host .person-root .user-avatar.red10,mgt-person .person-root .user-avatar.red10{background-color:var(var(--initials-background-color,#fff),#d13438)}:host .person-root .user-avatar.orange20,mgt-person .person-root .user-avatar.orange20{background-color:var(var(--initials-background-color,#fff),#ca5010)}:host .person-root .user-avatar.orangeYellow20,mgt-person .person-root .user-avatar.orangeYellow20{background-color:var(var(--initials-background-color,#fff),#986f0b)}:host .person-root .user-avatar.green10,mgt-person .person-root .user-avatar.green10{background-color:var(var(--initials-background-color,#fff),#498205)}:host .person-root .user-avatar.green20,mgt-person .person-root .user-avatar.green20{background-color:var(var(--initials-background-color,#fff),#0b6a0b)}:host .person-root .user-avatar.cyan20,mgt-person .person-root .user-avatar.cyan20{background-color:var(var(--initials-background-color,#fff),#038387)}:host .person-root .user-avatar.cyan30,mgt-person .person-root .user-avatar.cyan30{background-color:var(var(--initials-background-color,#fff),#005b70)}:host .person-root .user-avatar.cyanBlue10,mgt-person .person-root .user-avatar.cyanBlue10{background-color:var(var(--initials-background-color,#fff),#0078d4)}:host .person-root .user-avatar.cyanBlue20,mgt-person .person-root .user-avatar.cyanBlue20{background-color:var(var(--initials-background-color,#fff),#004e8c)}:host .person-root .user-avatar.blue10,mgt-person .person-root .user-avatar.blue10{background-color:var(var(--initials-background-color,#fff),#4f6bed)}:host .person-root .user-avatar.blueMagenta30,mgt-person .person-root .user-avatar.blueMagenta30{background-color:var(var(--initials-background-color,#fff),#5c2e91)}:host .person-root .user-avatar.blueMagenta20,mgt-person .person-root .user-avatar.blueMagenta20{background-color:var(var(--initials-background-color,#fff),#8764b8)}:host .person-root .user-avatar.magenta20,mgt-person .person-root .user-avatar.magenta20{background-color:var(var(--initials-background-color,#fff),#881798)}:host .person-root .user-avatar.magenta10,mgt-person .person-root .user-avatar.magenta10{background-color:var(var(--initials-background-color,#fff),#c239b3)}:host .person-root .user-avatar.magentaPink10,mgt-person .person-root .user-avatar.magentaPink10{background-color:var(var(--initials-background-color,#fff),#e3008c)}:host .person-root .user-avatar.orange30,mgt-person .person-root .user-avatar.orange30{background-color:var(var(--initials-background-color,#fff),#8e562e)}:host .person-root .user-avatar.gray30,mgt-person .person-root .user-avatar.gray30{background-color:var(var(--initials-background-color,#fff),#7a7574)}:host .person-root .user-avatar.lightGrey,mgt-person .person-root .user-avatar.lightGrey{background-color:#e5e5e5}:host .person-root .details,mgt-person .person-root .details{flex-shrink:1;display:flex;flex-direction:column;overflow:hidden;line-height:1.6;margin-inline-start:var(--details-spacing,12px)}:host .person-root .details.small,mgt-person .person-root .details.small{margin-inline-start:var(--details-spacing,8px)}:host .person-root .details.small .line1,mgt-person .person-root .details.small .line1{font-weight:400}:host .person-root .details.threeLines,mgt-person .person-root .details.threeLines{margin-inline-start:var(--details-spacing,14px);margin-bottom:var(--details-cta-spacing,0)}:host .person-root .details.threeLines .line1,mgt-person .person-root .details.threeLines .line1{font-size:var(var(--line1-font-size,var(--font-size,14px)),16px);line-height:var(var(--line1-line-height,20px),22px)}:host .person-root .details.fourLines,mgt-person .person-root .details.fourLines{margin-inline-start:var(--details-spacing,16px);height:84px}:host .person-root .details.fourLines .line1,mgt-person .person-root .details.fourLines .line1{font-size:20px;line-height:26px;margin-bottom:6px}:host .person-root .details.vertical,mgt-person .person-root .details.vertical{text-align:center;align-items:center;margin-top:var(--details-spacing,7px)}:host .person-root .details.vertical.small,mgt-person .person-root .details.vertical.small{margin-top:var(--details-spacing,7px)}:host .person-root .details.vertical.threelines,mgt-person .person-root .details.vertical.threelines{margin-top:var(--details-spacing,12px)}:host .person-root .details.vertical.fourlines,mgt-person .person-root .details.vertical.fourlines{margin-top:var(--details-spacing,10px)}:host .person-root .details.vertical.fourlines .line1,:host .person-root .details.vertical.threelines .line1,mgt-person .person-root .details.vertical.fourlines .line1,mgt-person .person-root .details.vertical.threelines .line1{margin-bottom:0}:host .person-root .details>div,mgt-person .person-root .details>div{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}:host .person-root .details .line1,mgt-person .person-root .details .line1{color:var(--line1-color,#000);font-size:var(--line1-font-size,var(--font-size,14px));font-weight:var(--line1-font-weight,600);text-transform:var(text-transform,none);line-height:var(--line1-line-height,20px);width:fit-content}:host .person-root .details .line2,mgt-person .person-root .details .line2{color:var(--line2-color,var(--neutral-foreground-hint,#717171));font-size:var(--line2-font-size,var(--email-font-size,12px));font-weight:var(--line2-font-weight,400);text-transform:var(--line2-text-transform,var(text-transform,none));line-height:var(--line2-line-height,16px)}:host .person-root .details .line3,mgt-person .person-root .details .line3{color:var(--line3-color,var(--neutral-foreground-hint,#717171));font-size:var(--line3-font-size,var(--email-font-size,12px));font-weight:var(--line3-font-weight,400);text-transform:var(--line3-text-transform,var(text-transform,none));line-height:var(--line3-line-height,16px)}:host .person-root .details .line4,mgt-person .person-root .details .line4{color:var(--line4-color,var(--neutral-foreground-hint,#717171));font-size:var(--line4-font-size,var(--email-font-size,12px));font-weight:var(--line4-font-weight,400);text-transform:var(--line4-text-transform,var(text-transform,none));line-height:16px}:host .avatar-icon,mgt-person .avatar-icon{display:flex;align-items:center;justify-content:center;line-height:1;margin:0;font-size:calc(var(--avatar-size,var(--avatar-size,40px)) * .5);width:var(--avatar-size,var(--avatar-size,40px));height:var(--avatar-size,var(--avatar-size,40px));overflow:hidden;border-radius:var(--avatar-border-radius,50%)}:host .avatar-icon.small,mgt-person .avatar-icon.small{font-size:var(--avatar-size-s,var(--avatar-size,24px));width:var(--avatar-size-s,var(--avatar-size,24px));height:var(--avatar-size-s,var(--avatar-size,24px))}:host .avatar-icon.threeLines,mgt-person .avatar-icon.threeLines{font-size:var(--avatar-size-3-lines,var(--avatar-size,56px));width:var(--avatar-size-3-lines,var(--avatar-size,56px));height:var(--avatar-size-3-lines,var(--avatar-size,56px))}:host .avatar-icon.fourLines,mgt-person .avatar-icon.fourLines{font-size:var(--avatar-size-4-lines,var(--avatar-size,72px));width:var(--avatar-size-4-lines,var(--avatar-size,72px));height:var(--avatar-size-4-lines,var(--avatar-size,72px))}:host .vertical,mgt-person .vertical{display:block}[dir=rtl] .root{direction:rtl}[dir=rtl] svg{direction:rtl}[dir=rtl] .person-root .user-avatar{position:relative}[dir=rtl] .person-root.small .contact-icon,[dir=rtl] .person-root.small .initials-text{font-size:calc(var(--avatar-size-s,var(--avatar-size,24px)) * .4)}[dir=rtl] .person-root.small .user-presence{left:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 8px);top:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 8px);width:8px;height:8px}[dir=rtl] .person-root.small .user-presence__people{border:0;width:6px;height:6px;left:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 6px)}[dir=rtl] .person-root.small .user-presence .presence-basic{width:4px;height:4px;border-radius:4px;padding:0}[dir=rtl] .person-root.small .user-presence .presence-basic .presence-oof-offline svg{height:0;width:0}[dir=rtl] .person-root.vertical{text-align:center;display:block}[dir=rtl] .person-root.vertical .user-avatar{display:block;margin-inline-start:auto}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg,:host svg>path,mgt-person svg,mgt-person svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg,:host svg>path,mgt-person svg,mgt-person svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}
`],FA={photoFor:"Photo for",emailAddress:"Email address",initials:"Initials"};var UA,HA;exports.PersonViewType=void 0,(UA=exports.PersonViewType||(exports.PersonViewType={}))[UA.avatar=2]="avatar",UA[UA.oneline=3]="oneline",UA[UA.twolines=4]="twolines",UA[UA.threelines=5]="threelines",UA[UA.fourlines=6]="fourlines",exports.avatarType=void 0,(HA=exports.avatarType||(exports.avatarType={})).photo="photo",HA.initials="initials";var BA,__decorate$u=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},__metadata$s=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)},__awaiter$w=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};const qA=["businessPhones","displayName","givenName","jobTitle","department","mail","mobilePhone","officeLocation","preferredLanguage","surname","userPrincipalName","id"];exports.MgtPerson=BA=class MgtPerson extends MgtTemplatedComponent{static get styles(){return LA}get strings(){return FA}get personQuery(){return this._personQuery}set personQuery(t){t!==this._personQuery&&(this._personQuery=t,this.personDetailsInternal=null,this.requestStateUpdate())}get fallbackDetails(){return this._fallbackDetails}set fallbackDetails(t){t!==this._fallbackDetails&&(this._fallbackDetails=t,this.personDetailsInternal||(t&&t.displayName?this._personAvatarBg=this.getColorFromName(t.displayName):this._personAvatarBg="lightGrey",this.requestStateUpdate()))}get userId(){return this._userId}set userId(t){t!==this._userId&&(this._userId=t,this.personDetailsInternal=null,this.requestStateUpdate())}get usage(){return this._usage}set usage(t){t!==this._usage&&(this._usage=t,this.requestStateUpdate())}get personDetailsInternal(){return this._personDetailsInternal}set personDetailsInternal(t){this._personDetailsInternal!==t&&(this._personDetailsInternal=t,t&&t.displayName?this._personAvatarBg=this.getColorFromName(t.displayName):this._personAvatarBg="lightGrey",this._fetchedImage=null,this._fetchedPresence=null,this.requestStateUpdate(),this.requestUpdate("personDetailsInternal"))}get personDetails(){return this._personDetails}set personDetails(t){this._personDetails!==t&&(this._personDetails=t,t&&t.displayName?this._personAvatarBg=this.getColorFromName(t.displayName):this._personAvatarBg="lightGrey",this._fetchedImage=null,this._fetchedPresence=null,this.requestStateUpdate(),this.requestUpdate("personDetails"))}get personImage(){return this._personImage||this._fetchedImage}set personImage(t){if(t===this._personImage)return;this._isInvalidImageSrc=!t;const o=this._personImage;this._personImage=t,this.requestUpdate("personImage",o)}get avatarType(){return this._avatarType}set avatarType(t){t!==this._avatarType&&(this._avatarType=t,this.requestStateUpdate())}get personPresence(){return this._personPresence||this._fetchedPresence}set personPresence(t){if(t===this._personPresence)return;const o=this._personPresence;this._personPresence=t,this.requestUpdate("personPresence",o)}static get requiredScopes(){const t=["user.readbasic.all","user.read","people.read","presence.read.all","presence.read"];return BA.config.useContactApis&&t.push("contacts.read"),t}get flyout(){return this.renderRoot.querySelector(".flyout")}constructor(){super(),this.personCardInteraction=exports.PersonCardInteraction.none,this.line1Property="displayName",this.line2Property="jobTitle",this.line3Property="department",this.line4Property="email",this.view=exports.ViewType.image,this.avatarSize="auto",this.disableImageFetch=!1,this._isInvalidImageSrc=!1,this._avatarType="photo",this.verticalLayout=!1}render(){if(this.isLoadingState&&!this.personDetails&&!this.personDetailsInternal&&!this.fallbackDetails)return this.renderLoading();const t=this.personDetails||this.personDetailsInternal||this.fallbackDetails,o=this.getImage(),s=this.personPresence||this._fetchedPresence;if(!t&&!o)return this.renderNoData();t&&t.personImage||!o||(t.personImage=o);let l=this.renderTemplate("default",{person:t,personImage:o,personPresence:s});if(!l){const h=this.renderDetails(t,s),v=this.renderAvatar(t,o,s),m={"person-root":!0,clickable:this.personCardInteraction===exports.PersonCardInteraction.click,vertical:this.isVertical()};l=XI`
        <div class=${IA(m)}>
          ${v} ${h}
        </div>
      `}return this.personCardInteraction!==exports.PersonCardInteraction.none&&(l=this.renderFlyout(l,t,o,s)),XI`
      <div
        class="root"
        dir=${this.direction}
        @click=${this.handleMouseClick}
        @mouseenter=${this.handleMouseEnter}
        @mouseleave=${this.handleMouseLeave}
        @keydown=${this.handleKeyDown}
        tabindex=0
      >
        ${l}
      </div>
    `}renderLoading(){return this.renderTemplate("loading",null)||XI``}clearState(){this._personImage="",this._personDetailsInternal=null,this._fetchedImage=null,this._fetchedPresence=null}renderNoData(){const t=this.renderTemplate("no-data",null);if(t)return t;const o={"avatar-icon":!0,vertical:this.isVertical(),small:!this.isLargeAvatar(),threeLines:this.isThreeLines(),fourLines:this.isFourLines()};return XI`
       <i class=${IA(o)}></i>
     `}renderPersonIcon(){return XI`
       <svg width="10" height="13" viewBox="0 0 10 13" fill="none" xmlns="http://www.w3.org/2000/svg">
       <path d="M8.5 7C9.32843 7 10 7.67157 10 8.5V9C10 10.9714 8.14049 13 5 13C1.85951 13 0 10.9714 0 9V8.5C0 7.67157 0.671573 7 1.5 7H8.5ZM8.5 8H1.5C1.22386 8 1 8.22386 1 8.5V9C1 10.4376 2.43216 12 5 12C7.56784 12 9 10.4376 9 9V8.5C9 8.22386 8.77614 8 8.5 8ZM5 0.5C6.51878 0.5 7.75 1.73122 7.75 3.25C7.75 4.76878 6.51878 6 5 6C3.48122 6 2.25 4.76878 2.25 3.25C2.25 1.73122 3.48122 0.5 5 0.5ZM5 1.5C4.0335 1.5 3.25 2.2835 3.25 3.25C3.25 4.2165 4.0335 5 5 5C5.9665 5 6.75 4.2165 6.75 3.25C6.75 2.2835 5.9665 1.5 5 1.5Z" fill="#616161"/>
       </svg>
     `}renderImage(t,o){if(o&&!this._isInvalidImageSrc&&"photo"===this._avatarType){const s=`${this.strings.photoFor} ${t.displayName}`;return XI`
        <div class="img-wrapper">
          <img alt=${s} src=${o} @error=${()=>this._isInvalidImageSrc=!0} />
        </div>
      `}if(t){const o=this.getInitials(t);return XI`
        <span class="initials-text" aria-label="${this.strings.initials} ${o}">
          ${o&&o.length?XI`
                ${o}
              `:XI`
                <i class="contact-icon">${this.renderPersonIcon()}</i>
              `}
        </span>
      `}}renderPresence(t){if(!this.showPresence||!t)return XI``;let o=null;switch(t.availability){case"DoNotDisturb":if("OutOfOffice"===t.activity)o="presence-oof-dnd";else o="presence-dnd";break;case"BeRightBack":o="presence-away";break;case"Available":switch(t.activity){case"Available":o="presence-available";break;case"OutOfOffice":o="presence-oof-available"}break;case"Busy":if("OutOfOffice"===t.activity)o="presence-oof-busy";else o="presence-busy";break;case"Away":switch(t.activity){case"Away":o="presence-away";break;case"OutOfOffice":o="presence-oof-offline"}break;case"Offline":switch(t.activity){case"Offline":case"OffWork":o="presence-offline";break;case"OutOfOffice":o="presence-oof-offline"}break;default:o="presence-offline"}const s={"ms-Icon":!0,"presence-basic":!0};s[o]=!0;let l=null;l="presence-oof-offline"===o?XI`
         <div class="ms-Icon presence-basic presence-oof-offline-wrapper">
           <i class="presence-oof-offline">
             ${getSvg($A.SkypeArrow,"#666666")}
           </i>
         </div>
       `:XI`
         <i class=${IA(s)} aria-hidden="true"></i>
       `;const h={"user-presence":!0,"user-presence__people":"people"===this._usage};return h[o]=!0,XI`
       <div class=${IA(h)} title=${t.activity} aria-label=${t.activity} role="img">
         ${l}
       </div>
     `}renderAvatar(t,o,s){const l=!o||this._isInvalidImageSrc||this._avatarType===exports.avatarType.initials,h={initials:l,small:!this.isLargeAvatar(),threeLines:this.isThreeLines(),fourLines:this.isFourLines(),"user-avatar":!0,vertical:this.isVertical()};let v="";if(l&&t?(h[this._personAvatarBg]=!0,v=`${this.strings.initials} ${this.getInitials(t)}`):(v=t&&t.displayName||"",""!==v&&(v=`${this.strings.photoFor} ${v}`)),""===v){const o=getEmailFromGraphEntity(t);null!==o&&(v=`${this.strings.emailAddress} ${o}`)}const m=this.renderImage(t,o),_=this.renderPresence(s);return XI`
       <div class=${IA(h)} title=${v} aria-label=${v}>
         ${m} ${_}
       </div>
     `}handleLine1Clicked(){this.fireCustomEvent("line1clicked",this.personDetailsInternal)}handleLine2Clicked(){this.fireCustomEvent("line2clicked",this.personDetailsInternal)}handleLine3Clicked(){this.fireCustomEvent("line3clicked",this.personDetailsInternal)}handleLine4Clicked(){this.fireCustomEvent("line4clicked",this.personDetailsInternal)}renderDetails(t,o){if(!t||this.view===exports.ViewType.image||this.view===exports.PersonViewType.avatar)return XI``;const s=t;o&&(s.presenceActivity=null==o?void 0:o.activity,s.presenceAvailability=null==o?void 0:o.availability);const l=[];if(this.view>exports.ViewType.image){const t=this.getTextFromProperty(s,this.line1Property);if(this.hasTemplate("line1")){const o=this.renderTemplate("line1",{person:s});l.push(XI`
           <div class="line1" @click=${()=>this.handleLine1Clicked()} role="presentation" aria-label="${t}">${o}</div>
         `)}else t&&l.push(XI`
             <div class="line1" @click=${()=>this.handleLine1Clicked()} role="presentation" aria-label="${t}">${t}</div>
           `)}if(this.view>exports.ViewType.oneline){const t=this.getTextFromProperty(s,this.line2Property);if(this.hasTemplate("line2")){const o=this.renderTemplate("line2",{person:s});l.push(XI`
           <div class="line2" @click=${()=>this.handleLine2Clicked()} role="presentation" aria-label="${t}">${o}</div>
         `)}else t&&l.push(XI`
             <div class="line2" @click=${()=>this.handleLine2Clicked()} role="presentation" aria-label="${t}">${t}</div>
           `)}if(this.view>exports.ViewType.twolines){const t=this.getTextFromProperty(s,this.line3Property);if(this.hasTemplate("line3")){const o=this.renderTemplate("line3",{person:s});l.push(XI`
           <div class="line3" @click=${()=>this.handleLine3Clicked()} role="presentation" aria-label="${t}">${o}</div>
         `)}else t&&l.push(XI`
             <div class="line3" @click=${()=>this.handleLine3Clicked()} role="presentation" aria-label="${t}">${t}</div>
           `)}if(this.view>exports.ViewType.threelines){const t=this.getTextFromProperty(s,this.line4Property);if(this.hasTemplate("line4")){const o=this.renderTemplate("line4",{person:s});l.push(XI`
          <div class="line4" @click=${()=>this.handleLine4Clicked()} role="presentation" aria-label="${t}">${o}</div>
        `)}else t&&l.push(XI`
            <div class="line4" @click=${()=>this.handleLine4Clicked()} role="presentation" aria-label="${t}">${t}</div>
          `)}const h=IA({details:!0,small:!this.isLargeAvatar(),threeLines:this.isThreeLines(),fourLines:this.isFourLines(),vertical:this.isVertical()});return XI`
       <div class="${h}">
         ${l}
       </div>
     `}renderFlyout(t,o,s,l){const h=this._personCardShouldRender?XI`
           <div slot="flyout" data-testid="flyout-slot">
             ${this.renderFlyoutContent(o,s,l)}
           </div>
         `:XI``;return mgtHtml`
      <mgt-flyout light-dismiss class="flyout" .avoidHidingAnchor=${!1}>
        ${t} ${h}
      </mgt-flyout>
`}renderFlyoutContent(t,o,s){return this.renderTemplate("person-card",{person:t,personImage:o})||mgtHtml`
        <mgt-person-card
          lock-tab-navigation
          .personDetails=${t}
          .personImage=${o}
          .personPresence=${s}
          .showPresence=${this.showPresence}
        ></mgt-person-card>
      `}loadState(){return __awaiter$w(this,void 0,void 0,(function*(){const t=Providers.globalProvider;if(!t||t.state===exports.ProviderState.Loading)return;if(t&&t.state===exports.ProviderState.SignedOut)return void(this.personDetailsInternal=null);const o=t.graph.forComponent(this);this.fallbackDetails&&(this.line2Property="email"),this.verticalLayout&&this.view<exports.ViewType.fourlines&&(this.line2Property="email");let s=[...qA,this.line1Property,this.line2Property,this.line3Property,this.line4Property];s=s.filter((t=>"email"!==t));let l=this.personDetailsInternal||this.personDetails||this.fallbackDetails;if(l){if(!l.personImage&&this.fetchImage&&"photo"===this._avatarType&&!this.personImage&&!this._fetchedImage){let t;t="groupTypes"in l?yield function getGroupImage(t,o,s=!0){return __awaiter$z(this,void 0,void 0,(function*(){let s,l,h=o.id;if(getIsPhotosCacheEnabled()){if(l=CacheService.getCache(AA.photos,AA.photos.stores.groups),s=yield l.getValue(h),s&&getPhotoInvalidationTime()>Date.now()-s.timeCached)return s.photo;if(s)try{const o=yield t.api(`groups/${h}/photo`).get();o&&(o["@odata.mediaEtag"]!==s.eTag||null===o["@odata.mediaEtag"]&&null===o.eTag)&&(s=null)}catch(t){return null}}return s=s||(yield getPhotoForResource(t,`groups/${h}`,["user.readbasic.all"])),getIsPhotosCacheEnabled()&&s&&l.putValue(h,s),s?s.photo:null}))}(o,l,BA.config.useContactApis):yield getPersonImage(o,l,BA.config.useContactApis),t&&(l.personImage=t,this._fetchedImage=t)}}else if(this.userId||"me"===this.personQuery){let t;t="photo"!==this._avatarType||this.disableImageFetch?"me"===this.personQuery?yield getMe(o,s):yield getUser(o,this.userId,s):yield getUserWithPhoto(o,this.userId,s),this.personDetailsInternal=t,this.personDetails=t,this._fetchedImage=this.getImage()}else if(this.personQuery){let t=yield findPeople(o,this.personQuery,1);if(t&&0!==t.length||(t=(yield findUsers(o,this.personQuery,1))||[]),t&&t.length&&(this.personDetailsInternal=t[0],this.personDetails=t[0],"photo"===this._avatarType&&!this.disableImageFetch)){const s=yield getPersonImage(o,t[0],BA.config.useContactApis);s&&(this.personDetailsInternal.personImage=s,this.personDetails.personImage=s,this._fetchedImage=s)}}const h={activity:"Offline",availability:"Offline",id:null};if(this.showPresence&&!this.personPresence&&!this._fetchedPresence)try{if(l=this.personDetailsInternal||this.personDetails,l){const t="me"!==this.personQuery?null==l?void 0:l.id:null;this._fetchedPresence=yield getUserPresence(o,t)}else this._fetchedPresence=h}catch(t){this._fetchedPresence=h}}))}getInitials(t){if(t||(t=this.personDetailsInternal),t.initials)return t.initials;let o="";if(t.givenName&&(o+=t.givenName[0].toUpperCase()),t.surname&&(o+=t.surname[0].toUpperCase()),!o&&t.displayName){const s=t.displayName.split(/\s+/);for(let t=0;t<2&&t<s.length;t++)s[t][0]&&this.isLetter(s[t][0])&&(o+=s[t][0].toUpperCase())}return o}getColorFromName(t){const o=t.split("").map((t=>t.charCodeAt(0))).join(""),s=["pinkRed10","red20","red10","orange20","orangeYellow20","green10","green20","cyan20","cyan30","cyanBlue10","cyanBlue20","blue10","blueMagenta30","blueMagenta20","magenta20","magenta10","magentaPink10","orange30","gray30","lightGrey"];return s[parseInt(o,10)%s.length]}getImage(){if(this.personImage)return this.personImage;if(this._fetchedImage)return this._fetchedImage;const t=this.personDetailsInternal||this.personDetails;return t&&t.personImage?t.personImage:null}isLetter(t){try{return t.match(new RegExp("\\p{L}","u"))}catch(o){return t.toLowerCase()!==t.toUpperCase()}}getTextFromProperty(t,o){if(!o||0===o.length)return null;const s=o.trim().split(",");let l,h=0;for(;!l&&h<s.length;){const o=s[h].trim();switch(o){case"mail":case"email":l=getEmailFromGraphEntity(t);break;default:l=t[o]}h++}return l}isLargeAvatar(){return"large"===this.avatarSize||"auto"===this.avatarSize&&this.view>exports.ViewType.oneline}isThreeLines(){return this.view===exports.ViewType.threelines}isFourLines(){return this.view===exports.ViewType.fourlines}isVertical(){return this.verticalLayout}handleMouseClick(t){const o=t.target;this.personCardInteraction===exports.PersonCardInteraction.click&&"MGT-PERSON-CARD"!==o.tagName&&this.showPersonCard()}handleKeyDown(t){t&&"Enter"===t.key&&this.showPersonCard()}handleMouseEnter(t){clearTimeout(this._mouseEnterTimeout),clearTimeout(this._mouseLeaveTimeout),this.personCardInteraction===exports.PersonCardInteraction.hover&&(this._mouseEnterTimeout=setTimeout(this.showPersonCard.bind(this),500))}handleMouseLeave(t){clearTimeout(this._mouseEnterTimeout),clearTimeout(this._mouseLeaveTimeout),this._mouseLeaveTimeout=setTimeout(this.hidePersonCard.bind(this),500)}hidePersonCard(){const t=this.flyout;t&&t.close();const o=this.querySelector("mgt-person-card")||this.renderRoot.querySelector("mgt-person-card");o&&(o.isExpanded=!1,o.clearHistory())}showPersonCard(){this._personCardShouldRender||(this._personCardShouldRender=!0);const t=this.flyout;t&&t.open()}},exports.MgtPerson.config={useContactApis:!0},__decorate$u([e$1({attribute:"person-query"}),__metadata$s("design:type",String),__metadata$s("design:paramtypes",[String])],exports.MgtPerson.prototype,"personQuery",null),__decorate$u([e$1({attribute:"fallback-details",type:Object}),__metadata$s("design:type",Object),__metadata$s("design:paramtypes",[Object])],exports.MgtPerson.prototype,"fallbackDetails",null),__decorate$u([e$1({attribute:"user-id"}),__metadata$s("design:type",String),__metadata$s("design:paramtypes",[String])],exports.MgtPerson.prototype,"userId",null),__decorate$u([e$1({attribute:"usage"}),__metadata$s("design:type",String),__metadata$s("design:paramtypes",[String])],exports.MgtPerson.prototype,"usage",null),__decorate$u([e$1({attribute:"show-presence",type:Boolean}),__metadata$s("design:type",Boolean)],exports.MgtPerson.prototype,"showPresence",void 0),__decorate$u([e$1({attribute:"avatar-size",type:String}),__metadata$s("design:type",String)],exports.MgtPerson.prototype,"avatarSize",void 0),__decorate$u([e$1({attribute:null,type:Object}),__metadata$s("design:type",Object),__metadata$s("design:paramtypes",[Object])],exports.MgtPerson.prototype,"personDetailsInternal",null),__decorate$u([e$1({attribute:"person-details",type:Object}),__metadata$s("design:type",Object),__metadata$s("design:paramtypes",[Object])],exports.MgtPerson.prototype,"personDetails",null),__decorate$u([e$1({attribute:"person-image",type:String}),__metadata$s("design:type",String),__metadata$s("design:paramtypes",[String])],exports.MgtPerson.prototype,"personImage",null),__decorate$u([e$1({attribute:"fetch-image",type:Boolean}),__metadata$s("design:type",Boolean)],exports.MgtPerson.prototype,"fetchImage",void 0),__decorate$u([e$1({attribute:"disable-image-fetch",type:Boolean}),__metadata$s("design:type",Boolean)],exports.MgtPerson.prototype,"disableImageFetch",void 0),__decorate$u([e$1({attribute:"vertical-layout",type:Boolean}),__metadata$s("design:type",Boolean)],exports.MgtPerson.prototype,"verticalLayout",void 0),__decorate$u([e$1({attribute:"avatar-type",converter:t=>"initials"===(t=t.toLowerCase())?exports.avatarType.initials:exports.avatarType.photo}),__metadata$s("design:type",String),__metadata$s("design:paramtypes",[String])],exports.MgtPerson.prototype,"avatarType",null),__decorate$u([e$1({attribute:"person-presence",type:Object}),__metadata$s("design:type",Object),__metadata$s("design:paramtypes",[Object])],exports.MgtPerson.prototype,"personPresence",null),__decorate$u([e$1({attribute:"person-card",converter:(t,o)=>(t=t.toLowerCase(),void 0===exports.PersonCardInteraction[t]?exports.PersonCardInteraction.none:exports.PersonCardInteraction[t])}),__metadata$s("design:type",Number)],exports.MgtPerson.prototype,"personCardInteraction",void 0),__decorate$u([e$1({attribute:"line1-property"}),__metadata$s("design:type",String)],exports.MgtPerson.prototype,"line1Property",void 0),__decorate$u([e$1({attribute:"line2-property"}),__metadata$s("design:type",String)],exports.MgtPerson.prototype,"line2Property",void 0),__decorate$u([e$1({attribute:"line3-property"}),__metadata$s("design:type",String)],exports.MgtPerson.prototype,"line3Property",void 0),__decorate$u([e$1({attribute:"line4-property"}),__metadata$s("design:type",String)],exports.MgtPerson.prototype,"line4Property",void 0),__decorate$u([e$1({converter:t=>t&&0!==t.length?(t=t.toLowerCase(),void 0===exports.ViewType[t]?exports.ViewType.image:exports.ViewType[t]):exports.ViewType.image}),__metadata$s("design:type",Number)],exports.MgtPerson.prototype,"view",void 0),__decorate$u([t$1(),__metadata$s("design:type",String)],exports.MgtPerson.prototype,"_fetchedImage",void 0),__decorate$u([t$1(),__metadata$s("design:type",Object)],exports.MgtPerson.prototype,"_fetchedPresence",void 0),__decorate$u([t$1(),__metadata$s("design:type",Boolean)],exports.MgtPerson.prototype,"_isInvalidImageSrc",void 0),__decorate$u([t$1(),__metadata$s("design:type",Boolean)],exports.MgtPerson.prototype,"_personCardShouldRender",void 0),exports.MgtPerson=BA=__decorate$u([customElement("person"),__metadata$s("design:paramtypes",[])],exports.MgtPerson);const jA=[i$4`
:host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\e70d"}.ms-Icon--ChevronUp::before{content:"\\\e70e"}.ms-Icon--Contact::before{content:"\\\e77b"}.ms-Icon--AddFriend::before{content:"\\\e8fa"}.ms-Icon--OutlookLogoInverse::before{content:"\\\eb6d"}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--event-background-color:#ffffff;background-color:transparent}.mgt-dark{--event-background-color:#161514;background-color:transparent!important}:host,mgt-agenda{--card-height:auto;--card-width:99%}:host .header,mgt-agenda .header{margin:var(--agenda-header-margin,18px 0 12px 10px);font-family:var(--default-font-family);font-size:var(--agenda-header-font-size,24px);font-style:normal;font-weight:400;line-height:32px;color:var(--agenda-header-color,var(--color-sub1,var(--neutral-foreground-rest,#1a1a1a)));opacity:.9}:host .agenda,:host .group,mgt-agenda .agenda,mgt-agenda .group{display:flex;flex-direction:column;row-gap:var(--event-row-gap,14px)}:host .agenda>.group:first-child>.header,:host .group>.group:first-child>.header,mgt-agenda .agenda>.group:first-child>.header,mgt-agenda .group>.group:first-child>.header{margin-top:0}:host .agenda .event,:host .group .event,mgt-agenda .agenda .event,mgt-agenda .group .event{background:var(--event-background-color,#fff);border:var(--event-border,solid 2px transparent);box-shadow:var(--elevation-shadow-card-rest,--event-box-shadow);padding:var(--event-padding,12px);position:relative;display:flex;flex:1 1 auto;content-visibility:visible;contain:none}:host .agenda .event-container,:host .group .event-container,mgt-agenda .agenda .event-container,mgt-agenda .group .event-container{border-radius:calc(var(--layer-corner-radius) * 1px);padding:1px}:host .agenda .event.narrow,:host .group .event.narrow,mgt-agenda .agenda .event.narrow,mgt-agenda .group .event.narrow{display:flex;flex-direction:column;inset:0}:host .agenda .event-time-container,:host .group .event-time-container,mgt-agenda .agenda .event-time-container,mgt-agenda .group .event-time-container{font-family:var(--default-font-family);font-style:normal;font-weight:600;font-size:12px;color:var(--event-time-color,var(--color,#000));width:112px;height:16px}:host .agenda .event-time-container.narrow,:host .group .event-time-container.narrow,mgt-agenda .agenda .event-time-container.narrow,mgt-agenda .group .event-time-container.narrow{margin-bottom:1px;width:100%}:host .agenda .event-time-container .event-time-loading.loading-element,:host .group .event-time-container .event-time-loading.loading-element,mgt-agenda .agenda .event-time-container .event-time-loading.loading-element,mgt-agenda .group .event-time-container .event-time-loading.loading-element{background:var(--event-background-color,#fff);border-radius:1px}:host .agenda .event-time,:host .group .event-time,mgt-agenda .agenda .event-time,mgt-agenda .group .event-time{font-size:var(--event-time-font-size,12px);color:var(--event-time-color,var(--color,#000));font-weight:600}:host .agenda .event-details-container,:host .group .event-details-container,mgt-agenda .agenda .event-details-container,mgt-agenda .group .event-details-container{display:flex;flex-direction:column;position:relative;bottom:8px;top:0;padding-inline-start:32px}:host .agenda .event-details-container.narrow,:host .group .event-details-container.narrow,mgt-agenda .agenda .event-details-container.narrow,mgt-agenda .group .event-details-container.narrow{position:inherit;left:6px;display:flex;flex-direction:column;padding-inline-start:0}:host .agenda .event-details-container .event-subject-loading.loading-element,:host .group .event-details-container .event-subject-loading.loading-element,mgt-agenda .agenda .event-details-container .event-subject-loading.loading-element,mgt-agenda .group .event-details-container .event-subject-loading.loading-element{background:var(--event-background-color,#fff);border-radius:1px}:host .agenda .event-subject,:host .group .event-subject,mgt-agenda .agenda .event-subject,mgt-agenda .group .event-subject{font-family:var(--default-font-family);font-style:normal;font-weight:400;font-size:var(--event-subject-font-size,20px);line-height:28px;color:var(--event-subject-color,var(--color-sub1,var(--neutral-foreground-rest,#1a1a1a)));mix-blend-mode:normal;position:inherit;bottom:8px}:host .agenda .event-location-container,:host .group .event-location-container,mgt-agenda .agenda .event-location-container,mgt-agenda .group .event-location-container{display:inline-flex;flex-direction:row}:host .agenda .event-location-container .event-location,:host .group .event-location-container .event-location,mgt-agenda .agenda .event-location-container .event-location,mgt-agenda .group .event-location-container .event-location{padding-inline-start:3px;font-family:var(--default-font-family);font-style:normal;font-weight:400;font-size:var(--event-location-font-size,12px);line-height:16px;color:var(--event-location-color,var(--color,#000))}:host .agenda .event-location-container .event-location-loading,:host .group .event-location-container .event-location-loading,mgt-agenda .agenda .event-location-container .event-location-loading,mgt-agenda .group .event-location-container .event-location-loading{width:90px;height:10px;margin:2px 0 0 4px}:host .agenda .event-location-container .event-location-loading.loading-element,:host .group .event-location-container .event-location-loading.loading-element,mgt-agenda .agenda .event-location-container .event-location-loading.loading-element,mgt-agenda .group .event-location-container .event-location-loading.loading-element{background:var(--event-background-color,#fff);border-radius:1px}:host .agenda .event-location-container .event-location-icon svg,:host .group .event-location-container .event-location-icon svg,mgt-agenda .agenda .event-location-container .event-location-icon svg,mgt-agenda .group .event-location-container .event-location-icon svg{position:relative;top:2px;width:12px;height:12px}:host .agenda .event-location-container .event-location-icon svg path,:host .group .event-location-container .event-location-icon svg path,mgt-agenda .agenda .event-location-container .event-location-icon svg path,mgt-agenda .group .event-location-container .event-location-icon svg path{stroke:var(--event-location-color,var(--color,#000))}:host .agenda .event-location-container .event-location-icon-loading,:host .group .event-location-container .event-location-icon-loading,mgt-agenda .agenda .event-location-container .event-location-icon-loading,mgt-agenda .group .event-location-container .event-location-icon-loading{width:14px;height:14px}:host .agenda .event-location-container .event-location-icon-loading.loading-element,:host .group .event-location-container .event-location-icon-loading.loading-element,mgt-agenda .agenda .event-location-container .event-location-icon-loading.loading-element,mgt-agenda .group .event-location-container .event-location-icon-loading.loading-element{background:var(--event-background-color,#fff);border-radius:1px}:host .agenda .event-location-container .event-attendee-loading,:host .group .event-location-container .event-attendee-loading,mgt-agenda .agenda .event-location-container .event-attendee-loading,mgt-agenda .group .event-location-container .event-attendee-loading{width:20px;height:20px;border-radius:10px;margin:0 2px 0 0}:host .agenda .event-location-container .event-attendee-loading.loading-element,:host .group .event-location-container .event-attendee-loading.loading-element,mgt-agenda .agenda .event-location-container .event-attendee-loading.loading-element,mgt-agenda .group .event-location-container .event-attendee-loading.loading-element{background:var(--event-background-color,#fff);border-radius:1px}:host .agenda .event-attendees,:host .group .event-attendees,mgt-agenda .agenda .event-attendees,mgt-agenda .group .event-attendees{--list-margin:8px 0 0 0;--avatar-size-s:20px}fluent-card.event.event-loading{--card-height:90px}:host mgt-people{--color:$event__attendees__color}:host fluent-tooltip{width:auto;contain:inline-size}[dir=rtl] :host{direction:rtl}[dir=rtl] .event-time-container{direction:ltr;display:flex;justify-content:flex-end}@media (forced-colors:active) and (prefers-color-scheme:dark){:host .agenda .event-location-container .event-location-icon svg path,mgt-agenda .agenda .event-location-container .event-location-icon svg path{stroke:#fff!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host .agenda .event-location-container .event-location-icon svg path,mgt-agenda .agenda .event-location-container .event-location-icon svg path{stroke:#000!important}}
`];var __awaiter$v=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};
/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const{I:zA}=NI,c$1=()=>document.createComment(""),r=(t,o,s)=>{var l;const h=t._$AA.parentNode,v=void 0===o?t._$AB:o._$AA;if(void 0===s){const o=h.insertBefore(c$1(),v),l=h.insertBefore(c$1(),v);s=new zA(o,l,t,t.options)}else{const o=s._$AB.nextSibling,m=s._$AM,_=m!==t;if(_){let o;null===(l=s._$AQ)||void 0===l||l.call(s,t),s._$AM=t,void 0!==s._$AP&&(o=t._$AU)!==m._$AU&&s._$AP(o)}if(o!==v||_){let t=s._$AA;for(;t!==o;){const o=t.nextSibling;h.insertBefore(t,v),t=o}}}return s},u$1=(t,o,s=t)=>(t._$AI(o,s),t),VA={},p=t=>{var o;null===(o=t._$AP)||void 0===o||o.call(t,!1,!0);let s=t._$AA;const l=t._$AB.nextSibling;for(;s!==l;){const t=s.nextSibling;s.remove(),s=t}},u=(t,o,s)=>{const l=new Map;for(let h=o;h<=s;h++)l.set(t[h],h);return l},GA=e(class extends i{constructor(t){if(super(t),t.type!==EA)throw Error("repeat() can only be used in text expressions")}ht(t,o,s){let l;void 0===s?s=o:void 0!==o&&(l=o);const h=[],v=[];let m=0;for(const o of t)h[m]=l?l(o,m):m,v[m]=s(o,m),m++;return{values:v,keys:h}}render(t,o,s){return this.ht(t,o,s).values}update(t,[o,s,l]){var h;const v=(t=>t._$AH)(t),{values:m,keys:_}=this.ht(o,s,l);if(!Array.isArray(v))return this.ut=_,m;const R=null!==(h=this.ut)&&void 0!==h?h:this.ut=[],$=[];let B,q,j=0,z=v.length-1,K=0,W=m.length-1;for(;j<=z&&K<=W;)if(null===v[j])j++;else if(null===v[z])z--;else if(R[j]===_[K])$[K]=u$1(v[j],m[K]),j++,K++;else if(R[z]===_[W])$[W]=u$1(v[z],m[W]),z--,W--;else if(R[j]===_[W])$[W]=u$1(v[j],m[W]),r(t,$[W+1],v[j]),j++,W--;else if(R[z]===_[K])$[K]=u$1(v[z],m[K]),r(t,v[j],v[z]),z--,K++;else if(void 0===B&&(B=u(_,K,W),q=u(R,j,z)),B.has(R[j]))if(B.has(R[z])){const o=q.get(_[K]),s=void 0!==o?v[o]:null;if(null===s){const o=r(t,v[j]);u$1(o,m[K]),$[K]=o}else $[K]=u$1(s,m[K]),r(t,v[j],s),v[o]=null;K++}else p(v[z]),z--;else p(v[j]),j++;for(;K<=W;){const o=r(t,$[W+1]);u$1(o,m[K]),$[K++]=o}for(;j<=z;){const t=v[j++];null!==t&&p(t)}return this.ut=_,((t,o=VA)=>{t._$AH=o})(t,$),AI}}),KA=[i$4`
:host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\e70d"}.ms-Icon--ChevronUp::before{content:"\\\e70e"}.ms-Icon--Contact::before{content:"\\\e77b"}.ms-Icon--AddFriend::before{content:"\\\e8fa"}.ms-Icon--OutlookLogoInverse::before{content:"\\\eb6d"}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}:host .people-list,mgt-people .people-list{list-style-type:none;margin:var(--list-margin,8px 4px 8px 8px);padding:0;font-family:var(--default-font-family);color:var(--color,#000);font-style:normal;font-weight:400;display:flex;align-items:center}:host .people-person,mgt-people .people-person{margin:var(--avatar-margin,0 4px 0 0);display:flex}:host .overflow span,mgt-people .overflow span{vertical-align:middle;color:var(--color,#1a1a1a);font-size:12px;font-weight:400}
`];
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var __decorate$t=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},__metadata$r=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)},__awaiter$u=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};exports.MgtPeople=class MgtPeople extends MgtTemplatedComponent{static get styles(){return KA}get groupId(){return this._groupId}set groupId(t){this._groupId!==t&&(this._groupId=t,this.requestStateUpdate(!0))}get userIds(){return this._userIds}set userIds(t){arraysAreEqual(this._userIds,t)||(this._userIds=t,this.requestStateUpdate(!0))}get peopleQueries(){return this._peopleQueries}set peopleQueries(t){arraysAreEqual(this._peopleQueries,t)||(this._peopleQueries=t,this.requestStateUpdate(!0))}get resource(){return this._resource}set resource(t){this._resource!==t&&(this._resource=t,this.requestStateUpdate(!0))}get version(){return this._version}set version(t){this._version!==t&&(this._version=t,this.requestStateUpdate(!0))}get fallbackDetails(){return this._fallbackDetails}set fallbackDetails(t){t!==this._fallbackDetails&&(this._fallbackDetails=t,this.requestStateUpdate())}static get requiredScopes(){return[...new Set(["user.read.all","people.read","user.readbasic.all","presence.read.all","contacts.read",...exports.MgtPerson.requiredScopes])]}constructor(){super(),this.personCardInteraction=exports.PersonCardInteraction.hover,this.scopes=[],this._version="v1.0",this.showMax=3}clearState(){this.people=null}requestStateUpdate(t){return t&&(this.people=null),super.requestStateUpdate(t)}render(){return this.isLoadingState?this.renderLoading():this.people&&0!==this.people.length?this.renderTemplate("default",{people:this.people,max:this.showMax})||this.renderPeople():this.renderNoData()}renderLoading(){return this.renderTemplate("loading",null)||XI``}renderPeople(){const t=this.people.slice(0,this.showMax).filter((t=>t));return XI`
      <ul class="people-list" aria-label="people">
        ${GA(t,(t=>t.id?t.id:t.displayName),(t=>XI`
            <li class="people-person">
              ${this.renderPerson(t)}
            </li>
          `))}
        ${this.people.length>this.showMax?this.renderOverflow():null}
      </ul>
    `}renderOverflow(){const t=this.people.length-this.showMax;return this.renderTemplate("overflow",{extra:t,max:this.showMax,people:this.people})||XI`
        <li aria-label="and ${t} more attendees" class="overflow"><span>+${t}<span></li>
      `}renderPerson(t){let o={activity:"Offline",availability:"Offline",id:null};this.showPresence&&this._peoplePresence&&(o=this._peoplePresence[t.id]);return this.renderTemplate("person",{person:t},t.id)||mgtHtml`
        <mgt-person
          .personDetails=${t}
          .fetchImage=${!0}
          .avatarSize=${"small"}
          .personCardInteraction=${this.personCardInteraction}
          .showPresence=${this.showPresence}
          .personPresence=${o}
          .usage=${"people"}
        ></mgt-person>
      `}renderNoData(){return this.renderTemplate("no-data",null)||XI``}loadState(){return __awaiter$u(this,void 0,void 0,(function*(){if(!this.people){const t=Providers.globalProvider;if(t&&t.state===exports.ProviderState.SignedIn){const o=t.graph.forComponent(this);this.groupId?this.people=yield findGroupMembers(o,null,this.groupId,this.showMax,exports.PersonType.person):this.userIds||this.peopleQueries?this.userIds?this.people=yield getUsersForUserIds(o,this.userIds,"","",this._fallbackDetails):this.people=yield function getUsersForPeopleQueries(t,o,s){return __awaiter$A(this,void 0,void 0,(function*(){if(!o||0===o.length)return[];const l=t.createBatch(),h=[];let v,m;getIsUsersCacheEnabled()&&(m=CacheService.getCache(AA.users,AA.users.stores.usersQuery));for(const t of o)if(getIsUsersCacheEnabled()&&(v=yield m.getValue(t)),getIsUsersCacheEnabled()&&(null==v?void 0:v.results[0])&&getUserInvalidationTime()>Date.now()-v.timeCached){const t=JSON.parse(v.results[0]);h.push(t)}else l.get(t,`/me/people?$search="${t}"`,["people.read"],{"X-PeopleQuery-QuerySources":"Mailbox,Directory"});if(l.hasRequests)try{const t=yield l.executeAll();for(const l of o){const o=t.get(l);if(o&&o.content&&o.content.value&&o.content.value.length>0)h.push(o.content.value[0]),getIsUsersCacheEnabled()&&m.putValue(l,{maxResults:1,results:[JSON.stringify(o.content.value[0])]});else{const t=s.find((t=>Object.values(t).includes(l)));t&&h.push(t)}}return h}catch(s){try{return Promise.all(o.filter((t=>t&&""!==t)).map((o=>__awaiter$A(this,void 0,void 0,(function*(){const s=yield findPeople(t,o,1);if(s&&s.length)return getIsUsersCacheEnabled()&&m.putValue(o,{maxResults:1,results:[JSON.stringify(s[0])]}),s[0]})))))}catch(t){return[]}}return h}))}(o,this.peopleQueries,this._fallbackDetails):this.resource?this.people=yield function getPeopleFromResource(t,o,s,l){return __awaiter$B(this,void 0,void 0,(function*(){let h;const v=`${o}${s}`;if(getIsPeopleCacheEnabled()){h=CacheService.getCache(AA.people,AA.people.stores.peopleQuery);const t=yield h.getValue(v);if(t&&getPeopleInvalidationTime()>Date.now()-t.timeCached)return t.results.map((t=>JSON.parse(t)))}let m=t.api(s).version(o);l&&l.length&&(m=m.middlewareOptions(prepScopes(...l)));let _=yield m.get();if(_&&Array.isArray(_.value)&&_["@odata.nextLink"]){let s=_;for(;s&&s["@odata.nextLink"];){const l=s["@odata.nextLink"].split(o)[1];s=yield t.client.api(l).version(o).get(),s&&s.value&&s.value.length&&(s.value=_.value.concat(s.value),_=s)}}if(getIsPeopleCacheEnabled()&&_){const t={results:null};Array.isArray(_.value)?t.results=_.value.map((t=>JSON.stringify(t))):t.results=[JSON.stringify(_)],h.putValue(v,t)}return _?Array.isArray(_.value)?_.value:[_]:null}))}(o,this.version,this.resource,this.scopes):this.people=yield getPeople(o),this.showPresence?this._peoplePresence=yield function getUsersPresenceByPeople(t,o){return __awaiter$y(this,void 0,void 0,(function*(){if(!o||0===o.length)return{};const s={},l=[],h=["presence.read.all"];let v;getIsPresenceCacheEnabled()&&(v=CacheService.getCache(AA.presence,AA.presence.stores.presence));for(const t of o)if(null==t?void 0:t.id){const o=t.id;let h;s[o]=null,getIsPresenceCacheEnabled()&&(h=yield v.getValue(o)),getIsPresenceCacheEnabled()&&h&&getPresenceInvalidationTime()>Date.now()-(yield h).timeCached?s[o]=JSON.parse(h.presence):l.push(o)}try{if(l.length>0){const o=yield t.api("/communications/getPresencesByUserId").middlewareOptions(prepScopes(...h)).post({ids:l});for(const t of o.value)s[t.id]=t,getIsPresenceCacheEnabled()&&v.putValue(t.id,{presence:JSON.stringify(t)})}return s}catch(l){try{const l=yield Promise.all(o.filter((t=>t&&t.id&&!s[t.id]&&"personType"in t&&"OrganizationUser"===t.personType.subclass)).map((o=>getUserPresence(t,o.id))));for(const t of l)s[t.id]=t;return s}catch(t){return null}}}))}(o,this.people):this._peoplePresence=null}}}))}},__decorate$t([e$1({attribute:"group-id",type:String}),__metadata$r("design:type",String),__metadata$r("design:paramtypes",[Object])],exports.MgtPeople.prototype,"groupId",null),__decorate$t([e$1({attribute:"user-ids",converter:(t,o)=>t.split(",").map((t=>t.trim()))}),__metadata$r("design:type",Array),__metadata$r("design:paramtypes",[Array])],exports.MgtPeople.prototype,"userIds",null),__decorate$t([e$1({attribute:"people",type:Object}),__metadata$r("design:type",Array)],exports.MgtPeople.prototype,"people",void 0),__decorate$t([e$1({attribute:"people-queries",converter:(t,o)=>t.split(",").map((t=>t.trim()))}),__metadata$r("design:type",Array),__metadata$r("design:paramtypes",[Array])],exports.MgtPeople.prototype,"peopleQueries",null),__decorate$t([e$1({attribute:"show-max",type:Number}),__metadata$r("design:type",Number)],exports.MgtPeople.prototype,"showMax",void 0),__decorate$t([e$1({attribute:"show-presence",type:Boolean}),__metadata$r("design:type",Boolean)],exports.MgtPeople.prototype,"showPresence",void 0),__decorate$t([e$1({attribute:"person-card",converter:(t,o)=>(t=t.toLowerCase(),void 0===exports.PersonCardInteraction[t]?exports.PersonCardInteraction.hover:exports.PersonCardInteraction[t])}),__metadata$r("design:type",Number)],exports.MgtPeople.prototype,"personCardInteraction",void 0),__decorate$t([e$1({attribute:"resource",type:String}),__metadata$r("design:type",String),__metadata$r("design:paramtypes",[Object])],exports.MgtPeople.prototype,"resource",null),__decorate$t([e$1({attribute:"version",type:String}),__metadata$r("design:type",String),__metadata$r("design:paramtypes",[Object])],exports.MgtPeople.prototype,"version",null),__decorate$t([e$1({attribute:"scopes",converter:t=>t?t.toLowerCase().split(","):null,reflect:!0}),__metadata$r("design:type",Array)],exports.MgtPeople.prototype,"scopes",void 0),__decorate$t([e$1({attribute:"fallback-details",type:Array}),__metadata$r("design:type",Array),__metadata$r("design:paramtypes",[Array])],exports.MgtPeople.prototype,"fallbackDetails",null),exports.MgtPeople=__decorate$t([customElement("people"),__metadata$r("design:paramtypes",[])],exports.MgtPeople);const WA=function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof global)return global;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;try{return new Function("return this")()}catch(t){return{}}}();void 0===WA.trustedTypes&&(WA.trustedTypes={createPolicy:(t,o)=>o});const QA={configurable:!1,enumerable:!1,writable:!1};void 0===WA.FAST&&Reflect.defineProperty(WA,"FAST",Object.assign({value:Object.create(null)},QA));const YA=WA.FAST;if(void 0===YA.getById){const t=Object.create(null);Reflect.defineProperty(YA,"getById",Object.assign({value(o,s){let l=t[o];return void 0===l&&(l=s?t[o]=s():null),l}},QA))}const JA=Object.freeze([]);function createMetadataLocator(){const t=new WeakMap;return function(o){let s=t.get(o);if(void 0===s){let l=Reflect.getPrototypeOf(o);for(;void 0===s&&null!==l;)s=t.get(l),l=Reflect.getPrototypeOf(l);s=void 0===s?[]:s.slice(0),t.set(o,s)}return s}}const XA=WA.FAST.getById(1,(()=>{const t=[],o=[];function throwFirstError(){if(o.length)throw o.shift()}function tryRunTask(t){try{t.call()}catch(t){o.push(t),setTimeout(throwFirstError,0)}}function process(){let o=0;for(;o<t.length;)if(tryRunTask(t[o]),o++,o>1024){for(let s=0,l=t.length-o;s<l;s++)t[s]=t[s+o];t.length-=o,o=0}t.length=0}return Object.freeze({enqueue:function enqueue(o){t.length<1&&WA.requestAnimationFrame(process),t.push(o)},process:process})})),ZA=WA.trustedTypes.createPolicy("fast-html",{createHTML:t=>t});let eP=ZA;const tP=`fast-${Math.random().toString(36).substring(2,8)}`,rP=`${tP}{`,oP=`}${tP}`,nP=Object.freeze({supportsAdoptedStyleSheets:Array.isArray(document.adoptedStyleSheets)&&"replace"in CSSStyleSheet.prototype,setHTMLPolicy(t){if(eP!==ZA)throw new Error("The HTML policy can only be set once.");eP=t},createHTML:t=>eP.createHTML(t),isMarker:t=>t&&8===t.nodeType&&t.data.startsWith(tP),extractDirectiveIndexFromMarker:t=>parseInt(t.data.replace(`${tP}:`,"")),createInterpolationPlaceholder:t=>`${rP}${t}${oP}`,createCustomAttributePlaceholder(t,o){return`${t}="${this.createInterpolationPlaceholder(o)}"`},createBlockPlaceholder:t=>`\x3c!--${tP}:${t}--\x3e`,queueUpdate:XA.enqueue,processUpdates:XA.process,nextUpdate:()=>new Promise(XA.enqueue),setAttribute(t,o,s){null==s?t.removeAttribute(o):t.setAttribute(o,s)},setBooleanAttribute(t,o,s){s?t.setAttribute(o,""):t.removeAttribute(o)},removeChildNodes(t){for(let o=t.firstChild;null!==o;o=t.firstChild)t.removeChild(o)},createTemplateWalker:t=>document.createTreeWalker(t,133,null,!1)});class SubscriberSet{constructor(t,o){this.sub1=void 0,this.sub2=void 0,this.spillover=void 0,this.source=t,this.sub1=o}has(t){return void 0===this.spillover?this.sub1===t||this.sub2===t:-1!==this.spillover.indexOf(t)}subscribe(t){const o=this.spillover;if(void 0===o){if(this.has(t))return;if(void 0===this.sub1)return void(this.sub1=t);if(void 0===this.sub2)return void(this.sub2=t);this.spillover=[this.sub1,this.sub2,t],this.sub1=void 0,this.sub2=void 0}else{-1===o.indexOf(t)&&o.push(t)}}unsubscribe(t){const o=this.spillover;if(void 0===o)this.sub1===t?this.sub1=void 0:this.sub2===t&&(this.sub2=void 0);else{const s=o.indexOf(t);-1!==s&&o.splice(s,1)}}notify(t){const o=this.spillover,s=this.source;if(void 0===o){const o=this.sub1,l=this.sub2;void 0!==o&&o.handleChange(s,t),void 0!==l&&l.handleChange(s,t)}else for(let l=0,h=o.length;l<h;++l)o[l].handleChange(s,t)}}class PropertyChangeNotifier{constructor(t){this.subscribers={},this.sourceSubscribers=null,this.source=t}notify(t){var o;const s=this.subscribers[t];void 0!==s&&s.notify(t),null===(o=this.sourceSubscribers)||void 0===o||o.notify(t)}subscribe(t,o){var s;if(o){let s=this.subscribers[o];void 0===s&&(this.subscribers[o]=s=new SubscriberSet(this.source)),s.subscribe(t)}else this.sourceSubscribers=null!==(s=this.sourceSubscribers)&&void 0!==s?s:new SubscriberSet(this.source),this.sourceSubscribers.subscribe(t)}unsubscribe(t,o){var s;if(o){const s=this.subscribers[o];void 0!==s&&s.unsubscribe(t)}else null===(s=this.sourceSubscribers)||void 0===s||s.unsubscribe(t)}}const iP=YA.getById(2,(()=>{const t=/(:|&&|\|\||if)/,o=new WeakMap,s=nP.queueUpdate;let l,createArrayObserver=t=>{throw new Error("Must call enableArrayObservation before observing arrays.")};function getNotifier(t){let s=t.$fastController||o.get(t);return void 0===s&&(Array.isArray(t)?s=createArrayObserver(t):o.set(t,s=new PropertyChangeNotifier(t))),s}const h=createMetadataLocator();class DefaultObservableAccessor{constructor(t){this.name=t,this.field=`_${t}`,this.callback=`${t}Changed`}getValue(t){return void 0!==l&&l.watch(t,this.name),t[this.field]}setValue(t,o){const s=this.field,l=t[s];if(l!==o){t[s]=o;const h=t[this.callback];"function"==typeof h&&h.call(t,l,o),getNotifier(t).notify(this.name)}}}class BindingObserverImplementation extends SubscriberSet{constructor(t,o,s=!1){super(t,o),this.binding=t,this.isVolatileBinding=s,this.needsRefresh=!0,this.needsQueue=!0,this.first=this,this.last=null,this.propertySource=void 0,this.propertyName=void 0,this.notifier=void 0,this.next=void 0}observe(t,o){this.needsRefresh&&null!==this.last&&this.disconnect();const s=l;l=this.needsRefresh?this:void 0,this.needsRefresh=this.isVolatileBinding;const h=this.binding(t,o);return l=s,h}disconnect(){if(null!==this.last){let t=this.first;for(;void 0!==t;)t.notifier.unsubscribe(this,t.propertyName),t=t.next;this.last=null,this.needsRefresh=this.needsQueue=!0}}watch(t,o){const s=this.last,h=getNotifier(t),v=null===s?this.first:{};if(v.propertySource=t,v.propertyName=o,v.notifier=h,h.subscribe(this,o),null!==s){if(!this.needsRefresh){let o;l=void 0,o=s.propertySource[s.propertyName],l=this,t===o&&(this.needsRefresh=!0)}s.next=v}this.last=v}handleChange(){this.needsQueue&&(this.needsQueue=!1,s(this))}call(){null!==this.last&&(this.needsQueue=!0,this.notify(this))}records(){let t=this.first;return{next:()=>{const o=t;return void 0===o?{value:void 0,done:!0}:(t=t.next,{value:o,done:!1})},[Symbol.iterator]:function(){return this}}}}return Object.freeze({setArrayObserverFactory(t){createArrayObserver=t},getNotifier:getNotifier,track(t,o){void 0!==l&&l.watch(t,o)},trackVolatile(){void 0!==l&&(l.needsRefresh=!0)},notify(t,o){getNotifier(t).notify(o)},defineProperty(t,o){"string"==typeof o&&(o=new DefaultObservableAccessor(o)),h(t).push(o),Reflect.defineProperty(t,o.name,{enumerable:!0,get:function(){return o.getValue(this)},set:function(t){o.setValue(this,t)}})},getAccessors:h,binding(t,o,s=this.isVolatileBinding(t)){return new BindingObserverImplementation(t,o,s)},isVolatileBinding:o=>t.test(o.toString())})}));function observable(t,o){iP.defineProperty(t,o)}const sP=YA.getById(3,(()=>{let t=null;return{get:()=>t,set(o){t=o}}}));class ExecutionContext{constructor(){this.index=0,this.length=0,this.parent=null,this.parentContext=null}get event(){return sP.get()}get isEven(){return this.index%2==0}get isOdd(){return this.index%2!=0}get isFirst(){return 0===this.index}get isInMiddle(){return!this.isFirst&&!this.isLast}get isLast(){return this.index===this.length-1}static setEvent(t){sP.set(t)}}iP.defineProperty(ExecutionContext.prototype,"index"),iP.defineProperty(ExecutionContext.prototype,"length");const aP=Object.seal(new ExecutionContext);class HTMLDirective{constructor(){this.targetIndex=0}}class TargetedHTMLDirective extends HTMLDirective{constructor(){super(...arguments),this.createPlaceholder=nP.createInterpolationPlaceholder}}class AttachedBehaviorHTMLDirective extends HTMLDirective{constructor(t,o,s){super(),this.name=t,this.behavior=o,this.options=s}createPlaceholder(t){return nP.createCustomAttributePlaceholder(this.name,t)}createBehavior(t){return new this.behavior(t,this.options)}}function normalBind(t,o){this.source=t,this.context=o,null===this.bindingObserver&&(this.bindingObserver=iP.binding(this.binding,this,this.isBindingVolatile)),this.updateTarget(this.bindingObserver.observe(t,o))}function triggerBind(t,o){this.source=t,this.context=o,this.target.addEventListener(this.targetName,this)}function normalUnbind(){this.bindingObserver.disconnect(),this.source=null,this.context=null}function contentUnbind(){this.bindingObserver.disconnect(),this.source=null,this.context=null;const t=this.target.$fastView;void 0!==t&&t.isComposed&&(t.unbind(),t.needsBindOnly=!0)}function triggerUnbind(){this.target.removeEventListener(this.targetName,this),this.source=null,this.context=null}function updateAttributeTarget(t){nP.setAttribute(this.target,this.targetName,t)}function updateBooleanAttributeTarget(t){nP.setBooleanAttribute(this.target,this.targetName,t)}function updateContentTarget(t){if(null==t&&(t=""),t.create){this.target.textContent="";let o=this.target.$fastView;void 0===o?o=t.create():this.target.$fastTemplate!==t&&(o.isComposed&&(o.remove(),o.unbind()),o=t.create()),o.isComposed?o.needsBindOnly&&(o.needsBindOnly=!1,o.bind(this.source,this.context)):(o.isComposed=!0,o.bind(this.source,this.context),o.insertBefore(this.target),this.target.$fastView=o,this.target.$fastTemplate=t)}else{const o=this.target.$fastView;void 0!==o&&o.isComposed&&(o.isComposed=!1,o.remove(),o.needsBindOnly?o.needsBindOnly=!1:o.unbind()),this.target.textContent=t}}function updatePropertyTarget(t){this.target[this.targetName]=t}function updateClassTarget(t){const o=this.classVersions||Object.create(null),s=this.target;let l=this.version||0;if(null!=t&&t.length){const h=t.split(/\s+/);for(let t=0,v=h.length;t<v;++t){const v=h[t];""!==v&&(o[v]=l,s.classList.add(v))}}if(this.classVersions=o,this.version=l+1,0!==l){l-=1;for(const t in o)o[t]===l&&s.classList.remove(t)}}class HTMLBindingDirective extends TargetedHTMLDirective{constructor(t){super(),this.binding=t,this.bind=normalBind,this.unbind=normalUnbind,this.updateTarget=updateAttributeTarget,this.isBindingVolatile=iP.isVolatileBinding(this.binding)}get targetName(){return this.originalTargetName}set targetName(t){if(this.originalTargetName=t,void 0!==t)switch(t[0]){case":":if(this.cleanedTargetName=t.substr(1),this.updateTarget=updatePropertyTarget,"innerHTML"===this.cleanedTargetName){const t=this.binding;this.binding=(o,s)=>nP.createHTML(t(o,s))}break;case"?":this.cleanedTargetName=t.substr(1),this.updateTarget=updateBooleanAttributeTarget;break;case"@":this.cleanedTargetName=t.substr(1),this.bind=triggerBind,this.unbind=triggerUnbind;break;default:this.cleanedTargetName=t,"class"===t&&(this.updateTarget=updateClassTarget)}}targetAtContent(){this.updateTarget=updateContentTarget,this.unbind=contentUnbind}createBehavior(t){return new BindingBehavior(t,this.binding,this.isBindingVolatile,this.bind,this.unbind,this.updateTarget,this.cleanedTargetName)}}class BindingBehavior{constructor(t,o,s,l,h,v,m){this.source=null,this.context=null,this.bindingObserver=null,this.target=t,this.binding=o,this.isBindingVolatile=s,this.bind=l,this.unbind=h,this.updateTarget=v,this.targetName=m}handleChange(){this.updateTarget(this.bindingObserver.observe(this.source,this.context))}handleEvent(t){ExecutionContext.setEvent(t);const o=this.binding(this.source,this.context);ExecutionContext.setEvent(null),!0!==o&&t.preventDefault()}}let lP=null;class CompilationContext{addFactory(t){t.targetIndex=this.targetIndex,this.behaviorFactories.push(t)}captureContentBinding(t){t.targetAtContent(),this.addFactory(t)}reset(){this.behaviorFactories=[],this.targetIndex=-1}release(){lP=this}static borrow(t){const o=lP||new CompilationContext;return o.directives=t,o.reset(),lP=null,o}}function createAggregateBinding(t){if(1===t.length)return t[0];let o;const s=t.length,l=t.map((t=>"string"==typeof t?()=>t:(o=t.targetName||o,t.binding))),h=new HTMLBindingDirective(((t,o)=>{let h="";for(let v=0;v<s;++v)h+=l[v](t,o);return h}));return h.targetName=o,h}const cP=oP.length;function parseContent(t,o){const s=o.split(rP);if(1===s.length)return null;const l=[];for(let o=0,h=s.length;o<h;++o){const h=s[o],v=h.indexOf(oP);let m;if(-1===v)m=h;else{const o=parseInt(h.substring(0,v));l.push(t.directives[o]),m=h.substring(v+cP)}""!==m&&l.push(m)}return l}function compileAttributes(t,o,s=!1){const l=o.attributes;for(let h=0,v=l.length;h<v;++h){const m=l[h],_=m.value,R=parseContent(t,_);let $=null;null===R?s&&($=new HTMLBindingDirective((()=>_)),$.targetName=m.name):$=createAggregateBinding(R),null!==$&&(o.removeAttributeNode(m),h--,v--,t.addFactory($))}}function compileContent(t,o,s){const l=parseContent(t,o.textContent);if(null!==l){let h=o;for(let v=0,m=l.length;v<m;++v){const m=l[v],_=0===v?o:h.parentNode.insertBefore(document.createTextNode(""),h.nextSibling);"string"==typeof m?_.textContent=m:(_.textContent=" ",t.captureContentBinding(m)),h=_,t.targetIndex++,_!==o&&s.nextNode()}t.targetIndex--}}const dP=document.createRange();class HTMLView{constructor(t,o){this.fragment=t,this.behaviors=o,this.source=null,this.context=null,this.firstChild=t.firstChild,this.lastChild=t.lastChild}appendTo(t){t.appendChild(this.fragment)}insertBefore(t){if(this.fragment.hasChildNodes())t.parentNode.insertBefore(this.fragment,t);else{const o=this.lastChild;if(t.previousSibling===o)return;const s=t.parentNode;let l,h=this.firstChild;for(;h!==o;)l=h.nextSibling,s.insertBefore(h,t),h=l;s.insertBefore(o,t)}}remove(){const t=this.fragment,o=this.lastChild;let s,l=this.firstChild;for(;l!==o;)s=l.nextSibling,t.appendChild(l),l=s;t.appendChild(o)}dispose(){const t=this.firstChild.parentNode,o=this.lastChild;let s,l=this.firstChild;for(;l!==o;)s=l.nextSibling,t.removeChild(l),l=s;t.removeChild(o);const h=this.behaviors,v=this.source;for(let t=0,o=h.length;t<o;++t)h[t].unbind(v)}bind(t,o){const s=this.behaviors;if(this.source!==t)if(null!==this.source){const l=this.source;this.source=t,this.context=o;for(let h=0,v=s.length;h<v;++h){const v=s[h];v.unbind(l),v.bind(t,o)}}else{this.source=t,this.context=o;for(let l=0,h=s.length;l<h;++l)s[l].bind(t,o)}}unbind(){if(null===this.source)return;const t=this.behaviors,o=this.source;for(let s=0,l=t.length;s<l;++s)t[s].unbind(o);this.source=null}static disposeContiguousBatch(t){if(0!==t.length){dP.setStartBefore(t[0].firstChild),dP.setEndAfter(t[t.length-1].lastChild),dP.deleteContents();for(let o=0,s=t.length;o<s;++o){const s=t[o],l=s.behaviors,h=s.source;for(let t=0,o=l.length;t<o;++t)l[t].unbind(h)}}}}class ViewTemplate{constructor(t,o){this.behaviorCount=0,this.hasHostBehaviors=!1,this.fragment=null,this.targetOffset=0,this.viewBehaviorFactories=null,this.hostBehaviorFactories=null,this.html=t,this.directives=o}create(t){if(null===this.fragment){let t;const o=this.html;if("string"==typeof o){t=document.createElement("template"),t.innerHTML=nP.createHTML(o);const s=t.content.firstElementChild;null!==s&&"TEMPLATE"===s.tagName&&(t=s)}else t=o;const s=function compileTemplate(t,o){const s=t.content;document.adoptNode(s);const l=CompilationContext.borrow(o);compileAttributes(l,t,!0);const h=l.behaviorFactories;l.reset();const v=nP.createTemplateWalker(s);let m;for(;m=v.nextNode();)switch(l.targetIndex++,m.nodeType){case 1:compileAttributes(l,m);break;case 3:compileContent(l,m,v);break;case 8:nP.isMarker(m)&&l.addFactory(o[nP.extractDirectiveIndexFromMarker(m)])}let _=0;(nP.isMarker(s.firstChild)||1===s.childNodes.length&&o.length)&&(s.insertBefore(document.createComment(""),s.firstChild),_=-1);const R=l.behaviorFactories;return l.release(),{fragment:s,viewBehaviorFactories:R,hostBehaviorFactories:h,targetOffset:_}}(t,this.directives);this.fragment=s.fragment,this.viewBehaviorFactories=s.viewBehaviorFactories,this.hostBehaviorFactories=s.hostBehaviorFactories,this.targetOffset=s.targetOffset,this.behaviorCount=this.viewBehaviorFactories.length+this.hostBehaviorFactories.length,this.hasHostBehaviors=this.hostBehaviorFactories.length>0}const o=this.fragment.cloneNode(!0),s=this.viewBehaviorFactories,l=new Array(this.behaviorCount),h=nP.createTemplateWalker(o);let v=0,m=this.targetOffset,_=h.nextNode();for(let t=s.length;v<t;++v){const t=s[v],o=t.targetIndex;for(;null!==_;){if(m===o){l[v]=t.createBehavior(_);break}_=h.nextNode(),m++}}if(this.hasHostBehaviors){const o=this.hostBehaviorFactories;for(let s=0,h=o.length;s<h;++s,++v)l[v]=o[s].createBehavior(t)}return new HTMLView(o,l)}render(t,o,s){"string"==typeof o&&(o=document.getElementById(o)),void 0===s&&(s=o);const l=this.create(s);return l.bind(t,aP),l.appendTo(o),l}}const uP=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;function html(t,...o){const s=[];let l="";for(let h=0,v=t.length-1;h<v;++h){const v=t[h];let m=o[h];if(l+=v,m instanceof ViewTemplate){const t=m;m=()=>t}if("function"==typeof m&&(m=new HTMLBindingDirective(m)),m instanceof TargetedHTMLDirective){const t=uP.exec(v);null!==t&&(m.targetName=t[2])}m instanceof HTMLDirective?(l+=m.createPlaceholder(s.length),s.push(m)):l+=m}return l+=t[t.length-1],new ViewTemplate(l,s)}class ElementStyles{constructor(){this.targets=new WeakSet}addStylesTo(t){this.targets.add(t)}removeStylesFrom(t){this.targets.delete(t)}isAttachedTo(t){return this.targets.has(t)}withBehaviors(...t){return this.behaviors=null===this.behaviors?t:this.behaviors.concat(t),this}}function reduceStyles(t){return t.map((t=>t instanceof ElementStyles?reduceStyles(t.styles):[t])).reduce(((t,o)=>t.concat(o)),[])}function reduceBehaviors(t){return t.map((t=>t instanceof ElementStyles?t.behaviors:null)).reduce(((t,o)=>null===o?t:(null===t&&(t=[]),t.concat(o))),null)}ElementStyles.create=(()=>{if(nP.supportsAdoptedStyleSheets){const t=new Map;return o=>new AdoptedStyleSheetsStyles(o,t)}return t=>new StyleElementStyles(t)})();class AdoptedStyleSheetsStyles extends ElementStyles{constructor(t,o){super(),this.styles=t,this.styleSheetCache=o,this._styleSheets=void 0,this.behaviors=reduceBehaviors(t)}get styleSheets(){if(void 0===this._styleSheets){const t=this.styles,o=this.styleSheetCache;this._styleSheets=reduceStyles(t).map((t=>{if(t instanceof CSSStyleSheet)return t;let s=o.get(t);return void 0===s&&(s=new CSSStyleSheet,s.replaceSync(t),o.set(t,s)),s}))}return this._styleSheets}addStylesTo(t){t.adoptedStyleSheets=[...t.adoptedStyleSheets,...this.styleSheets],super.addStylesTo(t)}removeStylesFrom(t){const o=this.styleSheets;t.adoptedStyleSheets=t.adoptedStyleSheets.filter((t=>-1===o.indexOf(t))),super.removeStylesFrom(t)}}let hP=0;class StyleElementStyles extends ElementStyles{constructor(t){super(),this.styles=t,this.behaviors=null,this.behaviors=reduceBehaviors(t),this.styleSheets=reduceStyles(t),this.styleClass=function getNextStyleClass(){return"fast-style-class-"+ ++hP}()}addStylesTo(t){const o=this.styleSheets,s=this.styleClass;t=this.normalizeTarget(t);for(let l=0;l<o.length;l++){const h=document.createElement("style");h.innerHTML=o[l],h.className=s,t.append(h)}super.addStylesTo(t)}removeStylesFrom(t){const o=(t=this.normalizeTarget(t)).querySelectorAll(`.${this.styleClass}`);for(let s=0,l=o.length;s<l;++s)t.removeChild(o[s]);super.removeStylesFrom(t)}isAttachedTo(t){return super.isAttachedTo(this.normalizeTarget(t))}normalizeTarget(t){return t===document?document.body:t}}const pP=Object.freeze({locate:createMetadataLocator()}),fP={toView:t=>t?"true":"false",fromView:t=>null!=t&&"false"!==t&&!1!==t&&0!==t},gP={toView(t){if(null==t)return null;const o=1*t;return isNaN(o)?null:o.toString()},fromView(t){if(null==t)return null;const o=1*t;return isNaN(o)?null:o}};class AttributeDefinition{constructor(t,o,s=o.toLowerCase(),l="reflect",h){this.guards=new Set,this.Owner=t,this.name=o,this.attribute=s,this.mode=l,this.converter=h,this.fieldName=`_${o}`,this.callbackName=`${o}Changed`,this.hasCallback=this.callbackName in t.prototype,"boolean"===l&&void 0===h&&(this.converter=fP)}setValue(t,o){const s=t[this.fieldName],l=this.converter;void 0!==l&&(o=l.fromView(o)),s!==o&&(t[this.fieldName]=o,this.tryReflectToAttribute(t),this.hasCallback&&t[this.callbackName](s,o),t.$fastController.notify(this.name))}getValue(t){return iP.track(t,this.name),t[this.fieldName]}onAttributeChangedCallback(t,o){this.guards.has(t)||(this.guards.add(t),this.setValue(t,o),this.guards.delete(t))}tryReflectToAttribute(t){const o=this.mode,s=this.guards;s.has(t)||"fromView"===o||nP.queueUpdate((()=>{s.add(t);const l=t[this.fieldName];switch(o){case"reflect":const o=this.converter;nP.setAttribute(t,this.attribute,void 0!==o?o.toView(l):l);break;case"boolean":nP.setBooleanAttribute(t,this.attribute,l)}s.delete(t)}))}static collect(t,...o){const s=[];o.push(pP.locate(t));for(let l=0,h=o.length;l<h;++l){const h=o[l];if(void 0!==h)for(let o=0,l=h.length;o<l;++o){const l=h[o];"string"==typeof l?s.push(new AttributeDefinition(t,l)):s.push(new AttributeDefinition(t,l.property,l.attribute,l.mode,l.converter))}}return s}}function attr(t,o){let s;function decorator(t,o){arguments.length>1&&(s.property=o),pP.locate(t.constructor).push(s)}return arguments.length>1?(s={},void decorator(t,o)):(s=void 0===t?{}:t,decorator)}const vP={mode:"open"},mP={},bP=YA.getById(4,(()=>{const t=new Map;return Object.freeze({register:o=>!t.has(o.type)&&(t.set(o.type,o),!0),getByType:o=>t.get(o)})}));class FASTElementDefinition{constructor(t,o=t.definition){"string"==typeof o&&(o={name:o}),this.type=t,this.name=o.name,this.template=o.template;const s=AttributeDefinition.collect(t,o.attributes),l=new Array(s.length),h={},v={};for(let t=0,o=s.length;t<o;++t){const o=s[t];l[t]=o.attribute,h[o.name]=o,v[o.attribute]=o}this.attributes=s,this.observedAttributes=l,this.propertyLookup=h,this.attributeLookup=v,this.shadowOptions=void 0===o.shadowOptions?vP:null===o.shadowOptions?void 0:Object.assign(Object.assign({},vP),o.shadowOptions),this.elementOptions=void 0===o.elementOptions?mP:Object.assign(Object.assign({},mP),o.elementOptions),this.styles=void 0===o.styles?void 0:Array.isArray(o.styles)?ElementStyles.create(o.styles):o.styles instanceof ElementStyles?o.styles:ElementStyles.create([o.styles])}get isDefined(){return!!bP.getByType(this.type)}define(t=customElements){const o=this.type;if(bP.register(this)){const t=this.attributes,s=o.prototype;for(let o=0,l=t.length;o<l;++o)iP.defineProperty(s,t[o]);Reflect.defineProperty(o,"observedAttributes",{value:this.observedAttributes,enumerable:!0})}return t.get(this.name)||t.define(this.name,o,this.elementOptions),this}}FASTElementDefinition.forType=bP.getByType;const yP=new WeakMap,wP={bubbles:!0,composed:!0,cancelable:!0};function getShadowRoot(t){return t.shadowRoot||yP.get(t)||null}class Controller extends PropertyChangeNotifier{constructor(t,o){super(t),this.boundObservables=null,this.behaviors=null,this.needsInitialization=!0,this._template=null,this._styles=null,this._isConnected=!1,this.$fastController=this,this.view=null,this.element=t,this.definition=o;const s=o.shadowOptions;if(void 0!==s){const o=t.attachShadow(s);"closed"===s.mode&&yP.set(t,o)}const l=iP.getAccessors(t);if(l.length>0){const o=this.boundObservables=Object.create(null);for(let s=0,h=l.length;s<h;++s){const h=l[s].name,v=t[h];void 0!==v&&(delete t[h],o[h]=v)}}}get isConnected(){return iP.track(this,"isConnected"),this._isConnected}setIsConnected(t){this._isConnected=t,iP.notify(this,"isConnected")}get template(){return this._template}set template(t){this._template!==t&&(this._template=t,this.needsInitialization||this.renderTemplate(t))}get styles(){return this._styles}set styles(t){this._styles!==t&&(null!==this._styles&&this.removeStyles(this._styles),this._styles=t,this.needsInitialization||null===t||this.addStyles(t))}addStyles(t){const o=getShadowRoot(this.element)||this.element.getRootNode();if(t instanceof HTMLStyleElement)o.append(t);else if(!t.isAttachedTo(o)){const s=t.behaviors;t.addStylesTo(o),null!==s&&this.addBehaviors(s)}}removeStyles(t){const o=getShadowRoot(this.element)||this.element.getRootNode();if(t instanceof HTMLStyleElement)o.removeChild(t);else if(t.isAttachedTo(o)){const s=t.behaviors;t.removeStylesFrom(o),null!==s&&this.removeBehaviors(s)}}addBehaviors(t){const o=this.behaviors||(this.behaviors=new Map),s=t.length,l=[];for(let h=0;h<s;++h){const s=t[h];o.has(s)?o.set(s,o.get(s)+1):(o.set(s,1),l.push(s))}if(this._isConnected){const t=this.element;for(let o=0;o<l.length;++o)l[o].bind(t,aP)}}removeBehaviors(t,o=!1){const s=this.behaviors;if(null===s)return;const l=t.length,h=[];for(let v=0;v<l;++v){const l=t[v];if(s.has(l)){const t=s.get(l)-1;0===t||o?s.delete(l)&&h.push(l):s.set(l,t)}}if(this._isConnected){const t=this.element;for(let o=0;o<h.length;++o)h[o].unbind(t)}}onConnectedCallback(){if(this._isConnected)return;const t=this.element;this.needsInitialization?this.finishInitialization():null!==this.view&&this.view.bind(t,aP);const o=this.behaviors;if(null!==o)for(const[s]of o)s.bind(t,aP);this.setIsConnected(!0)}onDisconnectedCallback(){if(!this._isConnected)return;this.setIsConnected(!1);const t=this.view;null!==t&&t.unbind();const o=this.behaviors;if(null!==o){const t=this.element;for(const[s]of o)s.unbind(t)}}onAttributeChangedCallback(t,o,s){const l=this.definition.attributeLookup[t];void 0!==l&&l.onAttributeChangedCallback(this.element,s)}emit(t,o,s){return!!this._isConnected&&this.element.dispatchEvent(new CustomEvent(t,Object.assign(Object.assign({detail:o},wP),s)))}finishInitialization(){const t=this.element,o=this.boundObservables;if(null!==o){const s=Object.keys(o);for(let l=0,h=s.length;l<h;++l){const h=s[l];t[h]=o[h]}this.boundObservables=null}const s=this.definition;null===this._template&&(this.element.resolveTemplate?this._template=this.element.resolveTemplate():s.template&&(this._template=s.template||null)),null!==this._template&&this.renderTemplate(this._template),null===this._styles&&(this.element.resolveStyles?this._styles=this.element.resolveStyles():s.styles&&(this._styles=s.styles||null)),null!==this._styles&&this.addStyles(this._styles),this.needsInitialization=!1}renderTemplate(t){const o=this.element,s=getShadowRoot(o)||o;null!==this.view?(this.view.dispose(),this.view=null):this.needsInitialization||nP.removeChildNodes(s),t&&(this.view=t.render(o,s,o))}static forCustomElement(t){const o=t.$fastController;if(void 0!==o)return o;const s=FASTElementDefinition.forType(t.constructor);if(void 0===s)throw new Error("Missing FASTElement definition.");return t.$fastController=new Controller(t,s)}}function createFASTElement(t){return class extends t{constructor(){super(),Controller.forCustomElement(this)}$emit(t,o,s){return this.$fastController.emit(t,o,s)}connectedCallback(){this.$fastController.onConnectedCallback()}disconnectedCallback(){this.$fastController.onDisconnectedCallback()}attributeChangedCallback(t,o,s){this.$fastController.onAttributeChangedCallback(t,o,s)}}}const _P=Object.assign(createFASTElement(HTMLElement),{from:t=>createFASTElement(t),define:(t,o)=>new FASTElementDefinition(t,o).define().type});class CSSDirective{createCSS(){return""}createBehavior(){}}function collectStyles(t,o){const s=[];let l="";const h=[];for(let v=0,m=t.length-1;v<m;++v){l+=t[v];let m=o[v];if(m instanceof CSSDirective){const t=m.createBehavior();m=m.createCSS(),t&&h.push(t)}m instanceof ElementStyles||m instanceof CSSStyleSheet?(""!==l.trim()&&(s.push(l),l=""),s.push(m)):l+=m}return l+=t[t.length-1],""!==l.trim()&&s.push(l),{styles:s,behaviors:h}}function css(t,...o){const{styles:s,behaviors:l}=collectStyles(t,o),h=ElementStyles.create(s);return l.length&&h.withBehaviors(...l),h}class CSSPartial extends CSSDirective{constructor(t,o){super(),this.behaviors=o,this.css="";const s=t.reduce(((t,o)=>("string"==typeof o?this.css+=o:t.push(o),t)),[]);s.length&&(this.styles=ElementStyles.create(s))}createBehavior(){return this}createCSS(){return this.css}bind(t){this.styles&&t.$fastController.addStyles(this.styles),this.behaviors.length&&t.$fastController.addBehaviors(this.behaviors)}unbind(t){this.styles&&t.$fastController.removeStyles(this.styles),this.behaviors.length&&t.$fastController.removeBehaviors(this.behaviors)}}function cssPartial(t,...o){const{styles:s,behaviors:l}=collectStyles(t,o);return new CSSPartial(s,l)}class RefBehavior{constructor(t,o){this.target=t,this.propertyName=o}bind(t){t[this.propertyName]=this.target}unbind(){}}function ref(t){return new AttachedBehaviorHTMLDirective("fast-ref",RefBehavior,t)}function when(t,o){const s="function"==typeof o?o:()=>o;return(o,l)=>t(o,l)?s(o,l):null}function elements(t){return t?function(o,s,l){return 1===o.nodeType&&o.matches(t)}:function(t,o,s){return 1===t.nodeType}}class NodeObservationBehavior{constructor(t,o){this.target=t,this.options=o,this.source=null}bind(t){const o=this.options.property;this.shouldUpdate=iP.getAccessors(t).some((t=>t.name===o)),this.source=t,this.updateTarget(this.computeNodes()),this.shouldUpdate&&this.observe()}unbind(){this.updateTarget(JA),this.source=null,this.shouldUpdate&&this.disconnect()}handleEvent(){this.updateTarget(this.computeNodes())}computeNodes(){let t=this.getNodes();return void 0!==this.options.filter&&(t=t.filter(this.options.filter)),t}updateTarget(t){this.source[this.options.property]=t}}class SlottedBehavior extends NodeObservationBehavior{constructor(t,o){super(t,o)}observe(){this.target.addEventListener("slotchange",this)}disconnect(){this.target.removeEventListener("slotchange",this)}getNodes(){return this.target.assignedNodes(this.options)}}function slotted(t){return"string"==typeof t&&(t={property:t}),new AttachedBehaviorHTMLDirective("fast-slotted",SlottedBehavior,t)}class ChildrenBehavior extends NodeObservationBehavior{constructor(t,o){super(t,o),this.observer=null,o.childList=!0}observe(){null===this.observer&&(this.observer=new MutationObserver(this.handleEvent.bind(this))),this.observer.observe(this.target,this.options)}disconnect(){this.observer.disconnect()}getNodes(){return"subtree"in this.options?Array.from(this.target.querySelectorAll(this.options.selector)):Array.from(this.target.childNodes)}}class StartEnd{handleStartContentChange(){this.startContainer.classList.toggle("start",this.start.assignedNodes().length>0)}handleEndContentChange(){this.endContainer.classList.toggle("end",this.end.assignedNodes().length>0)}}const endSlotTemplate=(t,o)=>html`
    <span
        part="end"
        ${ref("endContainer")}
        class=${t=>o.end?"end":void 0}
    >
        <slot name="end" ${ref("end")} @slotchange="${t=>t.handleEndContentChange()}">
            ${o.end||""}
        </slot>
    </span>
`,startSlotTemplate=(t,o)=>html`
    <span
        part="start"
        ${ref("startContainer")}
        class="${t=>o.start?"start":void 0}"
    >
        <slot
            name="start"
            ${ref("start")}
            @slotchange="${t=>t.handleStartContentChange()}"
        >
            ${o.start||""}
        </slot>
    </span>
`;
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
function __decorate$s(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m}html`
    <span part="end" ${ref("endContainer")}>
        <slot
            name="end"
            ${ref("end")}
            @slotchange="${t=>t.handleEndContentChange()}"
        ></slot>
    </span>
`,html`
    <span part="start" ${ref("startContainer")}>
        <slot
            name="start"
            ${ref("start")}
            @slotchange="${t=>t.handleStartContentChange()}"
        ></slot>
    </span>
`;const CP=new Map;"metadata"in Reflect||(Reflect.metadata=function(t,o){return function(s){Reflect.defineMetadata(t,o,s)}},Reflect.defineMetadata=function(t,o,s){let l=CP.get(s);void 0===l&&CP.set(s,l=new Map),l.set(t,o)},Reflect.getOwnMetadata=function(t,o){const s=CP.get(o);if(void 0!==s)return s.get(t)});class ResolverBuilder{constructor(t,o){this.container=t,this.key=o}instance(t){return this.registerResolver(0,t)}singleton(t){return this.registerResolver(1,t)}transient(t){return this.registerResolver(2,t)}callback(t){return this.registerResolver(3,t)}cachedCallback(t){return this.registerResolver(3,cacheCallbackResult(t))}aliasTo(t){return this.registerResolver(5,t)}registerResolver(t,o){const{container:s,key:l}=this;return this.container=this.key=void 0,s.registerResolver(l,new ResolverImpl(l,t,o))}}function cloneArrayWithPossibleProps(t){const o=t.slice(),s=Object.keys(t),l=s.length;let h;for(let v=0;v<l;++v)h=s[v],isArrayIndex(h)||(o[h]=t[h]);return o}const kP=Object.freeze({none(t){throw Error(`${t.toString()} not registered, did you forget to add @singleton()?`)},singleton:t=>new ResolverImpl(t,1,t),transient:t=>new ResolverImpl(t,2,t)}),TP=Object.freeze({default:Object.freeze({parentLocator:()=>null,responsibleForOwnerRequests:!1,defaultResolver:kP.singleton})}),SP=new Map;function getParamTypes(t){return o=>Reflect.getOwnMetadata(t,o)}let xP=null;const EP=Object.freeze({createContainer:t=>new ContainerImpl(null,Object.assign({},TP.default,t)),findResponsibleContainer(t){const o=t.$$container$$;return o&&o.responsibleForOwnerRequests?o:EP.findParentContainer(t)},findParentContainer(t){const o=new CustomEvent(OP,{bubbles:!0,composed:!0,cancelable:!0,detail:{container:void 0}});return t.dispatchEvent(o),o.detail.container||EP.getOrCreateDOMContainer()},getOrCreateDOMContainer:(t,o)=>t?t.$$container$$||new ContainerImpl(t,Object.assign({},TP.default,o,{parentLocator:EP.findParentContainer})):xP||(xP=new ContainerImpl(null,Object.assign({},TP.default,o,{parentLocator:()=>null}))),getDesignParamtypes:getParamTypes("design:paramtypes"),getAnnotationParamtypes:getParamTypes("di:paramtypes"),getOrCreateAnnotationParamTypes(t){let o=this.getAnnotationParamtypes(t);return void 0===o&&Reflect.defineMetadata("di:paramtypes",o=[],t),o},getDependencies(t){let o=SP.get(t);if(void 0===o){const s=t.inject;if(void 0===s){const s=EP.getDesignParamtypes(t),l=EP.getAnnotationParamtypes(t);if(void 0===s)if(void 0===l){const s=Object.getPrototypeOf(t);o="function"==typeof s&&s!==Function.prototype?cloneArrayWithPossibleProps(EP.getDependencies(s)):[]}else o=cloneArrayWithPossibleProps(l);else if(void 0===l)o=cloneArrayWithPossibleProps(s);else{o=cloneArrayWithPossibleProps(s);let t,h=l.length;for(let s=0;s<h;++s)t=l[s],void 0!==t&&(o[s]=t);const v=Object.keys(l);let m;h=v.length;for(let t=0;t<h;++t)m=v[t],isArrayIndex(m)||(o[m]=l[m])}}else o=cloneArrayWithPossibleProps(s);SP.set(t,o)}return o},defineProperty(t,o,s,l=!1){const h=`$di_${o}`;Reflect.defineProperty(t,o,{get:function(){let t=this[h];if(void 0===t){const v=this instanceof HTMLElement?EP.findResponsibleContainer(this):EP.getOrCreateDOMContainer();if(t=v.get(s),this[h]=t,l&&this instanceof _P){const l=this.$fastController,handleChange=()=>{EP.findResponsibleContainer(this).get(s)!==this[h]&&(this[h]=t,l.notify(o))};l.subscribe({handleChange:handleChange},"isConnected")}}return t}})},createInterface(t,o){const s="function"==typeof t?t:o,l="string"==typeof t?t:t&&"friendlyName"in t&&t.friendlyName||DP,h="string"!=typeof t&&(t&&"respectConnection"in t&&t.respectConnection||!1),Interface=function(t,o,s){if(null==t||void 0!==new.target)throw new Error(`No registration for interface: '${Interface.friendlyName}'`);if(o)EP.defineProperty(t,o,Interface,h);else{EP.getOrCreateAnnotationParamTypes(t)[s]=Interface}};return Interface.$isInterface=!0,Interface.friendlyName=null==l?"(anonymous)":l,null!=s&&(Interface.register=function(t,o){return s(new ResolverBuilder(t,null!=o?o:Interface))}),Interface.toString=function toString(){return`InterfaceSymbol<${Interface.friendlyName}>`},Interface},inject:(...t)=>function(o,s,l){if("number"==typeof l){const s=EP.getOrCreateAnnotationParamTypes(o),h=t[0];void 0!==h&&(s[l]=h)}else if(s)EP.defineProperty(o,s,t[0]);else{const s=l?EP.getOrCreateAnnotationParamTypes(l.value):EP.getOrCreateAnnotationParamTypes(o);let h;for(let o=0;o<t.length;++o)h=t[o],void 0!==h&&(s[o]=h)}},transient:t=>(t.register=function register(o){return MP.transient(t,t).register(o)},t.registerInRequestor=!1,t),singleton:(t,o=AP)=>(t.register=function register(o){return MP.singleton(t,t).register(o)},t.registerInRequestor=o.scoped,t)}),IP=EP.createInterface("Container");EP.inject;const AP={scoped:!1};class ResolverImpl{constructor(t,o,s){this.key=t,this.strategy=o,this.state=s,this.resolving=!1}get $isResolver(){return!0}register(t){return t.registerResolver(this.key,this)}resolve(t,o){switch(this.strategy){case 0:return this.state;case 1:if(this.resolving)throw new Error(`Cyclic dependency found: ${this.state.name}`);return this.resolving=!0,this.state=t.getFactory(this.state).construct(o),this.strategy=0,this.resolving=!1,this.state;case 2:{const s=t.getFactory(this.state);if(null===s)throw new Error(`Resolver for ${String(this.key)} returned a null factory`);return s.construct(o)}case 3:return this.state(t,o,this);case 4:return this.state[0].resolve(t,o);case 5:return o.get(this.state);default:throw new Error(`Invalid resolver strategy specified: ${this.strategy}.`)}}getFactory(t){var o,s,l;switch(this.strategy){case 1:case 2:return t.getFactory(this.state);case 5:return null!==(l=null===(s=null===(o=t.getResolver(this.state))||void 0===o?void 0:o.getFactory)||void 0===s?void 0:s.call(o,t))&&void 0!==l?l:null;default:return null}}}function containerGetKey(t){return this.get(t)}function transformInstance(t,o){return o(t)}class FactoryImpl{constructor(t,o){this.Type=t,this.dependencies=o,this.transformers=null}construct(t,o){let s;return s=void 0===o?new this.Type(...this.dependencies.map(containerGetKey,t)):new this.Type(...this.dependencies.map(containerGetKey,t),...o),null==this.transformers?s:this.transformers.reduce(transformInstance,s)}registerTransformer(t){(this.transformers||(this.transformers=[])).push(t)}}const PP={$isResolver:!0,resolve:(t,o)=>o};function isRegistry(t){return"function"==typeof t.register}function isRegisterInRequester(t){return function isSelfRegistry(t){return isRegistry(t)&&"boolean"==typeof t.registerInRequestor}(t)&&t.registerInRequestor}const RP=new Set(["Array","ArrayBuffer","Boolean","DataView","Date","Error","EvalError","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Number","Object","Promise","RangeError","ReferenceError","RegExp","Set","SharedArrayBuffer","String","SyntaxError","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","URIError","WeakMap","WeakSet"]),OP="__DI_LOCATE_PARENT__",$P=new Map;class ContainerImpl{constructor(t,o){this.owner=t,this.config=o,this._parent=void 0,this.registerDepth=0,this.context=null,null!==t&&(t.$$container$$=this),this.resolvers=new Map,this.resolvers.set(IP,PP),t instanceof Node&&t.addEventListener(OP,(t=>{t.composedPath()[0]!==this.owner&&(t.detail.container=this,t.stopImmediatePropagation())}))}get parent(){return void 0===this._parent&&(this._parent=this.config.parentLocator(this.owner)),this._parent}get depth(){return null===this.parent?0:this.parent.depth+1}get responsibleForOwnerRequests(){return this.config.responsibleForOwnerRequests}registerWithContext(t,...o){return this.context=t,this.register(...o),this.context=null,this}register(...t){if(100==++this.registerDepth)throw new Error("Unable to autoregister dependency");let o,s,l,h,v;const m=this.context;for(let _=0,R=t.length;_<R;++_)if(o=t[_],isObject(o))if(isRegistry(o))o.register(this,m);else if(void 0!==o.prototype)MP.singleton(o,o).register(this);else for(s=Object.keys(o),h=0,v=s.length;h<v;++h)l=o[s[h]],isObject(l)&&(isRegistry(l)?l.register(this,m):this.register(l));return--this.registerDepth,this}registerResolver(t,o){validateKey(t);const s=this.resolvers,l=s.get(t);return null==l?s.set(t,o):l instanceof ResolverImpl&&4===l.strategy?l.state.push(o):s.set(t,new ResolverImpl(t,4,[l,o])),o}registerTransformer(t,o){const s=this.getResolver(t);if(null==s)return!1;if(s.getFactory){const t=s.getFactory(this);return null!=t&&(t.registerTransformer(o),!0)}return!1}getResolver(t,o=!0){if(validateKey(t),void 0!==t.resolve)return t;let s,l=this;for(;null!=l;){if(s=l.resolvers.get(t),null!=s)return s;if(null==l.parent){const s=isRegisterInRequester(t)?this:l;return o?this.jitRegister(t,s):null}l=l.parent}return null}has(t,o=!1){return!!this.resolvers.has(t)||!(!o||null==this.parent)&&this.parent.has(t,!0)}get(t){if(validateKey(t),t.$isResolver)return t.resolve(this,this);let o,s=this;for(;null!=s;){if(o=s.resolvers.get(t),null!=o)return o.resolve(s,this);if(null==s.parent){const l=isRegisterInRequester(t)?this:s;return o=this.jitRegister(t,l),o.resolve(s,this)}s=s.parent}throw new Error(`Unable to resolve key: ${t}`)}getAll(t,o=!1){validateKey(t);const s=this;let l,h=s;if(o){let o=JA;for(;null!=h;)l=h.resolvers.get(t),null!=l&&(o=o.concat(buildAllResponse(l,h,s))),h=h.parent;return o}for(;null!=h;){if(l=h.resolvers.get(t),null!=l)return buildAllResponse(l,h,s);if(h=h.parent,null==h)return JA}return JA}getFactory(t){let o=$P.get(t);if(void 0===o){if(LP(t))throw new Error(`${t.name} is a native function and therefore cannot be safely constructed by DI. If this is intentional, please use a callback or cachedCallback resolver.`);$P.set(t,o=new FactoryImpl(t,EP.getDependencies(t)))}return o}registerFactory(t,o){$P.set(t,o)}createChild(t){return new ContainerImpl(null,Object.assign({},this.config,t,{parentLocator:()=>this}))}jitRegister(t,o){if("function"!=typeof t)throw new Error(`Attempted to jitRegister something that is not a constructor: '${t}'. Did you forget to register this dependency?`);if(RP.has(t.name))throw new Error(`Attempted to jitRegister an intrinsic type: ${t.name}. Did you forget to add @inject(Key)`);if(isRegistry(t)){const s=t.register(o);if(!(s instanceof Object)||null==s.resolve){const s=o.resolvers.get(t);if(null!=s)return s;throw new Error("A valid resolver was not returned from the static register method")}return s}if(t.$isInterface)throw new Error(`Attempted to jitRegister an interface: ${t.friendlyName}`);{const s=this.config.defaultResolver(t,o);return o.resolvers.set(t,s),s}}}const NP=new WeakMap;function cacheCallbackResult(t){return function(o,s,l){if(NP.has(l))return NP.get(l);const h=t(o,s,l);return NP.set(l,h),h}}const MP=Object.freeze({instance:(t,o)=>new ResolverImpl(t,0,o),singleton:(t,o)=>new ResolverImpl(t,1,o),transient:(t,o)=>new ResolverImpl(t,2,o),callback:(t,o)=>new ResolverImpl(t,3,o),cachedCallback:(t,o)=>new ResolverImpl(t,3,cacheCallbackResult(o)),aliasTo:(t,o)=>new ResolverImpl(o,5,t)});function validateKey(t){if(null==t)throw new Error("key/value cannot be null or undefined. Are you trying to inject/register something that doesn't exist with DI?")}function buildAllResponse(t,o,s){if(t instanceof ResolverImpl&&4===t.strategy){const l=t.state;let h=l.length;const v=new Array(h);for(;h--;)v[h]=l[h].resolve(o,s);return v}return[t.resolve(o,s)]}const DP="(anonymous)";function isObject(t){return"object"==typeof t&&null!==t||"function"==typeof t}const LP=function(){const t=new WeakMap;let o=!1,s="",l=0;return function(h){return o=t.get(h),void 0===o&&(s=h.toString(),l=s.length,o=l>=29&&l<=100&&125===s.charCodeAt(l-1)&&s.charCodeAt(l-2)<=32&&93===s.charCodeAt(l-3)&&101===s.charCodeAt(l-4)&&100===s.charCodeAt(l-5)&&111===s.charCodeAt(l-6)&&99===s.charCodeAt(l-7)&&32===s.charCodeAt(l-8)&&101===s.charCodeAt(l-9)&&118===s.charCodeAt(l-10)&&105===s.charCodeAt(l-11)&&116===s.charCodeAt(l-12)&&97===s.charCodeAt(l-13)&&110===s.charCodeAt(l-14)&&88===s.charCodeAt(l-15),t.set(h,o)),o}}(),FP={};function isArrayIndex(t){switch(typeof t){case"number":return t>=0&&(0|t)===t;case"string":{const o=FP[t];if(void 0!==o)return o;const s=t.length;if(0===s)return FP[t]=!1;let l=0;for(let o=0;o<s;++o)if(l=t.charCodeAt(o),0===o&&48===l&&s>1||l<48||l>57)return FP[t]=!1;return FP[t]=!0}default:return!1}}function presentationKeyFromTag(t){return`${t.toLowerCase()}:presentation`}const UP=new Map,HP=Object.freeze({define(t,o,s){const l=presentationKeyFromTag(t);void 0===UP.get(l)?UP.set(l,o):UP.set(l,!1),s.register(MP.instance(l,o))},forTag(t,o){const s=presentationKeyFromTag(t),l=UP.get(s);if(!1===l){return EP.findResponsibleContainer(o).get(s)}return l||null}});class DefaultComponentPresentation{constructor(t,o){this.template=t||null,this.styles=void 0===o?null:Array.isArray(o)?ElementStyles.create(o):o instanceof ElementStyles?o:ElementStyles.create([o])}applyTo(t){const o=t.$fastController;null===o.template&&(o.template=this.template),null===o.styles&&(o.styles=this.styles)}}class FoundationElement extends _P{constructor(){super(...arguments),this._presentation=void 0}get $presentation(){return void 0===this._presentation&&(this._presentation=HP.forTag(this.tagName,this)),this._presentation}templateChanged(){void 0!==this.template&&(this.$fastController.template=this.template)}stylesChanged(){void 0!==this.styles&&(this.$fastController.styles=this.styles)}connectedCallback(){null!==this.$presentation&&this.$presentation.applyTo(this),super.connectedCallback()}static compose(t){return(o={})=>new FoundationElementRegistry(this===FoundationElement?class extends FoundationElement{}:this,t,o)}}function resolveOption(t,o,s){return"function"==typeof t?t(o,s):t}__decorate$s([observable],FoundationElement.prototype,"template",void 0),__decorate$s([observable],FoundationElement.prototype,"styles",void 0);class FoundationElementRegistry{constructor(t,o,s){this.type=t,this.elementDefinition=o,this.overrideDefinition=s,this.definition=Object.assign(Object.assign({},this.elementDefinition),this.overrideDefinition)}register(t,o){const s=this.definition,l=this.overrideDefinition,h=`${s.prefix||o.elementPrefix}-${s.baseName}`;o.tryDefineElement({name:h,type:this.type,baseClass:this.elementDefinition.baseClass,callback:t=>{const o=new DefaultComponentPresentation(resolveOption(s.template,t,s),resolveOption(s.styles,t,s));t.definePresentation(o);let h=resolveOption(s.shadowOptions,t,s);t.shadowRootMode&&(h?l.shadowOptions||(h.mode=t.shadowRootMode):null!==h&&(h={mode:t.shadowRootMode})),t.defineElement({elementOptions:resolveOption(s.elementOptions,t,s),shadowOptions:h,attributes:resolveOption(s.attributes,t,s)})}})}}function applyMixins(t,...o){const s=pP.locate(t);o.forEach((o=>{Object.getOwnPropertyNames(o.prototype).forEach((s=>{"constructor"!==s&&Object.defineProperty(t.prototype,s,Object.getOwnPropertyDescriptor(o.prototype,s))}));pP.locate(o).forEach((t=>s.push(t)))}))}function isHTMLElement(...t){return t.every((t=>t instanceof HTMLElement))}let BP;const qP="resize",jP="scroll";var zP;!function(t){t[t.alt=18]="alt",t[t.arrowDown=40]="arrowDown",t[t.arrowLeft=37]="arrowLeft",t[t.arrowRight=39]="arrowRight",t[t.arrowUp=38]="arrowUp",t[t.back=8]="back",t[t.backSlash=220]="backSlash",t[t.break=19]="break",t[t.capsLock=20]="capsLock",t[t.closeBracket=221]="closeBracket",t[t.colon=186]="colon",t[t.colon2=59]="colon2",t[t.comma=188]="comma",t[t.ctrl=17]="ctrl",t[t.delete=46]="delete",t[t.end=35]="end",t[t.enter=13]="enter",t[t.equals=187]="equals",t[t.equals2=61]="equals2",t[t.equals3=107]="equals3",t[t.escape=27]="escape",t[t.forwardSlash=191]="forwardSlash",t[t.function1=112]="function1",t[t.function10=121]="function10",t[t.function11=122]="function11",t[t.function12=123]="function12",t[t.function2=113]="function2",t[t.function3=114]="function3",t[t.function4=115]="function4",t[t.function5=116]="function5",t[t.function6=117]="function6",t[t.function7=118]="function7",t[t.function8=119]="function8",t[t.function9=120]="function9",t[t.home=36]="home",t[t.insert=45]="insert",t[t.menu=93]="menu",t[t.minus=189]="minus",t[t.minus2=109]="minus2",t[t.numLock=144]="numLock",t[t.numPad0=96]="numPad0",t[t.numPad1=97]="numPad1",t[t.numPad2=98]="numPad2",t[t.numPad3=99]="numPad3",t[t.numPad4=100]="numPad4",t[t.numPad5=101]="numPad5",t[t.numPad6=102]="numPad6",t[t.numPad7=103]="numPad7",t[t.numPad8=104]="numPad8",t[t.numPad9=105]="numPad9",t[t.numPadDivide=111]="numPadDivide",t[t.numPadDot=110]="numPadDot",t[t.numPadMinus=109]="numPadMinus",t[t.numPadMultiply=106]="numPadMultiply",t[t.numPadPlus=107]="numPadPlus",t[t.openBracket=219]="openBracket",t[t.pageDown=34]="pageDown",t[t.pageUp=33]="pageUp",t[t.period=190]="period",t[t.print=44]="print",t[t.quote=222]="quote",t[t.scrollLock=145]="scrollLock",t[t.shift=16]="shift",t[t.space=32]="space",t[t.tab=9]="tab",t[t.tilde=192]="tilde",t[t.windowsLeft=91]="windowsLeft",t[t.windowsOpera=219]="windowsOpera",t[t.windowsRight=92]="windowsRight"}(zP||(zP={}));const VP="ArrowDown",GP="ArrowLeft",KP="ArrowRight",WP="ArrowUp",QP="Enter",YP="Escape",JP="Home",XP="End",ZP=" ";var eR;function inRange(t,o,s=0){return[o,s]=[o,s].sort(((t,o)=>t-o)),o<=t&&t<s}!function(t){t.ltr="ltr",t.rtl="rtl"}(eR||(eR={}));let tR=0;function uniqueId(t=""){return`${t}${tR++}`}var rR;!function(t){t.Canvas="Canvas",t.CanvasText="CanvasText",t.LinkText="LinkText",t.VisitedText="VisitedText",t.ActiveText="ActiveText",t.ButtonFace="ButtonFace",t.ButtonText="ButtonText",t.Field="Field",t.FieldText="FieldText",t.Highlight="Highlight",t.HighlightText="HighlightText",t.GrayText="GrayText"}(rR||(rR={}));class ARIAGlobalStatesAndProperties{}__decorate$s([attr({attribute:"aria-atomic"})],ARIAGlobalStatesAndProperties.prototype,"ariaAtomic",void 0),__decorate$s([attr({attribute:"aria-busy"})],ARIAGlobalStatesAndProperties.prototype,"ariaBusy",void 0),__decorate$s([attr({attribute:"aria-controls"})],ARIAGlobalStatesAndProperties.prototype,"ariaControls",void 0),__decorate$s([attr({attribute:"aria-current"})],ARIAGlobalStatesAndProperties.prototype,"ariaCurrent",void 0),__decorate$s([attr({attribute:"aria-describedby"})],ARIAGlobalStatesAndProperties.prototype,"ariaDescribedby",void 0),__decorate$s([attr({attribute:"aria-details"})],ARIAGlobalStatesAndProperties.prototype,"ariaDetails",void 0),__decorate$s([attr({attribute:"aria-disabled"})],ARIAGlobalStatesAndProperties.prototype,"ariaDisabled",void 0),__decorate$s([attr({attribute:"aria-errormessage"})],ARIAGlobalStatesAndProperties.prototype,"ariaErrormessage",void 0),__decorate$s([attr({attribute:"aria-flowto"})],ARIAGlobalStatesAndProperties.prototype,"ariaFlowto",void 0),__decorate$s([attr({attribute:"aria-haspopup"})],ARIAGlobalStatesAndProperties.prototype,"ariaHaspopup",void 0),__decorate$s([attr({attribute:"aria-hidden"})],ARIAGlobalStatesAndProperties.prototype,"ariaHidden",void 0),__decorate$s([attr({attribute:"aria-invalid"})],ARIAGlobalStatesAndProperties.prototype,"ariaInvalid",void 0),__decorate$s([attr({attribute:"aria-keyshortcuts"})],ARIAGlobalStatesAndProperties.prototype,"ariaKeyshortcuts",void 0),__decorate$s([attr({attribute:"aria-label"})],ARIAGlobalStatesAndProperties.prototype,"ariaLabel",void 0),__decorate$s([attr({attribute:"aria-labelledby"})],ARIAGlobalStatesAndProperties.prototype,"ariaLabelledby",void 0),__decorate$s([attr({attribute:"aria-live"})],ARIAGlobalStatesAndProperties.prototype,"ariaLive",void 0),__decorate$s([attr({attribute:"aria-owns"})],ARIAGlobalStatesAndProperties.prototype,"ariaOwns",void 0),__decorate$s([attr({attribute:"aria-relevant"})],ARIAGlobalStatesAndProperties.prototype,"ariaRelevant",void 0),__decorate$s([attr({attribute:"aria-roledescription"})],ARIAGlobalStatesAndProperties.prototype,"ariaRoledescription",void 0);class Anchor extends FoundationElement{constructor(){super(...arguments),this.handleUnsupportedDelegatesFocus=()=>{var t;window.ShadowRoot&&!window.ShadowRoot.prototype.hasOwnProperty("delegatesFocus")&&(null===(t=this.$fastController.definition.shadowOptions)||void 0===t?void 0:t.delegatesFocus)&&(this.focus=()=>{this.control.focus()})}}connectedCallback(){super.connectedCallback(),this.handleUnsupportedDelegatesFocus()}}__decorate$s([attr],Anchor.prototype,"download",void 0),__decorate$s([attr],Anchor.prototype,"href",void 0),__decorate$s([attr],Anchor.prototype,"hreflang",void 0),__decorate$s([attr],Anchor.prototype,"ping",void 0),__decorate$s([attr],Anchor.prototype,"referrerpolicy",void 0),__decorate$s([attr],Anchor.prototype,"rel",void 0),__decorate$s([attr],Anchor.prototype,"target",void 0),__decorate$s([attr],Anchor.prototype,"type",void 0),__decorate$s([observable],Anchor.prototype,"defaultSlottedContent",void 0);class DelegatesARIALink{}__decorate$s([attr({attribute:"aria-expanded"})],DelegatesARIALink.prototype,"ariaExpanded",void 0),applyMixins(DelegatesARIALink,ARIAGlobalStatesAndProperties),applyMixins(Anchor,StartEnd,DelegatesARIALink);const getDirection=t=>{const o=t.closest("[dir]");return null!==o&&"rtl"===o.dir?eR.rtl:eR.ltr};class AnchoredRegion extends FoundationElement{constructor(){super(...arguments),this.anchor="",this.viewport="",this.horizontalPositioningMode="uncontrolled",this.horizontalDefaultPosition="unset",this.horizontalViewportLock=!1,this.horizontalInset=!1,this.horizontalScaling="content",this.verticalPositioningMode="uncontrolled",this.verticalDefaultPosition="unset",this.verticalViewportLock=!1,this.verticalInset=!1,this.verticalScaling="content",this.fixedPlacement=!1,this.autoUpdateMode="anchor",this.anchorElement=null,this.viewportElement=null,this.initialLayoutComplete=!1,this.resizeDetector=null,this.baseHorizontalOffset=0,this.baseVerticalOffset=0,this.pendingPositioningUpdate=!1,this.pendingReset=!1,this.currentDirection=eR.ltr,this.regionVisible=!1,this.forceUpdate=!1,this.updateThreshold=.5,this.update=()=>{this.pendingPositioningUpdate||this.requestPositionUpdates()},this.startObservers=()=>{this.stopObservers(),null!==this.anchorElement&&(this.requestPositionUpdates(),null!==this.resizeDetector&&(this.resizeDetector.observe(this.anchorElement),this.resizeDetector.observe(this)))},this.requestPositionUpdates=()=>{null===this.anchorElement||this.pendingPositioningUpdate||(AnchoredRegion.intersectionService.requestPosition(this,this.handleIntersection),AnchoredRegion.intersectionService.requestPosition(this.anchorElement,this.handleIntersection),null!==this.viewportElement&&AnchoredRegion.intersectionService.requestPosition(this.viewportElement,this.handleIntersection),this.pendingPositioningUpdate=!0)},this.stopObservers=()=>{this.pendingPositioningUpdate&&(this.pendingPositioningUpdate=!1,AnchoredRegion.intersectionService.cancelRequestPosition(this,this.handleIntersection),null!==this.anchorElement&&AnchoredRegion.intersectionService.cancelRequestPosition(this.anchorElement,this.handleIntersection),null!==this.viewportElement&&AnchoredRegion.intersectionService.cancelRequestPosition(this.viewportElement,this.handleIntersection)),null!==this.resizeDetector&&this.resizeDetector.disconnect()},this.getViewport=()=>"string"!=typeof this.viewport||""===this.viewport?document.documentElement:document.getElementById(this.viewport),this.getAnchor=()=>document.getElementById(this.anchor),this.handleIntersection=t=>{this.pendingPositioningUpdate&&(this.pendingPositioningUpdate=!1,this.applyIntersectionEntries(t)&&this.updateLayout())},this.applyIntersectionEntries=t=>{const o=t.find((t=>t.target===this)),s=t.find((t=>t.target===this.anchorElement)),l=t.find((t=>t.target===this.viewportElement));return void 0!==o&&void 0!==l&&void 0!==s&&(!!(!this.regionVisible||this.forceUpdate||void 0===this.regionRect||void 0===this.anchorRect||void 0===this.viewportRect||this.isRectDifferent(this.anchorRect,s.boundingClientRect)||this.isRectDifferent(this.viewportRect,l.boundingClientRect)||this.isRectDifferent(this.regionRect,o.boundingClientRect))&&(this.regionRect=o.boundingClientRect,this.anchorRect=s.boundingClientRect,this.viewportElement===document.documentElement?this.viewportRect=new DOMRectReadOnly(l.boundingClientRect.x+document.documentElement.scrollLeft,l.boundingClientRect.y+document.documentElement.scrollTop,l.boundingClientRect.width,l.boundingClientRect.height):this.viewportRect=l.boundingClientRect,this.updateRegionOffset(),this.forceUpdate=!1,!0))},this.updateRegionOffset=()=>{this.anchorRect&&this.regionRect&&(this.baseHorizontalOffset=this.baseHorizontalOffset+(this.anchorRect.left-this.regionRect.left)+(this.translateX-this.baseHorizontalOffset),this.baseVerticalOffset=this.baseVerticalOffset+(this.anchorRect.top-this.regionRect.top)+(this.translateY-this.baseVerticalOffset))},this.isRectDifferent=(t,o)=>Math.abs(t.top-o.top)>this.updateThreshold||Math.abs(t.right-o.right)>this.updateThreshold||Math.abs(t.bottom-o.bottom)>this.updateThreshold||Math.abs(t.left-o.left)>this.updateThreshold,this.handleResize=t=>{this.update()},this.reset=()=>{this.pendingReset&&(this.pendingReset=!1,null===this.anchorElement&&(this.anchorElement=this.getAnchor()),null===this.viewportElement&&(this.viewportElement=this.getViewport()),this.currentDirection=getDirection(this),this.startObservers())},this.updateLayout=()=>{let t,o;if("uncontrolled"!==this.horizontalPositioningMode){const t=this.getPositioningOptions(this.horizontalInset);if("center"===this.horizontalDefaultPosition)o="center";else if("unset"!==this.horizontalDefaultPosition){let t=this.horizontalDefaultPosition;if("start"===t||"end"===t){const o=getDirection(this);if(o!==this.currentDirection)return this.currentDirection=o,void this.initialize();t=this.currentDirection===eR.ltr?"start"===t?"left":"right":"start"===t?"right":"left"}switch(t){case"left":o=this.horizontalInset?"insetStart":"start";break;case"right":o=this.horizontalInset?"insetEnd":"end"}}const s=void 0!==this.horizontalThreshold?this.horizontalThreshold:void 0!==this.regionRect?this.regionRect.width:0,l=void 0!==this.anchorRect?this.anchorRect.left:0,h=void 0!==this.anchorRect?this.anchorRect.right:0,v=void 0!==this.anchorRect?this.anchorRect.width:0,m=void 0!==this.viewportRect?this.viewportRect.left:0,_=void 0!==this.viewportRect?this.viewportRect.right:0;(void 0===o||"locktodefault"!==this.horizontalPositioningMode&&this.getAvailableSpace(o,l,h,v,m,_)<s)&&(o=this.getAvailableSpace(t[0],l,h,v,m,_)>this.getAvailableSpace(t[1],l,h,v,m,_)?t[0]:t[1])}if("uncontrolled"!==this.verticalPositioningMode){const o=this.getPositioningOptions(this.verticalInset);if("center"===this.verticalDefaultPosition)t="center";else if("unset"!==this.verticalDefaultPosition)switch(this.verticalDefaultPosition){case"top":t=this.verticalInset?"insetStart":"start";break;case"bottom":t=this.verticalInset?"insetEnd":"end"}const s=void 0!==this.verticalThreshold?this.verticalThreshold:void 0!==this.regionRect?this.regionRect.height:0,l=void 0!==this.anchorRect?this.anchorRect.top:0,h=void 0!==this.anchorRect?this.anchorRect.bottom:0,v=void 0!==this.anchorRect?this.anchorRect.height:0,m=void 0!==this.viewportRect?this.viewportRect.top:0,_=void 0!==this.viewportRect?this.viewportRect.bottom:0;(void 0===t||"locktodefault"!==this.verticalPositioningMode&&this.getAvailableSpace(t,l,h,v,m,_)<s)&&(t=this.getAvailableSpace(o[0],l,h,v,m,_)>this.getAvailableSpace(o[1],l,h,v,m,_)?o[0]:o[1])}const s=this.getNextRegionDimension(o,t),l=this.horizontalPosition!==o||this.verticalPosition!==t;if(this.setHorizontalPosition(o,s),this.setVerticalPosition(t,s),this.updateRegionStyle(),!this.initialLayoutComplete)return this.initialLayoutComplete=!0,void this.requestPositionUpdates();this.regionVisible||(this.regionVisible=!0,this.style.removeProperty("pointer-events"),this.style.removeProperty("opacity"),this.classList.toggle("loaded",!0),this.$emit("loaded",this,{bubbles:!1})),this.updatePositionClasses(),l&&this.$emit("positionchange",this,{bubbles:!1})},this.updateRegionStyle=()=>{this.style.width=this.regionWidth,this.style.height=this.regionHeight,this.style.transform=`translate(${this.translateX}px, ${this.translateY}px)`},this.updatePositionClasses=()=>{this.classList.toggle("top","start"===this.verticalPosition),this.classList.toggle("bottom","end"===this.verticalPosition),this.classList.toggle("inset-top","insetStart"===this.verticalPosition),this.classList.toggle("inset-bottom","insetEnd"===this.verticalPosition),this.classList.toggle("vertical-center","center"===this.verticalPosition),this.classList.toggle("left","start"===this.horizontalPosition),this.classList.toggle("right","end"===this.horizontalPosition),this.classList.toggle("inset-left","insetStart"===this.horizontalPosition),this.classList.toggle("inset-right","insetEnd"===this.horizontalPosition),this.classList.toggle("horizontal-center","center"===this.horizontalPosition)},this.setHorizontalPosition=(t,o)=>{if(void 0===t||void 0===this.regionRect||void 0===this.anchorRect||void 0===this.viewportRect)return;let s=0;switch(this.horizontalScaling){case"anchor":case"fill":s=this.horizontalViewportLock?this.viewportRect.width:o.width,this.regionWidth=`${s}px`;break;case"content":s=this.regionRect.width,this.regionWidth="unset"}let l=0;switch(t){case"start":this.translateX=this.baseHorizontalOffset-s,this.horizontalViewportLock&&this.anchorRect.left>this.viewportRect.right&&(this.translateX=this.translateX-(this.anchorRect.left-this.viewportRect.right));break;case"insetStart":this.translateX=this.baseHorizontalOffset-s+this.anchorRect.width,this.horizontalViewportLock&&this.anchorRect.right>this.viewportRect.right&&(this.translateX=this.translateX-(this.anchorRect.right-this.viewportRect.right));break;case"insetEnd":this.translateX=this.baseHorizontalOffset,this.horizontalViewportLock&&this.anchorRect.left<this.viewportRect.left&&(this.translateX=this.translateX-(this.anchorRect.left-this.viewportRect.left));break;case"end":this.translateX=this.baseHorizontalOffset+this.anchorRect.width,this.horizontalViewportLock&&this.anchorRect.right<this.viewportRect.left&&(this.translateX=this.translateX-(this.anchorRect.right-this.viewportRect.left));break;case"center":if(l=(this.anchorRect.width-s)/2,this.translateX=this.baseHorizontalOffset+l,this.horizontalViewportLock){const t=this.anchorRect.left+l,o=this.anchorRect.right-l;t<this.viewportRect.left&&!(o>this.viewportRect.right)?this.translateX=this.translateX-(t-this.viewportRect.left):o>this.viewportRect.right&&!(t<this.viewportRect.left)&&(this.translateX=this.translateX-(o-this.viewportRect.right))}}this.horizontalPosition=t},this.setVerticalPosition=(t,o)=>{if(void 0===t||void 0===this.regionRect||void 0===this.anchorRect||void 0===this.viewportRect)return;let s=0;switch(this.verticalScaling){case"anchor":case"fill":s=this.verticalViewportLock?this.viewportRect.height:o.height,this.regionHeight=`${s}px`;break;case"content":s=this.regionRect.height,this.regionHeight="unset"}let l=0;switch(t){case"start":this.translateY=this.baseVerticalOffset-s,this.verticalViewportLock&&this.anchorRect.top>this.viewportRect.bottom&&(this.translateY=this.translateY-(this.anchorRect.top-this.viewportRect.bottom));break;case"insetStart":this.translateY=this.baseVerticalOffset-s+this.anchorRect.height,this.verticalViewportLock&&this.anchorRect.bottom>this.viewportRect.bottom&&(this.translateY=this.translateY-(this.anchorRect.bottom-this.viewportRect.bottom));break;case"insetEnd":this.translateY=this.baseVerticalOffset,this.verticalViewportLock&&this.anchorRect.top<this.viewportRect.top&&(this.translateY=this.translateY-(this.anchorRect.top-this.viewportRect.top));break;case"end":this.translateY=this.baseVerticalOffset+this.anchorRect.height,this.verticalViewportLock&&this.anchorRect.bottom<this.viewportRect.top&&(this.translateY=this.translateY-(this.anchorRect.bottom-this.viewportRect.top));break;case"center":if(l=(this.anchorRect.height-s)/2,this.translateY=this.baseVerticalOffset+l,this.verticalViewportLock){const t=this.anchorRect.top+l,o=this.anchorRect.bottom-l;t<this.viewportRect.top&&!(o>this.viewportRect.bottom)?this.translateY=this.translateY-(t-this.viewportRect.top):o>this.viewportRect.bottom&&!(t<this.viewportRect.top)&&(this.translateY=this.translateY-(o-this.viewportRect.bottom))}}this.verticalPosition=t},this.getPositioningOptions=t=>t?["insetStart","insetEnd"]:["start","end"],this.getAvailableSpace=(t,o,s,l,h,v)=>{const m=o-h,_=v-(o+l);switch(t){case"start":return m;case"insetStart":return m+l;case"insetEnd":return _+l;case"end":return _;case"center":return 2*Math.min(m,_)+l}},this.getNextRegionDimension=(t,o)=>{const s={height:void 0!==this.regionRect?this.regionRect.height:0,width:void 0!==this.regionRect?this.regionRect.width:0};return void 0!==t&&"fill"===this.horizontalScaling?s.width=this.getAvailableSpace(t,void 0!==this.anchorRect?this.anchorRect.left:0,void 0!==this.anchorRect?this.anchorRect.right:0,void 0!==this.anchorRect?this.anchorRect.width:0,void 0!==this.viewportRect?this.viewportRect.left:0,void 0!==this.viewportRect?this.viewportRect.right:0):"anchor"===this.horizontalScaling&&(s.width=void 0!==this.anchorRect?this.anchorRect.width:0),void 0!==o&&"fill"===this.verticalScaling?s.height=this.getAvailableSpace(o,void 0!==this.anchorRect?this.anchorRect.top:0,void 0!==this.anchorRect?this.anchorRect.bottom:0,void 0!==this.anchorRect?this.anchorRect.height:0,void 0!==this.viewportRect?this.viewportRect.top:0,void 0!==this.viewportRect?this.viewportRect.bottom:0):"anchor"===this.verticalScaling&&(s.height=void 0!==this.anchorRect?this.anchorRect.height:0),s},this.startAutoUpdateEventListeners=()=>{window.addEventListener(qP,this.update,{passive:!0}),window.addEventListener(jP,this.update,{passive:!0,capture:!0}),null!==this.resizeDetector&&null!==this.viewportElement&&this.resizeDetector.observe(this.viewportElement)},this.stopAutoUpdateEventListeners=()=>{window.removeEventListener(qP,this.update),window.removeEventListener(jP,this.update),null!==this.resizeDetector&&null!==this.viewportElement&&this.resizeDetector.unobserve(this.viewportElement)}}anchorChanged(){this.initialLayoutComplete&&(this.anchorElement=this.getAnchor())}viewportChanged(){this.initialLayoutComplete&&(this.viewportElement=this.getViewport())}horizontalPositioningModeChanged(){this.requestReset()}horizontalDefaultPositionChanged(){this.updateForAttributeChange()}horizontalViewportLockChanged(){this.updateForAttributeChange()}horizontalInsetChanged(){this.updateForAttributeChange()}horizontalThresholdChanged(){this.updateForAttributeChange()}horizontalScalingChanged(){this.updateForAttributeChange()}verticalPositioningModeChanged(){this.requestReset()}verticalDefaultPositionChanged(){this.updateForAttributeChange()}verticalViewportLockChanged(){this.updateForAttributeChange()}verticalInsetChanged(){this.updateForAttributeChange()}verticalThresholdChanged(){this.updateForAttributeChange()}verticalScalingChanged(){this.updateForAttributeChange()}fixedPlacementChanged(){this.$fastController.isConnected&&this.initialLayoutComplete&&this.initialize()}autoUpdateModeChanged(t,o){this.$fastController.isConnected&&this.initialLayoutComplete&&("auto"===t&&this.stopAutoUpdateEventListeners(),"auto"===o&&this.startAutoUpdateEventListeners())}anchorElementChanged(){this.requestReset()}viewportElementChanged(){this.$fastController.isConnected&&this.initialLayoutComplete&&this.initialize()}connectedCallback(){super.connectedCallback(),"auto"===this.autoUpdateMode&&this.startAutoUpdateEventListeners(),this.initialize()}disconnectedCallback(){super.disconnectedCallback(),"auto"===this.autoUpdateMode&&this.stopAutoUpdateEventListeners(),this.stopObservers(),this.disconnectResizeDetector()}adoptedCallback(){this.initialize()}disconnectResizeDetector(){null!==this.resizeDetector&&(this.resizeDetector.disconnect(),this.resizeDetector=null)}initializeResizeDetector(){this.disconnectResizeDetector(),this.resizeDetector=new window.ResizeObserver(this.handleResize)}updateForAttributeChange(){this.$fastController.isConnected&&this.initialLayoutComplete&&(this.forceUpdate=!0,this.update())}initialize(){this.initializeResizeDetector(),null===this.anchorElement&&(this.anchorElement=this.getAnchor()),this.requestReset()}requestReset(){this.$fastController.isConnected&&!1===this.pendingReset&&(this.setInitialState(),nP.queueUpdate((()=>this.reset())),this.pendingReset=!0)}setInitialState(){this.initialLayoutComplete=!1,this.regionVisible=!1,this.translateX=0,this.translateY=0,this.baseHorizontalOffset=0,this.baseVerticalOffset=0,this.viewportRect=void 0,this.regionRect=void 0,this.anchorRect=void 0,this.verticalPosition=void 0,this.horizontalPosition=void 0,this.style.opacity="0",this.style.pointerEvents="none",this.forceUpdate=!1,this.style.position=this.fixedPlacement?"fixed":"absolute",this.updatePositionClasses(),this.updateRegionStyle()}}AnchoredRegion.intersectionService=new class IntersectionService{constructor(){this.intersectionDetector=null,this.observedElements=new Map,this.requestPosition=(t,o)=>{var s;null!==this.intersectionDetector&&(this.observedElements.has(t)?null===(s=this.observedElements.get(t))||void 0===s||s.push(o):(this.observedElements.set(t,[o]),this.intersectionDetector.observe(t)))},this.cancelRequestPosition=(t,o)=>{const s=this.observedElements.get(t);if(void 0!==s){const t=s.indexOf(o);-1!==t&&s.splice(t,1)}},this.initializeIntersectionDetector=()=>{WA.IntersectionObserver&&(this.intersectionDetector=new IntersectionObserver(this.handleIntersection,{root:null,rootMargin:"0px",threshold:[0,1]}))},this.handleIntersection=t=>{if(null===this.intersectionDetector)return;const o=[],s=[];t.forEach((t=>{var l;null===(l=this.intersectionDetector)||void 0===l||l.unobserve(t.target);const h=this.observedElements.get(t.target);void 0!==h&&(h.forEach((l=>{let h=o.indexOf(l);-1===h&&(h=o.length,o.push(l),s.push([])),s[h].push(t)})),this.observedElements.delete(t.target))})),o.forEach(((t,o)=>{t(s[o])}))},this.initializeIntersectionDetector()}},__decorate$s([attr],AnchoredRegion.prototype,"anchor",void 0),__decorate$s([attr],AnchoredRegion.prototype,"viewport",void 0),__decorate$s([attr({attribute:"horizontal-positioning-mode"})],AnchoredRegion.prototype,"horizontalPositioningMode",void 0),__decorate$s([attr({attribute:"horizontal-default-position"})],AnchoredRegion.prototype,"horizontalDefaultPosition",void 0),__decorate$s([attr({attribute:"horizontal-viewport-lock",mode:"boolean"})],AnchoredRegion.prototype,"horizontalViewportLock",void 0),__decorate$s([attr({attribute:"horizontal-inset",mode:"boolean"})],AnchoredRegion.prototype,"horizontalInset",void 0),__decorate$s([attr({attribute:"horizontal-threshold"})],AnchoredRegion.prototype,"horizontalThreshold",void 0),__decorate$s([attr({attribute:"horizontal-scaling"})],AnchoredRegion.prototype,"horizontalScaling",void 0),__decorate$s([attr({attribute:"vertical-positioning-mode"})],AnchoredRegion.prototype,"verticalPositioningMode",void 0),__decorate$s([attr({attribute:"vertical-default-position"})],AnchoredRegion.prototype,"verticalDefaultPosition",void 0),__decorate$s([attr({attribute:"vertical-viewport-lock",mode:"boolean"})],AnchoredRegion.prototype,"verticalViewportLock",void 0),__decorate$s([attr({attribute:"vertical-inset",mode:"boolean"})],AnchoredRegion.prototype,"verticalInset",void 0),__decorate$s([attr({attribute:"vertical-threshold"})],AnchoredRegion.prototype,"verticalThreshold",void 0),__decorate$s([attr({attribute:"vertical-scaling"})],AnchoredRegion.prototype,"verticalScaling",void 0),__decorate$s([attr({attribute:"fixed-placement",mode:"boolean"})],AnchoredRegion.prototype,"fixedPlacement",void 0),__decorate$s([attr({attribute:"auto-update-mode"})],AnchoredRegion.prototype,"autoUpdateMode",void 0),__decorate$s([observable],AnchoredRegion.prototype,"anchorElement",void 0),__decorate$s([observable],AnchoredRegion.prototype,"viewportElement",void 0),__decorate$s([observable],AnchoredRegion.prototype,"initialLayoutComplete",void 0);class BreadcrumbItem extends Anchor{constructor(){super(...arguments),this.separator=!0}}__decorate$s([observable],BreadcrumbItem.prototype,"separator",void 0),applyMixins(BreadcrumbItem,StartEnd,DelegatesARIALink);class Breadcrumb extends FoundationElement{slottedBreadcrumbItemsChanged(){if(this.$fastController.isConnected){if(void 0===this.slottedBreadcrumbItems||0===this.slottedBreadcrumbItems.length)return;const t=this.slottedBreadcrumbItems[this.slottedBreadcrumbItems.length-1];this.slottedBreadcrumbItems.forEach((o=>{const s=o===t;this.setItemSeparator(o,s),this.setAriaCurrent(o,s)}))}}setItemSeparator(t,o){t instanceof BreadcrumbItem&&(t.separator=!o)}findChildWithHref(t){var o,s;return t.childElementCount>0?t.querySelector("a[href]"):(null===(o=t.shadowRoot)||void 0===o?void 0:o.childElementCount)?null===(s=t.shadowRoot)||void 0===s?void 0:s.querySelector("a[href]"):null}setAriaCurrent(t,o){const s=this.findChildWithHref(t);null===s&&t.hasAttribute("href")&&t instanceof BreadcrumbItem?o?t.setAttribute("aria-current","page"):t.removeAttribute("aria-current"):null!==s&&(o?s.setAttribute("aria-current","page"):s.removeAttribute("aria-current"))}}__decorate$s([observable],Breadcrumb.prototype,"slottedBreadcrumbItems",void 0);const oR="form-associated-proxy",nR="ElementInternals",iR=nR in window&&"setFormValue"in window[nR].prototype,sR=new WeakMap;function FormAssociated(t){const o=class extends t{constructor(...t){super(...t),this.dirtyValue=!1,this.disabled=!1,this.proxyEventsToBlock=["change","click"],this.proxyInitialized=!1,this.required=!1,this.initialValue=this.initialValue||"",this.elementInternals||(this.formResetCallback=this.formResetCallback.bind(this))}static get formAssociated(){return iR}get validity(){return this.elementInternals?this.elementInternals.validity:this.proxy.validity}get form(){return this.elementInternals?this.elementInternals.form:this.proxy.form}get validationMessage(){return this.elementInternals?this.elementInternals.validationMessage:this.proxy.validationMessage}get willValidate(){return this.elementInternals?this.elementInternals.willValidate:this.proxy.willValidate}get labels(){if(this.elementInternals)return Object.freeze(Array.from(this.elementInternals.labels));if(this.proxy instanceof HTMLElement&&this.proxy.ownerDocument&&this.id){const t=this.proxy.labels,o=Array.from(this.proxy.getRootNode().querySelectorAll(`[for='${this.id}']`)),s=t?o.concat(Array.from(t)):o;return Object.freeze(s)}return JA}valueChanged(t,o){this.dirtyValue=!0,this.proxy instanceof HTMLElement&&(this.proxy.value=this.value),this.currentValue=this.value,this.setFormValue(this.value),this.validate()}currentValueChanged(){this.value=this.currentValue}initialValueChanged(t,o){this.dirtyValue||(this.value=this.initialValue,this.dirtyValue=!1)}disabledChanged(t,o){this.proxy instanceof HTMLElement&&(this.proxy.disabled=this.disabled),nP.queueUpdate((()=>this.classList.toggle("disabled",this.disabled)))}nameChanged(t,o){this.proxy instanceof HTMLElement&&(this.proxy.name=this.name)}requiredChanged(t,o){this.proxy instanceof HTMLElement&&(this.proxy.required=this.required),nP.queueUpdate((()=>this.classList.toggle("required",this.required))),this.validate()}get elementInternals(){if(!iR)return null;let t=sR.get(this);return t||(t=this.attachInternals(),sR.set(this,t)),t}connectedCallback(){super.connectedCallback(),this.addEventListener("keypress",this._keypressHandler),this.value||(this.value=this.initialValue,this.dirtyValue=!1),this.elementInternals||(this.attachProxy(),this.form&&this.form.addEventListener("reset",this.formResetCallback))}disconnectedCallback(){this.proxyEventsToBlock.forEach((t=>this.proxy.removeEventListener(t,this.stopPropagation))),!this.elementInternals&&this.form&&this.form.removeEventListener("reset",this.formResetCallback)}checkValidity(){return this.elementInternals?this.elementInternals.checkValidity():this.proxy.checkValidity()}reportValidity(){return this.elementInternals?this.elementInternals.reportValidity():this.proxy.reportValidity()}setValidity(t,o,s){this.elementInternals?this.elementInternals.setValidity(t,o,s):"string"==typeof o&&this.proxy.setCustomValidity(o)}formDisabledCallback(t){this.disabled=t}formResetCallback(){this.value=this.initialValue,this.dirtyValue=!1}attachProxy(){var t;this.proxyInitialized||(this.proxyInitialized=!0,this.proxy.style.display="none",this.proxyEventsToBlock.forEach((t=>this.proxy.addEventListener(t,this.stopPropagation))),this.proxy.disabled=this.disabled,this.proxy.required=this.required,"string"==typeof this.name&&(this.proxy.name=this.name),"string"==typeof this.value&&(this.proxy.value=this.value),this.proxy.setAttribute("slot",oR),this.proxySlot=document.createElement("slot"),this.proxySlot.setAttribute("name",oR)),null===(t=this.shadowRoot)||void 0===t||t.appendChild(this.proxySlot),this.appendChild(this.proxy)}detachProxy(){var t;this.removeChild(this.proxy),null===(t=this.shadowRoot)||void 0===t||t.removeChild(this.proxySlot)}validate(t){this.proxy instanceof HTMLElement&&this.setValidity(this.proxy.validity,this.proxy.validationMessage,t)}setFormValue(t,o){this.elementInternals&&this.elementInternals.setFormValue(t,o||t)}_keypressHandler(t){if(t.key===QP)if(this.form instanceof HTMLFormElement){const t=this.form.querySelector("[type=submit]");null==t||t.click()}}stopPropagation(t){t.stopPropagation()}};return attr({mode:"boolean"})(o.prototype,"disabled"),attr({mode:"fromView",attribute:"value"})(o.prototype,"initialValue"),attr({attribute:"current-value"})(o.prototype,"currentValue"),attr(o.prototype,"name"),attr({mode:"boolean"})(o.prototype,"required"),observable(o.prototype,"value"),o}function CheckableFormAssociated(t){class C extends(FormAssociated(t)){}class D extends C{constructor(...t){super(t),this.dirtyChecked=!1,this.checkedAttribute=!1,this.checked=!1,this.dirtyChecked=!1}checkedAttributeChanged(){this.defaultChecked=this.checkedAttribute}defaultCheckedChanged(){this.dirtyChecked||(this.checked=this.defaultChecked,this.dirtyChecked=!1)}checkedChanged(t,o){this.dirtyChecked||(this.dirtyChecked=!0),this.currentChecked=this.checked,this.updateForm(),this.proxy instanceof HTMLInputElement&&(this.proxy.checked=this.checked),void 0!==t&&this.$emit("change"),this.validate()}currentCheckedChanged(t,o){this.checked=this.currentChecked}updateForm(){const t=this.checked?this.value:null;this.setFormValue(t,t)}connectedCallback(){super.connectedCallback(),this.updateForm()}formResetCallback(){super.formResetCallback(),this.checked=!!this.checkedAttribute,this.dirtyChecked=!1}}return attr({attribute:"checked",mode:"boolean"})(D.prototype,"checkedAttribute"),attr({attribute:"current-checked",converter:fP})(D.prototype,"currentChecked"),observable(D.prototype,"defaultChecked"),observable(D.prototype,"checked"),D}class _Button extends FoundationElement{}class FormAssociatedButton extends(FormAssociated(_Button)){constructor(){super(...arguments),this.proxy=document.createElement("input")}}class Button$1 extends FormAssociatedButton{constructor(){super(...arguments),this.handleClick=t=>{var o;this.disabled&&(null===(o=this.defaultSlottedContent)||void 0===o?void 0:o.length)<=1&&t.stopPropagation()},this.handleSubmission=()=>{if(!this.form)return;const t=this.proxy.isConnected;t||this.attachProxy(),"function"==typeof this.form.requestSubmit?this.form.requestSubmit(this.proxy):this.proxy.click(),t||this.detachProxy()},this.handleFormReset=()=>{var t;null===(t=this.form)||void 0===t||t.reset()},this.handleUnsupportedDelegatesFocus=()=>{var t;window.ShadowRoot&&!window.ShadowRoot.prototype.hasOwnProperty("delegatesFocus")&&(null===(t=this.$fastController.definition.shadowOptions)||void 0===t?void 0:t.delegatesFocus)&&(this.focus=()=>{this.control.focus()})}}formactionChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formAction=this.formaction)}formenctypeChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formEnctype=this.formenctype)}formmethodChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formMethod=this.formmethod)}formnovalidateChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formNoValidate=this.formnovalidate)}formtargetChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formTarget=this.formtarget)}typeChanged(t,o){this.proxy instanceof HTMLInputElement&&(this.proxy.type=this.type),"submit"===o&&this.addEventListener("click",this.handleSubmission),"submit"===t&&this.removeEventListener("click",this.handleSubmission),"reset"===o&&this.addEventListener("click",this.handleFormReset),"reset"===t&&this.removeEventListener("click",this.handleFormReset)}validate(){super.validate(this.control)}connectedCallback(){var t;super.connectedCallback(),this.proxy.setAttribute("type",this.type),this.handleUnsupportedDelegatesFocus();const o=Array.from(null===(t=this.control)||void 0===t?void 0:t.children);o&&o.forEach((t=>{t.addEventListener("click",this.handleClick)}))}disconnectedCallback(){var t;super.disconnectedCallback();const o=Array.from(null===(t=this.control)||void 0===t?void 0:t.children);o&&o.forEach((t=>{t.removeEventListener("click",this.handleClick)}))}}__decorate$s([attr({mode:"boolean"})],Button$1.prototype,"autofocus",void 0),__decorate$s([attr({attribute:"form"})],Button$1.prototype,"formId",void 0),__decorate$s([attr],Button$1.prototype,"formaction",void 0),__decorate$s([attr],Button$1.prototype,"formenctype",void 0),__decorate$s([attr],Button$1.prototype,"formmethod",void 0),__decorate$s([attr({mode:"boolean"})],Button$1.prototype,"formnovalidate",void 0),__decorate$s([attr],Button$1.prototype,"formtarget",void 0),__decorate$s([attr],Button$1.prototype,"type",void 0),__decorate$s([observable],Button$1.prototype,"defaultSlottedContent",void 0);class DelegatesARIAButton{}__decorate$s([attr({attribute:"aria-expanded"})],DelegatesARIAButton.prototype,"ariaExpanded",void 0),__decorate$s([attr({attribute:"aria-pressed"})],DelegatesARIAButton.prototype,"ariaPressed",void 0),applyMixins(DelegatesARIAButton,ARIAGlobalStatesAndProperties),applyMixins(Button$1,StartEnd,DelegatesARIAButton);class Card$1 extends FoundationElement{}class _Checkbox extends FoundationElement{}class FormAssociatedCheckbox extends(CheckableFormAssociated(_Checkbox)){constructor(){super(...arguments),this.proxy=document.createElement("input")}}class Checkbox extends FormAssociatedCheckbox{constructor(){super(),this.initialValue="on",this.indeterminate=!1,this.keypressHandler=t=>{if(!this.readOnly&&t.key===ZP)this.indeterminate&&(this.indeterminate=!1),this.checked=!this.checked},this.clickHandler=t=>{this.disabled||this.readOnly||(this.indeterminate&&(this.indeterminate=!1),this.checked=!this.checked)},this.proxy.setAttribute("type","checkbox")}readOnlyChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.readOnly=this.readOnly)}}function isListboxOption(t){return isHTMLElement(t)&&("option"===t.getAttribute("role")||t instanceof HTMLOptionElement)}__decorate$s([attr({attribute:"readonly",mode:"boolean"})],Checkbox.prototype,"readOnly",void 0),__decorate$s([observable],Checkbox.prototype,"defaultSlottedNodes",void 0),__decorate$s([observable],Checkbox.prototype,"indeterminate",void 0);class ListboxOption extends FoundationElement{constructor(t,o,s,l){super(),this.defaultSelected=!1,this.dirtySelected=!1,this.selected=this.defaultSelected,this.dirtyValue=!1,t&&(this.textContent=t),o&&(this.initialValue=o),s&&(this.defaultSelected=s),l&&(this.selected=l),this.proxy=new Option(`${this.textContent}`,this.initialValue,this.defaultSelected,this.selected),this.proxy.disabled=this.disabled}checkedChanged(t,o){this.ariaChecked="boolean"!=typeof o?null:o?"true":"false"}contentChanged(t,o){this.proxy instanceof HTMLOptionElement&&(this.proxy.textContent=this.textContent),this.$emit("contentchange",null,{bubbles:!0})}defaultSelectedChanged(){this.dirtySelected||(this.selected=this.defaultSelected,this.proxy instanceof HTMLOptionElement&&(this.proxy.selected=this.defaultSelected))}disabledChanged(t,o){this.ariaDisabled=this.disabled?"true":"false",this.proxy instanceof HTMLOptionElement&&(this.proxy.disabled=this.disabled)}selectedAttributeChanged(){this.defaultSelected=this.selectedAttribute,this.proxy instanceof HTMLOptionElement&&(this.proxy.defaultSelected=this.defaultSelected)}selectedChanged(){this.ariaSelected=this.selected?"true":"false",this.dirtySelected||(this.dirtySelected=!0),this.proxy instanceof HTMLOptionElement&&(this.proxy.selected=this.selected)}initialValueChanged(t,o){this.dirtyValue||(this.value=this.initialValue,this.dirtyValue=!1)}get label(){var t;return null!==(t=this.value)&&void 0!==t?t:this.text}get text(){var t,o;return null!==(o=null===(t=this.textContent)||void 0===t?void 0:t.replace(/\s+/g," ").trim())&&void 0!==o?o:""}set value(t){const o=`${null!=t?t:""}`;this._value=o,this.dirtyValue=!0,this.proxy instanceof HTMLOptionElement&&(this.proxy.value=o),iP.notify(this,"value")}get value(){var t;return iP.track(this,"value"),null!==(t=this._value)&&void 0!==t?t:this.text}get form(){return this.proxy?this.proxy.form:null}}__decorate$s([observable],ListboxOption.prototype,"checked",void 0),__decorate$s([observable],ListboxOption.prototype,"content",void 0),__decorate$s([observable],ListboxOption.prototype,"defaultSelected",void 0),__decorate$s([attr({mode:"boolean"})],ListboxOption.prototype,"disabled",void 0),__decorate$s([attr({attribute:"selected",mode:"boolean"})],ListboxOption.prototype,"selectedAttribute",void 0),__decorate$s([observable],ListboxOption.prototype,"selected",void 0),__decorate$s([attr({attribute:"value",mode:"fromView"})],ListboxOption.prototype,"initialValue",void 0);class DelegatesARIAListboxOption{}__decorate$s([observable],DelegatesARIAListboxOption.prototype,"ariaChecked",void 0),__decorate$s([observable],DelegatesARIAListboxOption.prototype,"ariaPosInSet",void 0),__decorate$s([observable],DelegatesARIAListboxOption.prototype,"ariaSelected",void 0),__decorate$s([observable],DelegatesARIAListboxOption.prototype,"ariaSetSize",void 0),applyMixins(DelegatesARIAListboxOption,ARIAGlobalStatesAndProperties),applyMixins(ListboxOption,StartEnd,DelegatesARIAListboxOption);class Listbox$1 extends FoundationElement{constructor(){super(...arguments),this._options=[],this.selectedIndex=-1,this.selectedOptions=[],this.shouldSkipFocus=!1,this.typeaheadBuffer="",this.typeaheadExpired=!0,this.typeaheadTimeout=-1}get firstSelectedOption(){var t;return null!==(t=this.selectedOptions[0])&&void 0!==t?t:null}get hasSelectableOptions(){return this.options.length>0&&!this.options.every((t=>t.disabled))}get length(){var t,o;return null!==(o=null===(t=this.options)||void 0===t?void 0:t.length)&&void 0!==o?o:0}get options(){return iP.track(this,"options"),this._options}set options(t){this._options=t,iP.notify(this,"options")}get typeAheadExpired(){return this.typeaheadExpired}set typeAheadExpired(t){this.typeaheadExpired=t}clickHandler(t){const o=t.target.closest("option,[role=option]");if(o&&!o.disabled)return this.selectedIndex=this.options.indexOf(o),!0}focusAndScrollOptionIntoView(t=this.firstSelectedOption){this.contains(document.activeElement)&&null!==t&&(t.focus(),requestAnimationFrame((()=>{t.scrollIntoView({block:"nearest"})})))}focusinHandler(t){this.shouldSkipFocus||t.target!==t.currentTarget||(this.setSelectedOptions(),this.focusAndScrollOptionIntoView()),this.shouldSkipFocus=!1}getTypeaheadMatches(){const t=this.typeaheadBuffer.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&"),o=new RegExp(`^${t}`,"gi");return this.options.filter((t=>t.text.trim().match(o)))}getSelectableIndex(t=this.selectedIndex,o){const s=t>o?-1:t<o?1:0,l=t+s;let h=null;switch(s){case-1:h=this.options.reduceRight(((t,o,s)=>!t&&!o.disabled&&s<l?o:t),h);break;case 1:h=this.options.reduce(((t,o,s)=>!t&&!o.disabled&&s>l?o:t),h)}return this.options.indexOf(h)}handleChange(t,o){if("selected"===o)Listbox$1.slottedOptionFilter(t)&&(this.selectedIndex=this.options.indexOf(t)),this.setSelectedOptions()}handleTypeAhead(t){this.typeaheadTimeout&&window.clearTimeout(this.typeaheadTimeout),this.typeaheadTimeout=window.setTimeout((()=>this.typeaheadExpired=!0),Listbox$1.TYPE_AHEAD_TIMEOUT_MS),t.length>1||(this.typeaheadBuffer=`${this.typeaheadExpired?"":this.typeaheadBuffer}${t}`)}keydownHandler(t){if(this.disabled)return!0;this.shouldSkipFocus=!1;const o=t.key;switch(o){case JP:t.shiftKey||(t.preventDefault(),this.selectFirstOption());break;case VP:t.shiftKey||(t.preventDefault(),this.selectNextOption());break;case WP:t.shiftKey||(t.preventDefault(),this.selectPreviousOption());break;case XP:t.preventDefault(),this.selectLastOption();break;case"Tab":return this.focusAndScrollOptionIntoView(),!0;case QP:case YP:return!0;case ZP:if(this.typeaheadExpired)return!0;default:return 1===o.length&&this.handleTypeAhead(`${o}`),!0}}mousedownHandler(t){return this.shouldSkipFocus=!this.contains(document.activeElement),!0}multipleChanged(t,o){this.ariaMultiSelectable=o?"true":null}selectedIndexChanged(t,o){var s;if(this.hasSelectableOptions){if((null===(s=this.options[this.selectedIndex])||void 0===s?void 0:s.disabled)&&"number"==typeof t){const s=this.getSelectableIndex(t,o),l=s>-1?s:t;return this.selectedIndex=l,void(o===l&&this.selectedIndexChanged(o,l))}this.setSelectedOptions()}else this.selectedIndex=-1}selectedOptionsChanged(t,o){var s;const l=o.filter(Listbox$1.slottedOptionFilter);null===(s=this.options)||void 0===s||s.forEach((t=>{const o=iP.getNotifier(t);o.unsubscribe(this,"selected"),t.selected=l.includes(t),o.subscribe(this,"selected")}))}selectFirstOption(){var t,o;this.disabled||(this.selectedIndex=null!==(o=null===(t=this.options)||void 0===t?void 0:t.findIndex((t=>!t.disabled)))&&void 0!==o?o:-1)}selectLastOption(){this.disabled||(this.selectedIndex=function findLastIndex(t,o){let s=t.length;for(;s--;)if(o(t[s],s,t))return s;return-1}(this.options,(t=>!t.disabled)))}selectNextOption(){!this.disabled&&this.selectedIndex<this.options.length-1&&(this.selectedIndex+=1)}selectPreviousOption(){!this.disabled&&this.selectedIndex>0&&(this.selectedIndex=this.selectedIndex-1)}setDefaultSelectedOption(){var t,o;this.selectedIndex=null!==(o=null===(t=this.options)||void 0===t?void 0:t.findIndex((t=>t.defaultSelected)))&&void 0!==o?o:-1}setSelectedOptions(){var t,o,s;(null===(t=this.options)||void 0===t?void 0:t.length)&&(this.selectedOptions=[this.options[this.selectedIndex]],this.ariaActiveDescendant=null!==(s=null===(o=this.firstSelectedOption)||void 0===o?void 0:o.id)&&void 0!==s?s:"",this.focusAndScrollOptionIntoView())}slottedOptionsChanged(t,o){this.options=o.reduce(((t,o)=>(isListboxOption(o)&&t.push(o),t)),[]);const s=`${this.options.length}`;this.options.forEach(((t,o)=>{t.id||(t.id=uniqueId("option-")),t.ariaPosInSet=`${o+1}`,t.ariaSetSize=s})),this.$fastController.isConnected&&(this.setSelectedOptions(),this.setDefaultSelectedOption())}typeaheadBufferChanged(t,o){if(this.$fastController.isConnected){const t=this.getTypeaheadMatches();if(t.length){const o=this.options.indexOf(t[0]);o>-1&&(this.selectedIndex=o)}this.typeaheadExpired=!1}}}Listbox$1.slottedOptionFilter=t=>isListboxOption(t)&&!t.hidden,Listbox$1.TYPE_AHEAD_TIMEOUT_MS=1e3,__decorate$s([attr({mode:"boolean"})],Listbox$1.prototype,"disabled",void 0),__decorate$s([observable],Listbox$1.prototype,"selectedIndex",void 0),__decorate$s([observable],Listbox$1.prototype,"selectedOptions",void 0),__decorate$s([observable],Listbox$1.prototype,"slottedOptions",void 0),__decorate$s([observable],Listbox$1.prototype,"typeaheadBuffer",void 0);class DelegatesARIAListbox{}__decorate$s([observable],DelegatesARIAListbox.prototype,"ariaActiveDescendant",void 0),__decorate$s([observable],DelegatesARIAListbox.prototype,"ariaDisabled",void 0),__decorate$s([observable],DelegatesARIAListbox.prototype,"ariaExpanded",void 0),__decorate$s([observable],DelegatesARIAListbox.prototype,"ariaMultiSelectable",void 0),applyMixins(DelegatesARIAListbox,ARIAGlobalStatesAndProperties),applyMixins(Listbox$1,DelegatesARIAListbox);const aR="above",lR="below";class _Combobox extends Listbox$1{}class FormAssociatedCombobox extends(FormAssociated(_Combobox)){constructor(){super(...arguments),this.proxy=document.createElement("input")}}const cR="inline",dR="list",uR="both",hR="none";class Combobox$1 extends FormAssociatedCombobox{constructor(){super(...arguments),this._value="",this.filteredOptions=[],this.filter="",this.forcedPosition=!1,this.listboxId=uniqueId("listbox-"),this.maxHeight=0,this.open=!1}formResetCallback(){super.formResetCallback(),this.setDefaultSelectedOption(),this.updateValue()}validate(){super.validate(this.control)}get isAutocompleteInline(){return this.autocomplete===cR||this.isAutocompleteBoth}get isAutocompleteList(){return this.autocomplete===dR||this.isAutocompleteBoth}get isAutocompleteBoth(){return this.autocomplete===uR}openChanged(){if(this.open)return this.ariaControls=this.listboxId,this.ariaExpanded="true",this.setPositioning(),this.focusAndScrollOptionIntoView(),void nP.queueUpdate((()=>this.focus()));this.ariaControls="",this.ariaExpanded="false"}get options(){return iP.track(this,"options"),this.filteredOptions.length?this.filteredOptions:this._options}set options(t){this._options=t,iP.notify(this,"options")}placeholderChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.placeholder=this.placeholder)}positionChanged(t,o){this.positionAttribute=o,this.setPositioning()}get value(){return iP.track(this,"value"),this._value}set value(t){var o,s,l;const h=`${this._value}`;if(this.$fastController.isConnected&&this.options){const h=this.options.findIndex((o=>o.text.toLowerCase()===t.toLowerCase())),v=null===(o=this.options[this.selectedIndex])||void 0===o?void 0:o.text,m=null===(s=this.options[h])||void 0===s?void 0:s.text;this.selectedIndex=v!==m?h:this.selectedIndex,t=(null===(l=this.firstSelectedOption)||void 0===l?void 0:l.text)||t}h!==t&&(this._value=t,super.valueChanged(h,t),iP.notify(this,"value"))}clickHandler(t){if(!this.disabled){if(this.open){const o=t.target.closest("option,[role=option]");if(!o||o.disabled)return;this.selectedOptions=[o],this.control.value=o.text,this.clearSelectionRange(),this.updateValue(!0)}return this.open=!this.open,this.open&&this.control.focus(),!0}}connectedCallback(){super.connectedCallback(),this.forcedPosition=!!this.positionAttribute,this.value&&(this.initialValue=this.value)}disabledChanged(t,o){super.disabledChanged&&super.disabledChanged(t,o),this.ariaDisabled=this.disabled?"true":"false"}filterOptions(){this.autocomplete&&this.autocomplete!==hR||(this.filter="");const t=this.filter.toLowerCase();this.filteredOptions=this._options.filter((t=>t.text.toLowerCase().startsWith(this.filter.toLowerCase()))),this.isAutocompleteList&&(this.filteredOptions.length||t||(this.filteredOptions=this._options),this._options.forEach((t=>{t.hidden=!this.filteredOptions.includes(t)})))}focusAndScrollOptionIntoView(){this.contains(document.activeElement)&&(this.control.focus(),this.firstSelectedOption&&requestAnimationFrame((()=>{var t;null===(t=this.firstSelectedOption)||void 0===t||t.scrollIntoView({block:"nearest"})})))}focusoutHandler(t){if(this.syncValue(),!this.open)return!0;const o=t.relatedTarget;this.isSameNode(o)?this.focus():this.options&&this.options.includes(o)||(this.open=!1)}inputHandler(t){if(this.filter=this.control.value,this.filterOptions(),this.isAutocompleteInline||(this.selectedIndex=this.options.map((t=>t.text)).indexOf(this.control.value)),t.inputType.includes("deleteContent")||!this.filter.length)return!0;this.isAutocompleteList&&!this.open&&(this.open=!0),this.isAutocompleteInline&&(this.filteredOptions.length?(this.selectedOptions=[this.filteredOptions[0]],this.selectedIndex=this.options.indexOf(this.firstSelectedOption),this.setInlineSelection()):this.selectedIndex=-1)}keydownHandler(t){const o=t.key;if(t.ctrlKey||t.shiftKey)return!0;switch(o){case"Enter":this.syncValue(),this.isAutocompleteInline&&(this.filter=this.value),this.open=!1,this.clearSelectionRange();break;case"Escape":if(this.isAutocompleteInline||(this.selectedIndex=-1),this.open){this.open=!1;break}this.value="",this.control.value="",this.filter="",this.filterOptions();break;case"Tab":if(this.setInputToSelection(),!this.open)return!0;t.preventDefault(),this.open=!1;break;case"ArrowUp":case"ArrowDown":if(this.filterOptions(),!this.open){this.open=!0;break}this.filteredOptions.length>0&&super.keydownHandler(t),this.isAutocompleteInline&&this.setInlineSelection();break;default:return!0}}keyupHandler(t){switch(t.key){case"ArrowLeft":case"ArrowRight":case"Backspace":case"Delete":case"Home":case"End":this.filter=this.control.value,this.selectedIndex=-1,this.filterOptions()}}selectedIndexChanged(t,o){if(this.$fastController.isConnected){if(o=function limit(t,o,s){return Math.min(Math.max(s,t),o)}(-1,this.options.length-1,o),o!==this.selectedIndex)return void(this.selectedIndex=o);super.selectedIndexChanged(t,o)}}selectPreviousOption(){!this.disabled&&this.selectedIndex>=0&&(this.selectedIndex=this.selectedIndex-1)}setDefaultSelectedOption(){if(this.$fastController.isConnected&&this.options){const t=this.options.findIndex((t=>null!==t.getAttribute("selected")||t.selected));this.selectedIndex=t,!this.dirtyValue&&this.firstSelectedOption&&(this.value=this.firstSelectedOption.text),this.setSelectedOptions()}}setInputToSelection(){this.firstSelectedOption&&(this.control.value=this.firstSelectedOption.text,this.control.focus())}setInlineSelection(){this.firstSelectedOption&&(this.setInputToSelection(),this.control.setSelectionRange(this.filter.length,this.control.value.length,"backward"))}syncValue(){var t;const o=this.selectedIndex>-1?null===(t=this.firstSelectedOption)||void 0===t?void 0:t.text:this.control.value;this.updateValue(this.value!==o)}setPositioning(){const t=this.getBoundingClientRect(),o=window.innerHeight-t.bottom;this.position=this.forcedPosition?this.positionAttribute:t.top>o?aR:lR,this.positionAttribute=this.forcedPosition?this.positionAttribute:this.position,this.maxHeight=this.position===aR?~~t.top:~~o}selectedOptionsChanged(t,o){this.$fastController.isConnected&&this._options.forEach((t=>{t.selected=o.includes(t)}))}slottedOptionsChanged(t,o){super.slottedOptionsChanged(t,o),this.updateValue()}updateValue(t){var o;this.$fastController.isConnected&&(this.value=(null===(o=this.firstSelectedOption)||void 0===o?void 0:o.text)||this.control.value,this.control.value=this.value),t&&this.$emit("change")}clearSelectionRange(){const t=this.control.value.length;this.control.setSelectionRange(t,t)}}__decorate$s([attr({attribute:"autocomplete",mode:"fromView"})],Combobox$1.prototype,"autocomplete",void 0),__decorate$s([observable],Combobox$1.prototype,"maxHeight",void 0),__decorate$s([attr({attribute:"open",mode:"boolean"})],Combobox$1.prototype,"open",void 0),__decorate$s([attr],Combobox$1.prototype,"placeholder",void 0),__decorate$s([attr({attribute:"position"})],Combobox$1.prototype,"positionAttribute",void 0),__decorate$s([observable],Combobox$1.prototype,"position",void 0);class DelegatesARIACombobox{}__decorate$s([observable],DelegatesARIACombobox.prototype,"ariaAutoComplete",void 0),__decorate$s([observable],DelegatesARIACombobox.prototype,"ariaControls",void 0),applyMixins(DelegatesARIACombobox,DelegatesARIAListbox),applyMixins(Combobox$1,StartEnd,DelegatesARIACombobox);function composedParent(t){const o=t.parentElement;if(o)return o;{const o=t.getRootNode();if(o.host instanceof HTMLElement)return o.host}return null}const pR=document.createElement("div");class QueuedStyleSheetTarget{setProperty(t,o){nP.queueUpdate((()=>this.target.setProperty(t,o)))}removeProperty(t){nP.queueUpdate((()=>this.target.removeProperty(t)))}}class DocumentStyleSheetTarget extends QueuedStyleSheetTarget{constructor(){super();const t=new CSSStyleSheet;this.target=t.cssRules[t.insertRule(":root{}")].style,document.adoptedStyleSheets=[...document.adoptedStyleSheets,t]}}class HeadStyleElementStyleSheetTarget extends QueuedStyleSheetTarget{constructor(){super(),this.style=document.createElement("style"),document.head.appendChild(this.style);const{sheet:t}=this.style;if(t){const o=t.insertRule(":root{}",t.cssRules.length);this.target=t.cssRules[o].style}}}class StyleElementStyleSheetTarget{constructor(t){this.store=new Map,this.target=null;const o=t.$fastController;this.style=document.createElement("style"),o.addStyles(this.style),iP.getNotifier(o).subscribe(this,"isConnected"),this.handleChange(o,"isConnected")}targetChanged(){if(null!==this.target)for(const[t,o]of this.store.entries())this.target.setProperty(t,o)}setProperty(t,o){this.store.set(t,o),nP.queueUpdate((()=>{null!==this.target&&this.target.setProperty(t,o)}))}removeProperty(t){this.store.delete(t),nP.queueUpdate((()=>{null!==this.target&&this.target.removeProperty(t)}))}handleChange(t,o){const{sheet:s}=this.style;if(s){const t=s.insertRule(":host{}",s.cssRules.length);this.target=s.cssRules[t].style}else this.target=null}}__decorate$s([observable],StyleElementStyleSheetTarget.prototype,"target",void 0);class ElementStyleSheetTarget{constructor(t){this.target=t.style}setProperty(t,o){nP.queueUpdate((()=>this.target.setProperty(t,o)))}removeProperty(t){nP.queueUpdate((()=>this.target.removeProperty(t)))}}class RootStyleSheetTarget{setProperty(t,o){RootStyleSheetTarget.properties[t]=o;for(const s of RootStyleSheetTarget.roots.values())vR.getOrCreate(RootStyleSheetTarget.normalizeRoot(s)).setProperty(t,o)}removeProperty(t){delete RootStyleSheetTarget.properties[t];for(const o of RootStyleSheetTarget.roots.values())vR.getOrCreate(RootStyleSheetTarget.normalizeRoot(o)).removeProperty(t)}static registerRoot(t){const{roots:o}=RootStyleSheetTarget;if(!o.has(t)){o.add(t);const s=vR.getOrCreate(this.normalizeRoot(t));for(const t in RootStyleSheetTarget.properties)s.setProperty(t,RootStyleSheetTarget.properties[t])}}static unregisterRoot(t){const{roots:o}=RootStyleSheetTarget;if(o.has(t)){o.delete(t);const s=vR.getOrCreate(RootStyleSheetTarget.normalizeRoot(t));for(const t in RootStyleSheetTarget.properties)s.removeProperty(t)}}static normalizeRoot(t){return t===pR?document:t}}RootStyleSheetTarget.roots=new Set,RootStyleSheetTarget.properties={};const fR=new WeakMap,gR=nP.supportsAdoptedStyleSheets?class ConstructableStyleSheetTarget extends QueuedStyleSheetTarget{constructor(t){super();const o=new CSSStyleSheet;this.target=o.cssRules[o.insertRule(":host{}")].style,t.$fastController.addStyles(ElementStyles.create([o]))}}:StyleElementStyleSheetTarget,vR=Object.freeze({getOrCreate(t){if(fR.has(t))return fR.get(t);let o;return o=t===pR?new RootStyleSheetTarget:t instanceof Document?nP.supportsAdoptedStyleSheets?new DocumentStyleSheetTarget:new HeadStyleElementStyleSheetTarget:function isFastElement(t){return t instanceof _P}(t)?new gR(t):new ElementStyleSheetTarget(t),fR.set(t,o),o}});class DesignTokenImpl extends CSSDirective{constructor(t){super(),this.subscribers=new WeakMap,this._appliedTo=new Set,this.name=t.name,null!==t.cssCustomPropertyName&&(this.cssCustomProperty=`--${t.cssCustomPropertyName}`,this.cssVar=`var(${this.cssCustomProperty})`),this.id=DesignTokenImpl.uniqueId(),DesignTokenImpl.tokensById.set(this.id,this)}get appliedTo(){return[...this._appliedTo]}static from(t){return new DesignTokenImpl({name:"string"==typeof t?t:t.name,cssCustomPropertyName:"string"==typeof t?t:void 0===t.cssCustomPropertyName?t.name:t.cssCustomPropertyName})}static isCSSDesignToken(t){return"string"==typeof t.cssCustomProperty}static isDerivedDesignTokenValue(t){return"function"==typeof t}static getTokenById(t){return DesignTokenImpl.tokensById.get(t)}getOrCreateSubscriberSet(t=this){return this.subscribers.get(t)||this.subscribers.set(t,new Set)&&this.subscribers.get(t)}createCSS(){return this.cssVar||""}getValueFor(t){const o=DesignTokenNode.getOrCreate(t).get(this);if(void 0!==o)return o;throw new Error(`Value could not be retrieved for token named "${this.name}". Ensure the value is set for ${t} or an ancestor of ${t}.`)}setValueFor(t,o){return this._appliedTo.add(t),o instanceof DesignTokenImpl&&(o=this.alias(o)),DesignTokenNode.getOrCreate(t).set(this,o),this}deleteValueFor(t){return this._appliedTo.delete(t),DesignTokenNode.existsFor(t)&&DesignTokenNode.getOrCreate(t).delete(this),this}withDefault(t){return this.setValueFor(pR,t),this}subscribe(t,o){const s=this.getOrCreateSubscriberSet(o);o&&!DesignTokenNode.existsFor(o)&&DesignTokenNode.getOrCreate(o),s.has(t)||s.add(t)}unsubscribe(t,o){const s=this.subscribers.get(o||this);s&&s.has(t)&&s.delete(t)}notify(t){const o=Object.freeze({token:this,target:t});this.subscribers.has(this)&&this.subscribers.get(this).forEach((t=>t.handleChange(o))),this.subscribers.has(t)&&this.subscribers.get(t).forEach((t=>t.handleChange(o)))}alias(t){return o=>t.getValueFor(o)}}DesignTokenImpl.uniqueId=(()=>{let t=0;return()=>(t++,t.toString(16))})(),DesignTokenImpl.tokensById=new Map;class DesignTokenBindingObserver{constructor(t,o,s){this.source=t,this.token=o,this.node=s,this.dependencies=new Set,this.observer=iP.binding(t,this,!1),this.observer.handleChange=this.observer.call,this.handleChange()}disconnect(){this.observer.disconnect()}handleChange(){this.node.store.set(this.token,this.observer.observe(this.node.target,aP))}}class Store{constructor(){this.values=new Map}set(t,o){this.values.get(t)!==o&&(this.values.set(t,o),iP.getNotifier(this).notify(t.id))}get(t){return iP.track(this,t.id),this.values.get(t)}delete(t){this.values.delete(t)}all(){return this.values.entries()}}const mR=new WeakMap,bR=new WeakMap;class DesignTokenNode{constructor(t){this.target=t,this.store=new Store,this.children=[],this.assignedValues=new Map,this.reflecting=new Set,this.bindingObservers=new Map,this.tokenValueChangeHandler={handleChange:(t,o)=>{const s=DesignTokenImpl.getTokenById(o);if(s&&(s.notify(this.target),DesignTokenImpl.isCSSDesignToken(s))){const o=this.parent,l=this.isReflecting(s);if(o){const h=o.get(s),v=t.get(s);h===v||l?h===v&&l&&this.stopReflectToCSS(s):this.reflectToCSS(s)}else l||this.reflectToCSS(s)}}},mR.set(t,this),iP.getNotifier(this.store).subscribe(this.tokenValueChangeHandler),t instanceof _P?t.$fastController.addBehaviors([this]):t.isConnected&&this.bind()}static getOrCreate(t){return mR.get(t)||new DesignTokenNode(t)}static existsFor(t){return mR.has(t)}static findParent(t){if(pR!==t.target){let o=composedParent(t.target);for(;null!==o;){if(mR.has(o))return mR.get(o);o=composedParent(o)}return DesignTokenNode.getOrCreate(pR)}return null}static findClosestAssignedNode(t,o){let s=o;do{if(s.has(t))return s;s=s.parent?s.parent:s.target!==pR?DesignTokenNode.getOrCreate(pR):null}while(null!==s);return null}get parent(){return bR.get(this)||null}has(t){return this.assignedValues.has(t)}get(t){const o=this.store.get(t);if(void 0!==o)return o;const s=this.getRaw(t);return void 0!==s?(this.hydrate(t,s),this.get(t)):void 0}getRaw(t){var o;return this.assignedValues.has(t)?this.assignedValues.get(t):null===(o=DesignTokenNode.findClosestAssignedNode(t,this))||void 0===o?void 0:o.getRaw(t)}set(t,o){DesignTokenImpl.isDerivedDesignTokenValue(this.assignedValues.get(t))&&this.tearDownBindingObserver(t),this.assignedValues.set(t,o),DesignTokenImpl.isDerivedDesignTokenValue(o)?this.setupBindingObserver(t,o):this.store.set(t,o)}delete(t){this.assignedValues.delete(t),this.tearDownBindingObserver(t);const o=this.getRaw(t);o?this.hydrate(t,o):this.store.delete(t)}bind(){const t=DesignTokenNode.findParent(this);t&&t.appendChild(this);for(const t of this.assignedValues.keys())t.notify(this.target)}unbind(){if(this.parent){bR.get(this).removeChild(this)}}appendChild(t){t.parent&&bR.get(t).removeChild(t);const o=this.children.filter((o=>t.contains(o)));bR.set(t,this),this.children.push(t),o.forEach((o=>t.appendChild(o))),iP.getNotifier(this.store).subscribe(t);for(const[o,s]of this.store.all())t.hydrate(o,this.bindingObservers.has(o)?this.getRaw(o):s)}removeChild(t){const o=this.children.indexOf(t);return-1!==o&&this.children.splice(o,1),iP.getNotifier(this.store).unsubscribe(t),t.parent===this&&bR.delete(t)}contains(t){return function composedContains(t,o){let s=o;for(;null!==s;){if(s===t)return!0;s=composedParent(s)}return!1}(this.target,t.target)}reflectToCSS(t){this.isReflecting(t)||(this.reflecting.add(t),DesignTokenNode.cssCustomPropertyReflector.startReflection(t,this.target))}stopReflectToCSS(t){this.isReflecting(t)&&(this.reflecting.delete(t),DesignTokenNode.cssCustomPropertyReflector.stopReflection(t,this.target))}isReflecting(t){return this.reflecting.has(t)}handleChange(t,o){const s=DesignTokenImpl.getTokenById(o);s&&this.hydrate(s,this.getRaw(s))}hydrate(t,o){if(!this.has(t)){const s=this.bindingObservers.get(t);DesignTokenImpl.isDerivedDesignTokenValue(o)?s?s.source!==o&&(this.tearDownBindingObserver(t),this.setupBindingObserver(t,o)):this.setupBindingObserver(t,o):(s&&this.tearDownBindingObserver(t),this.store.set(t,o))}}setupBindingObserver(t,o){const s=new DesignTokenBindingObserver(o,t,this);return this.bindingObservers.set(t,s),s}tearDownBindingObserver(t){return!!this.bindingObservers.has(t)&&(this.bindingObservers.get(t).disconnect(),this.bindingObservers.delete(t),!0)}}DesignTokenNode.cssCustomPropertyReflector=new class CustomPropertyReflector{startReflection(t,o){t.subscribe(this,o),this.handleChange({token:t,target:o})}stopReflection(t,o){t.unsubscribe(this,o),this.remove(t,o)}handleChange(t){const{token:o,target:s}=t;this.add(o,s)}add(t,o){vR.getOrCreate(o).setProperty(t.cssCustomProperty,this.resolveCSSValue(DesignTokenNode.getOrCreate(o).get(t)))}remove(t,o){vR.getOrCreate(o).removeProperty(t.cssCustomProperty)}resolveCSSValue(t){return t&&"function"==typeof t.createCSS?t.createCSS():t}},__decorate$s([observable],DesignTokenNode.prototype,"children",void 0);const yR=Object.freeze({create:function create$2(t){return DesignTokenImpl.from(t)},notifyConnection:t=>!(!t.isConnected||!DesignTokenNode.existsFor(t))&&(DesignTokenNode.getOrCreate(t).bind(),!0),notifyDisconnection:t=>!(t.isConnected||!DesignTokenNode.existsFor(t))&&(DesignTokenNode.getOrCreate(t).unbind(),!0),registerRoot(t=pR){RootStyleSheetTarget.registerRoot(t)},unregisterRoot(t=pR){RootStyleSheetTarget.unregisterRoot(t)}}),wR=Object.freeze({definitionCallbackOnly:null,ignoreDuplicate:Symbol()}),_R=new Map,CR=new Map;let kR=null;const TR=EP.createInterface((t=>t.cachedCallback((t=>(null===kR&&(kR=new DefaultDesignSystem(null,t)),kR))))),SR=Object.freeze({tagFor:t=>CR.get(t),responsibleFor(t){const o=t.$$designSystem$$;if(o)return o;return EP.findResponsibleContainer(t).get(TR)},getOrCreate(t){if(!t)return null===kR&&(kR=EP.getOrCreateDOMContainer().get(TR)),kR;const o=t.$$designSystem$$;if(o)return o;const s=EP.getOrCreateDOMContainer(t);if(s.has(TR,!1))return s.get(TR);{const o=new DefaultDesignSystem(t,s);return s.register(MP.instance(TR,o)),o}}});class DefaultDesignSystem{constructor(t,o){this.owner=t,this.container=o,this.designTokensInitialized=!1,this.prefix="fast",this.shadowRootMode=void 0,this.disambiguate=()=>wR.definitionCallbackOnly,null!==t&&(t.$$designSystem$$=this)}withPrefix(t){return this.prefix=t,this}withShadowRootMode(t){return this.shadowRootMode=t,this}withElementDisambiguation(t){return this.disambiguate=t,this}withDesignTokenRoot(t){return this.designTokenRoot=t,this}register(...t){const o=this.container,s=[],l=this.disambiguate,h=this.shadowRootMode,v={elementPrefix:this.prefix,tryDefineElement(t,v,m){const _=function extractTryDefineElementParams(t,o,s){return"string"==typeof t?{name:t,type:o,callback:s}:t}(t,v,m),{name:R,callback:$,baseClass:B}=_;let{type:q}=_,j=R,z=_R.get(j),K=!0;for(;z;){const t=l(j,q,z);switch(t){case wR.ignoreDuplicate:return;case wR.definitionCallbackOnly:K=!1,z=void 0;break;default:j=t,z=_R.get(j)}}K&&((CR.has(q)||q===FoundationElement)&&(q=class extends q{}),_R.set(j,q),CR.set(q,j),B&&CR.set(B,j)),s.push(new ElementDefinitionEntry(o,j,q,h,$,K))}};this.designTokensInitialized||(this.designTokensInitialized=!0,null!==this.designTokenRoot&&yR.registerRoot(this.designTokenRoot)),o.registerWithContext(v,...t);for(const t of s)t.callback(t),t.willDefine&&null!==t.definition&&t.definition.define();return this}}class ElementDefinitionEntry{constructor(t,o,s,l,h,v){this.container=t,this.name=o,this.type=s,this.shadowRootMode=l,this.callback=h,this.willDefine=v,this.definition=null}definePresentation(t){HP.define(this.name,t,this.container)}defineElement(t){this.definition=new FASTElementDefinition(this.type,Object.assign(Object.assign({},t),{name:this.name}))}tagFor(t){return SR.tagFor(t)}}class ListboxElement extends Listbox$1{constructor(){super(...arguments),this.activeIndex=-1,this.rangeStartIndex=-1}get activeOption(){return this.options[this.activeIndex]}get checkedOptions(){var t;return null===(t=this.options)||void 0===t?void 0:t.filter((t=>t.checked))}get firstSelectedOptionIndex(){return this.options.indexOf(this.firstSelectedOption)}activeIndexChanged(t,o){var s,l;this.ariaActiveDescendant=null!==(l=null===(s=this.options[o])||void 0===s?void 0:s.id)&&void 0!==l?l:"",this.focusAndScrollOptionIntoView()}checkActiveIndex(){if(!this.multiple)return;const t=this.activeOption;t&&(t.checked=!0)}checkFirstOption(t=!1){t?(-1===this.rangeStartIndex&&(this.rangeStartIndex=this.activeIndex+1),this.options.forEach(((t,o)=>{t.checked=inRange(o,this.rangeStartIndex)}))):this.uncheckAllOptions(),this.activeIndex=0,this.checkActiveIndex()}checkLastOption(t=!1){t?(-1===this.rangeStartIndex&&(this.rangeStartIndex=this.activeIndex),this.options.forEach(((t,o)=>{t.checked=inRange(o,this.rangeStartIndex,this.options.length)}))):this.uncheckAllOptions(),this.activeIndex=this.options.length-1,this.checkActiveIndex()}connectedCallback(){super.connectedCallback(),this.addEventListener("focusout",this.focusoutHandler)}disconnectedCallback(){this.removeEventListener("focusout",this.focusoutHandler),super.disconnectedCallback()}checkNextOption(t=!1){t?(-1===this.rangeStartIndex&&(this.rangeStartIndex=this.activeIndex),this.options.forEach(((t,o)=>{t.checked=inRange(o,this.rangeStartIndex,this.activeIndex+1)}))):this.uncheckAllOptions(),this.activeIndex+=this.activeIndex<this.options.length-1?1:0,this.checkActiveIndex()}checkPreviousOption(t=!1){t?(-1===this.rangeStartIndex&&(this.rangeStartIndex=this.activeIndex),1===this.checkedOptions.length&&(this.rangeStartIndex+=1),this.options.forEach(((t,o)=>{t.checked=inRange(o,this.activeIndex,this.rangeStartIndex)}))):this.uncheckAllOptions(),this.activeIndex-=this.activeIndex>0?1:0,this.checkActiveIndex()}clickHandler(t){var o;if(!this.multiple)return super.clickHandler(t);const s=null===(o=t.target)||void 0===o?void 0:o.closest("[role=option]");return s&&!s.disabled?(this.uncheckAllOptions(),this.activeIndex=this.options.indexOf(s),this.checkActiveIndex(),this.toggleSelectedForAllCheckedOptions(),!0):void 0}focusAndScrollOptionIntoView(){super.focusAndScrollOptionIntoView(this.activeOption)}focusinHandler(t){if(!this.multiple)return super.focusinHandler(t);this.shouldSkipFocus||t.target!==t.currentTarget||(this.uncheckAllOptions(),-1===this.activeIndex&&(this.activeIndex=-1!==this.firstSelectedOptionIndex?this.firstSelectedOptionIndex:0),this.checkActiveIndex(),this.setSelectedOptions(),this.focusAndScrollOptionIntoView()),this.shouldSkipFocus=!1}focusoutHandler(t){this.multiple&&this.uncheckAllOptions()}keydownHandler(t){if(!this.multiple)return super.keydownHandler(t);if(this.disabled)return!0;const{key:o,shiftKey:s}=t;switch(this.shouldSkipFocus=!1,o){case JP:return void this.checkFirstOption(s);case VP:return void this.checkNextOption(s);case WP:return void this.checkPreviousOption(s);case XP:return void this.checkLastOption(s);case"Tab":return this.focusAndScrollOptionIntoView(),!0;case YP:return this.uncheckAllOptions(),this.checkActiveIndex(),!0;case ZP:if(t.preventDefault(),this.typeAheadExpired)return void this.toggleSelectedForAllCheckedOptions();default:return 1===o.length&&this.handleTypeAhead(`${o}`),!0}}mousedownHandler(t){if(t.offsetX>=0&&t.offsetX<=this.scrollWidth)return super.mousedownHandler(t)}multipleChanged(t,o){var s;this.ariaMultiSelectable=o?"true":null,null===(s=this.options)||void 0===s||s.forEach((t=>{t.checked=!o&&void 0})),this.setSelectedOptions()}setSelectedOptions(){this.multiple?this.$fastController.isConnected&&this.options&&(this.selectedOptions=this.options.filter((t=>t.selected)),this.focusAndScrollOptionIntoView()):super.setSelectedOptions()}sizeChanged(t,o){var s;const l=Math.max(0,parseInt(null!==(s=null==o?void 0:o.toFixed())&&void 0!==s?s:"",10));l!==o&&nP.queueUpdate((()=>{this.size=l}))}toggleSelectedForAllCheckedOptions(){const t=this.checkedOptions.filter((t=>!t.disabled)),o=!t.every((t=>t.selected));t.forEach((t=>t.selected=o)),this.selectedIndex=this.options.indexOf(t[t.length-1]),this.setSelectedOptions()}typeaheadBufferChanged(t,o){if(this.multiple){if(this.$fastController.isConnected){const t=this.getTypeaheadMatches(),o=this.options.indexOf(t[0]);o>-1&&(this.activeIndex=o,this.uncheckAllOptions(),this.checkActiveIndex()),this.typeAheadExpired=!1}}else super.typeaheadBufferChanged(t,o)}uncheckAllOptions(t=!1){this.options.forEach((t=>t.checked=!this.multiple&&void 0)),t||(this.rangeStartIndex=-1)}}__decorate$s([observable],ListboxElement.prototype,"activeIndex",void 0),__decorate$s([attr({mode:"boolean"})],ListboxElement.prototype,"multiple",void 0),__decorate$s([attr({converter:gP})],ListboxElement.prototype,"size",void 0);class _TextField extends FoundationElement{}class FormAssociatedTextField extends(FormAssociated(_TextField)){constructor(){super(...arguments),this.proxy=document.createElement("input")}}const xR="text";class TextField$1 extends FormAssociatedTextField{constructor(){super(...arguments),this.type=xR}readOnlyChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.readOnly=this.readOnly,this.validate())}autofocusChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.autofocus=this.autofocus,this.validate())}placeholderChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.placeholder=this.placeholder)}typeChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.type=this.type,this.validate())}listChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.setAttribute("list",this.list),this.validate())}maxlengthChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.maxLength=this.maxlength,this.validate())}minlengthChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.minLength=this.minlength,this.validate())}patternChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.pattern=this.pattern,this.validate())}sizeChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.size=this.size)}spellcheckChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.spellcheck=this.spellcheck)}connectedCallback(){super.connectedCallback(),this.proxy.setAttribute("type",this.type),this.validate(),this.autofocus&&nP.queueUpdate((()=>{this.focus()}))}select(){this.control.select(),this.$emit("select")}handleTextInput(){this.value=this.control.value}handleChange(){this.$emit("change")}validate(){super.validate(this.control)}}__decorate$s([attr({attribute:"readonly",mode:"boolean"})],TextField$1.prototype,"readOnly",void 0),__decorate$s([attr({mode:"boolean"})],TextField$1.prototype,"autofocus",void 0),__decorate$s([attr],TextField$1.prototype,"placeholder",void 0),__decorate$s([attr],TextField$1.prototype,"type",void 0),__decorate$s([attr],TextField$1.prototype,"list",void 0),__decorate$s([attr({converter:gP})],TextField$1.prototype,"maxlength",void 0),__decorate$s([attr({converter:gP})],TextField$1.prototype,"minlength",void 0),__decorate$s([attr],TextField$1.prototype,"pattern",void 0),__decorate$s([attr({converter:gP})],TextField$1.prototype,"size",void 0),__decorate$s([attr({mode:"boolean"})],TextField$1.prototype,"spellcheck",void 0),__decorate$s([observable],TextField$1.prototype,"defaultSlottedNodes",void 0);class DelegatesARIATextbox{}applyMixins(DelegatesARIATextbox,ARIAGlobalStatesAndProperties),applyMixins(TextField$1,StartEnd,DelegatesARIATextbox);class BaseProgress extends FoundationElement{constructor(){super(...arguments),this.percentComplete=0}valueChanged(){this.$fastController.isConnected&&this.updatePercentComplete()}minChanged(){this.$fastController.isConnected&&this.updatePercentComplete()}maxChanged(){this.$fastController.isConnected&&this.updatePercentComplete()}connectedCallback(){super.connectedCallback(),this.updatePercentComplete()}updatePercentComplete(){const t="number"==typeof this.min?this.min:0,o="number"==typeof this.max?this.max:100,s="number"==typeof this.value?this.value:0,l=o-t;this.percentComplete=0===l?0:Math.fround((s-t)/l*100)}}__decorate$s([attr({converter:gP})],BaseProgress.prototype,"value",void 0),__decorate$s([attr({converter:gP})],BaseProgress.prototype,"min",void 0),__decorate$s([attr({converter:gP})],BaseProgress.prototype,"max",void 0),__decorate$s([attr({mode:"boolean"})],BaseProgress.prototype,"paused",void 0),__decorate$s([observable],BaseProgress.prototype,"percentComplete",void 0);function whitespaceFilter(t,o,s){return t.nodeType!==Node.TEXT_NODE||"string"==typeof t.nodeValue&&!!t.nodeValue.trim().length}class _Switch extends FoundationElement{}class FormAssociatedSwitch extends(CheckableFormAssociated(_Switch)){constructor(){super(...arguments),this.proxy=document.createElement("input")}}class Switch extends FormAssociatedSwitch{constructor(){super(),this.initialValue="on",this.keypressHandler=t=>{if(!this.readOnly)switch(t.key){case QP:case ZP:this.checked=!this.checked}},this.clickHandler=t=>{this.disabled||this.readOnly||(this.checked=!this.checked)},this.proxy.setAttribute("type","checkbox")}readOnlyChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.readOnly=this.readOnly),this.readOnly?this.classList.add("readonly"):this.classList.remove("readonly")}checkedChanged(t,o){super.checkedChanged(t,o),this.checked?this.classList.add("checked"):this.classList.remove("checked")}}__decorate$s([attr({attribute:"readonly",mode:"boolean"})],Switch.prototype,"readOnly",void 0),__decorate$s([observable],Switch.prototype,"defaultSlottedNodes",void 0);class Tab extends FoundationElement{}__decorate$s([attr({mode:"boolean"})],Tab.prototype,"disabled",void 0);const ER="horizontal";class Tabs extends FoundationElement{constructor(){super(...arguments),this.orientation=ER,this.activeindicator=!0,this.showActiveIndicator=!0,this.prevActiveTabIndex=0,this.activeTabIndex=0,this.ticking=!1,this.change=()=>{this.$emit("change",this.activetab)},this.isDisabledElement=t=>"true"===t.getAttribute("aria-disabled"),this.isFocusableElement=t=>!this.isDisabledElement(t),this.setTabs=()=>{const t="gridColumn",o="gridRow",s=this.isHorizontal()?t:o;this.activeTabIndex=this.getActiveIndex(),this.showActiveIndicator=!1,this.tabs.forEach(((l,h)=>{if("tab"===l.slot){const t=this.activeTabIndex===h&&this.isFocusableElement(l);this.activeindicator&&this.isFocusableElement(l)&&(this.showActiveIndicator=!0);const o=this.tabIds[h],s=this.tabpanelIds[h];l.setAttribute("id",o),l.setAttribute("aria-selected",t?"true":"false"),l.setAttribute("aria-controls",s),l.addEventListener("click",this.handleTabClick),l.addEventListener("keydown",this.handleTabKeyDown),l.setAttribute("tabindex",t?"0":"-1"),t&&(this.activetab=l)}l.style[t]="",l.style[o]="",l.style[s]=`${h+1}`,this.isHorizontal()?l.classList.remove("vertical"):l.classList.add("vertical")}))},this.setTabPanels=()=>{this.tabpanels.forEach(((t,o)=>{const s=this.tabIds[o],l=this.tabpanelIds[o];t.setAttribute("id",l),t.setAttribute("aria-labelledby",s),this.activeTabIndex!==o?t.setAttribute("hidden",""):t.removeAttribute("hidden")}))},this.handleTabClick=t=>{const o=t.currentTarget;1===o.nodeType&&this.isFocusableElement(o)&&(this.prevActiveTabIndex=this.activeTabIndex,this.activeTabIndex=this.tabs.indexOf(o),this.setComponent())},this.handleTabKeyDown=t=>{if(this.isHorizontal())switch(t.key){case GP:t.preventDefault(),this.adjustBackward(t);break;case KP:t.preventDefault(),this.adjustForward(t)}else switch(t.key){case WP:t.preventDefault(),this.adjustBackward(t);break;case VP:t.preventDefault(),this.adjustForward(t)}switch(t.key){case JP:t.preventDefault(),this.adjust(-this.activeTabIndex);break;case XP:t.preventDefault(),this.adjust(this.tabs.length-this.activeTabIndex-1)}},this.adjustForward=t=>{const o=this.tabs;let s=0;for(s=this.activetab?o.indexOf(this.activetab)+1:1,s===o.length&&(s=0);s<o.length&&o.length>1;){if(this.isFocusableElement(o[s])){this.moveToTabByIndex(o,s);break}if(this.activetab&&s===o.indexOf(this.activetab))break;s+1>=o.length?s=0:s+=1}},this.adjustBackward=t=>{const o=this.tabs;let s=0;for(s=this.activetab?o.indexOf(this.activetab)-1:0,s=s<0?o.length-1:s;s>=0&&o.length>1;){if(this.isFocusableElement(o[s])){this.moveToTabByIndex(o,s);break}s-1<0?s=o.length-1:s-=1}},this.moveToTabByIndex=(t,o)=>{const s=t[o];this.activetab=s,this.prevActiveTabIndex=this.activeTabIndex,this.activeTabIndex=o,s.focus(),this.setComponent()}}orientationChanged(){this.$fastController.isConnected&&(this.setTabs(),this.setTabPanels(),this.handleActiveIndicatorPosition())}activeidChanged(t,o){this.$fastController.isConnected&&this.tabs.length<=this.tabpanels.length&&(this.prevActiveTabIndex=this.tabs.findIndex((o=>o.id===t)),this.setTabs(),this.setTabPanels(),this.handleActiveIndicatorPosition())}tabsChanged(){this.$fastController.isConnected&&this.tabs.length<=this.tabpanels.length&&(this.tabIds=this.getTabIds(),this.tabpanelIds=this.getTabPanelIds(),this.setTabs(),this.setTabPanels(),this.handleActiveIndicatorPosition())}tabpanelsChanged(){this.$fastController.isConnected&&this.tabpanels.length<=this.tabs.length&&(this.tabIds=this.getTabIds(),this.tabpanelIds=this.getTabPanelIds(),this.setTabs(),this.setTabPanels(),this.handleActiveIndicatorPosition())}getActiveIndex(){return void 0!==this.activeid?-1===this.tabIds.indexOf(this.activeid)?0:this.tabIds.indexOf(this.activeid):0}getTabIds(){return this.tabs.map((t=>{var o;return null!==(o=t.getAttribute("id"))&&void 0!==o?o:`tab-${uniqueId()}`}))}getTabPanelIds(){return this.tabpanels.map((t=>{var o;return null!==(o=t.getAttribute("id"))&&void 0!==o?o:`panel-${uniqueId()}`}))}setComponent(){this.activeTabIndex!==this.prevActiveTabIndex&&(this.activeid=this.tabIds[this.activeTabIndex],this.focusTab(),this.change())}isHorizontal(){return this.orientation===ER}handleActiveIndicatorPosition(){this.showActiveIndicator&&this.activeindicator&&this.activeTabIndex!==this.prevActiveTabIndex&&(this.ticking?this.ticking=!1:(this.ticking=!0,this.animateActiveIndicator()))}animateActiveIndicator(){this.ticking=!0;const t=this.isHorizontal()?"gridColumn":"gridRow",o=this.isHorizontal()?"translateX":"translateY",s=this.isHorizontal()?"offsetLeft":"offsetTop",l=this.activeIndicatorRef[s];this.activeIndicatorRef.style[t]=`${this.activeTabIndex+1}`;const h=this.activeIndicatorRef[s];this.activeIndicatorRef.style[t]=`${this.prevActiveTabIndex+1}`;const v=h-l;this.activeIndicatorRef.style.transform=`${o}(${v}px)`,this.activeIndicatorRef.classList.add("activeIndicatorTransition"),this.activeIndicatorRef.addEventListener("transitionend",(()=>{this.ticking=!1,this.activeIndicatorRef.style[t]=`${this.activeTabIndex+1}`,this.activeIndicatorRef.style.transform=`${o}(0px)`,this.activeIndicatorRef.classList.remove("activeIndicatorTransition")}))}adjust(t){this.prevActiveTabIndex=this.activeTabIndex,this.activeTabIndex=function wrapInBounds(t,o,s){return s<t?o:s>o?t:s}(0,this.tabs.length-1,this.activeTabIndex+t),this.setComponent()}focusTab(){this.tabs[this.activeTabIndex].focus()}connectedCallback(){super.connectedCallback(),this.tabIds=this.getTabIds(),this.tabpanelIds=this.getTabPanelIds(),this.activeTabIndex=this.getActiveIndex()}}__decorate$s([attr],Tabs.prototype,"orientation",void 0),__decorate$s([attr],Tabs.prototype,"activeid",void 0),__decorate$s([observable],Tabs.prototype,"tabs",void 0),__decorate$s([observable],Tabs.prototype,"tabpanels",void 0),__decorate$s([attr({mode:"boolean"})],Tabs.prototype,"activeindicator",void 0),__decorate$s([observable],Tabs.prototype,"activeIndicatorRef",void 0),__decorate$s([observable],Tabs.prototype,"showActiveIndicator",void 0),applyMixins(Tabs,StartEnd);const IR="top",AR="right",PR="bottom",RR="left",OR="start",$R="end",NR="top-left",MR="top-right",DR="bottom-left",LR="bottom-right",FR="top-start",UR="top-end",HR="bottom-start",BR="bottom-end";class Tooltip$1 extends FoundationElement{constructor(){super(...arguments),this.anchor="",this.delay=300,this.autoUpdateMode="anchor",this.anchorElement=null,this.viewportElement=null,this.verticalPositioningMode="dynamic",this.horizontalPositioningMode="dynamic",this.horizontalInset="false",this.verticalInset="false",this.horizontalScaling="content",this.verticalScaling="content",this.verticalDefaultPosition=void 0,this.horizontalDefaultPosition=void 0,this.tooltipVisible=!1,this.currentDirection=eR.ltr,this.showDelayTimer=null,this.hideDelayTimer=null,this.isAnchorHoveredFocused=!1,this.isRegionHovered=!1,this.handlePositionChange=t=>{this.classList.toggle("top","start"===this.region.verticalPosition),this.classList.toggle("bottom","end"===this.region.verticalPosition),this.classList.toggle("inset-top","insetStart"===this.region.verticalPosition),this.classList.toggle("inset-bottom","insetEnd"===this.region.verticalPosition),this.classList.toggle("center-vertical","center"===this.region.verticalPosition),this.classList.toggle("left","start"===this.region.horizontalPosition),this.classList.toggle("right","end"===this.region.horizontalPosition),this.classList.toggle("inset-left","insetStart"===this.region.horizontalPosition),this.classList.toggle("inset-right","insetEnd"===this.region.horizontalPosition),this.classList.toggle("center-horizontal","center"===this.region.horizontalPosition)},this.handleRegionMouseOver=t=>{this.isRegionHovered=!0},this.handleRegionMouseOut=t=>{this.isRegionHovered=!1,this.startHideDelayTimer()},this.handleAnchorMouseOver=t=>{this.tooltipVisible?this.isAnchorHoveredFocused=!0:this.startShowDelayTimer()},this.handleAnchorMouseOut=t=>{this.isAnchorHoveredFocused=!1,this.clearShowDelayTimer(),this.startHideDelayTimer()},this.handleAnchorFocusIn=t=>{this.startShowDelayTimer()},this.handleAnchorFocusOut=t=>{this.isAnchorHoveredFocused=!1,this.clearShowDelayTimer(),this.startHideDelayTimer()},this.startHideDelayTimer=()=>{this.clearHideDelayTimer(),this.tooltipVisible&&(this.hideDelayTimer=window.setTimeout((()=>{this.updateTooltipVisibility()}),60))},this.clearHideDelayTimer=()=>{null!==this.hideDelayTimer&&(clearTimeout(this.hideDelayTimer),this.hideDelayTimer=null)},this.startShowDelayTimer=()=>{this.isAnchorHoveredFocused||(this.delay>1?null===this.showDelayTimer&&(this.showDelayTimer=window.setTimeout((()=>{this.startHover()}),this.delay)):this.startHover())},this.startHover=()=>{this.isAnchorHoveredFocused=!0,this.updateTooltipVisibility()},this.clearShowDelayTimer=()=>{null!==this.showDelayTimer&&(clearTimeout(this.showDelayTimer),this.showDelayTimer=null)},this.getAnchor=()=>{const t=this.getRootNode();return t instanceof ShadowRoot?t.getElementById(this.anchor):document.getElementById(this.anchor)},this.handleDocumentKeydown=t=>{if(!t.defaultPrevented&&this.tooltipVisible&&t.key===YP)this.isAnchorHoveredFocused=!1,this.updateTooltipVisibility(),this.$emit("dismiss")},this.updateTooltipVisibility=()=>{if(!1===this.visible)this.hideTooltip();else{if(!0===this.visible)return void this.showTooltip();if(this.isAnchorHoveredFocused||this.isRegionHovered)return void this.showTooltip();this.hideTooltip()}},this.showTooltip=()=>{this.tooltipVisible||(this.currentDirection=getDirection(this),this.tooltipVisible=!0,document.addEventListener("keydown",this.handleDocumentKeydown),nP.queueUpdate(this.setRegionProps))},this.hideTooltip=()=>{this.tooltipVisible&&(this.clearHideDelayTimer(),null!==this.region&&void 0!==this.region&&(this.region.removeEventListener("positionchange",this.handlePositionChange),this.region.viewportElement=null,this.region.anchorElement=null,this.region.removeEventListener("mouseover",this.handleRegionMouseOver),this.region.removeEventListener("mouseout",this.handleRegionMouseOut)),document.removeEventListener("keydown",this.handleDocumentKeydown),this.tooltipVisible=!1)},this.setRegionProps=()=>{this.tooltipVisible&&(this.region.viewportElement=this.viewportElement,this.region.anchorElement=this.anchorElement,this.region.addEventListener("positionchange",this.handlePositionChange),this.region.addEventListener("mouseover",this.handleRegionMouseOver,{passive:!0}),this.region.addEventListener("mouseout",this.handleRegionMouseOut,{passive:!0}))}}visibleChanged(){this.$fastController.isConnected&&(this.updateTooltipVisibility(),this.updateLayout())}anchorChanged(){this.$fastController.isConnected&&(this.anchorElement=this.getAnchor())}positionChanged(){this.$fastController.isConnected&&this.updateLayout()}anchorElementChanged(t){if(this.$fastController.isConnected){if(null!=t&&(t.removeEventListener("mouseover",this.handleAnchorMouseOver),t.removeEventListener("mouseout",this.handleAnchorMouseOut),t.removeEventListener("focusin",this.handleAnchorFocusIn),t.removeEventListener("focusout",this.handleAnchorFocusOut)),null!==this.anchorElement&&void 0!==this.anchorElement){this.anchorElement.addEventListener("mouseover",this.handleAnchorMouseOver,{passive:!0}),this.anchorElement.addEventListener("mouseout",this.handleAnchorMouseOut,{passive:!0}),this.anchorElement.addEventListener("focusin",this.handleAnchorFocusIn,{passive:!0}),this.anchorElement.addEventListener("focusout",this.handleAnchorFocusOut,{passive:!0});const t=this.anchorElement.id;null!==this.anchorElement.parentElement&&this.anchorElement.parentElement.querySelectorAll(":hover").forEach((o=>{o.id===t&&this.startShowDelayTimer()}))}null!==this.region&&void 0!==this.region&&this.tooltipVisible&&(this.region.anchorElement=this.anchorElement),this.updateLayout()}}viewportElementChanged(){null!==this.region&&void 0!==this.region&&(this.region.viewportElement=this.viewportElement),this.updateLayout()}connectedCallback(){super.connectedCallback(),this.anchorElement=this.getAnchor(),this.updateTooltipVisibility()}disconnectedCallback(){this.hideTooltip(),this.clearShowDelayTimer(),this.clearHideDelayTimer(),super.disconnectedCallback()}updateLayout(){switch(this.verticalPositioningMode="locktodefault",this.horizontalPositioningMode="locktodefault",this.position){case IR:case PR:this.verticalDefaultPosition=this.position,this.horizontalDefaultPosition="center";break;case AR:case RR:case OR:case $R:this.verticalDefaultPosition="center",this.horizontalDefaultPosition=this.position;break;case NR:this.verticalDefaultPosition="top",this.horizontalDefaultPosition="left";break;case MR:this.verticalDefaultPosition="top",this.horizontalDefaultPosition="right";break;case DR:this.verticalDefaultPosition="bottom",this.horizontalDefaultPosition="left";break;case LR:this.verticalDefaultPosition="bottom",this.horizontalDefaultPosition="right";break;case FR:this.verticalDefaultPosition="top",this.horizontalDefaultPosition="start";break;case UR:this.verticalDefaultPosition="top",this.horizontalDefaultPosition="end";break;case HR:this.verticalDefaultPosition="bottom",this.horizontalDefaultPosition="start";break;case BR:this.verticalDefaultPosition="bottom",this.horizontalDefaultPosition="end";break;default:this.verticalPositioningMode="dynamic",this.horizontalPositioningMode="dynamic",this.verticalDefaultPosition=void 0,this.horizontalDefaultPosition="center"}}}__decorate$s([attr({mode:"boolean"})],Tooltip$1.prototype,"visible",void 0),__decorate$s([attr],Tooltip$1.prototype,"anchor",void 0),__decorate$s([attr],Tooltip$1.prototype,"delay",void 0),__decorate$s([attr],Tooltip$1.prototype,"position",void 0),__decorate$s([attr({attribute:"auto-update-mode"})],Tooltip$1.prototype,"autoUpdateMode",void 0),__decorate$s([attr({attribute:"horizontal-viewport-lock"})],Tooltip$1.prototype,"horizontalViewportLock",void 0),__decorate$s([attr({attribute:"vertical-viewport-lock"})],Tooltip$1.prototype,"verticalViewportLock",void 0),__decorate$s([observable],Tooltip$1.prototype,"anchorElement",void 0),__decorate$s([observable],Tooltip$1.prototype,"viewportElement",void 0),__decorate$s([observable],Tooltip$1.prototype,"verticalPositioningMode",void 0),__decorate$s([observable],Tooltip$1.prototype,"horizontalPositioningMode",void 0),__decorate$s([observable],Tooltip$1.prototype,"horizontalInset",void 0),__decorate$s([observable],Tooltip$1.prototype,"verticalInset",void 0),__decorate$s([observable],Tooltip$1.prototype,"horizontalScaling",void 0),__decorate$s([observable],Tooltip$1.prototype,"verticalScaling",void 0),__decorate$s([observable],Tooltip$1.prototype,"verticalDefaultPosition",void 0),__decorate$s([observable],Tooltip$1.prototype,"horizontalDefaultPosition",void 0),__decorate$s([observable],Tooltip$1.prototype,"tooltipVisible",void 0),__decorate$s([observable],Tooltip$1.prototype,"currentDirection",void 0);function isTreeItemElement(t){return isHTMLElement(t)&&"treeitem"===t.getAttribute("role")}class TreeItem extends FoundationElement{constructor(){super(...arguments),this.expanded=!1,this.focusable=!1,this.isNestedItem=()=>isTreeItemElement(this.parentElement),this.handleExpandCollapseButtonClick=t=>{this.disabled||t.defaultPrevented||(this.expanded=!this.expanded)},this.handleFocus=t=>{this.setAttribute("tabindex","0")},this.handleBlur=t=>{this.setAttribute("tabindex","-1")}}expandedChanged(){this.$fastController.isConnected&&this.$emit("expanded-change",this)}selectedChanged(){this.$fastController.isConnected&&this.$emit("selected-change",this)}itemsChanged(t,o){this.$fastController.isConnected&&this.items.forEach((t=>{isTreeItemElement(t)&&(t.nested=!0)}))}static focusItem(t){t.focusable=!0,t.focus()}childItemLength(){const t=this.childItems.filter((t=>isTreeItemElement(t)));return t?t.length:0}}__decorate$s([attr({mode:"boolean"})],TreeItem.prototype,"expanded",void 0),__decorate$s([attr({mode:"boolean"})],TreeItem.prototype,"selected",void 0),__decorate$s([attr({mode:"boolean"})],TreeItem.prototype,"disabled",void 0),__decorate$s([observable],TreeItem.prototype,"focusable",void 0),__decorate$s([observable],TreeItem.prototype,"childItems",void 0),__decorate$s([observable],TreeItem.prototype,"items",void 0),__decorate$s([observable],TreeItem.prototype,"nested",void 0),__decorate$s([observable],TreeItem.prototype,"renderCollapsedChildren",void 0),applyMixins(TreeItem,StartEnd);class TreeView extends FoundationElement{constructor(){super(...arguments),this.currentFocused=null,this.handleFocus=t=>{if(!(this.slottedTreeItems.length<1))return t.target===this?(null===this.currentFocused&&(this.currentFocused=this.getValidFocusableItem()),void(null!==this.currentFocused&&TreeItem.focusItem(this.currentFocused))):void(this.contains(t.target)&&(this.setAttribute("tabindex","-1"),this.currentFocused=t.target))},this.handleBlur=t=>{t.target instanceof HTMLElement&&(null===t.relatedTarget||!this.contains(t.relatedTarget))&&this.setAttribute("tabindex","0")},this.handleKeyDown=t=>{if(t.defaultPrevented)return;if(this.slottedTreeItems.length<1)return!0;const o=this.getVisibleNodes();switch(t.key){case JP:return void(o.length&&TreeItem.focusItem(o[0]));case XP:return void(o.length&&TreeItem.focusItem(o[o.length-1]));case GP:if(t.target&&this.isFocusableElement(t.target)){const o=t.target;o instanceof TreeItem&&o.childItemLength()>0&&o.expanded?o.expanded=!1:o instanceof TreeItem&&o.parentElement instanceof TreeItem&&TreeItem.focusItem(o.parentElement)}return!1;case KP:if(t.target&&this.isFocusableElement(t.target)){const o=t.target;o instanceof TreeItem&&o.childItemLength()>0&&!o.expanded?o.expanded=!0:o instanceof TreeItem&&o.childItemLength()>0&&this.focusNextNode(1,t.target)}return;case VP:return void(t.target&&this.isFocusableElement(t.target)&&this.focusNextNode(1,t.target));case WP:return void(t.target&&this.isFocusableElement(t.target)&&this.focusNextNode(-1,t.target));case QP:return void this.handleClick(t)}return!0},this.handleSelectedChange=t=>{if(t.defaultPrevented)return;if(!(t.target instanceof Element&&isTreeItemElement(t.target)))return!0;const o=t.target;o.selected?(this.currentSelected&&this.currentSelected!==o&&(this.currentSelected.selected=!1),this.currentSelected=o):o.selected||this.currentSelected!==o||(this.currentSelected=null)},this.setItems=()=>{const t=this.treeView.querySelector("[aria-selected='true']");this.currentSelected=t,null!==this.currentFocused&&this.contains(this.currentFocused)||(this.currentFocused=this.getValidFocusableItem()),this.nested=this.checkForNestedItems();this.getVisibleNodes().forEach((t=>{isTreeItemElement(t)&&(t.nested=this.nested)}))},this.isFocusableElement=t=>isTreeItemElement(t),this.isSelectedElement=t=>t.selected}slottedTreeItemsChanged(){this.$fastController.isConnected&&this.setItems()}connectedCallback(){super.connectedCallback(),this.setAttribute("tabindex","0"),nP.queueUpdate((()=>{this.setItems()}))}handleClick(t){if(t.defaultPrevented)return;if(!(t.target instanceof Element&&isTreeItemElement(t.target)))return!0;const o=t.target;o.disabled||(o.selected=!o.selected)}focusNextNode(t,o){const s=this.getVisibleNodes();if(!s)return;const l=s[s.indexOf(o)+t];isHTMLElement(l)&&TreeItem.focusItem(l)}getValidFocusableItem(){const t=this.getVisibleNodes();let o=t.findIndex(this.isSelectedElement);return-1===o&&(o=t.findIndex(this.isFocusableElement)),-1!==o?t[o]:null}checkForNestedItems(){return this.slottedTreeItems.some((t=>isTreeItemElement(t)&&t.querySelector("[role='treeitem']")))}getVisibleNodes(){return function getDisplayedNodes(t,o){if(!t||!o||!isHTMLElement(t))return;return Array.from(t.querySelectorAll(o)).filter((t=>null!==t.offsetParent))}(this,"[role='treeitem']")||[]}}__decorate$s([attr({attribute:"render-collapsed-nodes"})],TreeView.prototype,"renderCollapsedNodes",void 0),__decorate$s([observable],TreeView.prototype,"currentSelected",void 0),__decorate$s([observable],TreeView.prototype,"slottedTreeItems",void 0);class MatchMediaBehavior{constructor(t){this.listenerCache=new WeakMap,this.query=t}bind(t){const{query:o}=this,s=this.constructListener(t);s.bind(o)(),o.addListener(s),this.listenerCache.set(t,s)}unbind(t){const o=this.listenerCache.get(t);o&&(this.query.removeListener(o),this.listenerCache.delete(t))}}class MatchMediaStyleSheetBehavior extends MatchMediaBehavior{constructor(t,o){super(t),this.styles=o}static with(t){return o=>new MatchMediaStyleSheetBehavior(t,o)}constructListener(t){let o=!1;const s=this.styles;return function listener(){const{matches:l}=this;l&&!o?(t.$fastController.addStyles(s),o=l):!l&&o&&(t.$fastController.removeStyles(s),o=l)}}unbind(t){super.unbind(t),t.$fastController.removeStyles(this.styles)}}const qR=MatchMediaStyleSheetBehavior.with(window.matchMedia("(forced-colors)"));MatchMediaStyleSheetBehavior.with(window.matchMedia("(prefers-color-scheme: dark)")),MatchMediaStyleSheetBehavior.with(window.matchMedia("(prefers-color-scheme: light)"));class PropertyStyleSheetBehavior{constructor(t,o,s){this.propertyName=t,this.value=o,this.styles=s}bind(t){iP.getNotifier(t).subscribe(this,this.propertyName),this.handleChange(t,this.propertyName)}unbind(t){iP.getNotifier(t).unsubscribe(this,this.propertyName),t.$fastController.removeStyles(this.styles)}handleChange(t,o){t[o]===this.value?t.$fastController.addStyles(this.styles):t.$fastController.removeStyles(this.styles)}}const jR="not-allowed",zR=":host([hidden]){display:none}";function display(t){return`${zR}:host{display:${t}}`}const VR=function canUseFocusVisible(){if("boolean"==typeof BP)return BP;if(!function canUseDOM(){return!("undefined"==typeof window||!window.document||!window.document.createElement)}())return BP=!1,BP;const t=document.createElement("style"),o=function getNonce(){const t=document.querySelector('meta[property="csp-nonce"]');return t?t.getAttribute("content"):null}();null!==o&&t.setAttribute("nonce",o),document.head.appendChild(t);try{t.sheet.insertRule("foo:focus-visible {color:inherit}",0),BP=!0}catch(t){BP=!1}finally{document.head.removeChild(t)}return BP}()?"focus-visible":"focus";function clamp(t,o,s){return isNaN(t)||t<=o?o:t>=s?s:t}function normalize(t,o,s){return isNaN(t)||t<=o?0:t>=s?1:t/(s-o)}function denormalize(t,o,s){return isNaN(t)?o:o+t*(s-o)}function lerp(t,o,s){return isNaN(t)||t<=0?o:t>=1?s:o+t*(s-o)}function roundToPrecisionSmall(t,o){const s=Math.pow(10,o);return Math.round(t*s)/s}class ColorHSL{constructor(t,o,s){this.h=t,this.s=o,this.l=s}static fromObject(t){return!t||isNaN(t.h)||isNaN(t.s)||isNaN(t.l)?null:new ColorHSL(t.h,t.s,t.l)}equalValue(t){return this.h===t.h&&this.s===t.s&&this.l===t.l}roundToPrecision(t){return new ColorHSL(roundToPrecisionSmall(this.h,t),roundToPrecisionSmall(this.s,t),roundToPrecisionSmall(this.l,t))}toObject(){return{h:this.h,s:this.s,l:this.l}}}class ColorLAB{constructor(t,o,s){this.l=t,this.a=o,this.b=s}static fromObject(t){return!t||isNaN(t.l)||isNaN(t.a)||isNaN(t.b)?null:new ColorLAB(t.l,t.a,t.b)}equalValue(t){return this.l===t.l&&this.a===t.a&&this.b===t.b}roundToPrecision(t){return new ColorLAB(roundToPrecisionSmall(this.l,t),roundToPrecisionSmall(this.a,t),roundToPrecisionSmall(this.b,t))}toObject(){return{l:this.l,a:this.a,b:this.b}}}ColorLAB.epsilon=216/24389,ColorLAB.kappa=24389/27;class ColorRGBA64{constructor(t,o,s,l){this.r=t,this.g=o,this.b=s,this.a="number"!=typeof l||isNaN(l)?1:l}static fromObject(t){return!t||isNaN(t.r)||isNaN(t.g)||isNaN(t.b)?null:new ColorRGBA64(t.r,t.g,t.b,t.a)}equalValue(t){return this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a}toStringHexRGB(){return"#"+[this.r,this.g,this.b].map(this.formatHexValue).join("")}toStringHexRGBA(){return this.toStringHexRGB()+this.formatHexValue(this.a)}toStringHexARGB(){return"#"+[this.a,this.r,this.g,this.b].map(this.formatHexValue).join("")}toStringWebRGB(){return`rgb(${Math.round(denormalize(this.r,0,255))},${Math.round(denormalize(this.g,0,255))},${Math.round(denormalize(this.b,0,255))})`}toStringWebRGBA(){return`rgba(${Math.round(denormalize(this.r,0,255))},${Math.round(denormalize(this.g,0,255))},${Math.round(denormalize(this.b,0,255))},${clamp(this.a,0,1)})`}roundToPrecision(t){return new ColorRGBA64(roundToPrecisionSmall(this.r,t),roundToPrecisionSmall(this.g,t),roundToPrecisionSmall(this.b,t),roundToPrecisionSmall(this.a,t))}clamp(){return new ColorRGBA64(clamp(this.r,0,1),clamp(this.g,0,1),clamp(this.b,0,1),clamp(this.a,0,1))}toObject(){return{r:this.r,g:this.g,b:this.b,a:this.a}}formatHexValue(t){return function getHexStringForByte(t){const o=Math.round(clamp(t,0,255)).toString(16);return 1===o.length?"0"+o:o}(denormalize(t,0,255))}}class ColorXYZ{constructor(t,o,s){this.x=t,this.y=o,this.z=s}static fromObject(t){return!t||isNaN(t.x)||isNaN(t.y)||isNaN(t.z)?null:new ColorXYZ(t.x,t.y,t.z)}equalValue(t){return this.x===t.x&&this.y===t.y&&this.z===t.z}roundToPrecision(t){return new ColorXYZ(roundToPrecisionSmall(this.x,t),roundToPrecisionSmall(this.y,t),roundToPrecisionSmall(this.z,t))}toObject(){return{x:this.x,y:this.y,z:this.z}}}function rgbToRelativeLuminance(t){function luminanceHelper(t){return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}return function rgbToLinearLuminance(t){return.2126*t.r+.7152*t.g+.0722*t.b}(new ColorRGBA64(luminanceHelper(t.r),luminanceHelper(t.g),luminanceHelper(t.b),1))}function calcChannelOverlay(t,o,s){return s-o==0?0:(t-o)/(s-o)}function calcRgbOverlay(t,o,s){return(calcChannelOverlay(t.r,o.r,s.r)+calcChannelOverlay(t.g,o.g,s.g)+calcChannelOverlay(t.b,o.b,s.b))/3}function rgbToHSL(t){const o=Math.max(t.r,t.g,t.b),s=Math.min(t.r,t.g,t.b),l=o-s;let h=0;0!==l&&(h=o===t.r?(t.g-t.b)/l%6*60:o===t.g?60*((t.b-t.r)/l+2):60*((t.r-t.g)/l+4)),h<0&&(h+=360);const v=(o+s)/2;let m=0;return 0!==l&&(m=l/(1-Math.abs(2*v-1))),new ColorHSL(h,m,v)}function rgbToLAB(t){return function xyzToLAB(t){function xyzToLABHelper(t){return t>ColorLAB.epsilon?Math.pow(t,1/3):(ColorLAB.kappa*t+16)/116}const o=xyzToLABHelper(t.x/ColorXYZ.whitePoint.x),s=xyzToLABHelper(t.y/ColorXYZ.whitePoint.y),l=xyzToLABHelper(t.z/ColorXYZ.whitePoint.z);return new ColorLAB(116*s-16,500*(o-s),200*(s-l))}(function rgbToXYZ(t){function rgbToXYZHelper(t){return t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}const o=rgbToXYZHelper(t.r),s=rgbToXYZHelper(t.g),l=rgbToXYZHelper(t.b);return new ColorXYZ(.4124564*o+.3575761*s+.1804375*l,.2126729*o+.7151522*s+.072175*l,.0193339*o+.119192*s+.9503041*l)}(t))}function labToRGB(t,o=1){return function xyzToRGB(t,o=1){function xyzToRGBHelper(t){return t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055}const s=xyzToRGBHelper(3.2404542*t.x-1.5371385*t.y-.4985314*t.z),l=xyzToRGBHelper(-.969266*t.x+1.8760108*t.y+.041556*t.z),h=xyzToRGBHelper(.0556434*t.x-.2040259*t.y+1.0572252*t.z);return new ColorRGBA64(s,l,h,o)}(function labToXYZ(t){const o=(t.l+16)/116,s=o+t.a/500,l=o-t.b/200,h=Math.pow(s,3),v=Math.pow(o,3),m=Math.pow(l,3);let _=0;_=h>ColorLAB.epsilon?h:(116*s-16)/ColorLAB.kappa;let R=0;R=t.l>ColorLAB.epsilon*ColorLAB.kappa?v:t.l/ColorLAB.kappa;let $=0;return $=m>ColorLAB.epsilon?m:(116*l-16)/ColorLAB.kappa,_=ColorXYZ.whitePoint.x*_,R=ColorXYZ.whitePoint.y*R,$=ColorXYZ.whitePoint.z*$,new ColorXYZ(_,R,$)}(t),o)}var GR,KR;function interpolateRGB(t,o,s){return isNaN(t)||t<=0?o:t>=1?s:new ColorRGBA64(lerp(t,o.r,s.r),lerp(t,o.g,s.g),lerp(t,o.b,s.b),lerp(t,o.a,s.a))}ColorXYZ.whitePoint=new ColorXYZ(.95047,1,1.08883),function(t){t[t.Burn=0]="Burn",t[t.Color=1]="Color",t[t.Darken=2]="Darken",t[t.Dodge=3]="Dodge",t[t.Lighten=4]="Lighten",t[t.Multiply=5]="Multiply",t[t.Overlay=6]="Overlay",t[t.Screen=7]="Screen"}(GR||(GR={})),function(t){t[t.RGB=0]="RGB",t[t.HSL=1]="HSL",t[t.HSV=2]="HSV",t[t.XYZ=3]="XYZ",t[t.LAB=4]="LAB",t[t.LCH=5]="LCH"}(KR||(KR={}));const WR=/^#((?:[0-9a-f]{6}|[0-9a-f]{3}))$/i;function parseColorHexRGB(t){const o=WR.exec(t);if(null===o)return null;let s=o[1];if(3===s.length){const t=s.charAt(0),o=s.charAt(1),l=s.charAt(2);s=t.concat(t,o,o,l,l)}const l=parseInt(s,16);return isNaN(l)?null:new ColorRGBA64(normalize((16711680&l)>>>16,0,255),normalize((65280&l)>>>8,0,255),normalize(255&l,0,255),1)}function contrast(t,o){const s=t.relativeLuminance>o.relativeLuminance?t:o,l=t.relativeLuminance>o.relativeLuminance?o:t;return(s.relativeLuminance+.05)/(l.relativeLuminance+.05)}const QR=Object.freeze({create:(t,o,s)=>new SwatchRGBImpl(t,o,s),from:t=>new SwatchRGBImpl(t.r,t.g,t.b)});class SwatchRGBImpl extends ColorRGBA64{constructor(t,o,s){super(t,o,s,1),this.toColorString=this.toStringHexRGB,this.contrast=contrast.bind(null,this),this.createCSS=this.toColorString,this.relativeLuminance=rgbToRelativeLuminance(this)}static fromObject(t){return new SwatchRGBImpl(t.r,t.g,t.b)}}function binarySearch(t,o,s=0,l=t.length-1){if(l===s)return t[s];const h=Math.floor((l-s)/2)+s;return o(t[h])?binarySearch(t,o,s,h):binarySearch(t,o,h+1,l)}const YR=(-.1+Math.sqrt(.21))/2;function isDark(t){return t.relativeLuminance<=YR}function directionByIsDark(t){return isDark(t)?-1:1}const JR={stepContrast:1.03,stepContrastRamp:.03,preserveSource:!1};const XR=Object.freeze({create:function create$1(t,o,s){return"number"==typeof t?XR.from(QR.create(t,o,s)):XR.from(t)},from:function from(t,o){return function isSwatchRGB(t){const o={r:0,g:0,b:0,toColorString:()=>"",contrast:()=>0,relativeLuminance:0};for(const s in o)if(typeof o[s]!=typeof t[s])return!1;return!0}(t)?PaletteRGBImpl.from(t,o):PaletteRGBImpl.from(QR.create(t.r,t.g,t.b),o)}});class PaletteRGBImpl{constructor(t,o){this.closestIndexCache=new Map,this.source=t,this.swatches=o,this.reversedSwatches=Object.freeze([...this.swatches].reverse()),this.lastIndex=this.swatches.length-1}colorContrast(t,o,s,l){void 0===s&&(s=this.closestIndexOf(t));let h=this.swatches;const v=this.lastIndex;let m=s;void 0===l&&(l=directionByIsDark(t));return-1===l&&(h=this.reversedSwatches,m=v-m),binarySearch(h,(s=>contrast(t,s)>=o),m,v)}get(t){return this.swatches[t]||this.swatches[clamp(t,0,this.lastIndex)]}closestIndexOf(t){if(this.closestIndexCache.has(t.relativeLuminance))return this.closestIndexCache.get(t.relativeLuminance);let o=this.swatches.indexOf(t);if(-1!==o)return this.closestIndexCache.set(t.relativeLuminance,o),o;const s=this.swatches.reduce(((o,s)=>Math.abs(s.relativeLuminance-t.relativeLuminance)<Math.abs(o.relativeLuminance-t.relativeLuminance)?s:o));return o=this.swatches.indexOf(s),this.closestIndexCache.set(t.relativeLuminance,o),o}static saturationBump(t,o){const s=rgbToHSL(t).s,l=rgbToHSL(o);if(l.s<s){return function hslToRGB(t,o=1){const s=(1-Math.abs(2*t.l-1))*t.s,l=s*(1-Math.abs(t.h/60%2-1)),h=t.l-s/2;let v=0,m=0,_=0;return t.h<60?(v=s,m=l,_=0):t.h<120?(v=l,m=s,_=0):t.h<180?(v=0,m=s,_=l):t.h<240?(v=0,m=l,_=s):t.h<300?(v=l,m=0,_=s):t.h<360&&(v=s,m=0,_=l),new ColorRGBA64(v+h,m+h,_+h,o)}(new ColorHSL(l.h,s,l.l))}return o}static ramp(t){const o=t/100;return o>.5?(o-.5)/.5:2*o}static createHighResolutionPalette(t){const o=[],s=rgbToLAB(ColorRGBA64.fromObject(t).roundToPrecision(4)),l=labToRGB(new ColorLAB(0,s.a,s.b)).clamp().roundToPrecision(4),h=labToRGB(new ColorLAB(50,s.a,s.b)).clamp().roundToPrecision(4),v=labToRGB(new ColorLAB(100,s.a,s.b)).clamp().roundToPrecision(4),m=new ColorRGBA64(0,0,0),_=new ColorRGBA64(1,1,1),R=v.equalValue(_)?0:14,$=l.equalValue(m)?0:14;for(let t=100+R;t>=0-$;t-=.5){let s;if(t<0){s=interpolateRGB(t/$+1,m,l)}else if(t<=50)s=interpolateRGB(PaletteRGBImpl.ramp(t),l,h);else if(t<=100)s=interpolateRGB(PaletteRGBImpl.ramp(t),h,v);else{s=interpolateRGB((t-100)/R,v,_)}s=PaletteRGBImpl.saturationBump(h,s).roundToPrecision(4),o.push(QR.from(s))}return new PaletteRGBImpl(t,o)}static adjustEnd(t,o,s,l){const h=-1===l?o.swatches:o.reversedSwatches,refIndex=t=>{const s=o.closestIndexOf(t);return 1===l?o.lastIndex-s:s};1===l&&s.reverse();const v=t(s[s.length-2]);if(roundToPrecisionSmall(contrast(s[s.length-1],s[s.length-2]),2)<v){s.pop();const t=refIndex(o.colorContrast(h[o.lastIndex],v,void 0,l))-refIndex(s[s.length-2]);let m=1;for(let l=s.length-t-1;l<s.length;l++){const t=refIndex(s[l]),v=l===s.length-1?o.lastIndex:t+m;s[l]=h[v],m++}}1===l&&s.reverse()}static createColorPaletteByContrast(t,o){const s=PaletteRGBImpl.createHighResolutionPalette(t),nextContrast=t=>roundToPrecisionSmall(o.stepContrast+o.stepContrast*(1-t.relativeLuminance)*o.stepContrastRamp,2),l=[];let h=o.preserveSource?t:s.swatches[0];l.push(h);do{const t=nextContrast(h);h=s.colorContrast(h,t,void 0,1),l.push(h)}while(h.relativeLuminance>0);if(o.preserveSource){h=t;do{const t=nextContrast(h);h=s.colorContrast(h,t,void 0,-1),l.unshift(h)}while(h.relativeLuminance<1)}return this.adjustEnd(nextContrast,s,l,-1),o.preserveSource&&this.adjustEnd(nextContrast,s,l,1),l}static from(t,o){const s=void 0===o?JR:Object.assign(Object.assign({},JR),o);return new PaletteRGBImpl(t,Object.freeze(PaletteRGBImpl.createColorPaletteByContrast(t,s)))}}const ZR=QR.create(1,1,1),eO=QR.create(0,0,0),tO=QR.create(.5,.5,.5),rO=parseColorHexRGB("#0078D4"),oO=QR.create(rO.r,rO.g,rO.b);function foregroundOnAccentSet(t,o,s,l,h){const defaultRule=t=>t.contrast(ZR)>=h?ZR:eO,v=defaultRule(t),m=defaultRule(o);return{rest:v,hover:m,active:v.relativeLuminance===m.relativeLuminance?v:defaultRule(s),focus:defaultRule(l)}}class GradientSwatchRGB{constructor(t,o,s,l){this.toColorString=()=>this.cssGradient,this.contrast=contrast.bind(null,this),this.createCSS=this.toColorString,this.color=new ColorRGBA64(t,o,s),this.cssGradient=l,this.relativeLuminance=rgbToRelativeLuminance(this.color),this.r=t,this.g=o,this.b=s}static fromObject(t,o){return new GradientSwatchRGB(t.r,t.g,t.b,o)}}const nO=new ColorRGBA64(0,0,0),iO=new ColorRGBA64(1,1,1);function gradientShadowStroke(t,o,s,l,h,v,m,_,R=10,$=!1){const B=t.closestIndexOf(o);function overlayHelper(s){if($){const l=t.closestIndexOf(o),h=t.get(l),v=s.relativeLuminance<o.relativeLuminance?nO:iO,m=function calculateOverlayColor(t,o,s=null){let l=0,h=s;return null!==h?l=calcRgbOverlay(t,o,h):(h=new ColorRGBA64(0,0,0,1),l=calcRgbOverlay(t,o,h),l<=0&&(h=new ColorRGBA64(1,1,1,1),l=calcRgbOverlay(t,o,h))),l=Math.round(1e3*l)/1e3,new ColorRGBA64(h.r,h.g,h.b,l)}(parseColorHexRGB(s.toColorString()),parseColorHexRGB(h.toColorString()),v).roundToPrecision(2),_=function computeAlphaBlend(t,o){if(o.a>=1)return o;if(o.a<=0)return new ColorRGBA64(t.r,t.g,t.b,1);const s=o.a*o.r+(1-o.a)*t.r,l=o.a*o.g+(1-o.a)*t.g,h=o.a*o.b+(1-o.a)*t.b;return new ColorRGBA64(s,l,h,1)}(parseColorHexRGB(o.toColorString()),m);return QR.from(_)}return s}void 0===_&&(_=directionByIsDark(o));const q=B+_*s,j=q+_*(l-s),z=q+_*(h-s),K=q+_*(v-s),W=-1===_?0:100-R,Z=-1===_?R:100;function gradientHelper(o,s){const l=t.get(o);if(s){const s=t.get(o+_*m),h=-1===_?s:l,v=-1===_?l:s,R=`linear-gradient(${overlayHelper(h).toColorString()} ${W}%, ${overlayHelper(v).toColorString()} ${Z}%)`;return GradientSwatchRGB.fromObject(h,R)}return overlayHelper(l)}return{rest:gradientHelper(q,!0),hover:gradientHelper(j,!0),active:gradientHelper(z,!1),focus:gradientHelper(K,!0)}}function contrastAndDeltaSwatchSet(t,o,s,l,h,v,m,_){null==_&&(_=directionByIsDark(o));const R=t.closestIndexOf(t.colorContrast(o,s));return{rest:t.get(R+_*l),hover:t.get(R+_*h),active:t.get(R+_*v),focus:t.get(R+_*m)}}function deltaSwatchSet(t,o,s,l,h,v,m){const _=t.closestIndexOf(o);return null==m&&(m=directionByIsDark(o)),{rest:t.get(_+m*s),hover:t.get(_+m*l),active:t.get(_+m*h),focus:t.get(_+m*v)}}function deltaSwatchSetByLuminance(t,o,s,l,h,v,m=undefined,_,R,$,B,q=undefined){return isDark(o)?deltaSwatchSet(t,o,_,R,$,B,q):deltaSwatchSet(t,o,s,l,h,v,m)}var sO;function neutralLayer1Index(t,o){return t.closestIndexOf(function baseLayerLuminanceSwatch(t){return QR.create(t,t,t)}(o))}function neutralLayer2(t,o,s){return t.get(neutralLayer1Index(t,o)+-1*s)}!function(t){t[t.LightMode=.98]="LightMode",t[t.DarkMode=.15]="DarkMode"}(sO||(sO={}));const{create:aO}=yR;function createNonCss(t){return yR.create({name:t,cssCustomPropertyName:null})}const lO=aO("direction").withDefault(eR.ltr),cO=aO("disabled-opacity").withDefault(.3),dO=aO("base-height-multiplier").withDefault(8),uO=aO("base-horizontal-spacing-multiplier").withDefault(3),hO=aO("density").withDefault(0),pO=aO("design-unit").withDefault(4),fO=aO("control-corner-radius").withDefault(4),gO=aO("layer-corner-radius").withDefault(8),vO=aO("stroke-width").withDefault(1),mO=aO("focus-stroke-width").withDefault(2),bO=aO("body-font").withDefault('"Segoe UI Variable", "Segoe UI", sans-serif'),yO=aO("font-weight").withDefault(400);function fontVariations(t){return o=>{const s=t.getValueFor(o),l=yO.getValueFor(o);if(s.endsWith("px")){const t=Number.parseFloat(s.replace("px",""));if(t<=12)return`"wght" ${l}, "opsz" 8`;if(t>24)return`"wght" ${l}, "opsz" 36`}return`"wght" ${l}, "opsz" 10.5`}}const wO=aO("type-ramp-base-font-size").withDefault("14px"),_O=aO("type-ramp-base-line-height").withDefault("20px"),CO=aO("type-ramp-base-font-variations").withDefault(fontVariations(wO)),kO=aO("type-ramp-minus-1-font-size").withDefault("12px"),TO=aO("type-ramp-minus-1-line-height").withDefault("16px"),SO=aO("type-ramp-minus-1-font-variations").withDefault(fontVariations(kO)),xO=aO("type-ramp-minus-2-font-size").withDefault("10px"),EO=aO("type-ramp-minus-2-line-height").withDefault("14px"),IO=aO("type-ramp-minus-2-font-variations").withDefault(fontVariations(xO)),AO=aO("type-ramp-plus-1-font-size").withDefault("16px"),PO=aO("type-ramp-plus-1-line-height").withDefault("22px"),RO=aO("type-ramp-plus-1-font-variations").withDefault(fontVariations(AO)),OO=aO("type-ramp-plus-2-font-size").withDefault("20px"),$O=aO("type-ramp-plus-2-line-height").withDefault("26px"),NO=aO("type-ramp-plus-2-font-variations").withDefault(fontVariations(OO)),MO=aO("type-ramp-plus-3-font-size").withDefault("24px"),DO=aO("type-ramp-plus-3-line-height").withDefault("32px"),LO=aO("type-ramp-plus-3-font-variations").withDefault(fontVariations(MO)),FO=aO("type-ramp-plus-4-font-size").withDefault("28px"),UO=aO("type-ramp-plus-4-line-height").withDefault("36px"),HO=aO("type-ramp-plus-4-font-variations").withDefault(fontVariations(FO)),BO=aO("type-ramp-plus-5-font-size").withDefault("32px"),qO=aO("type-ramp-plus-5-line-height").withDefault("40px"),jO=aO("type-ramp-plus-5-font-variations").withDefault(fontVariations(BO)),zO=aO("type-ramp-plus-6-font-size").withDefault("40px"),VO=aO("type-ramp-plus-6-line-height").withDefault("52px"),GO=aO("type-ramp-plus-6-font-variations").withDefault(fontVariations(zO)),KO=aO("base-layer-luminance").withDefault(sO.LightMode),WO=createNonCss("accent-fill-rest-delta").withDefault(0),QO=createNonCss("accent-fill-hover-delta").withDefault(-2),YO=createNonCss("accent-fill-active-delta").withDefault(-5),JO=createNonCss("accent-fill-focus-delta").withDefault(0),XO=createNonCss("accent-foreground-rest-delta").withDefault(0),ZO=createNonCss("accent-foreground-hover-delta").withDefault(3),e$=createNonCss("accent-foreground-active-delta").withDefault(-8),t$=createNonCss("accent-foreground-focus-delta").withDefault(0),r$=createNonCss("neutral-fill-rest-delta").withDefault(-1),o$=createNonCss("neutral-fill-hover-delta").withDefault(1),n$=createNonCss("neutral-fill-active-delta").withDefault(0),i$=createNonCss("neutral-fill-focus-delta").withDefault(0),s$=createNonCss("neutral-fill-input-rest-delta").withDefault(-1),a$=createNonCss("neutral-fill-input-hover-delta").withDefault(1),l$=createNonCss("neutral-fill-input-active-delta").withDefault(0),c$=createNonCss("neutral-fill-input-focus-delta").withDefault(-2),d$=createNonCss("neutral-fill-input-alt-rest-delta").withDefault(2),u$=createNonCss("neutral-fill-input-alt-hover-delta").withDefault(4),h$=createNonCss("neutral-fill-input-alt-active-delta").withDefault(6),p$=createNonCss("neutral-fill-input-alt-focus-delta").withDefault(2),f$=createNonCss("neutral-fill-layer-rest-delta").withDefault(-2),g$=createNonCss("neutral-fill-layer-hover-delta").withDefault(-3),v$=createNonCss("neutral-fill-layer-active-delta").withDefault(-3),m$=createNonCss("neutral-fill-layer-alt-rest-delta").withDefault(-1),b$=createNonCss("neutral-fill-secondary-rest-delta").withDefault(3),y$=createNonCss("neutral-fill-secondary-hover-delta").withDefault(2),w$=createNonCss("neutral-fill-secondary-active-delta").withDefault(1),_$=createNonCss("neutral-fill-secondary-focus-delta").withDefault(3),C$=createNonCss("neutral-fill-stealth-rest-delta").withDefault(0),k$=createNonCss("neutral-fill-stealth-hover-delta").withDefault(3),T$=createNonCss("neutral-fill-stealth-active-delta").withDefault(2),S$=createNonCss("neutral-fill-stealth-focus-delta").withDefault(0),x$=createNonCss("neutral-fill-strong-rest-delta").withDefault(0),E$=createNonCss("neutral-fill-strong-hover-delta").withDefault(8),I$=createNonCss("neutral-fill-strong-active-delta").withDefault(-5),A$=createNonCss("neutral-fill-strong-focus-delta").withDefault(0),P$=createNonCss("neutral-stroke-rest-delta").withDefault(8),R$=createNonCss("neutral-stroke-hover-delta").withDefault(12),O$=createNonCss("neutral-stroke-active-delta").withDefault(6),$$=createNonCss("neutral-stroke-focus-delta").withDefault(8),N$=createNonCss("neutral-stroke-control-rest-delta").withDefault(3),M$=createNonCss("neutral-stroke-control-hover-delta").withDefault(5),D$=createNonCss("neutral-stroke-control-active-delta").withDefault(5),L$=createNonCss("neutral-stroke-control-focus-delta").withDefault(5),F$=createNonCss("neutral-stroke-divider-rest-delta").withDefault(4),U$=createNonCss("neutral-stroke-layer-rest-delta").withDefault(3),H$=createNonCss("neutral-stroke-layer-hover-delta").withDefault(3),B$=createNonCss("neutral-stroke-layer-active-delta").withDefault(3),q$=createNonCss("neutral-stroke-strong-hover-delta").withDefault(0),j$=createNonCss("neutral-stroke-strong-active-delta").withDefault(0),z$=createNonCss("neutral-stroke-strong-focus-delta").withDefault(0),V$=aO("neutral-base-color").withDefault(tO),G$=createNonCss("neutral-palette").withDefault((t=>XR.from(V$.getValueFor(t)))),K$=aO("accent-base-color").withDefault(oO),W$=createNonCss("accent-palette").withDefault((t=>XR.from(K$.getValueFor(t)))),Q$=createNonCss("neutral-layer-card-container-recipe").withDefault({evaluate:t=>neutralLayer2(G$.getValueFor(t),KO.getValueFor(t),f$.getValueFor(t))});aO("neutral-layer-card-container").withDefault((t=>Q$.getValueFor(t).evaluate(t)));const Y$=createNonCss("neutral-layer-floating-recipe").withDefault({evaluate:t=>function neutralLayerFloating$1(t,o,s){return t.get(neutralLayer1Index(t,o)+s)}(G$.getValueFor(t),KO.getValueFor(t),f$.getValueFor(t))}),J$=aO("neutral-layer-floating").withDefault((t=>Y$.getValueFor(t).evaluate(t))),X$=createNonCss("neutral-layer-1-recipe").withDefault({evaluate:t=>function neutralLayer1$1(t,o){return t.get(neutralLayer1Index(t,o))}(G$.getValueFor(t),KO.getValueFor(t))}),Z$=aO("neutral-layer-1").withDefault((t=>X$.getValueFor(t).evaluate(t))),eN=createNonCss("neutral-layer-2-recipe").withDefault({evaluate:t=>neutralLayer2(G$.getValueFor(t),KO.getValueFor(t),f$.getValueFor(t))});aO("neutral-layer-2").withDefault((t=>eN.getValueFor(t).evaluate(t)));const tN=createNonCss("neutral-layer-3-recipe").withDefault({evaluate:t=>function neutralLayer3(t,o,s){return t.get(neutralLayer1Index(t,o)+-1*s*2)}(G$.getValueFor(t),KO.getValueFor(t),f$.getValueFor(t))});aO("neutral-layer-3").withDefault((t=>tN.getValueFor(t).evaluate(t)));const rN=createNonCss("neutral-layer-4-recipe").withDefault({evaluate:t=>function neutralLayer4(t,o,s){return t.get(neutralLayer1Index(t,o)+-1*s*3)}(G$.getValueFor(t),KO.getValueFor(t),f$.getValueFor(t))});aO("neutral-layer-4").withDefault((t=>rN.getValueFor(t).evaluate(t)));const oN=aO("fill-color").withDefault((t=>Z$.getValueFor(t)));var nN;!function(t){t[t.normal=4.5]="normal",t[t.large=3]="large"}(nN||(nN={}));const iN=createNonCss("accent-fill-recipe").withDefault({evaluate:(t,o)=>function contrastAndDeltaSwatchSetByLuminance(t,o,s,l,h,v,m,_=undefined,R,$,B,q,j,z=undefined){return isDark(o)?contrastAndDeltaSwatchSet(t,o,R,$,B,q,j,z):contrastAndDeltaSwatchSet(t,o,s,l,h,v,m,_)}(W$.getValueFor(t),o||oN.getValueFor(t),5,WO.getValueFor(t),QO.getValueFor(t),YO.getValueFor(t),JO.getValueFor(t),void 0,8,WO.getValueFor(t),QO.getValueFor(t),YO.getValueFor(t),JO.getValueFor(t),void 0)}),sN=aO("accent-fill-rest").withDefault((t=>iN.getValueFor(t).evaluate(t).rest)),aN=aO("accent-fill-hover").withDefault((t=>iN.getValueFor(t).evaluate(t).hover)),lN=aO("accent-fill-active").withDefault((t=>iN.getValueFor(t).evaluate(t).active)),cN=aO("accent-fill-focus").withDefault((t=>iN.getValueFor(t).evaluate(t).focus)),dN=createNonCss("foreground-on-accent-recipe").withDefault({evaluate:t=>foregroundOnAccentSet(sN.getValueFor(t),aN.getValueFor(t),lN.getValueFor(t),cN.getValueFor(t),nN.normal)}),uN=aO("foreground-on-accent-rest").withDefault((t=>dN.getValueFor(t).evaluate(t).rest)),hN=aO("foreground-on-accent-hover").withDefault((t=>dN.getValueFor(t).evaluate(t).hover)),pN=aO("foreground-on-accent-active").withDefault((t=>dN.getValueFor(t).evaluate(t).active));aO("foreground-on-accent-focus").withDefault((t=>dN.getValueFor(t).evaluate(t).focus));const fN=createNonCss("accent-foreground-recipe").withDefault({evaluate:(t,o)=>contrastAndDeltaSwatchSet(W$.getValueFor(t),o||oN.getValueFor(t),9.5,XO.getValueFor(t),ZO.getValueFor(t),e$.getValueFor(t),t$.getValueFor(t))}),gN=aO("accent-foreground-rest").withDefault((t=>fN.getValueFor(t).evaluate(t).rest)),vN=aO("accent-foreground-hover").withDefault((t=>fN.getValueFor(t).evaluate(t).hover)),mN=aO("accent-foreground-active").withDefault((t=>fN.getValueFor(t).evaluate(t).active));aO("accent-foreground-focus").withDefault((t=>fN.getValueFor(t).evaluate(t).focus));const bN=createNonCss("accent-stroke-control-recipe").withDefault({evaluate:(t,o)=>gradientShadowStroke(G$.getValueFor(t),o||oN.getValueFor(t),-3,-3,-3,-3,10,1,void 0,!0)}),yN=aO("accent-stroke-control-rest").withDefault((t=>bN.getValueFor(t).evaluate(t,sN.getValueFor(t)).rest)),wN=aO("accent-stroke-control-hover").withDefault((t=>bN.getValueFor(t).evaluate(t,aN.getValueFor(t)).hover)),_N=aO("accent-stroke-control-active").withDefault((t=>bN.getValueFor(t).evaluate(t,lN.getValueFor(t)).active));aO("accent-stroke-control-focus").withDefault((t=>bN.getValueFor(t).evaluate(t,cN.getValueFor(t)).focus));const CN=createNonCss("neutral-fill-recipe").withDefault({evaluate:(t,o)=>deltaSwatchSetByLuminance(G$.getValueFor(t),o||oN.getValueFor(t),r$.getValueFor(t),o$.getValueFor(t),n$.getValueFor(t),i$.getValueFor(t),void 0,2,3,1,2,void 0)}),kN=aO("neutral-fill-rest").withDefault((t=>CN.getValueFor(t).evaluate(t).rest)),TN=aO("neutral-fill-hover").withDefault((t=>CN.getValueFor(t).evaluate(t).hover)),SN=aO("neutral-fill-active").withDefault((t=>CN.getValueFor(t).evaluate(t).active));aO("neutral-fill-focus").withDefault((t=>CN.getValueFor(t).evaluate(t).focus));const xN=createNonCss("neutral-fill-input-recipe").withDefault({evaluate:(t,o)=>deltaSwatchSetByLuminance(G$.getValueFor(t),o||oN.getValueFor(t),s$.getValueFor(t),a$.getValueFor(t),l$.getValueFor(t),c$.getValueFor(t),void 0,2,3,1,0,void 0)}),EN=aO("neutral-fill-input-rest").withDefault((t=>xN.getValueFor(t).evaluate(t).rest)),IN=aO("neutral-fill-input-hover").withDefault((t=>xN.getValueFor(t).evaluate(t).hover));aO("neutral-fill-input-active").withDefault((t=>xN.getValueFor(t).evaluate(t).active));const AN=aO("neutral-fill-input-focus").withDefault((t=>xN.getValueFor(t).evaluate(t).focus)),PN=createNonCss("neutral-fill-input-alt-recipe").withDefault({evaluate:(t,o)=>deltaSwatchSetByLuminance(G$.getValueFor(t),o||oN.getValueFor(t),d$.getValueFor(t),u$.getValueFor(t),h$.getValueFor(t),p$.getValueFor(t),1,d$.getValueFor(t),d$.getValueFor(t)-u$.getValueFor(t),d$.getValueFor(t)-h$.getValueFor(t),p$.getValueFor(t),1)}),RN=aO("neutral-fill-input-alt-rest").withDefault((t=>PN.getValueFor(t).evaluate(t).rest)),ON=aO("neutral-fill-input-alt-hover").withDefault((t=>PN.getValueFor(t).evaluate(t).hover)),$N=aO("neutral-fill-input-alt-active").withDefault((t=>PN.getValueFor(t).evaluate(t).active)),NN=aO("neutral-fill-input-alt-focus").withDefault((t=>PN.getValueFor(t).evaluate(t).focus)),MN=createNonCss("neutral-fill-layer-recipe").withDefault({evaluate:(t,o)=>deltaSwatchSet(G$.getValueFor(t),o||oN.getValueFor(t),f$.getValueFor(t),g$.getValueFor(t),v$.getValueFor(t),f$.getValueFor(t),1)});aO("neutral-fill-layer-rest").withDefault((t=>MN.getValueFor(t).evaluate(t).rest)),aO("neutral-fill-layer-hover").withDefault((t=>MN.getValueFor(t).evaluate(t).hover)),aO("neutral-fill-layer-active").withDefault((t=>MN.getValueFor(t).evaluate(t).active));const DN=createNonCss("neutral-fill-layer-alt-recipe").withDefault({evaluate:(t,o)=>deltaSwatchSet(G$.getValueFor(t),o||oN.getValueFor(t),m$.getValueFor(t),m$.getValueFor(t),m$.getValueFor(t),m$.getValueFor(t))});aO("neutral-fill-layer-alt-rest").withDefault((t=>DN.getValueFor(t).evaluate(t).rest));const LN=createNonCss("neutral-fill-secondary-recipe").withDefault({evaluate:(t,o)=>deltaSwatchSet(G$.getValueFor(t),o||oN.getValueFor(t),b$.getValueFor(t),y$.getValueFor(t),w$.getValueFor(t),_$.getValueFor(t))}),FN=aO("neutral-fill-secondary-rest").withDefault((t=>LN.getValueFor(t).evaluate(t).rest)),UN=aO("neutral-fill-secondary-hover").withDefault((t=>LN.getValueFor(t).evaluate(t).hover)),HN=aO("neutral-fill-secondary-active").withDefault((t=>LN.getValueFor(t).evaluate(t).active)),BN=aO("neutral-fill-secondary-focus").withDefault((t=>LN.getValueFor(t).evaluate(t).focus)),qN=createNonCss("neutral-fill-stealth-recipe").withDefault({evaluate:(t,o)=>deltaSwatchSet(G$.getValueFor(t),o||oN.getValueFor(t),C$.getValueFor(t),k$.getValueFor(t),T$.getValueFor(t),S$.getValueFor(t))}),jN=aO("neutral-fill-stealth-rest").withDefault((t=>qN.getValueFor(t).evaluate(t).rest)),zN=aO("neutral-fill-stealth-hover").withDefault((t=>qN.getValueFor(t).evaluate(t).hover)),VN=aO("neutral-fill-stealth-active").withDefault((t=>qN.getValueFor(t).evaluate(t).active)),GN=aO("neutral-fill-stealth-focus").withDefault((t=>qN.getValueFor(t).evaluate(t).focus)),KN=createNonCss("neutral-fill-strong-recipe").withDefault({evaluate:(t,o)=>contrastAndDeltaSwatchSet(G$.getValueFor(t),o||oN.getValueFor(t),4.5,x$.getValueFor(t),E$.getValueFor(t),I$.getValueFor(t),A$.getValueFor(t))});aO("neutral-fill-strong-rest").withDefault((t=>KN.getValueFor(t).evaluate(t).rest)),aO("neutral-fill-strong-hover").withDefault((t=>KN.getValueFor(t).evaluate(t).hover)),aO("neutral-fill-strong-active").withDefault((t=>KN.getValueFor(t).evaluate(t).active)),aO("neutral-fill-strong-focus").withDefault((t=>KN.getValueFor(t).evaluate(t).focus));const WN=createNonCss("neutral-foreground-recipe").withDefault({evaluate:(t,o)=>contrastAndDeltaSwatchSet(G$.getValueFor(t),o||oN.getValueFor(t),16,0,-19,-30,0)}),QN=aO("neutral-foreground-rest").withDefault((t=>WN.getValueFor(t).evaluate(t).rest)),YN=aO("neutral-foreground-hover").withDefault((t=>WN.getValueFor(t).evaluate(t).hover)),JN=aO("neutral-foreground-active").withDefault((t=>WN.getValueFor(t).evaluate(t).active));aO("neutral-foreground-focus").withDefault((t=>WN.getValueFor(t).evaluate(t).focus));const XN=createNonCss("neutral-foreground-hint-recipe").withDefault({evaluate:(t,o)=>function contrastSwatch(t,o,s){return t.colorContrast(o,s)}(G$.getValueFor(t),o||oN.getValueFor(t),4.5)}),ZN=aO("neutral-foreground-hint").withDefault((t=>XN.getValueFor(t).evaluate(t))),eM=createNonCss("neutral-stroke-recipe").withDefault({evaluate:(t,o)=>deltaSwatchSet(G$.getValueFor(t),o||oN.getValueFor(t),P$.getValueFor(t),R$.getValueFor(t),O$.getValueFor(t),$$.getValueFor(t))}),tM=aO("neutral-stroke-rest").withDefault((t=>eM.getValueFor(t).evaluate(t).rest)),rM=aO("neutral-stroke-hover").withDefault((t=>eM.getValueFor(t).evaluate(t).hover)),oM=aO("neutral-stroke-active").withDefault((t=>eM.getValueFor(t).evaluate(t).active));aO("neutral-stroke-focus").withDefault((t=>eM.getValueFor(t).evaluate(t).focus));const nM=createNonCss("neutral-stroke-control-recipe").withDefault({evaluate:(t,o)=>gradientShadowStroke(G$.getValueFor(t),o||oN.getValueFor(t),N$.getValueFor(t),M$.getValueFor(t),D$.getValueFor(t),L$.getValueFor(t),5)}),iM=aO("neutral-stroke-control-rest").withDefault((t=>nM.getValueFor(t).evaluate(t).rest)),sM=aO("neutral-stroke-control-hover").withDefault((t=>nM.getValueFor(t).evaluate(t).hover)),aM=aO("neutral-stroke-control-active").withDefault((t=>nM.getValueFor(t).evaluate(t).active));aO("neutral-stroke-control-focus").withDefault((t=>nM.getValueFor(t).evaluate(t).focus));const lM=createNonCss("neutral-stroke-divider-recipe").withDefault({evaluate:(t,o)=>function deltaSwatch(t,o,s){return t.get(t.closestIndexOf(o)+directionByIsDark(o)*s)}(G$.getValueFor(t),o||oN.getValueFor(t),F$.getValueFor(t))});aO("neutral-stroke-divider-rest").withDefault((t=>lM.getValueFor(t).evaluate(t)));const cM=createNonCss("neutral-stroke-input-recipe").withDefault({evaluate:(t,o)=>function underlineStroke(t,o,s,l,h,v,m,_){const R=t.closestIndexOf(o),$=directionByIsDark(o),B=R+$*s,q=B+$*(l-s),j=B+$*(h-s),z=B+$*(v-s),K=`calc(100% - ${_})`;function gradientHelper(o,s){const l=t.get(o);if(s){const s=t.get(o+$*m),h=`linear-gradient(${l.toColorString()} ${K}, ${s.toColorString()} ${K}, ${s.toColorString()})`;return GradientSwatchRGB.fromObject(l,h)}return l}return{rest:gradientHelper(B,!0),hover:gradientHelper(q,!0),active:gradientHelper(j,!1),focus:gradientHelper(z,!0)}}(G$.getValueFor(t),o||oN.getValueFor(t),N$.getValueFor(t),M$.getValueFor(t),D$.getValueFor(t),L$.getValueFor(t),20,vO.getValueFor(t)+"px")}),dM=aO("neutral-stroke-input-rest").withDefault((t=>cM.getValueFor(t).evaluate(t).rest)),uM=aO("neutral-stroke-input-hover").withDefault((t=>cM.getValueFor(t).evaluate(t).hover));aO("neutral-stroke-input-active").withDefault((t=>cM.getValueFor(t).evaluate(t).active)),aO("neutral-stroke-input-focus").withDefault((t=>cM.getValueFor(t).evaluate(t).focus));const hM=createNonCss("neutral-stroke-layer-recipe").withDefault({evaluate:(t,o)=>deltaSwatchSet(G$.getValueFor(t),o||oN.getValueFor(t),U$.getValueFor(t),H$.getValueFor(t),B$.getValueFor(t),U$.getValueFor(t))}),pM=aO("neutral-stroke-layer-rest").withDefault((t=>hM.getValueFor(t).evaluate(t).rest));aO("neutral-stroke-layer-hover").withDefault((t=>hM.getValueFor(t).evaluate(t).hover)),aO("neutral-stroke-layer-active").withDefault((t=>hM.getValueFor(t).evaluate(t).active));const fM=createNonCss("neutral-stroke-strong-recipe").withDefault({evaluate:(t,o)=>contrastAndDeltaSwatchSet(G$.getValueFor(t),o||oN.getValueFor(t),5.5,0,q$.getValueFor(t),j$.getValueFor(t),z$.getValueFor(t))}),gM=aO("neutral-stroke-strong-rest").withDefault((t=>fM.getValueFor(t).evaluate(t).rest)),vM=aO("neutral-stroke-strong-hover").withDefault((t=>fM.getValueFor(t).evaluate(t).hover)),mM=aO("neutral-stroke-strong-active").withDefault((t=>fM.getValueFor(t).evaluate(t).active));aO("neutral-stroke-strong-focus").withDefault((t=>fM.getValueFor(t).evaluate(t).focus));const bM=createNonCss("focus-stroke-outer-recipe").withDefault({evaluate:t=>function focusStrokeOuter$1(t,o){return isDark(o)?ZR:eO}(G$.getValueFor(t),oN.getValueFor(t))}),yM=aO("focus-stroke-outer").withDefault((t=>bM.getValueFor(t).evaluate(t))),wM=createNonCss("focus-stroke-inner-recipe").withDefault({evaluate:t=>function focusStrokeInner$1(t,o,s){return isDark(o)?eO:ZR}(W$.getValueFor(t),oN.getValueFor(t),yM.getValueFor(t))}),_M=aO("focus-stroke-inner").withDefault((t=>wM.getValueFor(t).evaluate(t))),CM=createNonCss("foreground-on-accent-large-recipe").withDefault({evaluate:t=>foregroundOnAccentSet(sN.getValueFor(t),aN.getValueFor(t),lN.getValueFor(t),cN.getValueFor(t),nN.large)});aO("foreground-on-accent-rest-large").withDefault((t=>CM.getValueFor(t).evaluate(t).rest)),aO("foreground-on-accent-hover-large").withDefault((t=>CM.getValueFor(t).evaluate(t,aN.getValueFor(t)).hover)),aO("foreground-on-accent-active-large").withDefault((t=>CM.getValueFor(t).evaluate(t,lN.getValueFor(t)).active)),aO("foreground-on-accent-focus-large").withDefault((t=>CM.getValueFor(t).evaluate(t,cN.getValueFor(t)).focus));const kM=aO("neutral-fill-inverse-rest-delta").withDefault(0),TM=aO("neutral-fill-inverse-hover-delta").withDefault(-3),SM=aO("neutral-fill-inverse-active-delta").withDefault(7),xM=aO("neutral-fill-inverse-focus-delta").withDefault(0);const EM=createNonCss("neutral-fill-inverse-recipe").withDefault({evaluate:(t,o)=>function neutralFillInverse(t,o,s,l,h,v){const m=directionByIsDark(o),_=t.closestIndexOf(t.colorContrast(o,14)),R=_+m*Math.abs(s-l);let $,B;return(1===m?s<l:m*s>m*l)?($=_,B=R):($=R,B=_),{rest:t.get($),hover:t.get(B),active:t.get($+m*h),focus:t.get($+m*v)}}(G$.getValueFor(t),o||oN.getValueFor(t),kM.getValueFor(t),TM.getValueFor(t),SM.getValueFor(t),xM.getValueFor(t))});aO("neutral-fill-inverse-rest").withDefault((t=>EM.getValueFor(t).evaluate(t).rest)),aO("neutral-fill-inverse-hover").withDefault((t=>EM.getValueFor(t).evaluate(t).hover)),aO("neutral-fill-inverse-active").withDefault((t=>EM.getValueFor(t).evaluate(t).active)),aO("neutral-fill-inverse-focus").withDefault((t=>EM.getValueFor(t).evaluate(t).focus));const IM=cssPartial`
  font-family: ${bO};
  font-size: ${wO};
  line-height: ${_O};
  font-weight: initial;
  font-variation-settings: ${CO};
`;cssPartial`
  font-family: ${bO};
  font-size: ${kO};
  line-height: ${TO};
  font-weight: initial;
  font-variation-settings: ${SO};
`,cssPartial`
  font-family: ${bO};
  font-size: ${xO};
  line-height: ${EO};
  font-weight: initial;
  font-variation-settings: ${IO};
`,cssPartial`
  font-family: ${bO};
  font-size: ${AO};
  line-height: ${PO};
  font-weight: initial;
  font-variation-settings: ${RO};
`,cssPartial`
  font-family: ${bO};
  font-size: ${OO};
  line-height: ${$O};
  font-weight: initial;
  font-variation-settings: ${NO};
`,cssPartial`
  font-family: ${bO};
  font-size: ${MO};
  line-height: ${DO};
  font-weight: initial;
  font-variation-settings: ${LO};
`,cssPartial`
  font-family: ${bO};
  font-size: ${FO};
  line-height: ${UO};
  font-weight: initial;
  font-variation-settings: ${HO};
`,cssPartial`
  font-family: ${bO};
  font-size: ${BO};
  line-height: ${qO};
  font-weight: initial;
  font-variation-settings: ${jO};
`,cssPartial`
  font-family: ${bO};
  font-size: ${zO};
  line-height: ${VO};
  font-weight: initial;
  font-variation-settings: ${GO};
`;const AM=cssPartial`
  outline: calc(${mO} * 1px) solid ${yM};
  outline-offset: calc(${mO} * -1px);
`,PM=cssPartial`
  outline: calc(${mO} * 1px) solid ${yM};
  outline-offset: calc(${vO} * 1px);
`,RM=cssPartial`(${dO} + ${hO}) * ${pO}`;class DirectionalStyleSheetBehavior{constructor(t,o){this.cache=new WeakMap,this.ltr=t,this.rtl=o}bind(t){this.attach(t)}unbind(t){const o=this.cache.get(t);o&&lO.unsubscribe(o)}attach(t){const o=this.cache.get(t)||new DirectionalStyleSheetBehaviorSubscription(this.ltr,this.rtl,t),s=lO.getValueFor(t);lO.subscribe(o),o.attach(s),this.cache.set(t,o)}}class DirectionalStyleSheetBehaviorSubscription{constructor(t,o,s){this.ltr=t,this.rtl=o,this.source=s,this.attached=null}handleChange({target:t,token:o}){this.attach(o.getValueFor(this.source))}attach(t){this.attached!==this[t]&&(null!==this.attached&&this.source.$fastController.removeStyles(this.attached),this.attached=this[t],null!==this.attached&&this.source.$fastController.addStyles(this.attached))}}const OM=yR.create({name:"elevation-shadow",cssCustomPropertyName:null}).withDefault({evaluate:(t,o,s)=>{let l=.12,h=.14;o>16&&(l=.2,h=.24);return`${`0 0 2px rgba(0, 0, 0, ${l})`}, ${`0 calc(${o} * 0.5px) calc((${o} * 1px)) rgba(0, 0, 0, ${h})`}`}}),$M=yR.create("elevation-shadow-card-rest-size").withDefault(4),NM=yR.create("elevation-shadow-card-hover-size").withDefault(8),MM=yR.create("elevation-shadow-card-active-size").withDefault(0),DM=yR.create("elevation-shadow-card-focus-size").withDefault(8),LM=yR.create("elevation-shadow-card-rest").withDefault((t=>OM.getValueFor(t).evaluate(t,$M.getValueFor(t))));yR.create("elevation-shadow-card-hover").withDefault((t=>OM.getValueFor(t).evaluate(t,NM.getValueFor(t)))),yR.create("elevation-shadow-card-active").withDefault((t=>OM.getValueFor(t).evaluate(t,MM.getValueFor(t)))),yR.create("elevation-shadow-card-focus").withDefault((t=>OM.getValueFor(t).evaluate(t,DM.getValueFor(t))));const FM=yR.create("elevation-shadow-tooltip-size").withDefault(16),UM=yR.create("elevation-shadow-tooltip").withDefault((t=>OM.getValueFor(t).evaluate(t,FM.getValueFor(t)))),HM=yR.create("elevation-shadow-flyout-size").withDefault(32),BM=yR.create("elevation-shadow-flyout").withDefault((t=>OM.getValueFor(t).evaluate(t,HM.getValueFor(t)))),qM=yR.create("elevation-shadow-dialog-size").withDefault(128);yR.create("elevation-shadow-dialog").withDefault((t=>OM.getValueFor(t).evaluate(t,qM.getValueFor(t))));const jM=yR.create("input-placeholder-rest").withDefault((t=>{const o=xN.getValueFor(t);return XN.getValueFor(t).evaluate(t,o.evaluate(t).rest)})),zM=yR.create("input-placeholder-hover").withDefault((t=>{const o=xN.getValueFor(t);return XN.getValueFor(t).evaluate(t,o.evaluate(t).hover)})),VM=yR.create("input-filled-placeholder-rest").withDefault((t=>{const o=LN.getValueFor(t);return XN.getValueFor(t).evaluate(t,o.evaluate(t).rest)})),GM=yR.create("input-filled-placeholder-hover").withDefault((t=>{const o=LN.getValueFor(t);return XN.getValueFor(t).evaluate(t,o.evaluate(t).hover)})),inputStateStyles=(t,o,s)=>css`
  @media (forced-colors: none) {
    :host(:not([disabled]):active)::after {
      left: 50%;
      width: 40%;
      transform: translateX(-50%);
      border-bottom-left-radius: 0;
      border-bottom-right-radius: 0;
    }

    :host(:not([disabled]):focus-within)::after {
      left: 0;
      width: 100%;
      transform: none;
    }

    :host(:not([disabled]):active)::after,
    :host(:not([disabled]):focus-within:not(:active))::after {
      content: '';
      position: absolute;
      height: calc(${mO} * 1px);
      bottom: 0;
      border-bottom: calc(${mO} * 1px) solid ${sN};
      border-bottom-left-radius: calc(${fO} * 1px);
      border-bottom-right-radius: calc(${fO} * 1px);
      z-index: 2;
      transition: all 300ms cubic-bezier(0.1, 0.9, 0.2, 1);
    }
  }
`,inputOutlineStyles=(t,o,s,l=":not([disabled]):not(:focus-within)")=>css`
  ${s} {
    background: padding-box linear-gradient(${EN}, ${EN}),
      border-box ${dM};
  }

  :host(${l}:hover) ${s} {
    background: padding-box linear-gradient(${IN}, ${IN}),
      border-box ${uM};
  }

  :host(:not([disabled]):focus-within) ${s} {
    background: padding-box linear-gradient(${AN}, ${AN}),
      border-box ${dM};
  }
  
  :host([disabled]) ${s} {
    background: padding-box linear-gradient(${EN}, ${EN}),
      border-box ${tM};
  }

  .control::placeholder {
    color: ${jM};
  }

  :host(${l}:hover) .control::placeholder {
    color: ${zM};
  }
`,inputFilledStyles=(t,o,s,l=":not([disabled]):not(:focus-within)")=>css`
  ${s} {
    background: ${FN};
  }

  :host(${l}:hover) ${s} {
    background: ${UN};
  }

  :host(:not([disabled]):focus-within) ${s} {
    background: ${BN};
  }

  :host([disabled]) ${s} {
    background: ${FN};
  }

  .control::placeholder {
    color: ${VM};
  }

  :host(${l}:hover) .control::placeholder {
    color: ${GM};
  }
`,inputForcedColorStyles=(t,o,s,l=":not([disabled]):not(:focus-within)")=>css`
  :host {
    color: ${rR.ButtonText};
  }

  ${s} {
    background: ${rR.ButtonFace};
    border-color: ${rR.ButtonText};
  }

  :host(${l}:hover) ${s},
  :host(:not([disabled]):focus-within) ${s} {
    border-color: ${rR.Highlight};
  }

  :host([disabled]) ${s} {
    opacity: 1;
    background: ${rR.ButtonFace};
    border-color: ${rR.GrayText};
  }

  .control::placeholder,
  :host(${l}:hover) .control::placeholder {
    color: ${rR.CanvasText};
  }

  :host(:not([disabled]):focus) ${s} {
    ${AM}
    outline-color: ${rR.Highlight};
  }

  :host([disabled]) {
    opacity: 1;
    color: ${rR.GrayText};
  }

  :host([disabled]) ::placeholder,
  :host([disabled]) ::-webkit-input-placeholder {
    color: ${rR.GrayText};
  }
`;function appearanceBehavior(t,o){return new PropertyStyleSheetBehavior("appearance",t,o)}const KM=Breadcrumb.compose({baseName:"breadcrumb",template:(t,o)=>html`
    <template role="navigation">
        <div role="list" class="list" part="list">
            <slot
                ${slotted({property:"slottedBreadcrumbItems",filter:elements()})}
            ></slot>
        </div>
    </template>
`,styles:(t,o)=>css`
  ${display("inline-block")} :host {
    box-sizing: border-box;
    ${IM};
  }

  .list {
    display: flex;
  }
`}),WM=BreadcrumbItem.compose({baseName:"breadcrumb-item",template:(t,o)=>html`
    <div role="listitem" class="listitem" part="listitem">
        ${when((t=>t.href&&t.href.length>0),html`
                ${((t,o)=>html`
    <a
        class="control"
        part="control"
        download="${t=>t.download}"
        href="${t=>t.href}"
        hreflang="${t=>t.hreflang}"
        ping="${t=>t.ping}"
        referrerpolicy="${t=>t.referrerpolicy}"
        rel="${t=>t.rel}"
        target="${t=>t.target}"
        type="${t=>t.type}"
        aria-atomic="${t=>t.ariaAtomic}"
        aria-busy="${t=>t.ariaBusy}"
        aria-controls="${t=>t.ariaControls}"
        aria-current="${t=>t.ariaCurrent}"
        aria-describedby="${t=>t.ariaDescribedby}"
        aria-details="${t=>t.ariaDetails}"
        aria-disabled="${t=>t.ariaDisabled}"
        aria-errormessage="${t=>t.ariaErrormessage}"
        aria-expanded="${t=>t.ariaExpanded}"
        aria-flowto="${t=>t.ariaFlowto}"
        aria-haspopup="${t=>t.ariaHaspopup}"
        aria-hidden="${t=>t.ariaHidden}"
        aria-invalid="${t=>t.ariaInvalid}"
        aria-keyshortcuts="${t=>t.ariaKeyshortcuts}"
        aria-label="${t=>t.ariaLabel}"
        aria-labelledby="${t=>t.ariaLabelledby}"
        aria-live="${t=>t.ariaLive}"
        aria-owns="${t=>t.ariaOwns}"
        aria-relevant="${t=>t.ariaRelevant}"
        aria-roledescription="${t=>t.ariaRoledescription}"
        ${ref("control")}
    >
        ${startSlotTemplate(0,o)}
        <span class="content" part="content">
            <slot ${slotted("defaultSlottedContent")}></slot>
        </span>
        ${endSlotTemplate(0,o)}
    </a>
`)(0,o)}
            `)}
        ${when((t=>!t.href),html`
                ${startSlotTemplate(0,o)}
                <slot></slot>
                ${endSlotTemplate(0,o)}
            `)}
        ${when((t=>t.separator),html`
                <span class="separator" part="separator" aria-hidden="true">
                    <slot name="separator">${o.separator||""}</slot>
                </span>
            `)}
    </div>
`,styles:(t,o)=>css`
    ${display("inline-flex")} :host {
      background: transparent;
      color: ${QN};
      fill: currentcolor;
      box-sizing: border-box;
      ${IM};
      min-width: calc(${RM} * 1px);
      border-radius: calc(${fO} * 1px);
    }

    .listitem {
      display: flex;
      align-items: center;
      border-radius: inherit;
    }

    .control {
      position: relative;
      align-items: center;
      box-sizing: border-box;
      color: inherit;
      fill: inherit;
      cursor: pointer;
      display: flex;
      outline: none;
      text-decoration: none;
      white-space: nowrap;
      border-radius: inherit;
    }

    .control:hover {
      color: ${YN};
    }

    .control:active {
      color: ${JN};
    }

    .control:${VR} {
      ${PM}
    }

    :host(:not([href])),
    :host([aria-current]) .control {
      color: ${QN};
      fill: currentcolor;
      cursor: default;
    }

    .start {
      display: flex;
      margin-inline-end: 6px;
    }

    .end {
      display: flex;
      margin-inline-start: 6px;
    }

    .separator {
      display: flex;
    }
  `.withBehaviors(qR(css`
        :host(:not([href])),
        .start,
        .end,
        .separator {
          background: ${rR.ButtonFace};
          color: ${rR.ButtonText};
          fill: currentcolor;
        }
        .separator {
          fill: ${rR.ButtonText};
        }
        :host([href]) {
          forced-color-adjust: none;
          background: ${rR.ButtonFace};
          color: ${rR.LinkText};
        }
        :host([href]) .control:hover {
          background: ${rR.LinkText};
          color: ${rR.HighlightText};
          fill: currentcolor;
        }
        .control:${VR} {
          outline-color: ${rR.LinkText};
        }
      `)),shadowOptions:{delegatesFocus:!0},separator:'\n    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">\n      <path d="M4.65 2.15a.5.5 0 000 .7L7.79 6 4.65 9.15a.5.5 0 10.7.7l3.5-3.5a.5.5 0 000-.7l-3.5-3.5a.5.5 0 00-.7 0z"/>\n    </svg>\n  '}),QM=":not([disabled])",YM="[disabled]";class Button extends Button$1{appearanceChanged(t,o){t!==o&&(this.classList.add(o),this.classList.remove(t))}connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="neutral")}defaultSlottedContentChanged(){const t=this.defaultSlottedContent.filter((t=>t.nodeType===Node.ELEMENT_NODE));1===t.length&&t[0]instanceof SVGElement?this.control.classList.add("icon-only"):this.control.classList.remove("icon-only")}}__decorate$z([attr],Button.prototype,"appearance",void 0);const JM=Button.compose({baseName:"button",baseClass:Button$1,template:(t,o)=>html`
    <button
        class="control"
        part="control"
        ?autofocus="${t=>t.autofocus}"
        ?disabled="${t=>t.disabled}"
        form="${t=>t.formId}"
        formaction="${t=>t.formaction}"
        formenctype="${t=>t.formenctype}"
        formmethod="${t=>t.formmethod}"
        formnovalidate="${t=>t.formnovalidate}"
        formtarget="${t=>t.formtarget}"
        name="${t=>t.name}"
        type="${t=>t.type}"
        value="${t=>t.value}"
        aria-atomic="${t=>t.ariaAtomic}"
        aria-busy="${t=>t.ariaBusy}"
        aria-controls="${t=>t.ariaControls}"
        aria-current="${t=>t.ariaCurrent}"
        aria-describedby="${t=>t.ariaDescribedby}"
        aria-details="${t=>t.ariaDetails}"
        aria-disabled="${t=>t.ariaDisabled}"
        aria-errormessage="${t=>t.ariaErrormessage}"
        aria-expanded="${t=>t.ariaExpanded}"
        aria-flowto="${t=>t.ariaFlowto}"
        aria-haspopup="${t=>t.ariaHaspopup}"
        aria-hidden="${t=>t.ariaHidden}"
        aria-invalid="${t=>t.ariaInvalid}"
        aria-keyshortcuts="${t=>t.ariaKeyshortcuts}"
        aria-label="${t=>t.ariaLabel}"
        aria-labelledby="${t=>t.ariaLabelledby}"
        aria-live="${t=>t.ariaLive}"
        aria-owns="${t=>t.ariaOwns}"
        aria-pressed="${t=>t.ariaPressed}"
        aria-relevant="${t=>t.ariaRelevant}"
        aria-roledescription="${t=>t.ariaRoledescription}"
        ${ref("control")}
    >
        ${startSlotTemplate(0,o)}
        <span class="content" part="content">
            <slot ${slotted("defaultSlottedContent")}></slot>
        </span>
        ${endSlotTemplate(0,o)}
    </button>
`,styles:(t,o)=>css`
    :host(${QM}) .control {
      cursor: pointer;
    }

    :host(${YM}) .control {
      cursor: ${jR};
    }

    @media (forced-colors: none) {
      :host(${YM}) .control {
        opacity: ${cO};
      }
    }

    ${css`
    ${display("inline-flex")}
    
    :host {
      position: relative;
      box-sizing: border-box;
      ${IM}
      height: calc(${RM} * 1px);
      min-width: calc(${RM} * 1px);
      color: ${QN};
      border-radius: calc(${fO} * 1px);
      fill: currentcolor;
    }

    .control {
      border: calc(${vO} * 1px) solid transparent;
      flex-grow: 1;
      box-sizing: border-box;
      display: inline-flex;
      justify-content: center;
      align-items: center;
      padding: 0 calc((10 + (${pO} * 2 * ${hO})) * 1px);
      white-space: nowrap;
      outline: none;
      text-decoration: none;
      color: inherit;
      border-radius: inherit;
      fill: inherit;
      font-family: inherit;
    }

    .control,
    .end,
    .start {
      font: inherit;
    }

    .control.icon-only {
      padding: 0;
      line-height: 0;
    }

    .control:${VR} {
      ${AM}
    }

    .control::-moz-focus-inner {
      border: 0;
    }

    .content {
      pointer-events: none;
    }

    .start,
    .end {
      display: flex;
      pointer-events: none;
    }

    .start {
      margin-inline-end: 11px;
    }

    .end {
      margin-inline-start: 11px;
    }
  `}
  `.withBehaviors(appearanceBehavior("neutral",((t,o,s,l="[disabled]")=>css`
    .control {
      background: padding-box linear-gradient(${kN}, ${kN}),
        border-box ${iM};
    }

    :host(${s}:hover) .control {
      background: padding-box linear-gradient(${TN}, ${TN}),
        border-box ${sM};
    }

    :host(${s}:active) .control {
      background: padding-box linear-gradient(${SN}, ${SN}),
        border-box ${aM};
    }

    :host(${l}) .control {
      background: padding-box linear-gradient(${kN}, ${kN}),
        border-box ${tM};
    }
  `.withBehaviors(qR(css`
        .control {
          background: ${rR.ButtonFace};
          border-color: ${rR.ButtonText};
          color: ${rR.ButtonText};
        }

        :host(${s}:hover) .control,
        :host(${s}:active) .control {
          forced-color-adjust: none;
          background: ${rR.HighlightText};
          border-color: ${rR.Highlight};
          color: ${rR.Highlight};
        }

        :host(${l}) .control {
          background: transparent;
          border-color: ${rR.GrayText};
          color: ${rR.GrayText};
        }

        .control:${VR} {
          outline-color: ${rR.CanvasText};
        }

        :host([href]) .control {
          background: transparent;
          border-color: ${rR.LinkText};
          color: ${rR.LinkText};
        }

        :host([href]:hover) .control,
        :host([href]:active) .control {
          background: transparent;
          border-color: ${rR.CanvasText};
          color: ${rR.CanvasText};
        }
    `)))(0,0,QM,YM)),appearanceBehavior("accent",((t,o,s,l="[disabled]")=>css`
    .control {
      background: padding-box linear-gradient(${sN}, ${sN}),
        border-box ${yN};
      color: ${uN};
    }

    :host(${s}:hover) .control {
      background: padding-box linear-gradient(${aN}, ${aN}),
        border-box ${wN};
      color: ${hN};
    }

    :host(${s}:active) .control {
      background: padding-box linear-gradient(${lN}, ${lN}),
        border-box ${_N};
      color: ${pN};
    }

    :host(${l}) .control {
      background: ${sN};
    }

    .control:${VR} {
      box-shadow: 0 0 0 calc(${mO} * 1px) ${_M} inset !important;
    }
  `.withBehaviors(qR(css`
        .control {
          forced-color-adjust: none;
          background: ${rR.Highlight};
          color: ${rR.HighlightText};
        }

        :host(${s}:hover) .control,
        :host(${s}:active) .control {
          background: ${rR.HighlightText};
          border-color: ${rR.Highlight};
          color: ${rR.Highlight};
        }

        :host(${l}) .control {
          background: transparent;
          border-color: ${rR.GrayText};
          color: ${rR.GrayText};
        }

        .control:${VR} {
          outline-color: ${rR.CanvasText};
          box-shadow: 0 0 0 calc(${mO} * 1px) ${rR.HighlightText} inset !important;
        }

        :host([href]) .control {
          background: ${rR.LinkText};
          color: ${rR.HighlightText};
        }

        :host([href]:hover) .control,
        :host([href]:active) .control {
          background: ${rR.ButtonFace};
          border-color: ${rR.LinkText};
          color: ${rR.LinkText};
        }
      `)))(0,0,QM,YM)),appearanceBehavior("lightweight",((t,o,s,l="[disabled]")=>css`
    :host {
      color: ${gN};
    }

    .control {
      background: ${jN};
    }

    :host(${s}:hover) .control {
      background: ${zN};
      color: ${vN};
    }

    :host(${s}:active) .control {
      background: ${VN};
      color: ${mN};
    }

    :host(${l}) .control {
      background: ${jN};
    }
  `.withBehaviors(qR(css`
        :host {
          color: ${rR.ButtonText};
        }

        .control {
          forced-color-adjust: none;
          background: transparent;
        }

        :host(${s}:hover) .control,
        :host(${s}:active) .control {
          background: transparent;
          border-color: ${rR.ButtonText};
          color: ${rR.ButtonText};
        }

        :host(${l}) .control {
          background: transparent;
          color: ${rR.GrayText};
        }

        .control:${VR} {
          outline-color: ${rR.CanvasText};
        }

        :host([href]) .control {
          color: ${rR.LinkText};
        }

        :host([href]:hover) .control,
        :host([href]:active) .control {
          border-color: ${rR.LinkText};
          color: ${rR.LinkText};
        }
      `)))(0,0,QM,YM)),appearanceBehavior("outline",((t,o,s,l="[disabled]")=>css`
    .control {
      background: transparent !important;
      border-color: ${tM};
    }

    :host(${s}:hover) .control {
      border-color: ${rM};
    }

    :host(${s}:active) .control {
      border-color: ${oM};
    }

    :host(${l}) .control {
      background: transparent !important;
      border-color: ${tM};
    }
  `.withBehaviors(qR(css`
        .control {
          border-color: ${rR.ButtonText};
          color: ${rR.ButtonText};
        }

        :host(${s}:hover) .control,
        :host(${s}:active) .control {
          background: ${rR.HighlightText};
          border-color: ${rR.Highlight};
          color: ${rR.Highlight};
        }

        :host(${l}) .control {
          border-color: ${rR.GrayText};
          color: ${rR.GrayText};
        }

        .control:${VR} {
          outline-color: ${rR.CanvasText};
        }

        :host([href]) .control {
          border-color: ${rR.LinkText};
          color: ${rR.LinkText};
        }

        :host([href]:hover) .control,
        :host([href]:active) .control {
          border-color: ${rR.CanvasText};
          color: ${rR.CanvasText};
        }
      `)))(0,0,QM,YM)),appearanceBehavior("stealth",((t,o,s,l="[disabled]")=>css`
    .control {
      background: ${jN};
    }

    :host(${s}:hover) .control {
      background: ${zN};
    }

    :host(${s}:active) .control {
      background: ${VN};
    }

    :host(${l}) .control {
      background: ${jN};
    }
  `.withBehaviors(qR(css`
        .control {
          forced-color-adjust: none;
          background: transparent;
          color: ${rR.ButtonText};
        }

        :host(${s}:hover) .control,
        :host(${s}:active) .control {
          background: transparent;
          border-color: ${rR.ButtonText};
          color: ${rR.ButtonText};
        }

        :host(${l}) .control {
          background: transparent;
          color: ${rR.GrayText};
        }
        
        .control:${VR} {
          outline-color: ${rR.CanvasText};
        }

        :host([href]) .control {
          color: ${rR.LinkText};
        }

        :host([href]:hover) .control,
        :host([href]:active) .control {
          background: transparent;
          border-color: ${rR.LinkText};
          color: ${rR.LinkText};
        }
      `)))(0,0,QM,YM))),shadowOptions:{delegatesFocus:!0}});class Card extends Card$1{cardFillColorChanged(t,o){if(o){const t=parseColorHexRGB(o);null!==t&&(this.neutralPaletteSource=o,oN.setValueFor(this,QR.create(t.r,t.g,t.b)))}}neutralPaletteSourceChanged(t,o){if(o){const t=parseColorHexRGB(o),s=QR.create(t.r,t.g,t.b);G$.setValueFor(this,XR.create(s))}}handleChange(t,o){this.cardFillColor||oN.setValueFor(this,(o=>MN.getValueFor(o).evaluate(o,oN.getValueFor(t)).rest))}connectedCallback(){super.connectedCallback();const t=composedParent(this);if(t){const o=iP.getNotifier(t);o.subscribe(this,"fillColor"),o.subscribe(this,"neutralPalette"),this.handleChange(t,"fillColor")}}}__decorate$z([attr({attribute:"card-fill-color",mode:"fromView"})],Card.prototype,"cardFillColor",void 0),__decorate$z([attr({attribute:"neutral-palette-source",mode:"fromView"})],Card.prototype,"neutralPaletteSource",void 0);const XM=Card.compose({baseName:"card",baseClass:Card$1,template:(t,o)=>html`
    <slot></slot>
`,styles:(t,o)=>css`
    ${display("block")} :host {
      display: block;
      contain: content;
      height: var(--card-height, 100%);
      width: var(--card-width, 100%);
      box-sizing: border-box;
      background: ${oN};
      color: ${QN};
      border: calc(${vO} * 1px) solid ${pM};
      border-radius: calc(${gO} * 1px);
      box-shadow: ${LM};
    }

    :host {
      content-visibility: auto;
    }
  `.withBehaviors(qR(css`
        :host {
          background: ${rR.Canvas};
          color: ${rR.CanvasText};
        }
      `))}),ZM=Checkbox.compose({baseName:"checkbox",template:(t,o)=>html`
    <template
        role="checkbox"
        aria-checked="${t=>t.checked}"
        aria-required="${t=>t.required}"
        aria-disabled="${t=>t.disabled}"
        aria-readonly="${t=>t.readOnly}"
        tabindex="${t=>t.disabled?null:0}"
        @keypress="${(t,o)=>t.keypressHandler(o.event)}"
        @click="${(t,o)=>t.clickHandler(o.event)}"
        class="${t=>t.readOnly?"readonly":""} ${t=>t.checked?"checked":""} ${t=>t.indeterminate?"indeterminate":""}"
    >
        <div part="control" class="control">
            <slot name="checked-indicator">
                ${o.checkedIndicator||""}
            </slot>
            <slot name="indeterminate-indicator">
                ${o.indeterminateIndicator||""}
            </slot>
        </div>
        <label
            part="label"
            class="${t=>t.defaultSlottedNodes&&t.defaultSlottedNodes.length?"label":"label label__hidden"}"
        >
            <slot ${slotted("defaultSlottedNodes")}></slot>
        </label>
    </template>
`,styles:(t,o)=>css`
    ${display("inline-flex")} :host {
      align-items: center;
      outline: none;
      ${""} user-select: none;
    }

    .control {
      position: relative;
      width: calc((${RM} / 2 + ${pO}) * 1px);
      height: calc((${RM} / 2 + ${pO}) * 1px);
      box-sizing: border-box;
      border-radius: calc(${fO} * 1px);
      border: calc(${vO} * 1px) solid ${gM};
      background: ${RN};
      cursor: pointer;
    }

    .label__hidden {
      display: none;
      visibility: hidden;
    }

    .label {
      ${IM}
      color: ${QN};
      ${""} padding-inline-start: calc(${pO} * 2px + 2px);
      margin-inline-end: calc(${pO} * 2px + 2px);
      cursor: pointer;
    }

    slot[name='checked-indicator'],
    slot[name='indeterminate-indicator'] {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      height: 100%;
      fill: ${QN};
      opacity: 0;
      pointer-events: none;
    }

    slot[name='indeterminate-indicator'] {
      position: absolute;
      top: 0;
    }

    :host(.checked) slot[name='checked-indicator'],
    :host(.checked) slot[name='indeterminate-indicator'] {
      fill: ${uN};
    }

    :host(:not(.disabled):hover) .control {
      background: ${ON};
      border-color: ${vM};
    }

    :host(:not(.disabled):active) .control {
      background: ${$N};
      border-color: ${mM};
    }

    :host(:${VR}) .control {
      background: ${NN};
      ${PM}
    }

    :host(.checked) .control {
      background: ${sN};
      border-color: transparent;
    }

    :host(.checked:not(.disabled):hover) .control {
      background: ${aN};
      border-color: transparent;
    }

    :host(.checked:not(.disabled):active) .control {
      background: ${lN};
      border-color: transparent;
    }

    :host(.disabled) .label,
    :host(.readonly) .label,
    :host(.readonly) .control,
    :host(.disabled) .control {
      cursor: ${jR};
    }

    :host(.checked:not(.indeterminate)) slot[name='checked-indicator'],
    :host(.indeterminate) slot[name='indeterminate-indicator'] {
      opacity: 1;
    }

    :host(.disabled) {
      opacity: ${cO};
    }
  `.withBehaviors(qR(css`
        .control {
          border-color: ${rR.FieldText};
          background: ${rR.Field};
        }
        :host(:not(.disabled):hover) .control,
        :host(:not(.disabled):active) .control {
          border-color: ${rR.Highlight};
          background: ${rR.Field};
        }
        slot[name='checked-indicator'],
        slot[name='indeterminate-indicator'] {
          fill: ${rR.FieldText};
        }
        :host(:${VR}) .control {
          forced-color-adjust: none;
          outline-color: ${rR.FieldText};
          background: ${rR.Field};
          border-color: ${rR.Highlight};
        }
        :host(.checked) .control {
          background: ${rR.Highlight};
          border-color: ${rR.Highlight};
        }
        :host(.checked:not(.disabled):hover) .control,
        :host(.checked:not(.disabled):active) .control {
          background: ${rR.HighlightText};
          border-color: ${rR.Highlight};
        }
        :host(.checked) slot[name='checked-indicator'],
        :host(.checked) slot[name='indeterminate-indicator'] {
          fill: ${rR.HighlightText};
        }
        :host(.checked:hover ) .control slot[name='checked-indicator'],
        :host(.checked:hover ) .control slot[name='indeterminate-indicator'] {
          fill: ${rR.Highlight};
        }
        :host(.disabled) {
          opacity: 1;
        }
        :host(.disabled) .control {
          border-color: ${rR.GrayText};
          background: ${rR.Field};
        }
        :host(.disabled) slot[name='checked-indicator'],
        :host(.checked.disabled:hover) .control slot[name='checked-indicator'],
        :host(.disabled) slot[name='indeterminate-indicator'],
        :host(.checked.disabled:hover) .control slot[name='indeterminate-indicator'] {
          fill: ${rR.GrayText};
        }
      `)),checkedIndicator:'\n    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n      <path d="M13.86 3.66a.5.5 0 01-.02.7l-7.93 7.48a.6.6 0 01-.84-.02L2.4 9.1a.5.5 0 01.72-.7l2.4 2.44 7.65-7.2a.5.5 0 01.7.02z"/>\n    </svg>\n  ',indeterminateIndicator:'\n    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n      <path d="M3 8c0-.28.22-.5.5-.5h9a.5.5 0 010 1h-9A.5.5 0 013 8z"/>\n    </svg>\n  '}),eD=".control",tD=":not([disabled]):not([open])";class Combobox extends Combobox$1{appearanceChanged(t,o){t!==o&&(this.classList.add(o),this.classList.remove(t))}connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="outline"),this.listbox&&oN.setValueFor(this.listbox,J$)}}__decorate$z([attr({mode:"fromView"})],Combobox.prototype,"appearance",void 0);const rD=Combobox.compose({baseName:"combobox",baseClass:Combobox$1,shadowOptions:{delegatesFocus:!0},template:(t,o)=>html`
    <template
        aria-disabled="${t=>t.ariaDisabled}"
        autocomplete="${t=>t.autocomplete}"
        class="${t=>t.open?"open":""} ${t=>t.disabled?"disabled":""} ${t=>t.position}"
        ?open="${t=>t.open}"
        tabindex="${t=>t.disabled?null:"0"}"
        @click="${(t,o)=>t.clickHandler(o.event)}"
        @focusout="${(t,o)=>t.focusoutHandler(o.event)}"
        @keydown="${(t,o)=>t.keydownHandler(o.event)}"
    >
        <div class="control" part="control">
            ${startSlotTemplate(0,o)}
            <slot name="control">
                <input
                    aria-activedescendant="${t=>t.open?t.ariaActiveDescendant:null}"
                    aria-autocomplete="${t=>t.ariaAutoComplete}"
                    aria-controls="${t=>t.ariaControls}"
                    aria-disabled="${t=>t.ariaDisabled}"
                    aria-expanded="${t=>t.ariaExpanded}"
                    aria-haspopup="listbox"
                    class="selected-value"
                    part="selected-value"
                    placeholder="${t=>t.placeholder}"
                    role="combobox"
                    type="text"
                    ?disabled="${t=>t.disabled}"
                    :value="${t=>t.value}"
                    @input="${(t,o)=>t.inputHandler(o.event)}"
                    @keyup="${(t,o)=>t.keyupHandler(o.event)}"
                    ${ref("control")}
                />
                <div class="indicator" part="indicator" aria-hidden="true">
                    <slot name="indicator">
                        ${o.indicator||""}
                    </slot>
                </div>
            </slot>
            ${endSlotTemplate(0,o)}
        </div>
        <div
            class="listbox"
            id="${t=>t.listboxId}"
            part="listbox"
            role="listbox"
            ?disabled="${t=>t.disabled}"
            ?hidden="${t=>!t.open}"
            ${ref("listbox")}
        >
            <slot
                ${slotted({filter:Listbox$1.slottedOptionFilter,flatten:!0,property:"slottedOptions"})}
            ></slot>
        </div>
    </template>
`,styles:(t,o)=>css`
    ${css`
    ${display("inline-flex")}
    
    :host {
      border-radius: calc(${fO} * 1px);
      box-sizing: border-box;
      color: ${QN};
      fill: currentcolor;
      font-family: ${bO};
      position: relative;
      user-select: none;
      min-width: 250px;
      vertical-align: top;
    }

    .listbox {
      box-shadow: ${BM};
      background: ${oN};
      border-radius: calc(${gO} * 1px);
      box-sizing: border-box;
      display: inline-flex;
      flex-direction: column;
      left: 0;
      max-height: calc(var(--max-height) - (${RM} * 1px));
      padding: calc((${pO} - ${vO} ) * 1px);
      overflow-y: auto;
      position: absolute;
      width: 100%;
      z-index: 1;
      margin: 1px 0;
      border: calc(${vO} * 1px) solid transparent;
    }

    .listbox[hidden] {
      display: none;
    }

    .control {
      border: calc(${vO} * 1px) solid transparent;
      border-radius: calc(${fO} * 1px);
      height: calc(${RM} * 1px);
      align-items: center;
      box-sizing: border-box;
      cursor: pointer;
      display: flex;
      ${IM}
      min-height: 100%;
      padding: 0 calc(${pO} * 2.25px);
      width: 100%;
    }

    :host(:${VR}) {
      ${AM}
    }

    :host([disabled]) .control {
      cursor: ${jR};
      opacity: ${cO};
      user-select: none;
    }

    :host([open][position='above']) .listbox {
      bottom: calc((${RM} + ${pO} * 2) * 1px);
    }

    :host([open][position='below']) .listbox {
      top: calc((${RM} + ${pO} * 2) * 1px);
    }

    .selected-value {
      font-family: inherit;
      flex: 1 1 auto;
      text-align: start;
    }

    .indicator {
      flex: 0 0 auto;
      margin-inline-start: 1em;
    }

    slot[name='listbox'] {
      display: none;
      width: 100%;
    }

    :host([open]) slot[name='listbox'] {
      display: flex;
      position: absolute;
    }

    .start {
      margin-inline-end: 11px;
    }

    .end {
      margin-inline-start: 11px;
    }

    .start,
    .end,
    .indicator,
    ::slotted(svg) {
      display: flex;
    }

    ::slotted([role='option']) {
      flex: 0 0 auto;
    }
  `}

    ${inputStateStyles()}

    :host(:empty) .listbox {
      display: none;
    }

    :host([disabled]) *,
    :host([disabled]) {
      cursor: ${jR};
      user-select: none;
    }

    :host(:active) .selected-value {
      user-select: none;
    }

    .selected-value {
      -webkit-appearance: none;
      background: transparent;
      border: none;
      color: inherit;
      ${IM}
      height: calc(100% - ${vO} * 1px));
      margin: auto 0;
      width: 100%;
      outline: none;
    }
  `.withBehaviors(appearanceBehavior("outline",inputOutlineStyles(0,0,eD,tD)),appearanceBehavior("filled",inputFilledStyles(0,0,eD,tD)),qR(inputForcedColorStyles(0,0,eD,tD))),indicator:'\n    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">\n      <path d="M2.15 4.65c.2-.2.5-.2.7 0L6 7.79l3.15-3.14a.5.5 0 11.7.7l-3.5 3.5a.5.5 0 01-.7 0l-3.5-3.5a.5.5 0 010-.7z"/>\n    </svg>\n  '}),oD={toView(t){var o;return null==t?null:null===(o=t)||void 0===o?void 0:o.toColorString()},fromView(t){if(null==t)return null;const o=parseColorHexRGB(t);return o?QR.create(o.r,o.g,o.b):null}},nD=css`
  :host {
    background-color: ${oN};
    color: ${QN};
  }
`.withBehaviors(qR(css`
      :host {
        background-color: ${rR.Canvas};
        box-shadow: 0 0 0 1px ${rR.CanvasText};
        color: ${rR.CanvasText};
      }
    `));function designToken(t){return(o,s)=>{o[s+"Changed"]=function(o,s){null!=s?t.setValueFor(this,s):t.deleteValueFor(this)}}}class DesignSystemProvider extends FoundationElement{constructor(){super(),this.noPaint=!1;const t={handleChange:this.noPaintChanged.bind(this)};iP.getNotifier(this).subscribe(t,"fillColor"),iP.getNotifier(this).subscribe(t,"baseLayerLuminance")}connectedCallback(){super.connectedCallback(),this.noPaintChanged()}noPaintChanged(){this.noPaint||void 0===this.fillColor&&!this.baseLayerLuminance?this.$fastController.removeStyles(nD):this.$fastController.addStyles(nD)}}__decorate$z([attr({attribute:"no-paint",mode:"boolean"})],DesignSystemProvider.prototype,"noPaint",void 0),__decorate$z([attr({attribute:"fill-color",converter:oD,mode:"fromView"}),designToken(oN)],DesignSystemProvider.prototype,"fillColor",void 0),__decorate$z([attr({attribute:"accent-base-color",converter:oD,mode:"fromView"}),designToken(K$)],DesignSystemProvider.prototype,"accentBaseColor",void 0),__decorate$z([attr({attribute:"neutral-base-color",converter:oD,mode:"fromView"}),designToken(V$)],DesignSystemProvider.prototype,"neutralBaseColor",void 0),__decorate$z([attr({converter:gP}),designToken(hO)],DesignSystemProvider.prototype,"density",void 0),__decorate$z([attr({attribute:"design-unit",converter:gP}),designToken(pO)],DesignSystemProvider.prototype,"designUnit",void 0),__decorate$z([attr({attribute:"direction"}),designToken(lO)],DesignSystemProvider.prototype,"direction",void 0),__decorate$z([attr({attribute:"base-height-multiplier",converter:gP}),designToken(dO)],DesignSystemProvider.prototype,"baseHeightMultiplier",void 0),__decorate$z([attr({attribute:"base-horizontal-spacing-multiplier",converter:gP}),designToken(uO)],DesignSystemProvider.prototype,"baseHorizontalSpacingMultiplier",void 0),__decorate$z([attr({attribute:"control-corner-radius",converter:gP}),designToken(fO)],DesignSystemProvider.prototype,"controlCornerRadius",void 0),__decorate$z([attr({attribute:"layer-corner-radius",converter:gP}),designToken(gO)],DesignSystemProvider.prototype,"layerCornerRadius",void 0),__decorate$z([attr({attribute:"stroke-width",converter:gP}),designToken(vO)],DesignSystemProvider.prototype,"strokeWidth",void 0),__decorate$z([attr({attribute:"focus-stroke-width",converter:gP}),designToken(mO)],DesignSystemProvider.prototype,"focusStrokeWidth",void 0),__decorate$z([attr({attribute:"disabled-opacity",converter:gP}),designToken(cO)],DesignSystemProvider.prototype,"disabledOpacity",void 0),__decorate$z([attr({attribute:"type-ramp-minus-2-font-size"}),designToken(xO)],DesignSystemProvider.prototype,"typeRampMinus2FontSize",void 0),__decorate$z([attr({attribute:"type-ramp-minus-2-line-height"}),designToken(EO)],DesignSystemProvider.prototype,"typeRampMinus2LineHeight",void 0),__decorate$z([attr({attribute:"type-ramp-minus-1-font-size"}),designToken(kO)],DesignSystemProvider.prototype,"typeRampMinus1FontSize",void 0),__decorate$z([attr({attribute:"type-ramp-minus-1-line-height"}),designToken(TO)],DesignSystemProvider.prototype,"typeRampMinus1LineHeight",void 0),__decorate$z([attr({attribute:"type-ramp-base-font-size"}),designToken(wO)],DesignSystemProvider.prototype,"typeRampBaseFontSize",void 0),__decorate$z([attr({attribute:"type-ramp-base-line-height"}),designToken(_O)],DesignSystemProvider.prototype,"typeRampBaseLineHeight",void 0),__decorate$z([attr({attribute:"type-ramp-plus-1-font-size"}),designToken(AO)],DesignSystemProvider.prototype,"typeRampPlus1FontSize",void 0),__decorate$z([attr({attribute:"type-ramp-plus-1-line-height"}),designToken(PO)],DesignSystemProvider.prototype,"typeRampPlus1LineHeight",void 0),__decorate$z([attr({attribute:"type-ramp-plus-2-font-size"}),designToken(OO)],DesignSystemProvider.prototype,"typeRampPlus2FontSize",void 0),__decorate$z([attr({attribute:"type-ramp-plus-2-line-height"}),designToken($O)],DesignSystemProvider.prototype,"typeRampPlus2LineHeight",void 0),__decorate$z([attr({attribute:"type-ramp-plus-3-font-size"}),designToken(MO)],DesignSystemProvider.prototype,"typeRampPlus3FontSize",void 0),__decorate$z([attr({attribute:"type-ramp-plus-3-line-height"}),designToken(DO)],DesignSystemProvider.prototype,"typeRampPlus3LineHeight",void 0),__decorate$z([attr({attribute:"type-ramp-plus-4-font-size"}),designToken(FO)],DesignSystemProvider.prototype,"typeRampPlus4FontSize",void 0),__decorate$z([attr({attribute:"type-ramp-plus-4-line-height"}),designToken(UO)],DesignSystemProvider.prototype,"typeRampPlus4LineHeight",void 0),__decorate$z([attr({attribute:"type-ramp-plus-5-font-size"}),designToken(BO)],DesignSystemProvider.prototype,"typeRampPlus5FontSize",void 0),__decorate$z([attr({attribute:"type-ramp-plus-5-line-height"}),designToken(qO)],DesignSystemProvider.prototype,"typeRampPlus5LineHeight",void 0),__decorate$z([attr({attribute:"type-ramp-plus-6-font-size"}),designToken(zO)],DesignSystemProvider.prototype,"typeRampPlus6FontSize",void 0),__decorate$z([attr({attribute:"type-ramp-plus-6-line-height"}),designToken(VO)],DesignSystemProvider.prototype,"typeRampPlus6LineHeight",void 0),__decorate$z([attr({attribute:"accent-fill-rest-delta",converter:gP}),designToken(WO)],DesignSystemProvider.prototype,"accentFillRestDelta",void 0),__decorate$z([attr({attribute:"accent-fill-hover-delta",converter:gP}),designToken(QO)],DesignSystemProvider.prototype,"accentFillHoverDelta",void 0),__decorate$z([attr({attribute:"accent-fill-active-delta",converter:gP}),designToken(YO)],DesignSystemProvider.prototype,"accentFillActiveDelta",void 0),__decorate$z([attr({attribute:"accent-fill-focus-delta",converter:gP}),designToken(JO)],DesignSystemProvider.prototype,"accentFillFocusDelta",void 0),__decorate$z([attr({attribute:"accent-foreground-rest-delta",converter:gP}),designToken(XO)],DesignSystemProvider.prototype,"accentForegroundRestDelta",void 0),__decorate$z([attr({attribute:"accent-foreground-hover-delta",converter:gP}),designToken(ZO)],DesignSystemProvider.prototype,"accentForegroundHoverDelta",void 0),__decorate$z([attr({attribute:"accent-foreground-active-delta",converter:gP}),designToken(e$)],DesignSystemProvider.prototype,"accentForegroundActiveDelta",void 0),__decorate$z([attr({attribute:"accent-foreground-focus-delta",converter:gP}),designToken(t$)],DesignSystemProvider.prototype,"accentForegroundFocusDelta",void 0),__decorate$z([attr({attribute:"neutral-fill-rest-delta",converter:gP}),designToken(r$)],DesignSystemProvider.prototype,"neutralFillRestDelta",void 0),__decorate$z([attr({attribute:"neutral-fill-hover-delta",converter:gP}),designToken(o$)],DesignSystemProvider.prototype,"neutralFillHoverDelta",void 0),__decorate$z([attr({attribute:"neutral-fill-active-delta",converter:gP}),designToken(n$)],DesignSystemProvider.prototype,"neutralFillActiveDelta",void 0),__decorate$z([attr({attribute:"neutral-fill-focus-delta",converter:gP}),designToken(i$)],DesignSystemProvider.prototype,"neutralFillFocusDelta",void 0),__decorate$z([attr({attribute:"neutral-fill-input-rest-delta",converter:gP}),designToken(s$)],DesignSystemProvider.prototype,"neutralFillInputRestDelta",void 0),__decorate$z([attr({attribute:"neutral-fill-input-hover-delta",converter:gP}),designToken(a$)],DesignSystemProvider.prototype,"neutralFillInputHoverDelta",void 0),__decorate$z([attr({attribute:"neutral-fill-input-active-delta",converter:gP}),designToken(l$)],DesignSystemProvider.prototype,"neutralFillInputActiveDelta",void 0),__decorate$z([attr({attribute:"neutral-fill-input-focus-delta",converter:gP}),designToken(c$)],DesignSystemProvider.prototype,"neutralFillInputFocusDelta",void 0),__decorate$z([attr({attribute:"neutral-fill-layer-rest-delta",converter:gP}),designToken(f$)],DesignSystemProvider.prototype,"neutralFillLayerRestDelta",void 0),__decorate$z([attr({attribute:"neutral-fill-stealth-rest-delta",converter:gP}),designToken(C$)],DesignSystemProvider.prototype,"neutralFillStealthRestDelta",void 0),__decorate$z([attr({attribute:"neutral-fill-stealth-hover-delta",converter:gP}),designToken(k$)],DesignSystemProvider.prototype,"neutralFillStealthHoverDelta",void 0),__decorate$z([attr({attribute:"neutral-fill-stealth-active-delta",converter:gP}),designToken(T$)],DesignSystemProvider.prototype,"neutralFillStealthActiveDelta",void 0),__decorate$z([attr({attribute:"neutral-fill-stealth-focus-delta",converter:gP}),designToken(S$)],DesignSystemProvider.prototype,"neutralFillStealthFocusDelta",void 0),__decorate$z([attr({attribute:"neutral-fill-strong-hover-delta",converter:gP}),designToken(E$)],DesignSystemProvider.prototype,"neutralFillStrongHoverDelta",void 0),__decorate$z([attr({attribute:"neutral-fill-strong-active-delta",converter:gP}),designToken(I$)],DesignSystemProvider.prototype,"neutralFillStrongActiveDelta",void 0),__decorate$z([attr({attribute:"neutral-fill-strong-focus-delta",converter:gP}),designToken(A$)],DesignSystemProvider.prototype,"neutralFillStrongFocusDelta",void 0),__decorate$z([attr({attribute:"base-layer-luminance",converter:gP}),designToken(KO)],DesignSystemProvider.prototype,"baseLayerLuminance",void 0),__decorate$z([attr({attribute:"neutral-stroke-divider-rest-delta",converter:gP}),designToken(F$)],DesignSystemProvider.prototype,"neutralStrokeDividerRestDelta",void 0),__decorate$z([attr({attribute:"neutral-stroke-rest-delta",converter:gP}),designToken(P$)],DesignSystemProvider.prototype,"neutralStrokeRestDelta",void 0),__decorate$z([attr({attribute:"neutral-stroke-hover-delta",converter:gP}),designToken(R$)],DesignSystemProvider.prototype,"neutralStrokeHoverDelta",void 0),__decorate$z([attr({attribute:"neutral-stroke-active-delta",converter:gP}),designToken(O$)],DesignSystemProvider.prototype,"neutralStrokeActiveDelta",void 0),__decorate$z([attr({attribute:"neutral-stroke-focus-delta",converter:gP}),designToken($$)],DesignSystemProvider.prototype,"neutralStrokeFocusDelta",void 0);const iD=DesignSystemProvider.compose({baseName:"design-system-provider",template:html` <slot></slot> `,styles:css`
    ${display("block")}
  `});const sD=class Listbox extends Listbox$1{}.compose({baseName:"listbox",template:(t,o)=>html`
    <template
        aria-activedescendant="${t=>t.ariaActiveDescendant}"
        aria-multiselectable="${t=>t.ariaMultiSelectable}"
        class="listbox"
        role="listbox"
        tabindex="${t=>t.disabled?null:"0"}"
        @click="${(t,o)=>t.clickHandler(o.event)}"
        @focusin="${(t,o)=>t.focusinHandler(o.event)}"
        @keydown="${(t,o)=>t.keydownHandler(o.event)}"
        @mousedown="${(t,o)=>t.mousedownHandler(o.event)}"
    >
        <slot
            ${slotted({filter:ListboxElement.slottedOptionFilter,flatten:!0,property:"slottedOptions"})}
        ></slot>
    </template>
`,styles:(t,o)=>css`
    ${display("inline-flex")} :host {
      border: calc(${vO} * 1px) solid ${tM};
      border-radius: calc(${fO} * 1px);
      box-sizing: border-box;
      flex-direction: column;
      padding: calc(${pO} * 1px) 0;
    }

    ::slotted(${t.tagFor(ListboxOption)}) {
      margin: 0 calc(${pO} * 1px);
    }

    :host(:focus-within:not([disabled])) {
      ${AM}
    }
  `}),aD=ListboxOption.compose({baseName:"option",template:(t,o)=>html`
    <template
        aria-checked="${t=>t.ariaChecked}"
        aria-disabled="${t=>t.ariaDisabled}"
        aria-posinset="${t=>t.ariaPosInSet}"
        aria-selected="${t=>t.ariaSelected}"
        aria-setsize="${t=>t.ariaSetSize}"
        class="${t=>[t.checked&&"checked",t.selected&&"selected",t.disabled&&"disabled"].filter(Boolean).join(" ")}"
        role="option"
    >
        ${startSlotTemplate(0,o)}
        <span class="content" part="content">
            <slot ${slotted("content")}></slot>
        </span>
        ${endSlotTemplate(0,o)}
    </template>
`,styles:(t,o)=>css`
    ${display("inline-flex")} :host {
      position: relative;
      ${IM}
      background: ${jN};
      border-radius: calc(${fO} * 1px);
      border: calc(${vO} * 1px) solid transparent;
      box-sizing: border-box;
      color: ${QN};
      cursor: pointer;
      fill: currentcolor;
      height: calc(${RM} * 1px);
      overflow: hidden;
      align-items: center;
      padding: 0 calc(((${pO} * 3) - ${vO} - 1) * 1px);
      user-select: none;
      white-space: nowrap;
    }

    :host::before {
      content: '';
      display: block;
      position: absolute;
      left: calc((${mO} - ${vO}) * 1px);
      top: calc((${RM} / 4) - ${mO} * 1px);
      width: 3px;
      height: calc((${RM} / 2) * 1px);
      background: transparent;
      border-radius: calc(${fO} * 1px);
    }

    :host(:not([disabled]):hover) {
      background: ${zN};
    }

    :host(:not([disabled]):active) {
      background: ${VN};
    }

    :host(:not([disabled]):active)::before {
      background: ${sN};
      height: calc(((${RM} / 2) - 6) * 1px);
    }

    :host([aria-selected='true'])::before {
      background: ${sN};
    }

    :host(:${VR}) {
      ${AM}
      background: ${GN};
    }

    :host([aria-selected='true']) {
      background: ${FN};
    }

    :host(:not([disabled])[aria-selected='true']:hover) {
      background: ${UN};
    }

    :host(:not([disabled])[aria-selected='true']:active) {
      background: ${HN};
    }

    :host(:not([disabled]):not([aria-selected='true']):hover) {
      background: ${zN};
    }

    :host(:not([disabled]):not([aria-selected='true']):active) {
      background: ${VN};
    }

    :host([disabled]) {
      cursor: ${jR};
      opacity: ${cO};
    }

    .content {
      grid-column-start: 2;
      justify-self: start;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .start,
    .end,
    ::slotted(svg) {
      display: flex;
    }

    ::slotted([slot='end']) {
      margin-inline-start: 1ch;
    }

    ::slotted([slot='start']) {
      margin-inline-end: 1ch;
    }
  `.withBehaviors(qR(css`
        :host {
          background: ${rR.ButtonFace};
          border-color: ${rR.ButtonFace};
          color: ${rR.ButtonText};
        }
        :host(:not([disabled]):not([aria-selected="true"]):hover),
        :host(:not([disabled])[aria-selected="true"]:hover),
        :host([aria-selected="true"]) {
          forced-color-adjust: none;
          background: ${rR.Highlight};
          color: ${rR.HighlightText};
        }
        :host(:not([disabled]):active)::before,
        :host([aria-selected='true'])::before {
          background: ${rR.HighlightText};
        }
        :host([disabled]),
        :host([disabled]:not([aria-selected='true']):hover) {
          background: ${rR.Canvas};
          color: ${rR.GrayText};
          fill: currentcolor;
          opacity: 1;
        }
        :host(:${VR}) {
          outline-color: ${rR.CanvasText};
        }
      `))});const lD=class Progress extends BaseProgress{}.compose({baseName:"progress",template:(t,o)=>html`
    <template
        role="progressbar"
        aria-valuenow="${t=>t.value}"
        aria-valuemin="${t=>t.min}"
        aria-valuemax="${t=>t.max}"
        class="${t=>t.paused?"paused":""}"
    >
        ${when((t=>"number"==typeof t.value),html`
                <div class="progress" part="progress" slot="determinate">
                    <div
                        class="determinate"
                        part="determinate"
                        style="width: ${t=>t.percentComplete}%"
                    ></div>
                </div>
            `)}
        ${when((t=>"number"!=typeof t.value),html`
                <div class="progress" part="progress" slot="indeterminate">
                    <slot class="indeterminate" name="indeterminate">
                        ${o.indeterminateIndicator1||""}
                        ${o.indeterminateIndicator2||""}
                    </slot>
                </div>
            `)}
    </template>
`,styles:(t,o)=>css`
    ${display("flex")} :host {
      align-items: center;
      height: calc((${vO} * 3) * 1px);
    }

    .progress {
      background-color: ${gM};
      border-radius: calc(${pO} * 1px);
      width: 100%;
      height: calc(${vO} * 1px);
      display: flex;
      align-items: center;
      position: relative;
    }

    .determinate {
      background-color: ${sN};
      border-radius: calc(${pO} * 1px);
      height: calc((${vO} * 3) * 1px);
      transition: all 0.2s ease-in-out;
      display: flex;
    }

    .indeterminate {
      height: calc((${vO} * 3) * 1px);
      border-radius: calc(${pO} * 1px);
      display: flex;
      width: 100%;
      position: relative;
      overflow: hidden;
    }

    .indeterminate-indicator-1 {
      position: absolute;
      opacity: 0;
      height: 100%;
      background-color: ${sN};
      border-radius: calc(${pO} * 1px);
      animation-timing-function: cubic-bezier(0.4, 0, 0.6, 1);
      width: 40%;
      animation: indeterminate-1 2s infinite;
    }

    .indeterminate-indicator-2 {
      position: absolute;
      opacity: 0;
      height: 100%;
      background-color: ${sN};
      border-radius: calc(${pO} * 1px);
      animation-timing-function: cubic-bezier(0.4, 0, 0.6, 1);
      width: 60%;
      animation: indeterminate-2 2s infinite;
    }

    :host(.paused) .indeterminate-indicator-1,
    :host(.paused) .indeterminate-indicator-2 {
      animation: none;
      background-color: ${ZN};
      width: 100%;
      opacity: 1;
    }

    :host(.paused) .determinate {
      background-color: ${ZN};
    }

    @keyframes indeterminate-1 {
      0% {
        opacity: 1;
        transform: translateX(-100%);
      }
      70% {
        opacity: 1;
        transform: translateX(300%);
      }
      70.01% {
        opacity: 0;
      }
      100% {
        opacity: 0;
        transform: translateX(300%);
      }
    }

    @keyframes indeterminate-2 {
      0% {
        opacity: 0;
        transform: translateX(-150%);
      }
      29.99% {
        opacity: 0;
      }
      30% {
        opacity: 1;
        transform: translateX(-150%);
      }
      100% {
        transform: translateX(166.66%);
        opacity: 1;
      }
    }
  `.withBehaviors(qR(css`
        .indeterminate-indicator-1,
        .indeterminate-indicator-2,
        .determinate,
        .progress {
          background-color: ${rR.ButtonText};
        }
        :host(.paused) .indeterminate-indicator-1,
        :host(.paused) .indeterminate-indicator-2,
        :host(.paused) .determinate {
          background-color: ${rR.GrayText};
        }
      `)),indeterminateIndicator1:'\n    <span class="indeterminate-indicator-1" part="indeterminate-indicator-1"></span>\n  ',indeterminateIndicator2:'\n    <span class="indeterminate-indicator-2" part="indeterminate-indicator-2"></span>\n  '});const cD=class ProgressRing extends BaseProgress{}.compose({baseName:"progress-ring",template:(t,o)=>html`
    <template
        role="progressbar"
        aria-valuenow="${t=>t.value}"
        aria-valuemin="${t=>t.min}"
        aria-valuemax="${t=>t.max}"
        class="${t=>t.paused?"paused":""}"
    >
        ${when((t=>"number"==typeof t.value),html`
                <svg
                    class="progress"
                    part="progress"
                    viewBox="0 0 16 16"
                    slot="determinate"
                >
                    <circle
                        class="background"
                        part="background"
                        cx="8px"
                        cy="8px"
                        r="7px"
                    ></circle>
                    <circle
                        class="determinate"
                        part="determinate"
                        style="stroke-dasharray: ${t=>44*t.percentComplete/100}px ${44}px"
                        cx="8px"
                        cy="8px"
                        r="7px"
                    ></circle>
                </svg>
            `)}
        ${when((t=>"number"!=typeof t.value),html`
                <slot name="indeterminate" slot="indeterminate">
                    ${o.indeterminateIndicator||""}
                </slot>
            `)}
    </template>
`,styles:(t,o)=>css`
    ${display("flex")} :host {
      align-items: center;
      height: calc(${RM} * 1px);
      width: calc(${RM} * 1px);
    }

    .progress {
      height: 100%;
      width: 100%;
    }

    .background {
      fill: none;
      stroke-width: 2px;
    }

    .determinate {
      stroke: ${sN};
      fill: none;
      stroke-width: 2px;
      stroke-linecap: round;
      transform-origin: 50% 50%;
      transform: rotate(-90deg);
      transition: all 0.2s ease-in-out;
    }

    .indeterminate-indicator-1 {
      stroke: ${sN};
      fill: none;
      stroke-width: 2px;
      stroke-linecap: round;
      transform-origin: 50% 50%;
      transform: rotate(-90deg);
      transition: all 0.2s ease-in-out;
      animation: spin-infinite 2s linear infinite;
    }

    :host(.paused) .indeterminate-indicator-1 {
      animation: none;
      stroke: ${ZN};
    }

    :host(.paused) .determinate {
      stroke: ${ZN};
    }

    @keyframes spin-infinite {
      0% {
        stroke-dasharray: 0.01px 43.97px;
        transform: rotate(0deg);
      }
      50% {
        stroke-dasharray: 21.99px 21.99px;
        transform: rotate(450deg);
      }
      100% {
        stroke-dasharray: 0.01px 43.97px;
        transform: rotate(1080deg);
      }
    }
  `.withBehaviors(qR(css`
        .background {
          stroke: ${rR.Field};
        }
        .determinate,
        .indeterminate-indicator-1 {
          stroke: ${rR.ButtonText};
        }
        :host(.paused) .determinate,
        :host(.paused) .indeterminate-indicator-1 {
          stroke: ${rR.GrayText};
        }
      `)),indeterminateIndicator:'\n    <svg class="progress" part="progress" viewBox="0 0 16 16">\n        <circle\n            class="background"\n            part="background"\n            cx="8px"\n            cy="8px"\n            r="7px"\n        ></circle>\n        <circle\n            class="indeterminate-indicator-1"\n            part="indeterminate-indicator-1"\n            cx="8px"\n            cy="8px"\n            r="7px"\n        ></circle>\n    </svg>\n  '}),dD=Switch.compose({baseName:"switch",template:(t,o)=>html`
    <template
        role="switch"
        aria-checked="${t=>t.checked}"
        aria-disabled="${t=>t.disabled}"
        aria-readonly="${t=>t.readOnly}"
        tabindex="${t=>t.disabled?null:0}"
        @keypress="${(t,o)=>t.keypressHandler(o.event)}"
        @click="${(t,o)=>t.clickHandler(o.event)}"
        class="${t=>t.checked?"checked":""}"
    >
        <label
            part="label"
            class="${t=>t.defaultSlottedNodes&&t.defaultSlottedNodes.length?"label":"label label__hidden"}"
        >
            <slot ${slotted("defaultSlottedNodes")}></slot>
        </label>
        <div part="switch" class="switch">
            <slot name="switch">${o.switch||""}</slot>
        </div>
        <span class="status-message" part="status-message">
            <span class="checked-message" part="checked-message">
                <slot name="checked-message"></slot>
            </span>
            <span class="unchecked-message" part="unchecked-message">
                <slot name="unchecked-message"></slot>
            </span>
        </span>
    </template>
`,styles:(t,o)=>css`
    :host([hidden]) {
      display: none;
    }

    ${display("inline-flex")} :host {
      align-items: center;
      outline: none;
      font-family: ${bO};
      ${""} user-select: none;
    }

    :host(.disabled) {
      opacity: ${cO};
    }

    :host(.disabled) .label,
    :host(.readonly) .label,
    :host(.disabled) .switch,
    :host(.readonly) .switch,
    :host(.disabled) .status-message,
    :host(.readonly) .status-message {
      cursor: ${jR};
    }

    .switch {
      position: relative;
      box-sizing: border-box;
      width: calc(((${RM} / 2) + ${pO}) * 2px);
      height: calc(((${RM} / 2) + ${pO}) * 1px);
      background: ${RN};
      border-radius: calc(${RM} * 1px);
      border: calc(${vO} * 1px) solid ${gM};
      cursor: pointer;
    }

    :host(:not(.disabled):hover) .switch {
      background: ${ON};
      border-color: ${vM};
    }

    :host(:not(.disabled):active) .switch {
      background: ${$N};
      border-color: ${mM};
    }

    :host(:${VR}) .switch {
      ${PM}
      background: ${NN};
    }

    :host(.checked) .switch {
      background: ${sN};
      border-color: transparent;
    }

    :host(.checked:not(.disabled):hover) .switch {
      background: ${aN};
      border-color: transparent;
    }

    :host(.checked:not(.disabled):active) .switch {
      background: ${lN};
      border-color: transparent;
    }

    slot[name='switch'] {
      position: absolute;
      display: flex;
      border: 1px solid transparent; /* Spacing included in the transform reference box */
      fill: ${QN};
      transition: all 0.2s ease-in-out;
    }

    .status-message {
      color: ${QN};
      cursor: pointer;
      ${IM}
    }

    .label__hidden {
      display: none;
      visibility: hidden;
    }

    .label {
      color: ${QN};
      ${IM}
      margin-inline-end: calc(${pO} * 2px + 2px);
      cursor: pointer;
    }

    ::slotted([slot="checked-message"]),
    ::slotted([slot="unchecked-message"]) {
        margin-inline-start: calc(${pO} * 2px + 2px);
    }

    :host(.checked) .switch {
      background: ${sN};
    }

    :host(.checked) .switch slot[name='switch'] {
      fill: ${uN};
      filter: drop-shadow(0px 1px 1px rgba(0, 0, 0, 0.15));
    }

    :host(.checked:not(.disabled)) .switch:hover {
      background: ${aN};
    }

    :host(.checked:not(.disabled)) .switch:hover slot[name='switch'] {
      fill: ${hN};
    }

    :host(.checked:not(.disabled)) .switch:active {
      background: ${lN};
    }

    :host(.checked:not(.disabled)) .switch:active slot[name='switch'] {
      fill: ${pN};
    }

    .unchecked-message {
      display: block;
    }

    .checked-message {
      display: none;
    }

    :host(.checked) .unchecked-message {
      display: none;
    }

    :host(.checked) .checked-message {
      display: block;
    }
  `.withBehaviors(new DirectionalStyleSheetBehavior(css`
        slot[name='switch'] {
          left: 0;
        }

        :host(.checked) slot[name='switch'] {
          left: 100%;
          transform: translateX(-100%);
        }
      `,css`
        slot[name='switch'] {
          right: 0;
        }

        :host(.checked) slot[name='switch'] {
          right: 100%;
          transform: translateX(100%);
        }
      `),qR(css`
        :host(:not(.disabled)) .switch slot[name='switch'] {
          forced-color-adjust: none;
          fill: ${rR.FieldText};
        }
        .switch {
          background: ${rR.Field};
          border-color: ${rR.FieldText};
        }
        :host(.checked) .switch {
          background: ${rR.Highlight};
          border-color: ${rR.Highlight};
        }
        :host(:not(.disabled):hover) .switch ,
        :host(:not(.disabled):active) .switch,
        :host(.checked:not(.disabled):hover) .switch {
          background: ${rR.HighlightText};
          border-color: ${rR.Highlight};
        }
        :host(.checked:not(.disabled)) .switch slot[name="switch"] {
          fill: ${rR.HighlightText};
        }
        :host(.checked:not(.disabled):hover) .switch slot[name='switch'] {
          fill: ${rR.Highlight};
        }
        :host(:${VR}) .switch {
          forced-color-adjust: none;
          background: ${rR.Field}; 
          border-color: ${rR.Highlight};
          outline-color: ${rR.FieldText};
        }
        :host(.disabled) {
          opacity: 1;
        }
        :host(.disabled) slot[name='switch'] {
          forced-color-adjust: none;
          fill: ${rR.GrayText};
        }
        :host(.disabled) .switch {
          background: ${rR.Field};
          border-color: ${rR.GrayText};
        }
        .status-message,
        .label {
          color: ${rR.FieldText};
        }
      `)),switch:'\n    <svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n      <rect x="2" y="2" width="12" height="12" rx="6"/>\n    </svg>\n  '}),uD=Tab.compose({baseName:"tab",template:(t,o)=>html`
    <template slot="tab" role="tab" aria-disabled="${t=>t.disabled}">
        <slot></slot>
    </template>
`,styles:(t,o)=>css`
      ${display("inline-flex")} :host {
        box-sizing: border-box;
        ${IM}
        height: calc((${RM} + (${pO} * 2)) * 1px);
        padding: 0 calc((6 + (${pO} * 2 * ${hO})) * 1px);
        color: ${QN};
        border-radius: calc(${fO} * 1px);
        border: calc(${vO} * 1px) solid transparent;
        align-items: center;
        justify-content: center;
        grid-row: 1 / 3;
        cursor: pointer;
      }

      :host([aria-selected='true']) {
        z-index: 2;
      }

      :host(:hover),
      :host(:active) {
        color: ${QN};
      }

      :host(:${VR}) {
        ${AM}
      }

      :host(.vertical) {
        justify-content: start;
        grid-column: 1 / 3;
      }

      :host(.vertical[aria-selected='true']) {
        z-index: 2;
      }

      :host(.vertical:hover),
      :host(.vertical:active) {
        color: ${QN};
      }

      :host(.vertical:hover[aria-selected='true']) {
      }
    `.withBehaviors(qR(css`
          :host {
            forced-color-adjust: none;
            border-color: transparent;
            color: ${rR.ButtonText};
            fill: currentcolor;
          }
          :host(:hover),
          :host(.vertical:hover),
          :host([aria-selected='true']:hover) {
            background: transparent;
            color: ${rR.Highlight};
            fill: currentcolor;
          }
          :host([aria-selected='true']) {
            background: transparent;
            color: ${rR.Highlight};
            fill: currentcolor;
          }
          :host(:${VR}) {
            background: transparent;
            outline-color: ${rR.ButtonText};
          }
        `))}),hD=class TabPanel extends FoundationElement{}.compose({baseName:"tab-panel",template:(t,o)=>html`
    <template slot="tabpanel" role="tabpanel">
        <slot></slot>
    </template>
`,styles:(t,o)=>css`
  ${display("block")} :host {
    box-sizing: border-box;
    ${IM}
    padding: 0 calc((6 + (${pO} * 2 * ${hO})) * 1px);
  }
`}),pD=Tabs.compose({baseName:"tabs",template:(t,o)=>html`
    <template class="${t=>t.orientation}">
        ${startSlotTemplate(0,o)}
        <div class="tablist" part="tablist" role="tablist">
            <slot class="tab" name="tab" part="tab" ${slotted("tabs")}></slot>

            ${when((t=>t.showActiveIndicator),html`
                    <div
                        ${ref("activeIndicatorRef")}
                        class="activeIndicator"
                        part="activeIndicator"
                    ></div>
                `)}
        </div>
        ${endSlotTemplate(0,o)}
        <div class="tabpanel">
            <slot name="tabpanel" part="tabpanel" ${slotted("tabpanels")}></slot>
        </div>
    </template>
`,styles:(t,o)=>css`
      ${display("grid")} :host {
        box-sizing: border-box;
        ${IM}
        color: ${QN};
        grid-template-columns: auto 1fr auto;
        grid-template-rows: auto 1fr;
      }

      .tablist {
        display: grid;
        grid-template-rows: calc(${RM} * 1px); auto;
        grid-template-columns: auto;
        position: relative;
        width: max-content;
        align-self: end;
      }

      .start,
      .end {
        align-self: center;
      }

      .activeIndicator {
        grid-row: 2;
        grid-column: 1;
        width: 20px;
        height: 3px;
        border-radius: calc(${fO} * 1px);
        justify-self: center;
        background: ${sN};
      }

      .activeIndicatorTransition {
        transition: transform 0.2s ease-in-out;
      }

      .tabpanel {
        grid-row: 2;
        grid-column-start: 1;
        grid-column-end: 4;
        position: relative;
      }

      :host(.vertical) {
        grid-template-rows: auto 1fr auto;
        grid-template-columns: auto 1fr;
      }

      :host(.vertical) .tablist {
        grid-row-start: 2;
        grid-row-end: 2;
        display: grid;
        grid-template-rows: auto;
        grid-template-columns: auto 1fr;
        position: relative;
        width: max-content;
        justify-self: end;
        align-self: flex-start;
        width: 100%;
      }

      :host(.vertical) .tabpanel {
        grid-column: 2;
        grid-row-start: 1;
        grid-row-end: 4;
      }

      :host(.vertical) .end {
        grid-row: 3;
      }

      :host(.vertical) .activeIndicator {
        grid-column: 1;
        grid-row: 1;
        width: 3px;
        height: 20px;
        margin-inline-start: calc(${mO} * 1px);
        border-radius: calc(${fO} * 1px);
        align-self: center;
        background: ${sN};
      }

      :host(.vertical) .activeIndicatorTransition {
        transition: transform 0.2s linear;
      }
    `.withBehaviors(qR(css`
        .activeIndicator,
        :host(.vertical) .activeIndicator {
          background: ${rR.Highlight};
        }
      `))}),fD=".root";class TextField extends TextField$1{appearanceChanged(t,o){t!==o&&(this.classList.add(o),this.classList.remove(t))}connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="outline")}}__decorate$z([attr],TextField.prototype,"appearance",void 0);const gD=TextField.compose({baseName:"text-field",baseClass:TextField$1,template:(t,o)=>html`
    <template
        class="
            ${t=>t.readOnly?"readonly":""}
        "
    >
        <label
            part="label"
            for="control"
            class="${t=>t.defaultSlottedNodes&&t.defaultSlottedNodes.length?"label":"label label__hidden"}"
        >
            <slot
                ${slotted({property:"defaultSlottedNodes",filter:whitespaceFilter})}
            ></slot>
        </label>
        <div class="root" part="root">
            ${startSlotTemplate(0,o)}
            <input
                class="control"
                part="control"
                id="control"
                @input="${t=>t.handleTextInput()}"
                @change="${t=>t.handleChange()}"
                ?autofocus="${t=>t.autofocus}"
                ?disabled="${t=>t.disabled}"
                list="${t=>t.list}"
                maxlength="${t=>t.maxlength}"
                minlength="${t=>t.minlength}"
                pattern="${t=>t.pattern}"
                placeholder="${t=>t.placeholder}"
                ?readonly="${t=>t.readOnly}"
                ?required="${t=>t.required}"
                size="${t=>t.size}"
                ?spellcheck="${t=>t.spellcheck}"
                :value="${t=>t.value}"
                type="${t=>t.type}"
                aria-atomic="${t=>t.ariaAtomic}"
                aria-busy="${t=>t.ariaBusy}"
                aria-controls="${t=>t.ariaControls}"
                aria-current="${t=>t.ariaCurrent}"
                aria-describedby="${t=>t.ariaDescribedby}"
                aria-details="${t=>t.ariaDetails}"
                aria-disabled="${t=>t.ariaDisabled}"
                aria-errormessage="${t=>t.ariaErrormessage}"
                aria-flowto="${t=>t.ariaFlowto}"
                aria-haspopup="${t=>t.ariaHaspopup}"
                aria-hidden="${t=>t.ariaHidden}"
                aria-invalid="${t=>t.ariaInvalid}"
                aria-keyshortcuts="${t=>t.ariaKeyshortcuts}"
                aria-label="${t=>t.ariaLabel}"
                aria-labelledby="${t=>t.ariaLabelledby}"
                aria-live="${t=>t.ariaLive}"
                aria-owns="${t=>t.ariaOwns}"
                aria-relevant="${t=>t.ariaRelevant}"
                aria-roledescription="${t=>t.ariaRoledescription}"
                ${ref("control")}
            />
            ${endSlotTemplate(0,o)}
        </div>
    </template>
`,styles:(t,o)=>css`
    ${display("inline-block")}

    ${((t,o,s)=>css`
  :host {
    ${IM}
    color: ${QN};
    fill: currentcolor;
    user-select: none;
    position: relative;
  }

  ${s} {
    box-sizing: border-box;
    position: relative;
    color: inherit;
    border: calc(${vO} * 1px) solid transparent;
    border-radius: calc(${fO} * 1px);
    height: calc(${RM} * 1px);
    font-family: inherit;
    font-size: inherit;
    line-height: inherit;
  }

  .control {
    width: 100%;
    outline: none;
  }

  .label {
    display: block;
    color: ${QN};
    cursor: pointer;
    ${IM}
    margin-bottom: 4px;
  }

  .label__hidden {
    display: none;
    visibility: hidden;
  }

  :host([disabled]) ${s},
  :host([readonly]) ${s},
  :host([disabled]) .label,
  :host([readonly]) .label,
  :host([disabled]) .control,
  :host([readonly]) .control {
    cursor: ${jR};
  }

  :host([disabled]) {
    opacity: ${cO};
  }
`)(0,0,fD)}

    ${inputStateStyles()}

    .root {
      display: flex;
      flex-direction: row;
    }

    .control {
      -webkit-appearance: none;
      color: inherit;
      background: transparent;
      border: 0;
      height: calc(100% - 4px);
      margin-top: auto;
      margin-bottom: auto;
      padding: 0 calc(${pO} * 2px + 1px);
      font-family: inherit;
      font-size: inherit;
      line-height: inherit;
    }

    .start,
    .end {
      display: flex;
      margin: auto;
    }

    .start {
      display: flex;
      margin-inline-start: 11px;
    }

    .end {
      display: flex;
      margin-inline-end: 11px;
    }
  `.withBehaviors(appearanceBehavior("outline",inputOutlineStyles(0,0,fD)),appearanceBehavior("filled",inputFilledStyles(0,0,fD)),qR(inputForcedColorStyles(0,0,fD))),shadowOptions:{delegatesFocus:!0}});const vD=class Tooltip extends Tooltip$1{connectedCallback(){super.connectedCallback(),oN.setValueFor(this,J$)}}.compose({baseName:"tooltip",baseClass:Tooltip$1,template:(t,o)=>html`
        ${when((t=>t.tooltipVisible),html`
            <${t.tagFor(AnchoredRegion)}
                fixed-placement="true"
                auto-update-mode="${t=>t.autoUpdateMode}"
                vertical-positioning-mode="${t=>t.verticalPositioningMode}"
                vertical-default-position="${t=>t.verticalDefaultPosition}"
                vertical-inset="${t=>t.verticalInset}"
                vertical-scaling="${t=>t.verticalScaling}"
                horizontal-positioning-mode="${t=>t.horizontalPositioningMode}"
                horizontal-default-position="${t=>t.horizontalDefaultPosition}"
                horizontal-scaling="${t=>t.horizontalScaling}"
                horizontal-inset="${t=>t.horizontalInset}"
                vertical-viewport-lock="${t=>t.horizontalViewportLock}"
                horizontal-viewport-lock="${t=>t.verticalViewportLock}"
                dir="${t=>t.currentDirection}"
                ${ref("region")}
            >
                <div class="tooltip" part="tooltip" role="tooltip">
                    <slot></slot>
                </div>
            </${t.tagFor(AnchoredRegion)}>
        `)}
    `,styles:(t,o)=>css`
    :host {
      position: relative;
      contain: layout;
      overflow: visible;
      height: 0;
      width: 0;
      z-index: 10000;
    }

    .tooltip {
      box-sizing: border-box;
      border-radius: calc(${fO} * 1px);
      border: calc(${vO} * 1px) solid ${pM};
      background: ${oN};
      color: ${QN};
      padding: 4px 12px;
      height: fit-content;
      width: fit-content;
      ${IM}
      white-space: nowrap;
      box-shadow: ${UM};
    }

    ${t.tagFor(AnchoredRegion)} {
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: visible;
      flex-direction: row;
    }

    ${t.tagFor(AnchoredRegion)}.right,
    ${t.tagFor(AnchoredRegion)}.left {
      flex-direction: column;
    }

    ${t.tagFor(AnchoredRegion)}.top .tooltip::after,
    ${t.tagFor(AnchoredRegion)}.bottom .tooltip::after,
    ${t.tagFor(AnchoredRegion)}.left .tooltip::after,
    ${t.tagFor(AnchoredRegion)}.right .tooltip::after {
      content: '';
      width: 12px;
      height: 12px;
      background: ${oN};
      border-top: calc(${vO} * 1px) solid ${pM};
      border-left: calc(${vO} * 1px) solid ${pM};
      position: absolute;
    }

    ${t.tagFor(AnchoredRegion)}.top .tooltip::after {
      transform: translateX(-50%) rotate(225deg);
      bottom: 5px;
      left: 50%;
    }

    ${t.tagFor(AnchoredRegion)}.top .tooltip {
      margin-bottom: 12px;
    }

    ${t.tagFor(AnchoredRegion)}.bottom .tooltip::after {
      transform: translateX(-50%) rotate(45deg);
      top: 5px;
      left: 50%;
    }

    ${t.tagFor(AnchoredRegion)}.bottom .tooltip {
      margin-top: 12px;
    }

    ${t.tagFor(AnchoredRegion)}.left .tooltip::after {
      transform: translateY(-50%) rotate(135deg);
      top: 50%;
      right: 5px;
    }

    ${t.tagFor(AnchoredRegion)}.left .tooltip {
      margin-right: 12px;
    }

    ${t.tagFor(AnchoredRegion)}.right .tooltip::after {
      transform: translateY(-50%) rotate(-45deg);
      top: 50%;
      left: 5px;
    }

    ${t.tagFor(AnchoredRegion)}.right .tooltip {
      margin-left: 12px;
    }
  `.withBehaviors(qR(css`
        :host([disabled]) {
          opacity: 1;
        }
        ${t.tagFor(AnchoredRegion)}.top .tooltip::after,
        ${t.tagFor(AnchoredRegion)}.bottom .tooltip::after,
        ${t.tagFor(AnchoredRegion)}.left .tooltip::after,
        ${t.tagFor(AnchoredRegion)}.right .tooltip::after {
          content: '';
          width: unset;
          height: unset;
        }
      `))}),mD=TreeView.compose({baseName:"tree-view",template:(t,o)=>html`
    <template
        role="tree"
        ${ref("treeView")}
        @keydown="${(t,o)=>t.handleKeyDown(o.event)}"
        @focusin="${(t,o)=>t.handleFocus(o.event)}"
        @focusout="${(t,o)=>t.handleBlur(o.event)}"
        @click="${(t,o)=>t.handleClick(o.event)}"
        @selected-change="${(t,o)=>t.handleSelectedChange(o.event)}"
    >
        <slot ${slotted("slottedTreeItems")}></slot>
    </template>
`,styles:(t,o)=>css`
  :host([hidden]) {
    display: none;
  }

  ${display("flex")} :host {
    flex-direction: column;
    align-items: stretch;
    min-width: fit-content;
    font-size: 0;
  }
`}),bD=css`
  .expand-collapse-button svg {
    transform: rotate(0deg);
  }
  :host(.nested) .expand-collapse-button {
    left: var(--expand-collapse-button-nested-width, calc(${RM} * -1px));
  }
  :host([selected])::after {
    left: calc(${mO} * 1px);
  }
  :host([expanded]) > .positioning-region .expand-collapse-button svg {
    transform: rotate(90deg);
  }
`,yD=css`
  .expand-collapse-button svg {
    transform: rotate(180deg);
  }
  :host(.nested) .expand-collapse-button {
    right: var(--expand-collapse-button-nested-width, calc(${RM} * -1px));
  }
  :host([selected])::after {
    right: calc(${mO} * 1px);
  }
  :host([expanded]) > .positioning-region .expand-collapse-button svg {
    transform: rotate(90deg);
  }
`,wD=cssPartial`((${dO} / 2) * ${pO}) + ((${pO} * ${hO}) / 2)`,_D=yR.create("tree-item-expand-collapse-hover").withDefault((t=>{const o=qN.getValueFor(t);return o.evaluate(t,o.evaluate(t).hover).hover})),CD=yR.create("tree-item-expand-collapse-selected-hover").withDefault((t=>{const o=LN.getValueFor(t);return qN.getValueFor(t).evaluate(t,o.evaluate(t).rest).hover})),kD=TreeItem.compose({baseName:"tree-item",template:(t,o)=>html`
    <template
        role="treeitem"
        slot="${t=>t.isNestedItem()?"item":void 0}"
        tabindex="-1"
        class="${t=>t.expanded?"expanded":""} ${t=>t.selected?"selected":""} ${t=>t.nested?"nested":""}
            ${t=>t.disabled?"disabled":""}"
        aria-expanded="${t=>t.childItems&&t.childItemLength()>0?t.expanded:void 0}"
        aria-selected="${t=>t.selected}"
        aria-disabled="${t=>t.disabled}"
        @focusin="${(t,o)=>t.handleFocus(o.event)}"
        @focusout="${(t,o)=>t.handleBlur(o.event)}"
        ${function children(t){return"string"==typeof t&&(t={property:t}),new AttachedBehaviorHTMLDirective("fast-children",ChildrenBehavior,t)}({property:"childItems",filter:elements()})}
    >
        <div class="positioning-region" part="positioning-region">
            <div class="content-region" part="content-region">
                ${when((t=>t.childItems&&t.childItemLength()>0),html`
                        <div
                            aria-hidden="true"
                            class="expand-collapse-button"
                            part="expand-collapse-button"
                            @click="${(t,o)=>t.handleExpandCollapseButtonClick(o.event)}"
                            ${ref("expandCollapseButton")}
                        >
                            <slot name="expand-collapse-glyph">
                                ${o.expandCollapseGlyph||""}
                            </slot>
                        </div>
                    `)}
                ${startSlotTemplate(0,o)}
                <slot></slot>
                ${endSlotTemplate(0,o)}
            </div>
        </div>
        ${when((t=>t.childItems&&t.childItemLength()>0&&(t.expanded||t.renderCollapsedChildren)),html`
                <div role="group" class="items" part="items">
                    <slot name="item" ${slotted("items")}></slot>
                </div>
            `)}
    </template>
`,styles:(t,o)=>css`
    ${display("block")} :host {
      contain: content;
      position: relative;
      outline: none;
      color: ${QN};
      fill: currentcolor;
      cursor: pointer;
      font-family: ${bO};
      --expand-collapse-button-size: calc(${RM} * 1px);
      --tree-item-nested-width: 0;
    }

    .positioning-region {
      display: flex;
      position: relative;
      box-sizing: border-box;
      background: ${jN};
      border: calc(${vO} * 1px) solid transparent;
      border-radius: calc(${fO} * 1px);
      height: calc((${RM} + 1) * 1px);
    }

    :host(:${VR}) .positioning-region {
      ${AM}
    }

    .positioning-region::before {
      content: '';
      display: block;
      width: var(--tree-item-nested-width);
      flex-shrink: 0;
    }

    :host(:not([disabled])) .positioning-region:hover {
      background: ${zN};
    }

    :host(:not([disabled])) .positioning-region:active {
      background: ${VN};
    }

    .content-region {
      display: inline-flex;
      align-items: center;
      white-space: nowrap;
      width: 100%;
      height: calc(${RM} * 1px);
      margin-inline-start: calc(${pO} * 2px + 8px);
      ${IM}
    }

    .items {
      display: none;
      ${""} font-size: calc(1em + (${pO} + 16) * 1px);
    }

    .expand-collapse-button {
      background: none;
      border: none;
      border-radius: calc(${fO} * 1px);
      ${""} width: calc((${wD} + (${pO} * 2)) * 1px);
      height: calc((${wD} + (${pO} * 2)) * 1px);
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      margin: 0 6px;
    }

    .expand-collapse-button svg {
      transition: transform 0.1s linear;
      pointer-events: none;
    }

    .start,
    .end {
      display: flex;
    }

    .start {
      ${""} margin-inline-end: calc(${pO} * 2px + 2px);
    }

    .end {
      ${""} margin-inline-start: calc(${pO} * 2px + 2px);
    }

    :host(.expanded) > .items {
      display: block;
    }

    :host([disabled]) {
      opacity: ${cO};
      cursor: ${jR};
    }

    :host(.nested) .content-region {
      position: relative;
      margin-inline-start: var(--expand-collapse-button-size);
    }

    :host(.nested) .expand-collapse-button {
      position: absolute;
    }

    :host(.nested) .expand-collapse-button:hover {
      background: ${_D};
    }

    :host(:not([disabled])[selected]) .positioning-region {
      background: ${FN};
    }

    :host(:not([disabled])[selected]) .expand-collapse-button:hover {
      background: ${CD};
    }

    :host([selected])::after {
      content: '';
      display: block;
      position: absolute;
      top: calc((${RM} / 4) * 1px);
      width: 3px;
      height: calc((${RM} / 2) * 1px);
      ${""} background: ${sN};
      border-radius: calc(${fO} * 1px);
    }

    ::slotted(fluent-tree-item) {
      --tree-item-nested-width: 1em;
      --expand-collapse-button-nested-width: calc(${RM} * -1px);
    }
  `.withBehaviors(new DirectionalStyleSheetBehavior(bD,yD),qR(css`
        :host {
          color: ${rR.ButtonText};
        }
        .positioning-region {
          border-color: ${rR.ButtonFace};
          background: ${rR.ButtonFace};
        }
        :host(:not([disabled])) .positioning-region:hover,
        :host(:not([disabled])) .positioning-region:active,
        :host(:not([disabled])[selected]) .positioning-region {
          background: ${rR.Highlight};
        }
        :host .positioning-region:hover .content-region,
        :host([selected]) .positioning-region .content-region {
          forced-color-adjust: none;
          color: ${rR.HighlightText};
        }
        :host([disabled][selected]) .positioning-region .content-region {
          color: ${rR.GrayText};
        }
        :host([selected])::after {
          background: ${rR.HighlightText};
        }
        :host(:${VR}) .positioning-region {
          forced-color-adjust: none;
          outline-color: ${rR.ButtonFace};
        }
        :host([disabled]),
        :host([disabled]) .content-region,
        :host([disabled]) .positioning-region:hover .content-region {
          opacity: 1;
          color: ${rR.GrayText};
        }
        :host(.nested) .expand-collapse-button:hover,
        :host(:not([disabled])[selected]) .expand-collapse-button:hover {
          background: ${rR.ButtonFace};
          fill: ${rR.ButtonText};
        }
      `)),expandCollapseGlyph:'\n    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">\n      <path d="M4.65 2.15a.5.5 0 000 .7L7.79 6 4.65 9.15a.5.5 0 10.7.7l3.5-3.5a.5.5 0 000-.7l-3.5-3.5a.5.5 0 00-.7 0z"/>\n    </svg>\n  '});const TD=function provideFluentDesignSystem(t){return SR.getOrCreate(t).withPrefix("fluent")}(),registerFluentComponents=(...t)=>{if(t&&t.length)for(const o of t)TD.register(o())};var __decorate$r=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},__metadata$q=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)},__awaiter$t=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};registerFluentComponents(XM,vD),exports.MgtAgenda=class MgtAgenda extends MgtTemplatedComponent{static get styles(){return jA}get date(){return this._date}set date(t){this._date!==t&&(this._date=t,this.reloadState())}get groupId(){return this._groupId}set groupId(t){this._groupId!==t&&(this._groupId=t,this.reloadState())}get days(){return this._days}set days(t){this._days!==t&&(this._days=t,this.reloadState())}get eventQuery(){return this._eventQuery}set eventQuery(t){this._eventQuery!==t&&(this._eventQuery=t,this.reloadState())}get preferredTimezone(){return this._preferredTimezone}set preferredTimezone(t){this._preferredTimezone!==t&&(this._preferredTimezone=t,this.reloadState())}static get requiredScopes(){return[...new Set(["calendars.read",...exports.MgtPeople.requiredScopes])]}constructor(){super(),this._days=3,this.onResize=this.onResize.bind(this)}connectedCallback(){this._isNarrow=this.offsetWidth<600,super.connectedCallback(),window.addEventListener("resize",this.onResize)}disconnectedCallback(){window.removeEventListener("resize",this.onResize),super.disconnectedCallback()}render(){if(!this.events&&this.isLoadingState)return this.renderLoading();if(!this.events||0===this.events.length)return this.renderNoData();const t=this.showMax&&this.showMax>0?this.events.slice(0,this.showMax):this.events,o=this.renderTemplate("default",{events:t});if(o)return o;const s={agenda:!0,grouped:this.groupByDay};return XI`
      <div dir=${this.direction} class="${IA(s)}">
        ${this.groupByDay?this.renderGroups(t):this.renderEvents(t)}
        ${this.isLoadingState?this.renderLoading():XI``}
      </div>
    `}reload(){return __awaiter$t(this,void 0,void 0,(function*(){this.events=yield this.loadEvents()}))}renderLoading(){return this.renderTemplate("loading",null)||XI`
        <fluent-card class="event event-loading">
          <div class="event-time-container">
            <div class="event-time-loading loading-element"></div>
          </div>
          <div class="event-details-container">
            <div class="event-subject-loading loading-element"></div>
            <div class="event-location-container">
              <div class="event-location-icon-loading loading-element"></div>
              <div class="event-location-loading loading-element"></div>
            </div>
            <div class="event-location-container">
              <div class="event-attendee-loading loading-element"></div>
              <div class="event-attendee-loading loading-element"></div>
              <div class="event-attendee-loading loading-element"></div>
            </div>
          </div>
        </fluent-card>`}clearState(){this.events=null}renderNoData(){return this.renderTemplate("no-data",null)||XI``}renderEvent(t){this._isNarrow=this.offsetWidth<600;const o={narrow:this._isNarrow};return XI`
      <fluent-card class="${IA(Object.assign({event:!0},o))}">
        <div class="${IA(Object.assign({"event-time-container":!0},o))}">
          <div class="event-time" aria-label="${this.getEventTimeString(t)}">${this.getEventTimeString(t)}</div>
        </div>
        <div class="${IA(Object.assign({"event-details-container":!0},o))}">
          ${this.renderTitle(t)} ${this.renderLocation(t)} ${this.renderAttendees(t)}
        </div>
        <div class="event-other-container">${this.renderOther(t)}</div>
      </fluent-card>
    `}renderHeader(t){return this.renderTemplate("header",{header:t},"header-"+t)||XI`
        <div class="header" aria-label="${t}">${t}</div>
      `}renderTitle(t){let o=(null==t?void 0:t.bodyPreview)?t.bodyPreview.slice(0,100):"";const s=""!==o,l={"event-subject":!0,narrow:this._isNarrow};o=o.split(" ").slice(0,-1).join(" ")+"...";const h=XI`
      <div
        aria-describedby="tooltip-${t.id}"
        class="${IA(l)}"
        id=${t.id}>
          ${t.subject}
      </div>
      <fluent-tooltip
        id="tooltip-${t.id}"
        position="right"
        anchor="${t.id}">
          ${o}
      </fluent-tooltip>
    `,v=XI`
      <div
        aria-label=${t.subject}
        class="${IA(l)}">
          ${t.subject}
      </div>`;return s?h:v}renderLocation(t){return t.location.displayName?XI`
      <div class="event-location-container">
        <div class="event-location-icon">${getSvg($A.OfficeLocation)}</div>
        <div class="event-location" aria-label="${t.location.displayName}">${t.location.displayName}</div>
      </div>
    `:null}renderAttendees(t){return t.attendees.length?mgtHtml`
      <mgt-people
        show-max="5"
        show-presence
        class="event-attendees"
        .peopleQueries=${t.attendees.map((t=>t.emailAddress.address))}
      ></mgt-people>
    `:null}renderOther(t){return this.hasTemplate("event-other")?XI`
          ${this.renderTemplate("event-other",{event:t},t.id+"-other")}
        `:null}renderGroups(t){const o={};return t.forEach((t=>{var s;let l=null===(s=null==t?void 0:t.start)||void 0===s?void 0:s.dateTime;"UTC"===t.end.timeZone&&(l+="Z");const h=this.getDateHeaderFromDateTimeString(l);o[h]=o[h]||[],o[h].push(t)})),XI`
      ${Object.keys(o).map((t=>XI`
            <div class="group">${this.renderHeader(t)} ${this.renderEvents(o[t])}</div>
          `))}
    `}renderEvents(t){return XI`
        ${t.map((t=>XI`
              <div
                class="event-container"
                tabindex="0"
                @focus=${()=>this.eventClicked(t)}>
                ${this.renderTemplate("event",{event:t},t.id)||this.renderEvent(t)}
              </div>`))}`}loadState(){return __awaiter$t(this,void 0,void 0,(function*(){if(this.events)return;const t=yield this.loadEvents();t&&t.length>0&&(this.events=t)}))}reloadState(){return __awaiter$t(this,void 0,void 0,(function*(){this.events=null,this.requestStateUpdate(!0)}))}onResize(){this._isNarrow=this.offsetWidth<600}eventClicked(t){this.fireCustomEvent("eventClick",t)}getEventTimeString(t){if(t.isAllDay)return"ALL DAY";let o=t.start.dateTime;"UTC"===t.start.timeZone&&(o+="Z");let s=t.end.dateTime;"UTC"===t.end.timeZone&&(s+="Z");return`${this.prettyPrintTimeFromDateTime(new Date(o))} - ${this.prettyPrintTimeFromDateTime(new Date(s))}`}loadEvents(){return __awaiter$t(this,void 0,void 0,(function*(){const t=Providers.globalProvider;let o=[];if(t&&t.state===exports.ProviderState.SignedIn){const s=t.graph.forComponent(this);if(this.eventQuery)try{const t=this.eventQuery.split("|");let l,h;t.length>1?(h=t[0].trim(),l=t[1].trim()):h=this.eventQuery;let v=s.api(h);l&&(v=v.middlewareOptions(prepScopes(l)));const m=yield v.get();m&&m.value&&(o=m.value)}catch(t){}else{const t=this.date?new Date(this.date):new Date,l=new Date(t.getTime());l.setDate(t.getDate()+this.days);try{const h=yield function getEventsPageIterator(t,o,s,l){return __awaiter$v(this,void 0,void 0,(function*(){const h=`startdatetime=${o.toISOString()}`,v=`enddatetime=${s.toISOString()}`;let m;m=l?`groups/${l}/calendar`:"me",m+=`/calendarview?${h}&${v}`;let _=t.api(m).middlewareOptions(prepScopes("calendars.read")).orderby("start/dateTime");return GraphPageIterator.create(t,_)}))}(s,t,l,this.groupId);if(h&&h.value)for(o=h.value;h.hasNext;)yield h.next(),o=h.value}catch(t){}}}return o}))}prettyPrintTimeFromDateTime(t){return t.toLocaleTimeString(navigator.language,{timeStyle:"short",timeZone:this.preferredTimezone})}getDateHeaderFromDateTimeString(t){return new Date(t).toLocaleDateString(navigator.language,{dateStyle:"full",timeZone:this.preferredTimezone})}},__decorate$r([e$1({attribute:"date",type:String}),__metadata$q("design:type",String),__metadata$q("design:paramtypes",[Object])],exports.MgtAgenda.prototype,"date",null),__decorate$r([e$1({attribute:"group-id",type:String}),__metadata$q("design:type",String),__metadata$q("design:paramtypes",[Object])],exports.MgtAgenda.prototype,"groupId",null),__decorate$r([e$1({attribute:"days",type:Number}),__metadata$q("design:type",Number),__metadata$q("design:paramtypes",[Object])],exports.MgtAgenda.prototype,"days",null),__decorate$r([e$1({attribute:"event-query",type:String}),__metadata$q("design:type",String),__metadata$q("design:paramtypes",[Object])],exports.MgtAgenda.prototype,"eventQuery",null),__decorate$r([e$1({attribute:"events",type:Array}),__metadata$q("design:type",Array)],exports.MgtAgenda.prototype,"events",void 0),__decorate$r([e$1({attribute:"show-max",type:Number}),__metadata$q("design:type",Number)],exports.MgtAgenda.prototype,"showMax",void 0),__decorate$r([e$1({attribute:"group-by-day",type:Boolean}),__metadata$q("design:type",Boolean)],exports.MgtAgenda.prototype,"groupByDay",void 0),__decorate$r([e$1({attribute:"preferred-timezone",type:String}),__metadata$q("design:type",String),__metadata$q("design:paramtypes",[Object])],exports.MgtAgenda.prototype,"preferredTimezone",null),__decorate$r([e$1({attribute:!1}),__metadata$q("design:type",Boolean)],exports.MgtAgenda.prototype,"_isNarrow",void 0),exports.MgtAgenda=__decorate$r([customElement("agenda"),__metadata$q("design:paramtypes",[])],exports.MgtAgenda);const SD=[i$4`
:host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\e70d"}.ms-Icon--ChevronUp::before{content:"\\\e70e"}.ms-Icon--Contact::before{content:"\\\e77b"}.ms-Icon--AddFriend::before{content:"\\\e8fa"}.ms-Icon--OutlookLogoInverse::before{content:"\\\eb6d"}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{background-color:#fff}.mgt-dark{background-color:#424242}:host{font-family:var(--font-family,var(--default-font-family))}:host .item,mgt-file .item{display:flex;flex-flow:row nowrap;align-items:center;background-color:var(background-color,#fff)}:host .item__file-type-icon,mgt-file .item__file-type-icon{height:var(--file-type-icon-height,28px);display:flex;align-items:center;justify-content:center}:host .item__file-type-icon img,mgt-file .item__file-type-icon img{height:var(--file-type-icon-height,28px)}:host .item__details,mgt-file .item__details{padding-inline-start:var(--file-padding-inline-start,14px)}:host .item__details .line1,mgt-file .item__details .line1{font-size:var(--font-size,14px);font-weight:var(--font-weight,400);text-transform:var(text-transform,none);line-height:20px;color:var(--line1-color,var(--color,#000))}:host .item__details .line2,mgt-file .item__details .line2{color:var(--line2-color,var(--color-sub2,var(--neutral-foreground-hint,#717171)));font-size:var(--line2-font-size,var(--last-modified-font-size,12px));font-weight:var(--line2-font-weight,400);text-transform:var(--line2-text-transform,var(text-transform,none));line-height:16px}:host .item__details .line3,mgt-file .item__details .line3{color:var(--line3-color,var(--color-sub2,var(--neutral-foreground-hint,#717171)));font-size:var(--line3-font-size,var(--size-font-size,12px));font-weight:var(--line3-font-weight,400);text-transform:var(--line3-text-transform,var(text-transform,none));line-height:16px}[dir=rtl] .item{direction:rtl}[dir=rtl] .item__details{direction:rtl}
`];var __awaiter$s=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};function clearFilesCache(){let t;t=CacheService.getCache(AA.fileLists,AA.fileLists.stores.fileLists),t.clearStore()}const getFileInvalidationTime=()=>CacheService.config.files.invalidationPeriod||CacheService.config.defaultInvalidationPeriod,getIsFilesCacheEnabled=()=>CacheService.config.files.isEnabled&&CacheService.config.isEnabled,getFileListInvalidationTime=()=>CacheService.config.fileLists.invalidationPeriod||CacheService.config.defaultInvalidationPeriod,getIsFileListsCacheEnabled=()=>CacheService.config.fileLists.isEnabled&&CacheService.config.isEnabled;function getDriveItemByQuery(t,o){return __awaiter$s(this,void 0,void 0,(function*(){let s;s=CacheService.getCache(AA.files,AA.files.stores.fileQueries);const l=yield getFileFromCache(s,o);if(l)return l;let h;try{h=yield t.api(o).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&s.putValue(o,{file:JSON.stringify(h)})}catch(t){}return h||null}))}function getDriveItemsByInsights(t,o,s){return __awaiter$s(this,void 0,void 0,(function*(){if(!o)return[];const l=o.value,h=t.createBatch(),v=[];for(const t of l){const o=t.resourceReference.id;""!==o&&h.get(o,o,s)}try{const t=yield h.executeAll();for(const o of l){const s=t.get(o.resourceReference.id);s&&s.content&&v.push(s.content)}return v}catch(o){try{return Promise.all(l.filter((t=>t.resourceReference.id&&""!==t.resourceReference.id)).map((o=>__awaiter$s(this,void 0,void 0,(function*(){const l=yield t.api(o.resourceReference.id).middlewareOptions(prepScopes(...s)).get();if(l&&l.length)return l[0].content})))))}catch(t){return[]}}}))}function getFilesPageIteratorFromRequest(t,o){return __awaiter$s(this,void 0,void 0,(function*(){return GraphPageIterator.create(t,o)}))}function getFilesPageIteratorFromCache(t,o,s){return __awaiter$s(this,void 0,void 0,(function*(){return GraphPageIterator.createFromValue(t,o,s)}))}function getFileFromCache(t,o){return __awaiter$s(this,void 0,void 0,(function*(){if(getIsFilesCacheEnabled()){const s=yield t.getValue(o);if(s&&getFileInvalidationTime()>Date.now()-s.timeCached){return JSON.parse(s.file)}}return null}))}function getFileListFromCache(t,o,s){return __awaiter$s(this,void 0,void 0,(function*(){if(t||(t=CacheService.getCache(AA.fileLists,o)),getIsFileListsCacheEnabled()){const o=yield t.getValue(s);if(o&&getFileListInvalidationTime()>Date.now()-o.timeCached)return o}return null}))}function fetchNextAndCacheForFilesPageIterator(t){return __awaiter$s(this,void 0,void 0,(function*(){const o=t._nextLink;if(t.hasNext&&(yield t.next()),getIsFileListsCacheEnabled()){let s;s=CacheService.getCache(AA.fileLists,AA.fileLists.stores.fileLists);const l=/(graph.microsoft.com\/(v1.0|beta))(.*?)(?=\?)/gi.exec(o)[3];s.putValue(l,{files:t.value,nextLink:t._nextLink})}}))}function sendFileChunck(t,o,s,l,h){return __awaiter$s(this,void 0,void 0,(function*(){try{const v="files.readwrite",m={"Content-Length":s,"Content-Range":l};let _;try{_=yield t.client.api(o).middlewareOptions(prepScopes(v)).headers(m).put(h)}catch(t){}return _||null}catch(t){return null}}))}const xD={PowerPoint:"pptx",Word:"docx",Excel:"xlsx",Pdf:"pdf",OneNote:"onetoc",OneNotePage:"one",InfoPath:"xsn",Visio:"vstx",Publisher:"pub",Project:"mpp",Access:"accdb",Mail:"email",Csv:"csv",Archive:"archive",Xps:"vector",Audio:"audio",Video:"video",Image:"photo",Web:"html",Text:"txt",Xml:"xml",Story:"genericfile",ExternalContent:"genericfile",Folder:"folder",Spsite:"spo",Other:"genericfile"},ED="https://spoprod-a.akamaihd.net/files/fabric-cdn-prod_20201008.001/assets/item-types";const ID={modifiedSubtitle:"Modified",sizeSubtitle:"Size"};var __decorate$q=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},__metadata$p=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)},__awaiter$r=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};exports.MgtFile=class MgtFile extends MgtTemplatedComponent{static get styles(){return SD}get strings(){return ID}get fileQuery(){return this._fileQuery}set fileQuery(t){t!==this._fileQuery&&(this._fileQuery=t,this.requestStateUpdate())}get siteId(){return this._siteId}set siteId(t){t!==this._siteId&&(this._siteId=t,this.requestStateUpdate())}get driveId(){return this._driveId}set driveId(t){t!==this._driveId&&(this._driveId=t,this.requestStateUpdate())}get groupId(){return this._groupId}set groupId(t){t!==this._groupId&&(this._groupId=t,this.requestStateUpdate())}get listId(){return this._listId}set listId(t){t!==this._listId&&(this._listId=t,this.requestStateUpdate())}get userId(){return this._userId}set userId(t){t!==this._userId&&(this._userId=t,this.requestStateUpdate())}get itemId(){return this._itemId}set itemId(t){t!==this._itemId&&(this._itemId=t,this.requestStateUpdate())}get itemPath(){return this._itemPath}set itemPath(t){t!==this._itemPath&&(this._itemPath=t,this.requestStateUpdate())}get insightType(){return this._insightType}set insightType(t){t!==this._insightType&&(this._insightType=t,this.requestStateUpdate())}get insightId(){return this._insightId}set insightId(t){t!==this._insightId&&(this._insightId=t,this.requestStateUpdate())}get fileDetails(){return this._fileDetails}set fileDetails(t){t!==this._fileDetails&&(this._fileDetails=t,this.requestStateUpdate())}get fileIcon(){return this._fileIcon}set fileIcon(t){t!==this._fileIcon&&(this._fileIcon=t,this.requestStateUpdate())}static get requiredScopes(){return[...new Set(["files.read","files.read.all","sites.read.all"])]}constructor(){super(),this.line1Property="name",this.line2Property="lastModifiedDateTime",this.line3Property="size",this.view=exports.ViewType.threelines}render(){if(!this.driveItem&&this.isLoadingState)return this.renderLoading();if(!this.driveItem)return this.renderNoData();const t=this.driveItem;let o;if(o=this.renderTemplate("default",{file:t}),!o){const s=this.renderDetails(t),l=this.renderFileTypeIcon();o=XI`
        <div class="item">
          ${l} ${s}
        </div>
      `}return XI`
      <span dir=${this.direction}>
        ${o}
      </span>
    `}renderLoading(){return this.renderTemplate("loading",null)||XI``}renderNoData(){return this.renderTemplate("no-data",null)||XI``}renderFileTypeIcon(){if(!this.fileIcon&&!this.driveItem.name)return XI``;let t;if(this.fileIcon)t=this.fileIcon;else{const o=/(?:\.([^.]+))?$/;t=function getFileTypeIconUriByExtension(t,o,s){const l=Object.keys(xD).find((o=>xD[o]===t));return l?`${ED}/${o.toString()}/${t}.${s}`:"jpg"===t||"png"===t?(t="photo",`${ED}/${o.toString()}/${t}.${s}`):null}(void 0===this.driveItem.package&&void 0===this.driveItem.folder?o.exec(this.driveItem.name)[1]?o.exec(this.driveItem.name)[1].toLowerCase():"null":void 0!==this.driveItem.package&&"oneNote"===this.driveItem.package.type?"onetoc":"folder",48,"svg")}return XI`
      <div class="item__file-type-icon">
        ${t?XI`
              <img src=${t} alt="File icon" />
            `:XI`
              ${getSvg($A.File)}
            `}
      </div>
    `}renderDetails(t){if(!t||this.view===exports.ViewType.image)return XI``;const o=[];if(this.view>exports.ViewType.image){const s=this.getTextFromProperty(t,this.line1Property);s&&o.push(XI`
          <div class="line1" aria-label="${s}">${s}</div>
        `)}if(this.view>exports.ViewType.oneline){const s=this.getTextFromProperty(t,this.line2Property);s&&o.push(XI`
          <div class="line2" aria-label="${s}">${s}</div>
        `)}if(this.view>exports.ViewType.twolines){const s=this.getTextFromProperty(t,this.line3Property);s&&o.push(XI`
          <div class="line3" aria-label="${s}">${s}</div>
        `)}return XI`
      <div class="item__details">
        ${o}
      </div>
    `}loadState(){return __awaiter$r(this,void 0,void 0,(function*(){if(this.fileDetails)return void(this.driveItem=this.fileDetails);const t=Providers.globalProvider;if(!t||t.state===exports.ProviderState.Loading)return;if(t.state===exports.ProviderState.SignedOut)return void(this.driveItem=null);const o=t.graph.forComponent(this);let s;const l=!(this.driveId||this.siteId||this.groupId||this.listId||this.userId);this.driveId&&!this.itemId&&!this.itemPath||this.siteId&&!this.itemId&&!this.itemPath||this.groupId&&!this.itemId&&!this.itemPath||this.listId&&!this.siteId&&!this.itemId||this.insightType&&!this.insightId||this.userId&&!this.itemId&&!this.itemPath&&!this.insightType&&!this.insightId?s=null:this.fileQuery?s=yield getDriveItemByQuery(o,this.fileQuery):this.itemId&&l?s=yield function getMyDriveItemById(t,o){return __awaiter$s(this,void 0,void 0,(function*(){const s=`/me/drive/items/${o}`;let l;l=CacheService.getCache(AA.files,AA.files.stores.userFiles);const h=yield getFileFromCache(l,s);if(h)return h;let v;try{v=yield t.api(s).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&l.putValue(s,{file:JSON.stringify(v)})}catch(t){}return v||null}))}(o,this.itemId):this.itemPath&&l?s=yield function getMyDriveItemByPath(t,o){return __awaiter$s(this,void 0,void 0,(function*(){const s=`/me/drive/root:/${o}`;let l;l=CacheService.getCache(AA.files,AA.files.stores.userFiles);const h=yield getFileFromCache(l,s);if(h)return h;let v;try{v=yield t.api(s).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&l.putValue(s,{file:JSON.stringify(v)})}catch(t){}return v||null}))}(o,this.itemPath):this.userId?this.itemId?s=yield function getUserDriveItemById(t,o,s){return __awaiter$s(this,void 0,void 0,(function*(){const l=`/users/${o}/drive/items/${s}`;let h;h=CacheService.getCache(AA.files,AA.files.stores.userFiles);const v=yield getFileFromCache(h,l);if(v)return v;let m;try{m=yield t.api(l).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&h.putValue(l,{file:JSON.stringify(m)})}catch(t){}return m||null}))}(o,this.userId,this.itemId):this.itemPath?s=yield function getUserDriveItemByPath(t,o,s){return __awaiter$s(this,void 0,void 0,(function*(){const l=`/users/${o}/drive/root:/${s}`;let h;h=CacheService.getCache(AA.files,AA.files.stores.userFiles);const v=yield getFileFromCache(h,l);if(v)return v;let m;try{m=yield t.api(l).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&h.putValue(l,{file:JSON.stringify(m)})}catch(t){}return m||null}))}(o,this.userId,this.itemPath):this.insightType&&this.insightId&&(s=yield function getUserInsightsDriveItemById(t,o,s,l){return __awaiter$s(this,void 0,void 0,(function*(){const h=`/users/${o}/insights/${s}/${l}/resource`;let v;v=CacheService.getCache(AA.files,AA.files.stores.insightFiles);const m=yield getFileFromCache(v,h);if(m)return m;let _;try{_=yield t.api(h).middlewareOptions(prepScopes("sites.read.all")).get(),getIsFilesCacheEnabled()&&v.putValue(h,{file:JSON.stringify(_)})}catch(t){}return _||null}))}(o,this.userId,this.insightType,this.insightId)):this.driveId?this.itemId?s=yield function getDriveItemById(t,o,s){return __awaiter$s(this,void 0,void 0,(function*(){const l=`/drives/${o}/items/${s}`;let h;h=CacheService.getCache(AA.files,AA.files.stores.driveFiles);const v=yield getFileFromCache(h,l);if(v)return v;let m;try{m=yield t.api(l).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&h.putValue(l,{file:JSON.stringify(m)})}catch(t){}return m||null}))}(o,this.driveId,this.itemId):this.itemPath&&(s=yield function getDriveItemByPath(t,o,s){return __awaiter$s(this,void 0,void 0,(function*(){const l=`/drives/${o}/root:/${s}`;let h;h=CacheService.getCache(AA.files,AA.files.stores.driveFiles);const v=yield getFileFromCache(h,l);if(v)return v;let m;try{m=yield t.api(l).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&h.putValue(l,{file:JSON.stringify(m)})}catch(t){}return m||null}))}(o,this.driveId,this.itemPath)):this.siteId&&!this.listId?this.itemId?s=yield function getSiteDriveItemById(t,o,s){return __awaiter$s(this,void 0,void 0,(function*(){const l=`/sites/${o}/drive/items/${s}`;let h;h=CacheService.getCache(AA.files,AA.files.stores.siteFiles);const v=yield getFileFromCache(h,l);if(v)return v;let m;try{m=yield t.api(l).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&h.putValue(l,{file:JSON.stringify(m)})}catch(t){}return m||null}))}(o,this.siteId,this.itemId):this.itemPath&&(s=yield function getSiteDriveItemByPath(t,o,s){return __awaiter$s(this,void 0,void 0,(function*(){const l=`/sites/${o}/drive/root:/${s}`;let h;h=CacheService.getCache(AA.files,AA.files.stores.siteFiles);const v=yield getFileFromCache(h,l);if(v)return v;let m;try{m=yield t.api(l).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&h.putValue(l,{file:JSON.stringify(m)})}catch(t){}return m||null}))}(o,this.siteId,this.itemPath)):this.listId?s=yield function getListDriveItemById(t,o,s,l){return __awaiter$s(this,void 0,void 0,(function*(){const h=`/sites/${o}/lists/${s}/items/${l}/driveItem`;let v;v=CacheService.getCache(AA.files,AA.files.stores.siteFiles);const m=yield getFileFromCache(v,h);if(m)return m;let _;try{_=yield t.api(h).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&v.putValue(h,{file:JSON.stringify(_)})}catch(t){}return _||null}))}(o,this.siteId,this.listId,this.itemId):this.groupId?this.itemId?s=yield function getGroupDriveItemById(t,o,s){return __awaiter$s(this,void 0,void 0,(function*(){const l=`/groups/${o}/drive/items/${s}`;let h;h=CacheService.getCache(AA.files,AA.files.stores.groupFiles);const v=yield getFileFromCache(h,l);if(v)return v;let m;try{m=yield t.api(l).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&h.putValue(l,{file:JSON.stringify(m)})}catch(t){}return m||null}))}(o,this.groupId,this.itemId):this.itemPath&&(s=yield function getGroupDriveItemByPath(t,o,s){return __awaiter$s(this,void 0,void 0,(function*(){const l=`/groups/${o}/drive/root:/${s}`;let h;h=CacheService.getCache(AA.files,AA.files.stores.groupFiles);const v=yield getFileFromCache(h,l);if(v)return v;let m;try{m=yield t.api(l).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&h.putValue(l,{file:JSON.stringify(m)})}catch(t){}return m||null}))}(o,this.groupId,this.itemPath)):this.insightType&&!this.userId&&(s=yield function getMyInsightsDriveItemById(t,o,s){return __awaiter$s(this,void 0,void 0,(function*(){const l=`/me/insights/${o}/${s}/resource`;let h;h=CacheService.getCache(AA.files,AA.files.stores.insightFiles);const v=yield getFileFromCache(h,l);if(v)return v;let m;try{m=yield t.api(l).middlewareOptions(prepScopes("sites.read.all")).get(),getIsFilesCacheEnabled()&&h.putValue(l,{file:JSON.stringify(m)})}catch(t){}return m||null}))}(o,this.insightType,this.insightId)),this.driveItem=s}))}getTextFromProperty(t,o){if(!o||0===o.length)return null;const s=o.trim().split(",");let l,h=0;for(;!l&&h<s.length;){const o=s[h].trim();switch(o){case"size":let s;s=t.size?this.formatBytes(t.size):"0",l=`${this.strings.sizeSubtitle}: ${s}`;break;case"lastModifiedDateTime":let h,v;if(t.lastModifiedDateTime){h=getRelativeDisplayDate(new Date(t.lastModifiedDateTime)),v=`${this.strings.modifiedSubtitle} ${h}`}else v="";l=v;break;default:l=t[o]}h++}return l}formatBytes(t,o=2){if(0===t)return"0 Bytes";const s=o<0?0:o,l=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,l)).toFixed(s))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][l]}},__decorate$q([e$1({attribute:"file-query"}),__metadata$p("design:type",String),__metadata$p("design:paramtypes",[String])],exports.MgtFile.prototype,"fileQuery",null),__decorate$q([e$1({attribute:"site-id"}),__metadata$p("design:type",String),__metadata$p("design:paramtypes",[String])],exports.MgtFile.prototype,"siteId",null),__decorate$q([e$1({attribute:"drive-id"}),__metadata$p("design:type",String),__metadata$p("design:paramtypes",[String])],exports.MgtFile.prototype,"driveId",null),__decorate$q([e$1({attribute:"group-id"}),__metadata$p("design:type",String),__metadata$p("design:paramtypes",[String])],exports.MgtFile.prototype,"groupId",null),__decorate$q([e$1({attribute:"list-id"}),__metadata$p("design:type",String),__metadata$p("design:paramtypes",[String])],exports.MgtFile.prototype,"listId",null),__decorate$q([e$1({attribute:"user-id"}),__metadata$p("design:type",String),__metadata$p("design:paramtypes",[String])],exports.MgtFile.prototype,"userId",null),__decorate$q([e$1({attribute:"item-id"}),__metadata$p("design:type",String),__metadata$p("design:paramtypes",[String])],exports.MgtFile.prototype,"itemId",null),__decorate$q([e$1({attribute:"item-path"}),__metadata$p("design:type",String),__metadata$p("design:paramtypes",[String])],exports.MgtFile.prototype,"itemPath",null),__decorate$q([e$1({attribute:"insight-type"}),__metadata$p("design:type",String),__metadata$p("design:paramtypes",[String])],exports.MgtFile.prototype,"insightType",null),__decorate$q([e$1({attribute:"insight-id"}),__metadata$p("design:type",String),__metadata$p("design:paramtypes",[String])],exports.MgtFile.prototype,"insightId",null),__decorate$q([e$1({type:Object}),__metadata$p("design:type",Object),__metadata$p("design:paramtypes",[Object])],exports.MgtFile.prototype,"fileDetails",null),__decorate$q([e$1({attribute:"file-icon"}),__metadata$p("design:type",String),__metadata$p("design:paramtypes",[String])],exports.MgtFile.prototype,"fileIcon",null),__decorate$q([e$1({type:Object}),__metadata$p("design:type",Object)],exports.MgtFile.prototype,"driveItem",void 0),__decorate$q([e$1({attribute:"line1-property"}),__metadata$p("design:type",String)],exports.MgtFile.prototype,"line1Property",void 0),__decorate$q([e$1({attribute:"line2-property"}),__metadata$p("design:type",String)],exports.MgtFile.prototype,"line2Property",void 0),__decorate$q([e$1({attribute:"line3-property"}),__metadata$p("design:type",String)],exports.MgtFile.prototype,"line3Property",void 0),__decorate$q([e$1({attribute:"view",converter:t=>t&&0!==t.length?(t=t.toLowerCase(),void 0===exports.ViewType[t]?exports.ViewType.threelines:exports.ViewType[t]):exports.ViewType.threelines}),__metadata$p("design:type",Number)],exports.MgtFile.prototype,"view",void 0),exports.MgtFile=__decorate$q([customElement("file"),__metadata$p("design:paramtypes",[])],exports.MgtFile);const AD=[i$4`
.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--file-item-background-color--hover:#f7f7f7;--file-item-background-color--active:#fbfbfb;--file-upload-button-background-color:#036ac4;--file-upload-dialog-background-color:rgba(0, 0, 0, 0.1);--file-upload-dialog-content-background-color:white;--file-upload-dialog-content-color:#323130;--file-upload-dialog-primarybutton-color:white;--file-upload-dialog-primarybutton-background-color:#006cbe}.mgt-dark{--file-item-background-color--hover:#0078d4;--file-item-background-color--active:#238ada;--file-upload-button-background-color:#006cbe;--file-upload-dialog-background-color:rgba(0, 0, 0, 0.3);--file-upload-dialog-content-background-color:#787878;--file-upload-dialog-content-color:#000;--file-upload-dialog-primarybutton-color:white;--file-upload-dialog-primarybutton-background-color:#006cbe}:host .file-upload-area-button{width:100%;--neutral-fill-hover:$file-upload-button-background-color;--neutral-fill-rest:$file-upload-button-background-color;--neutral-fill-active:$file-upload-button-background-color;--neutral-fill-focus:$file-upload-button-background-color}:host .file-upload-area-button div{float:var(--file-upload-button-float,right);text-align:center;display:table;margin-top:30px;margin-right:36px}:host .file-upload-area-button fluent-button.file-upload-button{color:var(--file-upload-button-color,#fff);vertical-align:middle;background-color:var(--file-upload-button-background-color,#036ac4);width:120px;height:32px;cursor:pointer;font-size:var(--default-font-size);font-family:var(--default-font-family);position:relative}:host .file-upload-area-button fluent-button.file-upload-button .upload-text{font-weight:400;line-height:20px}:host .file-upload-area-button input{width:.1px;height:.1px;opacity:0;overflow:hidden;position:absolute;z-index:-1}:host .file-upload-table{margin:var(--file-item-margin,0)}:host .file-upload-table .file-upload-cell{padding:1px 0 1px 1px;display:table-cell;width:50%;vertical-align:middle;position:relative}:host .file-upload-table .file-upload-cell .file-upload-filename{max-width:250px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:host .file-upload-table .file-upload-cell .file-upload-status{position:absolute;left:48px}:host .file-upload-table .file-upload-cell fluent-progress.file-upload-bar{width:180px;margin-top:10px}:host .file-upload-table .file-upload-cell .file-upload-cancel{cursor:pointer;margin-left:20px}:host .file-upload-table .file-upload-cell .file-upload-name{width:auto}:host .file-upload-table .file-upload-cell .cancel-icon{fill:var(--file-upload-button-color,var(--color,fileUploadIconBackground))}:host .file-upload-table.upload{display:table;width:260px}:host .mgt-file-item{--file-background-color:transparent;margin:0 0 20px 26px}:host .upload-icon{fill:var(--file-upload-button-color,#fff)}:host .file-upload-Template{clear:both}:host .file-upload-Template .file-upload-folder-tab{padding-left:20px}:host #file-upload-border{display:none}:host #file-upload-border.visible{border:var(--file-upload-border,dashed #0078d4 1px);background-color:var(--file-upload-background-color,rgba(0,120,212,.1));position:absolute;top:0;bottom:0;left:0;right:0;z-index:1;display:inline-block}:host .file-upload-dialog{display:none}:host .file-upload-dialog .file-upload-dialog-content{background-color:var(--file-upload-dialog-content-background-color,#fff);margin:auto;padding:24px;width:294px;height:auto;margin-top:165px;font-size:var(--default-font-size);font-family:var(--default-font-family);box-shadow:var(--file-list-box-shadow,0 3.2px 7.2px rgba(0,0,0,.132),0 .6px 1.8px rgba(0,0,0,.108));line-height:20px}:host .file-upload-dialog .file-upload-dialog-content div{color:var(--file-upload-dialog-content-color,#323130)}:host .file-upload-dialog .file-upload-dialog-check-wrapper{margin-top:12px}:host .file-upload-dialog fluent-checkbox.file-upload-dialog-check{--neutral-fill-input-rest:$file-upload-dialog-content-color}:host .file-upload-dialog fluent-checkbox.file-upload-dialog-check span{color:var(--file-upload-dialog-content-color,#323130)}:host .file-upload-dialog .file-upload-dialog-content-text{margin-bottom:36px}:host .file-upload-dialog .file-upload-dialog-title{margin-top:0}:host .file-upload-dialog .file-upload-dialog-editor{text-align:right}:host .file-upload-dialog .file-upload-dialog-close{float:right;cursor:pointer}:host .file-upload-dialog .file-upload-dialog-close svg{fill:var(--file-upload-button-color,var(--color,fileUploadIconBackground));padding-right:5px}:host .file-upload-dialog .file-upload-dialog-ok{height:32px;min-width:60px;border:1px solid #8a8886;background-color:var(--file-upload-button-background-color,#036ac4);color:#fff;font-size:var(--default-font-size);margin-right:5px;--neutral-fill-rest:$fileButtonColour;--neutral-fill-hover:$fileButtonColour;--neutral-fill-active:$fileButtonColour;--neutral-fill-focus:$fileButtonColour}:host .file-upload-dialog .file-upload-dialog-cancel{height:32px;min-width:82px;border:1px solid #8a8886;background-color:var(--file-upload-dialog-content-background-color,#fff);color:var(--file-upload-dialog-content-color,#323130);font-size:var(--default-font-size)}:host .file-upload-dialog.visible{position:absolute;z-index:1;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:var(--file-upload-dialog-background-color,rgba(0,0,0,.1));display:inline-block}:host fluent-checkbox.file-upload-dialog-check.hide{display:none}:host .file-upload-dialog-success{border-top:var(--file-item-border-top,none);border-left:var(--file-item-border-left,none);border-right:var(--file-item-border-right,none);border-bottom:var(--file-item-border-bottom,none);border-radius:var(--file-item-border-radius,2px);cursor:pointer}:host .file-upload-dialog-success.focused,:host .file-upload-dialog-success:hover{background-color:var(--file-item-background-color--hover,#f7f7f7)}:host .file-upload-dialog-success.focused .mgt-file-item,:host .file-upload-dialog-success:hover .mgt-file-item{--file-background-color:$file-item-background-color--hover}:host .file-upload-dialog-success.selected,:host .file-upload-dialog-success:active{background-color:var(--file-item-background-color--active,#fbfbfb)}:host .file-upload-dialog-success.selected .mgt-file-item,:host .file-upload-dialog-success:active .mgt-file-item{--file-background-color:$file-item-background-color--active}
`],PD={failUploadFile:"File upload fail.",cancelUploadFile:"File cancel.",buttonUploadFile:"Upload Files",maximumFilesTitle:"Maximum files",maximumFiles:"Sorry, the maximum number of files you can upload at once is {MaxNumber}. Do you want to upload the first {MaxNumber} files or reselect?",maximumFileSizeTitle:"Maximum files size",maximumFileSize:'Sorry, the maximum file size to upload is {FileSize}. The file "{FileName}" has ',fileTypeTitle:"File type",fileType:'Sorry, the format of following file "{FileName}" cannot be uploaded.',checkAgain:"Don't show again",checkApplyAll:"Apply to all",buttonOk:"OK",buttonCancel:"Cancel",buttonUpload:"Upload",buttonKeep:"Keep both",buttonReplace:"Replace",buttonReselect:"Reselect",fileReplaceTitle:"Replace file",fileReplace:'Do you want to replace the file "{FileName}" or keep both files?',uploadButtonLabel:"File upload button"};var __decorate$p=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},__metadata$o=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)},__awaiter$q=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};registerFluentComponents(lD,JM,ZM,XM);let RD=class MgtFileUpload extends MgtBaseComponent{static get styles(){return AD}get strings(){return PD}static get requiredScopes(){return[...new Set(["files.readwrite","files.readwrite.all","sites.readwrite.all"])]}constructor(){super(),this._dragCounter=0,this._dropEffect="copy",this._maxChunckSize=4194304,this._dialogTitle="",this._dialogContent="",this._dialogPrimaryButton="",this._dialogSecondaryButton="",this._dialogCheckBox="",this._applyAll=!1,this._applyAllConflitBehavior=null,this._maximumFileSize=!1,this._excludedFileType=!1,this.handleonDragOver=t=>__awaiter$q(this,void 0,void 0,(function*(){t.preventDefault(),t.stopPropagation(),t.dataTransfer.items&&t.dataTransfer.items.length>0&&(t.dataTransfer.dropEffect=t.dataTransfer.dropEffect=this._dropEffect)})),this.handleonDragEnter=t=>__awaiter$q(this,void 0,void 0,(function*(){if(t.preventDefault(),t.stopPropagation(),this._dragCounter++,t.dataTransfer.items&&t.dataTransfer.items.length>0){t.dataTransfer.dropEffect=this._dropEffect;this.renderRoot.querySelector("#file-upload-border").classList.add("visible")}})),this.handleonDragLeave=t=>{if(t.preventDefault(),t.stopPropagation(),this._dragCounter--,0===this._dragCounter){this.renderRoot.querySelector("#file-upload-border").classList.remove("visible")}},this.handleonDrop=t=>__awaiter$q(this,void 0,void 0,(function*(){t.preventDefault(),t.stopPropagation();this.renderRoot.querySelector("#file-upload-border").classList.remove("visible"),t.dataTransfer&&t.dataTransfer.items&&this.getSelectedFiles(yield this.getFilesFromUploadArea(t.dataTransfer.items)),t.dataTransfer.clearData(),this._dragCounter=0})),this.filesToUpload=[]}render(){if(null!==this.parentElement){const t=this.parentElement;t.addEventListener("dragenter",this.handleonDragEnter),t.addEventListener("dragleave",this.handleonDragLeave),t.addEventListener("dragover",this.handleonDragOver),t.addEventListener("drop",this.handleonDrop)}return XI`
        <div id="file-upload-dialog" class="file-upload-dialog">
          <!-- Modal content -->
          <fluent-card class="file-upload-dialog-content">
            <span class="file-upload-dialog-close" id="file-upload-dialog-close" >${getSvg($A.Cancel)}</span>
            <div class="file-upload-dialog-content-text">
              <h2 class="file-upload-dialog-title">${this._dialogTitle}</h2>
              <div>${this._dialogContent}</div>
              <div class="file-upload-dialog-check-wrapper">
                <fluent-checkbox id="file-upload-dialog-check" class="file-upload-dialog-check" >
                  <span>${this._dialogCheckBox}</span>
                </fluent-checkbox>
              </div>
            </div>
            <div class="file-upload-dialog-editor">
              <fluent-button class="file-upload-dialog-ok">
              ${this._dialogPrimaryButton}
              </fluent-button>
              <fluent-button class="file-upload-dialog-cancel">
              ${this._dialogSecondaryButton}
              </fluent-button>
            </div>
          </fluent-card>
        </div>
        <div id="file-upload-border" >
        </div>
        <div class="file-upload-area-button">
        <div>
          <input
            id="file-upload-input"
            title="${this.strings.uploadButtonLabel}"
            tabindex="-1"
            aria-label="file upload input"
            type="file"
            multiple="true"
            @change="${this.onFileUploadChange}"
          />
          <fluent-button class="file-upload-button" @click=${this.onFileUploadClick} label=${this.strings.uploadButtonLabel}>
            ${getSvg($A.Upload)} <span class="upload-text">${this.strings.buttonUploadFile}</span>
          </fluent-button>
        </div>
        </div>
        <div class="file-upload-Template">
        ${this.renderFolderTemplate(this.filesToUpload)}
        </div>
       `}renderFolderTemplate(t){const o=[];if(t.length>0){const s=t.map((t=>-1===o.indexOf(t.fullPath.substring(0,t.fullPath.lastIndexOf("/")))?""!==t.fullPath.substring(0,t.fullPath.lastIndexOf("/"))?(o.push(t.fullPath.substring(0,t.fullPath.lastIndexOf("/"))),mgtHtml`
            <div class='file-upload-table'>
              <div class='file-upload-cell'>
                <mgt-file
                  .fileDetails=${{name:t.fullPath.substring(1,t.fullPath.lastIndexOf("/")),folder:"Folder"}}
                  .view=${exports.ViewType.oneline}
                  class="mgt-file-item"
                >
                </mgt-file>
              </div>
            </div>
            ${this.renderFileTemplate(t,"file-upload-folder-tab")}`):XI`${this.renderFileTemplate(t,"")}`:XI`${this.renderFileTemplate(t,"file-upload-folder-tab")}`));return XI`${s}`}return null}renderFileTemplate(t,o){return mgtHtml`
        <div class="${t.completed?"file-upload-table":"file-upload-table upload"}">
          <div class="${o+("lastModifiedDateTime"===t.fieldUploadResponse?" file-upload-dialog-success":"")}">
            <div class='file-upload-cell'>
              <div style=${"description"===t.fieldUploadResponse?"opacity: 0.5;":""}>
                <div class="file-upload-status">
                  ${t.iconStatus}
                </div>
                <mgt-file
                  .fileDetails=${t.driveItem}
                  .view=${t.view}
                  .line2Property=${t.fieldUploadResponse}
                  class="mgt-file-item"
                  >
                </mgt-file>
              </div>
            </div>
              ${!1===t.completed?this.renderFileUploadTemplate(t):null}
            </div>
          </div>
        </div>
        `}renderFileUploadTemplate(t){return XI`
    <div class='file-upload-cell'>
      <div class='file-upload-table file-upload-name' >
        <div class='file-upload-cell'>
          <div title="${t.file.name}" class='file-upload-filename'>${t.file.name}</div>
        </div>
      </div>
      <div class='file-upload-table'>
        <div class='file-upload-cell'>
          <div class="${t.completed?"file-upload-table":"file-upload-table upload"}">
            <fluent-progress class="file-upload-bar" value="${t.percent}" ></fluent-progress>
            <div class='file-upload-cell' style="padding-left:5px">
              <span>${t.percent}%</span>
              <span
                class="file-upload-cancel"
                @click=${o=>this.deleteFileUploadSession(t)}>
                ${getSvg($A.Cancel)}
              </span>
            </div>
          <div>
        </div>
      </div>
    </div>
    `}onFileUploadChange(t){return __awaiter$q(this,void 0,void 0,(function*(){!t||t.target.files.length<1||(this.getSelectedFiles(yield this.getFilesFromUploadArea(t.target.files)),t.target.value=null)}))}onFileUploadClick(){this.renderRoot.querySelector("#file-upload-input").click()}deleteFileUploadSession(t){return __awaiter$q(this,void 0,void 0,(function*(){try{if(void 0!==t.uploadUrl){yield function deleteSessionFile(t,o){return __awaiter$s(this,void 0,void 0,(function*(){try{const s="files.readwrite";let l;try{l=yield t.client.api(o).middlewareOptions(prepScopes(s)).delete((t=>t))}catch(t){}return l||null}catch(t){return null}}))}(this.fileUploadList.graph,t.uploadUrl);t.uploadUrl=void 0,t.completed=!0,this.setUploadFail(t,PD.cancelUploadFile)}else t.uploadUrl=void 0,t.completed=!0,this.setUploadFail(t,PD.cancelUploadFile)}catch(o){t.uploadUrl=void 0,t.completed=!0,this.setUploadFail(t,PD.cancelUploadFile)}}))}getSelectedFiles(t){return __awaiter$q(this,void 0,void 0,(function*(){let o=[];const s=[];this._applyAll=!1,this._applyAllConflitBehavior=null,this._maximumFileSize=!1,this._excludedFileType=!1,this.filesToUpload.forEach((t=>__awaiter$q(this,void 0,void 0,(function*(){t.completed?s.push(t):o.push(t)}))));for(const s of t){const t=""===s.fullPath?"/"+s.name:s.fullPath;if(0===o.filter((o=>o.fullPath===t)).length){let l=!0;if(void 0!==this.fileUploadList.maxFileSize&&l&&s.size>1024*this.fileUploadList.maxFileSize&&(l=!1,!1===this._maximumFileSize)){const o=yield this.getFileUploadStatus(s,t,"MaxFileSize",this.fileUploadList);null!==o&&1===o[0]&&(this._maximumFileSize=!0)}if(void 0!==this.fileUploadList.excludedFileExtensions&&this.fileUploadList.excludedFileExtensions.length>0&&l&&this.fileUploadList.excludedFileExtensions.filter((t=>s.name.toLowerCase().indexOf(t.toLowerCase())>-1)).length>0&&(l=!1,!1===this._excludedFileType)){const o=yield this.getFileUploadStatus(s,t,"ExcludedFileType",this.fileUploadList);null!==o&&1===o[0]&&(this._excludedFileType=!0)}if(l){const l=yield this.getFileUploadStatus(s,t,"Upload",this.fileUploadList);let h=!1;null!==l&&(-1===l[0]?h=!0:(this._applyAll=Boolean(l[0]),this._applyAllConflitBehavior=l[1]?1:0)),o.push({file:s,driveItem:{name:s.name},fullPath:t,conflictBehavior:null!==l?l[1]?1:0:null,iconStatus:null,percent:1,view:exports.ViewType.image,completed:h,maxSize:this._maxChunckSize,minSize:0})}}}o=o.sort(((t,o)=>t.fullPath.substring(0,t.fullPath.lastIndexOf("/")).localeCompare(o.fullPath.substring(0,o.fullPath.lastIndexOf("/"))))),o.forEach((t=>{if(0!==s.filter((o=>o.fullPath===t.fullPath)).length){const o=s.findIndex((o=>o.fullPath===t.fullPath));s.splice(o,1)}})),o.push(...s),this.filesToUpload=o,this.filesToUpload.forEach((t=>__awaiter$q(this,void 0,void 0,(function*(){yield this.sendFileItemGraph(t)}))))}))}getFileUploadStatus(t,o,s,l){const h=Object.create(null,{requestStateUpdate:{get:()=>super.requestStateUpdate}});return __awaiter$q(this,void 0,void 0,(function*(){const v=this.renderRoot.querySelector("#file-upload-dialog");switch(s){case"Upload":return null!==(yield function getGraphfile(t,o){return __awaiter$s(this,void 0,void 0,(function*(){try{const s="files.read";let l;try{l=yield t.api(o).middlewareOptions(prepScopes(s)).get().catch((t=>null))}catch(t){}return l||null}catch(t){return null}}))}(this.fileUploadList.graph,`${this.getGrapQuery(o)}?$select=id`))?!0===this._applyAll?[this._applyAll,this._applyAllConflitBehavior]:(v.classList.add("visible"),this._dialogTitle=PD.fileReplaceTitle,this._dialogContent=PD.fileReplace.replace("{FileName}",t.name),this._dialogCheckBox=PD.checkApplyAll,this._dialogPrimaryButton=PD.buttonReplace,this._dialogSecondaryButton=PD.buttonKeep,h.requestStateUpdate.call(this,!0),new Promise((t=>__awaiter$q(this,void 0,void 0,(function*(){const o=this.renderRoot.querySelector(".file-upload-dialog-close"),s=this.renderRoot.querySelector(".file-upload-dialog-ok"),l=this.renderRoot.querySelector(".file-upload-dialog-cancel"),h=this.renderRoot.querySelector("#file-upload-dialog-check");function onOkDialogClick(){v.classList.remove("visible"),t([h.checked?1:0,1])}function onCancelDialogClick(){v.classList.remove("visible"),t([h.checked?1:0,0])}function onCloseDialogClick(){v.classList.remove("visible"),t([-1])}h.checked=!1,h.classList.remove("hide"),s.removeEventListener("click",onOkDialogClick),l.removeEventListener("click",onCancelDialogClick),o.removeEventListener("click",onCloseDialogClick),s.addEventListener("click",onOkDialogClick),l.addEventListener("click",onCancelDialogClick),o.addEventListener("click",onCloseDialogClick)}))))):null;case"ExcludedFileType":return v.classList.add("visible"),this._dialogTitle=PD.fileTypeTitle,this._dialogContent=PD.fileType.replace("{FileName}",t.name)+" ("+l.excludedFileExtensions.join(",")+")",this._dialogCheckBox=PD.checkAgain,this._dialogPrimaryButton=PD.buttonOk,this._dialogSecondaryButton=PD.buttonCancel,h.requestStateUpdate.call(this,!0),new Promise((t=>__awaiter$q(this,void 0,void 0,(function*(){const o=this.renderRoot.querySelector(".file-upload-dialog-ok"),s=this.renderRoot.querySelector(".file-upload-dialog-cancel"),l=this.renderRoot.querySelector(".file-upload-dialog-close"),h=this.renderRoot.querySelector("#file-upload-dialog-check");function onOkDialogClick(){v.classList.remove("visible"),t([h.checked?1:0])}function onCancelDialogClick(){v.classList.remove("visible"),t([0])}h.checked=!1,h.classList.remove("hide"),o.removeEventListener("click",onOkDialogClick),s.removeEventListener("click",onCancelDialogClick),l.removeEventListener("click",onCancelDialogClick),o.addEventListener("click",onOkDialogClick),s.addEventListener("click",onCancelDialogClick),l.addEventListener("click",onCancelDialogClick)}))));case"MaxFileSize":return v.classList.add("visible"),this._dialogTitle=PD.maximumFileSizeTitle,this._dialogContent=PD.maximumFileSize.replace("{FileSize}",formatBytes(l.maxFileSize)).replace("{FileName}",t.name)+formatBytes(t.size)+".",this._dialogCheckBox=PD.checkAgain,this._dialogPrimaryButton=PD.buttonOk,this._dialogSecondaryButton=PD.buttonCancel,h.requestStateUpdate.call(this,!0),new Promise((t=>__awaiter$q(this,void 0,void 0,(function*(){const o=this.renderRoot.querySelector(".file-upload-dialog-ok"),s=this.renderRoot.querySelector(".file-upload-dialog-cancel"),l=this.renderRoot.querySelector(".file-upload-dialog-close"),h=this.renderRoot.querySelector("#file-upload-dialog-check");function onOkDialogClick(){v.classList.remove("visible"),t([h.checked?1:0])}function onCancelDialogClick(){v.classList.remove("visible"),t([0])}h.checked=!1,h.classList.remove("hide"),o.removeEventListener("click",onOkDialogClick),s.removeEventListener("click",onCancelDialogClick),l.removeEventListener("click",onCancelDialogClick),o.addEventListener("click",onOkDialogClick),s.addEventListener("click",onCancelDialogClick),l.addEventListener("click",onCancelDialogClick)}))))}}))}getGrapQuery(t){let o="";return this.fileUploadList.itemPath&&this.fileUploadList.itemPath.length>0&&(o="/"===this.fileUploadList.itemPath.substring(0,1)?this.fileUploadList.itemPath:"/"+this.fileUploadList.itemPath),this.fileUploadList.userId&&this.fileUploadList.itemId?`/users/${this.fileUploadList.userId}/drive/items/${this.fileUploadList.itemId}:${t}`:this.fileUploadList.userId&&this.fileUploadList.itemPath?`/users/${this.fileUploadList.userId}/drive/root:${o}${t}`:this.fileUploadList.groupId&&this.fileUploadList.itemId?`/groups/${this.fileUploadList.groupId}/drive/items/${this.fileUploadList.itemId}:${t}`:this.fileUploadList.groupId&&this.fileUploadList.itemPath?`/groups/${this.fileUploadList.groupId}/drive/root:${o}${t}`:this.fileUploadList.driveId&&this.fileUploadList.itemId?`/drives/${this.fileUploadList.driveId}/items/${this.fileUploadList.itemId}:${t}`:this.fileUploadList.driveId&&this.fileUploadList.itemPath?`/drives/${this.fileUploadList.driveId}/root:${o}${t}`:this.fileUploadList.siteId&&this.fileUploadList.itemId?`/sites/${this.fileUploadList.siteId}/drive/items/${this.fileUploadList.itemId}:${t}`:this.fileUploadList.siteId&&this.fileUploadList.itemPath?`/sites/${this.fileUploadList.siteId}/drive/root:${o}${t}`:this.fileUploadList.itemId?`/me/drive/items/${this.fileUploadList.itemId}:${t}`:this.fileUploadList.itemPath?`/me/drive/root:${o}${t}`:`/me/drive/root:${t}`}sendFileItemGraph(t){return __awaiter$q(this,void 0,void 0,(function*(){const o=this.fileUploadList.graph;let s="";if(t.file.size<this._maxChunckSize)try{t.completed||(null!==t.conflictBehavior&&1!==t.conflictBehavior||(s=`${this.getGrapQuery(t.fullPath)}:/content`),0===t.conflictBehavior&&(s=`${this.getGrapQuery(t.fullPath)}:/content?@microsoft.graph.conflictBehavior=rename`),t.driveItem=yield function sendFileContent(t,o,s){return __awaiter$s(this,void 0,void 0,(function*(){try{const l="files.readwrite";let h;try{h=yield t.client.api(o).middlewareOptions(prepScopes(l)).put(s)}catch(t){}return h||null}catch(t){return null}}))}(o,s,t.file),null!==t.driveItem?this.setUploadSuccess(t):(t.driveItem={name:t.file.name},this.setUploadFail(t,PD.failUploadFile)))}catch(o){this.setUploadFail(t,PD.failUploadFile)}else if(!t.completed&&void 0===t.uploadUrl){const s=yield function getUploadSession(t,o,s){return __awaiter$s(this,void 0,void 0,(function*(){try{const l="files.readwrite",h={item:{"@microsoft.graph.conflictBehavior":0===s||null===s?"rename":"replace"}};let v;try{v=yield t.api(o).middlewareOptions(prepScopes(l)).post(JSON.stringify(h))}catch(t){}return v||null}catch(t){return null}}))}(o,`${this.getGrapQuery(t.fullPath)}:/createUploadSession`,t.conflictBehavior);try{if(null!==s){t.uploadUrl=s.uploadUrl;const l=yield this.sendSessionUrlGraph(o,t);null!==l?(t.driveItem=l,this.setUploadSuccess(t)):this.setUploadFail(t,PD.failUploadFile)}else this.setUploadFail(t,PD.failUploadFile)}catch(t){}}}))}sendSessionUrlGraph(t,o){const s=Object.create(null,{requestStateUpdate:{get:()=>super.requestStateUpdate}});return __awaiter$q(this,void 0,void 0,(function*(){for(;o.file.size>o.minSize;){void 0===o.mimeStreamString&&(o.mimeStreamString=yield this.readFileContent(o.file));const l=new Blob([o.mimeStreamString.slice(o.minSize,o.maxSize)]);if(o.percent=Math.round(o.maxSize/o.file.size*100),s.requestStateUpdate.call(this,!0),void 0===o.uploadUrl)return null;{const s=yield sendFileChunck(t,o.uploadUrl,""+(o.maxSize-o.minSize),`bytes ${o.minSize}-${o.maxSize-1}/${o.file.size}`,l);if(null===s)return null;if(void 0!==s.id)return s;void 0!==s.nextExpectedRanges&&(o.minSize=parseInt(s.nextExpectedRanges[0].split("-")[0]),o.maxSize=o.minSize+this._maxChunckSize,o.maxSize>o.file.size&&(o.maxSize=o.file.size))}}}))}setUploadSuccess(t){t.percent=100,super.requestStateUpdate(!0),setTimeout((()=>{t.iconStatus=getSvg($A.Success),t.view=exports.ViewType.twolines,t.fieldUploadResponse="lastModifiedDateTime",t.completed=!0,super.requestStateUpdate(!0),clearFilesCache()}),500)}setUploadFail(t,o){setTimeout((()=>{t.iconStatus=getSvg($A.Fail),t.view=exports.ViewType.twolines,t.driveItem.description=o,t.fieldUploadResponse="description",t.completed=!0,super.requestStateUpdate(!0)}),500)}readFileContent(t){return new Promise(((o,s)=>{const l=new FileReader;l.onloadend=t=>{o(l.result)},l.onerror=t=>{s(t)},l.readAsArrayBuffer(t)}))}getFilesFromUploadArea(t){return __awaiter$q(this,void 0,void 0,(function*(){const o=[];let s;const l=[];for(const h of t)if("file"!==h.kind){const t=h;t&&(t.fullPath="",l.push(t))}else if(h.getAsEntry)if(s=h.getAsEntry(),s.isDirectory)o.push(s);else{const t=h.getAsFile();t&&(t.fullPath="",l.push(t))}else if(h.webkitGetAsEntry)if(s=h.webkitGetAsEntry(),s.isDirectory)o.push(s);else{const t=h.getAsFile();t&&(t.fullPath="",l.push(t))}else if("function"==typeof h.getAsFile){const t=h.getAsFile();t&&(t.fullPath="",l.push(t))}if(o.length>0){const t=yield this.getFolderFiles(o);l.push(...t)}return l}))}getFolderFiles(t){return new Promise((o=>{let s=0;const l=[];function readEntry(t,h){t.isDirectory?function readReaderContent(t){s++,t.readEntries((t=>{s--;for(const o of t)readEntry(o,o.fullPath);0===s&&o(l)}))}(t.createReader()):(s++,t.file((t=>{s--,t.fullPath=h,l.push(t),0===s&&o(l)})))}t.forEach((t=>{readEntry(t,"")}))}))}};__decorate$p([e$1({type:Object}),__metadata$o("design:type",Array)],RD.prototype,"filesToUpload",void 0),__decorate$p([e$1({type:Object}),__metadata$o("design:type",Object)],RD.prototype,"fileUploadList",void 0),RD=__decorate$p([customElement("file-upload"),__metadata$o("design:paramtypes",[])],RD);const OD=[i$4`
:host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\e70d"}.ms-Icon--ChevronUp::before{content:"\\\e70e"}.ms-Icon--Contact::before{content:"\\\e77b"}.ms-Icon--AddFriend::before{content:"\\\e8fa"}.ms-Icon--OutlookLogoInverse::before{content:"\\\eb6d"}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--file-item-background-color--hover:#f7f7f7;--file-item-background-color--active:#fbfbfb;--file-list-background-color:#ffffff;--file-upload-button-background-color:#f3f2f1;--file-upload-dialog-background-color:rgba(0, 0, 0, 0.1);--file-upload-dialog-content-background-color:white;--file-upload-dialog-content-color:#323130;--file-upload-dialog-primarybutton-color:white;--file-upload-dialog-primarybutton-background-color:#006cbe}.mgt-dark{--file-item-background-color--hover:#0078d4;--file-item-background-color--active:#238ada;--file-list-background-color:#424242;--file-upload-button-background-color:#006cbe;--file-upload-dialog-background-color:rgba(0, 0, 0, 0.3);--file-upload-dialog-content-background-color:#787878;--file-upload-dialog-content-color:#000;--file-upload-dialog-primarybutton-color:white;--file-upload-dialog-primarybutton-background-color:#006cbe}:host{font-family:var(--default-font-family);font-size:var(--default-font-size)}:host .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,var(--neutral-foreground-rest,#1a1a1a));padding:20px 0 12px;line-height:19px}:host .root{padding-inline-start:20px}:host .file-list-wrapper{background-color:var(--file-list-background-color,#fff);box-shadow:var(--file-list-box-shadow,0 3.2px 7.2px rgba(0,0,0,.132),0 .6px 1.8px rgba(0,0,0,.108));border-radius:var(--file-list-border-radius,4px);border:var(--file-list-border,none);position:relative;color:var(--color-sub1,var(--neutral-foreground-rest,#1a1a1a));display:flex;flex-direction:column;border-radius:8px}:host .file-list-wrapper .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,var(--neutral-foreground-rest,#1a1a1a));margin:0 20px -15px 20px}:host .file-list-wrapper .file-list{display:flex;padding:var(--file-list-padding,4px 0);margin:var(--file-list-margin,0);flex-direction:column;list-style:none}:host .file-list-wrapper .file-list .file-item{border-top:var(--file-item-border-top,none);border-left:var(--file-item-border-left,none);border-right:var(--file-item-border-right,none);border-bottom:var(--file-item-border-bottom,none);margin:var(--file-item-margin,0 4px 0 4px);padding-inline-start:var(--file-item-padding-inline-start,24px);padding-top:var(--file-item-padding-top,10px);padding-bottom:var(--file-item-padding-bottom,8px);border-radius:var(--file-item-border-radius,2px);cursor:pointer}:host .file-list-wrapper .file-list .file-item .mgt-file-item{--file-background-color:$background-color}:host .file-list-wrapper .file-list .file-item.focused,:host .file-list-wrapper .file-list .file-item:hover{background-color:var(--file-item-background-color--hover,#f7f7f7)}:host .file-list-wrapper .file-list .file-item.focused .mgt-file-item,:host .file-list-wrapper .file-list .file-item:hover .mgt-file-item{--file-background-color:$file-item-background-color--hover}:host .file-list-wrapper .file-list .file-item.selected,:host .file-list-wrapper .file-list .file-item:active{background-color:var(--file-item-background-color--active,#fbfbfb)}:host .file-list-wrapper .file-list .file-item.selected .mgt-file-item,:host .file-list-wrapper .file-list .file-item:active .mgt-file-item{--file-background-color:$file-item-background-color--active}:host .file-list-wrapper .progress-ring{margin:4px auto;width:var(--progress-ring-size,24px);height:var(--progress-ring-size,24px)}:host .file-list-wrapper .show-more{text-align:center;font-size:var(--show-more-button-font-size,12px);padding:var(--show-more-button-padding,6px);border-bottom-right-radius:var(--show-more-button-border-bottom-right-radius,8px);border-bottom-left-radius:var(--show-more-button-border-bottom-left-radius,8px);cursor:pointer}:host .file-list-wrapper .show-more:hover{background-color:var(--show-more-button-background-color--hover,#efefef)}
`],$D={showMoreSubtitle:"Show more items",filesSectionTitle:"Files",sharedTextSubtitle:"Shared"};var __decorate$o=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},__metadata$n=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)},__awaiter$p=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};registerFluentComponents(cD,iD),exports.MgtFileList=class MgtFileList extends MgtTemplatedComponent{static get styles(){return OD}get strings(){return $D}get fileListQuery(){return this._fileListQuery}set fileListQuery(t){t!==this._fileListQuery&&(this._fileListQuery=t,this.requestStateUpdate(!0))}get displayName(){return this.strings.filesSectionTitle}renderIcon(){return getSvg($A.Files)}asCompactView(){return this._isCompact=!0,this.requestUpdate(),this}asFullView(){return this._isCompact=!1,this._isFullView=!0,this.requestUpdate(),this}get fileQueries(){return this._fileQueries}set fileQueries(t){arraysAreEqual(this._fileQueries,t)||(this._fileQueries=t,this.requestStateUpdate(!0))}get siteId(){return this._siteId}set siteId(t){t!==this._siteId&&(this._siteId=t,this.requestStateUpdate(!0))}get driveId(){return this._driveId}set driveId(t){t!==this._driveId&&(this._driveId=t,this.requestStateUpdate(!0))}get groupId(){return this._groupId}set groupId(t){t!==this._groupId&&(this._groupId=t,this.requestStateUpdate(!0))}get itemId(){return this._itemId}set itemId(t){t!==this._itemId&&(this._itemId=t,this.requestStateUpdate(!0))}get itemPath(){return this._itemPath}set itemPath(t){t!==this._itemPath&&(this._itemPath=t,this.requestStateUpdate(!0))}get userId(){return this._userId}set userId(t){t!==this._userId&&(this._userId=t,this.requestStateUpdate(!0))}get insightType(){return this._insightType}set insightType(t){t!==this._insightType&&(this._insightType=t,this.requestStateUpdate(!0))}get fileExtensions(){return this._fileExtensions}set fileExtensions(t){arraysAreEqual(this._fileExtensions,t)||(this._fileExtensions=t,this.requestStateUpdate(!0))}get pageSize(){return this._pageSize}set pageSize(t){t!==this._pageSize&&(this._pageSize=t,this.requestStateUpdate(!0))}get maxFileSize(){return this._maxFileSize}set maxFileSize(t){t!==this._maxFileSize&&(this._maxFileSize=t,this.requestStateUpdate(!0))}get maxUploadFile(){return this._maxUploadFile}set maxUploadFile(t){t!==this._maxUploadFile&&(this._maxUploadFile=t,this.requestStateUpdate(!0))}get excludedFileExtensions(){return this._excludedFileExtensions}set excludedFileExtensions(t){arraysAreEqual(this._excludedFileExtensions,t)||(this._excludedFileExtensions=t,this.requestStateUpdate(!0))}static get requiredScopes(){return[...new Set([...exports.MgtFile.requiredScopes])]}constructor(){super(),this._focusedItemIndex=-1,this.pageSize=10,this.itemView=exports.ViewType.twolines,this.maxUploadFile=10,this.enableFileUpload=!1,this._preloadedFiles=[],this._isCompact=!1,this._isFullView=!1}requestStateUpdate(t){return this.clearState(),super.requestStateUpdate(t)}clearState(){super.clearState(),this.files=null}render(){return!this.files&&this.isLoadingState?this.renderLoading():this.files&&0!==this.files.length?this._isCompact?this.renderCompactView():this.renderTemplate("default",{files:this.files})||this.renderFiles():this.renderNoData()}renderCompactView(){let t,o=this.files.slice(0,3);return t=XI`
      ${o.map((t=>this.renderFile(t)))}
    `,XI`
      <div class="root compact" dir=${this.direction}>
        ${t}
      </div>
    `}renderLoading(){return this.renderTemplate("loading",null)||XI``}renderNoData(){return this.renderTemplate("no-data",null)||(!0===this.enableFileUpload&&void 0!==Providers.globalProvider?XI`
      <fluent-design-system-provider use-defaults>
        <div id="file-list-wrapper" class="file-list-wrapper" dir=${this.direction}>
          ${this.renderFileUpload()}
        </div>
      </fluent-design-system-provider>
      `:XI``)}renderFiles(){return XI`
      <div id="file-list-wrapper" class="file-list-wrapper" dir=${this.direction}>
        ${this.enableFileUpload?this.renderFileUpload():null}
        ${this._isFullView?XI`<div class="title">${this.strings.filesSectionTitle}</div>`:null}
        <ul
          id="file-list"
          class="file-list"
          tabindex="0"
          @keydown="${this.onFileListKeyDown}"
          @keyup="${this.onFileListKeyUp}"
          @blur="${this.onFileListOut}"
        >
          ${GA(this.files,(t=>t.id),(t=>XI`
              <li class="file-item" @click=${o=>this.handleItemSelect(t,o)}>
                ${this.renderFile(t)}
              </li>
            `))}
        </ul>
        ${!this.hideMoreFilesButton&&this.pageIterator&&(this.pageIterator.hasNext||this._preloadedFiles.length)?this.renderMoreFileButton():null}
      </div>
    `}renderFile(t){const o=this.itemView;return this.renderTemplate("file",{file:t},t.id)||mgtHtml`
        <mgt-file class="mgt-file-item" .fileDetails=${t} .view=${o}></mgt-file>
      `}renderMoreFileButton(){return this._isLoadingMore?XI`
        <fluent-progress-ring role="progressbar" viewBox="0 0 8 8" class="progress-ring"></fluent-progress-ring>
      `:XI`<a id="show-more" class="show-more" @click=${()=>this.renderNextPage()} tabindex="0" @keydown=${this.onShowMoreKeyDown}><span>${this.strings.showMoreSubtitle}<span></a>`}renderFileUpload(){const t={graph:Providers.globalProvider.graph.forComponent(this),driveId:this.driveId,excludedFileExtensions:this.excludedFileExtensions,groupId:this.groupId,itemId:this.itemId,itemPath:this.itemPath,userId:this.userId,siteId:this.siteId,maxFileSize:this.maxFileSize,maxUploadFile:this.maxUploadFile};return mgtHtml`
        <mgt-file-upload .fileUploadList=${t} ></mgt-file-upload>
      `}onShowMoreKeyDown(t){t&&"Enter"===t.code&&(t.preventDefault(),this.renderNextPage())}onFileListKeyUp(t){const o=this.renderRoot.querySelector(".file-list").children[this._focusedItemIndex];"Enter"!==t.code&&"Space"!==t.code||(t.preventDefault(),null==o||o.classList.remove("selected"),null==o||o.classList.add("focused"))}onFileListKeyDown(t){const o=this.renderRoot.querySelector(".file-list");let s;if(o&&o.children.length){if("ArrowUp"!==t.code&&"ArrowDown"!==t.code||("ArrowUp"===t.code&&(-1===this._focusedItemIndex&&(this._focusedItemIndex=o.children.length),this._focusedItemIndex=(this._focusedItemIndex-1+o.children.length)%o.children.length),"ArrowDown"===t.code&&(this._focusedItemIndex=(this._focusedItemIndex+1)%o.children.length),s=o.children[this._focusedItemIndex],this.updateItemBackgroundColor(o,s,"focused")),"Enter"===t.code||"Space"===t.code){s=o.children[this._focusedItemIndex];const l=s.children[0];t.preventDefault(),this.fireCustomEvent("itemClick",l.fileDetails),this.updateItemBackgroundColor(o,s,"selected")}"Tab"===t.code&&(s=o.children[this._focusedItemIndex],null==s||s.classList.remove("focused"))}}onFileListOut(){const t=this.renderRoot.querySelector(".file-list").children[this._focusedItemIndex];null==t||t.classList.remove("focused")}loadState(){return __awaiter$p(this,void 0,void 0,(function*(){const t=Providers.globalProvider;if(!t||t.state===exports.ProviderState.Loading)return;if(t.state===exports.ProviderState.SignedOut)return void(this.files=null);const o=t.graph.forComponent(this);let s,l;const h=!(this.driveId||this.siteId||this.groupId||this.userId);if((this.driveId&&!this.itemId&&!this.itemPath||this.groupId&&!this.itemId&&!this.itemPath||this.siteId&&!this.itemId&&!this.itemPath||this.userId&&!this.insightType&&!this.itemId&&!this.itemPath)&&(this.files=null),!this.files){let t;if(this.fileListQuery?l=yield function getFilesByListQueryIterator(t,o,s){return __awaiter$s(this,void 0,void 0,(function*(){let l,h;const v=AA.fileLists.stores.fileLists;h=CacheService.getCache(AA.fileLists,v);const m=yield getFileListFromCache(h,v,o);if(m)return l=yield getFilesPageIteratorFromCache(t,m.files,m.nextLink),l;const _=["files.read","sites.read.all"];let R;try{R=yield t.api(o).middlewareOptions(prepScopes(..._)),s&&R.top(s),l=yield getFilesPageIteratorFromRequest(t,R),getIsFileListsCacheEnabled()&&h.putValue(o,{files:l.value,nextLink:l._nextLink})}catch(t){}return l||null}))}(o,this.fileListQuery,this.pageSize):this.fileQueries?s=yield function getFilesByQueries(t,o){return __awaiter$s(this,void 0,void 0,(function*(){if(!o||0===o.length)return[];const s=t.createBatch(),l=[],h=["files.read"];let v,m;getIsFilesCacheEnabled()&&(v=CacheService.getCache(AA.files,AA.files.stores.fileQueries));for(const t of o)getIsFilesCacheEnabled()&&(m=yield v.getValue(t)),getIsFilesCacheEnabled()&&m&&getFileInvalidationTime()>Date.now()-m.timeCached?l.push(JSON.parse(m.file)):""!==t&&s.get(t,t,h);try{const t=yield s.executeAll();for(const s of o){const o=t.get(s);o&&o.content&&(l.push(o.content),getIsFilesCacheEnabled()&&v.putValue(s,{file:JSON.stringify(o.content)}))}return l}catch(s){try{return Promise.all(o.filter((t=>t&&""!==t)).map((o=>__awaiter$s(this,void 0,void 0,(function*(){const s=yield getDriveItemByQuery(t,o);if(s)return getIsFilesCacheEnabled()&&v.putValue(o,{file:JSON.stringify(s)}),s})))))}catch(t){return[]}}}))}(o,this.fileQueries):h?this.itemId?l=yield function getFilesByIdIterator(t,o,s){return __awaiter$s(this,void 0,void 0,(function*(){const l=`/me/drive/items/${o}/children`;let h,v;const m=AA.fileLists.stores.fileLists;v=CacheService.getCache(AA.fileLists,m);const _=yield getFileListFromCache(v,m,l);if(_)return h=yield getFilesPageIteratorFromCache(t,_.files,_.nextLink),h;let R;try{R=t.api(l).middlewareOptions(prepScopes("files.read")),s&&R.top(s),h=yield getFilesPageIteratorFromRequest(t,R),getIsFileListsCacheEnabled()&&v.putValue(l,{files:h.value,nextLink:h._nextLink})}catch(t){}return h||null}))}(o,this.itemId,this.pageSize):this.itemPath?l=yield function getFilesByPathIterator(t,o,s){return __awaiter$s(this,void 0,void 0,(function*(){const l=`/me/drive/root:/${o}:/children`;let h,v;const m=AA.fileLists.stores.fileLists;v=CacheService.getCache(AA.fileLists,m);const _=yield getFileListFromCache(v,m,l);if(_)return h=yield getFilesPageIteratorFromCache(t,_.files,_.nextLink),h;let R;try{R=t.api(l).middlewareOptions(prepScopes("files.read")),s&&R.top(s),h=yield getFilesPageIteratorFromRequest(t,R),getIsFileListsCacheEnabled()&&v.putValue(l,{files:h.value,nextLink:h._nextLink})}catch(t){}return h||null}))}(o,this.itemPath,this.pageSize):this.insightType?s=yield function getMyInsightsFiles(t,o){return __awaiter$s(this,void 0,void 0,(function*(){const s=`/me/insights/${o}`;let l;const h=AA.fileLists.stores.insightfileLists;l=CacheService.getCache(AA.fileLists,h);const v=yield getFileListFromCache(l,h,s);if(v)return v.files;const m=["sites.read.all"];let _;try{_=yield t.api(s).filter("resourceReference/type eq 'microsoft.graph.driveItem'").middlewareOptions(prepScopes(...m)).get()}catch(t){}const R=yield getDriveItemsByInsights(t,_,m);return getIsFileListsCacheEnabled()&&l.putValue(s,{files:R}),R||null}))}(o,this.insightType):l=yield function getFilesIterator(t,o){return __awaiter$s(this,void 0,void 0,(function*(){const s="/me/drive/root/children";let l,h;const v=AA.fileLists.stores.fileLists;h=CacheService.getCache(AA.fileLists,v);const m=yield getFileListFromCache(h,v,s);if(m)return l=yield getFilesPageIteratorFromCache(t,m.files,m.nextLink),l;let _;try{_=t.api(s).middlewareOptions(prepScopes("files.read")),o&&_.top(o),l=yield getFilesPageIteratorFromRequest(t,_),getIsFileListsCacheEnabled()&&h.putValue(s,{files:l.value,nextLink:l._nextLink})}catch(t){}return l||null}))}(o,this.pageSize):this.driveId?this.itemId?l=yield function getDriveFilesByIdIterator(t,o,s,l){return __awaiter$s(this,void 0,void 0,(function*(){const h=`/drives/${o}/items/${s}/children`;let v,m;const _=AA.fileLists.stores.fileLists;m=CacheService.getCache(AA.fileLists,_);const R=yield getFileListFromCache(m,_,h);if(R)return v=yield getFilesPageIteratorFromCache(t,R.files,R.nextLink),v;let $;try{$=t.api(h).middlewareOptions(prepScopes("files.read")),l&&$.top(l),v=yield getFilesPageIteratorFromRequest(t,$),getIsFileListsCacheEnabled()&&m.putValue(h,{files:v.value,nextLink:v._nextLink})}catch(t){}return v||null}))}(o,this.driveId,this.itemId,this.pageSize):this.itemPath&&(l=yield function getDriveFilesByPathIterator(t,o,s,l){return __awaiter$s(this,void 0,void 0,(function*(){const h=`/drives/${o}/root:/${s}:/children`;let v,m;const _=AA.fileLists.stores.fileLists;m=CacheService.getCache(AA.fileLists,_);const R=yield getFileListFromCache(m,_,h);if(R)return v=yield getFilesPageIteratorFromCache(t,R.files,R.nextLink),v;let $;try{$=t.api(h).middlewareOptions(prepScopes("files.read")),l&&$.top(l),v=yield getFilesPageIteratorFromRequest(t,$),getIsFileListsCacheEnabled()&&m.putValue(h,{files:v.value,nextLink:v._nextLink})}catch(t){}return v||null}))}(o,this.driveId,this.itemPath,this.pageSize)):this.groupId?this.itemId?l=yield function getGroupFilesByIdIterator(t,o,s,l){return __awaiter$s(this,void 0,void 0,(function*(){const h=`/groups/${o}/drive/items/${s}/children`;let v,m;const _=AA.fileLists.stores.fileLists;m=CacheService.getCache(AA.fileLists,_);const R=yield getFileListFromCache(m,_,h);if(R)return v=yield getFilesPageIteratorFromCache(t,R.files,R.nextLink),v;let $;try{$=t.api(h).middlewareOptions(prepScopes("files.read")),l&&$.top(l),v=yield getFilesPageIteratorFromRequest(t,$),getIsFileListsCacheEnabled()&&m.putValue(h,{files:v.value,nextLink:v._nextLink})}catch(t){}return v||null}))}(o,this.groupId,this.itemId,this.pageSize):this.itemPath&&(l=yield function getGroupFilesByPathIterator(t,o,s,l){return __awaiter$s(this,void 0,void 0,(function*(){const h=`/groups/${o}/drive/root:/${s}:/children`;let v,m;const _=AA.fileLists.stores.fileLists;m=CacheService.getCache(AA.fileLists,_);const R=yield getFileListFromCache(m,_,h);if(R)return v=yield getFilesPageIteratorFromCache(t,R.files,R.nextLink),v;let $;try{$=t.api(h).middlewareOptions(prepScopes("files.read")),l&&$.top(l),v=yield getFilesPageIteratorFromRequest(t,$),getIsFileListsCacheEnabled()&&m.putValue(h,{files:v.value,nextLink:v._nextLink})}catch(t){}return v||null}))}(o,this.groupId,this.itemPath,this.pageSize)):this.siteId?this.itemId?l=yield function getSiteFilesByIdIterator(t,o,s,l){return __awaiter$s(this,void 0,void 0,(function*(){const h=`/sites/${o}/drive/items/${s}/children`;let v,m;const _=AA.fileLists.stores.fileLists;m=CacheService.getCache(AA.fileLists,_);const R=yield getFileListFromCache(m,_,h);if(R)return v=yield getFilesPageIteratorFromCache(t,R.files,R.nextLink),v;let $;try{$=t.api(h).middlewareOptions(prepScopes("files.read")),l&&$.top(l),v=yield getFilesPageIteratorFromRequest(t,$),getIsFileListsCacheEnabled()&&m.putValue(h,{files:v.value,nextLink:v._nextLink})}catch(t){}return v||null}))}(o,this.siteId,this.itemId,this.pageSize):this.itemPath&&(l=yield function getSiteFilesByPathIterator(t,o,s,l){return __awaiter$s(this,void 0,void 0,(function*(){const h=`/sites/${o}/drive/root:/${s}:/children`;let v,m;const _=AA.fileLists.stores.fileLists;m=CacheService.getCache(AA.fileLists,_);const R=yield getFileListFromCache(m,_,h);if(R)return v=yield getFilesPageIteratorFromCache(t,R.files,R.nextLink),v;let $;try{$=t.api(h).middlewareOptions(prepScopes("files.read")),l&&$.top(l),v=yield getFilesPageIteratorFromRequest(t,$),getIsFileListsCacheEnabled()&&m.putValue(h,{files:v.value,nextLink:v._nextLink})}catch(t){}return v||null}))}(o,this.siteId,this.itemPath,this.pageSize)):this.userId&&(this.itemId?l=yield function getUserFilesByIdIterator(t,o,s,l){return __awaiter$s(this,void 0,void 0,(function*(){const h=`/users/${o}/drive/items/${s}/children`;let v,m;const _=AA.fileLists.stores.fileLists;m=CacheService.getCache(AA.fileLists,_);const R=yield getFileListFromCache(m,_,h);if(R)return v=yield getFilesPageIteratorFromCache(t,R.files,R.nextLink),v;let $;try{$=t.api(h).middlewareOptions(prepScopes("files.read")),l&&$.top(l),v=yield getFilesPageIteratorFromRequest(t,$),getIsFileListsCacheEnabled()&&m.putValue(h,{files:v.value,nextLink:v._nextLink})}catch(t){}return v||null}))}(o,this.userId,this.itemId,this.pageSize):this.itemPath?l=yield function getUserFilesByPathIterator(t,o,s,l){return __awaiter$s(this,void 0,void 0,(function*(){const h=`/users/${o}/drive/root:/${s}:/children`;let v,m;const _=AA.fileLists.stores.fileLists;m=CacheService.getCache(AA.fileLists,_);const R=yield getFileListFromCache(m,_,h);if(R)return v=yield getFilesPageIteratorFromCache(t,R.files,R.nextLink),v;let $;try{$=t.api(h).middlewareOptions(prepScopes("files.read")),l&&$.top(l),v=yield getFilesPageIteratorFromRequest(t,$),getIsFileListsCacheEnabled()&&m.putValue(h,{files:v.value,nextLink:v._nextLink})}catch(t){}return v||null}))}(o,this.userId,this.itemPath,this.pageSize):this.insightType&&(s=yield function getUserInsightsFiles(t,o,s){return __awaiter$s(this,void 0,void 0,(function*(){let l,h;"shared"===s?(l="/me/insights/shared",h=`((lastshared/sharedby/id eq '${o}') and (resourceReference/type eq 'microsoft.graph.driveItem'))`):(l=`/users/${o}/insights/${s}`,h="resourceReference/type eq 'microsoft.graph.driveItem'");const v=`${l}?$filter=${h}`;let m;const _=AA.fileLists.stores.insightfileLists;m=CacheService.getCache(AA.fileLists,_);const R=yield getFileListFromCache(m,_,v);if(R)return R.files;const $=["sites.read.all"];let B;try{B=yield t.api(l).filter(h).middlewareOptions(prepScopes(...$)).get()}catch(t){}const q=yield getDriveItemsByInsights(t,B,$);return getIsFileListsCacheEnabled()&&m.putValue(l,{files:q}),q||null}))}(o,this.userId,this.insightType))),l&&(this.pageIterator=l,this._preloadedFiles=[...this.pageIterator.value],s=this._preloadedFiles.length>=this.pageSize?this._preloadedFiles.splice(0,this.pageSize):this._preloadedFiles.splice(0,this._preloadedFiles.length)),this.fileExtensions&&null!==this.fileExtensions){if(this.pageIterator&&this.pageIterator.value){for(;this.pageIterator.hasNext;)yield fetchNextAndCacheForFilesPageIterator(this.pageIterator);s=this.pageIterator.value,this._preloadedFiles=[]}t=s.filter((t=>{for(const o of this.fileExtensions)if(o==this.getFileExtension(t.name))return t}))}t&&t.length>=0?(this.files=t,this.pageSize&&(s=this.files.splice(0,this.pageSize),this.files=s)):this.files=s}}))}handleItemSelect(t,o){if(this.handleFileClick(t),this.fireCustomEvent("itemClick",t),o){const t=this.renderRoot.querySelector(".file-list"),s=Array.from(t.children),l=o.target.closest("li"),h=s.indexOf(l);this._focusedItemIndex=h;const v=t.children[this._focusedItemIndex];this.updateItemBackgroundColor(t,v,"selected");for(let o=0;o<t.children.length;o++)t.children[o].classList.remove("focused")}}renderNextPage(){return __awaiter$p(this,void 0,void 0,(function*(){if(this._preloadedFiles.length>0)this.files=[...this.files,...this._preloadedFiles.splice(0,Math.min(this.pageSize,this._preloadedFiles.length))];else if(this.pageIterator.hasNext){this._isLoadingMore=!0;const t=this.renderRoot.querySelector("file-list-wrapper");t&&t.animate&&t.animate([{height:"auto",transformOrigin:"top left"},{height:"auto",transformOrigin:"top left"}],{duration:1e3,easing:"ease-in-out",fill:"both"}),yield fetchNextAndCacheForFilesPageIterator(this.pageIterator),this._isLoadingMore=!1,this.files=this.pageIterator.value}this.requestUpdate()}))}handleFileClick(t){t&&t.webUrl&&window.open(t.webUrl,"_blank","noreferrer")}getFileExtension(t){return/(?:\.([^.]+))?$/.exec(t)[1]||""}updateItemBackgroundColor(t,o,s){for(let o=0;o<t.children.length;o++)t.children[o].classList.remove(s);o&&(o.classList.add(s),o.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}))}reload(t=!1){t&&clearFilesCache(),this.requestStateUpdate(!0)}},__decorate$o([e$1({attribute:"file-list-query"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],exports.MgtFileList.prototype,"fileListQuery",null),__decorate$o([e$1({attribute:"file-queries",converter:(t,o)=>t?t.split(",").map((t=>t.trim())):null}),__metadata$n("design:type",Array),__metadata$n("design:paramtypes",[Array])],exports.MgtFileList.prototype,"fileQueries",null),__decorate$o([e$1({type:Object}),__metadata$n("design:type",Array)],exports.MgtFileList.prototype,"files",void 0),__decorate$o([e$1({attribute:"site-id"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],exports.MgtFileList.prototype,"siteId",null),__decorate$o([e$1({attribute:"drive-id"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],exports.MgtFileList.prototype,"driveId",null),__decorate$o([e$1({attribute:"group-id"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],exports.MgtFileList.prototype,"groupId",null),__decorate$o([e$1({attribute:"item-id"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],exports.MgtFileList.prototype,"itemId",null),__decorate$o([e$1({attribute:"item-path"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],exports.MgtFileList.prototype,"itemPath",null),__decorate$o([e$1({attribute:"user-id"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],exports.MgtFileList.prototype,"userId",null),__decorate$o([e$1({attribute:"insight-type"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],exports.MgtFileList.prototype,"insightType",null),__decorate$o([e$1({attribute:"item-view",converter:t=>t&&0!==t.length?(t=t.toLowerCase(),void 0===exports.ViewType[t]?exports.ViewType.threelines:exports.ViewType[t]):exports.ViewType.threelines}),__metadata$n("design:type",Number)],exports.MgtFileList.prototype,"itemView",void 0),__decorate$o([e$1({attribute:"file-extensions",converter:(t,o)=>t.split(",").map((t=>t.trim()))}),__metadata$n("design:type",Array),__metadata$n("design:paramtypes",[Array])],exports.MgtFileList.prototype,"fileExtensions",null),__decorate$o([e$1({attribute:"page-size",type:Number}),__metadata$n("design:type",Number),__metadata$n("design:paramtypes",[Number])],exports.MgtFileList.prototype,"pageSize",null),__decorate$o([e$1({attribute:"hide-more-files-button",type:Boolean}),__metadata$n("design:type",Boolean)],exports.MgtFileList.prototype,"hideMoreFilesButton",void 0),__decorate$o([e$1({attribute:"max-file-size",type:Number}),__metadata$n("design:type",Number),__metadata$n("design:paramtypes",[Number])],exports.MgtFileList.prototype,"maxFileSize",null),__decorate$o([e$1({attribute:"enable-file-upload",type:Boolean}),__metadata$n("design:type",Boolean)],exports.MgtFileList.prototype,"enableFileUpload",void 0),__decorate$o([e$1({attribute:"max-upload-file",type:Number}),__metadata$n("design:type",Number),__metadata$n("design:paramtypes",[Number])],exports.MgtFileList.prototype,"maxUploadFile",null),__decorate$o([t$1(),__metadata$n("design:type",Boolean)],exports.MgtFileList.prototype,"_isCompact",void 0),__decorate$o([t$1(),__metadata$n("design:type",Boolean)],exports.MgtFileList.prototype,"_isFullView",void 0),__decorate$o([e$1({attribute:"excluded-file-extensions",converter:(t,o)=>t.split(",").map((t=>t.trim()))}),__metadata$n("design:type",Array),__metadata$n("design:paramtypes",[Array])],exports.MgtFileList.prototype,"excludedFileExtensions",null),__decorate$o([t$1(),__metadata$n("design:type",Boolean)],exports.MgtFileList.prototype,"_isLoadingMore",void 0),exports.MgtFileList=__decorate$o([customElement("file-list"),__metadata$n("design:paramtypes",[])],exports.MgtFileList);const ND={comboboxPlaceholder:"Select an item"};var __decorate$n=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},__metadata$m=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)},__awaiter$o=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};registerFluentComponents(rD,aD),exports.MgtPicker=class MgtPicker extends MgtTemplatedComponent{get strings(){return ND}constructor(){super(),this.version="v1.0",this.maxPages=3,this.scopes=[],this.cacheEnabled=!1,this.cacheInvalidationPeriod=0,this.placeholder=this.strings.comboboxPlaceholder,this.entityType=null,this.keyName=null,this.isRefreshing=!1}refresh(t=!1){this.isRefreshing=!0,t&&this.clearState(),this.requestStateUpdate(t)}clearState(){this.response=null,this.error=null}render(){var t;return this.isLoadingState&&!this.response?this.renderTemplate("loading",null):this.hasTemplate("error")?this.renderTemplate("error",this.error?this.error:null,"error"):this.hasTemplate("no-data")?this.renderTemplate("no-data",null):(null===(t=this.response)||void 0===t?void 0:t.length)>0?this.renderPicker():this.renderGet()}renderPicker(){return mgtHtml`
      <fluent-combobox id="combobox" autocomplete="list" placeholder=${this.placeholder}>
        ${this.response.map((t=>XI`
          <fluent-option value=${t.id} @click=${o=>this.handleClick(o,t)}> ${t[this.keyName]} </fluent-option>`))}
      </fluent-combobox>
     `}renderGet(){return mgtHtml`
      <mgt-get 
        resource=${this.resource}
        version=${this.version} 
        scopes=${this.scopes} 
        max-pages=${this.maxPages} 
        ?cache-enabled=${this.cacheEnabled}
        ?cache-invalidation-period=${this.cacheInvalidationPeriod}>
      </mgt-get>`}loadState(){return __awaiter$o(this,void 0,void 0,(function*(){if(!this.response){this.renderRoot.querySelector("mgt-get").addEventListener("dataChange",(t=>this.handleDataChange(t)))}this.isRefreshing=!1}))}handleDataChange(t){let o=t.detail.response.value,s=t.detail.error?t.detail.error:null;this.response=o,this.error=s}handleClick(t,o){this.fireCustomEvent("selectionChanged",o)}},__decorate$n([e$1({attribute:"resource",type:String}),__metadata$m("design:type",String)],exports.MgtPicker.prototype,"resource",void 0),__decorate$n([e$1({attribute:"version",type:String}),__metadata$m("design:type",String)],exports.MgtPicker.prototype,"version",void 0),__decorate$n([e$1({attribute:"max-pages",type:Number}),__metadata$m("design:type",Number)],exports.MgtPicker.prototype,"maxPages",void 0),__decorate$n([e$1({attribute:"placeholder",type:String}),__metadata$m("design:type",String)],exports.MgtPicker.prototype,"placeholder",void 0),__decorate$n([e$1({attribute:"key-name",type:String}),__metadata$m("design:type",String)],exports.MgtPicker.prototype,"keyName",void 0),__decorate$n([e$1({attribute:"entity-type",type:String}),__metadata$m("design:type",String)],exports.MgtPicker.prototype,"entityType",void 0),__decorate$n([e$1({attribute:"scopes",converter:t=>t?t.toLowerCase().split(","):null}),__metadata$m("design:type",Array)],exports.MgtPicker.prototype,"scopes",void 0),__decorate$n([e$1({attribute:"cache-enabled",type:Boolean}),__metadata$m("design:type",Boolean)],exports.MgtPicker.prototype,"cacheEnabled",void 0),__decorate$n([e$1({attribute:"cache-invalidation-period",type:Number}),__metadata$m("design:type",Number)],exports.MgtPicker.prototype,"cacheInvalidationPeriod",void 0),__decorate$n([t$1(),__metadata$m("design:type",Array)],exports.MgtPicker.prototype,"response",void 0),__decorate$n([t$1(),__metadata$m("design:type",Array)],exports.MgtPicker.prototype,"error",void 0),exports.MgtPicker=__decorate$n([customElement("picker"),__metadata$m("design:paramtypes",[])],exports.MgtPicker);var __decorate$m=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},__metadata$l=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)},__awaiter$n=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};exports.ResponseType=void 0,function(t){t.json="json",t.image="image"}(exports.ResponseType||(exports.ResponseType={}));const getIsResponseCacheEnabled=()=>CacheService.config.response.isEnabled&&CacheService.config.isEnabled;exports.MgtGet=class MgtGet extends MgtTemplatedComponent{constructor(){super(...arguments),this.scopes=[],this.version="v1.0",this.type=exports.ResponseType.json,this.maxPages=3,this.pollingRate=0,this.cacheEnabled=!1,this.cacheInvalidationPeriod=0,this.isPolling=!1,this.isRefreshing=!1}attributeChangedCallback(t,o,s){super.attributeChangedCallback(t,o,s),this.requestStateUpdate()}refresh(t=!1){this.isRefreshing=!0,t&&this.clearState(),this.requestStateUpdate(t)}clearState(){this.response=null}render(){if(this.isLoadingState&&!this.response)return this.renderTemplate("loading",null);if(this.error)return this.renderTemplate("error",this.error);if(this.hasTemplate("value")&&this.response&&this.response.value){let t;if(Array.isArray(this.response.value)){let o=null;this.isLoadingState&&!this.isPolling&&(o=this.renderTemplate("loading",null)),t=XI`
          ${this.response.value.map((t=>this.renderTemplate("value",t,t.id)))} ${o}
        `}else t=this.renderTemplate("value",this.response);if(this.hasTemplate("default")){const o=this.renderTemplate("default",this.response);return this.templates.value.templateOrder>this.templates.default.templateOrder?XI`
            ${o}${t}
          `:XI`
            ${t}${o}
          `}return t}return this.response?this.renderTemplate("default",this.response)||XI``:this.hasTemplate("no-data")?this.renderTemplate("no-data",null):XI``}loadState(){return __awaiter$n(this,void 0,void 0,(function*(){const t=Providers.globalProvider;if(this.error=null,t&&t.state===exports.ProviderState.SignedIn){if(this.resource){try{let o;const s=`${this.version}${this.resource}`;let l=null;if(this.shouldRetrieveCache()){o=CacheService.getCache(AA.get,AA.get.stores.responses);const t=getIsResponseCacheEnabled()?yield o.getValue(s):null;t&&(this.cacheInvalidationPeriod||CacheService.config.response.invalidationPeriod||CacheService.config.defaultInvalidationPeriod)>Date.now()-t.timeCached&&(l=JSON.parse(t.response))}if(!l){let h=this.resource,v=!1;this.response&&this.response["@odata.deltaLink"]?(h=this.response["@odata.deltaLink"],v=!0):v=new URL(h,"https://graph.microsoft.com").pathname.endsWith("delta");const m=t.graph.forComponent(this);let _=m.api(h).version(this.version);if(this.scopes&&this.scopes.length&&(_=_.middlewareOptions(prepScopes(...this.scopes))),this.type===exports.ResponseType.json){if(l=yield _.get(),v&&this.response&&Array.isArray(this.response.value)&&Array.isArray(l.value)&&(l.value=this.response.value.concat(l.value)),this.isPolling||equals(this.response,l)||(this.response=l),l&&Array.isArray(l.value)&&l["@odata.nextLink"]){let t=1,o=l;for(;(t<this.maxPages||this.maxPages<=0||v&&this.pollingRate)&&o&&o["@odata.nextLink"];){t++;const s=o["@odata.nextLink"].split(this.version)[1];o=yield m.client.api(s).version(this.version).get(),o&&o.value&&o.value.length&&(o.value=l.value.concat(o.value),l=o,this.isPolling||(this.response=l))}}}else{if(-1===this.resource.indexOf("/photo/$value")&&-1===this.resource.indexOf("/thumbnails/"))throw new Error("Only /photo/$value and /thumbnails/ endpoints support the image type");let t;if(this.resource.indexOf("/photo/$value")>-1){const o=this.resource.replace("/photo/$value",""),s=yield getPhotoForResource(m,o,this.scopes);s&&(t=s.photo)}else if(this.resource.indexOf("/thumbnails/")>-1){const o=yield function getDocumentThumbnail(t,o,s){return __awaiter$s(this,void 0,void 0,(function*(){try{const l=yield t.api(o).responseType(GE.RAW).middlewareOptions(prepScopes(...s)).get();if(404===l.status)return{eTag:null,thumbnail:null};if(!l.ok)return null;return{eTag:l.headers.get("eTag"),thumbnail:yield blobToBase64(yield l.blob())}}catch(t){return null}}))}(m,this.resource,this.scopes);o&&(t=o.thumbnail)}t&&(l={image:t})}this.shouldUpdateCache()&&l&&(o=CacheService.getCache(AA.get,AA.get.stores.responses),o.putValue(s,{response:JSON.stringify(l)}))}equals(this.response,l)||(this.response=l)}catch(t){this.error=t}this.response&&(this.error=null,this.pollingRate&&setTimeout((()=>__awaiter$n(this,void 0,void 0,(function*(){this.isPolling=!0,yield this.loadState(),this.isPolling=!1}))),this.pollingRate))}else this.response=null;this.isRefreshing=!1,this.fireCustomEvent("dataChange",{response:this.response,error:this.error})}}))}shouldRetrieveCache(){return getIsResponseCacheEnabled()&&this.cacheEnabled&&!(this.isRefreshing||this.isPolling)}shouldUpdateCache(){return getIsResponseCacheEnabled()&&this.cacheEnabled}},__decorate$m([e$1({attribute:"resource",reflect:!0,type:String}),__metadata$l("design:type",String)],exports.MgtGet.prototype,"resource",void 0),__decorate$m([e$1({attribute:"scopes",converter:(t,o)=>t?t.toLowerCase().split(","):null,reflect:!0}),__metadata$l("design:type",Array)],exports.MgtGet.prototype,"scopes",void 0),__decorate$m([e$1({attribute:"version",reflect:!0,type:String}),__metadata$l("design:type",String)],exports.MgtGet.prototype,"version",void 0),__decorate$m([e$1({attribute:"type",reflect:!0,type:exports.ResponseType}),__metadata$l("design:type",String)],exports.MgtGet.prototype,"type",void 0),__decorate$m([e$1({attribute:"max-pages",reflect:!0,type:Number}),__metadata$l("design:type",Number)],exports.MgtGet.prototype,"maxPages",void 0),__decorate$m([e$1({attribute:"polling-rate",reflect:!0,type:Number}),__metadata$l("design:type",Number)],exports.MgtGet.prototype,"pollingRate",void 0),__decorate$m([e$1({attribute:"cache-enabled",reflect:!0,type:Boolean}),__metadata$l("design:type",Boolean)],exports.MgtGet.prototype,"cacheEnabled",void 0),__decorate$m([e$1({attribute:"cache-invalidation-period",type:Number}),__metadata$l("design:type",Number)],exports.MgtGet.prototype,"cacheInvalidationPeriod",void 0),__decorate$m([e$1({attribute:!1}),__metadata$l("design:type",Object)],exports.MgtGet.prototype,"response",void 0),__decorate$m([e$1({attribute:!1}),__metadata$l("design:type",Object)],exports.MgtGet.prototype,"error",void 0),exports.MgtGet=__decorate$m([customElement("get")],exports.MgtGet);const MD=[i$4`
:host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\e70d"}.ms-Icon--ChevronUp::before{content:"\\\e70e"}.ms-Icon--Contact::before{content:"\\\e77b"}.ms-Icon--AddFriend::before{content:"\\\e8fa"}.ms-Icon--OutlookLogoInverse::before{content:"\\\eb6d"}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--button-color:var(--neutral-foreground-rest, #1a1a1a);--popup-color:var(--neutral-foreground-rest, #1a1a1a)}.mgt-dark{--button-color:#f3f2f1;--popup-color:#f3f2f1}:host,mgt-login{--font-size:14px;--font-weight:600;--margin:0;--popup-command-font-size:14px;--popup-command-margin:16px 0 0;--popup-padding:10px 4px 16px 4px;--box-shadow:none;--popup-padding:12px 4px;--profile-spacing:12px 0 28px 0;--profile-spacing-full:21px 0 28px 0}:host .root,mgt-login .root{position:relative;display:inline-block}:host .root.vertical-layout,mgt-login .root.vertical-layout{--profile-spacing:var(--profile-spacing-full)}:host .login-button,mgt-login .login-button{display:flex;align-items:center;font-family:var(--default-font-family);font-size:var(--font-size);font-weight:var(--font-weight);width:var(--width);height:var(--height);margin:var(--margin);color:var(--button-color,var(--neutral-foreground-rest,#1a1a1a));background-color:var(--button-background-color,transparent);border:none;cursor:pointer;transition:color .3s,background-color .3s;word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host .login-button:hover,mgt-login .login-button:hover{color:var(--button-color--hover,#023b8f);--color:var(--button-color--hover, #023b8f);background-color:var(--button-background-color--hover,var(--background-color--hover,var(--neutral-fill-hover,#f7f7f7)));--color-sub1:var(--button-color--hover, #023b8f);border-radius:4px}:host .login-button:focus,mgt-login .login-button:focus{outline:0}:host .login-button:disabled,mgt-login .login-button:disabled{opacity:.4;pointer-events:none}:host .login-button.no-click,mgt-login .login-button.no-click{pointer-events:none}:host .login-button.signed-in,mgt-login .login-button.signed-in{padding:7px 11px}:host .login-button.signed-in:hover,mgt-login .login-button.signed-in:hover{color:inherit;--color:inherit;--color-sub1:inherit}:host .login-button.signed-in.small,mgt-login .login-button.signed-in.small{padding:0}:host .login-button.signed-in.small:hover,mgt-login .login-button.signed-in.small:hover{background-color:inherit}:host .login-button.signed-in.small>.person,mgt-login .login-button.signed-in.small>.person{--focus-offset:2px}:host .login-button.signed-in.full-size,mgt-login .login-button.signed-in.full-size{padding:9px 11px}:host .login-button>.person,mgt-login .login-button>.person{--focus-offset:8px}:host fluent-button.login-button::part(content){margin:5px 0}:host .login-icon+span,mgt-login .login-icon+span{margin-left:6px}:host .popup,mgt-login .popup{font-family:var(--default-font-family);background-color:var(--popup-background-color,var(--neutral-fill-rest,var(--background-color,#fff)));width:300px;max-width:300px;z-index:1;color:var(--popup-color,var(--neutral-foreground-rest,#1a1a1a));border-radius:8px}:host .popup .person,mgt-login .popup .person{--color-sub1:set-var(popup__color, $theme-default, $login)}:host .popup-content,mgt-login .popup-content{display:flex;flex-direction:column;padding:var(--popup-padding);border-radius:8px;background-color:var(--popup-background-color,var(--neutral-fill-rest,var(--background-color,#fff)))}:host .popup-content .inside-content,mgt-login .popup-content .inside-content{overflow-y:auto;overflow-x:clip;max-height:400px}:host .popup-content .inside-content .list-box,mgt-login .popup-content .inside-content .list-box{margin-bottom:25px;margin-top:6px;background-color:var(--popup-background-color,var(--neutral-fill-rest,var(--background-color,#fff)));--accent-fill-hover:$popup__background-color;--accent-fill-active:$popup__background-color;--accent-foreground-cut-rest:black;--stroke-width:0}:host .popup-content .inside-content .list-box .list-box-option,mgt-login .popup-content .inside-content .list-box .list-box-option{margin:8px 1px}:host .popup-content .inside-content .list-box .list-box-option .person,mgt-login .popup-content .inside-content .list-box .list-box-option .person{max-width:246px;width:246px;margin:0 22px;--avatar-size:40px;--focus-offset:4px}:host .popup-content .inside-content .list-box .list-box-option:hover,mgt-login .popup-content .inside-content .list-box .list-box-option:hover{background-color:var(--login-hover-fill,var(--background-color--hover,var(--neutral-fill-hover,#f7f7f7)));cursor:pointer}:host .popup-content .inside-content .list-box:focus .list-box-option.selected,mgt-login .popup-content .inside-content .list-box:focus .list-box-option.selected{border-radius:4px;background:rgba(0,0,0,.1)}:host .popup-content .inside-content .list-box:focus .person:after,mgt-login .popup-content .inside-content .list-box:focus .person:after{background-image:none}:host .popup-content .inside-content:after,mgt-login .popup-content .inside-content:after{content:"";position:absolute;bottom:0;background:linear-gradient(to bottom,rgba(255,255,255,0),var(--popup-background-color,var(--neutral-fill-rest,var(--background-color,#fff))));height:25%;width:100%}:host .popup-content .inside-content::-webkit-scrollbar,mgt-login .popup-content .inside-content::-webkit-scrollbar{height:4em;width:4px;border-radius:11px}:host .popup-content .inside-content::-webkit-scrollbar-button,mgt-login .popup-content .inside-content::-webkit-scrollbar-button{background:#fff}:host .popup-content .inside-content::-webkit-scrollbar-track,mgt-login .popup-content .inside-content::-webkit-scrollbar-track{background:#fff;border-radius:10px}:host .popup-content .inside-content::-webkit-scrollbar-track-piece,mgt-login .popup-content .inside-content::-webkit-scrollbar-track-piece{background:#fff}:host .popup-content .inside-content::-webkit-scrollbar-thumb,mgt-login .popup-content .inside-content::-webkit-scrollbar-thumb{background:grey;border-radius:10px;height:4px}:host .popup-content .add-account,mgt-login .popup-content .add-account{margin:0 8px}:host .popup-content .add-account .add-account-button,mgt-login .popup-content .add-account .add-account-button{position:relative;color:var(--add-account-button-color,var(--color-sub2,var(--neutral-foreground-hint,#717171)));border:none;background-color:var(--popup-background-color,var(--neutral-fill-rest,var(--background-color,#fff)));cursor:pointer;padding:0;--neutral-fill-stealth-rest:var(--popup-background-color, var(--neutral-fill-rest, var(--background-color, #ffffff)));--neutral-fill-stealth-hover:var(--popup-button-color--hover, var(--neutral-fill-stealth-hover, #efefef))}:host .popup-content .add-account .add-account-button:hover,mgt-login .popup-content .add-account .add-account-button:hover{--accent-foreground-hover:var(--add-account-button-color, var(--color-sub2, var(--neutral-foreground-hint, #717171)));background-color:var(--popup-button-color--hover,var(--neutral-fill-stealth-hover,#efefef))}:host .popup-content .add-account .add-account-button .account-switch-icon,mgt-login .popup-content .add-account .add-account-button .account-switch-icon{vertical-align:middle;display:inline-flex}:host .popup-content .add-account .add-account-button .account-switch-icon svg path,mgt-login .popup-content .add-account .add-account-button .account-switch-icon svg path{fill:var(--add-account-button-color,var(--color-sub2,var(--neutral-foreground-hint,#717171)))}:host .popup-content .main-profile,mgt-login .popup-content .main-profile{padding:0 21px;margin:var(--profile-spacing)}:host .popup-commands ul,mgt-login .popup-commands ul{list-style-type:none;margin:var(--popup-command-margin);padding:0 8px;margin:0;text-align:right}:host .popup-command,mgt-login .popup-command{font-family:var(--default-font-family);font-size:var(--popup-command-font-size);color:#023b8f;background-color:var(--popup-background-color,var(--neutral-fill-rest,var(--background-color,#fff)));border:none;cursor:pointer;transition:color .3s;word-spacing:inherit;text-indent:inherit;letter-spacing:inherit;--neutral-fill-stealth-rest:var(--popup-background-color, var(--neutral-fill-rest, var(--background-color, #ffffff)));--neutral-fill-stealth-hover:var(--popup-button-color--hover, var(--neutral-fill-stealth-hover, #efefef))}:host .popup-command:hover,mgt-login .popup-command:hover{--accent-foreground-hover:--accent-foreground-rest;background-color:var(--popup-button-color--hover,var(--neutral-fill-stealth-hover,#efefef))}[dir=rtl]{--popup-padding:24px 24px 16px 48px}[dir=rtl] .person .details{--details-spacing:0px 12px 0px 0px}[dir=rtl] .person .details.small{--details-spacing:0px 6px 0px 0px}
`],DD={signInLinkSubtitle:"Sign In",signOutLinkSubtitle:"Sign Out"};var __decorate$l=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},__metadata$k=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)},__awaiter$m=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};registerFluentComponents(sD,cD,JM,XM),exports.MgtLogin=class MgtLogin extends MgtTemplatedComponent{static get styles(){return MD}get strings(){return DD}get flyout(){return this.renderRoot.querySelector(".flyout")}static get requiredScopes(){return[...new Set(["user.read",...exports.MgtPerson.requiredScopes])]}constructor(){super(),this.showPresence=!1,this.loginView="full",this._userDetailsKey="-userDetails",this.flyoutOpened=()=>{this._isFlyoutOpen=!0},this.flyoutClosed=()=>{this._isFlyoutOpen=!1},this._isFlyoutOpen=!1}connectedCallback(){super.connectedCallback(),this.addEventListener("click",(t=>t.stopPropagation()))}login(){return __awaiter$m(this,void 0,void 0,(function*(){const t=Providers.globalProvider;(t.isMultiAccountSupportedAndEnabled||!this.userDetails&&this.fireCustomEvent("loginInitiated"))&&t&&t.login&&(yield t.login(),t.state===exports.ProviderState.SignedIn?this.fireCustomEvent("loginCompleted"):this.fireCustomEvent("loginFailed"))}))}logout(){return __awaiter$m(this,void 0,void 0,(function*(){if(!this.fireCustomEvent("logoutInitiated"))return;const t=Providers.globalProvider;t&&t.isMultiAccountSupportedAndEnabled&&localStorage.removeItem(t.getActiveAccount().id+this._userDetailsKey),t&&t.logout&&(yield t.logout(),this.userDetails=null,t.isMultiAccountSupportedAndEnabled&&localStorage.removeItem(t.getActiveAccount().id+this._userDetailsKey),this.hideFlyout(),this.fireCustomEvent("logoutCompleted"))}))}render(){const t={root:!0,"vertical-layout":this.usesVerticalPersonCard};return XI`
       <div class=${IA(t)} dir=${this.direction}>
         <div>
           ${this.renderButton()}
         </div>
         ${this.renderFlyout()}
       </div>
     `}loadState(){return __awaiter$m(this,void 0,void 0,(function*(){const t=Providers.globalProvider;t&&!this.userDetails&&(t.state===exports.ProviderState.SignedIn?(this.userDetails=yield getUserWithPhoto(t.graph.forComponent(this)),this.userDetails.personImage&&(this._image=this.userDetails.personImage),t.isMultiAccountSupportedAndEnabled&&localStorage.setItem(Providers.globalProvider.getActiveAccount().id+this._userDetailsKey,JSON.stringify(this.userDetails)),this.fireCustomEvent("loginCompleted")):this.userDetails=null)}))}buildAriaLabel(t,o){return t?this.userDetails?this.userDetails.displayName:this.strings.signInLinkSubtitle:o}renderButton(){var t;const o=(null===(t=Providers.globalProvider)||void 0===t?void 0:t.state)===exports.ProviderState.SignedIn,s=this.buildAriaLabel(o,this.strings.signInLinkSubtitle),l={"login-button":!0,"signed-in":o,small:"avatar"===this.loginView,"full-size":"full"===this.loginView,"no-click":this._isFlyoutOpen};return o&&this.userDetails?XI`
        <button
          aria-label=${s}
          @click=${this.onClick}
          class=${IA(l)}
        >
          ${this.renderSignedInButtonContent(this.userDetails,this._image)}
        </button>
      `:XI`
        <fluent-button
          appearance="neutral"
          aria-label=${s}
          ?disabled=${this.isLoadingState}
          @click=${this.onClick}
          class=${IA(l)}
        >
          ${this.renderSignedOutButtonContent()}
        </fluent-button>
      `}renderFlyout(){return mgtHtml`
      <mgt-flyout
        class="flyout"
        light-dismiss
        @opened=${this.flyoutOpened}
        @closed=${this.flyoutClosed}
      >
        <div slot="flyout">
          <!-- Setting the card fill ensures the correct colors on hover states -->
          <fluent-card card-fill-color="#fbfbfb">
            ${this.renderFlyoutContent()}
          </fluent-card>
        </div>
      </mgt-flyout>
      `}renderFlyoutContent(){if(this.userDetails)return XI`
       <div class="popup">
         <div class="popup-content">
           <div class="popup-commands">
             ${this.renderFlyoutCommands()}
           </div>
           <div class="inside-content">
             <div class="main-profile">
               ${this.renderFlyoutPersonDetails(this.userDetails,this._image)}
             </div>
             ${this.renderAccounts()}
           </div>
           ${this.renderAddAccountContent()}
         </div>
       </div>
     `}get hasMultipleAccounts(){var t,o,s,l;return(null===(t=Providers.globalProvider)||void 0===t?void 0:t.isMultiAccountSupportedAndEnabled)&&(null===(l=null===(s=null===(o=Providers.globalProvider)||void 0===o?void 0:o.getAllAccounts)||void 0===s?void 0:s.call(o))||void 0===l?void 0:l.length)>1}get usesVerticalPersonCard(){return"full"===this.loginView||this.hasMultipleAccounts}renderFlyoutPersonDetails(t,o){return this.renderTemplate("flyout-person-details",{personDetails:t,personImage:o})||mgtHtml`
        <mgt-person
          .personDetails=${t}
          .personImage=${o}
          .view=${exports.ViewType.twolines}
          .line2Property=${"email"}
          ?vertical-layout=${this.usesVerticalPersonCard}
          class="person"
        />
        `}renderFlyoutCommands(){return this.renderTemplate("flyout-commands",{handleSignOut:()=>this.logout()})||XI`
        <ul>
          <li>
            <fluent-button
              appearance="lightweight"
              class="popup-command"
              @click=${this.logout}
              aria-label=${this.strings.signOutLinkSubtitle}
            >
              ${this.strings.signOutLinkSubtitle}
            </fluent-button>
          </li>
        </ul>
      `}renderButtonContent(){return this.userDetails?this.renderSignedInButtonContent(this.userDetails,this._image):this.renderSignedOutButtonContent()}renderAddAccountContent(){if(Providers.globalProvider.isMultiAccountSupportedAndEnabled)return XI`
          <div class="add-account">
             <fluent-button
               appearance="lightweight"
               class="add-account-button"
               aria-label="Sign in with different account"
               @click=${()=>{this.login()}}
             >
               <i class="account-switch-icon">${getSvg($A.SelectAccount,"#000000")}</i>
               Sign in with a different account
             </fluent-button>
           </div>
       `}parsePersonDisplayConfiguration(){const t={view:exports.ViewType.twolines,avatarSize:"small"};switch(this.loginView){case"avatar":t.view=exports.ViewType.image,t.avatarSize="small";break;case"compact":t.view=exports.ViewType.oneline,t.avatarSize="small";break;default:t.view=exports.ViewType.twolines,t.avatarSize="large"}return t}renderSignedInButtonContent(t,o){const s=this.renderTemplate("signed-in-button-content",{personDetails:t,personImage:o}),l=this.parsePersonDisplayConfiguration();return s||mgtHtml`
        <mgt-person
          .personDetails=${this.userDetails}
          .personImage=${this._image}
          .view=${l.view}
          .showPresence=${this.showPresence}
          .avatarSize=${l.avatarSize}
          line2-property="email"
          class="person"
        />
       `}renderAccounts(){if(Providers.globalProvider.state===exports.ProviderState.SignedIn&&Providers.globalProvider.isMultiAccountSupportedAndEnabled){const t=Providers.globalProvider,o=t.getAllAccounts();if(o&&o.length>1)return XI`
         <div id="accounts">
           <fluent-design-system-provider>
             <fluent-listbox class="list-box" name="Account list">
              ${o.map((o=>{if(o.id!==t.getActiveAccount().id){const t=localStorage.getItem(o.id+this._userDetailsKey);return mgtHtml`
                    <fluent-option class="list-box-option" value="${o.name}" role="option">
                      <mgt-person
                        @click=${()=>this.setActiveAccount(o)}
                        @keyup=${t=>{"Enter"===t.key&&this.setActiveAccount(o)}}
                        .personDetails=${t?JSON.parse(t):null}
                        .fallbackDetails=${{displayName:o.name,mail:o.mail}}
                        .view=${exports.PersonViewType.twolines}
                        class="person"
                      />
                    </fluent-option>
                  `}}))}
             </fluent-listbox>
           </fluent-design-system-provider>
         </div>
       `}}setActiveAccount(t){Providers.globalProvider.setActiveAccount(t)}clearState(){this.userDetails=null,this._image=null}renderSignedOutButtonContent(){return this.renderTemplate("signed-out-button-content",null)||XI`
        <span>${this.strings.signInLinkSubtitle}</span>
      `}showFlyout(){const t=this.flyout;t&&t.open()}hideFlyout(){const t=this.flyout;t&&t.close()}onClick(){this.userDetails&&this._isFlyoutOpen?this.hideFlyout():this.userDetails?this.showFlyout():this.login()}},__decorate$l([e$1({attribute:"user-details",type:Object}),__metadata$k("design:type",Object)],exports.MgtLogin.prototype,"userDetails",void 0),__decorate$l([e$1({attribute:"show-presence",type:Boolean}),__metadata$k("design:type",Object)],exports.MgtLogin.prototype,"showPresence",void 0),__decorate$l([e$1({attribute:"login-view",type:String}),__metadata$k("design:type",String)],exports.MgtLogin.prototype,"loginView",void 0),__decorate$l([e$1({attribute:!1}),__metadata$k("design:type",Boolean)],exports.MgtLogin.prototype,"_isFlyoutOpen",void 0),exports.MgtLogin=__decorate$l([customElement("login"),__metadata$k("design:paramtypes",[])],exports.MgtLogin);var LD,__awaiter$l=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};exports.GroupType=void 0,(LD=exports.GroupType||(exports.GroupType={}))[LD.any=0]="any",LD[LD.unified=1]="unified",LD[LD.security=2]="security",LD[LD.mailenabledsecurity=4]="mailenabledsecurity",LD[LD.distribution=8]="distribution";const getGroupsInvalidationTime=()=>CacheService.config.groups.invalidationPeriod||CacheService.config.defaultInvalidationPeriod,getIsGroupsCacheEnabled=()=>CacheService.config.groups.isEnabled&&CacheService.config.isEnabled;function findGroups(t,o,s=10,l=exports.GroupType.any,h=""){return __awaiter$l(this,void 0,void 0,(function*(){const v="Group.Read.All";let m;const _=`${o||"*"}*${l}*${h}`;if(getIsGroupsCacheEnabled()){m=CacheService.getCache(AA.groups,AA.groups.stores.groupsQuery);const t=yield m.getValue(_);if(t&&getGroupsInvalidationTime()>Date.now()-t.timeCached&&t.top>=s)return t.groups.map((t=>JSON.parse(t))).slice(0,s+1)}let R,$="";const B=[];if(""!==o&&($=`(startswith(displayName,'${o}') or startswith(mailNickname,'${o}') or startswith(mail,'${o}'))`),h&&($+=`${o?" and ":""}${h}`),l!==exports.GroupType.any){const o=t.createBatch(),h=[];exports.GroupType.unified===(l&exports.GroupType.unified)&&h.push("groupTypes/any(c:c+eq+'Unified')"),exports.GroupType.security===(l&exports.GroupType.security)&&h.push("(mailEnabled eq false and securityEnabled eq true)"),exports.GroupType.mailenabledsecurity===(l&exports.GroupType.mailenabledsecurity)&&h.push("(mailEnabled eq true and securityEnabled eq true)"),exports.GroupType.distribution===(l&exports.GroupType.distribution)&&h.push("(mailEnabled eq true and securityEnabled eq false)"),$=$?`${$} and `:"";for(const t of h)o.get(t,`/groups?$filter=${$+t}`,["Group.Read.All"]);try{R=yield o.executeAll();for(const t of h)if(R.get(t).content.value)for(const o of R.get(t).content.value){let t=B.filter((t=>t.id===o.id));0===t.length&&B.push(o),t=[]}}catch(o){try{const o=[];for(const l of h)o.push(yield t.api("groups").filter(`${$} and ${l}`).top(s).count(!0).header("ConsistencyLevel","eventual").middlewareOptions(prepScopes(v)).get());return Promise.all(o)}catch(t){return[]}}}else if(0===B.length){const o=yield t.api("groups").filter($).top(s).count(!0).header("ConsistencyLevel","eventual").middlewareOptions(prepScopes(v)).get();return getIsGroupsCacheEnabled()&&o&&m.putValue(_,{groups:o.value.map((t=>JSON.stringify(t))),top:s}),o?o.value:null}return B}))}function getGroup(t,o,s){return __awaiter$l(this,void 0,void 0,(function*(){let l;if(getIsGroupsCacheEnabled()){l=CacheService.getCache(AA.groups,AA.groups.stores.groups);const t=yield l.getValue(o);if(t&&getGroupsInvalidationTime()>Date.now()-t.timeCached){const o=t.group?JSON.parse(t.group):null,l=s&&o?s.filter((t=>!Object.keys(o).includes(t))):null;if(!l||l.length<=1)return o}}let h=`/groups/${o}`;s&&(h=h+"?$select="+s.toString());const v=yield t.api(h).middlewareOptions(prepScopes("Group.Read.All")).get();return getIsGroupsCacheEnabled()&&l.putValue(o,{group:JSON.stringify(v)}),v}))}function getGroupsForGroupIds(t,o,s=""){return __awaiter$l(this,void 0,void 0,(function*(){if(!o||0===o.length)return[];const l=t.createBatch(),h={},v=[];let m;getIsGroupsCacheEnabled()&&(m=CacheService.getCache(AA.groups,AA.groups.stores.groups));for(const t of o){h[t]=null;let o=null;if(getIsGroupsCacheEnabled()&&(o=yield m.getValue(t)),o&&getGroupsInvalidationTime()>Date.now()-o.timeCached)h[t]=o.group?JSON.parse(o.group):null;else if(""!==t){let o=`/groups/${t}`;s&&(o=`${o}?$filters=${s}`),l.get(t,o,["Group.Read.All"]),v.push(t)}}try{const t=yield l.executeAll();for(const s of o){const o=t.get(s);o&&o.content&&(h[s]=o.content,getIsGroupsCacheEnabled()&&m.putValue(s,{group:JSON.stringify(o.content)}))}return Promise.all(Object.values(h))}catch(s){try{return o.filter((t=>v.includes(t))).forEach((o=>h[o]=getGroup(t,o))),getIsGroupsCacheEnabled()&&o.filter((t=>v.includes(t))).forEach((t=>__awaiter$l(this,void 0,void 0,(function*(){return m.putValue(t,{group:JSON.stringify(yield h[t])})})))),Promise.all(Object.values(h))}catch(t){return[]}}}))}const FD=[i$4`
:host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\e70d"}.ms-Icon--ChevronUp::before{content:"\\\e70e"}.ms-Icon--Contact::before{content:"\\\e77b"}.ms-Icon--AddFriend::before{content:"\\\e8fa"}.ms-Icon--OutlookLogoInverse::before{content:"\\\eb6d"}
`];var __decorate$k=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m};let UD=class MgtSpinner extends MgtBaseComponent{static get styles(){return FD}render(){return XI`<fluent-progress-ring title="spinner"></fluent-progress-ring>`}};UD=__decorate$k([customElement("spinner")],UD);const HD=[i$4`
:host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\e70d"}.ms-Icon--ChevronUp::before{content:"\\\e70e"}.ms-Icon--Contact::before{content:"\\\e77b"}.ms-Icon--AddFriend::before{content:"\\\e8fa"}.ms-Icon--OutlookLogoInverse::before{content:"\\\eb6d"}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--selected-person-background-color:#f0f0f0}.mgt-dark{--selected-person-background-color:#4f4f4f}:host{font-family:var(--default-font-family);font-size:14px;height:24px;display:contents;overflow:hidden;position:absolute;width:135px;left:0;top:0;border-radius:12px;--dropdown-item-hover-background:#f7f7f7}:host .root,mgt-people-picker .root{display:block}.people-picker{background-color:var(--input-background-color,#fff);box-sizing:border-box;background:padding-box linear-gradient(var(--neutral-fill-input-rest),var(--neutral-fill-input-rest)),border-box var(--neutral-stroke-input-rest);border:calc(var(--stroke-width) * 1px) solid transparent;border-radius:calc(var(--control-corner-radius) * 1px);min-height:calc((var(--base-height-multiplier) + var(--density)) * var(--design-unit) * 1px);padding:3px}.people-picker:hover{background:padding-box linear-gradient(var(--neutral-fill-input-focus),var(--neutral-fill-input-focus)),border-box var(--neutral-stroke-input-rest)}.people-picker.focused{border-bottom:calc(var(--focus-stroke-width) * 1px) solid var(--accent-fill-rest);border-bottom-left-radius:calc(var(--control-corner-radius) * 1px);border-bottom-right-radius:calc(var(--control-corner-radius) * 1px)}.people-picker.disabled{pointer-events:none}.people-picker .people-picker-inner{flex:1 1 auto;display:flex;flex-wrap:wrap;vertical-align:middle;list-style-type:none;font-style:normal;font-weight:400;overflow:hidden}.people-picker .flyout .search-box{display:flex;height:23px}.people-picker .flyout .search-box .search-icon{padding:5px}.people-picker .flyout .search-box.search-box-start{line-height:normal;margin-inline-start:0;margin-inline-end:0}.people-picker .flyout .search-box__input{box-sizing:border-box;border-width:0;border-style:none;display:flex;flex:1 0 auto;font-family:var(--default-font-family);position:relative;outline:0;font-style:normal;font-weight:400;font-size:14px;background-color:var(--input-background-color,#fff);color:var(--color-sub1,var(--neutral-foreground-rest,#1a1a1a));word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}.people-picker .flyout .search-box__input::placeholder{color:var(--placeholder-color,#605e5c)}.people-picker .flyout .flyout-root{position:relative;top:8px;padding:unset;border-radius:2px;min-width:260px;overflow-y:auto;text-align:left;list-style-type:none;background-color:var(--dropdown-background-color,var(--list-background-color,#fff));max-height:var(--mgt-flyout-set-height,unset);border-radius:8px}.people-picker .flyout .flyout-root li{cursor:pointer}.people-picker .flyout .flyout-root .people-list{list-style:none;padding:unset;margin:unset}.people-picker .flyout .flyout-root .people-list .list-person{display:flex;flex-direction:row;align-items:center;padding:12px;font-style:normal;font-weight:600;font-size:14px;margin:var(--file-item-margin,4px);border-radius:4px}.people-picker .flyout .flyout-root .people-list .list-person:hover{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,var(--neutral-fill-hover,#f7f7f7)))}.people-picker .flyout .flyout-root .people-list .list-person:hover .people-person-text-area{color:var(--dropdown-item-text-hover-color,#000)}.people-picker .flyout .flyout-root .people-list .list-person.focused{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,var(--neutral-fill-hover,#f7f7f7)))}.people-picker .flyout .flyout-root .people-list .list-person.focused .people-person-text-area{color:var(--dropdown-item-text-hover-color,#000)}.people-picker .flyout .flyout-root .people-list .list-person .people-person-text-area{margin-left:13px;flex:1 1 0;max-height:40px;overflow:hidden;color:var(--dropdown-item-text-color,#000)}.people-picker .flyout .flyout-root .people-list .list-person .people-person-text-area .people-person-text{font-size:14px;font-weight:400;margin:0;padding:0}.people-picker .flyout .flyout-root .people-list .list-person .people-person-text-area .people-person-text.highlight-search-text{font-weight:700}.people-picker .selected-list{list-style:none;padding:0;display:contents}.people-picker .selected-list__person-wrapper,.people-picker .selected-list__person-wrapper-highlighted,.people-picker .selected-list__person-wrapper-highlighted:hover{display:flex;margin:1px;align-items:center;border-radius:12px;height:23px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;position:relative;background-color:var(--selected-person-background-color,#f0f0f0)}.people-picker .selected-list__person-wrapper-highlighted:hover,.people-picker .selected-list__person-wrapper:hover{background-color:#fafafa}.people-picker .selected-list__person-wrapper-highlighted__person,.people-picker .selected-list__person-wrapper__person{overflow:hidden;min-width:100%;--avatar-size-s:24px;margin-left:0;--color:var(--color-sub1, var(--neutral-foreground-rest, #1a1a1a));color:var(--color-sub1,var(--neutral-foreground-rest,#1a1a1a))}.people-picker .selected-list__person-wrapper-highlighted__overflow,.people-picker .selected-list__person-wrapper__overflow{margin-left:25px}.people-picker .selected-list__person-wrapper-highlighted__overflow__gradient,.people-picker .selected-list__person-wrapper__overflow__gradient{content:"";position:absolute;margin-right:23px;width:10px;height:90%;top:0;right:0;background-image:linear-gradient(to right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f0f0f0) 100%);background-image:-moz-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f0f0f0) 100%);background-image:-o-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f0f0f0) 100%);background-image:-ms-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f0f0f0) 100%);background-image:-webkit-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f0f0f0) 100%);background-image:none}.people-picker .selected-list__person-wrapper-highlighted__overflow__close-icon,.people-picker .selected-list__person-wrapper__overflow__close-icon{font-family:FabricMDL2Icons;cursor:pointer;color:var(--color-sub1,var(--neutral-foreground-rest,#1a1a1a));display:flex;flex-direction:column;align-items:center;position:absolute;height:24px;width:24px;right:0;top:0;border-radius:12px;line-height:24px}.people-picker .selected-list__person-wrapper-highlighted__overflow__close-icon:hover,.people-picker .selected-list__person-wrapper__overflow__close-icon:hover{color:#023b8f}.people-picker .selected-list__person-wrapper-highlighted__overflow__close-icon:focus,.people-picker .selected-list__person-wrapper-highlighted__overflow__close-icon:focus-visible,.people-picker .selected-list__person-wrapper__overflow__close-icon:focus,.people-picker .selected-list__person-wrapper__overflow__close-icon:focus-visible{outline-offset:-4px;outline-width:1px;outline-style:solid}.people-picker .selected-list__person-wrapper-highlighted,.people-picker .selected-list__person-wrapper-highlighted:hover{background:#005393}.people-picker .selected-list__person-wrapper-highlighted__person{color:#fff;--color:white}.people-picker .selected-list__person-wrapper-highlighted__overflow__gradient{background-image:none}.people-picker .selected-list__person-wrapper-highlighted__overflow__close-icon{background:#005393;color:#fff;line-height:24px}.people-picker .selected-list__person-wrapper-highlighted:hover{background-color:#006cbe}.person{margin-left:6px;width:100%;cursor:default;--avatar-size-s:32px;--line2-color:#717171;--font-size:14px;--font-weight:600}:host .loading-text,:host .search-error-text,mgt-people-picker .loading-text,mgt-people-picker .search-error-text{font-family:var(--default-font-family);font-style:normal;font-weight:600;font-size:14px;line-height:19px;text-align:center;margin-left:50px;margin-right:50px;color:#023b8f}:host .message-parent,mgt-people-picker .message-parent{padding:2px;margin-top:30px;margin-bottom:30px;display:flex;flex-direction:column;align-items:center;justify-content:center;vertical-align:middle}:host .people-person-job-title,mgt-people-picker .people-person-job-title{flex:100%;order:3;font-weight:400;font-size:12px}:host .people-person-job-title.uppercase,mgt-people-picker .people-person-job-title.uppercase{text-transform:uppercase}mgt-flyout{flex:1 0 auto;--box-shadow:none;--mgt-flyout-border-radius:var(--layer-corner-radius)}[dir=rtl] .person{margin-right:6px;--details-spacing:0px 12px 0 0;width:100%}[dir=rtl] .selected-list{margin-right:8px!important}.people-picker [dir=rtl] .selected-list__person-wrapper-highlighted,[dir=rtl] .people-picker .selected-list__person-wrapper-highlighted,[dir=rtl] .selected-list__person-wrapper{margin-left:6px!important}.people-picker [dir=rtl] .selected-list__person-wrapper-highlighted__person,[dir=rtl] .people-picker .selected-list__person-wrapper-highlighted__person,[dir=rtl] .selected-list__person-wrapper__person{margin-right:0!important;margin-left:4px!important}.people-picker [dir=rtl] .selected-list__person-wrapper-highlighted__overflow__gradient,[dir=rtl] .people-picker .selected-list__person-wrapper-highlighted__overflow__gradient,[dir=rtl] .selected-list__person-wrapper__overflow__gradient{right:auto!important;position:absolute!important;margin-right:0!important;width:10px!important;height:90%;top:0}.people-picker [dir=rtl] .selected-list__person-wrapper-highlighted__overflow__close-icon,[dir=rtl] .people-picker .selected-list__person-wrapper-highlighted__overflow__close-icon,[dir=rtl] .selected-list__person-wrapper__overflow__close-icon{right:auto!important;margin-left:5px!important;left:0!important}[dir=rtl] .selected-list__person-wrapper-highlighted__overflow__close-icon{right:auto!important;left:0!important}[dir=rtl] .people-person-text-area{margin-right:13px;margin-left:0!important}[dir=rtl] .flyout-root{text-align:right!important}@media (forced-colors:active) and (prefers-color-scheme:dark){svg,svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important;color:#fff!important}.flyout-root{border:1px solid #fff}.people-list .list-person{border:solid 1px #fff}}@media (forced-colors:active) and (prefers-color-scheme:light){svg,svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important;color:#000!important}.flyout-root{border:1px solid #000}.people-list .list-person{border:solid 1px #000}}
`],BD={inputPlaceholderText:"Start typing a name",noResultsFound:"We didn't find any matches.",loadingMessage:"Loading...",suggestedContact:"suggested contact",suggestedContacts:"suggested contacts",selected:"selected",removeSelectedItem:"remove selected item"};var __decorate$j=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},__metadata$j=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)},__awaiter$k=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};exports.MgtPeoplePicker=class MgtPeoplePicker extends MgtTemplatedComponent{static get styles(){return HD}get strings(){return BD}get flyout(){return this.renderRoot.querySelector(".flyout")}get input(){return this.renderRoot.querySelector(".search-box__input")}get groupId(){return this._groupId}set groupId(t){this._groupId!==t&&(this._groupId=t,this.requestStateUpdate(!0))}get groupIds(){return this._groupIds}set groupIds(t){arraysAreEqual(this._groupIds,t)||(this._groupIds=t,this.requestStateUpdate(!0))}get type(){return this._type}set type(t){this._type!==t&&(this._type=t,this.requestStateUpdate(!0))}get groupType(){return this._groupType}set groupType(t){this._groupType!==t&&(this._groupType=t,this.requestStateUpdate(!0))}get userType(){return this._userType}set userType(t){this._userType!==t&&(this._userType=t,this.requestStateUpdate(!0))}get transitiveSearch(){return this._transitiveSearch}set transitiveSearch(t){this.transitiveSearch!==t&&(this._transitiveSearch=t,this.requestStateUpdate(!0))}get people(){return this._people}set people(t){arraysAreEqual(this._people,t)||(this._people=t,this.requestStateUpdate(!0))}get showMax(){return this._showMax}set showMax(t){t!==this._showMax&&(this._showMax=t,this.requestStateUpdate(!0))}get selectedPeople(){return this._selectedPeople}set selectedPeople(t){t||(t=[]),arraysAreEqual(this._selectedPeople,t)||(this._selectedPeople=t)}get defaultSelectedUserIds(){return this._defaultSelectedUserIds}set defaultSelectedUserIds(t){arraysAreEqual(this._defaultSelectedUserIds,t)||(this._defaultSelectedUserIds=t,this.requestStateUpdate(!0))}get defaultSelectedGroupIds(){return this._defaultSelectedGroupIds}set defaultSelectedGroupIds(t){arraysAreEqual(this._defaultSelectedGroupIds,t)||(this._defaultSelectedGroupIds=t,this.requestStateUpdate(!0))}get userIds(){return this._userIds}set userIds(t){arraysAreEqual(this._userIds,t)||(this._userIds=t,this.requestStateUpdate(!0))}get userFilters(){return this._userFilters}set userFilters(t){this._userFilters=t,this.requestStateUpdate(!0)}get peopleFilters(){return this._peopleFilters}set peopleFilters(t){this._peopleFilters=t,this.requestStateUpdate(!0)}get groupFilters(){return this._groupFilters}set groupFilters(t){this._groupFilters=t,this.requestStateUpdate(!0)}static get requiredScopes(){return[...new Set(["user.read.all","people.read","group.read.all","user.readbasic.all",...exports.MgtPerson.requiredScopes])]}constructor(){super(),this._type=exports.PersonType.person,this._groupType=exports.GroupType.any,this._userType=exports.UserType.any,this._selectedPeople=[],this._arrowSelectionCount=-1,this._highlightedUsers=[],this._currentHighlightedUserPos=0,this._isFocused=!1,this._setAnyEmail=!1,this._isKeyboardFocus=!0,this._dir=this.direction,this.clearState(),this._showLoading=!0,this.showMax=6,this.disableImages=!1,this.disabled=!1,this.allowAnyEmail=!1,this.addEventListener("copy",this.handleCopy),this.addEventListener("cut",this.handleCut),this.addEventListener("paste",this.handlePaste)}focus(t){this.input&&(this.input.focus(t),this.input.select())}selectUsersById(t){return __awaiter$k(this,void 0,void 0,(function*(){const o=Providers.globalProvider,s=Providers.globalProvider.graph;if(o&&o.state===exports.ProviderState.SignedIn)for(const o in t){const l=t[o];try{const t=yield getUser(s,l);this.addPerson(t)}catch(t){if(t.message&&t.message.includes("does not exist")&&this.allowAnyEmail&&isValidEmail(l)){const t={mail:l,displayName:l};this.addPerson(t)}}}}))}selectGroupsById(t){return __awaiter$k(this,void 0,void 0,(function*(){const o=Providers.globalProvider,s=Providers.globalProvider.graph;if(o&&o.state===exports.ProviderState.SignedIn)for(const o in t)try{const l=yield getGroup(s,t[o]);this.addPerson(l)}catch(t){}}))}render(){const t=this.renderTemplate("default",{people:this._foundPeople});if(t)return t;const o=this.renderSelectedPeople(this.selectedPeople),s=this.renderInput(),l=this.renderFlyout(s),h={focused:this._isFocused,"people-picker":!0,disabled:this.disabled};return XI`
      <div dir=${this._dir} class=${IA(h)}>
          <div class="people-picker-inner">${o} ${l}</div>
      </div>
    `}clearState(){this.selectedPeople=[],this.userInput="",this._highlightedUsers=[],this._currentHighlightedUserPos=0}requestStateUpdate(t){return t&&(this._groupPeople=null,this._foundPeople=null,this.selectedPeople=[],this.defaultPeople=null),super.requestStateUpdate(t)}renderInput(){var t;const o=(null===(t=this.selectedPeople)||void 0===t?void 0:t.length)>0,s=this.disabled?this.placeholder||"":this.placeholder?this.placeholder:this.strings.inputPlaceholderText,l={"search-box":!0,"search-box-start":o};return"single"===(this.selectionMode?this.selectionMode:"multiple")&&this.selectedPeople.length>=1?(this.lostFocus(),XI``):XI`
       <div class="${IA(l)}">
         <span class="search-icon">${getSvg($A.Search)}</span>
         <input
           id="people-picker-input"
           class="search-box__input"
           type="text"
           role="combobox"
           placeholder=${s}
           autocomplete="off"
           aria-label=${this.ariaLabel||""}
           aria-controls="suggestions-list"
           aria-haspopup="listbox"
           aria-autocomplete="list"
           aria-expanded="false"
           @click="${this.handleInputClick}"
           @focus="${this.gainedFocus}"
           @keydown="${this.onUserKeyDown}"
           @keyup="${this.onUserKeyUp}"
           @input="${this.onUserInput}"
           @blur=${this.lostFocus}
           ?disabled=${this.disabled}
         />
       </div>
     `}renderSelectedPeople(t){return t&&t.length?(this.hideSearchIcon(),XI`
       <ul
        id="selected-list"
        aria-label="${this.strings.selected}"
        class="selected-list"
        >${t.slice(0,t.length).map((t=>XI`
             <li
             class="selected-list__person-wrapper">
               ${this.renderTemplate("selected-person",{person:t},`selected-${t.id?t.id:t.displayName}`)||this.renderSelectedPerson(t)}

               <div class="selected-list__person-wrapper__overflow">
                 <div class="selected-list__person-wrapper__overflow__gradient"></div>
                 <div
                   tabindex="0"
                   role="button"
                   aria-label="${this.strings.removeSelectedItem} ${t.displayName}"
                   class="selected-list__person-wrapper__overflow__close-icon"
                   @click="${o=>this.removePerson(t,o)}"
                   @keydown="${o=>this.handleRemovePersonKeyDown(t,o)}"
                 >
                   \uE711
                 </div>
               </div>
              </li>
           `))}</ul>
     `):XI``}renderFlyout(t){return mgtHtml`
       <mgt-flyout light-dismiss class="flyout">
         ${t}
         <fluent-card
          slot="flyout"
          class="flyout-root"
          @wheel=${t=>this.handleSectionScroll(t)}
          class="custom">
           ${this.renderFlyoutContent()}
         </fluent-card>
       </mgt-flyout>
     `}renderFlyoutContent(){if(this.isLoadingState||this._showLoading)return this.renderLoading();const t=this._foundPeople;return t&&0!==t.length&&0!==this.showMax?this.renderSearchResults(t):this.renderNoData()}renderLoading(){return this.renderTemplate("loading",null)||mgtHtml`
         <div class="message-parent">
           <mgt-spinner></mgt-spinner>
           <div label="loading-text" aria-label="loading" class="loading-text">
             ${this.strings.loadingMessage}
           </div>
         </div>
       `}renderNoData(){if(this._isFocused)return this.renderTemplate("error",null)||this.renderTemplate("no-data",null)||XI`
         <div class="message-parent">
           <div label="search-error-text" aria-label=${this.strings.noResultsFound} class="search-error-text">
             ${this.strings.noResultsFound}
           </div>
         </div>
       `}renderSearchResults(t){const o=t.filter((t=>t.id));return XI`
      <ul
        id="suggestions-list"
        aria-label="${this.strings.suggestedContacts}"
        class="people-list"
        role="listbox">
          ${GA(o,(t=>t.id),(t=>XI`
              <li
              id="${t.id}"
              aria-label=" ${this.strings.suggestedContact} ${t.displayName}"
              class="list-person"
              role="option"
              @click="${o=>this.handleSuggestionClick(t)}">
                ${this.renderPersonResult(t)}
              </li>
            `))}
       </ul>
     `}renderPersonResult(t){const o=t;return o.jobTitle||o.mail,o.jobTitle,this.renderTemplate("person",{person:t},t.id)||mgtHtml`
         <mgt-person
          class="person"
          show-presence
          view="twoLines"
          line2-property="jobTitle,mail"
          dir=${this._dir}
          .personDetails=${t}
          .fetchImage=${!this.disableImages}>
          .personCardInteraction=${exports.PersonCardInteraction.none}
        </mgt-person>`}renderSelectedPerson(t){return mgtHtml`
       <mgt-person
         tabindex="-1"
         class="person selected-list__person-wrapper__person"
         .personDetails=${t}
         .fetchImage=${!this.disableImages}
         .view=${exports.ViewType.oneline}
         .personCardInteraction=${exports.PersonCardInteraction.click}
       ></mgt-person>
     `}loadState(){var t,o;return __awaiter$k(this,void 0,void 0,(function*(){let s=this.people;const l=this.userInput.toLowerCase(),h=Providers.globalProvider;if(s){if(l){const t=s.filter((t=>null==t?void 0:t.displayName.toLowerCase().includes(l)));s=t}this._showLoading=!1}else if(!s&&h&&h.state===exports.ProviderState.SignedIn){const v=h.graph.forComponent(this);if(!l.length){if(this.defaultPeople)s=this.defaultPeople;else{if(this.groupId||this.groupIds){if(null===this._groupPeople)if(this.groupId)try{this.type===exports.PersonType.group?this._groupPeople=yield findGroupMembers(v,null,this.groupId,this.showMax,this.type,this.transitiveSearch):this._groupPeople=yield findGroupMembers(v,null,this.groupId,this.showMax,this.type,this.transitiveSearch,this.userFilters,this.peopleFilters)}catch(t){this._groupPeople=[]}else if(this.groupIds)if(this.type===exports.PersonType.group)try{this._groupPeople=yield getGroupsForGroupIds(v,this.groupIds,this.groupFilters)}catch(t){this._groupPeople=[]}else try{const t=yield findUsersFromGroupIds(v,"",this.groupIds,this.showMax,this.type,this.transitiveSearch,this.userFilters);this._groupPeople=t}catch(t){this._groupPeople=[]}s=this._groupPeople||[]}else if(this.type===exports.PersonType.person||this.type===exports.PersonType.any)if(this.userIds)s=yield getUsersForUserIds(v,this.userIds,"",this.userFilters);else{const t=this.userType===exports.UserType.user||this.userType===exports.UserType.contact;s=this._userFilters&&t?yield function getUsers(t,o="",s=10){return __awaiter$A(this,void 0,void 0,(function*(){let l;const h=""===o?"*":o,v={maxResults:s,results:null};if(getIsUsersCacheEnabled()){l=CacheService.getCache(AA.users,AA.users.stores.userFilters);const t=yield l.getValue(h);if(t&&getUserInvalidationTime()>Date.now()-t.timeCached)return t.results.map((t=>JSON.parse(t)))}const m=t.api("/users").top(s);o&&m.filter(o);try{const t=yield m.middlewareOptions(prepScopes("user.read")).get();return getIsUsersCacheEnabled()&&t&&(v.results=t.value.map((t=>JSON.stringify(t))),l.putValue(o,v)),t.value}catch(t){}}))}(v,this._userFilters,this.showMax):yield getPeople(v,this.userType,this._peopleFilters)}else if(this.type===exports.PersonType.group)if(this.groupIds)try{s=yield this.getGroupsForGroupIds(v,s)}catch(t){}else{let t=(yield findGroups(v,"",this.showMax,this.groupType,this._groupFilters))||[];t.length>0&&t[0].value&&(t=t[0].value),s=t}this.defaultPeople=s}this._isFocused&&(this._showLoading=!1)}if(!((null===(t=this.defaultSelectedUserIds)||void 0===t?void 0:t.length)>0||(null===(o=this.defaultSelectedGroupIds)||void 0===o?void 0:o.length)>0)||this.selectedPeople.length||this.defaultSelectedUsers||(this.defaultSelectedUsers=yield getUsersForUserIds(v,this.defaultSelectedUserIds,"",this.userFilters),this.defaultSelectedGroups=yield getGroupsForGroupIds(v,this.defaultSelectedGroupIds,this.peopleFilters),this.defaultSelectedGroups=this.defaultSelectedGroups.filter((t=>null!==t)),this.defaultSelectedUsers=this.defaultSelectedUsers.filter((t=>null!==t)),this.selectedPeople=[...this.defaultSelectedUsers,...this.defaultSelectedGroups],this.requestUpdate(),this.fireCustomEvent("selectionChanged",this.selectedPeople)),l)if(s=[],this.groupId)s=(yield findGroupMembers(v,l,this.groupId,this.showMax,this.type,this.transitiveSearch,this.userFilters,this.peopleFilters))||[];else{if(this.type===exports.PersonType.person||this.type===exports.PersonType.any){try{if(this.userType===exports.UserType.contact||this.userType===exports.UserType.user)s=this.userIds&&this.userIds.length?yield getUsersForUserIds(v,this.userIds,l,this._userFilters):yield findUsers(v,l,this.showMax,this._userFilters);else if(this.groupIds)try{s=yield findUsersFromGroupIds(v,l,this.groupIds,this.showMax,this.type,this.transitiveSearch,this.userFilters)}catch(t){}else s=this.userIds&&this.userIds.length?yield getUsersForUserIds(v,this.userIds,l,this._userFilters):(yield findPeople(v,l,this.showMax,this.userType,this._peopleFilters))||[]}catch(t){}if(s&&s.length<this.showMax&&this.userType!==exports.UserType.contact&&this.type!==exports.PersonType.person)try{const t=(yield findUsers(v,l,this.showMax,this._userFilters))||[],o=new Set(s.map((t=>t.id)));for(const l of t)o.has(l.id)||s.push(l)}catch(t){}}if((this.type===exports.PersonType.group||this.type===exports.PersonType.any)&&s.length<this.showMax)if(this.groupIds)try{s=yield function findGroupsFromGroupIds(t,o,s,l=10,h=exports.GroupType.any,v=""){return __awaiter$l(this,void 0,void 0,(function*(){const m=[],_=yield findGroups(t,o,l,h,v);if(_)for(let t=0;t<_.length;t++){const o=_[t];o.id&&s.includes(o.id)&&m.push(o)}return m}))}(v,l,this.groupIds,this.showMax,this.groupType,this.userFilters)}catch(t){}else{let t=[];try{t=(yield findGroups(v,l,this.showMax,this.groupType,this._groupFilters))||[],s=s.concat(t)}catch(t){}}}}this._foundPeople=this.filterPeople(s)}))}getGroupsForGroupIds(t,o){return __awaiter$k(this,void 0,void 0,(function*(){const s=yield getGroupsForGroupIds(t,this.groupIds,this.groupFilters);for(const t of s)o=o.concat(t);return o=o.filter((t=>t))}))}hideFlyout(){const t=this.flyout;t&&t.close(),this.input&&(this.input.setAttribute("aria-expanded","false"),this.input.setAttribute("aria-activedescendant","")),this._arrowSelectionCount=-1}showFlyout(){const t=this.flyout;t&&t.open(),this.input&&this.input.setAttribute("aria-expanded","true")}removePerson(t,o){var s;o.stopPropagation();const l=this.selectedPeople.filter((o=>!t.id&&o.displayName?o.displayName!==t.displayName:o.id!==t.id));this.selectedPeople=l,this.loadState(),this.fireCustomEvent("selectionChanged",this.selectedPeople),this.selectedPeople.length<=0&&this.showSearchIcon(),null===(s=this.input)||void 0===s||s.focus()}handleRemovePersonKeyDown(t,o){"Enter"===o.key&&this.removePerson(t,o)}addPerson(t){if(t){setTimeout((()=>{this.clearInput()}),50);const o=this.selectedPeople.filter((o=>!t.id&&o.displayName?o.displayName===t.displayName:o.id===t.id));0===o.length&&(this.selectedPeople=[...this.selectedPeople,t],this.fireCustomEvent("selectionChanged",this.selectedPeople),this.selectedPeople.length<=0?this.showSearchIcon():this.hideSearchIcon(),this.loadState(),this._foundPeople=[],this._arrowSelectionCount=-1)}}clearInput(){this.clearHighlighted(),"single"!==this.selectionMode&&(this.input.value=""),this.userInput=""}handleInputClick(){this.flyout.isOpen||this.handleUserSearch()}gainedFocus(){this.clearHighlighted(),this._isFocused=!0,this.loadState()}lostFocus(){this._isFocused=!1,this._arrowSelectionCount=-1,this.input&&(this.input.setAttribute("aria-expanded","false"),this.input.setAttribute("aria-activedescendant",""));const t=this.renderRoot.querySelector(".people-list");if(t)for(let o=0;o<t.children.length;o++)t.children[o].classList.remove("focused"),t.children[o].setAttribute("aria-selected","false");this.requestUpdate()}onUserKeyUp(t){const o=(t.ctrlKey||t.metaKey)&&"v"===t.key,s=["ControlLeft","ControlRight"].includes(t.code)||t.ctrlKey||t.metaKey,l=["ArrowDown","ArrowRight","ArrowUp","ArrowLeft"].includes(t.code);return!o&&s||l?((s||["ArrowLeft","ArrowRight"].includes(t.code))&&this.hideFlyout(),void(["ArrowDown"].includes(t.code)&&!this.flyout.isOpen&&this._isFocused&&this.handleUserSearch())):t.shiftKey||"ShiftLeft"===t.code||"Tab"===t.code||"Enter"===t.code?void 0:"Escape"===t.code?(this.clearInput(),this._foundPeople=[],void(this._arrowSelectionCount=-1)):"Backspace"===t.code&&0===this.userInput.length&&this.selectedPeople.length>0?(this.clearHighlighted(),this.selectedPeople=this.selectedPeople.splice(0,this.selectedPeople.length-1),this.loadState(),this.hideFlyout(),this.selectedPeople.length<=0&&this.showSearchIcon(),void this.fireCustomEvent("selectionChanged",this.selectedPeople)):void("Comma"!==t.code&&"Semicolon"!==t.code||this.allowAnyEmail&&(this._setAnyEmail=!0,t.preventDefault(),t.stopPropagation()))}onUserInput(t){const o=t.target;if(this.userInput=o.value,this.userInput){isValidEmail(this.userInput)&&this.allowAnyEmail?this._setAnyEmail&&this.handleAnyEmail():this.handleUserSearch(),this._setAnyEmail=!1}}handleAnyEmail(){if(this._showLoading=!1,this._arrowSelectionCount=-1,isValidEmail(this.userInput)){const t={mail:this.userInput,displayName:this.userInput};this.addPerson(t)}this.hideFlyout(),this.input&&(this.input.focus(),this._isFocused=!0)}handleSuggestionClick(t){this.addPerson(t),this.hideFlyout(),this.input.focus()}handleUserSearch(){this._debouncedSearch||(this._debouncedSearch=debounce((()=>__awaiter$k(this,void 0,void 0,(function*(){const t=setTimeout((()=>{this._showLoading=!0}),50);yield this.loadState(),clearTimeout(t),this._showLoading=!1,this._arrowSelectionCount=-1,this.showFlyout()}))),400)),this._debouncedSearch()}showSearchIcon(){var t;const o=null===(t=this.renderRoot)||void 0===t?void 0:t.querySelector(".search-icon");void 0===o&&null===o||(o.style.display=null)}hideSearchIcon(){var t;const o=null===(t=this.renderRoot)||void 0===t?void 0:t.querySelector(".search-icon");void 0===o&&null===o||(o.style.display="none")}onUserKeyDown(t){const o=this.renderRoot.querySelector(".selected-list"),s=t.ctrlKey||t.metaKey;if(s&&o){const l=o.querySelectorAll("mgt-person.selected-list__person-wrapper__person");if(this.hideFlyout(),s&&"ArrowLeft"===t.code)this._currentHighlightedUserPos=(this._currentHighlightedUserPos-1+l.length)%l.length,this._currentHighlightedUserPos>=0&&!Number.isNaN(this._currentHighlightedUserPos)?this._highlightedUsers.push(l[this._currentHighlightedUserPos]):this._currentHighlightedUserPos=0;else if(s&&"ArrowRight"===t.code){const t=this._highlightedUsers.pop();if(t){const o=t.parentElement;o&&(this.clearHighlighted(o),this._currentHighlightedUserPos++)}}else s&&"KeyA"===t.code&&(this._highlightedUsers=[],l.forEach((t=>this._highlightedUsers.push(t))));return void(this._highlightedUsers&&this.highlightSelectedPeople(this._highlightedUsers))}if(this.clearHighlighted(),!this.flyout.isOpen)return;const l=t.target;if("ArrowUp"!==t.key&&"ArrowDown"!==t.key||(this.handleArrowSelection(t),l.value.length>0&&t.preventDefault()),"Enter"===t.code)if(!t.shiftKey&&this._foundPeople){t.preventDefault(),t.stopPropagation();const o=this._foundPeople[this._arrowSelectionCount];o&&(this.addPerson(o),this.hideFlyout(),this.input.value="")}else this.allowAnyEmail&&this.handleAnyEmail();"Escape"===t.code&&t.stopPropagation(),"Tab"===t.code&&this.hideFlyout(),"Comma"!==t.code&&"Semicolon"!==t.code||this.allowAnyEmail&&(t.preventDefault(),t.stopPropagation(),this.userInput=l.value,this.handleAnyEmail())}writeHighlightedText(){return __awaiter$k(this,void 0,void 0,(function*(){const t=[];for(const o of this._highlightedUsers){const{id:s,displayName:l,email:h,userPrincipalName:v,scoredEmailAddresses:m}=o._personDetails;let _;_=m&&m.length>0?m.pop().address:v||h,t.push({id:s,displayName:l,email:_})}let o="";t.length>0&&(o=JSON.stringify(t)),yield navigator.clipboard.writeText(o)}))}handleCut(){return __awaiter$k(this,void 0,void 0,(function*(){yield this.writeHighlightedText(),this.removeHighlightedOnCut()}))}handleCopy(){return __awaiter$k(this,void 0,void 0,(function*(){yield this.writeHighlightedText()}))}handlePaste(){return __awaiter$k(this,void 0,void 0,(function*(){try{const t=yield navigator.clipboard.readText();if(t)try{const o=JSON.parse(t);if(o&&o.length>0)for(const t of o)this.addPerson(t)}catch(o){if(o instanceof SyntaxError){const o=[",",";"];let s;try{for(let l=0;l<o.length;l++)if(s=t.split(o[l]),s.length>1){this.hideFlyout(),this.selectUsersById(s);break}}catch(t){}}}}catch(t){}}))}removeHighlightedOnCut(){this.selectedPeople=this.selectedPeople.splice(0,this.selectedPeople.length-this._highlightedUsers.length),this._highlightedUsers=[],this._currentHighlightedUserPos=0,this.loadState(),this.hideFlyout(),this.fireCustomEvent("selectionChanged",this.selectedPeople)}highlightSelectedPeople(t){for(let o=0;o<t.length;o++){const s=t[o].parentElement;s.setAttribute("class","selected-list__person-wrapper-highlighted");const l=Array.from(s.getElementsByClassName("selected-list__person-wrapper__person"));if(l&&l.length>0){l.pop().setAttribute("class","selected-list__person-wrapper-highlighted__person")}const h=Array.from(s.getElementsByClassName("selected-list__person-wrapper__overflow__gradient"));if(h&&h.length>0){h.pop().setAttribute("class","selected-list__person-wrapper-highlighted__overflow__gradient")}const v=Array.from(s.getElementsByClassName("selected-list__person-wrapper__overflow__close-icon"));if(v&&v.length>0){v.pop().setAttribute("class","selected-list__person-wrapper-highlighted__overflow__close-icon")}}}clearHighlighted(t){if(t)this.clearNodeHighlights(t);else{for(let t=0;t<this._highlightedUsers.length;t++){const o=this._highlightedUsers[t].parentElement;o&&this.clearNodeHighlights(o)}this._highlightedUsers=[],this._currentHighlightedUserPos=0}}clearNodeHighlights(t){t.setAttribute("class","selected-list__person-wrapper");const o=Array.from(t.getElementsByClassName("selected-list__person-wrapper-highlighted__person"));if(o&&o.length>0){o.pop().setAttribute("class","selected-list__person-wrapper__person")}const s=Array.from(t.getElementsByClassName("selected-list__person-wrapper-highlighted__overflow__gradient"));if(s&&s.length>0){s.pop().setAttribute("class","selected-list__person-wrapper__overflow__gradient")}const l=Array.from(t.getElementsByClassName("selected-list__person-wrapper-highlighted__overflow__close-icon"));if(l&&l.length>0){l.pop().setAttribute("class","selected-list__person-wrapper__overflow__close-icon")}}handleArrowSelection(t){const o=this.renderRoot.querySelector(".people-list");if(o&&o.children.length){t&&("ArrowUp"===t.key&&(-1===this._arrowSelectionCount?this._arrowSelectionCount=0:this._arrowSelectionCount=(this._arrowSelectionCount-1+o.children.length)%o.children.length),"ArrowDown"===t.key&&(-1===this._arrowSelectionCount?this._arrowSelectionCount=0:this._arrowSelectionCount=(this._arrowSelectionCount+1)%o.children.length));for(let t=0;t<o.children.length;t++)o.children[t].classList.remove("focused"),o.children[t].setAttribute("aria-selected","false");const s=o.children[this._arrowSelectionCount];s&&(s.classList.add("focused"),s.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"}),s.setAttribute("aria-selected","true"),this.input.setAttribute("aria-activedescendant",o.children[this._arrowSelectionCount].id))}}filterPeople(t){const o=[];if(t&&t.length>0){t=t.filter((t=>t));const s=this.selectedPeople.map((t=>t.id?t.id:t.displayName)),l=t.filter((t=>(null==t?void 0:t.id)?-1===s.indexOf(t.id):-1===s.indexOf(null==t?void 0:t.displayName))),h=new Set;for(let t=0;t<l.length;t++){const o=JSON.stringify(l[t]);h.add(o)}h.forEach((t=>{const s=JSON.parse(t);o.push(s)}))}return o}handleSectionScroll(t){const o=this.renderRoot.querySelector(".flyout-root");o&&(t.deltaY<0&&0===o.scrollTop||t.deltaY>0&&o.clientHeight+o.scrollTop>=o.scrollHeight-1||t.stopPropagation())}},__decorate$j([e$1({attribute:"group-id",converter:t=>t.trim()}),__metadata$j("design:type",String),__metadata$j("design:paramtypes",[Object])],exports.MgtPeoplePicker.prototype,"groupId",null),__decorate$j([e$1({attribute:"group-ids",converter:t=>t.split(",").map((t=>t.trim()))}),__metadata$j("design:type",Array),__metadata$j("design:paramtypes",[Object])],exports.MgtPeoplePicker.prototype,"groupIds",null),__decorate$j([e$1({attribute:"type",converter:(t,o)=>(t=t.toLowerCase())&&0!==t.length?void 0===exports.PersonType[t]?exports.PersonType.any:exports.PersonType[t]:exports.PersonType.any}),__metadata$j("design:type",Object),__metadata$j("design:paramtypes",[Object])],exports.MgtPeoplePicker.prototype,"type",null),__decorate$j([e$1({attribute:"group-type",converter:(t,o)=>{if(!t||0===t.length)return exports.GroupType.any;const s=t.split(","),l=[];for(let t of s)t=t.trim(),void 0!==exports.GroupType[t]&&l.push(exports.GroupType[t]);if(0===l.length)return exports.GroupType.any;const h=l.reduce(((t,o)=>t|o));return h}}),__metadata$j("design:type",Number),__metadata$j("design:paramtypes",[Object])],exports.MgtPeoplePicker.prototype,"groupType",null),__decorate$j([e$1({attribute:"user-type",converter:(t,o)=>(t=t.toLowerCase())&&void 0!==exports.UserType[t]?exports.UserType[t]:exports.UserType.any}),__metadata$j("design:type",String),__metadata$j("design:paramtypes",[Object])],exports.MgtPeoplePicker.prototype,"userType",null),__decorate$j([e$1({attribute:"transitive-search",type:Boolean}),__metadata$j("design:type",Boolean),__metadata$j("design:paramtypes",[Boolean])],exports.MgtPeoplePicker.prototype,"transitiveSearch",null),__decorate$j([e$1({attribute:"people",type:Object}),__metadata$j("design:type",Array),__metadata$j("design:paramtypes",[Array])],exports.MgtPeoplePicker.prototype,"people",null),__decorate$j([e$1({attribute:"show-max",type:Number}),__metadata$j("design:type",Number),__metadata$j("design:paramtypes",[Number])],exports.MgtPeoplePicker.prototype,"showMax",null),__decorate$j([e$1({attribute:"disable-images",type:Boolean}),__metadata$j("design:type",Boolean)],exports.MgtPeoplePicker.prototype,"disableImages",void 0),__decorate$j([e$1({attribute:"selected-people",type:Array}),__metadata$j("design:type",Array),__metadata$j("design:paramtypes",[Array])],exports.MgtPeoplePicker.prototype,"selectedPeople",null),__decorate$j([e$1({attribute:"default-selected-user-ids",converter:t=>t.split(",").map((t=>t.trim())),type:String}),__metadata$j("design:type",Array),__metadata$j("design:paramtypes",[Object])],exports.MgtPeoplePicker.prototype,"defaultSelectedUserIds",null),__decorate$j([e$1({attribute:"default-selected-group-ids",converter:t=>t.split(",").map((t=>t.trim())),type:String}),__metadata$j("design:type",Array),__metadata$j("design:paramtypes",[Object])],exports.MgtPeoplePicker.prototype,"defaultSelectedGroupIds",null),__decorate$j([e$1({attribute:"placeholder",type:String}),__metadata$j("design:type",String)],exports.MgtPeoplePicker.prototype,"placeholder",void 0),__decorate$j([e$1({attribute:"disabled",type:Boolean}),__metadata$j("design:type",Boolean)],exports.MgtPeoplePicker.prototype,"disabled",void 0),__decorate$j([e$1({attribute:"allow-any-email",type:Boolean}),__metadata$j("design:type",Boolean)],exports.MgtPeoplePicker.prototype,"allowAnyEmail",void 0),__decorate$j([e$1({attribute:"selection-mode",type:String}),__metadata$j("design:type",String)],exports.MgtPeoplePicker.prototype,"selectionMode",void 0),__decorate$j([e$1({attribute:"user-ids",converter:t=>t.split(",").map((t=>t.trim())),type:String}),__metadata$j("design:type",Array),__metadata$j("design:paramtypes",[Array])],exports.MgtPeoplePicker.prototype,"userIds",null),__decorate$j([e$1({attribute:"user-filters"}),__metadata$j("design:type",String),__metadata$j("design:paramtypes",[String])],exports.MgtPeoplePicker.prototype,"userFilters",null),__decorate$j([e$1({attribute:"people-filters"}),__metadata$j("design:type",String),__metadata$j("design:paramtypes",[String])],exports.MgtPeoplePicker.prototype,"peopleFilters",null),__decorate$j([e$1({attribute:"group-filters"}),__metadata$j("design:type",String),__metadata$j("design:paramtypes",[String])],exports.MgtPeoplePicker.prototype,"groupFilters",null),__decorate$j([e$1({attribute:"aria-label",type:String}),__metadata$j("design:type",String)],exports.MgtPeoplePicker.prototype,"ariaLabel",void 0),__decorate$j([t$1(),__metadata$j("design:type",Boolean)],exports.MgtPeoplePicker.prototype,"_showLoading",void 0),__decorate$j([t$1(),__metadata$j("design:type",Object)],exports.MgtPeoplePicker.prototype,"_isFocused",void 0),__decorate$j([t$1(),__metadata$j("design:type",Boolean)],exports.MgtPeoplePicker.prototype,"_setAnyEmail",void 0),__decorate$j([t$1(),__metadata$j("design:type",Array)],exports.MgtPeoplePicker.prototype,"_foundPeople",void 0),exports.MgtPeoplePicker=__decorate$j([customElement("people-picker"),__metadata$j("design:paramtypes",[])],exports.MgtPeoplePicker);var __awaiter$j=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};const qD="businessPhones,companyName,department,displayName,givenName,jobTitle,mail,mobilePhone,officeLocation,preferredLanguage,surname,userPrincipalName,id,accountEnabled",jD={directReports:"directReports",files:"files",messages:"messages",people:"people",person:"person"};function getPersonCardGraphData(t,o,s,l){return __awaiter$j(this,void 0,void 0,(function*(){const h=o.id,v=getEmailFromGraphEntity(o),m="classification"in o||"personType"in o&&("PersonalContact"===o.personType.subclass||"Group"===o.personType.class),_=t.createBatch();let R;m||l.sections.organization&&(!function buildOrgStructureRequest(t,o){const s=`manager($levels=max;$select=${qD})`;t.get(jD.person,`users/${o}?$expand=${s}&$select=${qD}&$count=true`,["user.read.all"],{ConsistencyLevel:"eventual"}),t.get(jD.directReports,`users/${o}/directReports?$select=${qD}`)}(_,h),"boolean"!=typeof l.sections.organization&&l.sections.organization.showWorksWith&&function buildWorksWithRequest(t,o){t.get(jD.people,`users/${o}/people?$filter=personType/class eq 'Person'`,["People.Read.All"])}(_,h)),l.sections.mailMessages&&v&&function buildMessagesWithUserRequest(t,o){t.get(jD.messages,`me/messages?$search="from:${o}"`,["Mail.ReadBasic"])}(_,v),l.sections.files&&function buildFilesRequest(t,o){let s;s=o?`me/insights/shared?$filter=lastshared/sharedby/address eq '${o}'`:"me/insights/used";t.get(jD.files,s,["Sites.Read.All"])}(_,s?null:v);const $={};try{R=yield _.executeAll()}catch(t){}if(R)for(const[t,o]of R)$[t]=o.content.value||o.content;if(!m&&l.sections.profile)try{const o=yield function getProfile(t,o){return __awaiter$j(this,void 0,void 0,(function*(){return yield t.api(`/users/${o}/profile`).version("beta").get()}))}(t,h);o&&($.profile=o)}catch(t){}return $.directReports&&$.directReports.length>0&&($.directReports=$.directReports.filter((t=>t.accountEnabled))),$}))}const zD=[i$4`
:host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\e70d"}.ms-Icon--ChevronUp::before{content:"\\\e70e"}.ms-Icon--Contact::before{content:"\\\e77b"}.ms-Icon--AddFriend::before{content:"\\\e8fa"}.ms-Icon--OutlookLogoInverse::before{content:"\\\eb6d"}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--presence-background-color:#ffffff;--presence-icon-color:#ffffff;--line1-color:#000000;--line2-color:var(--neutral-foreground-hint, #717171);--line3-color:var(--neutral-foreground-hint, #717171);--line4-color:var(--neutral-foreground-hint, #717171);--initials-color:black;--initials-background-color:white}.mgt-dark{--presence-background-color:#000000;--presence-icon-color:#000000;--line1-color:#ffffff;--line2-color:#c8c6c4;--line3-color:#c8c6c4;--line4-color:#c8c6c4;--initials-color:white;--initials-background-color:black}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--person-card-contact-link-color:#023b8f;--person-card-contact-link-hover-color:#106ebe}.mgt-dark{--person-card-contact-link-color:#ffffff;--person-card-contact-link-hover-color:#f3f2f1}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--person-card-active-org-member-color:#023b8f}.mgt-dark{--person-card-active-org-member-color:#ffffff}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--token-overflow-color:#023b8f}.mgt-dark{--token-overflow-color:#f3f2f1}.mgt-light{--person-card-background-color:#ffffff;--person-card-display-name-color:#000000;--person-card-title-color:var(--neutral-foreground-hint, #717171);--person-card-subtitle-color:var(--neutral-foreground-hint, #717171);--person-card-nav-back-arrow-color:#023b8f;--person-card-nav-back-arrow-color:#000000;--person-card-show-more-color:#023b8f;--person-card-show-more-hover-color:#106ebe}.mgt-dark{--person-card-background-color:#000000;--person-card-display-name-color:#ffffff;--person-card-title-color:#c8c6c4;--person-card-subtitle-color:#c8c6c4;--person-card-nav-back-arrow-color:#106ebe;--person-card-nav-back-arrow-color:#ffffff;--person-card-show-more-color:#ffffff;--person-card-show-more-hover-color:#f3f2f1}:host{box-shadow:var(--box-shadow,0 3.2px 7.2px 0 rgba(0,0,0,.132));background-color:var(--person-card-background-color,#fff);width:var(--mgt-flyout-set-width,375px);font-family:var(--default-font-family);overflow:hidden;user-select:none;border-radius:8px;border:1px solid var(--background-color-sub1,#faf9f8)}:host .small{max-height:100vh;overflow-y:auto;overflow-x:hidden}:host .nav{height:0;position:relative;z-index:100}:host .nav__back{padding-top:18px;padding-inline-start:12px;height:32px;width:32px}:host .nav__back svg{fill:var(--person-card-nav-back-arrow-color,#023b8f)}:host .nav__back:hover{cursor:pointer}:host .nav__back:hover svg{fill:var(--person-card-nav-back-arrow-color,#000)}:host .close-card-container{position:relative;z-index:100}:host .close-card-container .close-button{--focus-stroke-width:none;--control-corner-radius:2;--accent-foreground-active:none;--accent-foreground-hover:none;--neutral-fill-stealth-rest:transparent;--neutral-fill-stealth-hover:var(--background-color--hover, var(--neutral-fill-hover, #f7f7f7));position:absolute;right:10px;margin-top:9px;z-index:1;border:1px solid transparent}:host .close-card-container .close-button svg{width:9px;height:9px}:host .close-card-container .close-button svg path{fill:var(--icon-color-sub3,#023b8f)}:host .person-details-container{display:flex;flex-direction:column;padding-inline-start:23px;padding-top:23px;border-bottom:1px solid var(--line-seperator-color-sub1,#ebebeb)}:host .person-details-container .person-image{--presence-background-color:var(--presence-background-color, #ffffff);--presence-icon-color:var(--presence-icon-color, #ffffff);--line1-font-size:var(--person-card-display-name-font-size, 20px);--line1-line-height:var(--person-card-display-name-line-height, 28px);--line1-color:var(--person-card-display-name-color, #000000);--line2-font-size:var(--person-card-title-font-size, 14px);--line2-line-height:var(--person-card-title-line-height, 20px);--line2-color:var(--person-card-title-color, var(--neutral-foreground-hint, #717171));--line3-font-size:var(--person-card-subtitle-font-size, 14px);--line3-line-height:var(--person-card-subtitle-line-height, 19px);--line3-color:var(--person-card-subtitle-color, var(--neutral-foreground-hint, #717171));--avatar-size:75px;--details-cta-spacing:30px;--user-presence-margin-offset:5px}:host .person-details-container .base-icons{display:flex;-webkit-align-items:center;align-items:center;position:relative;left:91px;bottom:25px;z-index:1;width:fit-content}:host .person-details-container .base-icons .icon{display:flex;align-items:center;cursor:pointer;font-size:13px;white-space:nowrap}:host .person-details-container .base-icons .icon:not(:last-child){margin-inline-end:38px}:host .person-details-container .base-icons .icon svg path{fill:var(--icon-color-sub3,#023b8f)}:host .person-details-container .base-icons .icon:active svg path,:host .person-details-container .base-icons .icon:hover svg path{fill:var(--icon-color__sub3--hover,#023b8f)}:host .expanded-details-container{display:flex;flex-direction:column;position:relative}:host .expanded-details-container .expanded-details-button{display:flex;justify-content:center;align-items:center;height:32px}:host .expanded-details-container .expanded-details-button svg path{stroke:var(--icon-color-sub3,#023b8f)}:host .expanded-details-container .expanded-details-button:hover{cursor:pointer;background-color:var(--background-color--hover,var(--neutral-fill-hover,#f7f7f7))}:host .expanded-details-container .sections .section{padding:20px 0;display:flex;flex-direction:column;position:relative}:host .expanded-details-container .sections .section:not(:last-child):after{position:absolute;content:"";width:90%;transform:translateX(-50%);border-bottom:1px solid var(--line-seperator-color-sub1,#ebebeb);left:50%;bottom:0}:host .expanded-details-container .sections .section__header{display:flex;flex-direction:row;padding:0 20px}:host .expanded-details-container .sections .section__title{flex-grow:1;color:var(--title-color-subtitle,var(--neutral-foreground-rest,#1a1a1a));font-size:14px;font-weight:600;line-height:19px}:host .expanded-details-container .sections .section__show-more{color:var(--person-card-show-more-color,#023b8f);font-size:12px;font-weight:600;align-self:center;vertical-align:top;--neutral-fill-stealth-rest:transparent;--neutral-fill-stealth-hover:var(--background-color--active, #e1dfdd);--base-height-multiplier:6}:host .expanded-details-container .sections .section__show-more:hover{cursor:pointer;color:var(--person-card-show-more-hover-color,#106ebe)}:host .expanded-details-container .sections .section__content{margin-top:14px}:host .expanded-details-container .sections .section .additional-details{padding:0 20px}:host .expanded-details-container .section-nav{border-bottom:1px solid var(--line-seperator-color-sub1,#ebebeb);height:36px;padding-bottom:2px}:host .expanded-details-container .section-nav fluent-tabs{grid-template-columns:minmax(1px,.1fr);--accent-fill-rest:var(--icon-color-sub3, #023b8f)}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel{max-height:360px;min-height:360px;overflow-y:auto;overflow-x:hidden;padding:0;scrollbar-width:thin}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel .inserted{max-width:var(--mgt-flyout-set-width,375px);min-width:var(--mgt-flyout-set-width,360px)}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel .overview-panel{max-width:var(--mgt-flyout-set-width,375px)}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar{height:4em;width:4px;border-radius:11px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar-button{background:var(--person-card-background-color,#fff);height:1px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar-track{background:var(--person-card-background-color,#fff);border-radius:10px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar-track-piece{background:var(--person-card-background-color,#fff)}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar-thumb{background:grey;border-radius:10px;height:4px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab{padding-bottom:1px!important;border:1px solid transparent!important}:host .expanded-details-container .section-nav fluent-tabs fluent-tab:focus-visible{border:1px solid #2b2b2b!important}:host .expanded-details-container .section-nav fluent-tabs fluent-tab.section-nav__icon{cursor:pointer;box-sizing:border-box;width:48px;display:flex;align-items:center;justify-content:center}:host .expanded-details-container .section-nav fluent-tabs fluent-tab.section-nav__icon svg{fill:var(--icon-color,#605e5c)}:host .expanded-details-container .section-nav fluent-tabs fluent-tab.section-nav__icon:hover{background:var(--tab-background-color--hover,var(--neutral-fill-hover,#f7f7f7));border-radius:4px}:host .expanded-details-container .section-host{min-height:360px;overflow-y:auto;overflow-x:hidden}:host .expanded-details-container .section-host::-webkit-scrollbar{height:4em;width:4px;border-radius:11px}:host .expanded-details-container .section-host::-webkit-scrollbar-button{background:#fff}:host .expanded-details-container .section-host::-webkit-scrollbar-track{background:#fff;border-radius:10px}:host .expanded-details-container .section-host::-webkit-scrollbar-track-piece{background:#fff}:host .expanded-details-container .section-host::-webkit-scrollbar-thumb{background:grey;border-radius:10px;height:4px}:host .expanded-details-container .section-host.small{overflow-y:hidden}:host .loading{margin:40px 20px;display:flex;justify-content:center;height:360px}:host .message-section{border-bottom:1px solid var(--tab-line-color,#d6d6d6);display:flex}:host .message-section fluent-text-field{margin:10px 10px 10px 16px;--neutral-fill-input-rest:var(--input-background-color, #ffffff);--neutral-fill-input-hover:var(--input-background-color--hover, var(--neutral-fill-hover, #f7f7f7));--neutral-fill-input-focus:var(--input-background-color--focus, #ffffff);width:300px;margin-inline-start:16px;border-radius:4px}:host .message-section fluent-text-field:focus-within{--neutral-fill-secondary-rest:var(--person-card-background-color, #ffffff)}:host .message-section .send-message-icon{max-width:15px;margin-top:10px}:host .message-section svg{height:17px;width:16px;fill:var(--icon-color,#605e5c)}:host .message-section svg:hover{filter:brightness(.5)}:host .message-section svg:disabled{filter:none}[dir=rtl] .base-icons{right:91px}[dir=rtl] .nav__back{width:20px!important;-moz-transform:scaleX(-1);-o-transform:scaleX(-1);-webkit-transform:scaleX(-1);transform:scaleX(-1);filter:FlipH;-ms-filter:FlipH}[dir=rtl] .close-card-container .close-button{right:auto;left:10px}[dir=rtl] .message-section svg{transform:scale(-1,1)}@media (forced-colors:active) and (prefers-color-scheme:dark){.root{border:1px solid #fff;border-radius:inherit}.root svg,.root svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.expanded-details-container>svg,.expanded-details-container>svg>path,svg,svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){.root{border:1px solid #000;border-radius:inherit}.root svg,.root svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.expanded-details-container>svg,.expanded-details-container>svg>path,svg,svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}
`];var __decorate$i=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},__metadata$i=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)};class BasePersonCardSection extends MgtTemplatedComponent{get personDetails(){return this._personDetails}set personDetails(t){this._personDetails!==t&&(this._personDetails=t,this.requestStateUpdate())}get isCompact(){return this._isCompact}constructor(){super(),this._isCompact=!1,this._personDetails=null}asCompactView(){return this._isCompact=!0,this.requestUpdate(),this}asFullView(){return this._isCompact=!1,this.requestUpdate(),this}clearState(){this._isCompact=!1,this._personDetails=null}render(){return this.isCompact?this.renderCompactView():this.renderFullView()}renderLoading(){return mgtHtml`
      <div class="loading">
        <mgt-spinner></mgt-spinner>
      </div>
    `}renderNoData(){return XI`
      <div class="no-data">No data</div>
    `}navigateCard(t){let o=this.parentNode;for(;o;)if(o=o.parentNode,o&&o.host&&"MGT-PERSON-CARD"===o.host.tagName){o=o.host;break}o.navigate(t)}}__decorate$i([e$1({attribute:"person-details",type:Object}),__metadata$i("design:type",Object),__metadata$i("design:paramtypes",[Object])],BasePersonCardSection.prototype,"personDetails",null);const VD=[i$4`
:host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\e70d"}.ms-Icon--ChevronUp::before{content:"\\\e70e"}.ms-Icon--Contact::before{content:"\\\e77b"}.ms-Icon--AddFriend::before{content:"\\\e8fa"}.ms-Icon--OutlookLogoInverse::before{content:"\\\eb6d"}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, "Segoe UI");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\e70d"}.ms-Icon--ChevronUp::before{content:"\\\e70e"}.ms-Icon--Contact::before{content:"\\\e77b"}.ms-Icon--AddFriend::before{content:"\\\e8fa"}.ms-Icon--OutlookLogoInverse::before{content:"\\\eb6d"}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--person-card-contact-link-color:#023b8f;--person-card-contact-link-hover-color:#106ebe}.mgt-dark{--person-card-contact-link-color:#ffffff;--person-card-contact-link-hover-color:#f3f2f1}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,var(--neutral-foreground-rest,#1a1a1a));margin:0 20px 12px 20px}:host .root .part{display:grid;grid-template-columns:auto 1fr auto}:host .root .part .part__icon{display:flex;min-width:20px;width:20px;height:20px;align-items:center;justify-content:center;margin-left:20px;margin-top:10px;line-height:20px}:host .root .part .part__details{margin:10px 14px;overflow:hidden}:host .root .part .part__details .part__title{font-size:12px;color:var(--title-color-sub2,var(--neutral-foreground-hint,#717171));line-height:16px}:host .root .part .part__details .part__value{grid-column:2;color:var(--color-sub1,var(--neutral-foreground-rest,#1a1a1a));font-size:14px;font-weight:400;line-height:19px}:host .root .part .part__details .part__value .part__link{color:var(--person-card-contact-link-color,#023b8f);font-family:var(--default-font-family);font-size:14px;cursor:pointer;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:100%;display:inline-block}:host .root .part .part__details .part__value .part__link:hover{color:var(--person-card-contact-link-hover-color,#106ebe)}:host .root .part .part__copy{width:32px;height:100%;background-color:var(--background-color-sub2,#f3f2f1);visibility:hidden;display:flex;align-items:center;justify-content:center}:host .root .part .part__copy svg{fill:var(--icon-color,#605e5c);cursor:pointer}:host .root .part:hover .part__copy{visibility:visible}:host .root.compact{padding:0}:host .root.compact .part{height:30px;align-items:center}:host .root.compact .part__details{margin:0}:host .root.compact .part__title{display:none}:host .root.compact .part__icon{margin-top:0;margin-right:6px;margin-bottom:2px}[dir=rtl] .part__link.phone{text-align:right;direction:ltr}[dir=rtl] .part__icon{margin:10px 20px 0 0!important}[dir=rtl].compact .part__icon{margin-left:6px!important;margin-top:0!important}@media (forced-colors:active) and (prefers-color-scheme:dark){.root svg{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.root svg path,.root svg rect{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){.root svg{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.root svg path,.root svg rect{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}
`],GD={contactSectionTitle:"Contact",emailTitle:"Email",chatTitle:"Teams",businessPhoneTitle:"Business Phone",cellPhoneTitle:"Mobile Phone",departmentTitle:"Department",titleTitle:"Title",officeLocationTitle:"Office Location",copyToClipboardButton:"Copy to clipboard"};var __decorate$h=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},__metadata$h=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)};exports.MgtContact=class MgtContact extends BasePersonCardSection{static get styles(){return VD}get strings(){return GD}get hasData(){if(!this._contactParts)return!1;const t=Object.values(this._contactParts).filter((t=>!!t.value));return!!t.length}constructor(t){super(),this._contactParts={email:{icon:getSvg($A.Email,"#605e5c"),onClick:()=>this.sendEmail(getEmailFromGraphEntity(this._person)),showCompact:!0,title:this.strings.emailTitle},chat:{icon:getSvg($A.Chat,"#605e5c"),onClick:()=>{var t;return this.sendChat(null===(t=this._person)||void 0===t?void 0:t.userPrincipalName)},showCompact:!1,title:this.strings.chatTitle},businessPhone:{icon:getSvg($A.Phone,"#605e5c"),onClick:()=>{var t,o;return this.sendCall((null===(o=null===(t=this._person)||void 0===t?void 0:t.businessPhones)||void 0===o?void 0:o.length)>0?this._person.businessPhones[0]:null)},showCompact:!0,title:this.strings.businessPhoneTitle},cellPhone:{icon:getSvg($A.CellPhone,"#605e5c"),onClick:()=>{var t;return this.sendCall(null===(t=this._person)||void 0===t?void 0:t.mobilePhone)},showCompact:!0,title:this.strings.cellPhoneTitle},department:{icon:getSvg($A.Department,"#605e5c"),showCompact:!1,title:this.strings.departmentTitle},title:{icon:getSvg($A.Person,"#605e5c"),showCompact:!1,title:this.strings.titleTitle},officeLocation:{icon:getSvg($A.OfficeLocation,"#605e5c"),showCompact:!0,title:this.strings.officeLocationTitle}},this.sendCall=t=>{this.sendLink("tel:",t)},this._person=t,this._contactParts.email.value=getEmailFromGraphEntity(this._person),this._contactParts.chat.value=this._person.userPrincipalName,this._contactParts.cellPhone.value=this._person.mobilePhone,this._contactParts.department.value=this._person.department,this._contactParts.title.value=this._person.jobTitle,this._contactParts.officeLocation.value=this._person.officeLocation,this._person.businessPhones&&this._person.businessPhones.length&&(this._contactParts.businessPhone.value=this._person.businessPhones[0])}get displayName(){return this.strings.contactSectionTitle}renderIcon(){return getSvg($A.Contact)}clearState(){super.clearState();for(const t of Object.keys(this._contactParts))this._contactParts[t].value=null}renderCompactView(){let t;if(!this.hasData)return null;const o=Object.values(this._contactParts).filter((t=>!!t.value));let s=Object.values(o).filter((t=>!!t.value&&t.showCompact));return s&&s.length||(s=Object.values(o).slice(0,2)),t=XI`
      ${s.map((t=>this.renderContactPart(t)))}
    `,XI`
      <div class="root compact" dir=${this.direction}>
        ${t}
      </div>
    `}renderFullView(){let t;if(this.hasData){const o=Object.values(this._contactParts).filter((t=>!!t.value));t=XI`
        ${o.map((t=>this.renderContactPart(t)))}
      `}return XI`
      <div class="root" dir=${this.direction}>
        <div class="title" tabindex="0">${this.displayName}</div>
        ${t}
      </div>
    `}renderContactPart(t){let o=!1;"Mobile Phone"!==t.title&&"Business Phone"!==t.title||(o=!0);const s={part__link:!0,phone:o},l=t.onClick?XI`
          <span class=${IA(s)} @click=${o=>t.onClick(o)}>${t.value}</span>
        `:XI`
          ${t.value}
        `;return XI`
      <div class="part" @click=${o=>this.handlePartClick(o,t.value)} tabindex="0">
        <div class="part__icon" aria-label=${t.title} title=${t.title}>${t.icon}</div>
        <div class="part__details">
          <div class="part__title">${t.title}</div>
          <div class="part__value" title=${t.title}>${l}</div>
        </div>
        <div
          class="part__copy"
          aria-role="button" 
          aria-label=${this.strings.copyToClipboardButton}
          title=${this.strings.copyToClipboardButton}
        >
          ${getSvg($A.Copy)}
        </div>
      </div>
    `}handlePartClick(t,o){o&&navigator.clipboard.writeText(o)}sendLink(t,o){o?window.open(`${t}${o}`,"_blank","noreferrer"):console.error(`Target resource for ${t} link was not provided: resource: ${o}`)}sendChat(t){if(!t)return void console.error("Can't send chat when upn is not provided");const o=`https://teams.microsoft.com/l/chat/0/0?users=${t}`,openWindow=()=>window.open(o,"_blank","noreferrer");TeamsHelper.isAvailable?TeamsHelper.executeDeepLink(o,(t=>{t||openWindow()})):openWindow()}sendEmail(t){this.sendLink("mailto:",t)}},exports.MgtContact=__decorate$h([customElement("contact"),__metadata$h("design:paramtypes",[Object])],exports.MgtContact);const KD=[i$4`
:host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\e70d"}.ms-Icon--ChevronUp::before{content:"\\\e70e"}.ms-Icon--Contact::before{content:"\\\e77b"}.ms-Icon--AddFriend::before{content:"\\\e8fa"}.ms-Icon--OutlookLogoInverse::before{content:"\\\eb6d"}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, "Segoe UI");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\e70d"}.ms-Icon--ChevronUp::before{content:"\\\e70e"}.ms-Icon--Contact::before{content:"\\\e77b"}.ms-Icon--AddFriend::before{content:"\\\e8fa"}.ms-Icon--OutlookLogoInverse::before{content:"\\\eb6d"}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,var(--neutral-foreground-rest,#1a1a1a));margin:0 20px 12px 20px}:host .root .message{padding:8px 20px;display:flex;align-items:center;justify-content:space-between}:host .root .message:hover{background-color:#f7f7f7;cursor:pointer}:host .root .message:last-child{margin-bottom:unset}:host .root .message .message__detail{min-width:0;line-height:normal}:host .root .message .message__detail .message__subject{color:var(--color,#000);font-size:var(--message-subject-font-size,14px);font-weight:var(--message-subject-font-weight,600);line-height:var(--message-subject-line-height,20px)}:host .root .message .message__detail .message__from{font-size:var(--message-subject-font-size,12px);color:var(--color-sub1,var(--neutral-foreground-rest,#1a1a1a));line-height:var(--message-subject-line-height,16px);font-weight:var(--message-subject-font-weight,400)}:host .root .message .message__detail .message__message{font-size:var(--message-subject-font-size,12px);color:var(--color-sub2,var(--neutral-foreground-hint,#717171));line-height:var(--message-subject-line-height,16px);font-weight:var(--message-subject-font-weight,400)}:host .root .message .message__detail>div{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}:host .root .message .message__date{margin-top:8px;font-size:12px;color:var(--color-sub2,var(--neutral-foreground-hint,#717171));margin-left:10px;white-space:nowrap}
`],WD={emailsSectionTitle:"Emails"};var __decorate$g=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},__metadata$g=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)};exports.MgtMessages=class MgtMessages extends BasePersonCardSection{static get styles(){return KD}get strings(){return WD}constructor(t){super(),this._messages=t}get displayName(){return this.strings.emailsSectionTitle}clearState(){super.clearState(),this._messages=[]}renderIcon(){return getSvg($A.Messages)}renderCompactView(){let t;if(this.isLoadingState)t=this.renderLoading();else if(this._messages&&this._messages.length){const o=this._messages?this._messages.slice(0,3).map((t=>this.renderMessage(t))):[];t=XI`
         ${o}
       `}else t=this.renderNoData();return XI`
       <div class="root compact">
         ${t}
       </div>
     `}renderFullView(){let t;return t=this.isLoadingState?this.renderLoading():this._messages&&this._messages.length?XI`
         ${this._messages.slice(0,5).map((t=>this.renderMessage(t)))}
       `:this.renderNoData(),XI`
       <div class="root">
         <div class="title" tabindex="0">${this.strings.emailsSectionTitle}</div>
         ${t}
       </div>
     `}renderMessage(t){return XI`
       <div class="message" @click=${()=>this.handleMessageClick(t)}>
         <div class="message__detail">
           <div class="message__subject">${t.subject}</div>
           <div class="message__from">${t.from.emailAddress.name}</div>
           <div class="message__message">${t.bodyPreview}</div>
         </div>
         <div class="message__date">${getRelativeDisplayDate(new Date(t.receivedDateTime))}</div>
       </div>
     `}handleMessageClick(t){window.open(t.webLink,"_blank","noreferrer")}},exports.MgtMessages=__decorate$g([customElement("messages"),__metadata$g("design:paramtypes",[Array])],exports.MgtMessages);const QD=[i$4`
:host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\e70d"}.ms-Icon--ChevronUp::before{content:"\\\e70e"}.ms-Icon--Contact::before{content:"\\\e77b"}.ms-Icon--AddFriend::before{content:"\\\e8fa"}.ms-Icon--OutlookLogoInverse::before{content:"\\\eb6d"}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, "Segoe UI");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\e70d"}.ms-Icon--ChevronUp::before{content:"\\\e70e"}.ms-Icon--Contact::before{content:"\\\e77b"}.ms-Icon--AddFriend::before{content:"\\\e8fa"}.ms-Icon--OutlookLogoInverse::before{content:"\\\eb6d"}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--person-card-active-org-member-color:#023b8f}.mgt-dark{--person-card-active-org-member-color:#ffffff}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root.compact .coworker .coworker__image{height:40px;width:40px;border-radius:40px;--avatar-size:40px;--avatar-size-s:40px;margin-right:12px}:host .root.compact .coworker .coworker__name{font-size:14px}:host .root.compact .coworker .coworker__title{font-size:12px}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,var(--neutral-foreground-rest,#1a1a1a));margin:0 20px 20px 20px;line-height:19px}:host .root .subtitle{color:var(--title-color-sub2,var(--neutral-foreground-hint,#717171));font-size:14px;margin:0 20px 8px 20px}:host .root .divider{display:flex;background:var(--line-seperator-color,#d6d6d6);height:1px;margin-top:26px;margin-bottom:18px;margin-left:20px;margin-right:20px}:host .root .org-member{height:74px;box-sizing:border-box;border-radius:2px;padding:12px;display:flex;align-items:center;margin-left:20px;margin-right:20px}:host .root .org-member.org-member--target{background-color:var(--background-color--active,#e1dfdd);border:1px solid var(--person-card-active-org-member-color,#023b8f)}:host .root .org-member:not(.org-member--target){border:1px solid var(--line-seperator-color,#d6d6d6)}:host .root .org-member:not(.org-member--target):hover{cursor:pointer;background-color:var(--background-color--hover,var(--neutral-fill-hover,#f7f7f7))}:host .root .org-member .org-member__person{flex-grow:1}:host .root .org-member .org-member__details{flex-grow:1}:host .root .org-member .org-member__details .org-member__name{font-size:16px;color:var(--color-sub1,var(--neutral-foreground-rest,#1a1a1a));font-weight:600}:host .root .org-member .org-member__details .org-member__department,:host .root .org-member .org-member__details .org-member__title{font-weight:14px;color:var(--color-sub2,var(--neutral-foreground-hint,#717171))}:host .root .org-member__separator:not(:last-child){border:1px solid var(--line-seperator-color,#d6d6d6);box-sizing:border-box;width:0;margin:0 50%;height:14px}:host .root .coworker{display:flex;align-items:center;padding:10px 20px}:host .root .coworker:hover{cursor:pointer;background-color:var(--background-color--hover,var(--neutral-fill-hover,#f7f7f7))}:host .root .coworker .coworker__person{height:46px;border-radius:46px;margin-right:8px}:host .root .direct-report__compact{padding:12px 20px}:host .root .direct-report__compact .direct-report{cursor:pointer;width:38px;margin-right:4px;display:inline;--avatar-size:38px}[dir=rtl] .org-member .org-member__more{-moz-transform:scaleX(-1);-o-transform:scaleX(-1);-webkit-transform:scaleX(-1);transform:scaleX(-1);filter:FlipH;-ms-filter:FlipH}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg,:host svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host svg,:host svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}
`],YD={reportsToSectionTitle:"Reports to",directReportsSectionTitle:"Direct reports",organizationSectionTitle:"Organization",youWorkWithSubSectionTitle:"You work with",userWorksWithSubSectionTitle:"works with"};var __decorate$f=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},__metadata$f=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)};exports.MgtOrganization=class MgtOrganization extends BasePersonCardSection{static get styles(){return QD}get strings(){return YD}constructor(t,o){super(),this._state=t,this._me=o}clearState(){super.clearState(),this._state=null,this._me=null}get displayName(){const{person:t,directReports:o}=this._state;return!t.manager&&o&&o.length?`${this.strings.directReportsSectionTitle} (${o.length})`:this.strings.reportsToSectionTitle}renderIcon(){return getSvg($A.Organization)}renderCompactView(){let t;if(!this._state||!this._state.person)return null;const{person:o,directReports:s}=this._state;return o?(o.manager?t=this.renderCoworker(o.manager):s&&s.length&&(t=this.renderCompactDirectReports()),XI`
        <div class="root compact">
          ${t}
        </div>
      `):null}renderFullView(){let t;if(!this._state||!this._state.person)return null;const{person:o,directReports:s,people:l}=this._state;if(!(o||s||l))return null;{const o=this.renderManagers(),s=this.renderCurrentUser(),l=this.renderDirectReports(),h=this.renderCoworkers();t=XI`
          ${o} ${s} ${l} ${h}
        `}return XI`
       <div class="root" dir=${this.direction}>
         <div class="title" tabindex="0">${this.strings.organizationSectionTitle}</div>
         ${t}
       </div>
     `}renderManager(t){return mgtHtml`
       <div class="org-member" @keydown=${o=>{"Enter"===o.code&&this.navigateCard(t)}} @click=${()=>this.navigateCard(t)}>
         <div class="org-member__person">
           <mgt-person
             .personDetails=${t}
             .fetchImage=${!0}
             .view=${exports.ViewType.twolines}
             .showPresence=${!0}
           ></mgt-person>
         </div>
         <div tabindex="0" class="org-member__more">
           ${getSvg($A.ExpandRight)}
         </div>
       </div>
       <div class="org-member__separator"></div>
     `}renderManagers(){const{person:t}=this._state;if(!t||!t.manager)return null;const o=[];let s=t;for(;s.manager;)o.push(s.manager),s=s.manager;return o.length?o.reverse().map((t=>this.renderManager(t))):null}renderDirectReports(){const{directReports:t}=this._state;return t&&t.length?XI`
       <div class="org-member__separator"></div>
       <div>
         ${t.map((t=>mgtHtml`
             <div class="org-member org-member--direct-report" @keydown=${o=>{"Enter"===o.code&&this.navigateCard(t)}} @click=${()=>this.navigateCard(t)}>
               <div class="org-member__person">
                 <mgt-person
                   .personDetails=${t}
                   .fetchImage=${!0}
                   .showPresence=${!0}
                   .view=${exports.ViewType.twolines}
                 ></mgt-person>
               </div>
               <div tabindex="0" class="org-member__more">
                 ${getSvg($A.ExpandRight)}
               </div>
             </div>
             <div class="org-member__separator"></div>
           `))}
       </div>
     `:null}renderCompactDirectReports(){const{directReports:t}=this._state;return XI`
       <div class="direct-report__compact">
         ${t.slice(0,6).map((t=>mgtHtml`
             <div
               class="direct-report"
               @keydown=${o=>{"Enter"===o.code&&this.navigateCard(t)}}
               @click=${()=>this.navigateCard(t)}
             >
               <mgt-person
                 .personDetails=${t}
                 .fetchImage=${!0}
                 .showPresence=${!0}
                 .view=${exports.ViewType.twolines}
               ></mgt-person>
             </div>
           `))}
       </div>
     `}renderCurrentUser(){const{person:t}=this._state;return mgtHtml`
       <div class="org-member org-member--target">
         <div class="org-member__person">
           <mgt-person
             .personDetails=${t}
             .fetchImage=${!0}
             .showPresence=${!0}
             .view=${exports.ViewType.twolines}
           ></mgt-person>
         </div>
       </div>
     `}renderCoworker(t){return mgtHtml`
       <div class="coworker" @keydown=${o=>{"Enter"===o.code&&this.navigateCard(t)}} @click=${()=>this.navigateCard(t)}>
         <div class="coworker__person">
           <mgt-person
             .personDetails=${t}
             .fetchImage=${!0}
             .showPresence=${!0}
             .view=${exports.ViewType.twolines}
           ></mgt-person>
         </div>
       </div>
     `}renderCoworkers(){const{people:t}=this._state;if(!t||!t.length)return null;const o=this._me.id===this._state.person.id?this.strings.youWorkWithSubSectionTitle:`${this._state.person.givenName} ${this.strings.userWorksWithSubSectionTitle}`;return XI`
       <div class="divider"></div>
       <div class="subtitle" tabindex="0">${o}</div>
       <div>
         ${t.slice(0,6).map((t=>this.renderCoworker(t)))}
       </div>
     `}},exports.MgtOrganization=__decorate$f([customElement("organization"),__metadata$f("design:paramtypes",[Object,Object])],exports.MgtOrganization);const JD=[i$4`
:host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\e70d"}.ms-Icon--ChevronUp::before{content:"\\\e70e"}.ms-Icon--Contact::before{content:"\\\e77b"}.ms-Icon--AddFriend::before{content:"\\\e8fa"}.ms-Icon--OutlookLogoInverse::before{content:"\\\eb6d"}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, "Segoe UI");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\e70d"}.ms-Icon--ChevronUp::before{content:"\\\e70e"}.ms-Icon--Contact::before{content:"\\\e77b"}.ms-Icon--AddFriend::before{content:"\\\e8fa"}.ms-Icon--OutlookLogoInverse::before{content:"\\\eb6d"}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--token-overflow-color:#023b8f}.mgt-dark{--token-overflow-color:#f3f2f1}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,var(--neutral-foreground-rest,#1a1a1a));margin:0 20px 12px 20px}:host .root section{margin-bottom:24px;padding:0 20px}:host .root section:last-child{margin:0}:host .root section .section__title{font-size:14px;color:var(--title-color-sub2,var(--neutral-foreground-hint,#717171))}:host .root section .section__content{display:flex;flex-direction:column;margin-top:10px}:host .root .token-list{display:flex;flex-direction:row;flex-wrap:wrap;margin-top:-10px}:host .root .token-list .token-list__item{text-overflow:ellipsis;white-space:nowrap;display:inline-block;overflow:hidden;font-size:14px;align-items:center;background:var(--background-color-sub2,#f3f2f1);border-radius:2px;max-height:28px;padding:4px 8px;margin-right:10px;margin-top:10px;color:var(--color-sub1,var(--neutral-foreground-rest,#1a1a1a))}:host .root .token-list .token-list__item:last-child{margin-right:initial}:host .root .token-list .token-list__item.overflow{display:none}:host .root .token-list .token-list__item:hover{color:var(--color-sub1,var(--neutral-foreground-rest,#1a1a1a))}:host .root .token-list .token-list__item.token-list__item--show-overflow{cursor:pointer;user-select:unset;background:0 0;color:var(--token-overflow-color,#023b8f)}:host .root .data-list__item{margin-bottom:20px}:host .root .data-list__item:last-child{margin-bottom:initial}:host .root .data-list__item .data-list__item__header{display:flex;justify-content:space-between;align-items:center}:host .root .data-list__item .data-list__item__content{font-size:12px;line-height:16px;color:var(--color-sub2,var(--neutral-foreground-hint,#717171));margin-top:4px}:host .root .data-list__item .data-list__item__title{font-size:14px;line-height:16px;color:var(--title-color-subtitle,var(--neutral-foreground-rest,#1a1a1a))}:host .root .data-list__item .data-list__item__date-range{color:var(--title-color-subtitle,var(--neutral-foreground-rest,#1a1a1a));font-size:10px;line-height:12px}:host .root .language__proficiency{opacity:.77}:host .root .work-position .work-position__company{color:#023b8f}:host .root .work-position .work-position__location{font-size:10px;color:var(--color-sub2,var(--neutral-foreground-hint,#717171));line-height:16px}:host .root .educational-activity .educational-activity__degree{font-size:12px;line-height:14px;color:var(--color-sub3,#727170)}:host .root .birthday{display:flex;align-items:center;margin-top:-6px}:host .root .birthday .birthday__icon{margin-right:8px}:host .root .birthday .birthday__date{font-size:12px;color:var(--color-sub1,var(--neutral-foreground-rest,#1a1a1a))}[dir=rtl] .token-list__item{margin-right:0!important}
`],XD={SkillsAndExperienceSectionTitle:"Skills & Experience",AboutCompactSectionTitle:"About",SkillsSubSectionTitle:"Skills",LanguagesSubSectionTitle:"Languages",WorkExperienceSubSectionTitle:"Work Experience",EducationSubSectionTitle:"Education",professionalInterestsSubSectionTitle:"Professional Interests",personalInterestsSubSectionTitle:"Personal Interests",birthdaySubSectionTitle:"Birthday",currentYearSubtitle:"Current",socialMediaSubSectionTitle:"Social Media"};var __decorate$e=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},__metadata$e=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)};exports.MgtProfile=class MgtProfile extends BasePersonCardSection{static get styles(){return JD}get strings(){return XD}get displayName(){return this.strings.SkillsAndExperienceSectionTitle}get hasData(){if(!this.profile)return!1;const{languages:t,skills:o,positions:s,educationalActivities:l}=this.profile;return[this._birthdayAnniversary,this._personalInterests&&this._personalInterests.length,this._professionalInterests&&this._professionalInterests.length,t&&t.length,o&&o.length,s&&s.length,l&&l.length].filter((t=>!!t)).length>0}get profile(){return this._profile}set profile(t){t!==this._profile&&(this._profile=t,this._birthdayAnniversary=t&&t.anniversaries?t.anniversaries.find(this.isBirthdayAnniversary):null,this._personalInterests=t&&t.interests?t.interests.filter(this.isPersonalInterest):null,this._professionalInterests=t&&t.interests?t.interests.filter(this.isProfessionalInterest):null)}constructor(t){super(),this.profile=t}renderIcon(){return getSvg($A.Profile)}clearState(){super.clearState(),this.profile=null}renderCompactView(){return XI`
       <div class="root compact" dir=${this.direction}>
         ${this.renderSubSections().slice(0,2)}
       </div>
     `}renderFullView(){return this.initPostRenderOperations(),XI`
       <div class="root" dir=${this.direction}>
         <div class="title">${this.strings.AboutCompactSectionTitle}</div>
         ${this.renderSubSections()}
       </div>
     `}renderSubSections(){return[this.renderSkills(),this.renderBirthday(),this.renderLanguages(),this.renderWorkExperience(),this.renderEducation(),this.renderProfessionalInterests(),this.renderPersonalInterests()].filter((t=>!!t))}renderLanguages(){const{languages:t}=this._profile;if(!t||!t.length)return null;const o=[];for(const s of t){let t=null;s.proficiency&&s.proficiency.length&&(t=XI`
           <span class="language__proficiency" tabindex="0">
             &nbsp;(${s.proficiency})
           </span>
         `),o.push(XI`
         <div class="token-list__item language">
           <span class="language__title" tabindex="0">${s.displayName}</span>
           ${t}
         </div>
       `)}const s=o.length?this.strings.LanguagesSubSectionTitle:"";return XI`
       <section>
         <div class="section__title" tabindex="0">${s}</div>
         <div class="section__content">
           <div class="token-list">
             ${o}
           </div>
         </div>
       </section>
     `}renderSkills(){const{skills:t}=this._profile;if(!t||!t.length)return null;const o=[];for(const s of t)o.push(XI`
         <div class="token-list__item skill" tabindex="0">
           ${s.displayName}
         </div>
       `);const s=o.length?this.strings.SkillsSubSectionTitle:"";return XI`
       <section>
         <div class="section__title" tabindex="0">${s}</div>
         <div class="section__content">
           <div class="token-list">
             ${o}
           </div>
         </div>
       </section>
     `}renderWorkExperience(){var t,o,s,l,h,v,m,_,R;const{positions:$}=this._profile;if(!$||!$.length)return null;const B=[];for(const $ of this._profile.positions)($.detail.description||""!==$.detail.jobTitle)&&B.push(XI`
           <div class="data-list__item work-position">
             <div class="data-list__item__header">
               <div class="data-list__item__title" tabindex="0">${null===(t=$.detail)||void 0===t?void 0:t.jobTitle}</div>
               <div class="data-list__item__date-range" tabindex="0">
                 ${this.getDisplayDateRange($.detail)}
               </div>
             </div>
             <div class="data-list__item__content">
               <div class="work-position__company" tabindex="0">
                 ${null===(s=null===(o=null==$?void 0:$.detail)||void 0===o?void 0:o.company)||void 0===s?void 0:s.displayName}
               </div>
               <div class="work-position__location" tabindex="0">
                 ${null===(v=null===(h=null===(l=null==$?void 0:$.detail)||void 0===l?void 0:l.company)||void 0===h?void 0:h.address)||void 0===v?void 0:v.city}, ${null===(R=null===(_=null===(m=null==$?void 0:$.detail)||void 0===m?void 0:m.company)||void 0===_?void 0:_.address)||void 0===R?void 0:R.state}
               </div>
             </div>
           </div>
         `);const q=B.length?this.strings.WorkExperienceSubSectionTitle:"";return XI`
       <section>
         <div class="section__title" tabindex="0">${q}</div>
         <div class="section__content">
           <div class="data-list">
             ${B}
           </div>
         </div>
       </section>
     `}renderEducation(){const{educationalActivities:t}=this._profile;if(!t||!t.length)return null;const o=[];for(const s of t)o.push(XI`
         <div class="data-list__item educational-activity">
           <div class="data-list__item__header">
             <div class="data-list__item__title" tabindex="0">${s.institution.displayName}</div>
             <div class="data-list__item__date-range" tabindex="0">
               ${this.getDisplayDateRange(s)}
             </div>
           </div>
           <div class="data-list__item__content">
             <div class="educational-activity__degree" tabindex="0">
               ${s.program.displayName||"Bachelors Degree"}
             </div>
           </div>
         </div>
       `);const s=o.length?this.strings.EducationSubSectionTitle:"";return XI`
       <section>
         <div class="section__title" tabindex="0">${s}</div>
         <div class="section__content">
           <div class="data-list">
             ${o}
           </div>
         </div>
       </section>
     `}renderProfessionalInterests(){if(!this._professionalInterests||!this._professionalInterests.length)return null;const t=[];for(const o of this._professionalInterests)t.push(XI`
         <div class="token-list__item interest interest--professional" tabindex="0">
           ${o.displayName}
         </div>
       `);const o=t.length?this.strings.professionalInterestsSubSectionTitle:"";return XI`
       <section>
         <div class="section__title" tabindex="0">${o}</div>
         <div class="section__content">
           <div class="token-list">
             ${t}
           </div>
         </div>
       </section>
     `}renderPersonalInterests(){if(!this._personalInterests||!this._personalInterests.length)return null;const t=[];for(const o of this._personalInterests)t.push(XI`
         <div class="token-list__item interest interest--personal" tabindex="0">
           ${o.displayName}
         </div>
       `);const o=t.length?this.strings.personalInterestsSubSectionTitle:"";return XI`
       <section>
         <div class="section__title" tabindex="0">${o}</div>
         <div class="section__content">
           <div class="token-list">
             ${t}
           </div>
         </div>
       </section>
     `}renderBirthday(){return this._birthdayAnniversary&&this._birthdayAnniversary.date?XI`
       <section>
         <div class="section__title" tabindex="0">Birthday</div>
         <div class="section__content">
           <div class="birthday">
             <div class="birthday__icon">
               ${getSvg($A.Birthday)}
             </div>
             <div class="birthday__date" tabindex="0">
               ${this.getDisplayDate(new Date(this._birthdayAnniversary.date))}
             </div>
           </div>
         </div>
       </section>
     `:null}isPersonalInterest(t){return t.categories&&t.categories.includes("personal")}isProfessionalInterest(t){return t.categories&&t.categories.includes("professional")}isBirthdayAnniversary(t){return"birthday"===t.type}getDisplayDate(t){return t.toLocaleString("default",{day:"numeric",month:"long"})}getDisplayDateRange(t){const o=new Date(t.startMonthYear).getFullYear();if(0===o)return null;return`${o} â ${t.endMonthYear?new Date(t.endMonthYear).getFullYear():this.strings.currentYearSubtitle}`}initPostRenderOperations(){setTimeout((()=>{try{this.shadowRoot.querySelectorAll("section").forEach((t=>{this.handleTokenOverflow(t)}))}catch(t){}}),0)}handleTokenOverflow(t){const o=t.querySelectorAll(".token-list");if(o&&o.length)for(const t of Array.from(o)){const o=t.querySelectorAll(".token-list__item");if(!o||!o.length)continue;let s=null,l=o[0].getBoundingClientRect();const h=t.getBoundingClientRect(),v=2*l.height+h.top;for(let t=0;t<o.length-1;t++)if(l=o[t].getBoundingClientRect(),l.top>v){s=Array.from(o).slice(t,o.length);break}if(s){s.forEach((t=>t.classList.add("overflow")));const o=document.createElement("div");o.classList.add("token-list__item"),o.classList.add("token-list__item--show-overflow"),o.tabIndex=0,o.innerText=`+ ${s.length} more`;const revealOverflow=()=>{o.remove(),s.forEach((t=>t.classList.remove("overflow")))};o.addEventListener("click",(t=>{revealOverflow()})),o.addEventListener("keydown",(t=>{"Enter"===t.code&&revealOverflow()})),t.appendChild(o)}}}},exports.MgtProfile=__decorate$e([customElement("profile"),__metadata$e("design:paramtypes",[Object])],exports.MgtProfile);const ZD={showMoreSectionButton:"Show more",endOfCard:"End of the card",quickMessage:"Send a quick message"};var eL,__decorate$d=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},__metadata$d=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)},__awaiter$i=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};registerFluentComponents(pD,uD,hD,JM,gD),exports.MgtPersonCard=eL=class MgtPersonCard extends MgtTemplatedComponent{static get styles(){return zD}get strings(){return ZD}static get requiredScopes(){return eL.getScopes()}static getScopes(){const t=[];return this.config.sections.files&&t.push("Sites.Read.All"),this.config.sections.mailMessages&&(t.push("Mail.Read"),t.push("Mail.ReadBasic")),this.config.sections.organization&&(t.push("User.Read.All"),"boolean"!=typeof this.config.sections.organization&&this.config.sections.organization.showWorksWith&&t.push("People.Read.All")),this.config.sections.profile&&t.push("User.Read.All"),this.config.useContactApis&&t.push("Contacts.Read"),t.indexOf("User.Read.All")<0&&(t.push("User.ReadBasic.All"),t.push("User.Read")),t.indexOf("People.Read.All")<0&&t.push("People.Read"),t.push("Chat.Create","Chat.ReadWrite"),[...new Set(t)]}static get config(){return this._config}get personDetails(){return this._personDetails}set personDetails(t){this._personDetails!==t&&(this._personDetails=t,this.personImage=this.getImage(),this.requestStateUpdate())}get userId(){return this._userId}set userId(t){t!==this._userId&&(this._userId=t,this.personDetails=null,this._cardState=null,this.requestStateUpdate())}get internalPersonDetails(){return this._cardState&&this._cardState.person||this.personDetails}constructor(){super(),this.isSending=!1,this.hoverStates={email:!1,chat:!1,video:!1,call:!1},this.setHoveredState=(t,o)=>{this.hoverStates[t]=o,this.hoverStates=Object.assign({},this.hoverStates)},this.isHovered=t=>this.hoverStates[t],this._chatInput="",this._currentSection=null,this._history=[],this.sections=[],this._graph=null}attributeChangedCallback(t,o,s){if(super.attributeChangedCallback(t,o,s),o!==s&&"person-query"===t)this.personDetails=null,this._cardState=null,this.requestStateUpdate()}navigate(t){this._history.push({personDetails:this.personDetails,personImage:this.getImage(),state:this._cardState}),this._personDetails=t,this._cardState=null,this.personImage=null,this._currentSection=null,this.sections=[],this._chatInput="",this.requestStateUpdate()}goBack(){if(!this._history||!this._history.length)return;const t=this._history.pop();this._currentSection=null;const o=this.renderRoot.querySelector("fluent-tab");o&&o.click(),this._cardState=t.state,this._personDetails=t.state.person,this.personImage=t.personImage,this.loadSections()}clearHistory(){if(this._currentSection=null,!this._history||!this._history.length)return;const t=this._history[0];this._history=[],this._cardState=t.state,this._personDetails=t.state,this.personImage=t.personImage,this.loadSections()}render(){if(!this.internalPersonDetails)return this.renderNoData();const t=this.internalPersonDetails,o=this.getImage();if(this.hasTemplate("default"))return this.renderTemplate("default",{person:this.internalPersonDetails,personImage:o});const s=this.isExpanded?XI`
           <div class="close-card-container">
             <fluent-button appearance="lightweight" class="close-button" @click=${()=>this.closeCard()} >
               ${getSvg($A.Close)}
             </fluent-button>
           </div>
         `:null,l=this._history&&this._history.length?XI`
            <div class="nav">
              <div class="nav__back" tabindex="0" @keydown=${t=>{"Enter"===t.code&&this.goBack()}} @click=${()=>this.goBack()}>${getSvg($A.Back)}</div>
            </div>
          `:null;let h=this.renderTemplate("person-details",{person:this.internalPersonDetails,personImage:o});if(!h){const o=this.renderPerson(),s=this.renderContactIcons(t);h=XI`
         ${o} ${s}
       `}const v=this.isExpanded?this.renderExpandedDetails():this.renderExpandedDetailsButton();this._windowHeight=window.innerHeight&&document.documentElement.clientHeight?Math.min(window.innerHeight,document.documentElement.clientHeight):window.innerHeight||document.documentElement.clientHeight,this._windowHeight<250&&(this._smallView=!0);const m=this.lockTabNavigation?XI`<div @keydown=${this.handleEndOfCard} aria-label=${this.strings.endOfCard} tabindex="0" id="end-of-container"></div>`:XI``;return XI`
      <div class="root" dir=${this.direction}>
        <div class=${this._smallView?"small":""}>
          ${l}
          ${s}
          <div class="person-details-container">${h}</div>
          <div class="expanded-details-container">${v}</div>
          ${m}
        </div>
      </div>
     `}handleEndOfCard(t){if(t&&"Tab"===t.code){const t=this.renderRoot.querySelector("#end-of-container");if(t){t.blur();const o=this.renderRoot.querySelector("mgt-person");o&&o.focus()}}}closeCard(){this.updateCurrentSection(null),this.isExpanded=!1}renderNoData(){return this.renderTemplate("no-data",null)||XI``}renderPerson(){return mgtHtml`
      <mgt-person
        tabindex="0"
        class="person-image"
        .personDetails=${this.internalPersonDetails}
        .personImage=${this.getImage()}
        .personPresence=${this.personPresence}
        .showPresence=${this.showPresence}
        .avatarSize=${"large"}
        .view=${exports.ViewType.threelines}
      ></mgt-person>
    `}renderPersonSubtitle(t){if((t=t||this.internalPersonDetails).department)return XI`
       <div class="department">${t.department}</div>
     `}renderContactIcons(t){const o=t=t||this.internalPersonDetails;let s,l,h,v;return getEmailFromGraphEntity(t)&&(s=XI`
         <div class="icon"
           @click=${()=>this.emailUser()}
           @mouseenter=${()=>this.setHoveredState("email",!0)}
           @mouseleave=${()=>this.setHoveredState("email",!1)}
           tabindex=0
           role="button">
           ${this.isHovered("email")?getSvg($A.SmallEmailHovered):getSvg($A.SmallEmail)}
         </div>
       `),(null==o?void 0:o.userPrincipalName)&&(l=XI`
         <div class="icon"
           @click=${()=>this.chatUser()}
           @mouseenter=${()=>this.setHoveredState("chat",!0)}
           @mouseleave=${()=>this.setHoveredState("chat",!1)}
           tabindex=0
           role="button">
           ${this.isHovered("chat")?getSvg($A.SmallChatHovered):getSvg($A.SmallChat)}
         </div>
       `),h=XI`
        <div class="icon"
           @click=${()=>this.videoCallUser()}
           @mouseenter=${()=>this.setHoveredState("video",!0)}
           @mouseleave=${()=>this.setHoveredState("video",!1)}
           tabindex=0
           role="button">
           ${this.isHovered("video")?getSvg($A.VideoHovered):getSvg($A.Video)}
         </div>
      `,o.userPrincipalName&&(v=XI`
         <div class="icon"
           @click=${()=>this.callUser()}
           @mouseenter=${()=>this.setHoveredState("call",!0)}
           @mouseleave=${()=>this.setHoveredState("call",!1)}
           tabindex=0
           role="button">
           ${this.isHovered("call")?getSvg($A.CallHovered):getSvg($A.Call)}
         </div>
       `),XI`
       <div class="base-icons">
         ${s} ${l} ${h} ${v}
       </div>
     `}renderExpandedDetailsButton(){return XI`
      <div
        class="expanded-details-button"
        @click=${this.showExpandedDetails}
        @keydown=${this.handleKeyDown}
        tabindex=0
      >
        ${getSvg($A.ExpandDown)}
      </div>
     `}renderExpandedDetails(t){if(!this._cardState&&this._isStateLoading)return mgtHtml`
         <div class="loading">
           <mgt-spinner></mgt-spinner>
         </div>
       `;Providers.globalProvider.state===exports.ProviderState.SignedOut&&this.loadSections(),t=t||this.internalPersonDetails;const o=this.renderSectionNavigation();return XI`
      <div class="section-nav">
        ${o}
      </div>
      <div
        class="section-host ${this._smallView?"small":""} ${this._smallView?"small":""}"
        @wheel=${t=>this.handleSectionScroll(t)}
        tabindex=0
      ></div>
    `}renderSectionNavigation(){if(!this.sections||this.sections.length<2&&!this.hasTemplate("additional-details"))return;const t=this._currentSection?this.sections.indexOf(this._currentSection):-1,o=this.sections.map(((o,s)=>{const l=o.tagName.toLowerCase(),h=IA({active:s===t,"section-nav__icon":!0});return XI`
        <fluent-tab
          id="${l}-Tab"
          class=${h}
          slot="tab"
          @keyup="${()=>this.updateCurrentSection(o)}"
          @click=${()=>this.updateCurrentSection(o)}
        >
          ${o.renderIcon()}
        </fluent-tab>
      `})),s=this.sections.map(((t,o)=>XI`
        <fluent-tab-panel slot="tabpanel">
          <div class="inserted">${this._currentSection?t.asFullView():null}</div>
        </fluent-tab-panel>
      `)),l=IA({active:-1===t,"section-nav__icon":!0,overviewTab:!0});return XI`
      <fluent-tabs
        orientation="horizontal"
        activeindicator
        @wheel=${t=>this.handleSectionScroll(t)}
      >
        <fluent-tab
          class="${l}"
          slot="tab"
          @keyup="${()=>this.updateCurrentSection(null)}"
          @click=${()=>this.updateCurrentSection(null)}
        >
          <div>${getSvg($A.Overview)}</div>
        </fluent-tab>
        ${o}
        <fluent-tab-panel slot="tabpanel" >
          <div class="overview-panel">${this._currentSection?null:this.renderOverviewSection()}</div>
        </fluent-tab-panel>
        ${s}
      </fluent-tabs>
    `}renderOverviewSection(){const t=this.sections.map((t=>XI`
        <div class="section">
          <div class="section__header">
            <div class="section__title" tabindex=0>${t.displayName}</div>
              <fluent-button
                appearance="lightweight"
                class="section__show-more"
                @click=${()=>this.updateCurrentSection(t)}
              >
                ${this.strings.showMoreSectionButton}
              </fluent-button>
          </div>
          <div class="section__content">${t.asCompactView()}</div>
        </div>
      `)),o=this.renderTemplate("additional-details",{person:this.internalPersonDetails,personImage:this.getImage(),state:this._cardState});return o&&t.splice(1,0,XI`
           <div class="section">
             <div class="additional-details">${o}</div>
           </div>
         `),XI`
       <div class="sections">
          ${this.renderMessagingSection()}
          ${t}
       </div>
     `}renderCurrentSection(){if(this.sections&&this.sections.length||this.hasTemplate("additional-details"))return 1!==this.sections.length||this.hasTemplate("additional-details")?this._currentSection?XI`
       ${this._currentSection.asFullView()}
     `:this.renderOverviewSection():XI`
         ${this.sections[0].asFullView()}
       `}renderMessagingSection(){const t=this.personDetails,o=this._me.userPrincipalName,s=this._chatInput;return(null==t?void 0:t.userPrincipalName)===o?void 0:XI`
      <div class="message-section">
        <fluent-text-field appearance="outline" placeholder="${this.strings.quickMessage}"
          .value=${s}
          @input=${t=>{this._chatInput=t.target.value,this.requestUpdate()}}
          @keydown="${t=>this.sendQuickMessageOnEnter(t)}">
        </fluent-text-field>
        <fluent-button class="send-message-icon" 
          @click=${()=>this.sendQuickMessage()}
          ?disabled=${this.isSending}>
          ${this.isSending?getSvg($A.Confirmation):getSvg($A.Send)}
        </fluent-button>
      </div>
      `}loadState(){var t;return __awaiter$i(this,void 0,void 0,(function*(){if(this._cardState)return;if(!this.personDetails&&this.inheritDetails){let t=this.parentElement;for(;t&&"MGT-PERSON"!==t.tagName;)t=t.parentElement;const o=t.personDetails||t.personDetailsInternal;t&&o&&(this.personDetails=o,this.personImage=t.personImage)}const o=Providers.globalProvider;if(!o||o.state!==exports.ProviderState.SignedIn)return;const s=o.graph.forComponent(this);if(this._graph=s,this._isStateLoading=!0,this._me||(this._me=yield Providers.me()),this.personDetails){const t=this.personDetails,o=t.userPrincipalName||t.id;if(o&&!getEmailFromGraphEntity(t)){const t=yield getUserWithPhoto(s,o);this.personDetails=t,this.personImage=this.getImage()}}else if(this.userId||"me"===this.personQuery){const t=yield getUserWithPhoto(s,this.userId);this.personDetails=t,this.personImage=this.getImage()}else if(this.personQuery){const t=yield findPeople(s,this.personQuery,1);t&&t.length&&(this.personDetails=t[0],getPersonImage(s,this.personDetails,eL.config.useContactApis).then((t=>{t&&(this.personDetails.personImage=t,this.personImage=t)})))}const l={activity:"Offline",availability:"Offline",id:null};if(!this.personPresence&&this.showPresence)try{this.personDetails&&this.personDetails.id?getUserPresence(s,this.personDetails.id).then((t=>{this.personPresence=t})):this.personPresence=l}catch(t){this.personPresence=l}(null===(t=this.personDetails)||void 0===t?void 0:t.id)&&(this._cardState=yield getPersonCardGraphData(s,this.personDetails,this._me===this.personDetails.id,eL.config)),this.loadSections(),this._isStateLoading=!1}))}sendQuickMessage(){return __awaiter$i(this,void 0,void 0,(function*(){const t=this._chatInput.trim();if(!t||!t.length)return;const o=this.personDetails,s=this._me.userPrincipalName;this.isSending=!0;const l=yield function createChat(t,o,s){return __awaiter$j(this,void 0,void 0,(function*(){const l={chatType:"oneonOne",members:[{"@odata.type":"#microsoft.graph.aadUserConversationMember",roles:["owner"],"user@odata.bind":`https://graph.microsoft.com/v1.0/users('${s}')`},{"@odata.type":"#microsoft.graph.aadUserConversationMember",roles:["owner"],"user@odata.bind":`https://graph.microsoft.com/v1.0/users('${o}')`}]};return yield t.api("/chats").header("Cache-Control","no-store").middlewareOptions(prepScopes("Chat.Create","Chat.ReadWrite")).post(l)}))}(this._graph,o.userPrincipalName,s),h={body:{content:t}};yield function sendMessage(t,o,s){return __awaiter$j(this,void 0,void 0,(function*(){return yield t.api(`/chats/${o}/messages`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Chat.ReadWrite","ChatMessage.Send")).post(s)}))}(this._graph,l.id,h),this.isSending=!1,this.clearInputData()}))}emailUser(){const t=this.internalPersonDetails;if(t){const o=getEmailFromGraphEntity(t);o&&window.open("mailto:"+o,"_blank","noreferrer")}}get hasPhone(){var t,o;const s=this.personDetails,l=this.personDetails;return Boolean(null===(t=null==s?void 0:s.businessPhones)||void 0===t?void 0:t.length)||Boolean(null===(o=null==l?void 0:l.phones)||void 0===o?void 0:o.length)}callUser(){const t=this.personDetails,o=this.personDetails;if(t&&t.businessPhones&&t.businessPhones.length){const o=t.businessPhones[0];o&&window.open("tel:"+o,"_blank","noreferrer")}else if(o&&o.phones&&o.phones.length){const t=this.getPersonBusinessPhones(o)[0];t&&window.open("tel:"+t,"_blank","noreferrer")}}chatUser(t=null){const o=this.personDetails;if(o&&o.userPrincipalName){let s=`https://teams.microsoft.com/l/chat/0/0?users=${o.userPrincipalName}`;t&&t.length&&(s+=`&message=${t}`);const openWindow=()=>window.open(s,"_blank","noreferrer");TeamsHelper.isAvailable?TeamsHelper.executeDeepLink(s,(t=>{t||openWindow()})):openWindow()}}videoCallUser(){const t=this.personDetails;if(t&&t.userPrincipalName){const o=`https://teams.microsoft.com/l/call/0/0?users=${t.userPrincipalName}&withVideo=true`,openWindow=()=>window.open(o,"_blank");TeamsHelper.isAvailable?TeamsHelper.executeDeepLink(o,(t=>{t||openWindow()})):openWindow()}}showExpandedDetails(){const t=this.renderRoot.querySelector(".root");t&&t.animate&&t.animate([{height:"auto",transformOrigin:"top left"},{height:"auto",transformOrigin:"top left"}],{duration:1e3,easing:"ease-in-out",fill:"both"}),this.isExpanded=!0,this.fireCustomEvent("expanded",null,!0)}loadSections(){if(this.sections=[],!this.internalPersonDetails)return;const t=new exports.MgtContact(this.internalPersonDetails);if(t.hasData&&this.sections.push(t),!this._cardState)return;const{person:o,directReports:s,messages:l,files:h,profile:v}=this._cardState;if(eL.config.sections.organization&&(o&&o.manager||s&&s.length)&&this.sections.push(new exports.MgtOrganization(this._cardState,this._me)),eL.config.sections.mailMessages&&l&&l.length&&this.sections.push(new exports.MgtMessages(l)),eL.config.sections.files&&h&&h.length&&this.sections.push(new exports.MgtFileList),eL.config.sections.profile&&v){const t=new exports.MgtProfile(v);t.hasData&&this.sections.push(t)}}getImage(){if(this.personImage)return this.personImage;const t=this.personDetails;return t&&t.personImage?t.personImage:null}clearInputData(){this._chatInput="",this.requestUpdate()}getPersonBusinessPhones(t){const o=t.phones,s=[];for(const t of o)"business"===t.type&&s.push(t.number);return s}updateCurrentSection(t){if(t){const o=t.tagName.toLowerCase();this.renderRoot.querySelector(`#${o}-Tab`).click()}const o=this.renderRoot.querySelectorAll("fluent-tab-panel");for(const t of o)t.scrollTop=0;this._currentSection=t,this.requestUpdate()}handleSectionScroll(t){const o=this.renderRoot.querySelectorAll("fluent-tab-panel");for(const s of o)s&&(t.deltaY<0&&0===s.scrollTop||t.deltaY>0&&s.clientHeight+s.scrollTop>=s.scrollHeight-1||t.stopPropagation())}handleKeyDown(t){t&&"Enter"===t.code&&this.showExpandedDetails()}sendQuickMessageOnEnter(t){"Enter"===t.code&&this.sendQuickMessage()}},exports.MgtPersonCard._config={sections:{files:!0,mailMessages:!0,organization:{showWorksWith:!0},profile:!0},useContactApis:!0,isSendMessageVisible:!0},__decorate$d([e$1({attribute:"person-details",type:Object}),__metadata$d("design:type",Object),__metadata$d("design:paramtypes",[Object])],exports.MgtPersonCard.prototype,"personDetails",null),__decorate$d([e$1({attribute:"person-query"}),__metadata$d("design:type",String)],exports.MgtPersonCard.prototype,"personQuery",void 0),__decorate$d([e$1({attribute:"lock-tab-navigation",type:Boolean}),__metadata$d("design:type",Boolean)],exports.MgtPersonCard.prototype,"lockTabNavigation",void 0),__decorate$d([e$1({attribute:"user-id"}),__metadata$d("design:type",String),__metadata$d("design:paramtypes",[String])],exports.MgtPersonCard.prototype,"userId",null),__decorate$d([e$1({attribute:"person-image",type:String}),__metadata$d("design:type",String)],exports.MgtPersonCard.prototype,"personImage",void 0),__decorate$d([e$1({attribute:"fetch-image",type:Boolean}),__metadata$d("design:type",Boolean)],exports.MgtPersonCard.prototype,"fetchImage",void 0),__decorate$d([e$1({attribute:"is-expanded",type:Boolean}),__metadata$d("design:type",Boolean)],exports.MgtPersonCard.prototype,"isExpanded",void 0),__decorate$d([e$1({attribute:"inherit-details",type:Boolean}),__metadata$d("design:type",Boolean)],exports.MgtPersonCard.prototype,"inheritDetails",void 0),__decorate$d([e$1({attribute:"show-presence",type:Boolean}),__metadata$d("design:type",Boolean)],exports.MgtPersonCard.prototype,"showPresence",void 0),__decorate$d([e$1({attribute:"person-presence",type:Object}),__metadata$d("design:type",Object)],exports.MgtPersonCard.prototype,"personPresence",void 0),__decorate$d([t$1(),__metadata$d("design:type",Boolean)],exports.MgtPersonCard.prototype,"isSending",void 0),__decorate$d([t$1(),__metadata$d("design:type",Object)],exports.MgtPersonCard.prototype,"_cardState",void 0),__decorate$d([t$1(),__metadata$d("design:type",Boolean)],exports.MgtPersonCard.prototype,"_isStateLoading",void 0),__decorate$d([t$1(),__metadata$d("design:type",Object)],exports.MgtPersonCard.prototype,"hoverStates",void 0),exports.MgtPersonCard=eL=__decorate$d([customElement("person-card"),__metadata$d("design:paramtypes",[])],exports.MgtPersonCard);const tL=[i$4`
:host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\e70d"}.ms-Icon--ChevronUp::before{content:"\\\e70e"}.ms-Icon--Contact::before{content:"\\\e77b"}.ms-Icon--AddFriend::before{content:"\\\e8fa"}.ms-Icon--OutlookLogoInverse::before{content:"\\\eb6d"}:host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\e70d"}.ms-Icon--ChevronUp::before{content:"\\\e70e"}.ms-Icon--Contact::before{content:"\\\e77b"}.ms-Icon--AddFriend::before{content:"\\\e8fa"}.ms-Icon--OutlookLogoInverse::before{content:"\\\eb6d"}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--task-border:1px solid #e1dfdd;--task-complete-border:2px dotted #e1dfdd;--task-new-add-button-disabled-background:#ebebeb;--task-icon-color:#000000}.mgt-dark{--task-border:1px solid #717171;--task-complete-border:2px dotted #717171;--task-new-add-button-disabled-background:#4f4f4f;--task-icon-color:#ffffff}:host{font-family:var(--default-font-family);display:flex;flex-direction:column;background-color:var(--background-color-sub1,#faf9f8);padding:var(--tasks-padding,12px);color:var(--color-sub1,var(--neutral-foreground-rest,#1a1a1a))}:host input[type=date]::-webkit-calendar-picker-indicator,:host input[type=date]::-webkit-inner-spin-button{display:none;-webkit-appearance:none}:host .TaskIcon{font-family:FabricMDL2Icons;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .TaskIcon.Divider{vertical-align:initial;margin:0 12px;font-size:16px}:host .Header{padding:var(--tasks-header-padding,0);margin:var(--tasks-header-margin,0 0 12px 0);padding:var(--tasks-title-padding,0);display:flex;align-items:center;justify-content:space-between}:host .Header .header__loading{max-width:90px;width:100%;height:20px;background:#f2f2f2}:host .Header select{font-family:var(--default-font-family, "Segoe UI");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px);border:none;-moz-appearance:none;-webkit-appearance:none;cursor:pointer}:host .Header select::-ms-expand{display:none}:host .Header .PlanTitle{font-family:var(--default-font-family, "Segoe UI");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px)}:host .Header .AddBar{display:flex}:host .Header .AddBar .AddBarItem{flex:1 1 auto}:host .Header .NewTaskDue{display:flex}:host .Header .NewTaskDue input{flex:1 1 auto;background-color:var(--background-color-sub1,#faf9f8)}:host .Header .TitleCont{flex:1 1 auto;display:flex;align-items:center;height:var(--tasks-new-button-height,34px)}:host .Header .NewTaskButton{flex:0 0 auto;display:flex;justify-content:center;align-items:center;width:var(--tasks-new-button-width,auto);height:var(--tasks-new-button-height,32px);border-radius:2px;padding:0 20px;background:var(--tasks-new-button-background,#0078d4);border:var(--tasks-new-button-border,solid 1px transparent);color:var(--tasks-new-button-color,#fff);user-select:none;-moz-user-select:none;-ms-user-select:none;cursor:pointer}:host .Header .NewTaskButton span{font-size:14px;font-weight:600;letter-spacing:.1px;line-height:14px}:host .Header .NewTaskButton .TaskIcon{margin-right:8px}:host .Header .NewTaskButton.hidden{visibility:hidden}:host .Header .NewTaskButton:hover{background:var(--tasks-new-button-hover-background,#106ebe)}:host .Header .NewTaskButton:active{background:var(--tasks-new-button-active-background,#005a9e)}:host .Task{position:relative;margin:var(--task-margin,0 0 18px 0);padding:var(--task-padding,0 0 0 0);background-color:var(--tasks-background-color,var(--background-color,#fff));border:var(--task-border,1px solid #e1dfdd);border-radius:8px}:host .Task .TaskContent{display:flex}:host .Task .TaskContent .Divider{position:absolute;height:2px;left:0;right:0;bottom:0;background-color:var(--background-color-sub1,#faf9f8)}:host .Task .TaskContent .TaskDetailsContainer{flex:1;display:grid;display:-ms-grid;grid-template-columns:auto 1fr;-ms-grid-columns:auto 1fr;grid-template-rows:auto auto auto auto;-ms-grid-rows:auto auto auto auto;justify-content:space-between;align-items:flex-start;color:var(--task-detail-color,var(--color-sub2,var(--neutral-foreground-hint,#717171)));font-size:12px;font-weight:600;white-space:normal;margin-bottom:12px}:host .Task .TaskContent .TaskDetailsContainer .TaskDetail{width:100%;height:100%;margin:4px 24px 6px 0;display:flex;justify-content:flex-start;align-items:center}:host .Task .TaskContent .TaskDetailsContainer .TaskTitle{color:var(--task-title-color,var(--title-color-subtitle,var(--neutral-foreground-rest,#1a1a1a)));font-size:14px;font-weight:600;grid-row:1;-ms-grid-row:1;grid-column:1/3;-ms-grid-column:1;-ms-grid-column-span:2;margin:22px 0 4px}:host .Task .TaskContent .TaskDetailsContainer .TaskGroup{min-height:24px;grid-row:2;-ms-grid-row:2;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer .TaskBucket{min-height:24px;grid-row:2;-ms-grid-row:2;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer .TaskDue{justify-content:flex-end;align-items:flex-start;grid-row:4;-ms-grid-row:4;grid-column:1/3;-ms-grid-column:1;-ms-grid-column-span:2}:host .Task .TaskContent .TaskDetailsContainer.tablet{grid-template-columns:1fr .5fr 1fr .5fr;-ms-grid-columns:1fr .5fr 1fr .5fr;grid-template-rows:auto auto;-ms-grid-rows:auto auto}:host .Task .TaskContent .TaskDetailsContainer.tablet.NoPlan{grid-template-columns:0 1fr 1fr 1fr;-ms-grid-columns:0 1fr 1fr 1fr}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskDetail{margin:4px 24px 6px 0}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskTitle{grid-row:1;-ms-grid-row:1;grid-column:1/5;-ms-grid-column:1;-ms-grid-column-span:4}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskGroup{grid-row:2;-ms-grid-row:2;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskBucket{grid-row:2;-ms-grid-row:2;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskAssignee{grid-row:2;-ms-grid-row:2;grid-column:3;-ms-grid-column:3}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskDue{justify-content:flex-start;align-items:center;grid-row:2;-ms-grid-row:2;grid-column:4;-ms-grid-column:4}:host .Task .TaskContent .TaskDetailsContainer.desktop{grid-template-columns:2fr 1fr .5fr 1fr .5fr;-ms-grid-columns:2fr 1fr .5fr 1fr .5fr;grid-template-rows:auto;-ms-grid-rows:auto;margin:0}:host .Task .TaskContent .TaskDetailsContainer.desktop.NoPlan{grid-template-columns:2fr 0 1fr 1fr 1fr;-ms-grid-columns:2fr 0 1fr 1fr 1fr}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskDetail{margin:0 24px 0 0}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskTitle{padding:0;grid-row:1;-ms-grid-row:1;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskGroup{min-height:61px;grid-row:1;-ms-grid-row:1;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskBucket{grid-row:1;-ms-grid-row:1;grid-column:3;-ms-grid-column:3}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskAssignee{grid-row:1;-ms-grid-row:1;grid-column:4;-ms-grid-column:4}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskDue{justify-content:flex-start;align-items:center;grid-row:1;-ms-grid-row:1;grid-column:5;-ms-grid-column:5}:host .Task .TaskContent .TaskDetailsContainer svg{vertical-align:middle;margin-right:4px}:host .Task .TaskContent .TaskDetailsContainer svg path{fill:var(--task-detail-color,var(--color-sub2,var(--neutral-foreground-hint,#717171)))}:host .Task .TaskContent .TaskDetailsContainer select,:host .Task .TaskContent .TaskDetailsContainer span{vertical-align:middle;color:var(--color-sub2,var(--neutral-foreground-hint,#717171))}:host .Task .TaskContent .TaskDetailsContainer .TaskIcon{color:#797775;margin-right:8px}:host .Task .TaskContent .TaskDetailsContainer .people{color:var(--task-detail-color,var(--color-sub2,var(--neutral-foreground-hint,#717171)));font-size:16px}:host .Task .TaskContent .TaskDetailsContainer .person{display:inline-block}:host .Task .TaskContent .TaskDetailsContainer .Picker{background-color:var(--background-color-sub1,#faf9f8);-webkit-background-clip:padding-box;-moz-background-clip:padding-box;background-clip:padding-box;width:var(--mgt-flyout-set-width,350px);color:var(--task-detail-color,var(--color-sub2,var(--neutral-foreground-hint,#717171)))}:host .Task .TaskContent .TaskDetailsContainer .Picker .people-picker{--separator-margin:0px 10px 0px 10px}:host .Task .TaskContent .TaskDetailsContainer input,:host .Task .TaskContent .TaskDetailsContainer select{color:var(--task-detail-color,var(--color-sub2,var(--neutral-foreground-hint,#717171)));font-size:.9em;background-color:var(--background-color-sub1,#faf9f8)}:host .Task .TaskCheckContainer{font-family:FabricMDL2Icons;display:inline-block;border-radius:50%;color:#fff;cursor:pointer;display:flex;align-items:var(--task-icon-alignment,flex-start);margin:21px 10px 20px 20px;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Task .TaskCheckContainer.Complete .TaskCheck{background-color:var(--task-icon-background-completed,#00ad56);border:var(--task-icon-border-completed,solid 1px #fff);color:var(--task-icon-color-completed,#fff)}:host .Task .TaskCheckContainer.Complete .TaskContent .TaskDetailsContainer .TaskTitle{text-decoration:line-through;color:var(--color-sub3,#727170)}:host .Task .TaskCheckContainer .TaskCheck{font-family:FabricMDL2Icons;font-size:12px;display:inline-block;width:18px;height:18px;border-radius:var(--task-icon-border-radius,50%);border:var(--task-icon-border,solid 1px #797775);color:var(--task-icon-color,#000);display:flex;justify-content:center;align-items:center;background-color:var(--task-icon-background,transparent);user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Task .TaskCheckContainer .TaskCheck.Loading .TaskCheckContent{animation:rotateIcon 2s infinite linear}:host .Task .TaskOptions{cursor:pointer;user-select:none;-moz-user-select:none;-ms-user-select:none;margin:16px 8px 0 0}:host .Task.ReadOnly .TaskCheckContainer{cursor:default}:host .Task.Complete{background:var(--task-complete-background,var(--background-color-sub1,#faf9f8));border:var(--task-complete-border,2px dotted #e1dfdd)}:host .Task.Complete .TaskContent .TaskDetailsContainer .TaskTitle{text-decoration:line-through;color:var(--color-sub3,#727170)}:host .Task.NewTask{margin:var(--task-new-margin,var(--task-margin,0 0 24px 0));display:flex;flex-direction:row}:host .Task.NewTask .SelfAssign{display:none}:host .Task.NewTask .AssignTo{border:0;background:0 0}:host .Task.NewTask .FakeCheckBox{width:15px;height:15px;cursor:pointer;margin:0 5px 0 5px}:host .Task.NewTask .FakeCheckBox::after{font-family:FabricMDL2Icons;content:"uE739"}:host .Task.NewTask .FakeCheckBox~:checked{font-family:FabricMDL2Icons;content:"uE73A"}:host .Task.NewTask .TaskContent{flex:1 1 auto;align-content:center;vertical-align:middle;margin:0 0 0 12px}:host .Task.NewTask .TaskContent .TaskDetailsContainer{display:flex;flex-direction:column;align-items:stretch;margin:0}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle{display:flex;height:32px;padding:2px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input{flex:1;font-family:var(--default-font-family, "Segoe UI");margin:var(--task-new-input-margin,0 24px 0 16px);padding:var(--task-new-input-padding,6px);font-size:var(--task-new-input-font-size,14px);font-weight:600;border:var(--task-new-border,none);border-bottom:1px solid #e1dfdd;outline:0;border-radius:0;background-color:var(--background-color-sub1,#faf9f8)}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:hover{border-bottom:1px solid #106ebe}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:active{border-bottom:1px solid #005a9e}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:focus{border-bottom:1px solid #0078d4}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails{display:flex;justify-content:stretch;align-items:center;flex-wrap:wrap;margin:14px 0 14px 4px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskGroup{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskBucket{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskDue{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskAssignee{margin:8px 16px;min-width:80px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .TaskPeople label{display:flex;align-content:center;align-items:center}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select{font-family:var(--default-font-family);font-size:12px;font-weight:600;border:var(--task-new-select-border,none);border-bottom:1px solid #e1dfdd}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:hover,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:hover{border-bottom:1px solid #106ebe}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:active,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:active{border-bottom:1px solid #005a9e}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:focus,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:focus{border-bottom:1px solid #0078d4}:host .Task.NewTask .TaskAddButtonContainer{margin-right:28px}:host .Task.NewTask .TaskAddButtonContainer .TaskAdd,:host .Task.NewTask .TaskAddButtonContainer .TaskCancel{justify-content:center;align-items:center;cursor:pointer;flex:0 0 auto;display:flex;width:var(--tasks-new-button-width,100px);height:var(--tasks-new-button-height,32px);border-radius:4px;border:var(--tasks-new-button-border,solid 1px #e5e5e5);font-family:var(--default-font-family, "Segoe UI");font-size:14px;line-height:20px}:host .Task.NewTask .TaskAddButtonContainer .TaskAdd{color:#fff;background:var(--task-new-add-button-background,#0078d4);margin:22px 0 12px auto}:host .Task.NewTask .TaskAddButtonContainer .TaskCancel{color:var(--task-new-cancel-button-color,var(--color-sub1,var(--neutral-foreground-rest,#1a1a1a)))}:host .Task.NewTask .TaskAddButtonContainer.Disabled .TaskAdd{color:var(--task-new-cancel-button-color,var(--color-sub1,var(--neutral-foreground-rest,#1a1a1a)));background:var(--task-new-add-button-disabled-background,#fff);cursor:default}:host .Task.LoadingTask .TaskCheckContainer{cursor:default}:host .Task.LoadingTask .TaskDetails{display:flex}:host .Task.LoadingTask .TaskCheck{background:#f2f2f2;border-color:#f2f2f2;cursor:default}:host .Task.LoadingTask .TaskDetailIcon{width:16px;height:16px;margin:5px;background:#f2f2f2}:host .Task.LoadingTask .TaskTitle{background:#f2f2f2;max-width:400px;height:20px;margin-right:20px!important}:host .Task.LoadingTask .TaskDetail{margin-right:12px;display:flex;flex-direction:row;align-items:center}:host .Task.LoadingTask .TaskDetailName{width:81px;height:10px;background:#f2f2f2}@keyframes rotateIcon{from{transform:rotate(0)}to{transform:rotate(360deg)}}[dir=rtl] .arrow-options{--arrow-options-left:auto}[dir=rtl] .dot-options{--dot-options-translateX:translateX(60px)}[dir=rtl] .TaskDetails{margin-right:14px!important}[dir=rtl] .TaskIcon{margin-left:8px}[dir=rtl] .TaskDetail svg{margin-left:4px}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host svg{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}
`];var __awaiter$h=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};function assignPeopleToPlannerTask(t,o,s,l){return setPlannerTaskDetails(t,o,{assignments:s},l)}function setPlannerTaskDetails(t,o,s,l){return __awaiter$h(this,void 0,void 0,(function*(){return yield t.api(`/planner/tasks/${o}`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Group.ReadWrite.All")).header("If-Match",l).patch(JSON.stringify(s))}))}var __awaiter$g=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};function setTodoTaskDetails(t,o,s,l){return __awaiter$g(this,void 0,void 0,(function*(){return yield t.api(`/me/outlook/tasks/${o}`).header("Cache-Control","no-store").header("If-Match",l).middlewareOptions(prepScopes("Tasks.ReadWrite")).patch(s)}))}var __awaiter$f=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};class TaskSourceBase{constructor(t){this.graph=BetaGraph.fromGraph(t)}}class PlannerTaskSource extends TaskSourceBase{getTaskGroups(){return __awaiter$f(this,void 0,void 0,(function*(){return(yield function getAllMyPlannerPlans(t){return __awaiter$h(this,void 0,void 0,(function*(){const o=yield t.api("/me/planner/plans").header("Cache-Control","no-store").middlewareOptions(prepScopes("Group.Read.All")).get();return o&&o.value}))}(this.graph)).map((t=>({id:t.id,title:t.title})))}))}getTaskGroupsForGroup(t){return __awaiter$f(this,void 0,void 0,(function*(){return(yield function getPlansForGroup(t,o){return __awaiter$h(this,void 0,void 0,(function*(){const s=`/groups/${o}/planner/plans`,l=yield t.api(s).header("Cache-Control","no-store").middlewareOptions(prepScopes("Group.Read.All")).get();return l?l.value:null}))}(this.graph,t)).map((t=>({id:t.id,title:t.title})))}))}getTaskGroup(t){return __awaiter$f(this,void 0,void 0,(function*(){const o=yield function getSinglePlannerPlan(t,o){return __awaiter$h(this,void 0,void 0,(function*(){return yield t.api(`/planner/plans/${o}`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Group.Read.All")).get()}))}(this.graph,t);return{id:o.id,title:o.title,_raw:o}}))}getTaskFoldersForTaskGroup(t){return __awaiter$f(this,void 0,void 0,(function*(){return(yield function getBucketsForPlannerPlan(t,o){return __awaiter$h(this,void 0,void 0,(function*(){const s=yield t.api(`/planner/plans/${o}/buckets`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Group.Read.All")).get();return s&&s.value}))}(this.graph,t)).map((t=>({_raw:t,id:t.id,name:t.name,parentId:t.planId})))}))}getTasksForTaskFolder(t){return __awaiter$f(this,void 0,void 0,(function*(){return(yield function getTasksForPlannerBucket(t,o){return __awaiter$h(this,void 0,void 0,(function*(){const s=yield t.api(`/planner/buckets/${o}/tasks`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Group.Read.All")).get();return s&&s.value}))}(this.graph,t)).map((t=>({_raw:t,assignments:t.assignments,completed:100===t.percentComplete,dueDate:t.dueDateTime&&new Date(t.dueDateTime),eTag:t["@odata.etag"],id:t.id,immediateParentId:t.bucketId,name:t.title,topParentId:t.planId})))}))}setTaskComplete(t,o){return __awaiter$f(this,void 0,void 0,(function*(){return yield function setPlannerTaskComplete(t,o,s){return setPlannerTaskDetails(t,o,{percentComplete:100},s)}(this.graph,t,o)}))}setTaskIncomplete(t,o){return __awaiter$f(this,void 0,void 0,(function*(){return yield function setPlannerTaskIncomplete(t,o,s){return setPlannerTaskDetails(t,o,{percentComplete:0},s)}(this.graph,t,o)}))}addTask(t){return __awaiter$f(this,void 0,void 0,(function*(){return yield function addPlannerTask(t,o){return t.api("/planner/tasks").header("Cache-Control","no-store").middlewareOptions(prepScopes("Group.ReadWrite.All")).post(o)}(this.graph,{assignments:t.assignments,bucketId:t.immediateParentId,dueDateTime:t.dueDate&&t.dueDate.toISOString(),planId:t.topParentId,title:t.name})}))}assignPeopleToTask(t,o,s){return __awaiter$f(this,void 0,void 0,(function*(){return yield assignPeopleToPlannerTask(this.graph,t,o,s)}))}removeTask(t,o){return __awaiter$f(this,void 0,void 0,(function*(){return yield function removePlannerTask(t,o,s){return t.api(`/planner/tasks/${o}`).header("Cache-Control","no-store").header("If-Match",s).middlewareOptions(prepScopes("Group.ReadWrite.All")).delete()}(this.graph,t,o)}))}isAssignedToMe(t,o){return Object.keys(t.assignments).includes(o)}}class TodoTaskSource extends TaskSourceBase{getTaskGroups(){return __awaiter$f(this,void 0,void 0,(function*(){return(yield function getAllMyTodoGroups(t){return __awaiter$g(this,void 0,void 0,(function*(){const o=yield t.api("/me/outlook/taskGroups").header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.Read")).get();return o&&o.value}))}(this.graph)).map((t=>({_raw:t,id:t.id,secondaryId:t.groupKey,title:t.name})))}))}getTaskGroup(t){return __awaiter$f(this,void 0,void 0,(function*(){const o=yield function getSingleTodoGroup(t,o){return __awaiter$g(this,void 0,void 0,(function*(){return yield t.api(`/me/outlook/taskGroups/${o}`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.Read")).get()}))}(this.graph,t);return{id:o.id,secondaryId:o.groupKey,title:o.name,_raw:o}}))}getTaskFoldersForTaskGroup(t){return __awaiter$f(this,void 0,void 0,(function*(){return(yield function getFoldersForTodoGroup(t,o){return __awaiter$g(this,void 0,void 0,(function*(){const s=yield t.api(`/me/outlook/taskGroups/${o}/taskFolders`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.Read")).get();return s&&s.value}))}(this.graph,t)).map((o=>({_raw:o,id:o.id,name:o.name,parentId:t})))}))}getTasksForTaskFolder(t,o){return __awaiter$f(this,void 0,void 0,(function*(){return(yield function getAllTodoTasksForFolder(t,o){return __awaiter$g(this,void 0,void 0,(function*(){const s=yield t.api(`/me/outlook/taskFolders/${o}/tasks`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.Read")).get();return s&&s.value}))}(this.graph,t)).map((s=>({_raw:s,assignments:{},completed:!!s.completedDateTime,dueDate:s.dueDateTime&&new Date(s.dueDateTime.dateTime+"Z"),eTag:s["@odata.etag"],id:s.id,immediateParentId:t,name:s.subject,topParentId:o})))}))}setTaskComplete(t,o){return __awaiter$f(this,void 0,void 0,(function*(){return yield function setTodoTaskComplete(t,o,s){return __awaiter$g(this,void 0,void 0,(function*(){return yield setTodoTaskDetails(t,o,{isReminderOn:!1,status:"completed"},s)}))}(this.graph,t,o)}))}assignPeopleToTask(t,o,s){return __awaiter$f(this,void 0,void 0,(function*(){return yield assignPeopleToPlannerTask(this.graph,t,o,s)}))}setTaskIncomplete(t,o){return __awaiter$f(this,void 0,void 0,(function*(){return yield function setTodoTaskIncomplete(t,o,s){return __awaiter$g(this,void 0,void 0,(function*(){return yield setTodoTaskDetails(t,o,{isReminderOn:!0,status:"notStarted"},s)}))}(this.graph,t,o)}))}addTask(t){return __awaiter$f(this,void 0,void 0,(function*(){const o={parentFolderId:t.immediateParentId,subject:t.name};return t.dueDate&&(o.dueDateTime={dateTime:t.dueDate.toISOString(),timeZone:"UTC"}),yield function addTodoTask(t,o){return __awaiter$g(this,void 0,void 0,(function*(){const{parentFolderId:s=null}=o;return s?yield t.api(`/me/outlook/taskFolders/${s}/tasks`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.ReadWrite")).post(o):yield t.api("/me/outlook/tasks").header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.ReadWrite")).post(o)}))}(this.graph,o)}))}removeTask(t,o){return __awaiter$f(this,void 0,void 0,(function*(){return yield function removeTodoTask(t,o,s){return __awaiter$g(this,void 0,void 0,(function*(){return yield t.api(`/me/outlook/tasks/${o}`).header("Cache-Control","no-store").header("If-Match",s).middlewareOptions(prepScopes("Tasks.ReadWrite")).delete()}))}(this.graph,t,o)}))}isAssignedToMe(t,o){return!0}getTaskGroupsForGroup(t){return __awaiter$f(this,void 0,void 0,(function*(){}))}}const rL=[i$4`
:host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\e70d"}.ms-Icon--ChevronUp::before{content:"\\\e70e"}.ms-Icon--Contact::before{content:"\\\e77b"}.ms-Icon--AddFriend::before{content:"\\\e8fa"}.ms-Icon--OutlookLogoInverse::before{content:"\\\eb6d"}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}:host,mgt-arrow-options{position:relative;font-family:var(--default-font-family)}:host .ArrowIcon,mgt-arrow-options .ArrowIcon{font-family:FabricMDL2Icons;margin:0 0 0 20px;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Header,mgt-arrow-options .Header{cursor:pointer}:host .Header:hover,mgt-arrow-options .Header:hover{color:var(--theme-primary-color)}:host .Menu,mgt-arrow-options .Menu{position:absolute;left:var(--arrow-options-left,0);box-shadow:var(--box-shadow-color,rgba(0,0,0,.092)) 0 0 40px 5px;background:var(--background-color,#fff);z-index:1;display:none;color:var(--color,#000);white-space:nowrap}:host .Menu.Open,mgt-arrow-options .Menu.Open{display:block}:host .MenuOption,mgt-arrow-options .MenuOption{padding:20px;cursor:pointer;user-select:none;-moz-user-select:none;-ms-user-select:none;display:flex;align-items:center;justify-content:stretch;justify-items:stretch}:host .MenuOption:first,mgt-arrow-options .MenuOption:first{padding:12px 20px 20px 20px}:host .MenuOption:hover,mgt-arrow-options .MenuOption:hover{background-color:var(--background-color--hover,var(--neutral-fill-hover,#f7f7f7))}:host .MenuOption:active,mgt-arrow-options .MenuOption:active{background-color:var(--background-color--active,#e1dfdd)}:host .MenuOptionCheck,mgt-arrow-options .MenuOptionCheck{font-family:FabricMDL2Icons;color:transparent;margin-right:10px}:host .MenuOptionCheck.CurrentValue,mgt-arrow-options .MenuOptionCheck.CurrentValue{color:#023b8f}
`];var __decorate$c=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},__metadata$c=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)};let oL=class MgtArrowOptions extends MgtBaseComponent{static get styles(){return rL}constructor(){super(),this.value="",this.options={},this._clickHandler=t=>this.open=!1}connectedCallback(){super.connectedCallback(),window.addEventListener("click",this._clickHandler)}disconnectedCallback(){window.removeEventListener("click",this._clickHandler),super.disconnectedCallback()}onHeaderClick(t){Object.keys(this.options).length>1&&(t.preventDefault(),t.stopPropagation(),this.open=!this.open)}render(){return XI`
      <span class="Header" @click=${t=>this.onHeaderClick(t)}>
        <span class="CurrentValue">${this.value}</span>
      </span>
      <div class=${IA({Menu:!0,Open:this.open,Closed:!this.open})}>
        ${this.getMenuOptions()}
      </div>
    `}getMenuOptions(){const t=Object.keys(this.options),o=this.options;return t.map((t=>XI`
        <div
          class="MenuOption"
          @click="${s=>{this.open=!1,o[t](s)}}"
        >
          <span class=${IA({MenuOptionCheck:!0,CurrentValue:this.value===t})}>
            \uE73E
          </span>
          <span class="MenuOptionName">${t}</span>
        </div>
      `))}};__decorate$c([e$1({type:Boolean}),__metadata$c("design:type",Boolean)],oL.prototype,"open",void 0),__decorate$c([e$1({type:String}),__metadata$c("design:type",String)],oL.prototype,"value",void 0),__decorate$c([e$1({type:Object}),__metadata$c("design:type",Object)],oL.prototype,"options",void 0),oL=__decorate$c([customElement("arrow-options"),__metadata$c("design:paramtypes",[])],oL);const nL=[i$4`
:host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\e70d"}.ms-Icon--ChevronUp::before{content:"\\\e70e"}.ms-Icon--Contact::before{content:"\\\e77b"}.ms-Icon--AddFriend::before{content:"\\\e8fa"}.ms-Icon--OutlookLogoInverse::before{content:"\\\eb6d"}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}:host,mgt-dot-options{font-family:var(--default-font-family)}:host .DotIcon,mgt-dot-options .DotIcon{display:inline-block;font-family:FabricMDL2Icons;min-width:40px;min-height:30px;text-align:center;line-height:30px}:host .Menu,mgt-dot-options .Menu{position:absolute;box-shadow:var(--box-shadow-color,rgba(0,0,0,.092)) 0 0 40px 5px;background:var(--background-color,#fff);z-index:1;display:none;color:var(--color,#000);white-space:nowrap;transform:var(--dot-options-translateX,translateX(-50px))}:host .DotMenu.Open .Menu,mgt-dot-options .DotMenu.Open .Menu{display:block}:host .DotMenu .DotItem,mgt-dot-options .DotMenu .DotItem{direction:ltr;text-align:left;padding:10px 10px 8px 10px}:host .DotMenu .DotItem:hover,mgt-dot-options .DotMenu .DotItem:hover{background:var(--background-color--hover,var(--neutral-fill-hover,#f7f7f7))}:host .DotMenu .DotItem:active,mgt-dot-options .DotMenu .DotItem:active{background:var(--background-color--active,#e1dfdd)}:host .DotMenu .DotItemName,mgt-dot-options .DotMenu .DotItemName{direction:rtl}
`];var __decorate$b=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},__metadata$b=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)};let iL=class MgtDotOptions extends MgtBaseComponent{static get styles(){return nL}constructor(){super(),this._clickHandler=null,this._clickHandler=t=>this.open=!1}connectedCallback(){super.connectedCallback(),window.addEventListener("click",this._clickHandler)}disconnectedCallback(){window.removeEventListener("click",this._clickHandler),super.disconnectedCallback()}render(){return XI`
      <div tabindex="0" class=${IA({DotMenu:!0,Open:this.open})}
        @click=${t=>this.onDotClick(t)}
        @keydown=${t=>this.onDotKeydown(t)}>
        <span class="DotIcon">\uE712</span>
        <div tabindex="0" class="Menu">
          ${Object.keys(this.options).map((t=>this.getMenuOption(t,this.options[t])))}
        </div>
      </div>
    `}getMenuOption(t,o){return XI`
      <div
        class="DotItem"
        @click="${t=>{t.preventDefault(),t.stopPropagation(),o(t),this.open=!1}}"
        @keydown="${t=>{this.handleKeydownMenuOption,o(t),this.open=!1}}"
      >
        <span class="DotItemName">
          ${t}
        </span>
      </div>
    `}onDotClick(t){t.preventDefault(),t.stopPropagation(),this.open=!this.open}onDotKeydown(t){"Enter"===t.code&&(t.preventDefault(),t.stopPropagation(),this.open=!this.open)}handleKeydownMenuOption(t){"Enter"===t.code&&(t.preventDefault(),t.stopPropagation())}};__decorate$b([e$1({type:Boolean}),__metadata$b("design:type",Boolean)],iL.prototype,"open",void 0),__decorate$b([e$1({type:Object}),__metadata$b("design:type",Object)],iL.prototype,"options",void 0),iL=__decorate$b([customElement("dot-options"),__metadata$b("design:paramtypes",[])],iL);const sL={removeTaskSubtitle:"Delete Task",cancelNewTaskSubtitle:"Cancel",newTaskPlaceholder:"Adding task...",addTaskButtonSubtitle:"Add"};var aL,__decorate$a=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},__metadata$a=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)},__awaiter$e=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};exports.TasksSource=void 0,(aL=exports.TasksSource||(exports.TasksSource={}))[aL.planner=0]="planner",aL[aL.todo=1]="todo";const lL={BASE_SELF_ASSIGNED:"All Tasks",BUCKETS_SELF_ASSIGNED:"All Tasks",BUCKET_NOT_FOUND:"Folder not found",PLANS_SELF_ASSIGNED:"All groups",PLAN_NOT_FOUND:"Group not found"},cL={BASE_SELF_ASSIGNED:"Assigned to Me",BUCKETS_SELF_ASSIGNED:"All Tasks",BUCKET_NOT_FOUND:"Bucket not found",PLANS_SELF_ASSIGNED:"All Plans",PLAN_NOT_FOUND:"Plan not found"},dL={"@odata.type":"microsoft.graph.plannerAssignment",orderHint:"string !"};exports.MgtTasks=class MgtTasks extends MgtTemplatedComponent{get res(){switch(this.dataSource){case exports.TasksSource.todo:return lL;case exports.TasksSource.planner:default:return cL}}static get styles(){return tL}get strings(){return sL}get isNewTaskVisible(){return this._isNewTaskVisible}set isNewTaskVisible(t){this._isNewTaskVisible=t,t||(this._newTaskDueDate=null,this._newTaskName="",this._newTaskGroupId="")}static get requiredScopes(){return[...new Set(["group.read.all","group.readwrite.all","tasks.read","tasks.readwrite",...exports.MgtPeople.requiredScopes,...exports.MgtPeoplePicker.requiredScopes])]}constructor(){super(),this.dataSource=exports.TasksSource.planner,this._me=null,this.clearState(),this.previousMediaQuery=this.mediaQuery,this.onResize=this.onResize.bind(this)}connectedCallback(){super.connectedCallback(),window.addEventListener("resize",this.onResize)}disconnectedCallback(){window.removeEventListener("resize",this.onResize),super.disconnectedCallback()}attributeChangedCallback(t,o,s){super.attributeChangedCallback(t,o,s),"data-source"===t&&(this.dataSource===exports.TasksSource.planner?(this._currentGroup=this.initialId,this._currentFolder=this.initialBucketId):this.dataSource===exports.TasksSource.todo&&(this._currentGroup=null,this._currentFolder=this.initialId),this.clearState(),this.requestStateUpdate())}clearState(){this._newTaskFolderId="",this._newTaskGroupId="",this._newTaskDueDate=null,this._newTaskName="",this._newTaskBeingAdded=!1,this._tasks=[],this._folders=[],this._groups=[],this._hiddenTasks=[],this._loadingTasks=[],this._hasDoneInitialLoad=!1,this._inTaskLoad=!1,this._todoDefaultSet=!1}firstUpdated(t){super.firstUpdated(t),this.initialId&&!this._currentGroup&&(this.dataSource===exports.TasksSource.planner?this._currentGroup=this.initialId:this.dataSource===exports.TasksSource.todo&&(this._currentFolder=this.initialId)),this.dataSource===exports.TasksSource.planner&&this.initialBucketId&&!this._currentFolder&&(this._currentFolder=this.initialBucketId)}render(){let t=this._tasks.filter((t=>this.isTaskInSelectedGroupFilter(t))).filter((t=>this.isTaskInSelectedFolderFilter(t))).filter((t=>!this._hiddenTasks.includes(t.id)));this.taskFilter&&(t=t.filter((t=>this.taskFilter(t._raw))));const o=this._inTaskLoad&&!this._hasDoneInitialLoad?this.renderLoadingTask():null;let s;return this.hideHeader||(s=XI`
        <div class="Header" dir=${this.direction}>
          ${this.renderPlanOptions()}
        </div>
      `),XI`
      ${s}
      <div class="Tasks" dir=${this.direction}>
        ${this._isNewTaskVisible?this.renderNewTask():null} ${o}
        ${GA(t,(t=>t.id),(t=>this.renderTask(t)))}
      </div>
    `}loadState(){return __awaiter$e(this,void 0,void 0,(function*(){const t=this.getTaskSource();if(!t)return;const o=Providers.globalProvider;if(!o||o.state!==exports.ProviderState.SignedIn)return;let s;if(this._inTaskLoad=!0,!this._me){s=getMe(o.graph.forComponent(this))}this.groupId&&this.dataSource===exports.TasksSource.planner?yield this._loadTasksForGroup(t):this.targetId?this.dataSource===exports.TasksSource.todo?yield this._loadTargetTodoTasks(t):yield this._loadTargetPlannerTasks(t):yield this._loadAllTasks(t),s&&(this._me=yield s),this._inTaskLoad=!1,this._hasDoneInitialLoad=!0}))}onResize(){this.mediaQuery!==this.previousMediaQuery&&(this.previousMediaQuery=this.mediaQuery,this.requestUpdate())}_loadTargetTodoTasks(t){return __awaiter$e(this,void 0,void 0,(function*(){const o=yield t.getTaskGroups(),s=(yield Promise.all(o.map((o=>t.getTaskFoldersForTaskGroup(o.id))))).reduce(((t,o)=>[...t,...o]),[]),l=(yield Promise.all(s.map((o=>t.getTasksForTaskFolder(o.id,o.parentId))))).reduce(((t,o)=>[...t,...o]),[]);this._tasks=l,this._folders=s,this._groups=o,this._currentGroup=null}))}_loadTargetPlannerTasks(t){return __awaiter$e(this,void 0,void 0,(function*(){const o=yield t.getTaskGroup(this.targetId);let s=yield t.getTaskFoldersForTaskGroup(o.id);this.targetBucketId&&(s=s.filter((t=>t.id===this.targetBucketId)));const l=(yield Promise.all(s.map((o=>t.getTasksForTaskFolder(o.id,o.parentId))))).reduce(((t,o)=>[...t,...o]),[]);this._tasks=l,this._folders=s,this._groups=[o]}))}_loadAllTasks(t){return __awaiter$e(this,void 0,void 0,(function*(){const o=yield t.getTaskGroups(),s=(yield Promise.all(o.map((o=>t.getTaskFoldersForTaskGroup(o.id))))).reduce(((t,o)=>[...t,...o]),[]);if(!this.initialId&&this.dataSource===exports.TasksSource.todo&&!this._todoDefaultSet){this._todoDefaultSet=!0;const t=s.find((t=>t._raw.isDefaultFolder));t&&(this._currentFolder=t.id)}const l=(yield Promise.all(s.map((o=>t.getTasksForTaskFolder(o.id,o.parentId))))).reduce(((t,o)=>[...t,...o]),[]);this._tasks=l,this._folders=s,this._groups=o}))}_loadTasksForGroup(t){return __awaiter$e(this,void 0,void 0,(function*(){const o=yield t.getTaskGroupsForGroup(this.groupId),s=(yield Promise.all(o.map((o=>t.getTaskFoldersForTaskGroup(o.id))))).reduce(((t,o)=>[...t,...o]),[]),l=(yield Promise.all(s.map((o=>t.getTasksForTaskFolder(o.id,o.parentId))))).reduce(((t,o)=>[...t,...o]),[]);this._tasks=l,this._folders=s,this._groups=o}))}addTask(t,o,s,l,h={}){return __awaiter$e(this,void 0,void 0,(function*(){const v=this.getTaskSource();if(!v)return;const m={assignments:h,dueDate:o,immediateParentId:l,name:t,topParentId:s};this._newTaskBeingAdded=!0,m._raw=yield v.addTask(m),this.fireCustomEvent("taskAdded",m),yield this.requestStateUpdate(),this._newTaskBeingAdded=!1,this.isNewTaskVisible=!1}))}completeTask(t){return __awaiter$e(this,void 0,void 0,(function*(){const o=this.getTaskSource();o&&(this._loadingTasks=[...this._loadingTasks,t.id],yield o.setTaskComplete(t.id,t.eTag),this.fireCustomEvent("taskChanged",t),yield this.requestStateUpdate(),this._loadingTasks=this._loadingTasks.filter((o=>o!==t.id)))}))}uncompleteTask(t){return __awaiter$e(this,void 0,void 0,(function*(){const o=this.getTaskSource();o&&(this._loadingTasks=[...this._loadingTasks,t.id],yield o.setTaskIncomplete(t.id,t.eTag),this.fireCustomEvent("taskChanged",t),yield this.requestStateUpdate(),this._loadingTasks=this._loadingTasks.filter((o=>o!==t.id)))}))}removeTask(t){return __awaiter$e(this,void 0,void 0,(function*(){const o=this.getTaskSource();o&&(this._hiddenTasks=[...this._hiddenTasks,t.id],yield o.removeTask(t.id,t.eTag),this.fireCustomEvent("taskRemoved",t),yield this.requestStateUpdate(),this._hiddenTasks=this._hiddenTasks.filter((o=>o!==t.id)))}))}assignPeople(t,o){return __awaiter$e(this,void 0,void 0,(function*(){const s=this.getTaskSource();if(!s)return;let l=[];t&&t.assignments&&(l=Object.keys(t.assignments).sort());const h=o.map((t=>t.id)),v=h.length===l.length&&h.sort().every(((t,o)=>t===l[o]));if(v)return;const m={};if(0===o.length)for(let t=0;t<l.length;t++)m[l[t]]=null;if(o){for(let t=0;t<l.length;t++)for(let s=0;s<o.length;s++){if(l[t]!==o[s].id){m[l[t]]=null;break}m[l[t]]=dL}for(let t=0;t<o.length;t++)m[o[t].id]=dL}t&&(this._loadingTasks=[...this._loadingTasks,t.id],yield s.assignPeopleToTask(t.id,m,t.eTag),yield this.requestStateUpdate(),this._loadingTasks=this._loadingTasks.filter((o=>o!==t.id)))}))}onAddTaskClick(t){const o=this.getPeoplePicker(null),s={};if(o)for(const t of o.selectedPeople)o.selectedPeople.length&&(s[t.id]=dL);!this._newTaskBeingAdded&&this._newTaskName&&(this._currentGroup||this._newTaskGroupId)&&this.addTask(this._newTaskName,this._newTaskDueDate,this._currentGroup?this._currentGroup:this._newTaskGroupId,this._currentFolder?this._currentFolder:this._newTaskFolderId,s)}onAddTaskKeyDown(t){"Enter"===t.code&&this.onAddTaskClick}newTaskButtonKeydown(t){"Enter"===t.code&&(this.isNewTaskVisible=!this.isNewTaskVisible)}newTaskVisible(t){"Enter"===t.code&&(this.isNewTaskVisible=!1)}renderPlanOptions(){const t=Providers.globalProvider;if(!t||t.state!==exports.ProviderState.SignedIn)return null;if(this._inTaskLoad&&!this._hasDoneInitialLoad)return XI`
        <span class="LoadingHeader"></span>
      `;const o=this.readOnly||this._isNewTaskVisible?null:XI`
            <div
              tabindex="0"
              class="AddBarItem NewTaskButton"
              @click="${()=>{this.isNewTaskVisible=!this.isNewTaskVisible}}"
              @keydown="${this.newTaskButtonKeydown}"
            >
              <span class="TaskIcon">î</span>
              <span>${this.strings.addTaskButtonSubtitle}</span>
            </div>
          `;if(this.dataSource===exports.TasksSource.planner){const t=this._groups.find((t=>t.id===this._currentGroup))||{title:this.res.BASE_SELF_ASSIGNED},s={[this.res.BASE_SELF_ASSIGNED]:t=>{this._currentGroup=null,this._currentFolder=null}};for(const t of this._groups)s[t.title]=o=>{this._currentGroup=t.id,this._currentFolder=null};const l=mgtHtml`
        <mgt-arrow-options class="arrow-options" .options="${s}" .value="${t.title}"></mgt-arrow-options>
      `,h=this._currentGroup?XI`
            <span class="TaskIcon Divider">/</span>
          `:null,v=this._folders.find((t=>t.id===this._currentFolder))||{name:this.res.BUCKETS_SELF_ASSIGNED},m={[this.res.BUCKETS_SELF_ASSIGNED]:t=>{this._currentFolder=null}};for(const t of this._folders.filter((t=>t.parentId===this._currentGroup)))m[t.name]=o=>{this._currentFolder=t.id};const _=this.targetBucketId?XI`
            <span class="PlanTitle">
              ${this._folders[0]&&this._folders[0].name}
            </span>
          `:mgtHtml`
            <mgt-arrow-options class="arrow-options" .options="${m}" .value="${v.name}"></mgt-arrow-options>
          `;return XI`
        <div class="TitleCont">
          ${l} ${h} ${this._currentGroup?_:null}
        </div>
        ${o}
      `}{const t=this._folders.find((t=>t.id===this.targetId))||{name:this.res.BUCKETS_SELF_ASSIGNED},s=this._folders.find((t=>t.id===this._currentFolder))||{name:this.res.BUCKETS_SELF_ASSIGNED},l={};for(const t of this._folders)l[t.name]=()=>{this._currentFolder=t.id};l[this.res.BUCKETS_SELF_ASSIGNED]=t=>{this._currentFolder=null};const h=this.targetId?XI`
            <span class="PlanTitle">
              ${t.name}
            </span>
          `:mgtHtml`
            <mgt-arrow-options class="arrow-options" .value="${s.name}" .options="${l}"></mgt-arrow-options>
          `;return XI`
        <span class="TitleCont">
          ${h}
        </span>
        ${o}
      `}}renderNewTask(){const t=XI`
      <input
        type="text"
        placeholder=${this.strings.newTaskPlaceholder}
        .value="${this._newTaskName}"
        label="new-taskName-input"
        aria-label="new-taskName-input"
        role="textbox"
        @input="${t=>{this._newTaskName=t.target.value}}"
      />
    `,o=this._groups;o.length>0&&!this._newTaskGroupId&&(this._newTaskGroupId=o[0].id);const s=this.dataSource===exports.TasksSource.todo?null:this._currentGroup?XI`
            <span class="NewTaskGroup">
              ${this.renderPlannerIcon()}
              <span>${this.getPlanTitle(this._currentGroup)}</span>
            </span>
          `:XI`
            <span class="NewTaskGroup">
              ${this.renderPlannerIcon()}
              <select aria-label="new task group"
                .value="${this._newTaskGroupId}"
                @change="${t=>{this._newTaskGroupId=t.target.value}}"
              >
                ${this._groups.map((t=>XI`
                    <option value="${t.id}">${t.title}</option>
                  `))}
              </select>
            </span>
          `,l=this._folders.filter((t=>this._currentGroup&&t.parentId===this._currentGroup||!this._currentGroup&&t.parentId===this._newTaskGroupId));l.length>0&&!this._newTaskFolderId&&(this._newTaskFolderId=l[0].id);const h=this._currentFolder?XI`
          <span class="NewTaskBucket">
            ${this.renderBucketIcon()}
            <span>${this.getFolderName(this._currentFolder)}</span>
          </span>
        `:XI`
          <span class="NewTaskBucket">
            ${this.renderBucketIcon()}
            <select aria-label="new task bucket"
              .value="${this._newTaskFolderId}"
              @change="${t=>{this._newTaskFolderId=t.target.value}}"
            >
              ${l.map((t=>XI`
                  <option value="${t.id}">${t.name}</option>
                `))}
            </select>
          </span>
        `,v=XI`
      <span class="NewTaskDue">
      ${this.renderCalendarIcon()}
        <input
          type="date"
          label="new-taskDate-input"
          aria-label="new-taskDate-input"
          role="textbox"
          .value="${this.dateToInputValue(this._newTaskDueDate)}"
          @change="${t=>{const o=t.target.value;this._newTaskDueDate=o?new Date(o+"T17:00"):null}}"
        />
      </span>
    `,m=this.dataSource===exports.TasksSource.todo?null:this.renderAssignedPeople(null),_=this._newTaskBeingAdded?XI`
          <div class="TaskAddButtonContainer"></div>
        `:XI`
          <div class="TaskAddButtonContainer ${""===this._newTaskName?"Disabled":""}">
            <div tabindex="0" class="TaskIcon TaskAdd"
              @click="${this.onAddTaskClick}"
              @keydown="${this.onAddTaskKeyDown}">
              <span>${this.strings.addTaskButtonSubtitle}</span>
            </div>
            <div tabindex="0" class="TaskIcon TaskCancel"
              @click="${()=>this.isNewTaskVisible=!1}"
              @keydown="${this.newTaskVisible}">
              <span>${this.strings.cancelNewTaskSubtitle}</span>
            </div>
          </div>
        `;return XI`
      <div class="Task NewTask Incomplete">
        <div class="TaskContent">
          <div class="TaskDetailsContainer">
            <div class="TaskTitle">
              ${t}
            </div>
            <div class="TaskDetails">
              ${s} ${h} ${v} ${m}
            </div>
          </div>
        </div>
        ${_}
      </div>
    `}togglePeoplePicker(t){const o=this.getPeoplePicker(t),s=this.getMgtPeople(t),l=this.getFlyout(t);o&&s&&l&&(l.isOpen?l.close():(o.selectedPeople=s.people,l.open(),window.requestAnimationFrame((()=>{o.focus()}))))}updateAssignedPeople(t){const o=this.getPeoplePicker(t),s=this.getMgtPeople(t);o&&o.selectedPeople!==s.people&&(s.people=o.selectedPeople,this.assignPeople(t,o.selectedPeople))}getPeoplePicker(t){const o=t?t.id:"newTask";return this.renderRoot.querySelector(`.picker-${o}`)}getMgtPeople(t){const o=t?t.id:"newTask";return this.renderRoot.querySelector(`.people-${o}`)}getFlyout(t){const o=t?t.id:"newTask";return this.renderRoot.querySelector(`.flyout-${o}`)}renderTask(t){const{name:o="Task",completed:s=!1,dueDate:l}=t,h=this._loadingTasks.includes(t.id),v=h?XI`
          ïª
        `:s?XI`
          î¾
        `:null,m=XI`
      <span tabindex="0" class=${IA({Complete:!h&&s,Loading:h,TaskCheck:!0,TaskIcon:!0})}><span class="TaskCheckContent">${v}</span></span>
    `,_=this._currentGroup?null:this.getPlanTitle(t.topParentId),R=this._currentFolder?null:this.getFolderName(t.immediateParentId),$={task:Object.assign(Object.assign({},t._raw),{groupTitle:_,folderTitle:R})},B=this.renderTemplate("task",$,t.id);if(B)return B;let q=this.renderTemplate("task-details",$,`task-details-${t.id}`);if(!q){const s=this.dataSource===exports.TasksSource.todo||this._currentGroup?null:XI`
              <div class="TaskDetail TaskGroup">
                ${this.renderPlannerIcon()}
                <span>${this.getPlanTitle(t.topParentId)}</span>
              </div>
            `,h=this._currentFolder?null:XI`
            <div class="TaskDetail TaskBucket">
              ${this.renderBucketIcon()}
              <span>${this.getFolderName(t.immediateParentId)}</span>
            </div>
          `,v=l?XI`
            <div class="TaskDetail TaskDue">
              <span>Due ${getShortDateString(l)}</span>
            </div>
          `:null,m=this.dataSource!==exports.TasksSource.todo?this.renderAssignedPeople(t):null;q=XI`
        <div class="TaskTitle">
          ${o}
        </div>
        ${s} ${h} ${m} ${v}
      `}const j=this.readOnly||this.hideOptions?null:mgtHtml`
            <div class="TaskOptions">
              <mgt-dot-options
                class="dot-options"
                .options="${{[this.strings.removeTaskSubtitle]:()=>this.removeTask(t)}}"
              ></mgt-dot-options>
            </div>
          `;return XI`
      <div
        class=${IA({Complete:s,Incomplete:!s,ReadOnly:this.readOnly,Task:!0})}
      >
        <div
          class="TaskContent"
          @click=${()=>{this.handleTaskClick(t)}}
        >
          <span
            class=${IA({Complete:s,Incomplete:!s,TaskCheckContainer:!0})}
            @click="${o=>{this.readOnly||(t.completed?this.uncompleteTask(t):this.completeTask(t),o.stopPropagation(),o.preventDefault())}}"
            @keydown="${o=>{"Enter"===o.code&&(this.readOnly||(t.completed?this.uncompleteTask(t):this.completeTask(t),o.stopPropagation(),o.preventDefault()))}}"
          >
            ${m}
          </span>
          <div class="TaskDetailsContainer ${this.mediaQuery} ${this._currentGroup?"NoPlan":""}">
            ${q}
          </div>
          ${j}

        </div>
      </div>
    `}renderAssignedPeople(t){let o=null;const s={NewTaskAssignee:null===t,TaskAssignee:null!==t,TaskDetail:null!==t},l=t?Object.keys(t.assignments).map((t=>t)):[],h=XI`
      <template data-type="no-data">
        <i class="login-icon ms-Icon ms-Icon--Contact"></i>
      </template>
    `,v=t?t.id:"newTask";s[`flyout-${v}`]=!0,o=mgtHtml`
      <mgt-people
        class="people people-${v}"
        .userIds="${l}"
        .personCardInteraction=${exports.PersonCardInteraction.none}
        @click=${o=>{this.togglePeoplePicker(t),o.stopPropagation()}}
        @keydown=${o=>{"Enter"===o.code&&(this.togglePeoplePicker(t),o.stopPropagation())}}
        >${h}
      </mgt-people>
    `;const m=mgtHtml`
      <mgt-people-picker
        class="people-picker picker-${v}"
        @click=${t=>t.stopPropagation()}
        @keydown=${t=>{"Enter"===t.code&&t.stopPropagation()}}
      ></mgt-people-picker>
    `;return mgtHtml`
      <mgt-flyout light-dismiss class=${IA(s)} @closed=${o=>this.updateAssignedPeople(t)}>
        ${o}
        <div slot="flyout" class=${IA({Picker:!0})}>
          ${m}
        </div>
      </mgt-flyout>
    `}handleTaskClick(t){t&&this.fireCustomEvent("taskClick",t)}renderLoadingTask(){return XI`
      <div class="Task LoadingTask">
        <div class="TaskContent">
          <div class="TaskCheckContainer">
            <div class="TaskCheck"></div>
          </div>
          <div class="TaskDetailsContainer">
            <div class="TaskTitle"></div>
            <div class="TaskDetails">
              <span class="TaskDetail">
                <div class="TaskDetailIcon"></div>
                <div class="TaskDetailName"></div>
              </span>
              <span class="TaskDetail">
                <div class="TaskDetailIcon"></div>
                <div class="TaskDetailName"></div>
              </span>
            </div>
          </div>
        </div>
      </div>
    `}renderPlannerIcon(){return XI`
      <svg width="16" height="18" viewBox="0 0 16 18" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M7.223 1.156C6.98 1.26 6.769 1.404 6.586 1.586C6.403 1.768 6.261 1.98 6.157 2.223C6.052 2.465 6 2.724 6 3H2V17H14V3H10C10 2.724 9.948 2.465 9.844 2.223C9.74 1.98 9.596 1.768 9.414 1.586C9.231 1.404 9.02 1.26 8.777 1.156C8.535 1.053 8.276 1 8 1C7.723 1 7.465 1.053 7.223 1.156ZM5 4H7V3C7 2.86 7.026 2.729 7.078 2.609C7.13 2.49 7.202 2.385 7.293 2.293C7.384 2.202 7.49 2.131 7.609 2.079C7.73 2.026 7.859 2 8 2C8.14 2 8.271 2.026 8.39 2.079C8.511 2.131 8.616 2.202 8.707 2.293C8.798 2.385 8.87 2.49 8.922 2.609C8.974 2.729 9 2.86 9 3V4H11V5H5V4ZM12 6V4H13V16H3V4H4V6H12Z"
          fill="#3C3C3C"
        />
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M7.35156 12.3517L5.49956 14.2037L4.14856 12.8517L4.85156 12.1487L5.49956 12.7967L6.64856 11.6487L7.35156 12.3517Z"
          fill="#3C3C3C"
        />
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M7.35156 8.35168L5.49956 10.2037L4.14856 8.85168L4.85156 8.14868L5.49956 8.79668L6.64856 7.64868L7.35156 8.35168Z"
          fill="#3C3C3C"
        />
        <path fill-rule="evenodd" clip-rule="evenodd" d="M8 14H12.001V13H8V14Z" fill="#3C3C3C" />
        <path fill-rule="evenodd" clip-rule="evenodd" d="M8 10H12.001V9H8V10Z" fill="#3C3C3C" />
      </svg>
    `}renderBucketIcon(){return XI`
      <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M14 2H2V4H3H5H6H10H11H13H14V2ZM10 5H6V6H10V5ZM5 5H3V14H13V5H11V6C11 6.55228 10.5523 7 10 7H6C5.44772 7 5 6.55228 5 6V5ZM1 5H2V14V15H3H13H14V14V5H15V4V2V1H14H2H1V2V4V5Z"
          fill="#3C3C3C"
        />
      </svg>
    `}renderCalendarIcon(){return XI`
          <svg width="16" height="20" viewBox="0 0 16 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M5 11C5.55228 11 6 10.5523 6 10C6 9.44771 5.55228 9 5 9C4.44772 9 4 9.44771 4 10C4 10.5523 4.44772 11 5 11ZM6 13C6 13.5523 5.55228 14 5 14C4.44772 14 4 13.5523 4 13C4 12.4477 4.44772 12 5 12C5.55228 12 6 12.4477 6 13ZM8 11C8.55229 11 9 10.5523 9 10C9 9.44771 8.55229 9 8 9C7.44771 9 7 9.44771 7 10C7 10.5523 7.44771 11 8 11ZM9 13C9 13.5523 8.55229 14 8 14C7.44771 14 7 13.5523 7 13C7 12.4477 7.44771 12 8 12C8.55229 12 9 12.4477 9 13ZM11 11C11.5523 11 12 10.5523 12 10C12 9.44771 11.5523 9 11 9C10.4477 9 10 9.44771 10 10C10 10.5523 10.4477 11 11 11ZM15 5.5C15 4.11929 13.8807 3 12.5 3H3.5C2.11929 3 1 4.11929 1 5.5V14.5C1 15.8807 2.11929 17 3.5 17H12.5C13.8807 17 15 15.8807 15 14.5V5.5ZM2 7H14V14.5C14 15.3284 13.3284 16 12.5 16H3.5C2.67157 16 2 15.3284 2 14.5V7ZM3.5 4H12.5C13.3284 4 14 4.67157 14 5.5V6H2V5.5C2 4.67157 2.67157 4 3.5 4Z" fill="#717171"/>
          </svg>
        `}getTaskSource(){const t=Providers.globalProvider;if(!t||t.state!==exports.ProviderState.SignedIn)return null;const o=t.graph.forComponent(this);return this.dataSource===exports.TasksSource.planner?new PlannerTaskSource(o):this.dataSource===exports.TasksSource.todo?new TodoTaskSource(o):null}getPlanTitle(t){return t?t===this.res.PLANS_SELF_ASSIGNED?this.res.PLANS_SELF_ASSIGNED:(this._groups.find((o=>o.id===t))||{title:this.res.PLAN_NOT_FOUND}).title:this.res.BASE_SELF_ASSIGNED}getFolderName(t){return t?(this._folders.find((o=>o.id===t))||{name:this.res.BUCKET_NOT_FOUND}).name:this.res.BUCKETS_SELF_ASSIGNED}isTaskInSelectedGroupFilter(t){return t.topParentId===this._currentGroup||!this._currentGroup&&this.getTaskSource().isAssignedToMe(t,this._me.id)}isTaskInSelectedFolderFilter(t){return t.immediateParentId===this._currentFolder||!this._currentFolder}dateToInputValue(t){return t?new Date(t.getTime()-6e4*t.getTimezoneOffset()).toISOString().split("T")[0]:null}},__decorate$a([e$1({attribute:"read-only",type:Boolean}),__metadata$a("design:type",Boolean)],exports.MgtTasks.prototype,"readOnly",void 0),__decorate$a([e$1({attribute:"data-source",converter:(t,o)=>(t=t.toLowerCase(),exports.TasksSource[t]||exports.TasksSource.planner)}),__metadata$a("design:type",Number)],exports.MgtTasks.prototype,"dataSource",void 0),__decorate$a([e$1({attribute:"target-id",type:String}),__metadata$a("design:type",String)],exports.MgtTasks.prototype,"targetId",void 0),__decorate$a([e$1({attribute:"target-bucket-id",type:String}),__metadata$a("design:type",String)],exports.MgtTasks.prototype,"targetBucketId",void 0),__decorate$a([e$1({attribute:"initial-id",type:String}),__metadata$a("design:type",String)],exports.MgtTasks.prototype,"initialId",void 0),__decorate$a([e$1({attribute:"initial-bucket-id",type:String}),__metadata$a("design:type",String)],exports.MgtTasks.prototype,"initialBucketId",void 0),__decorate$a([e$1({attribute:"hide-header",type:Boolean}),__metadata$a("design:type",Boolean)],exports.MgtTasks.prototype,"hideHeader",void 0),__decorate$a([e$1({attribute:"hide-options",type:Boolean}),__metadata$a("design:type",Boolean)],exports.MgtTasks.prototype,"hideOptions",void 0),__decorate$a([e$1({attribute:"group-id",type:String}),__metadata$a("design:type",String)],exports.MgtTasks.prototype,"groupId",void 0),__decorate$a([e$1(),__metadata$a("design:type",Boolean)],exports.MgtTasks.prototype,"_isNewTaskVisible",void 0),__decorate$a([e$1(),__metadata$a("design:type",Boolean)],exports.MgtTasks.prototype,"_newTaskBeingAdded",void 0),__decorate$a([e$1(),__metadata$a("design:type",String)],exports.MgtTasks.prototype,"_newTaskName",void 0),__decorate$a([e$1(),__metadata$a("design:type",Date)],exports.MgtTasks.prototype,"_newTaskDueDate",void 0),__decorate$a([e$1(),__metadata$a("design:type",String)],exports.MgtTasks.prototype,"_newTaskGroupId",void 0),__decorate$a([e$1(),__metadata$a("design:type",String)],exports.MgtTasks.prototype,"_newTaskFolderId",void 0),__decorate$a([e$1(),__metadata$a("design:type",Array)],exports.MgtTasks.prototype,"_groups",void 0),__decorate$a([e$1(),__metadata$a("design:type",Array)],exports.MgtTasks.prototype,"_folders",void 0),__decorate$a([e$1(),__metadata$a("design:type",Array)],exports.MgtTasks.prototype,"_tasks",void 0),__decorate$a([e$1(),__metadata$a("design:type",Array)],exports.MgtTasks.prototype,"_hiddenTasks",void 0),__decorate$a([e$1(),__metadata$a("design:type",Array)],exports.MgtTasks.prototype,"_loadingTasks",void 0),__decorate$a([e$1(),__metadata$a("design:type",Boolean)],exports.MgtTasks.prototype,"_inTaskLoad",void 0),__decorate$a([e$1(),__metadata$a("design:type",Boolean)],exports.MgtTasks.prototype,"_hasDoneInitialLoad",void 0),__decorate$a([e$1(),__metadata$a("design:type",Boolean)],exports.MgtTasks.prototype,"_todoDefaultSet",void 0),__decorate$a([e$1(),__metadata$a("design:type",String)],exports.MgtTasks.prototype,"_currentGroup",void 0),__decorate$a([e$1(),__metadata$a("design:type",String)],exports.MgtTasks.prototype,"_currentFolder",void 0),exports.MgtTasks=__decorate$a([customElement("tasks"),__metadata$a("design:paramtypes",[])],exports.MgtTasks);const uL=[i$4`
:host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\e70d"}.ms-Icon--ChevronUp::before{content:"\\\e70e"}.ms-Icon--Contact::before{content:"\\\e77b"}.ms-Icon--AddFriend::before{content:"\\\e8fa"}.ms-Icon--OutlookLogoInverse::before{content:"\\\eb6d"}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--dropdown-item-selected-background:#deecf9;--arrow-fill:#000000}.mgt-dark{--dropdown-item-selected-background:#333d47;--arrow-fill:#605e5c}:host,:host mgt-teams-channel-picker{font-family:var(--default-font-family)}:host .container,:host mgt-teams-channel-picker .container{display:flex;flex-direction:column}:host .dropdown,:host mgt-teams-channel-picker .dropdown{z-index:1;display:none;margin-top:4px}:host .dropdown.visible,:host mgt-teams-channel-picker .dropdown.visible{display:flex}:host .dropdown .team-photo,:host mgt-teams-channel-picker .dropdown .team-photo{width:24px;position:inherit;border-radius:50%;margin:0 6px}:host .dropdown .team-start-slot,:host mgt-teams-channel-picker .dropdown .team-start-slot{width:max-content}:host .dropdown .team-parent-name,:host mgt-teams-channel-picker .dropdown .team-parent-name{width:auto}:host .loading-text,:host .search-error-text,:host mgt-teams-channel-picker .loading-text,:host mgt-teams-channel-picker .search-error-text{font-family:var(--default-font-family);font-style:normal;font-weight:400;font-size:14px;line-height:20px}:host .message-parent,:host mgt-teams-channel-picker .message-parent{display:flex;flex-direction:row;gap:5px;padding:5px}:host .message-parent .loading-text,:host mgt-teams-channel-picker .message-parent .loading-text{color:var(--color,#0078d4);margin:auto}:host fluent-card{--fill-color:var(--dropdown-background-color, --fill-color);--card-height:auto;--width:var(--card-width)}:host fluent-text-field{width:100%;--fill-color:var(--color, $color);--neutral-fill-input-rest:var(--input-background-color, #ffffff);--input-placeholder-rest:var(--placeholder-color, --input-placeholder-rest);--input-placeholder-hover:var(--placeholder-color--focus, --input-placeholder-hover)}:host fluent-tree-view{--tree-item-nested-width:2em}:host fluent-tree-item{--tree-item-nested-width:2em;--neutral-foreground-rest:var(--color, $color);--neutral-fill-stealth-hover:var(--dropdown-item-hover-background, --neutral-fill-stealth-hover);--neutral-fill-secondary-rest:var(--dropdown-item-selected-background, --neutral-fill-secondary-rest);--neutral-fill-stealth-rest:var(--dropdown-background-color, --neutral-fill-stealth-rest)}:host fluent-tree-view{min-width:100%}:host fluent-breadcrumb-item .team-parent-name{font-weight:700}:host fluent-breadcrumb-item .team-photo{width:19px;position:inherit;border-radius:50%}:host fluent-breadcrumb-item .arrow{margin-left:8px;margin-right:8px}:host fluent-breadcrumb-item .arrow svg{stroke:var(--arrow-fill,var(--color-sub1,var(--neutral-foreground-rest,#1a1a1a)))}[dir=rtl] :host{--direction:rtl}[dir=rtl] .dropdown{text-align:right}[dir=rtl] .arrow{-moz-transform:scaleX(-1);-o-transform:scaleX(-1);-webkit-transform:scaleX(-1);transform:scaleX(-1);filter:FlipH;-ms-filter:FlipH;margin-right:0;margin-left:5px}[dir=rtl] .selected-team{padding-left:10px}[dir=rtl] .message-parent .loading-text{right:auto;left:10px;padding-right:8px;text-align:right}@media (forced-colors:active) and (prefers-color-scheme:dark){:host fluent-text-field svg{stroke:#fff!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host fluent-text-field svg{stroke:#000!important}}
`];var __awaiter$d=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};const hL={inputPlaceholderText:"Select a channel",noResultsFound:"We didn't find any matches.",loadingMessage:"Loading..."};var pL,__decorate$9=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},__metadata$9=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)},__awaiter$c=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};registerFluentComponents(KM,WM,XM,mD,kD,gD),exports.MgtTeamsChannelPicker=pL=class MgtTeamsChannelPicker extends MgtTemplatedComponent{static get styles(){return uL}get strings(){return hL}static get config(){return this._config}get selectedItem(){return this._selectedItemState?{channel:this._selectedItemState.item,team:this._selectedItemState.parent.item}:null}static get requiredScopes(){return this.config.useTeamsBasedScopes?["team.readbasic.all","channel.readbasic.all"]:["user.read.all","group.read.all"]}set items(t){this._items!==t&&(this._items=t,this._treeViewState=t?this.generateTreeViewState(t):[],this.resetFocusState())}get items(){return this._items}get _input(){return this.renderRoot.querySelector("fluent-text-field").shadowRoot.querySelector("input")}constructor(){super(),this.teamsPhotos={},this._inputValue="",this._treeViewState=[],this._focusList=[],this.handleWindowClick=this.handleWindowClick.bind(this),this.addEventListener("focus",(t=>this.loadTeamsIfNotLoaded())),this.addEventListener("mouseover",(t=>this.loadTeamsIfNotLoaded())),this.addEventListener("blur",(t=>this.lostFocus())),this.clearState()}connectedCallback(){super.connectedCallback(),window.addEventListener("click",this.handleWindowClick);const t=this.renderRoot.ownerDocument;t&&t.documentElement.setAttribute("dir",this.direction)}disconnectedCallback(){window.removeEventListener("click",this.handleWindowClick),super.disconnectedCallback()}selectChannelById(t){return __awaiter$c(this,void 0,void 0,(function*(){const o=Providers.globalProvider;if(o&&o.state===exports.ProviderState.SignedIn){this.items||(yield this.requestStateUpdate());for(const o of this._treeViewState)for(const s of o.channels)if(s.item.id===t)return o.isExpanded=!0,this.selectChannel(s),this.markSelectedChannelInDropdown(t),!0}return!1}))}markSelectedChannelInDropdown(t){const o=this.renderRoot.querySelector(`[id='${t}']`);o&&(o.setAttribute("selected","true"),o.parentElement&&o.parentElement.setAttribute("expanded","true"))}render(){const t={dropdown:!0,visible:this._isDropdownVisible};return this.renderTemplate("default",{teams:this.items})||XI`
        <div class="container" @blur=${this.lostFocus}>
          <fluent-text-field
            appearance="outline"
            id="teams-channel-picker-input"
            aria-label="Select a channel"
            placeholder="${this._selectedItemState?"":this.strings.inputPlaceholderText} "
            label="teams-channel-picker-input"
            @click=${this.gainedFocus}
            @keyup=${t=>this.handleInputChanged(t)}>
              <div slot="start" style="width: max-content;">${this.renderSelected()}</div>
              <div slot="end">${this.renderChevrons()}${this.renderCloseButton()}</div>
          </fluent-text-field>
          <fluent-card class=${IA(t)}>
            ${this.renderDropdown()}
          </fluent-card>
        </div>`}renderSelected(){var t,o,s,l,h,v;if(!this._selectedItemState)return this.renderSearchIcon();let m;this._selectedItemState.parent.channels&&(m=XI`<img
        class="team-photo"
        alt="${this._selectedItemState.parent.item.displayName}"
        src=${null===(t=this.teamsPhotos[this._selectedItemState.parent.item.id])||void 0===t?void 0:t.photo} />`);const _=null===(l=null===(s=null===(o=this._selectedItemState)||void 0===o?void 0:o.parent)||void 0===s?void 0:s.item)||void 0===l?void 0:l.displayName.trim(),R=null===(v=null===(h=this._selectedItemState)||void 0===h?void 0:h.item)||void 0===v?void 0:v.displayName.trim();return XI`
      <fluent-breadcrumb title=${this._selectedItemState.item.displayName}>
        <fluent-breadcrumb-item>
          <span slot="start">${m}</span>
          <span class="team-parent-name">${_}</span>
          <span slot="separator" class="arrow">${getSvg($A.TeamSeparator,"#000000")}</span>
        </fluent-breadcrumb-item>
        <fluent-breadcrumb-item>${R}</fluent-breadcrumb-item>
      </fluent-breadcrumb>`}clearState(){this._items=[],this._inputValue="",this._treeViewState=[],this._focusList=[],this._isDropdownVisible=!1}renderSearchIcon(){return XI`
      <div class="search-icon">
        ${getSvg($A.Search,"#252424")}
      </div>
    `}renderCloseButton(){return XI`
      <div
        class="close-icon"
        style="display:none"
        @click="${()=>this.removeSelectedChannel(null)}">
        <svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M0.0885911 0.215694L0.146447 0.146447C0.320013 -0.0271197 0.589437 -0.046405 0.784306 0.0885911L0.853553 0.146447L4 3.293L7.14645 0.146447C7.34171 -0.0488154 7.65829 -0.0488154 7.85355 0.146447C8.04882 0.341709 8.04882 0.658291 7.85355 0.853553L4.707 4L7.85355 7.14645C8.02712 7.32001 8.0464 7.58944 7.91141 7.78431L7.85355 7.85355C7.67999 8.02712 7.41056 8.0464 7.21569 7.91141L7.14645 7.85355L4 4.707L0.853553 7.85355C0.658291 8.04882 0.341709 8.04882 0.146447 7.85355C-0.0488154 7.65829 -0.0488154 7.34171 0.146447 7.14645L3.293 4L0.146447 0.853553C-0.0271197 0.679987 -0.046405 0.410563 0.0885911 0.215694L0.146447 0.146447L0.0885911 0.215694Z" fill="#212121"/>
        </svg>
      </div>
    `}showCloseIcon(){const t=this.renderRoot.querySelector(".down-chevron"),o=this.renderRoot.querySelector(".up-chevron"),s=this.renderRoot.querySelector(".close-icon");t&&(t.style.display="none"),o&&(o.style.display="none"),s&&(s.style.display=null)}renderDownChevron(){return XI`
      <div class="down-chevron" @click=${this.gainedFocus}>
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M2.21967 4.46967C2.51256 4.17678 2.98744 4.17678 3.28033 4.46967L6 7.18934L8.71967 4.46967C9.01256 4.17678 9.48744 4.17678 9.78033 4.46967C10.0732 4.76256 10.0732 5.23744 9.78033 5.53033L6.53033 8.78033C6.23744 9.07322 5.76256 9.07322 5.46967 8.78033L2.21967 5.53033C1.92678 5.23744 1.92678 4.76256 2.21967 4.46967Z" fill="#212121" />
        </svg>
      </div>`}renderUpChevron(){return XI`
      <div style="display:none" class="up-chevron" @click=${t=>this.handleUpChevronClick(t)}>
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M2.21967 7.53033C2.51256 7.82322 2.98744 7.82322 3.28033 7.53033L6 4.81066L8.71967 7.53033C9.01256 7.82322 9.48744 7.82322 9.78033 7.53033C10.0732 7.23744 10.0732 6.76256 9.78033 6.46967L6.53033 3.21967C6.23744 2.92678 5.76256 2.92678 5.46967 3.21967L2.21967 6.46967C1.92678 6.76256 1.92678 7.23744 2.21967 7.53033Z" fill="#212121" />
        </svg>
      </div>`}renderChevrons(){return XI`${this.renderUpChevron()}${this.renderDownChevron()}`}renderDropdown(){return this.isLoadingState||!this._treeViewState?this.renderLoading():this._treeViewState?!this.isLoadingState&&0===this._treeViewState.length&&this._inputValue.length>0?this.renderError():this.renderDropdownList(this._treeViewState):XI``}renderDropdownList(t){if(t&&t.length>0){let o=null;return XI`
        <fluent-tree-view
          class="tree-view"
          dir=${this.direction}>
          ${GA(t,(t=>null==t?void 0:t.item),(t=>(t.channels&&(o=XI`<img
                  class="team-photo"
                  alt="${t.item.displayName}"
                  src=${this.teamsPhotos[t.item.id].photo} />`),XI`
                <fluent-tree-item
                  ?expanded=${null==t?void 0:t.isExpanded}
                  @click=${t=>this.handleTeamTreeItemClick(t)}>
                    ${o}${t.item.displayName}
                    ${GA(null==t?void 0:t.channels,(t=>t.item),(t=>this.renderItem(t)))}
                </fluent-tree-item>`)))}
        </fluent-tree-view>`}return null}renderItem(t){var o;return XI`
      <fluent-tree-item
        id=${null===(o=null==t?void 0:t.item)||void 0===o?void 0:o.id}
        @keydown=${o=>this.onUserKeyDown(o,t)}
        @click=${()=>this.handleItemClick(t)}>
          ${null==t?void 0:t.item.displayName}
      </fluent-tree-item>`}renderError(){return this.renderTemplate("error",null,"error")||XI`
        <div class="message-parent">
          <div
            label="search-error-text"
            aria-label="We didn't find any matches."
            class="search-error-text">
            ${this.strings.noResultsFound}
          </div>
        </div>
      `}renderLoading(){return this.renderTemplate("loading",null,"loading")||mgtHtml`
        <div class="message-parent">
          <mgt-spinner></mgt-spinner>
          <div label="loading-text" aria-label="loading" class="loading-text">
            ${this.strings.loadingMessage}
          </div>
        </div>
      `}loadState(){return __awaiter$c(this,void 0,void 0,(function*(){const t=Providers.globalProvider;let o;if(t&&t.state===exports.ProviderState.SignedIn){const s=t.graph.forComponent(this);if(!(yield t.getAccessTokenForScopes(...pL.requiredScopes)))return;o=yield function getAllMyTeams(t){return __awaiter$d(this,void 0,void 0,(function*(){const o=yield t.api("/me/joinedTeams").select(["displayName","id","isArchived"]).get();return o?o.value:null}))}(s),o=o.filter((t=>!t.isArchived));let l=o.map((t=>t.id));const h=BetaGraph.fromGraph(s);this.teamsPhotos=yield function getTeamsPhotosforPhotoIds(t,o){return __awaiter$d(this,void 0,void 0,(function*(){let s,l={};if(getIsPhotosCacheEnabled()){s=CacheService.getCache(AA.photos,AA.photos.stores.teams);for(const t of o)try{const o=yield s.getValue(t);o&&getPhotoInvalidationTime()>Date.now()-o.timeCached&&(l[t]=o)}catch(t){}if(Object.keys(l).length)return l}let h=["team.readbasic.all"];l={};for(const v of o)try{const o=yield getPhotoForResource(t,`/teams/${v}`,h);getIsPhotosCacheEnabled()&&o&&s.putValue(v,o),l[v]=o}catch(t){}return l}))}(h,l);const v=s.createBatch(),m=["team.readbasic.all"];for(const t of o)v.get(t.id,`teams/${t.id}/channels`,m);const _=yield v.executeAll();for(const t of o){const o=_.get(t.id);o&&o.content&&o.content.value&&(t.channels=o.content.value.map((t=>({item:t}))))}this.items=o.map((t=>({channels:t.channels,item:t})))}this.filterList(),this.resetFocusState()}))}removeSelectedChannel(t){this.selectChannel(t);const o=this.renderRoot.querySelectorAll("fluent-tree-item");o&&o.forEach((t=>{t.removeAttribute("expanded"),t.removeAttribute("selected")}))}handleItemClick(t){t.channels?t.isExpanded=!t.isExpanded:(this.selectChannel(t),this.lostFocus())}handleTeamTreeItemClick(t){t.preventDefault(),t.stopImmediatePropagation();const o=t.target;if(o){o.getAttribute("expanded")?o.removeAttribute("expanded"):o.setAttribute("expanded","true"),o.removeAttribute("selected");o.getAttribute("id")&&o.setAttribute("selected","true")}}handleInputChanged(t){const o=t.target;this._inputValue!==(null==o?void 0:o.value)&&(this._inputValue=null==o?void 0:o.value,this.gainedFocus(),this.debouncedSearch||(this.debouncedSearch=debounce((()=>{this.filterList()}),400)),this.debouncedSearch())}onUserKeyDown(t,o){switch(t.code){case"Enter":this.selectChannel(o),this.resetFocusState(),this.lostFocus(),t.preventDefault();break;case"Backspace":0===this._inputValue.length&&this._selectedItemState&&(this.selectChannel(null),this.resetFocusState(),t.preventDefault())}}filterList(){this.items&&(this._treeViewState=this.generateTreeViewState(this.items,this._inputValue),this.resetFocusState())}generateTreeViewState(t,o="",s=null){const l=[];if(o=o.toLowerCase(),t)for(const h of t){let t;if(0===o.length||h.item.displayName.toLowerCase().includes(o))t={item:h.item,parent:s},h.channels&&(t.channels=this.generateTreeViewState(h.channels,"",t),t.isExpanded=o.length>0);else if(h.channels){const l={item:h.item,parent:s},v=this.generateTreeViewState(h.channels,o,l);v.length>0&&(t=l,t.channels=v,t.isExpanded=!0)}t&&l.push(t)}return l}generateFocusList(t){if(!t||0===t.length)return[];let o=[];for(const s of t)o.push(s),s.channels&&s.isExpanded&&(o=[...o,...this.generateFocusList(s.channels)]);return o}resetFocusState(){this._focusList=this.generateFocusList(this._treeViewState),this.requestUpdate()}loadTeamsIfNotLoaded(){this.items||this.isLoadingState||this.requestStateUpdate()}handleWindowClick(t){t.target!==this&&this.lostFocus()}gainedFocus(){this._isFocused=!0;const t=this._input;t&&t.focus(),this._isDropdownVisible=!0,this.toggleChevron(),this.resetFocusState()}lostFocus(){const t=this._input;t&&(t.value=this._inputValue="",t.textContent=""),this._isFocused=!1,this._isDropdownVisible=!1,this.filterList(),this.toggleChevron(),this.requestUpdate(),void 0!==this._selectedItemState&&this.showCloseIcon()}selectChannel(t){t&&this._selectedItemState!==t?this._input.setAttribute("disabled","true"):this._input.removeAttribute("disabled"),this._selectedItemState=t,this.lostFocus(),this.fireCustomEvent("selectionChanged",this.selectedItem)}hideCloseIcon(){const t=this.renderRoot.querySelector(".close-icon");t&&(t.style.display="none")}toggleChevron(){const t=this.renderRoot.querySelector(".down-chevron"),o=this.renderRoot.querySelector(".up-chevron");this._isDropdownVisible?(t&&(t.style.display="none"),o&&(o.style.display=null)):(t&&(t.style.display=null,this.hideCloseIcon()),o&&(o.style.display="none")),this.hideCloseIcon()}handleUpChevronClick(t){t.stopPropagation(),this.lostFocus()}},exports.MgtTeamsChannelPicker._config={useTeamsBasedScopes:!1},__decorate$9([t$1(),__metadata$9("design:type",Object)],exports.MgtTeamsChannelPicker.prototype,"_selectedItemState",void 0),__decorate$9([t$1(),__metadata$9("design:type",Boolean)],exports.MgtTeamsChannelPicker.prototype,"_isDropdownVisible",void 0),__decorate$9([t$1(),__metadata$9("design:type",Boolean)],exports.MgtTeamsChannelPicker.prototype,"_isFocused",void 0),exports.MgtTeamsChannelPicker=pL=__decorate$9([customElement("teams-channel-picker"),__metadata$9("design:paramtypes",[])],exports.MgtTeamsChannelPicker);const fL={cancelNewTaskSubtitle:"Cancel",newTaskPlaceholder:"Adding task...",addTaskButtonSubtitle:"Add",removeTaskSubtitle:"Delete Task"};var __decorate$8=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},__metadata$8=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)},__awaiter$b=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};class MgtTasksBase extends MgtTemplatedComponent{get newTaskName(){return this._newTaskName}get strings(){return fL}constructor(){super(),this.clearState(),this._previousMediaQuery=this.mediaQuery,this.onResize=this.onResize.bind(this)}attributeChangedCallback(t,o,s){switch(super.attributeChangedCallback(t,o,s),t){case"target-id":case"initial-id":this.clearState(),this.requestStateUpdate()}}connectedCallback(){super.connectedCallback(),window.addEventListener("resize",this.onResize)}disconnectedCallback(){window.removeEventListener("resize",this.onResize),super.disconnectedCallback()}render(){const t=Providers.globalProvider;if(!t||t.state!==exports.ProviderState.SignedIn)return XI``;if(this.isLoadingState)return this.renderLoadingTask();const o=this.hideHeader?null:this.renderHeader(),s=this._isNewTaskVisible?this.renderNewTaskPanel():null,l=this.isLoadingState?this.renderLoadingTask():this.renderTasks();return XI`
      ${o} ${s}
      <div class="Tasks" dir=${this.direction}>
        ${l}
      </div>
    `}renderHeader(){const t=this.renderHeaderContent(),o=IA({AddBarItem:!0,NewTaskButton:!0,hidden:this.readOnly||this._isNewTaskVisible});return XI`
      <div class="Header" dir=${this.direction}>
        ${t}
        <button class="${o}" @click="${()=>this.showNewTaskPanel()}">
          <span class="TaskIcon">î</span>
          <span>${this.strings.addTaskButtonSubtitle}</span>
        </button>
      </div>
    `}renderLoadingTask(){return XI`
      <div class="Task LoadingTask">
        <div class="TaskContent">
          <div class="TaskCheckContainer">
            <div class="TaskCheck"></div>
          </div>
          <div class="TaskDetailsContainer">
            <div class="TaskTitle"></div>
            <div class="TaskDetails">
              <span class="TaskDetail">
                <div class="TaskDetailIcon"></div>
                <div class="TaskDetailName"></div>
              </span>
              <span class="TaskDetail">
                <div class="TaskDetailIcon"></div>
                <div class="TaskDetailName"></div>
              </span>
            </div>
          </div>
        </div>
      </div>
    `}renderNewTaskPanel(){const t=this._newTaskName,o=XI`
      <input
        type="text"
        placeholder="${this.strings.newTaskPlaceholder}"
        .value="${t}"
        label="new-taskName-input"
        aria-label="new-taskName-input"
        role="textbox"
        @input="${t=>{this._newTaskName=t.target.value,this.requestUpdate()}}"
      />
    `,s=IA({Disabled:!(this._isNewTaskBeingAdded||t&&t.length),TaskAddButtonContainer:!0}),l=this._isNewTaskBeingAdded?null:XI`
          <div
            tabindex='0'
            class="TaskIcon TaskAdd"
            @click="${()=>this.addTask()}"
            @keypress="${t=>{"Enter"!==t.key&&" "!==t.key||this.addTask()}}"
          >
          <span>${this.strings.addTaskButtonSubtitle}</span>
          </div>
          <div
            role='button'
            tabindex='0'
            class="TaskIcon TaskCancel"
            @click="${()=>this.hideNewTaskPanel()}"
            @keypress="${t=>{"Enter"!==t.key&&" "!==t.key||this.hideNewTaskPanel()}}">
            <span>${this.strings.cancelNewTaskSubtitle}</span>
          </div>
        `,h=this.renderNewTaskDetails();return XI`
      <div dir=${this.direction} class="Task NewTask Incomplete">
        <div class="TaskContent">
          <div class="TaskDetailsContainer">
            <div class="TaskTitle">
              ${o}
            </div>
            <div class="TaskDetails">
              ${h}
            </div>
          </div>
        </div>
        <div class="${s}">
          ${l}
        </div>
      </div>
    `}renderBucketIcon(){return XI`
      <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M14 2H2V4H3H5H6H10H11H13H14V2ZM10 5H6V6H10V5ZM5 5H3V14H13V5H11V6C11 6.55228 10.5523 7 10 7H6C5.44772 7 5 6.55228 5 6V5ZM1 5H2V14V15H3H13H14V14V5H15V4V2V1H14H2H1V2V4V5Z"
          fill="#3C3C3C"
        />
      </svg>
    `}renderCalendarIcon(){return XI`
        <svg width="16" height="20" viewBox="0 0 16 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M5 11C5.55228 11 6 10.5523 6 10C6 9.44771 5.55228 9 5 9C4.44772 9 4 9.44771 4 10C4 10.5523 4.44772 11 5 11ZM6 13C6 13.5523 5.55228 14 5 14C4.44772 14 4 13.5523 4 13C4 12.4477 4.44772 12 5 12C5.55228 12 6 12.4477 6 13ZM8 11C8.55229 11 9 10.5523 9 10C9 9.44771 8.55229 9 8 9C7.44771 9 7 9.44771 7 10C7 10.5523 7.44771 11 8 11ZM9 13C9 13.5523 8.55229 14 8 14C7.44771 14 7 13.5523 7 13C7 12.4477 7.44771 12 8 12C8.55229 12 9 12.4477 9 13ZM11 11C11.5523 11 12 10.5523 12 10C12 9.44771 11.5523 9 11 9C10.4477 9 10 9.44771 10 10C10 10.5523 10.4477 11 11 11ZM15 5.5C15 4.11929 13.8807 3 12.5 3H3.5C2.11929 3 1 4.11929 1 5.5V14.5C1 15.8807 2.11929 17 3.5 17H12.5C13.8807 17 15 15.8807 15 14.5V5.5ZM2 7H14V14.5C14 15.3284 13.3284 16 12.5 16H3.5C2.67157 16 2 15.3284 2 14.5V7ZM3.5 4H12.5C13.3284 4 14 4.67157 14 5.5V6H2V5.5C2 4.67157 2.67157 4 3.5 4Z" fill="#717171"/>
        </svg>
      `}addTask(){return __awaiter$b(this,void 0,void 0,(function*(){if(!this._isNewTaskBeingAdded&&this.newTaskName){this._isNewTaskBeingAdded=!0,this.requestUpdate();try{yield this.createNewTask()}finally{this._isNewTaskBeingAdded=!1,this._isNewTaskVisible=!1,this.requestUpdate()}}}))}clearNewTaskData(){this._newTaskName=""}clearState(){this.clearNewTaskData(),this._isNewTaskVisible=!1,this.requestUpdate()}handleTaskClick(t,o){this.fireCustomEvent("taskClick",{task:o})}dateToInputValue(t){return t?new Date(t.getTime()-6e4*t.getTimezoneOffset()).toISOString().split("T")[0]:null}showNewTaskPanel(){this._isNewTaskVisible=!0,this.requestUpdate()}hideNewTaskPanel(){this._isNewTaskVisible=!1,this.clearNewTaskData(),this.requestUpdate()}onResize(){this.mediaQuery!==this._previousMediaQuery&&(this._previousMediaQuery=this.mediaQuery,this.requestUpdate())}}__decorate$8([e$1({attribute:"read-only",type:Boolean}),__metadata$8("design:type",Boolean)],MgtTasksBase.prototype,"readOnly",void 0),__decorate$8([e$1({attribute:"hide-header",type:Boolean}),__metadata$8("design:type",Boolean)],MgtTasksBase.prototype,"hideHeader",void 0),__decorate$8([e$1({attribute:"hide-options",type:Boolean}),__metadata$8("design:type",Boolean)],MgtTasksBase.prototype,"hideOptions",void 0),__decorate$8([e$1({attribute:"target-id",type:String}),__metadata$8("design:type",String)],MgtTasksBase.prototype,"targetId",void 0),__decorate$8([e$1({attribute:"initial-id",type:String}),__metadata$8("design:type",String)],MgtTasksBase.prototype,"initialId",void 0);var gL,vL,mL,__awaiter$a=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};!function(t){t[t.notStarted=0]="notStarted",t[t.inProgress=1]="inProgress",t[t.completed=2]="completed",t[t.deferred=3]="deferred",t[t.waitingOnOthers=4]="waitingOnOthers"}(gL||(gL={})),function(t){t[t.low=0]="low",t[t.normal=1]="normal",t[t.high=2]="high"}(vL||(vL={})),function(t){t[t.none=0]="none",t[t.default=1]="default",t[t.flaggedEmails=2]="flaggedEmails",t[t.unknownFutureValue=3]="unknownFutureValue"}(mL||(mL={}));const bL=[i$4`
:host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\e70d"}.ms-Icon--ChevronUp::before{content:"\\\e70e"}.ms-Icon--Contact::before{content:"\\\e77b"}.ms-Icon--AddFriend::before{content:"\\\e8fa"}.ms-Icon--OutlookLogoInverse::before{content:"\\\eb6d"}.mgt-light{--color:#000000;--color-sub1:var(--neutral-foreground-rest, #1a1a1a);--color-sub2:var(--neutral-foreground-hint, #717171);--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:var(--neutral-fill-hover, #f7f7f7);--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--icon-color-sub3:#023b8f;--icon-color--hover:#605e5c;--icon-color__sub3--hover:#023b8f;--tab-line-color:#d6d6d6;--tab-line-color--hover:#727170;--tab-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--title-color-main:#000000;--title-color-subtitle:var(--neutral-foreground-rest, #1a1a1a);--title-color-sub2:var(--neutral-foreground-hint, #717171);--line-seperator-color:#d6d6d6;--line-seperator-color-sub1:#ebebeb;--placeholder-color:#605e5c;--placeholder-color--focus:var(--neutral-foreground-rest, #1a1a1a);--input-background-color:#ffffff;--input-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--input-background-color--focus:#ffffff;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:var(--neutral-fill-hover, #f7f7f7);--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--icon-color-sub3:#ffffff;--icon-color--hover:#717171;--icon-color__sub3--hover:#ffffff;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--line-seperator-color-sub1:#faf9f8;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-background-color--focus:#4f4f4f;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--task-border:1px solid #e1dfdd;--task-complete-border:2px dotted #e1dfdd;--task-new-add-button-disabled-background:#ebebeb;--task-icon-color:#000000}.mgt-dark{--task-border:1px solid #717171;--task-complete-border:2px dotted #717171;--task-new-add-button-disabled-background:#4f4f4f;--task-icon-color:#ffffff}:host{font-family:var(--default-font-family);display:flex;flex-direction:column;background-color:var(--background-color-sub1,#faf9f8);padding:var(--tasks-padding,12px);color:var(--color-sub1,var(--neutral-foreground-rest,#1a1a1a))}:host input[type=date]::-webkit-calendar-picker-indicator,:host input[type=date]::-webkit-inner-spin-button{display:none;-webkit-appearance:none}:host .TaskIcon{font-family:FabricMDL2Icons;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .TaskIcon.Divider{vertical-align:initial;margin:0 12px;font-size:16px}:host .Header{padding:var(--tasks-header-padding,0);margin:var(--tasks-header-margin,0 0 12px 0);padding:var(--tasks-title-padding,0);display:flex;align-items:center;justify-content:space-between}:host .Header .header__loading{max-width:90px;width:100%;height:20px;background:#f2f2f2}:host .Header select{font-family:var(--default-font-family, "Segoe UI");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px);border:none;-moz-appearance:none;-webkit-appearance:none;cursor:pointer}:host .Header select::-ms-expand{display:none}:host .Header .PlanTitle{font-family:var(--default-font-family, "Segoe UI");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px)}:host .Header .AddBar{display:flex}:host .Header .AddBar .AddBarItem{flex:1 1 auto}:host .Header .NewTaskDue{display:flex}:host .Header .NewTaskDue input{flex:1 1 auto;background-color:var(--background-color-sub1,#faf9f8)}:host .Header .TitleCont{flex:1 1 auto;display:flex;align-items:center;height:var(--tasks-new-button-height,34px)}:host .Header .NewTaskButton{flex:0 0 auto;display:flex;justify-content:center;align-items:center;width:var(--tasks-new-button-width,auto);height:var(--tasks-new-button-height,32px);border-radius:2px;padding:0 20px;background:var(--tasks-new-button-background,#0078d4);border:var(--tasks-new-button-border,solid 1px transparent);color:var(--tasks-new-button-color,#fff);user-select:none;-moz-user-select:none;-ms-user-select:none;cursor:pointer}:host .Header .NewTaskButton span{font-size:14px;font-weight:600;letter-spacing:.1px;line-height:14px}:host .Header .NewTaskButton .TaskIcon{margin-right:8px}:host .Header .NewTaskButton.hidden{visibility:hidden}:host .Header .NewTaskButton:hover{background:var(--tasks-new-button-hover-background,#106ebe)}:host .Header .NewTaskButton:active{background:var(--tasks-new-button-active-background,#005a9e)}:host .Task{position:relative;margin:var(--task-margin,0 0 18px 0);padding:var(--task-padding,0 0 0 0);background-color:var(--tasks-background-color,var(--background-color,#fff));border:var(--task-border,1px solid #e1dfdd);border-radius:8px}:host .Task .TaskContent{display:flex}:host .Task .TaskContent .Divider{position:absolute;height:2px;left:0;right:0;bottom:0;background-color:var(--background-color-sub1,#faf9f8)}:host .Task .TaskContent .TaskDetailsContainer{flex:1;display:grid;display:-ms-grid;grid-template-columns:auto 1fr;-ms-grid-columns:auto 1fr;grid-template-rows:auto auto auto auto;-ms-grid-rows:auto auto auto auto;justify-content:space-between;align-items:flex-start;color:var(--task-detail-color,var(--color-sub2,var(--neutral-foreground-hint,#717171)));font-size:12px;font-weight:600;white-space:normal;margin-bottom:12px}:host .Task .TaskContent .TaskDetailsContainer .TaskDetail{width:100%;height:100%;margin:4px 24px 6px 0;display:flex;justify-content:flex-start;align-items:center}:host .Task .TaskContent .TaskDetailsContainer .TaskTitle{color:var(--task-title-color,var(--title-color-subtitle,var(--neutral-foreground-rest,#1a1a1a)));font-size:14px;font-weight:600;grid-row:1;-ms-grid-row:1;grid-column:1/3;-ms-grid-column:1;-ms-grid-column-span:2;margin:22px 0 4px}:host .Task .TaskContent .TaskDetailsContainer .TaskGroup{min-height:24px;grid-row:2;-ms-grid-row:2;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer .TaskBucket{min-height:24px;grid-row:2;-ms-grid-row:2;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer .TaskDue{justify-content:flex-end;align-items:flex-start;grid-row:4;-ms-grid-row:4;grid-column:1/3;-ms-grid-column:1;-ms-grid-column-span:2}:host .Task .TaskContent .TaskDetailsContainer.tablet{grid-template-columns:1fr .5fr 1fr .5fr;-ms-grid-columns:1fr .5fr 1fr .5fr;grid-template-rows:auto auto;-ms-grid-rows:auto auto}:host .Task .TaskContent .TaskDetailsContainer.tablet.NoPlan{grid-template-columns:0 1fr 1fr 1fr;-ms-grid-columns:0 1fr 1fr 1fr}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskDetail{margin:4px 24px 6px 0}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskTitle{grid-row:1;-ms-grid-row:1;grid-column:1/5;-ms-grid-column:1;-ms-grid-column-span:4}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskGroup{grid-row:2;-ms-grid-row:2;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskBucket{grid-row:2;-ms-grid-row:2;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskAssignee{grid-row:2;-ms-grid-row:2;grid-column:3;-ms-grid-column:3}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskDue{justify-content:flex-start;align-items:center;grid-row:2;-ms-grid-row:2;grid-column:4;-ms-grid-column:4}:host .Task .TaskContent .TaskDetailsContainer.desktop{grid-template-columns:2fr 1fr .5fr 1fr .5fr;-ms-grid-columns:2fr 1fr .5fr 1fr .5fr;grid-template-rows:auto;-ms-grid-rows:auto;margin:0}:host .Task .TaskContent .TaskDetailsContainer.desktop.NoPlan{grid-template-columns:2fr 0 1fr 1fr 1fr;-ms-grid-columns:2fr 0 1fr 1fr 1fr}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskDetail{margin:0 24px 0 0}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskTitle{padding:0;grid-row:1;-ms-grid-row:1;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskGroup{min-height:61px;grid-row:1;-ms-grid-row:1;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskBucket{grid-row:1;-ms-grid-row:1;grid-column:3;-ms-grid-column:3}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskAssignee{grid-row:1;-ms-grid-row:1;grid-column:4;-ms-grid-column:4}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskDue{justify-content:flex-start;align-items:center;grid-row:1;-ms-grid-row:1;grid-column:5;-ms-grid-column:5}:host .Task .TaskContent .TaskDetailsContainer svg{vertical-align:middle;margin-right:4px}:host .Task .TaskContent .TaskDetailsContainer svg path{fill:var(--task-detail-color,var(--color-sub2,var(--neutral-foreground-hint,#717171)))}:host .Task .TaskContent .TaskDetailsContainer select,:host .Task .TaskContent .TaskDetailsContainer span{vertical-align:middle;color:var(--color-sub2,var(--neutral-foreground-hint,#717171))}:host .Task .TaskContent .TaskDetailsContainer .TaskIcon{color:#797775;margin-right:8px}:host .Task .TaskContent .TaskDetailsContainer .people{color:var(--task-detail-color,var(--color-sub2,var(--neutral-foreground-hint,#717171)));font-size:16px}:host .Task .TaskContent .TaskDetailsContainer .person{display:inline-block}:host .Task .TaskContent .TaskDetailsContainer .Picker{background-color:var(--background-color-sub1,#faf9f8);-webkit-background-clip:padding-box;-moz-background-clip:padding-box;background-clip:padding-box;width:var(--mgt-flyout-set-width,350px);color:var(--task-detail-color,var(--color-sub2,var(--neutral-foreground-hint,#717171)))}:host .Task .TaskContent .TaskDetailsContainer .Picker .people-picker{--separator-margin:0px 10px 0px 10px}:host .Task .TaskContent .TaskDetailsContainer input,:host .Task .TaskContent .TaskDetailsContainer select{color:var(--task-detail-color,var(--color-sub2,var(--neutral-foreground-hint,#717171)));font-size:.9em;background-color:var(--background-color-sub1,#faf9f8)}:host .Task .TaskCheckContainer{font-family:FabricMDL2Icons;display:inline-block;border-radius:50%;color:#fff;cursor:pointer;display:flex;align-items:var(--task-icon-alignment,flex-start);margin:21px 10px 20px 20px;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Task .TaskCheckContainer.Complete .TaskCheck{background-color:var(--task-icon-background-completed,#00ad56);border:var(--task-icon-border-completed,solid 1px #fff);color:var(--task-icon-color-completed,#fff)}:host .Task .TaskCheckContainer.Complete .TaskContent .TaskDetailsContainer .TaskTitle{text-decoration:line-through;color:var(--color-sub3,#727170)}:host .Task .TaskCheckContainer .TaskCheck{font-family:FabricMDL2Icons;font-size:12px;display:inline-block;width:18px;height:18px;border-radius:var(--task-icon-border-radius,50%);border:var(--task-icon-border,solid 1px #797775);color:var(--task-icon-color,#000);display:flex;justify-content:center;align-items:center;background-color:var(--task-icon-background,transparent);user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Task .TaskCheckContainer .TaskCheck.Loading .TaskCheckContent{animation:rotateIcon 2s infinite linear}:host .Task .TaskOptions{cursor:pointer;user-select:none;-moz-user-select:none;-ms-user-select:none;margin:16px 8px 0 0}:host .Task.ReadOnly .TaskCheckContainer{cursor:default}:host .Task.Complete{background:var(--task-complete-background,var(--background-color-sub1,#faf9f8));border:var(--task-complete-border,2px dotted #e1dfdd)}:host .Task.Complete .TaskContent .TaskDetailsContainer .TaskTitle{text-decoration:line-through;color:var(--color-sub3,#727170)}:host .Task.NewTask{margin:var(--task-new-margin,var(--task-margin,0 0 24px 0));display:flex;flex-direction:row}:host .Task.NewTask .SelfAssign{display:none}:host .Task.NewTask .AssignTo{border:0;background:0 0}:host .Task.NewTask .FakeCheckBox{width:15px;height:15px;cursor:pointer;margin:0 5px 0 5px}:host .Task.NewTask .FakeCheckBox::after{font-family:FabricMDL2Icons;content:"uE739"}:host .Task.NewTask .FakeCheckBox~:checked{font-family:FabricMDL2Icons;content:"uE73A"}:host .Task.NewTask .TaskContent{flex:1 1 auto;align-content:center;vertical-align:middle;margin:0 0 0 12px}:host .Task.NewTask .TaskContent .TaskDetailsContainer{display:flex;flex-direction:column;align-items:stretch;margin:0}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle{display:flex;height:32px;padding:2px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input{flex:1;font-family:var(--default-font-family, "Segoe UI");margin:var(--task-new-input-margin,0 24px 0 16px);padding:var(--task-new-input-padding,6px);font-size:var(--task-new-input-font-size,14px);font-weight:600;border:var(--task-new-border,none);border-bottom:1px solid #e1dfdd;outline:0;border-radius:0;background-color:var(--background-color-sub1,#faf9f8)}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:hover{border-bottom:1px solid #106ebe}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:active{border-bottom:1px solid #005a9e}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:focus{border-bottom:1px solid #0078d4}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails{display:flex;justify-content:stretch;align-items:center;flex-wrap:wrap;margin:14px 0 14px 4px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskGroup{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskBucket{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskDue{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskAssignee{margin:8px 16px;min-width:80px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .TaskPeople label{display:flex;align-content:center;align-items:center}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select{font-family:var(--default-font-family);font-size:12px;font-weight:600;border:var(--task-new-select-border,none);border-bottom:1px solid #e1dfdd}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:hover,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:hover{border-bottom:1px solid #106ebe}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:active,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:active{border-bottom:1px solid #005a9e}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:focus,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:focus{border-bottom:1px solid #0078d4}:host .Task.NewTask .TaskAddButtonContainer{margin-right:28px}:host .Task.NewTask .TaskAddButtonContainer .TaskAdd,:host .Task.NewTask .TaskAddButtonContainer .TaskCancel{justify-content:center;align-items:center;cursor:pointer;flex:0 0 auto;display:flex;width:var(--tasks-new-button-width,100px);height:var(--tasks-new-button-height,32px);border-radius:4px;border:var(--tasks-new-button-border,solid 1px #e5e5e5);font-family:var(--default-font-family, "Segoe UI");font-size:14px;line-height:20px}:host .Task.NewTask .TaskAddButtonContainer .TaskAdd{color:#fff;background:var(--task-new-add-button-background,#0078d4);margin:22px 0 12px auto}:host .Task.NewTask .TaskAddButtonContainer .TaskCancel{color:var(--task-new-cancel-button-color,var(--color-sub1,var(--neutral-foreground-rest,#1a1a1a)))}:host .Task.NewTask .TaskAddButtonContainer.Disabled .TaskAdd{color:var(--task-new-cancel-button-color,var(--color-sub1,var(--neutral-foreground-rest,#1a1a1a)));background:var(--task-new-add-button-disabled-background,#fff);cursor:default}:host .Task.LoadingTask .TaskCheckContainer{cursor:default}:host .Task.LoadingTask .TaskDetails{display:flex}:host .Task.LoadingTask .TaskCheck{background:#f2f2f2;border-color:#f2f2f2;cursor:default}:host .Task.LoadingTask .TaskDetailIcon{width:16px;height:16px;margin:5px;background:#f2f2f2}:host .Task.LoadingTask .TaskTitle{background:#f2f2f2;max-width:400px;height:20px;margin-right:20px!important}:host .Task.LoadingTask .TaskDetail{margin-right:12px;display:flex;flex-direction:row;align-items:center}:host .Task.LoadingTask .TaskDetailName{width:81px;height:10px;background:#f2f2f2}@keyframes rotateIcon{from{transform:rotate(0)}to{transform:rotate(360deg)}}[dir=rtl] .arrow-options{--arrow-options-left:auto}[dir=rtl] .dot-options{--dot-options-translateX:translateX(60px)}[dir=rtl] .TaskDetails{margin-right:14px!important}[dir=rtl] .TaskIcon{margin-left:8px}[dir=rtl] .TaskDetail svg{margin-left:4px}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host svg{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}:host{border-radius:8px}:host .Task{border:none}
`],yL={cancelNewTaskSubtitle:"Cancel",newTaskPlaceholder:"Adding task...",addTaskButtonSubtitle:"Add",removeTaskSubtitle:"Delete Task"};var __decorate$7=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},__metadata$7=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)},__awaiter$9=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};function applyTheme(t,o=document.body){const s=function getThemeSettings(t){switch(t){case"contrast":return{accentBaseColor:"#7f85f5",neutralBaseColor:"#adadad",baseLayerLuminance:sO.DarkMode};case"default":return{accentBaseColor:"#5b5fc7",neutralBaseColor:"#616161",baseLayerLuminance:sO.LightMode};case"dark":return{accentBaseColor:"#479ef5",neutralBaseColor:"#adadad",baseLayerLuminance:sO.DarkMode};default:return{accentBaseColor:"#0f6cbd",neutralBaseColor:"#616161",baseLayerLuminance:sO.LightMode}}}(t);!function applyColorScheme(t,o=document.body){K$.setValueFor(o,QR.from(parseColorHexRGB(t.accentBaseColor))),V$.setValueFor(o,QR.from(parseColorHexRGB(t.neutralBaseColor))),KO.setValueFor(o,t.baseLayerLuminance)}(s,o)}exports.MgtTodo=class MgtTodo extends MgtTasksBase{static get styles(){return bL}get strings(){return yL}static get requiredScopes(){return["tasks.read","tasks.readwrite"]}constructor(){super(),this._graph=null,this._newTaskDueDate=null,this._newTaskListId="",this._currentList=null,this._lists=[],this._tasks=[],this._loadingTasks=[],this._isLoadingTasks=!1}renderTasks(){if(this._isLoadingTasks)return this.renderLoadingTask();let t=this._tasks;t&&this.taskFilter&&(t=t.filter((t=>this.taskFilter(t))));const o=GA(t,(t=>t.id),(t=>this.renderTask(t)));return XI`
      ${o}
    `}renderNewTaskDetails(){const t=this._lists.filter((t=>this._currentList&&t.id===this._currentList.id||!this._currentList&&t.id===this._newTaskListId));t.length>0&&!this._newTaskListId&&(this._newTaskListId=t[0].id);const o=this._currentList?XI`
          <span class="NewTaskGroup">
            ${this.renderBucketIcon()}
            <span>${this._currentList.displayName}</span>
          </span>
        `:XI`
          <span class="NewTaskGroup">
            ${this.renderBucketIcon()}
            <select
              .value="${this._newTaskListId}"
              @change="${t=>{this._newTaskListId=t.target.value}}"
            >
              ${t.map((t=>XI`
                  <option value="${t.id}">${t.displayName}</option>
                `))}
            </select>
          </span>
        `,s=XI`
      <span class="NewTaskDue">
        ${this.renderCalendarIcon()}
        <input
          type="date"
          label="new-taskDate-input"
          aria-label="new-taskDate-input"
          role="textbox"
          .value="${this.dateToInputValue(this._newTaskDueDate)}"
          @change="${t=>{const o=t.target.value;this._newTaskDueDate=o?new Date(o+"T17:00"):null}}"
        />
      </span>
    `;return XI`
      ${o} ${s}
    `}renderHeaderContent(){if(this.isLoadingState)return XI`
        <div class="header__loading"></div>
      `;const t=this._lists||[],o=this._currentList,s=this.targetId;let l;if(s&&t.length){const o=t.find((t=>t.id===s));o&&(l=XI`
          <span class="PlanTitle">
            ${o.displayName}
          </span>
        `)}else if(o){const s={};for(const o of t)s[o.displayName]=()=>this.loadTaskList(o);l=mgtHtml`
        <mgt-arrow-options .value="${o.displayName}" .options="${s}"></mgt-arrow-options>
      `}return XI`
      <span class="TitleCont">
        ${l}
      </span>
    `}renderTask(t){const o={task:t,list:this._currentList};if(this.hasTemplate("task"))return this.renderTemplate("task",o,t.id);const s=gL[t.status]===gL.completed,l=this._loadingTasks.includes(t.id),h={Complete:!l&&s,Loading:l,TaskCheck:!0,TaskIcon:!0},v=l?XI`
          ïª
        `:s?XI`
          î¾
        `:null;let m=null;if(this.hasTemplate("task-details"))m=this.renderTemplate("task-details",o,`task-details-${t.id}`);else{const o=t.dueDateTime?XI`
            <div class="TaskDetail TaskDue">
              <span>Due ${getShortDateString(new Date(t.dueDateTime.dateTime))}</span>
            </div>
          `:null;m=XI`
        <div class="TaskTitle">
          ${t.title}
        </div>
        <div class="TaskDetail TaskBucket">
          ${this.renderBucketIcon()}
          <span>${this._currentList.displayName}</span>
        </div>
        ${o}
      `}const _=this.readOnly||this.hideOptions?null:mgtHtml`
            <div class="TaskOptions">
              <mgt-dot-options
                .options="${{[this.strings.removeTaskSubtitle]:o=>this.removeTask(o,t.id)}}"
              ></mgt-dot-options>
            </div>
          `,R=IA({Complete:s,Incomplete:!s,ReadOnly:this.readOnly,Task:!0}),$=IA({Complete:s,Incomplete:!s,TaskCheckContainer:!0});return XI`
      <div class=${R}>
        <div class="TaskContent" @click="${o=>this.handleTaskClick(o,t)}}">
          <span class=${$} @click="${o=>this.handleTaskCheckClick(o,t)}">
            <span class=${IA(h)}>
              <span class="TaskCheckContent">${v}</span>
            </span>
          </span>
          <div class="TaskDetailsContainer ${this.mediaQuery}">
            ${m}
          </div>
          ${_}
          <div class="Divider"></div>
        </div>
      </div>
    `}loadState(){return __awaiter$9(this,void 0,void 0,(function*(){const t=Providers.globalProvider;if(!t||t.state!==exports.ProviderState.SignedIn)return;if(!this._graph){const o=t.graph.forComponent(this);this._graph=o}let o=this._lists;if(!o||!o.length){if(this.targetId){const t=yield function getTodoTaskList(t,o){return __awaiter$a(this,void 0,void 0,(function*(){return yield t.api(`/me/todo/lists/${o}`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.Read")).get()}))}(this._graph,this.targetId);o=t?[t]:[]}else o=yield function getTodoTaskLists(t){return __awaiter$a(this,void 0,void 0,(function*(){const o=yield t.api("/me/todo/lists").header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.Read")).get();return o&&o.value}))}(this._graph);this._tasks=[],this._currentList=null,this._lists=o}let s=this._currentList;!s&&o&&o.length&&(this.initialId&&(s=o.find((t=>t.id===this.initialId))),s||(s=o[0]),this._tasks=[],this._currentList=s),s&&(yield this.loadTaskList(s))}))}createNewTask(){return __awaiter$9(this,void 0,void 0,(function*(){const t=this._currentList.id,o={title:this.newTaskName};this._newTaskDueDate&&(o.dueDateTime={dateTime:this._newTaskDueDate.toLocaleDateString(),timeZone:"UTC"});const s=yield function createTodoTask(t,o,s){return __awaiter$a(this,void 0,void 0,(function*(){return yield t.api(`/me/todo/lists/${o}/tasks`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.ReadWrite")).post(s)}))}(this._graph,t,o);this._tasks.unshift(s)}))}clearNewTaskData(){super.clearNewTaskData(),this._newTaskDueDate=null,this._newTaskListId=null}clearState(){super.clearState(),this._currentList=null,this._lists=[],this._tasks=[],this._loadingTasks=[],this._isLoadingTasks=!1}loadTaskList(t){return __awaiter$9(this,void 0,void 0,(function*(){this._isLoadingTasks=!0,this._currentList=t,this.requestUpdate(),this._tasks=yield function getTodoTasks(t,o){return __awaiter$a(this,void 0,void 0,(function*(){const s=yield t.api(`/me/todo/lists/${o}/tasks`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.Read")).get();return s&&s.value}))}(this._graph,t.id),this._isLoadingTasks=!1,this.requestUpdate()}))}updateTaskStatus(t,o){return __awaiter$9(this,void 0,void 0,(function*(){this._loadingTasks=[...this._loadingTasks,t.id],this.requestUpdate(),t.status=o;const s=this._currentList.id;t=yield function updateTodoTask(t,o,s,l){return __awaiter$a(this,void 0,void 0,(function*(){return yield t.api(`/me/todo/lists/${o}/tasks/${s}`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.ReadWrite")).patch(l)}))}(this._graph,s,t.id,t);const l=this._tasks.findIndex((o=>o.id===t.id));this._tasks[l]=t,this._loadingTasks=this._loadingTasks.filter((o=>o!==t.id)),this.requestUpdate()}))}removeTask(t,o){return __awaiter$9(this,void 0,void 0,(function*(){this._tasks=this._tasks.filter((t=>t.id!==o)),this.requestUpdate();const t=this._currentList.id;yield function deleteTodoTask(t,o,s){return __awaiter$a(this,void 0,void 0,(function*(){yield t.api(`/me/todo/lists/${o}/tasks/${s}`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.ReadWrite")).delete()}))}(this._graph,t,o),this._tasks=this._tasks.filter((t=>t.id!==o))}))}handleTaskCheckClick(t,o){this.readOnly||(gL[o.status]===gL.completed?this.updateTaskStatus(o,gL.notStarted):this.updateTaskStatus(o,gL.completed),t.stopPropagation(),t.preventDefault())}},exports.MgtTodo=__decorate$7([customElement("todo"),__metadata$7("design:paramtypes",[])],exports.MgtTodo);const wL={label:"Color mode:",on:"Dark",off:"Light"};var __decorate$6=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},__metadata$6=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)};registerFluentComponents(dD);let _L=class MgtThemeToggle extends MgtBaseComponent{constructor(){super();const t=window.matchMedia("(prefers-color-scheme:dark)").matches;this.darkModeActive=t,this.applyTheme(this.darkModeActive)}get strings(){return wL}updated(t){t.has("darkModeActive")&&this.applyTheme(this.darkModeActive)}render(){return XI`
      <fluent-switch checked=${this.darkModeActive} @change=${this.onSwitchChanged}>
        <span slot="checked-message">${wL.on}</span>
        <span slot="unchecked-message">${wL.off}</span>
        <label for="direction-switch">${wL.label}</label>
      </fluent-switch>
`}onSwitchChanged(t){this.darkModeActive=t.target.checked,this.fireCustomEvent("darkmodechanged",this.darkModeActive)}applyTheme(t){const o=t?"dark":"light";applyTheme(o),document.body.classList.remove("mgt-dark-mode","mgt-light-mode"),document.body.classList.add(`mgt-${o}-mode`)}};__decorate$6([e$1({attribute:"mode",reflect:!0,type:String,converter:{fromAttribute:t=>"dark"===t,toAttribute:t=>t?"dark":"light"}}),__metadata$6("design:type",Boolean)],_L.prototype,"darkModeActive",void 0),_L=__decorate$6([customElement("theme-toggle"),__metadata$6("design:paramtypes",[])],_L);
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var extendStatics$2=function(t,o){return extendStatics$2=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var s in o)o.hasOwnProperty(s)&&(t[s]=o[s])},extendStatics$2(t,o)};function __extends$2(t,o){function __(){this.constructor=t}extendStatics$2(t,o),t.prototype=null===o?Object.create(o):(__.prototype=o.prototype,new __)}var __assign$2=function(){return __assign$2=Object.assign||function __assign(t){for(var o,s=1,l=arguments.length;s<l;s++)for(var h in o=arguments[s])Object.prototype.hasOwnProperty.call(o,h)&&(t[h]=o[h]);return t},__assign$2.apply(this,arguments)};function __awaiter$8(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))}function __generator$2(t,o){var s,l,h,v,m={label:0,sent:function(){if(1&h[0])throw h[1];return h[1]},trys:[],ops:[]};return v={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(v[Symbol.iterator]=function(){return this}),v;function verb(v){return function(_){return function step(v){if(s)throw new TypeError("Generator is already executing.");for(;m;)try{if(s=1,l&&(h=2&v[0]?l.return:v[0]?l.throw||((h=l.return)&&h.call(l),0):l.next)&&!(h=h.call(l,v[1])).done)return h;switch(l=0,h&&(v=[2&v[0],h.value]),v[0]){case 0:case 1:h=v;break;case 4:return m.label++,{value:v[1],done:!1};case 5:m.label++,l=v[1],v=[0];continue;case 7:v=m.ops.pop(),m.trys.pop();continue;default:if(!(h=m.trys,(h=h.length>0&&h[h.length-1])||6!==v[0]&&2!==v[0])){m=0;continue}if(3===v[0]&&(!h||v[1]>h[0]&&v[1]<h[3])){m.label=v[1];break}if(6===v[0]&&m.label<h[1]){m.label=h[1],h=v;break}if(h&&m.label<h[2]){m.label=h[2],m.ops.push(v);break}h[2]&&m.ops.pop(),m.trys.pop();continue}v=o.call(t,m)}catch(t){v=[6,t],l=0}finally{s=h=0}if(5&v[0])throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}([v,_])}}}function __spreadArrays$1(){for(var t=0,o=0,s=arguments.length;o<s;o++)t+=arguments[o].length;var l=Array(t),h=0;for(o=0;o<s;o++)for(var v=arguments[o],m=0,_=v.length;m<_;m++,h++)l[h]=v[m];return l}var CL,kL=function(){function CryptoUtils(){}return CryptoUtils.createNewGuid=function(){var t=window.crypto;if(t&&t.getRandomValues){var o=new Uint8Array(16);return t.getRandomValues(o),o[6]|=64,o[6]&=79,o[8]|=128,o[8]&=191,CryptoUtils.decimalToHex(o[0])+CryptoUtils.decimalToHex(o[1])+CryptoUtils.decimalToHex(o[2])+CryptoUtils.decimalToHex(o[3])+"-"+CryptoUtils.decimalToHex(o[4])+CryptoUtils.decimalToHex(o[5])+"-"+CryptoUtils.decimalToHex(o[6])+CryptoUtils.decimalToHex(o[7])+"-"+CryptoUtils.decimalToHex(o[8])+CryptoUtils.decimalToHex(o[9])+"-"+CryptoUtils.decimalToHex(o[10])+CryptoUtils.decimalToHex(o[11])+CryptoUtils.decimalToHex(o[12])+CryptoUtils.decimalToHex(o[13])+CryptoUtils.decimalToHex(o[14])+CryptoUtils.decimalToHex(o[15])}for(var s="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",l="0123456789abcdef",h=0,v="",m=0;m<36;m++)"-"!==s[m]&&"4"!==s[m]&&(h=16*Math.random()|0),"x"===s[m]?v+=l[h]:"y"===s[m]?(h&=3,v+=l[h|=8]):v+=s[m];return v},CryptoUtils.isGuid=function(t){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)},CryptoUtils.decimalToHex=function(t){for(var o=t.toString(16);o.length<2;)o="0"+o;return o},CryptoUtils.base64Encode=function(t){return btoa(encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,(function toSolidBytes(t,o){return String.fromCharCode(Number("0x"+o))})))},CryptoUtils.base64Decode=function(t){var o=t.replace(/-/g,"+").replace(/_/g,"/");switch(o.length%4){case 0:break;case 2:o+="==";break;case 3:o+="=";break;default:throw new Error("Invalid base64 string")}return decodeURIComponent(atob(o).split("").map((function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)})).join(""))},CryptoUtils.deserialize=function(t){var o,s=/\+/g,l=/([^&=]+)=([^&]*)/g,decode=function(t){return decodeURIComponent(t.replace(s," "))},h={};for(o=l.exec(t);o;)h[decode(o[1])]=decode(o[2]),o=l.exec(t);return h},CryptoUtils}(),TL=function(){function Constants(){}return Object.defineProperty(Constants,"libraryName",{get:function(){return"Msal.js"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"claims",{get:function(){return"claims"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"clientId",{get:function(){return"clientId"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"adalIdToken",{get:function(){return"adal.idtoken"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"cachePrefix",{get:function(){return"msal"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"scopes",{get:function(){return"scopes"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"no_account",{get:function(){return"NO_ACCOUNT"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"upn",{get:function(){return"upn"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"domain_hint",{get:function(){return"domain_hint"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"prompt_select_account",{get:function(){return"&prompt=select_account"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"prompt_none",{get:function(){return"&prompt=none"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"prompt",{get:function(){return"prompt"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"response_mode_fragment",{get:function(){return"&response_mode=fragment"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"resourceDelimiter",{get:function(){return"|"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"cacheDelimiter",{get:function(){return"."},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"popUpWidth",{get:function(){return this._popUpWidth},set:function(t){this._popUpWidth=t},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"popUpHeight",{get:function(){return this._popUpHeight},set:function(t){this._popUpHeight=t},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"login",{get:function(){return"LOGIN"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"renewToken",{get:function(){return"RENEW_TOKEN"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"unknown",{get:function(){return"UNKNOWN"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"ADFS",{get:function(){return"adfs"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"homeAccountIdentifier",{get:function(){return"homeAccountIdentifier"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"common",{get:function(){return"common"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"openidScope",{get:function(){return"openid"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"profileScope",{get:function(){return"profile"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"oidcScopes",{get:function(){return[this.openidScope,this.profileScope]},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"interactionTypeRedirect",{get:function(){return"redirectInteraction"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"interactionTypePopup",{get:function(){return"popupInteraction"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"interactionTypeSilent",{get:function(){return"silentInteraction"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"inProgress",{get:function(){return"inProgress"},enumerable:!1,configurable:!0}),Constants._popUpWidth=483,Constants._popUpHeight=600,Constants}(),SL="sessionStorage";!function(t){t.SCOPE="scope",t.STATE="state",t.ERROR="error",t.ERROR_DESCRIPTION="error_description",t.ACCESS_TOKEN="access_token",t.ID_TOKEN="id_token",t.EXPIRES_IN="expires_in",t.SESSION_STATE="session_state",t.CLIENT_INFO="client_info"}(CL||(CL={}));var xL,EL,IL,AL="id_token",PL="token",RL="id_token token";!function(t){t.AUTHORITY="authority",t.ACQUIRE_TOKEN_ACCOUNT="acquireTokenAccount",t.SESSION_STATE="session.state",t.STATE_LOGIN="state.login",t.STATE_ACQ_TOKEN="state.acquireToken",t.STATE_RENEW="state.renew",t.NONCE_IDTOKEN="nonce.idtoken",t.LOGIN_REQUEST="login.request",t.RENEW_STATUS="token.renew.status",t.URL_HASH="urlHash",t.INTERACTION_STATUS="interaction.status",t.REDIRECT_REQUEST="redirect_request"}(xL||(xL={})),function(t){t.IDTOKEN="idtoken",t.CLIENT_INFO="client.info"}(EL||(EL={})),function(t){t.LOGIN_ERROR="login.error",t.ERROR="error",t.ERROR_DESC="error.description"}(IL||(IL={}));var OL,$L=".well-known/openid-configuration";!function(t){t.ACCOUNT="account",t.SID="sid",t.LOGIN_HINT="login_hint",t.ORGANIZATIONS="organizations",t.CONSUMERS="consumers",t.ID_TOKEN="id_token",t.ACCOUNT_ID="accountIdentifier",t.HOMEACCOUNT_ID="homeAccountIdentifier"}(OL||(OL={}));var NL,ML=[OL.SID,OL.LOGIN_HINT],DL="GET",LL={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"},FL="msalIdTokenFrame",UL="msalRenewFrame",HL={code:"unexpected_error",desc:"Unexpected error in authentication."},BL={code:"no_window_object",desc:"No window object available. Details:"},qL=function(t){function AuthError(o,s){var l=t.call(this,s)||this;return Object.setPrototypeOf(l,AuthError.prototype),l.errorCode=o,l.errorMessage=s,l.name="AuthError",l}return __extends$2(AuthError,t),AuthError.createUnexpectedError=function(t){return new AuthError(HL.code,HL.desc+": "+t)},AuthError.createNoWindowObjectError=function(t){return new AuthError(BL.code,BL.desc+" "+t)},AuthError}(Error),jL=function(){function StringUtils(){}return StringUtils.isEmpty=function(t){return void 0===t||!t||0===t.length},StringUtils.validateAndParseJsonCacheKey=function(t){try{var o=JSON.parse(t);return o&&"object"==typeof o?o:null}catch(t){return null}},StringUtils}(),zL={code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},VL={code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},GL={code:"token_renewal_error",desc:"Token renewal operation failed due to timeout."},KL={code:"invalid_id_token",desc:"Invalid ID token format."},WL={code:"invalid_state_error",desc:"Invalid state."},QL={code:"nonce_mismatch_error",desc:"Nonce is not matching, Nonce received: "},YL={code:"login_progress_error",desc:"Login_In_Progress: Error during login call - login is already in progress."},JL={code:"acquiretoken_progress_error",desc:"AcquireToken_In_Progress: Error during login call - login is already in progress."},XL={code:"user_cancelled",desc:"User cancelled the flow."},ZL={code:"callback_error",desc:"Error occurred in token received callback function."},eF={code:"user_login_error",desc:"User login is required. For silent calls, request must contain either sid or login_hint"},tF={code:"user_non_existent",desc:"User object does not exist. Please call a login API."},rF={code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},oF={code:"client_info_not_populated_error",desc:"The service did not populate client_info in the response, Please verify with the service team"},nF={code:"null_or_empty_id_token",desc:"The idToken is null or empty. Please review the trace to determine the root cause."},iF={code:"id_token_parsing_error",desc:"ID token cannot be parsed. Please review stack trace to determine root cause."},sF={code:"token_encoding_error",desc:"The token to be decoded is not encoded correctly."},aF={code:"invalid_interaction_type",desc:"The interaction type passed to the handler was incorrect or unknown"},lF={code:"cannot_parse_cache",desc:"The cached token key is not a valid JSON and cannot be parsed"},cF={code:"block_token_requests",desc:"Token calls are blocked in hidden iframes"},dF=function(t){function ClientAuthError(o,s){var l=t.call(this,o,s)||this;return l.name="ClientAuthError",Object.setPrototypeOf(l,ClientAuthError.prototype),l}return __extends$2(ClientAuthError,t),ClientAuthError.createEndpointResolutionError=function(t){var o=zL.desc;return t&&!jL.isEmpty(t)&&(o+=" Details: "+t),new ClientAuthError(zL.code,o)},ClientAuthError.createPopupWindowError=function(t){var o=VL.desc;return t&&!jL.isEmpty(t)&&(o+=" Details: "+t),new ClientAuthError(VL.code,o)},ClientAuthError.createTokenRenewalTimeoutError=function(){return new ClientAuthError(GL.code,GL.desc)},ClientAuthError.createInvalidIdTokenError=function(t){return new ClientAuthError(KL.code,KL.desc+" Given token: "+t)},ClientAuthError.createInvalidStateError=function(t,o){return new ClientAuthError(WL.code,WL.desc+" "+t+", state expected : "+o+".")},ClientAuthError.createNonceMismatchError=function(t,o){return new ClientAuthError(QL.code,QL.desc+" "+t+", nonce expected : "+o+".")},ClientAuthError.createLoginInProgressError=function(){return new ClientAuthError(YL.code,YL.desc)},ClientAuthError.createAcquireTokenInProgressError=function(){return new ClientAuthError(JL.code,JL.desc)},ClientAuthError.createUserCancelledError=function(){return new ClientAuthError(XL.code,XL.desc)},ClientAuthError.createErrorInCallbackFunction=function(t){return new ClientAuthError(ZL.code,ZL.desc+" "+t+".")},ClientAuthError.createUserLoginRequiredError=function(){return new ClientAuthError(eF.code,eF.desc)},ClientAuthError.createUserDoesNotExistError=function(){return new ClientAuthError(tF.code,tF.desc)},ClientAuthError.createClientInfoDecodingError=function(t){return new ClientAuthError(rF.code,rF.desc+" Failed with error: "+t)},ClientAuthError.createClientInfoNotPopulatedError=function(t){return new ClientAuthError(oF.code,oF.desc+" Failed with error: "+t)},ClientAuthError.createIdTokenNullOrEmptyError=function(t){return new ClientAuthError(nF.code,nF.desc+" Raw ID Token Value: "+t)},ClientAuthError.createIdTokenParsingError=function(t){return new ClientAuthError(iF.code,iF.desc+" Failed with error: "+t)},ClientAuthError.createTokenEncodingError=function(t){return new ClientAuthError(sF.code,sF.desc+" Attempted to decode: "+t)},ClientAuthError.createInvalidInteractionTypeError=function(){return new ClientAuthError(aF.code,aF.desc)},ClientAuthError.createCacheParseError=function(t){var o="invalid key: "+t+", "+lF.desc;return new ClientAuthError(lF.code,o)},ClientAuthError.createBlockTokenRequestsInHiddenIframeError=function(){return new ClientAuthError(cF.code,cF.desc)},ClientAuthError}(qL),uF={code:"no_config_set",desc:"Configuration has not been set. Please call the UserAgentApplication constructor with a valid Configuration object."},hF={code:"storage_not_supported",desc:"The value for the cacheLocation is not supported."},pF={code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call handleRedirectCallback() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},fF={code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},gF={code:"scopes_required",desc:"Scopes are required to obtain an access token."},vF={code:"empty_input_scopes_error",desc:"Scopes cannot be passed as empty array."},mF={code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},bF={code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent' and 'none'"},yF={code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please see here for valid authorities: <insert URL here>."},wF={code:"authority_uri_insecure",desc:"Authority URIs must use https."},_F={code:"authority_uri_invalid_path",desc:"Given authority URI is invalid."},CF={code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter or set validateAuthority=false."},kF={code:"b2c_known_authorities_not_set",desc:"Must set known authorities when validateAuthority is set to True and using B2C"},TF={code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},SF={code:"empty_request_error",desc:"Request object is required."},xF={code:"invalid_guid_sent_as_correlationId",desc:"Please set the correlationId as a valid guid"},EF={code:"telemetry_config_error",desc:"Telemetry config is not configured with required values"},IF={code:"sso_silent_error",desc:"request must contain either sid or login_hint"},AF={code:"authority_metadata_error",desc:"Invalid authorityMetadata. Must be a JSON object containing authorization_endpoint, end_session_endpoint, and issuer fields."},PF=function(t){function ClientConfigurationError(o,s){var l=t.call(this,o,s)||this;return l.name="ClientConfigurationError",Object.setPrototypeOf(l,ClientConfigurationError.prototype),l}return __extends$2(ClientConfigurationError,t),ClientConfigurationError.createNoSetConfigurationError=function(){return new ClientConfigurationError(uF.code,""+uF.desc)},ClientConfigurationError.createStorageNotSupportedError=function(t){return new ClientConfigurationError(hF.code,hF.desc+" Given location: "+t)},ClientConfigurationError.createRedirectCallbacksNotSetError=function(){return new ClientConfigurationError(pF.code,pF.desc)},ClientConfigurationError.createInvalidCallbackObjectError=function(t){return new ClientConfigurationError(fF.code,fF.desc+" Given value for callback function: "+t)},ClientConfigurationError.createEmptyScopesArrayError=function(t){return new ClientConfigurationError(vF.code,vF.desc+" Given value: "+t+".")},ClientConfigurationError.createScopesNonArrayError=function(t){return new ClientConfigurationError(mF.code,mF.desc+" Given value: "+t+".")},ClientConfigurationError.createScopesRequiredError=function(t){return new ClientConfigurationError(gF.code,gF.desc+" Given value: "+t)},ClientConfigurationError.createInvalidPromptError=function(t){return new ClientConfigurationError(bF.code,bF.desc+" Given value: "+t)},ClientConfigurationError.createClaimsRequestParsingError=function(t){return new ClientConfigurationError(TF.code,TF.desc+" Given value: "+t)},ClientConfigurationError.createEmptyRequestError=function(){var t=SF;return new ClientConfigurationError(t.code,t.desc)},ClientConfigurationError.createInvalidCorrelationIdError=function(){return new ClientConfigurationError(xF.code,xF.desc)},ClientConfigurationError.createKnownAuthoritiesNotSetError=function(){return new ClientConfigurationError(kF.code,kF.desc)},ClientConfigurationError.createInvalidAuthorityTypeError=function(){return new ClientConfigurationError(yF.code,yF.desc)},ClientConfigurationError.createUntrustedAuthorityError=function(t){return new ClientConfigurationError(CF.code,CF.desc+" Provided Authority: "+t)},ClientConfigurationError.createTelemetryConfigError=function(t){var o=EF,s=o.code,l=o.desc,h={applicationName:"string",applicationVersion:"string",telemetryEmitter:"function"},v=Object.keys(h).reduce((function(o,s){return t[s]?o:o.concat([s+" ("+h[s]+")"])}),[]);return new ClientConfigurationError(s,l+" mising values: "+v.join(","))},ClientConfigurationError.createSsoSilentError=function(){return new ClientConfigurationError(IF.code,IF.desc)},ClientConfigurationError.createInvalidAuthorityMetadataError=function(){return new ClientConfigurationError(AF.code,AF.desc)},ClientConfigurationError}(dF),RF=function(){function ScopeSet(){}return ScopeSet.isIntersectingScopes=function(t,o){for(var s=this.trimAndConvertArrayToLowerCase(__spreadArrays$1(t)),l=this.trimAndConvertArrayToLowerCase(__spreadArrays$1(o)),h=0;h<l.length;h++)if(s.indexOf(l[h].toLowerCase())>-1)return!0;return!1},ScopeSet.containsScope=function(t,o){var s=this.trimAndConvertArrayToLowerCase(__spreadArrays$1(t));return this.trimAndConvertArrayToLowerCase(__spreadArrays$1(o)).every((function(t){return s.indexOf(t.toString().toLowerCase())>=0}))},ScopeSet.trimAndConvertToLowerCase=function(t){return t.trim().toLowerCase()},ScopeSet.trimAndConvertArrayToLowerCase=function(t){var o=this;return t.map((function(t){return o.trimAndConvertToLowerCase(t)}))},ScopeSet.trimScopes=function(t){return t.map((function(t){return t.trim()}))},ScopeSet.removeElement=function(t,o){var s=this.trimAndConvertToLowerCase(o);return t.filter((function(t){return t!==s}))},ScopeSet.parseScope=function(t){var o="";if(t)for(var s=0;s<t.length;++s)o+=s!==t.length-1?t[s]+" ":t[s];return o},ScopeSet.validateInputScope=function(t,o){if(t){if(!Array.isArray(t))throw PF.createScopesNonArrayError(t);if(t.length<1&&o)throw PF.createEmptyScopesArrayError(t.toString())}else if(o)throw PF.createScopesRequiredError(t)},ScopeSet.getScopeFromState=function(t){if(t){var o=t.indexOf(TL.resourceDelimiter);if(o>-1&&o+1<t.length)return t.substring(o+1)}return""},ScopeSet.appendScopes=function(t,o){if(t){var s=o?this.trimAndConvertArrayToLowerCase(__spreadArrays$1(o)):null,l=this.trimAndConvertArrayToLowerCase(__spreadArrays$1(t));return s?__spreadArrays$1(l,s):l}return null},ScopeSet.onlyContainsOidcScopes=function(t){var o=t.length,s=0;return t.indexOf(TL.openidScope)>-1&&(s+=1),t.indexOf(TL.profileScope)>-1&&(s+=1),o>0&&o===s},ScopeSet.containsAnyOidcScopes=function(t){var o=t.indexOf(TL.openidScope)>-1,s=t.indexOf(TL.profileScope)>-1;return o||s},ScopeSet.onlyContainsClientId=function(t,o){return!!t&&t.indexOf(o)>-1&&1===t.length},ScopeSet.appendDefaultScopes=function(t){var o=t;return-1===o.indexOf(TL.openidScope)&&o.push(TL.openidScope),-1===o.indexOf(TL.profileScope)&&o.push(TL.profileScope),o},ScopeSet.removeDefaultScopes=function(t){return t.filter((function(t){return t!==TL.openidScope&&t!==TL.profileScope}))},ScopeSet.translateClientIdIfSingleScope=function(t,o){return this.onlyContainsClientId(t,o)?TL.oidcScopes:t},ScopeSet}(),OF=function(){function UrlUtils(){}return UrlUtils.createNavigateUrl=function(t){var o=this.createNavigationUrlString(t),s=t.authorityInstance.AuthorizationEndpoint;return s.indexOf("?")<0?s+="?":s+="&",""+s+o.join("&")},UrlUtils.createNavigationUrlString=function(t){var o=RF.appendDefaultScopes(t.scopes),s=[];return s.push("response_type="+t.responseType),s.push("scope="+encodeURIComponent(RF.parseScope(o))),s.push("client_id="+encodeURIComponent(t.clientId)),s.push("redirect_uri="+encodeURIComponent(t.redirectUri)),s.push("state="+encodeURIComponent(t.state)),s.push("nonce="+encodeURIComponent(t.nonce)),s.push("client_info=1"),s.push("x-client-SKU="+t.xClientSku),s.push("x-client-Ver="+t.xClientVer),t.promptValue&&s.push("prompt="+encodeURIComponent(t.promptValue)),t.claimsValue&&s.push("claims="+encodeURIComponent(t.claimsValue)),t.queryParameters&&s.push(t.queryParameters),t.extraQueryParameters&&s.push(t.extraQueryParameters),s.push("client-request-id="+encodeURIComponent(t.correlationId)),s},UrlUtils.getCurrentUrl=function(){return window.location.href.split("?")[0].split("#")[0]},UrlUtils.removeHashFromUrl=function(t){return t.split("#")[0]},UrlUtils.replaceTenantPath=function(t,o){var s=t.toLowerCase(),l=this.GetUrlComponents(s),h=l.PathSegments;return!o||0===h.length||h[0]!==TL.common&&h[0]!==OL.ORGANIZATIONS&&h[0]!==OL.CONSUMERS||(h[0]=o),this.constructAuthorityUriFromObject(l,h)},UrlUtils.constructAuthorityUriFromObject=function(t,o){return this.CanonicalizeUri(t.Protocol+"//"+t.HostNameAndPort+"/"+o.join("/"))},UrlUtils.isCommonAuthority=function(t){var o=this.CanonicalizeUri(t),s=this.GetUrlComponents(o).PathSegments;return 0!==s.length&&s[0]===TL.common},UrlUtils.isOrganizationsAuthority=function(t){var o=this.CanonicalizeUri(t),s=this.GetUrlComponents(o).PathSegments;return 0!==s.length&&s[0]===OL.ORGANIZATIONS},UrlUtils.isConsumersAuthority=function(t){var o=this.CanonicalizeUri(t),s=this.GetUrlComponents(o).PathSegments;return 0!==s.length&&s[0]===OL.CONSUMERS},UrlUtils.GetUrlComponents=function(t){if(!t)throw"Url required";var o=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),s=t.match(o);if(!s||s.length<6)throw"Valid url required";var l={Protocol:s[1],HostNameAndPort:s[4],AbsolutePath:s[5]},h=l.AbsolutePath.split("/");return h=h.filter((function(t){return t&&t.length>0})),l.PathSegments=h,s[6]&&(l.Search=s[6]),s[8]&&(l.Hash=s[8]),l},UrlUtils.CanonicalizeUri=function(t){if(t){var o=t.toLowerCase();return UrlUtils.endsWith(o,"/")||(o+="/"),o}return t},UrlUtils.endsWith=function(t,o){return!(!t||!o)&&-1!==t.indexOf(o,t.length-o.length)},UrlUtils.urlRemoveQueryStringParameter=function(t,o){if(jL.isEmpty(t))return t;var s=new RegExp("(\\&"+o+"=)[^&]+");return t.replace(s,""),s=new RegExp("("+o+"=)[^&]+&"),t.replace(s,""),s=new RegExp("("+o+"=)[^&]+"),t.replace(s,"")},UrlUtils.getHashFromUrl=function(t){var o=t.indexOf("#"),s=t.indexOf("#/");return s>-1?t.substring(s+2):o>-1?t.substring(o+1):t},UrlUtils.urlContainsHash=function(t){var o=UrlUtils.deserializeHash(t);return o.hasOwnProperty(CL.ERROR_DESCRIPTION)||o.hasOwnProperty(CL.ERROR)||o.hasOwnProperty(CL.ACCESS_TOKEN)||o.hasOwnProperty(CL.ID_TOKEN)},UrlUtils.deserializeHash=function(t){var o=UrlUtils.getHashFromUrl(t);return kL.deserialize(o)},UrlUtils.getHostFromUri=function(t){var o=String(t).replace(/^(https?:)\/\//,"");return o=o.split("/")[0]},UrlUtils}(),$F=function $F(t,o,s,l,h){this.authority=OF.CanonicalizeUri(t),this.clientId=o,this.scopes=s,this.homeAccountIdentifier=kL.base64Encode(l)+"."+kL.base64Encode(h)},NF=function NF(t,o,s,l){this.accessToken=t,this.idToken=o,this.expiresIn=s,this.homeAccountIdentifier=l},MF="1.4.17",DF=function(){function ServerRequestParameters(t,o,s,l,h,v,m){this.authorityInstance=t,this.clientId=o,this.nonce=kL.createNewGuid(),this.scopes=h?__spreadArrays$1(h):TL.oidcScopes,this.scopes=RF.trimScopes(this.scopes),this.state=v,this.correlationId=m,this.xClientSku="MSAL.JS",this.xClientVer=MF,this.responseType=s,this.redirectUri=l}return Object.defineProperty(ServerRequestParameters.prototype,"authority",{get:function(){return this.authorityInstance?this.authorityInstance.CanonicalAuthority:null},enumerable:!1,configurable:!0}),ServerRequestParameters.prototype.populateQueryParams=function(t,o,s,l){var h={};o&&(o.prompt&&(this.promptValue=o.prompt),o.claimsRequest&&(this.claimsValue=o.claimsRequest),ServerRequestParameters.isSSOParam(o)&&(h=this.constructUnifiedCacheQueryParameter(o,null))),s&&(h=this.constructUnifiedCacheQueryParameter(null,s)),h=this.addHintParameters(t,h);var v=o?o.extraQueryParameters:null;this.queryParameters=ServerRequestParameters.generateQueryParametersString(h),this.extraQueryParameters=ServerRequestParameters.generateQueryParametersString(v,l)},ServerRequestParameters.prototype.constructUnifiedCacheQueryParameter=function(t,o){var s,l,h;if(t)if(t.account){var v=t.account;(null===(s=v.idTokenClaims)||void 0===s?void 0:s.login_hint)?(l=OL.LOGIN_HINT,h=v.idTokenClaims.login_hint):v.sid?(l=OL.SID,h=v.sid):v.userName&&(l=OL.LOGIN_HINT,h=v.userName)}else t.sid?(l=OL.SID,h=t.sid):t.loginHint&&(l=OL.LOGIN_HINT,h=t.loginHint);else o&&o.hasOwnProperty(TL.upn)&&(l=OL.ID_TOKEN,h=o.upn);return this.addSSOParameter(l,h)},ServerRequestParameters.prototype.addHintParameters=function(t,o){var s,l,h=o;return t&&(h[OL.SID]||h[OL.LOGIN_HINT]||((null===(s=t.idTokenClaims)||void 0===s?void 0:s.login_hint)?h=this.addSSOParameter(OL.LOGIN_HINT,null===(l=t.idTokenClaims)||void 0===l?void 0:l.login_hint,h):t.sid&&this.promptValue===LL.NONE?h=this.addSSOParameter(OL.SID,t.sid,h):t.userName&&(h=this.addSSOParameter(OL.LOGIN_HINT,t.userName,h)))),h},ServerRequestParameters.prototype.addSSOParameter=function(t,o,s){var l=s||{};if(!o)return l;switch(t){case OL.SID:l[OL.SID]=o;break;case OL.ID_TOKEN:case OL.LOGIN_HINT:l[OL.LOGIN_HINT]=o}return l},ServerRequestParameters.generateQueryParametersString=function(t,o){var s=null;return t&&Object.keys(t).forEach((function(l){l===TL.domain_hint&&(o||t[OL.SID])||(s?s+="&"+l+"="+encodeURIComponent(t[l]):s=l+"="+encodeURIComponent(t[l]))})),s},ServerRequestParameters.isSSOParam=function(t){return!(!t||!(t.account||t.sid||t.loginHint))},ServerRequestParameters.determineResponseType=function(t,o){return RF.onlyContainsOidcScopes(o)?AL:t?this.responseTypeForMatchingAccounts(o):RL},ServerRequestParameters.responseTypeForMatchingAccounts=function(t){return RF.containsAnyOidcScopes(t)?RL:PL},ServerRequestParameters}(),LF=function(){function XhrClient(){}return XhrClient.prototype.sendRequestAsync=function(t,o,s){var l=this;return new Promise((function(s,h){var v=new XMLHttpRequest;if(v.open(o,t,!0),v.onload=function(){var t;(v.status<200||v.status>=300)&&h(l.handleError(v.responseText));try{t=JSON.parse(v.responseText)}catch(t){h(l.handleError(v.responseText))}var o={statusCode:v.status,body:t};s(o)},v.onerror=function(){h(v.status)},o!==DL)throw"not implemented";v.send()}))},XhrClient.prototype.handleError=function(t){var o;try{if((o=JSON.parse(t)).error)return o.error;throw t}catch(o){return t}},XhrClient}(),FF=function(){function TrustedAuthority(){}return TrustedAuthority.setTrustedAuthoritiesFromConfig=function(t,o){t&&!this.getTrustedHostList().length&&o.forEach((function(t){TrustedAuthority.TrustedHostList.push(t.toLowerCase())}))},TrustedAuthority.getAliases=function(t,o,s){return __awaiter$8(this,void 0,void 0,(function(){var l,h,v,m;return __generator$2(this,(function(_){return l=new LF,h=DL,v="https://login.microsoftonline.com/common//discovery/instance?api-version=1.1&authorization_endpoint="+t+"oauth2/v2.0/authorize",m=o.createAndStartHttpEvent(s,h,v,"getAliases"),[2,l.sendRequestAsync(v,h,!0).then((function(t){return m.httpResponseStatus=t.statusCode,o.stopEvent(m),t.body.metadata})).catch((function(t){throw m.serverErrorCode=t,o.stopEvent(m),t}))]}))}))},TrustedAuthority.setTrustedAuthoritiesFromNetwork=function(t,o,s){return __awaiter$8(this,void 0,void 0,(function(){var l;return __generator$2(this,(function(h){switch(h.label){case 0:return[4,this.getAliases(t,o,s)];case 1:return h.sent().forEach((function(t){t.aliases.forEach((function(t){TrustedAuthority.TrustedHostList.push(t.toLowerCase())}))})),l=OF.GetUrlComponents(t).HostNameAndPort,TrustedAuthority.getTrustedHostList().length&&!TrustedAuthority.IsInTrustedHostList(l)&&TrustedAuthority.TrustedHostList.push(l.toLowerCase()),[2]}}))}))},TrustedAuthority.getTrustedHostList=function(){return this.TrustedHostList},TrustedAuthority.IsInTrustedHostList=function(t){return this.TrustedHostList.indexOf(t.toLowerCase())>-1},TrustedAuthority.TrustedHostList=[],TrustedAuthority}();!function(t){t[t.Default=0]="Default",t[t.Adfs=1]="Adfs"}(NL||(NL={}));var UF,HF=function(){function Authority(t,o,s){this.IsValidationEnabled=o,this.CanonicalAuthority=t,this.validateAsUri(),this.tenantDiscoveryResponse=s}return Authority.isAdfs=function(t){var o=OF.GetUrlComponents(t).PathSegments;return o.length&&o[0].toLowerCase()===TL.ADFS},Object.defineProperty(Authority.prototype,"AuthorityType",{get:function(){return Authority.isAdfs(this.canonicalAuthority)?NL.Adfs:NL.Default},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"Tenant",{get:function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"AuthorizationEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"EndSessionEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"SelfSignedJwtAudience",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!1,configurable:!0}),Authority.prototype.validateResolved=function(){if(!this.hasCachedMetadata())throw"Please call ResolveEndpointsAsync first"},Object.defineProperty(Authority.prototype,"CanonicalAuthority",{get:function(){return this.canonicalAuthority},set:function(t){this.canonicalAuthority=OF.CanonicalizeUri(t),this.canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"CanonicalAuthorityUrlComponents",{get:function(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=OF.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function(){return this.AuthorityType===NL.Adfs?""+this.CanonicalAuthority+$L:this.CanonicalAuthority+"v2.0/"+$L},enumerable:!1,configurable:!0}),Authority.prototype.validateAsUri=function(){var t;try{t=this.CanonicalAuthorityUrlComponents}catch(t){throw yF}if(!t.Protocol||"https:"!==t.Protocol.toLowerCase())throw wF;if(!t.PathSegments||t.PathSegments.length<1)throw _F},Authority.prototype.DiscoverEndpoints=function(t,o,s){var l=new LF,h=DL,v=o.createAndStartHttpEvent(s,h,t,"openIdConfigurationEndpoint");return l.sendRequestAsync(t,h,!0).then((function(t){return v.httpResponseStatus=t.statusCode,o.stopEvent(v),{AuthorizationEndpoint:t.body.authorization_endpoint,EndSessionEndpoint:t.body.end_session_endpoint,Issuer:t.body.issuer}})).catch((function(t){throw v.serverErrorCode=t,o.stopEvent(v),t}))},Authority.prototype.resolveEndpointsAsync=function(t,o){return __awaiter$8(this,void 0,void 0,(function(){var s,l,h;return __generator$2(this,(function(v){switch(v.label){case 0:return this.IsValidationEnabled?(s=this.canonicalAuthorityUrlComponents.HostNameAndPort,0!==FF.getTrustedHostList().length?[3,2]:[4,FF.setTrustedAuthoritiesFromNetwork(this.canonicalAuthority,t,o)]):[3,3];case 1:v.sent(),v.label=2;case 2:if(!FF.IsInTrustedHostList(s))throw PF.createUntrustedAuthorityError(s);v.label=3;case 3:return l=this.GetOpenIdConfigurationEndpoint(),h=this,[4,this.DiscoverEndpoints(l,t,o)];case 4:return h.tenantDiscoveryResponse=v.sent(),[2,this.tenantDiscoveryResponse]}}))}))},Authority.prototype.hasCachedMetadata=function(){return!!(this.tenantDiscoveryResponse&&this.tenantDiscoveryResponse.AuthorizationEndpoint&&this.tenantDiscoveryResponse.EndSessionEndpoint&&this.tenantDiscoveryResponse.Issuer)},Authority.prototype.GetOpenIdConfigurationEndpoint=function(){return this.DefaultOpenIdConfigurationEndpoint},Authority}(),BF=function(){function ClientInfo(t,o){if(!t||jL.isEmpty(t))return this.uid="",void(this.utid="");try{var s=kL.base64Decode(t),l=JSON.parse(s);l&&(l.hasOwnProperty("uid")&&(this.uid=o?ClientInfo.stripPolicyFromUid(l.uid,o):l.uid),l.hasOwnProperty("utid")&&(this.utid=l.utid))}catch(t){throw dF.createClientInfoDecodingError(t)}}return Object.defineProperty(ClientInfo.prototype,"uid",{get:function(){return this._uid?this._uid:""},set:function(t){this._uid=t},enumerable:!1,configurable:!0}),Object.defineProperty(ClientInfo.prototype,"utid",{get:function(){return this._utid?this._utid:""},set:function(t){this._utid=t},enumerable:!1,configurable:!0}),ClientInfo.createClientInfoFromIdToken=function(t,o){var s={uid:t.subject,utid:""};return new ClientInfo(kL.base64Encode(JSON.stringify(s)),o)},ClientInfo.stripPolicyFromUid=function(t,o){var s=t.split("-"),l=o.split("/").reverse(),h="";return jL.isEmpty(l[0])?l.length>1&&(h=l[1]):h=l[0],s[s.length-1]===h?s.slice(0,s.length-1).join("-"):t},ClientInfo.prototype.encodeClientInfo=function(){var t=JSON.stringify({uid:this.uid,utid:this.utid});return kL.base64Encode(t)},ClientInfo}(),qF=function(){function TimeUtils(){}return TimeUtils.parseExpiresIn=function(t){return parseInt(t||"3599",10)},TimeUtils.now=function(){return Math.round((new Date).getTime()/1e3)},TimeUtils.relativeNowMs=function(){return window.performance.now()},TimeUtils}(),jF=function(){function TokenUtils(){}return TokenUtils.decodeJwt=function(t){if(jL.isEmpty(t))return null;var o=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);return!o||o.length<4?null:{header:o[1],JWSPayload:o[2],JWSSig:o[3]}},TokenUtils.validateExpirationIsWithinOffset=function(t,o){var s=o||300;return t&&t>qF.now()+s},TokenUtils.extractIdToken=function(t){var o=this.decodeJwt(t);if(!o)return null;try{var s=o.JWSPayload,l=kL.base64Decode(s);return l?JSON.parse(l):null}catch(t){}return null},TokenUtils}(),zF=function zF(t){if(jL.isEmpty(t))throw dF.createIdTokenNullOrEmptyError(t);try{this.rawIdToken=t,this.claims=jF.extractIdToken(t),this.claims&&(this.claims.hasOwnProperty("iss")&&(this.issuer=this.claims.iss),this.claims.hasOwnProperty("oid")&&(this.objectId=this.claims.oid),this.claims.hasOwnProperty("sub")&&(this.subject=this.claims.sub),this.claims.hasOwnProperty("tid")&&(this.tenantId=this.claims.tid),this.claims.hasOwnProperty("ver")&&(this.version=this.claims.ver),this.claims.hasOwnProperty("preferred_username")?this.preferredName=this.claims.preferred_username:this.claims.hasOwnProperty("upn")&&(this.preferredName=this.claims.upn),this.claims.hasOwnProperty("name")&&(this.name=this.claims.name),this.claims.hasOwnProperty("nonce")&&(this.nonce=this.claims.nonce),this.claims.hasOwnProperty("exp")&&(this.expiration=this.claims.exp),this.claims.hasOwnProperty("home_oid")&&(this.homeObjectId=this.claims.home_oid),this.claims.hasOwnProperty("sid")&&(this.sid=this.claims.sid),this.claims.hasOwnProperty("cloud_instance_host_name")&&(this.cloudInstance=this.claims.cloud_instance_host_name))}catch(t){throw dF.createIdTokenParsingError(t)}},VF=function VF(t,o){this.key=t,this.value=o},GF=function(){function BrowserStorage(t){if(!window)throw qL.createNoWindowObjectError("Browser storage class could not find window object");if(!(void 0!==window[t]&&null!==window[t]))throw PF.createStorageNotSupportedError(t);this.cacheLocation=t}return BrowserStorage.prototype.setItem=function(t,o,s){window[this.cacheLocation].setItem(t,o),s&&this.setItemCookie(t,o)},BrowserStorage.prototype.getItem=function(t,o){return o&&this.getItemCookie(t)?this.getItemCookie(t):window[this.cacheLocation].getItem(t)},BrowserStorage.prototype.removeItem=function(t){return window[this.cacheLocation].removeItem(t)},BrowserStorage.prototype.clear=function(){return window[this.cacheLocation].clear()},BrowserStorage.prototype.setItemCookie=function(t,o,s){var l=encodeURIComponent(t)+"="+encodeURIComponent(o)+";path=/;";s&&(l+="expires="+this.getCookieExpirationTime(s)+";");document.cookie=l},BrowserStorage.prototype.getItemCookie=function(t){for(var o=encodeURIComponent(t)+"=",s=document.cookie.split(";"),l=0;l<s.length;l++){for(var h=s[l];" "===h.charAt(0);)h=h.substring(1);if(0===h.indexOf(o))return decodeURIComponent(h.substring(o.length,h.length))}return""},BrowserStorage.prototype.clearItemCookie=function(t){this.setItemCookie(t,"",-1)},BrowserStorage.prototype.getCookieExpirationTime=function(t){var o=new Date;return new Date(o.getTime()+24*t*60*60*1e3).toUTCString()},BrowserStorage}(),KF=function(){function RequestUtils(){}return RequestUtils.validateRequest=function(t,o,s,l){if(!o&&!t)throw PF.createEmptyRequestError();var h,v;t&&(h=o?RF.appendScopes(t.scopes,t.extraScopesToConsent):t.scopes,RF.validateInputScope(h,!o),h=RF.translateClientIdIfSingleScope(h,s),this.validatePromptParameter(t.prompt),v=this.validateEQParameters(t.extraQueryParameters,t.claimsRequest),this.validateClaimsRequest(t.claimsRequest));var m=this.validateAndGenerateState(t&&t.state,l),_=this.validateAndGenerateCorrelationId(t&&t.correlationId);return __assign$2(__assign$2({},t),{extraQueryParameters:v,scopes:h,state:m,correlationId:_})},RequestUtils.validatePromptParameter=function(t){if(t&&[LL.LOGIN,LL.SELECT_ACCOUNT,LL.CONSENT,LL.NONE].indexOf(t)<0)throw PF.createInvalidPromptError(t)},RequestUtils.validateEQParameters=function(t,o){var s=__assign$2({},t);return s?(o&&delete s[TL.claims],ML.forEach((function(t){s[t]&&delete s[t]})),s):null},RequestUtils.validateClaimsRequest=function(t){if(t)try{JSON.parse(t)}catch(t){throw PF.createClaimsRequestParsingError(t)}},RequestUtils.validateAndGenerateState=function(t,o){return jL.isEmpty(t)?RequestUtils.generateLibraryState(o):""+RequestUtils.generateLibraryState(o)+TL.resourceDelimiter+t},RequestUtils.generateLibraryState=function(t){var o={id:kL.createNewGuid(),ts:qF.now(),method:t},s=JSON.stringify(o);return kL.base64Encode(s)},RequestUtils.parseLibraryState=function(t){var o=decodeURIComponent(t).split(TL.resourceDelimiter)[0];if(kL.isGuid(o))return{id:o,ts:qF.now(),method:TL.interactionTypeRedirect};try{var s=kL.base64Decode(o);return JSON.parse(s)}catch(o){throw dF.createInvalidStateError(t,null)}},RequestUtils.validateAndGenerateCorrelationId=function(t){if(t&&!kL.isGuid(t))throw PF.createInvalidCorrelationIdError();return kL.isGuid(t)?t:kL.createNewGuid()},RequestUtils.createRequestSignature=function(t){return""+t.scopes.join(" ").toLowerCase()+TL.resourceDelimiter+t.authority},RequestUtils}(),WF=function(t){function AuthCache(o,s,l){var h=t.call(this,s)||this;return h.temporaryCache=new GF(SL),h.clientId=o,h.rollbackEnabled=!0,h.migrateCacheEntries(l),h}return __extends$2(AuthCache,t),AuthCache.prototype.migrateCacheEntries=function(o){var s,l=this,h=TL.cachePrefix+"."+EL.IDTOKEN,v=TL.cachePrefix+"."+EL.CLIENT_INFO,m=TL.cachePrefix+"."+IL.ERROR,_=TL.cachePrefix+"."+IL.ERROR_DESC,R=t.prototype.getItem.call(this,h);if(R)try{s=new zF(R)}catch(t){return}if(s&&s.claims&&s.claims.aud===this.clientId){var $=[R,t.prototype.getItem.call(this,v),t.prototype.getItem.call(this,m),t.prototype.getItem.call(this,_)];[EL.IDTOKEN,EL.CLIENT_INFO,IL.ERROR,IL.ERROR_DESC].forEach((function(t,s){return l.duplicateCacheEntry(t,$[s],o)}))}},AuthCache.prototype.duplicateCacheEntry=function(t,o,s){o&&this.setItem(t,o,s)},AuthCache.prototype.generateCacheKey=function(t,o){try{return JSON.parse(t),t}catch(s){return 0===t.indexOf(""+TL.cachePrefix)||0===t.indexOf(TL.adalIdToken)?t:o?TL.cachePrefix+"."+this.clientId+"."+t:TL.cachePrefix+"."+t}},AuthCache.prototype.matchKeyForType=function(t,o,s,l){var h=jL.validateAndParseJsonCacheKey(t);if(!h)return null;var v=t.match(o)&&t.match(s),m=!1;switch(l){case CL.ACCESS_TOKEN:m=!!t.match(TL.scopes);break;case CL.ID_TOKEN:m=!t.match(TL.scopes)}return v&&m?h:null},AuthCache.prototype.setItem=function(o,s,l){t.prototype.setItem.call(this,this.generateCacheKey(o,!0),s,l),this.rollbackEnabled&&!l&&t.prototype.setItem.call(this,this.generateCacheKey(o,!1),s,l)},AuthCache.prototype.getItem=function(o,s){return t.prototype.getItem.call(this,this.generateCacheKey(o,!0),s)},AuthCache.prototype.removeItem=function(o){this.temporaryCache.removeItem(this.generateCacheKey(o,!0)),t.prototype.removeItem.call(this,this.generateCacheKey(o,!0)),this.rollbackEnabled&&t.prototype.removeItem.call(this,this.generateCacheKey(o,!1))},AuthCache.prototype.setTemporaryItem=function(t,o,s){this.temporaryCache.setItem(this.generateCacheKey(t,!0),o,s)},AuthCache.prototype.getTemporaryItem=function(t,o){return this.temporaryCache.getItem(this.generateCacheKey(t,!0),o)},AuthCache.prototype.resetCacheItems=function(){var o,s=window[this.cacheLocation];for(o in s)s.hasOwnProperty(o)&&-1!==o.indexOf(TL.cachePrefix)&&t.prototype.removeItem.call(this,o)},AuthCache.prototype.resetTempCacheItems=function(o){var s=this,l=o&&KF.parseLibraryState(o).id,h=this.tokenRenewalInProgress(o),v=window[this.cacheLocation];l&&!h&&Object.keys(v).forEach((function(o){-1!==o.indexOf(l)&&(s.removeItem(o),t.prototype.clearItemCookie.call(s,o))})),this.setInteractionInProgress(!1),this.removeItem(xL.REDIRECT_REQUEST)},AuthCache.prototype.setItemCookie=function(o,s,l){t.prototype.setItemCookie.call(this,this.generateCacheKey(o,!0),s,l),this.rollbackEnabled&&t.prototype.setItemCookie.call(this,this.generateCacheKey(o,!1),s,l)},AuthCache.prototype.clearItemCookie=function(o){t.prototype.clearItemCookie.call(this,this.generateCacheKey(o,!0)),this.rollbackEnabled&&t.prototype.clearItemCookie.call(this,this.generateCacheKey(o,!1))},AuthCache.prototype.getItemCookie=function(o){return t.prototype.getItemCookie.call(this,this.generateCacheKey(o,!0))},AuthCache.prototype.getAllTokensByType=function(t,o,s){var l=this,h=Object.keys(window[this.cacheLocation]).reduce((function(h,v){var m=l.matchKeyForType(v,t,o,s);if(m){var _=l.getItem(v);if(_)try{var R=new VF(m,JSON.parse(_));return h.concat([R])}catch(t){return h}}return h}),[]);return h},AuthCache.prototype.getAllAccessTokens=function(t,o){return this.getAllTokensByType(t,o,CL.ACCESS_TOKEN)},AuthCache.prototype.getAllIdTokens=function(t,o){return this.getAllTokensByType(t,o,CL.ID_TOKEN)},AuthCache.prototype.getAllTokens=function(t,o){return __spreadArrays$1(this.getAllAccessTokens(t,o),this.getAllIdTokens(t,o))},AuthCache.prototype.isInteractionInProgress=function(t){var o=this.getInteractionInProgress();return t?o===this.clientId:!!o},AuthCache.prototype.getInteractionInProgress=function(){return this.getTemporaryItem(this.generateCacheKey(xL.INTERACTION_STATUS,!1))},AuthCache.prototype.setInteractionInProgress=function(t){if(t){if(this.isInteractionInProgress(!1))throw dF.createAcquireTokenInProgressError();this.setTemporaryItem(this.generateCacheKey(xL.INTERACTION_STATUS,!1),this.clientId)}else!t&&this.isInteractionInProgress(!0)&&this.removeItem(this.generateCacheKey(xL.INTERACTION_STATUS,!1))},AuthCache.prototype.tokenRenewalInProgress=function(t){var o=this.getItem(AuthCache.generateTemporaryCacheKey(xL.RENEW_STATUS,t));return!(!o||o!==TL.inProgress)},AuthCache.prototype.clearMsalCookie=function(o){var s=this;o?(this.clearItemCookie(AuthCache.generateTemporaryCacheKey(xL.NONCE_IDTOKEN,o)),this.clearItemCookie(AuthCache.generateTemporaryCacheKey(xL.STATE_LOGIN,o)),this.clearItemCookie(AuthCache.generateTemporaryCacheKey(xL.LOGIN_REQUEST,o)),this.clearItemCookie(AuthCache.generateTemporaryCacheKey(xL.STATE_ACQ_TOKEN,o))):document.cookie.split(";").forEach((function(o){var l=o.trim().split("=")[0];l.indexOf(TL.cachePrefix)>-1&&t.prototype.clearItemCookie.call(s,l)}))},AuthCache.generateAcquireTokenAccountKey=function(t,o){var s=KF.parseLibraryState(o).id;return""+xL.ACQUIRE_TOKEN_ACCOUNT+TL.resourceDelimiter+t+TL.resourceDelimiter+s},AuthCache.generateAuthorityKey=function(t){return AuthCache.generateTemporaryCacheKey(xL.AUTHORITY,t)},AuthCache.generateTemporaryCacheKey=function(t,o){var s=KF.parseLibraryState(o).id;return""+t+TL.resourceDelimiter+s},AuthCache}(GF),QF=function(){function Account(t,o,s,l,h,v,m){this.accountIdentifier=t,this.homeAccountIdentifier=o,this.userName=s,this.name=l,this.idToken=h,this.idTokenClaims=h,this.sid=v,this.environment=m}return Account.createAccount=function(t,o){var s,l=t.objectId||t.subject,h=o?o.uid:"",v=o?o.utid:"";return jL.isEmpty(h)||(s=jL.isEmpty(v)?kL.base64Encode(h):kL.base64Encode(h)+"."+kL.base64Encode(v)),new Account(l,s,t.preferredName,t.name,t.claims,t.sid,t.issuer)},Account.compareAccounts=function(t,o){return!(!t||!o)&&!(!t.homeAccountIdentifier||!o.homeAccountIdentifier||t.homeAccountIdentifier!==o.homeAccountIdentifier)},Account}(),YF=function(){function WindowUtils(){}return WindowUtils.isInIframe=function(){return window.parent!==window},WindowUtils.isInPopup=function(){return!(!window.opener||window.opener===window)},WindowUtils.generateFrameName=function(t,o){return""+t+TL.resourceDelimiter+o},WindowUtils.monitorIframeForHash=function(t,o,s,l){return new Promise((function(h,v){var m=qF.relativeNowMs()+o;l.verbose("monitorWindowForIframe polling started");var _=setInterval((function(){if(qF.relativeNowMs()>m)return l.error("monitorIframeForHash unable to find hash in url, timing out"),l.errorPii("monitorIframeForHash polling timed out for url: "+s),clearInterval(_),void v(dF.createTokenRenewalTimeoutError());var o;try{o=t.location.href}catch(t){}o&&OF.urlContainsHash(o)&&(l.verbose("monitorIframeForHash found url in hash"),clearInterval(_),h(t.location.hash))}),WindowUtils.POLLING_INTERVAL_MS)}))},WindowUtils.monitorPopupForHash=function(t,o,s,l){return new Promise((function(h,v){var m=o/WindowUtils.POLLING_INTERVAL_MS,_=0;l.verbose("monitorWindowForHash polling started");var R=setInterval((function(){if(t.closed)return l.error("monitorWindowForHash window closed"),clearInterval(R),void v(dF.createUserCancelledError());var o;try{o=t.location.href}catch(t){}if(o&&"about:blank"!==o)if(_++,o&&OF.urlContainsHash(o)){l.verbose("monitorPopupForHash found url in hash"),clearInterval(R);var $=t.location.hash;WindowUtils.clearUrlFragment(t),h($)}else _>m&&(l.error("monitorPopupForHash unable to find hash in url, timing out"),l.errorPii("monitorPopupForHash polling timed out for url: "+s),clearInterval(R),v(dF.createTokenRenewalTimeoutError()))}),WindowUtils.POLLING_INTERVAL_MS)}))},WindowUtils.loadFrame=function(t,o,s,l){var h=this;return l.infoPii("LoadFrame: "+o),new Promise((function(v,m){setTimeout((function(){var s=h.loadFrameSync(t,o,l);s?v(s):m("Unable to load iframe with name: "+o)}),s)}))},WindowUtils.loadFrameSync=function(t,o,s){var l=WindowUtils.addHiddenIFrame(o,s);return l?(""!==l.src&&"about:blank"!==l.src||(l.src=t,s.infoPii("Frame Name : "+o+" Navigated to: "+t)),l):null},WindowUtils.addHiddenIFrame=function(t,o){if(void 0===t)return null;o.info("Add msal iframe to document"),o.infoPii("Add msal frame to document:"+t);var s=document.getElementById(t);if(s)o.verbose("Add msal iframe already exists");else{o.verbose("Add msal iframe does not exist");var l=document.createElement("iframe");l.setAttribute("id",t),l.setAttribute("aria-hidden","true"),l.style.visibility="hidden",l.style.position="absolute",l.style.width=l.style.height="0",l.style.border="0",l.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),s=document.getElementsByTagName("body")[0].appendChild(l)}return s},WindowUtils.removeHiddenIframe=function(t){document.body===t.parentNode&&document.body.removeChild(t)},WindowUtils.getIframeWithHash=function(t){var o=document.getElementsByTagName("iframe"),s=Array.apply(null,Array(o.length)).map((function(t,s){return o.item(s)}));return s.filter((function(o){try{return o.contentWindow.location.hash===t}catch(t){return!1}}))[0]},WindowUtils.getPopups=function(){return window.openedWindows||(window.openedWindows=[]),window.openedWindows},WindowUtils.getPopUpWithHash=function(t){return WindowUtils.getPopups().filter((function(o){try{return o.location.hash===t}catch(t){return!1}}))[0]},WindowUtils.trackPopup=function(t){WindowUtils.getPopups().push(t)},WindowUtils.closePopups=function(){WindowUtils.getPopups().forEach((function(t){return t.close()}))},WindowUtils.blockReloadInHiddenIframes=function(){if(OF.urlContainsHash(window.location.hash)&&WindowUtils.isInIframe())throw dF.createBlockTokenRequestsInHiddenIframeError()},WindowUtils.checkIfBackButtonIsPressed=function(t){var o=t.getItem(xL.REDIRECT_REQUEST);if(o&&!OF.urlContainsHash(window.location.hash)){var s=o.split(TL.resourceDelimiter);s.shift();var l=s.length>0?s.join(TL.resourceDelimiter):null;t.resetTempCacheItems(l)}},WindowUtils.clearUrlFragment=function(t){t.location.hash="","function"==typeof t.history.replaceState&&t.history.replaceState(null,null,""+t.location.pathname+t.location.search)},WindowUtils.POLLING_INTERVAL_MS=50,WindowUtils}(),JF=function(){function ResponseUtils(){}return ResponseUtils.setResponseIdToken=function(t,o){if(!t)return null;if(!o)return t;var s=Number(o.expiration);return s&&!t.expiresOn&&(t.expiresOn=new Date(1e3*s)),__assign$2(__assign$2({},t),{idToken:o,idTokenClaims:o.claims,uniqueId:o.objectId||o.subject,tenantId:o.tenantId})},ResponseUtils.buildAuthResponse=function(t,o,s,l,h,v){switch(s.responseType){case AL:var m=__assign$2(__assign$2({},o),{tokenType:CL.ID_TOKEN,account:l,scopes:h,accountState:v});return(m=ResponseUtils.setResponseIdToken(m,t)).idToken?m:null;case RL:var _=ResponseUtils.setResponseIdToken(o,t);return _&&_.accessToken&&_.idToken?_:null;case PL:return ResponseUtils.setResponseIdToken(o,t);default:return null}},ResponseUtils}(),XF=function(){function AuthorityFactory(){}return AuthorityFactory.saveMetadataFromNetwork=function(t,o,s){return __awaiter$8(this,void 0,void 0,(function(){var l;return __generator$2(this,(function(h){switch(h.label){case 0:return[4,t.resolveEndpointsAsync(o,s)];case 1:return l=h.sent(),this.metadataMap.set(t.CanonicalAuthority,l),[2,l]}}))}))},AuthorityFactory.getMetadata=function(t){return this.metadataMap.get(t)},AuthorityFactory.saveMetadataFromConfig=function(t,o){try{if(o){var s=JSON.parse(o);if(!s.authorization_endpoint||!s.end_session_endpoint||!s.issuer)throw PF.createInvalidAuthorityMetadataError();this.metadataMap.set(t,{AuthorizationEndpoint:s.authorization_endpoint,EndSessionEndpoint:s.end_session_endpoint,Issuer:s.issuer})}}catch(t){throw PF.createInvalidAuthorityMetadataError()}},AuthorityFactory.CreateInstance=function(t,o,s){return jL.isEmpty(t)?null:(s&&this.saveMetadataFromConfig(t,s),new HF(t,o,this.metadataMap.get(t)))},AuthorityFactory.metadataMap=new Map,AuthorityFactory}();!function(t){t[t.Error=0]="Error",t[t.Warning=1]="Warning",t[t.Info=2]="Info",t[t.Verbose=3]="Verbose"}(UF||(UF={}));var ZF=function(){function Logger(t,o){void 0===o&&(o={}),this.level=UF.Info;var s=o.correlationId,l=void 0===s?"":s,h=o.level,v=void 0===h?UF.Info:h,m=o.piiLoggingEnabled,_=void 0!==m&&m;this.localCallback=t,this.correlationId=l,this.level=v,this.piiLoggingEnabled=_}return Logger.prototype.logMessage=function(t,o,s){if(!(t>this.level||!this.piiLoggingEnabled&&s)){var l,h=(new Date).toUTCString();l=jL.isEmpty(this.correlationId)?h+":"+MF+"-"+UF[t]+(s?"-pii":"")+" "+o:h+":"+this.correlationId+"-"+MF+"-"+UF[t]+(s?"-pii":"")+" "+o,this.executeCallback(t,l,s)}},Logger.prototype.executeCallback=function(t,o,s){this.localCallback&&this.localCallback(t,o,s)},Logger.prototype.error=function(t){this.logMessage(UF.Error,t,!1)},Logger.prototype.errorPii=function(t){this.logMessage(UF.Error,t,!0)},Logger.prototype.warning=function(t){this.logMessage(UF.Warning,t,!1)},Logger.prototype.warningPii=function(t){this.logMessage(UF.Warning,t,!0)},Logger.prototype.info=function(t){this.logMessage(UF.Info,t,!1)},Logger.prototype.infoPii=function(t){this.logMessage(UF.Info,t,!0)},Logger.prototype.verbose=function(t){this.logMessage(UF.Verbose,t,!1)},Logger.prototype.verbosePii=function(t){this.logMessage(UF.Verbose,t,!0)},Logger.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled},Logger}(),eU={clientId:"",authority:null,validateAuthority:!0,authorityMetadata:"",knownAuthorities:[],redirectUri:function(){return OF.getCurrentUrl()},postLogoutRedirectUri:function(){return OF.getCurrentUrl()},navigateToLoginRequestUrl:!0},tU={cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},rU={logger:new ZF(null),loadFrameTimeout:6e3,tokenRenewalOffsetSeconds:300,navigateFrameWait:500},oU={isAngular:!1,unprotectedResources:new Array,protectedResourceMap:new Map};var nU={code:"server_unavailable",desc:"Server is temporarily unavailable."},iU={code:"unknown_server_error"},sU=function(t){function ServerError(o,s){var l=t.call(this,o,s)||this;return l.name="ServerError",Object.setPrototypeOf(l,ServerError.prototype),l}return __extends$2(ServerError,t),ServerError.createServerUnavailableError=function(){return new ServerError(nU.code,nU.desc)},ServerError.createUnknownServerError=function(t){return new ServerError(iU.code,t)},ServerError}(qL),aU={code:"interaction_required"},lU={code:"consent_required"},cU={code:"login_required"},dU=function(t){function InteractionRequiredAuthError(o,s){var l=t.call(this,o,s)||this;return l.name="InteractionRequiredAuthError",Object.setPrototypeOf(l,InteractionRequiredAuthError.prototype),l}return __extends$2(InteractionRequiredAuthError,t),InteractionRequiredAuthError.isInteractionRequiredError=function(t){var o=[aU.code,lU.code,cU.code];return t&&o.indexOf(t)>-1},InteractionRequiredAuthError.createLoginRequiredAuthError=function(t){return new InteractionRequiredAuthError(cU.code,t)},InteractionRequiredAuthError.createInteractionRequiredAuthError=function(t){return new InteractionRequiredAuthError(aU.code,t)},InteractionRequiredAuthError.createConsentRequiredAuthError=function(t){return new InteractionRequiredAuthError(lU.code,t)},InteractionRequiredAuthError}(sU);function buildResponseStateOnly(t){return{uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:"",scopes:null,expiresOn:null,account:null,accountState:t,fromCache:!1}}var uU,hU,pU,fU="event_name",gU="elapsed_time",vU={MsalCorrelationIdConstStrKey:"Microsoft.MSAL.correlation_id",ApiTelemIdConstStrKey:"msal.api_telem_id",ApiIdConstStrKey:"msal.api_id",BrokerAppConstStrKey:"Microsoft_MSAL_broker_app",CacheEventCountConstStrKey:"Microsoft_MSAL_cache_event_count",HttpEventCountTelemetryBatchKey:"Microsoft_MSAL_http_event_count",IdpConstStrKey:"Microsoft_MSAL_idp",IsSilentTelemetryBatchKey:"",IsSuccessfulConstStrKey:"Microsoft_MSAL_is_successful",ResponseTimeConstStrKey:"Microsoft_MSAL_response_time",TenantIdConstStrKey:"Microsoft_MSAL_tenant_id",UiEventCountTelemetryBatchKey:"Microsoft_MSAL_ui_event_count"},scrubTenantFromUri=function(t){var o=OF.GetUrlComponents(t);if(HF.isAdfs(t))return t;var s=o.PathSegments;if(s&&s.length>=2){var l="tfp"===s[1]?2:1;l<s.length&&(s[l]="<tenant>")}return o.Protocol+"//"+o.HostNameAndPort+"/"+s.join("/")},hashPersonalIdentifier=function(t){return kL.base64Encode(t)},prependEventNamePrefix=function(t){return"msal."+(t||"")},supportsBrowserPerformance=function(){return!!("undefined"!=typeof window&&"performance"in window&&window.performance.mark&&window.performance.measure)},mU=function(){function TelemetryEvent(t,o,s){var l;this.eventId=kL.createNewGuid(),this.label=s,this.event=((l={})[prependEventNamePrefix(fU)]=t,l[prependEventNamePrefix(gU)]=-1,l[""+vU.MsalCorrelationIdConstStrKey]=o,l)}return TelemetryEvent.prototype.setElapsedTime=function(t){this.event[prependEventNamePrefix(gU)]=t},TelemetryEvent.prototype.stop=function(){var t,o,s;this.setElapsedTime(+Date.now()-+this.startTimestamp),t=this.displayName,o=this.perfStartMark,s=this.perfEndMark,supportsBrowserPerformance()&&(window.performance.mark(s),window.performance.measure(t,o,s),window.performance.clearMeasures(t),window.performance.clearMarks(o),window.performance.clearMarks(s))},TelemetryEvent.prototype.start=function(){var t;this.startTimestamp=Date.now(),this.event[prependEventNamePrefix("start_time")]=this.startTimestamp,t=this.perfStartMark,supportsBrowserPerformance()&&window.performance.mark(t)},Object.defineProperty(TelemetryEvent.prototype,"telemetryCorrelationId",{get:function(){return this.event[""+vU.MsalCorrelationIdConstStrKey]},set:function(t){this.event[""+vU.MsalCorrelationIdConstStrKey]=t},enumerable:!1,configurable:!0}),Object.defineProperty(TelemetryEvent.prototype,"eventName",{get:function(){return this.event[prependEventNamePrefix(fU)]},enumerable:!1,configurable:!0}),TelemetryEvent.prototype.get=function(){return __assign$2(__assign$2({},this.event),{eventId:this.eventId})},Object.defineProperty(TelemetryEvent.prototype,"key",{get:function(){return this.telemetryCorrelationId+"_"+this.eventId+"-"+this.eventName},enumerable:!1,configurable:!0}),Object.defineProperty(TelemetryEvent.prototype,"displayName",{get:function(){return"Msal-"+this.label+"-"+this.telemetryCorrelationId},enumerable:!1,configurable:!0}),Object.defineProperty(TelemetryEvent.prototype,"perfStartMark",{get:function(){return"start-"+this.key},enumerable:!1,configurable:!0}),Object.defineProperty(TelemetryEvent.prototype,"perfEndMark",{get:function(){return"end-"+this.key},enumerable:!1,configurable:!0}),TelemetryEvent}(),bU=function(t){function DefaultEvent(o,s,l,h){var v=t.call(this,prependEventNamePrefix("default_event"),s,"DefaultEvent")||this;return v.event[prependEventNamePrefix("client_id")]=l,v.event[prependEventNamePrefix("sdk_plaform")]=o.sdk,v.event[prependEventNamePrefix("sdk_version")]=o.sdkVersion,v.event[prependEventNamePrefix("application_name")]=o.applicationName,v.event[prependEventNamePrefix("application_version")]=o.applicationVersion,v.event[prependEventNamePrefix("effective_connection_speed")]=o.networkInformation&&o.networkInformation.connectionSpeed,v.event[""+vU.UiEventCountTelemetryBatchKey]=v.getEventCount(prependEventNamePrefix("ui_event"),h),v.event[""+vU.HttpEventCountTelemetryBatchKey]=v.getEventCount(prependEventNamePrefix("http_event"),h),v.event[""+vU.CacheEventCountConstStrKey]=v.getEventCount(prependEventNamePrefix("cache_event"),h),v}return __extends$2(DefaultEvent,t),DefaultEvent.prototype.getEventCount=function(t,o){return o[t]?o[t]:0},DefaultEvent}(mU),yU=prependEventNamePrefix("authority"),wU=prependEventNamePrefix("authority_type"),_U=prependEventNamePrefix("ui_behavior"),CU=prependEventNamePrefix("tenant_id"),kU=prependEventNamePrefix("user_id"),TU=prependEventNamePrefix("was_successful"),SU=prependEventNamePrefix("api_error_code"),xU=prependEventNamePrefix("login_hint");!function(t){t[t.AcquireTokenRedirect=2001]="AcquireTokenRedirect",t[t.AcquireTokenSilent=2002]="AcquireTokenSilent",t[t.AcquireTokenPopup=2003]="AcquireTokenPopup",t[t.LoginRedirect=2004]="LoginRedirect",t[t.LoginPopup=2005]="LoginPopup",t[t.Logout=2006]="Logout"}(hU||(hU={})),function(t){t.AcquireTokenRedirect="AcquireTokenRedirect",t.AcquireTokenSilent="AcquireTokenSilent",t.AcquireTokenPopup="AcquireTokenPopup",t.LoginRedirect="LoginRedirect",t.LoginPopup="LoginPopup",t.Logout="Logout"}(pU||(pU={}));var EU=((uU={})[pU.AcquireTokenSilent]=hU.AcquireTokenSilent,uU[pU.AcquireTokenPopup]=hU.AcquireTokenPopup,uU[pU.AcquireTokenRedirect]=hU.AcquireTokenRedirect,uU[pU.LoginPopup]=hU.LoginPopup,uU[pU.LoginRedirect]=hU.LoginRedirect,uU[pU.Logout]=hU.Logout,uU),IU=function(t){function ApiEvent(o,s,l){var h=t.call(this,prependEventNamePrefix("api_event"),o,l)||this;return l&&(h.apiCode=EU[l],h.apiEventIdentifier=l),h.piiEnabled=s,h}return __extends$2(ApiEvent,t),Object.defineProperty(ApiEvent.prototype,"apiEventIdentifier",{set:function(t){this.event[vU.ApiTelemIdConstStrKey]=t},enumerable:!1,configurable:!0}),Object.defineProperty(ApiEvent.prototype,"apiCode",{set:function(t){this.event[vU.ApiIdConstStrKey]=t},enumerable:!1,configurable:!0}),Object.defineProperty(ApiEvent.prototype,"authority",{set:function(t){this.event[yU]=scrubTenantFromUri(t).toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(ApiEvent.prototype,"apiErrorCode",{set:function(t){this.event[SU]=t},enumerable:!1,configurable:!0}),Object.defineProperty(ApiEvent.prototype,"tenantId",{set:function(t){this.event[CU]=this.piiEnabled&&t?hashPersonalIdentifier(t):null},enumerable:!1,configurable:!0}),Object.defineProperty(ApiEvent.prototype,"accountId",{set:function(t){this.event[kU]=this.piiEnabled&&t?hashPersonalIdentifier(t):null},enumerable:!1,configurable:!0}),Object.defineProperty(ApiEvent.prototype,"wasSuccessful",{get:function(){return!0===this.event[TU]},set:function(t){this.event[TU]=t},enumerable:!1,configurable:!0}),Object.defineProperty(ApiEvent.prototype,"loginHint",{set:function(t){this.event[xU]=this.piiEnabled&&t?hashPersonalIdentifier(t):null},enumerable:!1,configurable:!0}),Object.defineProperty(ApiEvent.prototype,"authorityType",{set:function(t){this.event[wU]=t.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(ApiEvent.prototype,"promptType",{set:function(t){this.event[_U]=t.toLowerCase()},enumerable:!1,configurable:!0}),ApiEvent}(mU),AU=prependEventNamePrefix("http_path"),PU=prependEventNamePrefix("user_agent"),RU=prependEventNamePrefix("query_parameters"),OU=prependEventNamePrefix("api_version"),$U=prependEventNamePrefix("response_code"),NU=prependEventNamePrefix("oauth_error_code"),MU=prependEventNamePrefix("http_method"),DU=prependEventNamePrefix("request_id_header"),LU=prependEventNamePrefix("spe_info"),FU=prependEventNamePrefix("server_error_code"),UU=prependEventNamePrefix("server_sub_error_code"),HU=prependEventNamePrefix("url"),BU=function(t){function HttpEvent(o,s){return t.call(this,prependEventNamePrefix("http_event"),o,s)||this}return __extends$2(HttpEvent,t),Object.defineProperty(HttpEvent.prototype,"url",{set:function(t){var o=scrubTenantFromUri(t);this.event[HU]=o&&o.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(HttpEvent.prototype,"httpPath",{set:function(t){this.event[AU]=scrubTenantFromUri(t).toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(HttpEvent.prototype,"userAgent",{set:function(t){this.event[PU]=t},enumerable:!1,configurable:!0}),Object.defineProperty(HttpEvent.prototype,"queryParams",{set:function(t){this.event[RU]=DF.generateQueryParametersString(t)},enumerable:!1,configurable:!0}),Object.defineProperty(HttpEvent.prototype,"apiVersion",{set:function(t){this.event[OU]=t.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(HttpEvent.prototype,"httpResponseStatus",{set:function(t){this.event[$U]=t},enumerable:!1,configurable:!0}),Object.defineProperty(HttpEvent.prototype,"oAuthErrorCode",{set:function(t){this.event[NU]=t},enumerable:!1,configurable:!0}),Object.defineProperty(HttpEvent.prototype,"httpMethod",{set:function(t){this.event[MU]=t},enumerable:!1,configurable:!0}),Object.defineProperty(HttpEvent.prototype,"requestIdHeader",{set:function(t){this.event[DU]=t},enumerable:!1,configurable:!0}),Object.defineProperty(HttpEvent.prototype,"speInfo",{set:function(t){this.event[LU]=t},enumerable:!1,configurable:!0}),Object.defineProperty(HttpEvent.prototype,"serverErrorCode",{set:function(t){this.event[FU]=t},enumerable:!1,configurable:!0}),Object.defineProperty(HttpEvent.prototype,"serverSubErrorCode",{set:function(t){this.event[UU]=t},enumerable:!1,configurable:!0}),HttpEvent}(mU),qU=function(){function TelemetryManager(t,o,s){this.completedEvents={},this.inProgressEvents={},this.eventCountByCorrelationId={},this.onlySendFailureTelemetry=!1,this.telemetryPlatform=__assign$2({sdk:TL.libraryName,sdkVersion:MF,networkInformation:{connectionSpeed:"undefined"!=typeof navigator&&navigator.connection&&navigator.connection.effectiveType}},t.platform),this.clientId=t.clientId,this.onlySendFailureTelemetry=t.onlySendFailureTelemetry,this.telemetryEmitter=o,this.logger=s}return TelemetryManager.getTelemetrymanagerStub=function(t,o){return new this({platform:{applicationName:"UnSetStub",applicationVersion:"0.0"},clientId:t},(function(){}),o)},TelemetryManager.prototype.startEvent=function(t){this.logger.verbose("Telemetry Event started: "+t.key),this.telemetryEmitter&&(t.start(),this.inProgressEvents[t.key]=t)},TelemetryManager.prototype.stopEvent=function(t){if(this.logger.verbose("Telemetry Event stopped: "+t.key),this.telemetryEmitter&&this.inProgressEvents[t.key]){t.stop(),this.incrementEventCount(t);var o=this.completedEvents[t.telemetryCorrelationId];this.completedEvents[t.telemetryCorrelationId]=__spreadArrays$1(o||[],[t]),delete this.inProgressEvents[t.key]}},TelemetryManager.prototype.flush=function(t){var o=this;if(this.logger.verbose("Flushing telemetry events: "+t),this.telemetryEmitter&&this.completedEvents[t]){var s=this.getOrphanedEvents(t);s.forEach((function(t){return o.incrementEventCount(t)}));var l=__spreadArrays$1(this.completedEvents[t],s);delete this.completedEvents[t];var h=this.eventCountByCorrelationId[t];if(delete this.eventCountByCorrelationId[t],l&&l.length){var v=__spreadArrays$1(l,[new bU(this.telemetryPlatform,t,this.clientId,h)]);this.telemetryEmitter(v.map((function(t){return t.get()})))}}},TelemetryManager.prototype.createAndStartApiEvent=function(t,o){var s=new IU(t,this.logger.isPiiLoggingEnabled(),o);return this.startEvent(s),s},TelemetryManager.prototype.stopAndFlushApiEvent=function(t,o,s,l){o.wasSuccessful=s,l&&(o.apiErrorCode=l),this.stopEvent(o),this.flush(t)},TelemetryManager.prototype.createAndStartHttpEvent=function(t,o,s,l){var h=new BU(t,l);return h.url=s,h.httpMethod=o,this.startEvent(h),h},TelemetryManager.prototype.incrementEventCount=function(t){var o,s=t.eventName,l=this.eventCountByCorrelationId[t.telemetryCorrelationId];l?l[s]=l[s]?l[s]+1:1:this.eventCountByCorrelationId[t.telemetryCorrelationId]=((o={})[s]=1,o)},TelemetryManager.prototype.getOrphanedEvents=function(t){var o=this;return Object.keys(this.inProgressEvents).reduce((function(s,l){if(-1!==l.indexOf(t)){var h=o.inProgressEvents[l];return delete o.inProgressEvents[l],__spreadArrays$1(s,[h])}return s}),[])},TelemetryManager}(),jU=function(){function AuthCacheUtils(){}return AuthCacheUtils.filterTokenCacheItemsByScope=function(t,o){return t.filter((function(t){var s=t.key.scopes.split(" "),l=RF.removeDefaultScopes(o);return 0===l.length?RF.containsScope(s,o):RF.containsScope(s,l)}))},AuthCacheUtils.filterTokenCacheItemsByAuthority=function(t,o){return t.filter((function(t){return OF.CanonicalizeUri(t.key.authority)===o}))},AuthCacheUtils.filterTokenCacheItemsByDomain=function(t,o){return t.filter((function(t){return OF.GetUrlComponents(t.key.authority).HostNameAndPort===o}))},AuthCacheUtils}(),zU="https://login.microsoftonline.com/common",VU=function(){function UserAgentApplication(t){this.authResponseCallback=null,this.tokenReceivedCallback=null,this.errorReceivedCallback=null,this.config=function buildConfiguration$1(t){var o=t.auth,s=t.cache,l=void 0===s?{}:s,h=t.system,v=void 0===h?{}:h,m=t.framework,_=void 0===m?{}:m;return{auth:__assign$2(__assign$2({},eU),o),cache:__assign$2(__assign$2({},tU),l),system:__assign$2(__assign$2({},rU),v),framework:__assign$2(__assign$2({},oU),_)}}(t),this.logger=this.config.system.logger,this.clientId=this.config.auth.clientId,this.inCookie=this.config.cache.storeAuthStateInCookie,this.telemetryManager=this.getTelemetryManagerFromConfig(this.config.system.telemetry,this.clientId),FF.setTrustedAuthoritiesFromConfig(this.config.auth.validateAuthority,this.config.auth.knownAuthorities),XF.saveMetadataFromConfig(this.config.auth.authority,this.config.auth.authorityMetadata),this.authority=this.config.auth.authority||zU,this.cacheStorage=new WF(this.clientId,this.config.cache.cacheLocation,this.inCookie),window.activeRenewals||(window.activeRenewals={}),window.renewStates||(window.renewStates=[]),window.callbackMappedToRenewStates||(window.callbackMappedToRenewStates={}),window.promiseMappedToRenewStates||(window.promiseMappedToRenewStates={}),window.msal=this;var o=window.location.hash,s=OF.urlContainsHash(o);(YF.checkIfBackButtonIsPressed(this.cacheStorage),s&&this.cacheStorage.isInteractionInProgress(!0))&&(this.getResponseState(o).method===TL.interactionTypeRedirect&&this.handleRedirectAuthenticationResponse(o))}return Object.defineProperty(UserAgentApplication.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},set:function(t){this.authorityInstance=XF.CreateInstance(t,this.config.auth.validateAuthority)},enumerable:!1,configurable:!0}),UserAgentApplication.prototype.getAuthorityInstance=function(){return this.authorityInstance},UserAgentApplication.prototype.handleRedirectCallback=function(t,o){if(!t)throw PF.createInvalidCallbackObjectError(t);o?(this.tokenReceivedCallback=t,this.errorReceivedCallback=o,this.logger.warning("This overload for callback is deprecated - please change the format of the callbacks to a single callback as shown: (err: AuthError, response: AuthResponse).")):this.authResponseCallback=t,this.redirectError?this.authErrorHandler(TL.interactionTypeRedirect,this.redirectError,this.redirectResponse):this.redirectResponse&&this.authResponseHandler(TL.interactionTypeRedirect,this.redirectResponse)},UserAgentApplication.prototype.urlContainsHash=function(t){return this.logger.verbose("UrlContainsHash has been called"),OF.urlContainsHash(t)},UserAgentApplication.prototype.authResponseHandler=function(t,o,s){if(this.logger.verbose("AuthResponseHandler has been called"),this.cacheStorage.setInteractionInProgress(!1),t===TL.interactionTypeRedirect)this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback?(this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling success callback with response"),this.tokenReceivedCallback(o)):this.authResponseCallback&&(this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with response"),this.authResponseCallback(null,o));else{if(t!==TL.interactionTypePopup)throw dF.createInvalidInteractionTypeError();this.logger.verbose("Interaction type is popup, resolving"),s(o)}},UserAgentApplication.prototype.authErrorHandler=function(t,o,s,l){if(this.logger.verbose("AuthErrorHandler has been called"),this.cacheStorage.setInteractionInProgress(!1),t===TL.interactionTypeRedirect)if(this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback)this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling error callback"),this.errorReceivedCallback(o,s.accountState);else{if(!this.authResponseCallback)throw this.logger.verbose("handleRedirectCallback has not been called and no callbacks are registered, throwing error"),o;this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with error"),this.authResponseCallback(o,s)}else{if(t!==TL.interactionTypePopup)throw dF.createInvalidInteractionTypeError();this.logger.verbose("Interaction type is popup, rejecting"),l(o)}},UserAgentApplication.prototype.loginRedirect=function(t){this.logger.verbose("LoginRedirect has been called");var o=KF.validateRequest(t,!0,this.clientId,TL.interactionTypeRedirect);this.acquireTokenInteractive(TL.interactionTypeRedirect,!0,o,null,null)},UserAgentApplication.prototype.acquireTokenRedirect=function(t){this.logger.verbose("AcquireTokenRedirect has been called");var o=KF.validateRequest(t,!1,this.clientId,TL.interactionTypeRedirect);this.acquireTokenInteractive(TL.interactionTypeRedirect,!1,o,null,null)},UserAgentApplication.prototype.loginPopup=function(t){var o=this;this.logger.verbose("LoginPopup has been called");var s=KF.validateRequest(t,!0,this.clientId,TL.interactionTypePopup),l=this.telemetryManager.createAndStartApiEvent(s.correlationId,pU.LoginPopup);return new Promise((function(t,l){o.acquireTokenInteractive(TL.interactionTypePopup,!0,s,t,l)})).then((function(t){return o.logger.verbose("Successfully logged in"),o.telemetryManager.stopAndFlushApiEvent(s.correlationId,l,!0),t})).catch((function(t){throw o.cacheStorage.resetTempCacheItems(s.state),o.telemetryManager.stopAndFlushApiEvent(s.correlationId,l,!1,t.errorCode),t}))},UserAgentApplication.prototype.acquireTokenPopup=function(t){var o=this;this.logger.verbose("AcquireTokenPopup has been called");var s=KF.validateRequest(t,!1,this.clientId,TL.interactionTypePopup),l=this.telemetryManager.createAndStartApiEvent(s.correlationId,pU.AcquireTokenPopup);return new Promise((function(t,l){o.acquireTokenInteractive(TL.interactionTypePopup,!1,s,t,l)})).then((function(t){return o.logger.verbose("Successfully acquired token"),o.telemetryManager.stopAndFlushApiEvent(s.correlationId,l,!0),t})).catch((function(t){throw o.cacheStorage.resetTempCacheItems(s.state),o.telemetryManager.stopAndFlushApiEvent(s.correlationId,l,!1,t.errorCode),t}))},UserAgentApplication.prototype.acquireTokenInteractive=function(t,o,s,l,h){var v,m=this;this.logger.verbose("AcquireTokenInteractive has been called"),YF.blockReloadInHiddenIframes();try{this.cacheStorage.setInteractionInProgress(!0)}catch(l){var _=o?dF.createLoginInProgressError():dF.createAcquireTokenInProgressError(),R=buildResponseStateOnly(this.getAccountState(s.state));return this.cacheStorage.resetTempCacheItems(s.state),void this.authErrorHandler(t,_,R,h)}if(t===TL.interactionTypeRedirect&&this.cacheStorage.setItem(xL.REDIRECT_REQUEST,""+TL.inProgress+TL.resourceDelimiter+s.state),s&&s.account&&!o?(v=s.account,this.logger.verbose("Account set from request")):(v=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),v||DF.isSSOParam(s))this.logger.verbose("User session exists, login not required"),this.acquireTokenHelper(v,t,o,s,l,h);else{if(!o){this.logger.verbose("AcquireToken call, no context or account given"),this.logger.info("User login is required");R=buildResponseStateOnly(this.getAccountState(s.state));return this.cacheStorage.resetTempCacheItems(s.state),void this.authErrorHandler(t,dF.createUserLoginRequiredError(),R,h)}if(this.extractADALIdToken()&&!s.scopes){this.logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken");var $=this.buildIDTokenRequest(s);this.silentLogin=!0,this.acquireTokenSilent($).then((function(o){m.silentLogin=!1,m.logger.info("Unified cache call is successful"),m.authResponseHandler(t,o,l)}),(function(v){m.silentLogin=!1,m.logger.error("Error occurred during unified cache ATS: "+v),m.acquireTokenHelper(null,t,o,s,l,h)}))}else this.logger.verbose("Login call but no token found, proceed to login"),this.acquireTokenHelper(null,t,o,s,l,h)}},UserAgentApplication.prototype.acquireTokenHelper=function(t,o,s,l,h,v){return __awaiter$8(this,void 0,void 0,(function(){var m,_,R,$,B,q,j,z,K,W;return __generator$2(this,(function(Z){switch(Z.label){case 0:this.logger.verbose("AcquireTokenHelper has been called"),this.logger.verbose("Interaction type: "+o+". isLoginCall: "+s),m=l.scopes?l.scopes.join(" ").toLowerCase():TL.oidcScopes.join(" "),this.logger.verbosePii("Request signature: "+m),R=l&&l.authority?XF.CreateInstance(l.authority,this.config.auth.validateAuthority,l.authorityMetadata):this.authorityInstance,Z.label=1;case 1:return Z.trys.push([1,11,,12]),R.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,XF.saveMetadataFromNetwork(R,this.telemetryManager,l.correlationId)]);case 2:return Z.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),Z.label=4;case 4:if(B=s?AL:this.getTokenType(t,l.scopes),q=l.redirectStartPage||window.location.href,_=new DF(R,this.clientId,B,this.getRedirectUri(l&&l.redirectUri),l.scopes,l.state,l.correlationId),this.logger.verbose("Finished building server authentication request"),this.updateCacheEntries(_,t,s,q),this.logger.verbose("Updating cache entries"),_.populateQueryParams(t,l),this.logger.verbose("Query parameters populated from account"),j=OF.createNavigateUrl(_)+TL.response_mode_fragment,o===TL.interactionTypeRedirect)s?this.logger.verbose("Interaction type redirect but login call is true. State not cached"):(this.cacheStorage.setItem(WF.generateTemporaryCacheKey(xL.STATE_ACQ_TOKEN,l.state),_.state,this.inCookie),this.logger.verbose("State cached for redirect"),this.logger.verbosePii("State cached: "+_.state));else{if(o!==TL.interactionTypePopup)throw this.logger.verbose("Invalid interaction error. State not cached"),dF.createInvalidInteractionTypeError();window.renewStates.push(_.state),window.requestType=s?TL.login:TL.renewToken,this.logger.verbose("State saved to window"),this.logger.verbosePii("State saved: "+_.state),this.registerCallback(_.state,m,h,v)}if(o!==TL.interactionTypePopup)return[3,9];this.logger.verbose("Interaction type is popup. Generating popup window");try{$=this.openPopup(j,"msal",TL.popUpWidth,TL.popUpHeight),YF.trackPopup($)}catch(t){if(this.logger.info(VL.code+":"+VL.desc),this.cacheStorage.setItem(IL.ERROR,VL.code),this.cacheStorage.setItem(IL.ERROR_DESC,VL.desc),v)return v(dF.createPopupWindowError()),[2]}if(!$)return[3,8];Z.label=5;case 5:return Z.trys.push([5,7,,8]),[4,YF.monitorPopupForHash($,this.config.system.loadFrameTimeout,j,this.logger)];case 6:return z=Z.sent(),this.handleAuthenticationResponse(z),this.cacheStorage.setInteractionInProgress(!1),this.logger.info("Closing popup window"),this.config.framework.isAngular&&this.broadcast("msal:popUpHashChanged",z),YF.closePopups(),[3,8];case 7:return K=Z.sent(),v&&v(K),this.config.framework.isAngular?this.broadcast("msal:popUpClosed",K.errorCode+TL.resourceDelimiter+K.errorMessage):(this.cacheStorage.setInteractionInProgress(!1),$.close()),[3,8];case 8:return[3,10];case 9:l.onRedirectNavigate?(this.logger.verbose("Invoking onRedirectNavigate callback"),!1!==l.onRedirectNavigate(j)?(this.logger.verbose("onRedirectNavigate did not return false, navigating"),this.navigateWindow(j)):this.logger.verbose("onRedirectNavigate returned false, stopping navigation")):(this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(j)),Z.label=10;case 10:return[3,12];case 11:return W=Z.sent(),this.logger.error(W),this.cacheStorage.resetTempCacheItems(l.state),this.authErrorHandler(o,dF.createEndpointResolutionError(W.toString),buildResponseStateOnly(l.state),v),$&&$.close(),[3,12];case 12:return[2]}}))}))},UserAgentApplication.prototype.ssoSilent=function(t){if(this.logger.verbose("ssoSilent has been called"),!t)throw PF.createEmptyRequestError();if(!t.sid&&!t.loginHint)throw PF.createSsoSilentError();return this.acquireTokenSilent(__assign$2(__assign$2({},t),{scopes:TL.oidcScopes}))},UserAgentApplication.prototype.acquireTokenSilent=function(t){var o=this;this.logger.verbose("AcquireTokenSilent has been called");var s=KF.validateRequest(t,!1,this.clientId,TL.interactionTypeSilent),l=this.telemetryManager.createAndStartApiEvent(s.correlationId,pU.AcquireTokenSilent),h=KF.createRequestSignature(s);return new Promise((function(t,l){return __awaiter$8(o,void 0,void 0,(function(){var o,v,m,_,R,$,B,q,j,z,K;return __generator$2(this,(function(W){switch(W.label){case 0:if(YF.blockReloadInHiddenIframes(),o=s.scopes.join(" ").toLowerCase(),this.logger.verbosePii("Serialized scopes: "+o),s.account?(v=s.account,this.logger.verbose("Account set from request")):(v=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),m=this.cacheStorage.getItem(TL.adalIdToken),!v&&!s.sid&&!s.loginHint&&jL.isEmpty(m))return this.logger.info("User login is required"),[2,l(dF.createUserLoginRequiredError())];if(_=this.getTokenType(v,s.scopes),this.logger.verbose("Response type: "+_),R=new DF(XF.CreateInstance(s.authority,this.config.auth.validateAuthority,s.authorityMetadata),this.clientId,_,this.getRedirectUri(s.redirectUri),s.scopes,s.state,s.correlationId),this.logger.verbose("Finished building server authentication request"),DF.isSSOParam(s)||v?(R.populateQueryParams(v,s,null,!0),this.logger.verbose("Query parameters populated from existing SSO or account")):v||jL.isEmpty(m)?this.logger.verbose("No additional query parameters added"):($=jF.extractIdToken(m),this.logger.verbose("ADAL's idToken exists. Extracting login information from ADAL's idToken to populate query parameters"),R.populateQueryParams(v,null,$,!0)),!(B=s.claimsRequest||R.claimsValue)&&!s.forceRefresh)try{j=this.getCachedToken(R,v)}catch(t){q=t}return j?(this.logger.verbose("Token found in cache lookup"),this.logger.verbosePii("Scopes found: "+JSON.stringify(j.scopes)),t(j),[2,null]):[3,1];case 1:return q?(this.logger.infoPii(q.errorCode+":"+q.errorMessage),l(q),[2,null]):[3,2];case 2:z=void 0,z=B?"Skipped cache lookup since claims were given":s.forceRefresh?"Skipped cache lookup since request.forceRefresh option was set to true":"No valid token found in cache lookup",this.logger.verbose(z),R.authorityInstance||(R.authorityInstance=s.authority?XF.CreateInstance(s.authority,this.config.auth.validateAuthority,s.authorityMetadata):this.authorityInstance),this.logger.verbosePii("Authority instance: "+R.authority),W.label=3;case 3:return W.trys.push([3,7,,8]),R.authorityInstance.hasCachedMetadata()?[3,5]:(this.logger.verbose("No cached metadata for authority"),[4,XF.saveMetadataFromNetwork(R.authorityInstance,this.telemetryManager,s.correlationId)]);case 4:return W.sent(),this.logger.verbose("Authority has been updated with endpoint discovery response"),[3,6];case 5:this.logger.verbose("Cached metadata found for authority"),W.label=6;case 6:return window.activeRenewals[h]?(this.logger.verbose("Renewing token in progress. Registering callback"),this.registerCallback(window.activeRenewals[h],h,t,l)):s.scopes&&RF.onlyContainsOidcScopes(s.scopes)?(this.logger.verbose("OpenID Connect scopes only, renewing idToken"),this.silentLogin=!0,this.renewIdToken(h,t,l,v,R)):(this.logger.verbose("Renewing access token"),this.renewToken(h,t,l,v,R)),[3,8];case 7:return K=W.sent(),this.logger.error(K),l(dF.createEndpointResolutionError(K.toString())),[2,null];case 8:return[2]}}))}))})).then((function(t){return o.logger.verbose("Successfully acquired token"),o.telemetryManager.stopAndFlushApiEvent(s.correlationId,l,!0),t})).catch((function(t){throw o.cacheStorage.resetTempCacheItems(s.state),o.telemetryManager.stopAndFlushApiEvent(s.correlationId,l,!1,t.errorCode),t}))},UserAgentApplication.prototype.openPopup=function(t,o,s,l){this.logger.verbose("OpenPopup has been called");try{var h=window.screenLeft?window.screenLeft:window.screenX,v=window.screenTop?window.screenTop:window.screenY,m=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,_=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,R=m/2-s/2+h,$=_/2-l/2+v,B=window.open(t,o,"width="+s+", height="+l+", top="+$+", left="+R+", scrollbars=yes");if(!B)throw dF.createPopupWindowError();return B.focus&&B.focus(),B}catch(t){throw this.cacheStorage.setInteractionInProgress(!1),dF.createPopupWindowError(t.toString())}},UserAgentApplication.prototype.loadIframeTimeout=function(t,o,s){return __awaiter$8(this,void 0,void 0,(function(){var l,h,v,m,_;return __generator$2(this,(function(R){switch(R.label){case 0:return l=window.activeRenewals[s],this.logger.verbosePii("Set loading state to pending for: "+s+":"+l),this.cacheStorage.setItem(WF.generateTemporaryCacheKey(xL.RENEW_STATUS,l),TL.inProgress),this.config.system.navigateFrameWait?[4,YF.loadFrame(t,o,this.config.system.navigateFrameWait,this.logger)]:[3,2];case 1:return v=R.sent(),[3,3];case 2:v=YF.loadFrameSync(t,o,this.logger),R.label=3;case 3:h=v,R.label=4;case 4:return R.trys.push([4,6,,7]),[4,YF.monitorIframeForHash(h.contentWindow,this.config.system.loadFrameTimeout,t,this.logger)];case 5:return(m=R.sent())&&this.handleAuthenticationResponse(m),[3,7];case 6:throw _=R.sent(),this.cacheStorage.getItem(WF.generateTemporaryCacheKey(xL.RENEW_STATUS,l))===TL.inProgress&&(this.logger.verbose("Loading frame has timed out after: "+this.config.system.loadFrameTimeout/1e3+" seconds for scope/authority "+s+":"+l),l&&window.callbackMappedToRenewStates[l]&&window.callbackMappedToRenewStates[l](null,_),this.cacheStorage.removeItem(WF.generateTemporaryCacheKey(xL.RENEW_STATUS,l))),YF.removeHiddenIframe(h),_;case 7:return YF.removeHiddenIframe(h),[2]}}))}))},UserAgentApplication.prototype.navigateWindow=function(t,o){if(!t||jL.isEmpty(t))throw this.logger.info("Navigate url is empty"),qL.createUnexpectedError("Navigate url is empty");var s=o||window,l=o?"Navigated Popup window to:"+t:"Navigate to:"+t;this.logger.infoPii(l),s.location.assign(t)},UserAgentApplication.prototype.registerCallback=function(t,o,s,l){var h=this;window.activeRenewals[o]=t,window.promiseMappedToRenewStates[t]||(window.promiseMappedToRenewStates[t]=[]),window.promiseMappedToRenewStates[t].push({resolve:s,reject:l}),window.callbackMappedToRenewStates[t]||(window.callbackMappedToRenewStates[t]=function(s,l){delete window.activeRenewals[o];for(var v=0;v<window.promiseMappedToRenewStates[t].length;++v)try{if(l)window.promiseMappedToRenewStates[t][v].reject(l);else{if(!s)throw h.cacheStorage.resetTempCacheItems(t),qL.createUnexpectedError("Error and response are both null");window.promiseMappedToRenewStates[t][v].resolve(s)}}catch(t){h.logger.warning(t)}delete window.promiseMappedToRenewStates[t],delete window.callbackMappedToRenewStates[t]})},UserAgentApplication.prototype.logout=function(t){this.logger.verbose("Logout has been called"),this.logoutAsync(t)},UserAgentApplication.prototype.logoutAsync=function(t){return __awaiter$8(this,void 0,void 0,(function(){var o,s,l,h,v,m;return __generator$2(this,(function(_){switch(_.label){case 0:o=t||kL.createNewGuid(),s=this.telemetryManager.createAndStartApiEvent(o,pU.Logout),this.clearCache(),this.account=null,_.label=1;case 1:return _.trys.push([1,5,,6]),this.authorityInstance.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,XF.saveMetadataFromNetwork(this.authorityInstance,this.telemetryManager,t)]);case 2:return _.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),_.label=4;case 4:return l="client-request-id="+o,h=void 0,this.getPostLogoutRedirectUri()?(h="&post_logout_redirect_uri="+encodeURIComponent(this.getPostLogoutRedirectUri()),this.logger.verbose("redirectUri found and set")):(h="",this.logger.verbose("No redirectUri set for app. postLogoutQueryParam is empty")),v=void 0,this.authorityInstance.EndSessionEndpoint?(v=this.authorityInstance.EndSessionEndpoint+"?"+l+h,this.logger.verbose("EndSessionEndpoint found and urlNavigate set"),this.logger.verbosePii("urlNavigate set to: "+this.authorityInstance.EndSessionEndpoint)):(v=this.authority+"oauth2/v2.0/logout?"+l+h,this.logger.verbose("No endpoint, urlNavigate set to default")),this.telemetryManager.stopAndFlushApiEvent(o,s,!0),this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(v),[3,6];case 5:return m=_.sent(),this.telemetryManager.stopAndFlushApiEvent(o,s,!1,m.errorCode),[3,6];case 6:return[2]}}))}))},UserAgentApplication.prototype.clearCache=function(){this.logger.verbose("Clearing cache"),window.renewStates=[];for(var t=this.cacheStorage.getAllTokens(TL.clientId,TL.homeAccountIdentifier),o=0;o<t.length;o++)this.cacheStorage.removeItem(JSON.stringify(t[o].key));this.cacheStorage.resetCacheItems(),this.cacheStorage.clearMsalCookie(),this.logger.verbose("Cache cleared")},UserAgentApplication.prototype.clearCacheForScope=function(t){this.logger.verbose("Clearing access token from cache");for(var o=this.cacheStorage.getAllAccessTokens(TL.clientId,TL.homeAccountIdentifier),s=0;s<o.length;s++){var l=o[s];l.value.accessToken===t&&(this.cacheStorage.removeItem(JSON.stringify(l.key)),this.logger.verbosePii("Access token removed: "+l.key))}},UserAgentApplication.prototype.isCallback=function(t){return this.logger.info("isCallback will be deprecated in favor of urlContainsHash in MSAL.js v2.0."),this.logger.verbose("isCallback has been called"),OF.urlContainsHash(t)},UserAgentApplication.prototype.processCallBack=function(t,o,s){this.logger.info("ProcessCallBack has been called. Processing callback from redirect response");var l,h,v=o;v||(this.logger.verbose("StateInfo is null, getting stateInfo from hash"),v=this.getResponseState(t));try{l=this.saveTokenFromHash(t,v)}catch(t){h=t}try{this.cacheStorage.clearMsalCookie(v.state);var m=this.getAccountState(v.state);if(l){if(v.requestType===TL.renewToken||l.accessToken?(window.parent!==window?this.logger.verbose("Window is in iframe, acquiring token silently"):this.logger.verbose("Acquiring token interactive in progress"),this.logger.verbose("Response tokenType set to "+CL.ACCESS_TOKEN),l.tokenType=CL.ACCESS_TOKEN):v.requestType===TL.login&&(this.logger.verbose("Response tokenType set to "+CL.ID_TOKEN),l.tokenType=CL.ID_TOKEN),!s)return this.logger.verbose("Setting redirectResponse"),void(this.redirectResponse=l)}else if(!s)return this.logger.verbose("Response is null, setting redirectResponse with state"),this.redirectResponse=buildResponseStateOnly(m),this.redirectError=h,void this.cacheStorage.resetTempCacheItems(v.state);this.logger.verbose("Calling callback provided to processCallback"),s(l,h)}catch(t){throw this.logger.error("Error occurred in token received callback function: "+t),dF.createErrorInCallbackFunction(t.toString())}},UserAgentApplication.prototype.handleAuthenticationResponse=function(t){this.logger.verbose("HandleAuthenticationResponse has been called");var o=t||window.location.hash,s=this.getResponseState(o);this.logger.verbose("Obtained state from response");var l=window.callbackMappedToRenewStates[s.state];this.processCallBack(o,s,l)},UserAgentApplication.prototype.handleRedirectAuthenticationResponse=function(t){this.logger.info("Returned from redirect url"),this.logger.verbose("HandleRedirectAuthenticationResponse has been called"),YF.clearUrlFragment(window),this.logger.verbose("Window.location.hash cleared");var o=this.getResponseState(t);if(this.config.auth.navigateToLoginRequestUrl&&window.parent===window){this.logger.verbose("Window.parent is equal to window, not in popup or iframe. Navigation to login request url after login turned on");var s=this.cacheStorage.getItem(WF.generateTemporaryCacheKey(xL.LOGIN_REQUEST,o.state),this.inCookie);if(!s||"null"===s)return this.logger.error("Unable to get valid login request url from cache, redirecting to home page"),void window.location.assign("/");this.logger.verbose("Valid login request url obtained from cache");var l=OF.removeHashFromUrl(window.location.href),h=OF.removeHashFromUrl(s);if(l!==h)return this.logger.verbose("Current url is not login request url, navigating"),this.logger.verbosePii("CurrentUrl: "+l+", finalRedirectUrl: "+h),void window.location.assign(""+h+t);this.logger.verbose("Current url matches login request url");var v=OF.GetUrlComponents(s);v.Hash&&(this.logger.verbose("Login request url contains hash, resetting non-msal hash"),window.location.hash=v.Hash)}else this.config.auth.navigateToLoginRequestUrl||this.logger.verbose("Default navigation to start page after login turned off");this.processCallBack(t,o,null)},UserAgentApplication.prototype.getResponseState=function(t){this.logger.verbose("GetResponseState has been called");var o,s=OF.deserializeHash(t);if(!s)throw qL.createUnexpectedError("Hash was not parsed correctly.");if(!s.hasOwnProperty(CL.STATE))throw qL.createUnexpectedError("Hash does not contain state.");this.logger.verbose("Hash contains state. Creating stateInfo object");var l=KF.parseLibraryState(s.state);if((o={requestType:TL.unknown,state:s.state,timestamp:l.ts,method:l.method,stateMatch:!1}).state===this.cacheStorage.getItem(WF.generateTemporaryCacheKey(xL.STATE_LOGIN,o.state),this.inCookie)||o.state===this.silentAuthenticationState)return this.logger.verbose("State matches cached state, setting requestType to login"),o.requestType=TL.login,o.stateMatch=!0,o;if(o.state===this.cacheStorage.getItem(WF.generateTemporaryCacheKey(xL.STATE_ACQ_TOKEN,o.state),this.inCookie))return this.logger.verbose("State matches cached state, setting requestType to renewToken"),o.requestType=TL.renewToken,o.stateMatch=!0,o;if(!o.stateMatch){this.logger.verbose("State does not match cached state, setting requestType to type from window"),o.requestType=window.requestType;for(var h=window.renewStates,v=0;v<h.length;v++)if(h[v]===o.state){this.logger.verbose("Matching state found for request"),o.stateMatch=!0;break}o.stateMatch||this.logger.verbose("Matching state not found for request")}return o},UserAgentApplication.prototype.getCachedToken=function(t,o){this.logger.verbose("GetCachedToken has been called");var s=t.scopes,l=this.getCachedIdToken(t,o),h=this.getCachedAccessToken(t,o,s),v=this.getAccountState(t.state);return JF.buildAuthResponse(l,h,t,o,s,v)},UserAgentApplication.prototype.getTokenCacheItemByAuthority=function(t,o,s,l){var h,v=this;return 1===(h=OF.isCommonAuthority(t)||OF.isOrganizationsAuthority(t)||OF.isConsumersAuthority(t)?jU.filterTokenCacheItemsByDomain(o,OF.GetUrlComponents(t).HostNameAndPort):jU.filterTokenCacheItemsByAuthority(o,t)).length?h[0]:h.length>1?(this.logger.warning("Multiple matching tokens found. Cleaning cache and requesting a new token."),h.forEach((function(t){v.cacheStorage.removeItem(JSON.stringify(t.key))})),null):(this.logger.verbose("No matching tokens of type "+l+" found"),null)},UserAgentApplication.prototype.getCachedIdToken=function(t,o){this.logger.verbose("Getting all cached tokens of type ID Token");var s=this.cacheStorage.getAllIdTokens(this.clientId,o?o.homeAccountIdentifier:null),l=t.authority||this.authority,h=this.getTokenCacheItemByAuthority(l,s,null,CL.ID_TOKEN);if(h){if(this.logger.verbose("Evaluating ID token found"),this.evaluateTokenExpiration(h)){this.logger.verbose("ID token expiration is within offset, using ID token found in cache");var v=h.value;return v?this.logger.verbose("ID Token found in cache is valid and unexpired"):this.logger.verbose("ID Token found in cache is invalid"),v?new zF(v.idToken):null}return this.logger.verbose("Cached ID token is expired, removing from cache"),this.cacheStorage.removeItem(JSON.stringify(h.key)),null}return this.logger.verbose("No tokens found"),null},UserAgentApplication.prototype.getCachedAccessToken=function(t,o,s){this.logger.verbose("Getting all cached tokens of type Access Token");var l=this.cacheStorage.getAllAccessTokens(this.clientId,o?o.homeAccountIdentifier:null),h=jU.filterTokenCacheItemsByScope(l,s),v=t.authority||this.authority,m=this.getTokenCacheItemByAuthority(v,h,s,CL.ACCESS_TOKEN);if(m){if(t.authorityInstance=XF.CreateInstance(m.key.authority,this.config.auth.validateAuthority),this.logger.verbose("Evaluating access token found"),this.evaluateTokenExpiration(m)){this.logger.verbose("Access token expiration is within offset, using access token found in cache");var _=o||this.getAccount();if(!_)throw qL.createUnexpectedError("Account should not be null here.");var R=this.getAccountState(t.state);return{uniqueId:"",tenantId:"",tokenType:CL.ACCESS_TOKEN,idToken:null,idTokenClaims:null,accessToken:m.value.accessToken,scopes:m.key.scopes.split(" "),expiresOn:new Date(1e3*Number(m.value.expiresIn)),account:_,accountState:R,fromCache:!0}}return this.logger.verbose("Access token expired, removing from cache"),this.cacheStorage.removeItem(JSON.stringify(m.key)),null}return this.logger.verbose("No matching token found when filtering by scope and authority"),null},UserAgentApplication.prototype.evaluateTokenExpiration=function(t){var o=Number(t.value.expiresIn);return jF.validateExpirationIsWithinOffset(o,this.config.system.tokenRenewalOffsetSeconds)},UserAgentApplication.prototype.extractADALIdToken=function(){this.logger.verbose("ExtractADALIdToken has been called");var t=this.cacheStorage.getItem(TL.adalIdToken);return jL.isEmpty(t)?null:jF.extractIdToken(t)},UserAgentApplication.prototype.renewToken=function(t,o,s,l,h){this.logger.verbose("RenewToken has been called"),this.logger.verbosePii("RenewToken scope and authority: "+t);var v=YF.generateFrameName(UL,t);YF.addHiddenIFrame(v,this.logger),this.updateCacheEntries(h,l,!1),this.logger.verbosePii("RenewToken expected state: "+h.state);var m=OF.urlRemoveQueryStringParameter(OF.createNavigateUrl(h),TL.prompt)+TL.prompt_none+TL.response_mode_fragment;window.renewStates.push(h.state),window.requestType=TL.renewToken,this.logger.verbose("Set window.renewState and requestType"),this.registerCallback(h.state,t,o,s),this.logger.infoPii("Navigate to: "+m),this.loadIframeTimeout(m,v,t).catch((function(t){return s(t)}))},UserAgentApplication.prototype.renewIdToken=function(t,o,s,l,h){this.logger.info("RenewIdToken has been called");var v=YF.generateFrameName(FL,t);YF.addHiddenIFrame(v,this.logger),this.updateCacheEntries(h,l,!1),this.logger.verbose("RenewIdToken expected state: "+h.state);var m=OF.urlRemoveQueryStringParameter(OF.createNavigateUrl(h),TL.prompt)+TL.prompt_none+TL.response_mode_fragment;this.silentLogin?(this.logger.verbose("Silent login is true, set silentAuthenticationState"),window.requestType=TL.login,this.silentAuthenticationState=h.state):(this.logger.verbose("Not silent login, set window.renewState and requestType"),window.requestType=TL.renewToken,window.renewStates.push(h.state)),this.registerCallback(h.state,t,o,s),this.logger.infoPii('Navigate to:" '+m),this.loadIframeTimeout(m,v,t).catch((function(t){return s(t)}))},UserAgentApplication.prototype.saveToken=function(t,o,s,l,h){var v=new $F(o,this.clientId,s,l.uid,l.utid),m=new NF(t.accessToken,t.idToken.rawIdToken,h.toString(),l.encodeClientInfo());return this.cacheStorage.setItem(JSON.stringify(v),JSON.stringify(m)),h?(this.logger.verbose("New expiration set for token"),t.expiresOn=new Date(1e3*h)):this.logger.error("Could not parse expiresIn parameter for access token"),t},UserAgentApplication.prototype.saveIdToken=function(t,o,s,l,h){this.logger.verbose("SaveIdToken has been called");var v=__assign$2({},t);v.scopes=TL.oidcScopes,v.accessToken=s[CL.ID_TOKEN];var m=Number(h.expiration);return this.logger.verbose("Saving ID token to cache"),this.saveToken(v,o,undefined,l,m)},UserAgentApplication.prototype.saveAccessToken=function(t,o,s,l){this.logger.verbose("SaveAccessToken has been called");var h=__assign$2({},t),v=s[CL.SCOPE],m=v.split(" "),_=this.cacheStorage.getAllAccessTokens(this.clientId,o);this.logger.verbose("Retrieving all access tokens from cache and removing duplicates");for(var R=0;R<_.length;R++){var $=_[R];if($.key.homeAccountIdentifier===t.account.homeAccountIdentifier){var B=$.key.scopes.split(" ");RF.isIntersectingScopes(B,m)&&this.cacheStorage.removeItem(JSON.stringify($.key))}}h.accessToken=s[CL.ACCESS_TOKEN],h.scopes=m;var q=qF.parseExpiresIn(s[CL.EXPIRES_IN]),j=KF.parseLibraryState(s[CL.STATE]).ts+q;return this.logger.verbose("Saving access token to cache"),this.saveToken(h,o,v,l,j)},UserAgentApplication.prototype.saveTokenFromHash=function(t,o){this.logger.verbose("SaveTokenFromHash has been called"),this.logger.info("State status: "+o.stateMatch+"; Request type: "+o.requestType);var s,l={uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:null,scopes:[],expiresOn:null,account:null,accountState:"",fromCache:!1},h=OF.deserializeHash(t),v="",m="",_=null;if(h.hasOwnProperty(CL.ERROR_DESCRIPTION)||h.hasOwnProperty(CL.ERROR)){if(this.logger.verbose("Server returned an error"),this.logger.infoPii("Error : "+h[CL.ERROR]+"; Error description: "+h[CL.ERROR_DESCRIPTION]),this.cacheStorage.setItem(IL.ERROR,h[CL.ERROR]),this.cacheStorage.setItem(IL.ERROR_DESC,h[CL.ERROR_DESCRIPTION]),o.requestType===TL.login&&(this.logger.verbose("RequestType is login, caching login error, generating authorityKey"),this.cacheStorage.setItem(IL.LOGIN_ERROR,h[CL.ERROR_DESCRIPTION]+":"+h[CL.ERROR]),v=WF.generateAuthorityKey(o.state)),o.requestType===TL.renewToken){this.logger.verbose("RequestType is renewToken, generating acquireTokenAccountKey"),v=WF.generateAuthorityKey(o.state);var R=this.getAccount(),$=void 0;R&&!jL.isEmpty(R.homeAccountIdentifier)?($=R.homeAccountIdentifier,this.logger.verbose("AccountId is set")):($=TL.no_account,this.logger.verbose("AccountId is set as no_account")),m=WF.generateAcquireTokenAccountKey($,o.state)}var B=h[CL.ERROR],q=h[CL.ERROR_DESCRIPTION];s=dU.isInteractionRequiredError(B)||dU.isInteractionRequiredError(q)?new dU(h[CL.ERROR],h[CL.ERROR_DESCRIPTION]):new sU(h[CL.ERROR],h[CL.ERROR_DESCRIPTION])}else if(this.logger.verbose("Server returns success"),o.stateMatch){this.logger.info("State is right"),h.hasOwnProperty(CL.SESSION_STATE)&&(this.logger.verbose("Fragment has session state, caching"),this.cacheStorage.setItem(WF.generateTemporaryCacheKey(xL.SESSION_STATE,o.state),h[CL.SESSION_STATE])),l.accountState=this.getAccountState(o.state);var j=void 0;if(h.hasOwnProperty(CL.ACCESS_TOKEN)){this.logger.info("Fragment has access token"),l.accessToken=h[CL.ACCESS_TOKEN],h.hasOwnProperty(CL.SCOPE)&&(l.scopes=h[CL.SCOPE].split(" ")),h.hasOwnProperty(CL.ID_TOKEN)?(this.logger.verbose("Fragment has id_token"),_=new zF(h[CL.ID_TOKEN])):(this.logger.verbose("No idToken on fragment, getting idToken from cache"),_=new zF(this.cacheStorage.getItem(EL.IDTOKEN))),l=JF.setResponseIdToken(l,_);var z=this.populateAuthority(o.state,this.inCookie,this.cacheStorage,_);this.logger.verbose("Got authority from cache"),h.hasOwnProperty(CL.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),j=new BF(h[CL.CLIENT_INFO],z)):this.authorityInstance.AuthorityType===NL.Adfs?j=BF.createClientInfoFromIdToken(_,z):this.logger.warning("ClientInfo not received in the response from AAD"),l.account=QF.createAccount(_,j),this.logger.verbose("Account object created from response");var K=void 0;l.account&&!jL.isEmpty(l.account.homeAccountIdentifier)?(this.logger.verbose("AccountKey set"),K=l.account.homeAccountIdentifier):(this.logger.verbose("AccountKey set as no_account"),K=TL.no_account),m=WF.generateAcquireTokenAccountKey(K,o.state);var W=WF.generateAcquireTokenAccountKey(TL.no_account,o.state);this.logger.verbose("AcquireTokenAccountKey generated");var Z=this.cacheStorage.getItem(m),te=void 0;jL.isEmpty(Z)?jL.isEmpty(this.cacheStorage.getItem(W))||(this.logger.verbose("No acquireToken account retrieved from cache"),l=this.saveAccessToken(l,z,h,j)):(te=JSON.parse(Z),this.logger.verbose("AcquireToken request account retrieved from cache"),l.account&&te&&QF.compareAccounts(l.account,te)?(l=this.saveAccessToken(l,z,h,j),this.logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this.logger.warning("The account object created from the response is not the same as the one passed in the acquireToken request"))}if(h.hasOwnProperty(CL.ID_TOKEN)){this.logger.info("Fragment has idToken"),_=new zF(h[CL.ID_TOKEN]);z=this.populateAuthority(o.state,this.inCookie,this.cacheStorage,_);if(l=JF.setResponseIdToken(l,_),h.hasOwnProperty(CL.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),j=new BF(h[CL.CLIENT_INFO],z)):this.authorityInstance.AuthorityType===NL.Adfs?j=BF.createClientInfoFromIdToken(_,z):this.logger.warning("ClientInfo not received in the response from AAD"),this.account=QF.createAccount(_,j),l.account=this.account,this.logger.verbose("Account object created from response"),_&&_.nonce){this.logger.verbose("IdToken has nonce");var ne=this.cacheStorage.getItem(WF.generateTemporaryCacheKey(xL.NONCE_IDTOKEN,o.state),this.inCookie);_.nonce!==ne?(this.account=null,this.cacheStorage.setItem(IL.LOGIN_ERROR,"Nonce Mismatch. Expected Nonce: "+ne+",Actual Nonce: "+_.nonce),this.logger.error("Nonce Mismatch. Expected Nonce: "+ne+", Actual Nonce: "+_.nonce),s=dF.createNonceMismatchError(ne,_.nonce)):(this.logger.verbose("Nonce matches, saving idToken to cache"),this.cacheStorage.setItem(EL.IDTOKEN,h[CL.ID_TOKEN],this.inCookie),this.cacheStorage.setItem(EL.CLIENT_INFO,j.encodeClientInfo(),this.inCookie),this.saveIdToken(l,z,h,j,_))}else this.logger.verbose("No idToken or no nonce. Cache key for Authority set as state"),v=o.state,m=o.state,this.logger.error("Invalid id_token received in the response"),s=dF.createInvalidIdTokenError(_),this.cacheStorage.setItem(IL.ERROR,s.errorCode),this.cacheStorage.setItem(IL.ERROR_DESC,s.errorMessage)}}else{this.logger.verbose("State mismatch"),v=o.state,m=o.state;var ie=this.cacheStorage.getItem(WF.generateTemporaryCacheKey(xL.STATE_LOGIN,o.state),this.inCookie);this.logger.error("State Mismatch. Expected State: "+ie+", Actual State: "+o.state),s=dF.createInvalidStateError(o.state,ie),this.cacheStorage.setItem(IL.ERROR,s.errorCode),this.cacheStorage.setItem(IL.ERROR_DESC,s.errorMessage)}if(this.cacheStorage.removeItem(WF.generateTemporaryCacheKey(xL.RENEW_STATUS,o.state)),this.cacheStorage.resetTempCacheItems(o.state),this.logger.verbose("Status set to complete, temporary cache cleared"),this.inCookie&&(this.logger.verbose("InCookie is true, setting authorityKey in cookie"),this.cacheStorage.setItemCookie(v,"",-1),this.cacheStorage.clearMsalCookie(o.state)),s)throw s;if(!l)throw qL.createUnexpectedError("Response is null");return l},UserAgentApplication.prototype.populateAuthority=function(t,o,s,l){this.logger.verbose("PopulateAuthority has been called");var h=WF.generateAuthorityKey(t),v=s.getItem(h,o);return jL.isEmpty(v)?v:OF.replaceTenantPath(v,l.tenantId)},UserAgentApplication.prototype.getAccount=function(){if(this.account)return this.account;var t=this.cacheStorage.getItem(EL.IDTOKEN,this.inCookie),o=this.cacheStorage.getItem(EL.CLIENT_INFO,this.inCookie);if(!jL.isEmpty(t)&&!jL.isEmpty(o)){var s=new zF(t),l=new BF(o,"");return this.account=QF.createAccount(s,l),this.account}return null},UserAgentApplication.prototype.getAccountState=function(t){if(t){var o=t.indexOf(TL.resourceDelimiter);if(o>-1&&o+1<t.length)return t.substring(o+1)}return t},UserAgentApplication.prototype.getAllAccounts=function(){for(var t=[],o=this.cacheStorage.getAllAccessTokens(TL.clientId,TL.homeAccountIdentifier),s=0;s<o.length;s++){var l=new zF(o[s].value.idToken),h=new BF(o[s].value.homeAccountIdentifier,""),v=QF.createAccount(l,h);t.push(v)}return this.getUniqueAccounts(t)},UserAgentApplication.prototype.getUniqueAccounts=function(t){if(!t||t.length<=1)return t;for(var o=[],s=[],l=0;l<t.length;++l)t[l].homeAccountIdentifier&&-1===o.indexOf(t[l].homeAccountIdentifier)&&(o.push(t[l].homeAccountIdentifier),s.push(t[l]));return s},UserAgentApplication.prototype.broadcast=function(t,o){var s=new CustomEvent(t,{detail:o});window.dispatchEvent(s)},UserAgentApplication.prototype.getCachedTokenInternal=function(t,o,s,l){var h=o||this.getAccount();if(!h)return null;var v=this.authorityInstance?this.authorityInstance:XF.CreateInstance(this.authority,this.config.auth.validateAuthority),m=this.getTokenType(h,t),_=new DF(v,this.clientId,m,this.getRedirectUri(),t,s,l);return this.getCachedToken(_,o)},UserAgentApplication.prototype.getScopesForEndpoint=function(t){if(this.config.framework.unprotectedResources.length>0)for(var o=0;o<this.config.framework.unprotectedResources.length;o++)if(t.indexOf(this.config.framework.unprotectedResources[o])>-1)return null;if(this.config.framework.protectedResourceMap.size>0)for(var s=0,l=Array.from(this.config.framework.protectedResourceMap.keys());s<l.length;s++){var h=l[s];if(t.indexOf(h)>-1)return this.config.framework.protectedResourceMap.get(h)}return t.indexOf("http://")>-1||t.indexOf("https://")>-1?OF.getHostFromUri(t)===OF.getHostFromUri(this.getRedirectUri())?new Array(this.clientId):null:new Array(this.clientId)},UserAgentApplication.prototype.getLoginInProgress=function(){return this.cacheStorage.isInteractionInProgress(!0)},UserAgentApplication.prototype.setInteractionInProgress=function(t){this.cacheStorage.setInteractionInProgress(t)},UserAgentApplication.prototype.setloginInProgress=function(t){this.setInteractionInProgress(t)},UserAgentApplication.prototype.getAcquireTokenInProgress=function(){return this.cacheStorage.isInteractionInProgress(!0)},UserAgentApplication.prototype.setAcquireTokenInProgress=function(t){this.setInteractionInProgress(t)},UserAgentApplication.prototype.getLogger=function(){return this.logger},UserAgentApplication.prototype.setLogger=function(t){this.logger=t},UserAgentApplication.prototype.getRedirectUri=function(t){return t||("function"==typeof this.config.auth.redirectUri?this.config.auth.redirectUri():this.config.auth.redirectUri)},UserAgentApplication.prototype.getPostLogoutRedirectUri=function(){return"function"==typeof this.config.auth.postLogoutRedirectUri?this.config.auth.postLogoutRedirectUri():this.config.auth.postLogoutRedirectUri},UserAgentApplication.prototype.getCurrentConfiguration=function(){if(!this.config)throw PF.createNoSetConfigurationError();return this.config},UserAgentApplication.prototype.getTokenType=function(t,o){var s=QF.compareAccounts(t,this.getAccount());return DF.determineResponseType(s,o)},UserAgentApplication.prototype.setAccountCache=function(t,o){var s=t?this.getAccountId(t):TL.no_account,l=WF.generateAcquireTokenAccountKey(s,o);this.cacheStorage.setItem(l,JSON.stringify(t))},UserAgentApplication.prototype.setAuthorityCache=function(t,o){var s=WF.generateAuthorityKey(t);this.cacheStorage.setItem(s,OF.CanonicalizeUri(o),this.inCookie)},UserAgentApplication.prototype.updateCacheEntries=function(t,o,s,l){l&&this.cacheStorage.setItem(WF.generateTemporaryCacheKey(xL.LOGIN_REQUEST,t.state),l,this.inCookie),s?this.cacheStorage.setItem(WF.generateTemporaryCacheKey(xL.STATE_LOGIN,t.state),t.state,this.inCookie):this.setAccountCache(o,t.state),this.setAuthorityCache(t.state,t.authority),this.cacheStorage.setItem(WF.generateTemporaryCacheKey(xL.NONCE_IDTOKEN,t.state),t.nonce,this.inCookie)},UserAgentApplication.prototype.getAccountId=function(t){return jL.isEmpty(t.homeAccountIdentifier)?TL.no_account:t.homeAccountIdentifier},UserAgentApplication.prototype.buildIDTokenRequest=function(t){return{scopes:TL.oidcScopes,authority:this.authority,account:this.getAccount(),extraQueryParameters:t.extraQueryParameters,correlationId:t.correlationId}},UserAgentApplication.prototype.getTelemetryManagerFromConfig=function(t,o){if(!t)return qU.getTelemetrymanagerStub(o,this.logger);var s=t.applicationName,l=t.applicationVersion,h=t.telemetryEmitter;if(!s||!l||!h)throw PF.createTelemetryConfigError(t);return new qU({platform:{applicationName:s,applicationVersion:l},clientId:o},h,this.logger)},UserAgentApplication}(),__awaiter$7=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};class MsalProvider extends IProvider{get userAgentApplication(){return this._userAgentApplication}get name(){return"MgtMsalProvider"}constructor(t){super(),this.sessionStorageRequestedScopesKey="mgt-requested-scopes",this.sessionStorageDeniedScopesKey="mgt-denied-scopes",this.initProvider(t)}trySilentSignIn(){return __awaiter$7(this,void 0,void 0,(function*(){try{if(this._userAgentApplication.isCallback(window.location.hash))return;this._userAgentApplication.getAccount()&&(yield this.getAccessToken(null))?this.setState(exports.ProviderState.SignedIn):this.setState(exports.ProviderState.SignedOut)}catch(t){this.setState(exports.ProviderState.SignedOut)}}))}login(t){return __awaiter$7(this,void 0,void 0,(function*(){let o=t||{loginHint:this._loginHint,scopes:this.scopes};if(this._prompt&&(o.prompt=this._prompt),this._domainHint&&(o.extraQueryParameters={domain_hint:this._domainHint}),this._loginType===exports.LoginType.Popup){const t=yield this._userAgentApplication.loginPopup(o);this.setState(t.account?exports.ProviderState.SignedIn:exports.ProviderState.SignedOut)}else this._userAgentApplication.loginRedirect(o)}))}logout(){return __awaiter$7(this,void 0,void 0,(function*(){this._userAgentApplication.logout(),this.setState(exports.ProviderState.SignedOut)}))}getAccessToken(t){return __awaiter$7(this,void 0,void 0,(function*(){const o=t&&t.scopes||this.scopes,s={loginHint:this._loginHint,scopes:o};this._domainHint&&(s.extraQueryParameters={domain_hint:this._domainHint});try{return(yield this._userAgentApplication.acquireTokenSilent(s)).accessToken}catch(t){if(!this.requiresInteraction(t))throw this.setState(exports.ProviderState.SignedOut),t;if(this._loginType===exports.LoginType.Redirect){if(this.areScopesDenied(o))throw t;this.setRequestedScopes(o),this._userAgentApplication.acquireTokenRedirect(s)}else try{return(yield this._userAgentApplication.acquireTokenPopup(s)).accessToken}catch(t){throw t}}throw null}))}updateScopes(t){this.scopes=t}requiresInteraction(t){return!(!t||!t.errorCode)&&(-1!==t.errorCode.indexOf("consent_required")||-1!==t.errorCode.indexOf("interaction_required")||-1!==t.errorCode.indexOf("login_required"))}setRequestedScopes(t){t&&sessionStorage.setItem(this.sessionStorageRequestedScopesKey,JSON.stringify(t))}getRequestedScopes(){const t=sessionStorage.getItem(this.sessionStorageRequestedScopesKey);return t?JSON.parse(t):null}clearRequestedScopes(){sessionStorage.removeItem(this.sessionStorageRequestedScopesKey)}addDeniedScopes(t){if(t){let o=this.getDeniedScopes()||[];o=o.concat(t);let s=o.indexOf("openid");-1!==s&&o.splice(s,1),s=o.indexOf("profile"),-1!==s&&o.splice(s,1),sessionStorage.setItem(this.sessionStorageDeniedScopesKey,JSON.stringify(o))}}getDeniedScopes(){const t=sessionStorage.getItem(this.sessionStorageDeniedScopesKey);return t?JSON.parse(t):null}areScopesDenied(t){if(t){const o=this.getDeniedScopes();if(o&&o.filter((o=>-1!==t.indexOf(o))).length>0)return!0}return!1}initProvider(t){let o,s;if(this.scopes=void 0!==t.scopes?t.scopes:["user.read"],this._loginType=void 0!==t.loginType?t.loginType:exports.LoginType.Redirect,this._loginHint=t.loginHint,this._domainHint=t.domainHint,this._prompt=void 0!==t.prompt?t.prompt:"select_account","clientId"in t){if(!t.clientId)throw new Error("clientId must be provided");{const l=t.options||{auth:{clientId:t.clientId}};l.auth.clientId=t.clientId,l.cache=l.cache||{},l.cache.cacheLocation=l.cache.cacheLocation||"localStorage",void 0!==l.cache.storeAuthStateInCookie&&null!==l.cache.storeAuthStateInCookie||(l.cache.storeAuthStateInCookie=!0),t.authority&&(l.auth.authority=t.authority),t.redirectUri&&(l.auth.redirectUri=t.redirectUri),s=t.clientId,o=new VU(l)}}else{if(!("userAgentApplication"in t))throw new Error("either clientId or userAgentApplication must be provided");if(!t.userAgentApplication)throw new Error("userAgentApplication must be provided");o=t.userAgentApplication;s=o.getCurrentConfiguration().auth.clientId}this.clientId=s,this.baseURL=void 0!==t.baseURL?t.baseURL:this.baseURL,this._userAgentApplication=o,this._userAgentApplication.handleRedirectCallback((t=>this.tokenReceivedCallback(t)),((t,o)=>this.errorReceivedCallback(t,o))),this.graph=createFromProvider(this),this.trySilentSignIn()}tokenReceivedCallback(t){"id_token"===t.tokenType&&this.setState(exports.ProviderState.SignedIn),this.clearRequestedScopes()}errorReceivedCallback(t,o){const s=this.getRequestedScopes();s&&this.addDeniedScopes(s),this.clearRequestedScopes()}}var __decorate$5=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},__metadata$5=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)};exports.MgtMsalProvider=class MgtMsalProvider extends MgtBaseProvider{constructor(){super(...arguments),this.clientId=""}get isAvailable(){return!0}initializeProvider(){if(this.clientId){const t={clientId:this.clientId,domainHint:this.domainHint,prompt:this.prompt};if(this.loginType&&this.loginType.length>1){let o=this.loginType.toLowerCase();o=o[0].toUpperCase()+o.slice(1);const s=exports.LoginType[o];t.loginType=s}if(this.authority&&(t.authority=this.authority),this.scopes){const o=this.scopes.split(",");o&&o.length>0&&(t.scopes=o)}this.redirectUri&&(t.redirectUri=this.redirectUri),this.baseUrl&&(t.baseURL=this.baseUrl),this.provider=new MsalProvider(t),Providers.globalProvider=this.provider}}},__decorate$5([e$1({attribute:"client-id",type:String}),__metadata$5("design:type",Object)],exports.MgtMsalProvider.prototype,"clientId",void 0),__decorate$5([e$1({attribute:"login-type",type:String}),__metadata$5("design:type",Object)],exports.MgtMsalProvider.prototype,"loginType",void 0),__decorate$5([e$1(),__metadata$5("design:type",Object)],exports.MgtMsalProvider.prototype,"authority",void 0),__decorate$5([e$1({attribute:"scopes",type:String}),__metadata$5("design:type",Object)],exports.MgtMsalProvider.prototype,"scopes",void 0),__decorate$5([e$1({attribute:"redirect-uri",type:String}),__metadata$5("design:type",Object)],exports.MgtMsalProvider.prototype,"redirectUri",void 0),__decorate$5([e$1({attribute:"domain-hint",type:String}),__metadata$5("design:type",Object)],exports.MgtMsalProvider.prototype,"domainHint",void 0),__decorate$5([e$1({attribute:"prompt",type:String}),__metadata$5("design:type",Object)],exports.MgtMsalProvider.prototype,"prompt",void 0),exports.MgtMsalProvider=__decorate$5([customElement("msal-provider")],exports.MgtMsalProvider);var __awaiter$6=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};class TeamsProvider extends MsalProvider{static get isAvailable(){return TeamsHelper.isAvailable}static get microsoftTeamsLib(){return TeamsHelper.microsoftTeamsLib}static set microsoftTeamsLib(t){TeamsHelper.microsoftTeamsLib=t}get name(){return"MgtTeamsProvider"}static handleAuth(t=HE){return __awaiter$6(this,void 0,void 0,(function*(){const o=TeamsHelper.microsoftTeamsLib;if(!o)return void console.error("Make sure you have referenced the Microsoft Teams sdk before using the TeamsProvider");o.initialize(),sessionStorage.getItem(this._sessionStorageLogoutInProgress)&&o.authentication.notifySuccess();const s=new URL(window.location.href).searchParams.get("signout"),l=localStorage.getItem(this._localStorageParametersKey);let h;if(h=l?JSON.parse(l):{},!h.clientId)return void o.authentication.notifyFailure("no clientId provided");const v=h.scopes?h.scopes.split(","):null,m=h.options||{auth:{clientId:h.clientId}};m.system=m.system||{},m.system.loadFrameTimeout=1e4;const _=new MsalProvider({clientId:h.clientId,options:m,scopes:v,baseURL:t});if(_.userAgentApplication.urlContainsHash(window.location.hash))return;const handleProviderState=()=>__awaiter$6(this,void 0,void 0,(function*(){if(_.state===exports.ProviderState.SignedOut){if(s)return void o.authentication.notifySuccess();sessionStorage.getItem(this._sessionStorageLoginInProgress)||(sessionStorage.setItem(this._sessionStorageLoginInProgress,"true"),_.login({loginHint:h.loginHint,scopes:v||_.scopes}))}else if(_.state===exports.ProviderState.SignedIn){if(s)return sessionStorage.setItem(this._sessionStorageLogoutInProgress,"true"),void(yield _.logout());try{const t=yield _.getAccessTokenForScopes(..._.scopes);o.authentication.notifySuccess(t)}catch(t){o.authentication.notifyFailure(t)}}}));_.onStateChanged(handleProviderState),handleProviderState()}))}constructor(t){super({clientId:t.clientId,loginType:exports.LoginType.Redirect,options:t.msalOptions,scopes:t.scopes,baseURL:t.baseURL}),this._msalOptions=t.msalOptions,this._authPopupUrl=t.authPopupUrl;TeamsHelper.microsoftTeamsLib.initialize()}login(){return __awaiter$6(this,void 0,void 0,(function*(){this.setState(exports.ProviderState.Loading);const t=TeamsHelper.microsoftTeamsLib;return new Promise(((o,s)=>{t.getContext((l=>{this.teamsContext=l;const h={clientId:this.clientId,loginHint:l.loginHint,options:this._msalOptions,scopes:this.scopes.join(",")};localStorage.setItem(TeamsProvider._localStorageParametersKey,JSON.stringify(h));const v=new URL(this._authPopupUrl,new URL(window.location.href));t.authentication.authenticate({failureCallback:t=>{this.setState(exports.ProviderState.SignedOut),s()},successCallback:t=>{this.trySilentSignIn(),o()},url:v.href})}))}))}))}logout(){return __awaiter$6(this,void 0,void 0,(function*(){const t=TeamsHelper.microsoftTeamsLib;return new Promise(((o,s)=>{t.getContext((l=>{this.teamsContext=l;const h=new URL(this._authPopupUrl,new URL(window.location.href));h.searchParams.append("signout","true"),t.authentication.authenticate({failureCallback:t=>{this.trySilentSignIn(),s()},successCallback:t=>{this.trySilentSignIn(),o()},url:h.href})}))}))}))}getAccessToken(t){return __awaiter$6(this,void 0,void 0,(function*(){if(!this.teamsContext&&TeamsHelper.microsoftTeamsLib){const t=TeamsHelper.microsoftTeamsLib;t.initialize(),this.teamsContext=yield t.getContext()}const o={scopes:t&&t.scopes||this.scopes};this.teamsContext&&this.teamsContext.loginHint&&(o.loginHint=this.teamsContext.loginHint);try{return(yield this.userAgentApplication.acquireTokenSilent(o)).accessToken}catch(t){if(this.requiresInteraction(t))return null;throw t}}))}}TeamsProvider._localStorageParametersKey="msg-teamsprovider-auth-parameters",TeamsProvider._sessionStorageLoginInProgress="msg-teamsprovider-login-in-progress",TeamsProvider._sessionStorageLogoutInProgress="msg-teamsprovider-logout-in-progress";var __decorate$4=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},__metadata$4=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)};exports.MgtTeamsProvider=class MgtTeamsProvider extends MgtBaseProvider{constructor(){super(...arguments),this.clientId="",this.authPopupUrl=""}get isAvailable(){return TeamsProvider.isAvailable}initializeProvider(){if(this.clientId&&this.authPopupUrl){const t={authPopupUrl:this.authPopupUrl,clientId:this.clientId};if(this.scopes){const o=this.scopes.split(",");o&&o.length>0&&(t.scopes=o)}if(this.authority){const o={auth:{authority:this.authority,clientId:this.clientId}};t.msalOptions=o}this.baseUrl&&(t.baseURL=this.baseUrl),this.provider=new TeamsProvider(t),Providers.globalProvider=this.provider}}},__decorate$4([e$1({attribute:"client-id",type:String}),__metadata$4("design:type",Object)],exports.MgtTeamsProvider.prototype,"clientId",void 0),__decorate$4([e$1({attribute:"auth-popup-url",type:String}),__metadata$4("design:type",Object)],exports.MgtTeamsProvider.prototype,"authPopupUrl",void 0),__decorate$4([e$1(),__metadata$4("design:type",Object)],exports.MgtTeamsProvider.prototype,"authority",void 0),__decorate$4([e$1({attribute:"scopes",type:String}),__metadata$4("design:type",Object)],exports.MgtTeamsProvider.prototype,"scopes",void 0),exports.MgtTeamsProvider=__decorate$4([customElement("teams-provider")],exports.MgtTeamsProvider);var __awaiter$5=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};class CustomHeaderMiddleware{constructor(t){this._getCustomHeaders=t}execute(t){return __awaiter$5(this,void 0,void 0,(function*(){if(this._getCustomHeaders){const o=yield this._getCustomHeaders();for(const s in o)o.hasOwnProperty(s)&&setRequestHeader(t.request,t.options,s,o[s])}return yield this.nextMiddleware.execute(t)}))}setNext(t){this.nextMiddleware=t}}class ProxyGraph extends Graph{constructor(t,o){const s=[new RetryHandler(new RetryHandlerOptions),new TelemetryHandler,new SdkVersionMiddleware(ZE),new CustomHeaderMiddleware(o),new HTTPMessageHandler];super(Client.initWithMiddleware({baseUrl:t,middleware:chainMiddleware(...s),customHosts:new Set([new URL(t).hostname])}))}}class ProxyProvider extends IProvider{get name(){return"MgtProxyProvider"}constructor(t,o=null){super(),this.graph=new ProxyGraph(t,o),this.graph.api("me").get().then((t=>{null!=t?this.setState(exports.ProviderState.SignedIn):this.setState(exports.ProviderState.SignedOut)}),(t=>{this.setState(exports.ProviderState.SignedOut)}))}getAccessToken(){return null}}var __decorate$3=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},__metadata$3=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)};exports.MgtProxyProvider=class MgtProxyProvider extends MgtBaseProvider{get isAvailable(){return!0}initializeProvider(){void 0!==this.graphProxyUrl&&(this.provider=new ProxyProvider(this.graphProxyUrl),Providers.globalProvider=this.provider)}},__decorate$3([e$1({attribute:"graph-proxy-url"}),__metadata$3("design:type",String)],exports.MgtProxyProvider.prototype,"graphProxyUrl",void 0),exports.MgtProxyProvider=__decorate$3([customElement("proxy-provider")],exports.MgtProxyProvider);var __awaiter$4=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};
/*! @azure/msal-browser v2.33.0 2023-02-06 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var extendStatics$1=function(t,o){return extendStatics$1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(t[s]=o[s])},extendStatics$1(t,o)};function __extends$1(t,o){function __(){this.constructor=t}extendStatics$1(t,o),t.prototype=null===o?Object.create(o):(__.prototype=o.prototype,new __)}var __assign$1=function(){return __assign$1=Object.assign||function __assign(t){for(var o,s=1,l=arguments.length;s<l;s++)for(var h in o=arguments[s])Object.prototype.hasOwnProperty.call(o,h)&&(t[h]=o[h]);return t},__assign$1.apply(this,arguments)};function __rest(t,o){var s={};for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&o.indexOf(l)<0&&(s[l]=t[l]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var h=0;for(l=Object.getOwnPropertySymbols(t);h<l.length;h++)o.indexOf(l[h])<0&&Object.prototype.propertyIsEnumerable.call(t,l[h])&&(s[l[h]]=t[l[h]])}return s}function __awaiter$3(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))}function __generator$1(t,o){var s,l,h,v,m={label:0,sent:function(){if(1&h[0])throw h[1];return h[1]},trys:[],ops:[]};return v={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(v[Symbol.iterator]=function(){return this}),v;function verb(v){return function(_){return function step(v){if(s)throw new TypeError("Generator is already executing.");for(;m;)try{if(s=1,l&&(h=2&v[0]?l.return:v[0]?l.throw||((h=l.return)&&h.call(l),0):l.next)&&!(h=h.call(l,v[1])).done)return h;switch(l=0,h&&(v=[2&v[0],h.value]),v[0]){case 0:case 1:h=v;break;case 4:return m.label++,{value:v[1],done:!1};case 5:m.label++,l=v[1],v=[0];continue;case 7:v=m.ops.pop(),m.trys.pop();continue;default:if(!(h=m.trys,(h=h.length>0&&h[h.length-1])||6!==v[0]&&2!==v[0])){m=0;continue}if(3===v[0]&&(!h||v[1]>h[0]&&v[1]<h[3])){m.label=v[1];break}if(6===v[0]&&m.label<h[1]){m.label=h[1],h=v;break}if(h&&m.label<h[2]){m.label=h[2],m.ops.push(v);break}h[2]&&m.ops.pop(),m.trys.pop();continue}v=o.call(t,m)}catch(t){v=[6,t],l=0}finally{s=h=0}if(5&v[0])throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}([v,_])}}}function __read(t,o){var s="function"==typeof Symbol&&t[Symbol.iterator];if(!s)return t;var l,h,v=s.call(t),m=[];try{for(;(void 0===o||o-- >0)&&!(l=v.next()).done;)m.push(l.value)}catch(t){h={error:t}}finally{try{l&&!l.done&&(s=v.return)&&s.call(v)}finally{if(h)throw h.error}}return m}function __spread(){for(var t=[],o=0;o<arguments.length;o++)t=t.concat(__read(arguments[o]));return t}
/*! @azure/msal-common v10.0.0 2023-02-06 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var extendStatics=function(t,o){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(t[s]=o[s])},extendStatics(t,o)};function __extends(t,o){function __(){this.constructor=t}extendStatics(t,o),t.prototype=null===o?Object.create(o):(__.prototype=o.prototype,new __)}var __assign=function(){return __assign=Object.assign||function __assign(t){for(var o,s=1,l=arguments.length;s<l;s++)for(var h in o=arguments[s])Object.prototype.hasOwnProperty.call(o,h)&&(t[h]=o[h]);return t},__assign.apply(this,arguments)};function __awaiter$2(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))}function __generator(t,o){var s,l,h,v,m={label:0,sent:function(){if(1&h[0])throw h[1];return h[1]},trys:[],ops:[]};return v={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(v[Symbol.iterator]=function(){return this}),v;function verb(v){return function(_){return function step(v){if(s)throw new TypeError("Generator is already executing.");for(;m;)try{if(s=1,l&&(h=2&v[0]?l.return:v[0]?l.throw||((h=l.return)&&h.call(l),0):l.next)&&!(h=h.call(l,v[1])).done)return h;switch(l=0,h&&(v=[2&v[0],h.value]),v[0]){case 0:case 1:h=v;break;case 4:return m.label++,{value:v[1],done:!1};case 5:m.label++,l=v[1],v=[0];continue;case 7:v=m.ops.pop(),m.trys.pop();continue;default:if(!(h=m.trys,(h=h.length>0&&h[h.length-1])||6!==v[0]&&2!==v[0])){m=0;continue}if(3===v[0]&&(!h||v[1]>h[0]&&v[1]<h[3])){m.label=v[1];break}if(6===v[0]&&m.label<h[1]){m.label=h[1],h=v;break}if(h&&m.label<h[2]){m.label=h[2],m.ops.push(v);break}h[2]&&m.ops.pop(),m.trys.pop();continue}v=o.call(t,m)}catch(t){v=[6,t],l=0}finally{s=h=0}if(5&v[0])throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}([v,_])}}}function __spreadArrays(){for(var t=0,o=0,s=arguments.length;o<s;o++)t+=arguments[o].length;var l=Array(t),h=0;for(o=0;o<s;o++)for(var v=arguments[o],m=0,_=v.length;m<_;m++,h++)l[h]=v[m];return l}
/*! @azure/msal-common v10.0.0 2023-02-06 */var GU,KU,WU,QU,YU,JU={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",REGIONAL_AUTH_NON_MSI_QUERY_STRING:"allowestsrnonmsi=true",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},XU=[JU.OPENID_SCOPE,JU.PROFILE_SCOPE,JU.OFFLINE_ACCESS_SCOPE],ZU=__spreadArrays(XU,[JU.EMAIL_SCOPE]);!function(t){t.CONTENT_TYPE="Content-Type",t.RETRY_AFTER="Retry-After",t.CCS_HEADER="X-AnchorMailbox",t.WWWAuthenticate="WWW-Authenticate",t.AuthenticationInfo="Authentication-Info",t.X_MS_REQUEST_ID="x-ms-request-id",t.X_MS_HTTP_VERSION="x-ms-httpver"}(GU||(GU={})),function(t){t.ID_TOKEN="idtoken",t.CLIENT_INFO="client.info",t.ADAL_ID_TOKEN="adal.idtoken",t.ERROR="error",t.ERROR_DESC="error.description",t.ACTIVE_ACCOUNT="active-account",t.ACTIVE_ACCOUNT_FILTERS="active-account-filters"}(KU||(KU={})),function(t){t.COMMON="common",t.ORGANIZATIONS="organizations",t.CONSUMERS="consumers"}(WU||(WU={})),function(t){t.CLIENT_ID="client_id",t.REDIRECT_URI="redirect_uri",t.RESPONSE_TYPE="response_type",t.RESPONSE_MODE="response_mode",t.GRANT_TYPE="grant_type",t.CLAIMS="claims",t.SCOPE="scope",t.ERROR="error",t.ERROR_DESCRIPTION="error_description",t.ACCESS_TOKEN="access_token",t.ID_TOKEN="id_token",t.REFRESH_TOKEN="refresh_token",t.EXPIRES_IN="expires_in",t.STATE="state",t.NONCE="nonce",t.PROMPT="prompt",t.SESSION_STATE="session_state",t.CLIENT_INFO="client_info",t.CODE="code",t.CODE_CHALLENGE="code_challenge",t.CODE_CHALLENGE_METHOD="code_challenge_method",t.CODE_VERIFIER="code_verifier",t.CLIENT_REQUEST_ID="client-request-id",t.X_CLIENT_SKU="x-client-SKU",t.X_CLIENT_VER="x-client-VER",t.X_CLIENT_OS="x-client-OS",t.X_CLIENT_CPU="x-client-CPU",t.X_CLIENT_CURR_TELEM="x-client-current-telemetry",t.X_CLIENT_LAST_TELEM="x-client-last-telemetry",t.X_MS_LIB_CAPABILITY="x-ms-lib-capability",t.X_APP_NAME="x-app-name",t.X_APP_VER="x-app-ver",t.POST_LOGOUT_URI="post_logout_redirect_uri",t.ID_TOKEN_HINT="id_token_hint",t.DEVICE_CODE="device_code",t.CLIENT_SECRET="client_secret",t.CLIENT_ASSERTION="client_assertion",t.CLIENT_ASSERTION_TYPE="client_assertion_type",t.TOKEN_TYPE="token_type",t.REQ_CNF="req_cnf",t.OBO_ASSERTION="assertion",t.REQUESTED_TOKEN_USE="requested_token_use",t.ON_BEHALF_OF="on_behalf_of",t.FOCI="foci",t.CCS_HEADER="X-AnchorMailbox",t.RETURN_SPA_CODE="return_spa_code",t.NATIVE_BROKER="nativebroker",t.LOGOUT_HINT="logout_hint"}(QU||(QU={})),function(t){t.ACCESS_TOKEN="access_token",t.XMS_CC="xms_cc"}(YU||(YU={}));var eH,tH={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"};!function(t){t.ACCOUNT="account",t.SID="sid",t.LOGIN_HINT="login_hint",t.ID_TOKEN="id_token",t.DOMAIN_HINT="domain_hint",t.ORGANIZATIONS="organizations",t.CONSUMERS="consumers",t.ACCOUNT_ID="accountIdentifier",t.HOMEACCOUNT_ID="homeAccountIdentifier"}(eH||(eH={}));var rH,oH,nH,iH,sH,aH,lH,cH={PLAIN:"plain",S256:"S256"};!function(t){t.QUERY="query",t.FRAGMENT="fragment",t.FORM_POST="form_post"}(rH||(rH={})),function(t){t.IMPLICIT_GRANT="implicit",t.AUTHORIZATION_CODE_GRANT="authorization_code",t.CLIENT_CREDENTIALS_GRANT="client_credentials",t.RESOURCE_OWNER_PASSWORD_GRANT="password",t.REFRESH_TOKEN_GRANT="refresh_token",t.DEVICE_CODE_GRANT="device_code",t.JWT_BEARER="urn:ietf:params:oauth:grant-type:jwt-bearer"}(oH||(oH={})),function(t){t.MSSTS_ACCOUNT_TYPE="MSSTS",t.ADFS_ACCOUNT_TYPE="ADFS",t.MSAV1_ACCOUNT_TYPE="MSA",t.GENERIC_ACCOUNT_TYPE="Generic"}(nH||(nH={})),function(t){t.CACHE_KEY_SEPARATOR="-",t.CLIENT_INFO_SEPARATOR="."}(iH||(iH={})),function(t){t.ID_TOKEN="IdToken",t.ACCESS_TOKEN="AccessToken",t.ACCESS_TOKEN_WITH_AUTH_SCHEME="AccessToken_With_AuthScheme",t.REFRESH_TOKEN="RefreshToken"}(sH||(sH={})),function(t){t.ACCOUNT="Account",t.CREDENTIAL="Credential",t.ID_TOKEN="IdToken",t.ACCESS_TOKEN="AccessToken",t.REFRESH_TOKEN="RefreshToken",t.APP_METADATA="AppMetadata",t.TEMPORARY="TempCache",t.TELEMETRY="Telemetry",t.UNDEFINED="Undefined",t.THROTTLING="Throttling"}(aH||(aH={})),function(t){t[t.ADFS=1001]="ADFS",t[t.MSA=1002]="MSA",t[t.MSSTS=1003]="MSSTS",t[t.GENERIC=1004]="GENERIC",t[t.ACCESS_TOKEN=2001]="ACCESS_TOKEN",t[t.REFRESH_TOKEN=2002]="REFRESH_TOKEN",t[t.ID_TOKEN=2003]="ID_TOKEN",t[t.APP_METADATA=3001]="APP_METADATA",t[t.UNDEFINED=9999]="UNDEFINED"}(lH||(lH={}));var dH,uH="appmetadata",hH="1",pH={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:86400};!function(t){t.CONFIG="config",t.CACHE="cache",t.NETWORK="network",t.HARDCODED_VALUES="hardcoded_values"}(dH||(dH={}));var fH,gH={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"};!function(t){t.BEARER="Bearer",t.POP="pop",t.SSH="ssh-cert"}(fH||(fH={}));var vH,mH,bH,yH,wH,_H,CH=60,kH=3600,TH="throttling",SH="retry-after, h429",xH="invalid_grant",EH="client_mismatch";!function(t){t.username="username",t.password="password"}(vH||(vH={})),function(t){t[t.httpSuccess=200]="httpSuccess",t[t.httpBadRequest=400]="httpBadRequest"}(mH||(mH={})),function(t){t.FAILED_AUTO_DETECTION="1",t.INTERNAL_CACHE="2",t.ENVIRONMENT_VARIABLE="3",t.IMDS="4"}(bH||(bH={})),function(t){t.CONFIGURED_MATCHES_DETECTED="1",t.CONFIGURED_NO_AUTO_DETECTION="2",t.CONFIGURED_NOT_DETECTED="3",t.AUTO_DETECTION_REQUESTED_SUCCESSFUL="4",t.AUTO_DETECTION_REQUESTED_FAILED="5"}(yH||(yH={})),function(t){t.NO_CACHE_HIT="0",t.FORCE_REFRESH="1",t.NO_CACHED_ACCESS_TOKEN="2",t.CACHED_ACCESS_TOKEN_EXPIRED="3",t.REFRESH_CACHED_ACCESS_TOKEN="4"}(wH||(wH={})),function(t){t.Jwt="JWT",t.Jwk="JWK"}(_H||(_H={}));
/*! @azure/msal-common v10.0.0 2023-02-06 */
var IH,AH={code:"unexpected_error",desc:"Unexpected error in authentication."},PH={code:"post_request_failed",desc:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."},RH=function(t){function AuthError(o,s,l){var h=this,v=s?o+": "+s:o;return h=t.call(this,v)||this,Object.setPrototypeOf(h,AuthError.prototype),h.errorCode=o||JU.EMPTY_STRING,h.errorMessage=s||JU.EMPTY_STRING,h.subError=l||JU.EMPTY_STRING,h.name="AuthError",h}return __extends(AuthError,t),AuthError.prototype.setCorrelationId=function(t){this.correlationId=t},AuthError.createUnexpectedError=function(t){return new AuthError(AH.code,AH.desc+": "+t)},AuthError.createPostRequestFailed=function(t){return new AuthError(PH.code,PH.desc+": "+t)},AuthError}(Error),OH={createNewGuid:function(){throw RH.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw RH.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw RH.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(t){throw"Crypto interface - generatePkceCodes() has not been implemented",RH.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")}))}))},getPublicKeyThumbprint:function(){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(t){throw"Crypto interface - getPublicKeyThumbprint() has not been implemented",RH.createUnexpectedError("Crypto interface - getPublicKeyThumbprint() has not been implemented")}))}))},removeTokenBindingKey:function(){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(t){throw"Crypto interface - removeTokenBindingKey() has not been implemented",RH.createUnexpectedError("Crypto interface - removeTokenBindingKey() has not been implemented")}))}))},clearKeystore:function(){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(t){throw"Crypto interface - clearKeystore() has not been implemented",RH.createUnexpectedError("Crypto interface - clearKeystore() has not been implemented")}))}))},signJwt:function(){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(t){throw"Crypto interface - signJwt() has not been implemented",RH.createUnexpectedError("Crypto interface - signJwt() has not been implemented")}))}))},hashString:function(){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(t){throw"Crypto interface - hashString() has not been implemented",RH.createUnexpectedError("Crypto interface - hashString() has not been implemented")}))}))}},$H={code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},NH={code:"client_info_empty_error",desc:"The client info was empty. Please review the trace to determine the root cause."},MH={code:"token_parsing_error",desc:"Token cannot be parsed. Please review stack trace to determine root cause."},DH={code:"null_or_empty_token",desc:"The token is null or empty. Please review the trace to determine the root cause."},LH={code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},FH={code:"network_error",desc:"Network request failed. Please check network trace to determine root cause."},UH={code:"openid_config_error",desc:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints."},HH={code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},BH={code:"invalid_state",desc:"State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState()."},qH={code:"state_mismatch",desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},jH={code:"state_not_found",desc:"State not found"},zH={code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},VH={code:"nonce_not_found",desc:"nonce not found"},GH={code:"auth_time_not_found",desc:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information."},KH={code:"max_age_transpired",desc:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication."},WH={code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account."},QH={code:"multiple_matching_accounts",desc:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"},YH={code:"multiple_matching_appMetadata",desc:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata"},JH={code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},XH={code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},ZH={code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},eB={code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},tB={code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},rB={code:"device_code_polling_cancelled",desc:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."},oB={code:"device_code_expired",desc:"Device code is expired."},nB={code:"device_code_unknown_error",desc:"Device code stopped polling for unknown reasons."},iB={code:"no_account_in_silent_request",desc:"Please pass an account object, silent flow is not supported without account information"},sB={code:"invalid_cache_record",desc:"Cache record object was null or undefined."},aB={code:"invalid_cache_environment",desc:"Invalid environment when attempting to create cache entry"},lB={code:"no_account_found",desc:"No account found in cache for given key."},cB={code:"no cache plugin set on CacheManager",desc:"ICachePlugin needs to be set before using readFromStorage or writeFromStorage"},dB={code:"no_crypto_object",desc:"No crypto object detected. This is required for the following operation: "},uB={code:"invalid_cache_type",desc:"Invalid cache type"},hB={code:"unexpected_account_type",desc:"Unexpected account type."},pB={code:"unexpected_credential_type",desc:"Unexpected credential type."},fB={code:"invalid_assertion",desc:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515"},gB={code:"invalid_client_credential",desc:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential"},vB={code:"token_refresh_required",desc:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired."},mB={code:"user_timeout_reached",desc:"User defined timeout for device code polling reached"},bB={code:"token_claims_cnf_required_for_signedjwt",desc:"Cannot generate a POP jwt if the token_claims are not populated"},yB={code:"authorization_code_missing_from_server_response",desc:"Server response does not contain an authorization code to proceed"},wB={code:"binding_key_not_removed",desc:"Could not remove the credential's binding key from storage."},_B={code:"end_session_endpoint_not_supported",desc:"Provided authority does not support logout."},CB={code:"key_id_missing",desc:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key."},kB=function(t){function ClientAuthError(o,s){var l=t.call(this,o,s)||this;return l.name="ClientAuthError",Object.setPrototypeOf(l,ClientAuthError.prototype),l}return __extends(ClientAuthError,t),ClientAuthError.createClientInfoDecodingError=function(t){return new ClientAuthError($H.code,$H.desc+" Failed with error: "+t)},ClientAuthError.createClientInfoEmptyError=function(){return new ClientAuthError(NH.code,""+NH.desc)},ClientAuthError.createTokenParsingError=function(t){return new ClientAuthError(MH.code,MH.desc+" Failed with error: "+t)},ClientAuthError.createTokenNullOrEmptyError=function(t){return new ClientAuthError(DH.code,DH.desc+" Raw Token Value: "+t)},ClientAuthError.createEndpointDiscoveryIncompleteError=function(t){return new ClientAuthError(LH.code,LH.desc+" Detail: "+t)},ClientAuthError.createNetworkError=function(t,o){return new ClientAuthError(FH.code,FH.desc+" | Fetch client threw: "+o+" | Attempted to reach: "+t.split("?")[0])},ClientAuthError.createUnableToGetOpenidConfigError=function(t){return new ClientAuthError(UH.code,UH.desc+" Attempted to retrieve endpoints from: "+t)},ClientAuthError.createHashNotDeserializedError=function(t){return new ClientAuthError(HH.code,HH.desc+" Given Object: "+t)},ClientAuthError.createInvalidStateError=function(t,o){return new ClientAuthError(BH.code,BH.desc+" Invalid State: "+t+", Root Err: "+o)},ClientAuthError.createStateMismatchError=function(){return new ClientAuthError(qH.code,qH.desc)},ClientAuthError.createStateNotFoundError=function(t){return new ClientAuthError(jH.code,jH.desc+":  "+t)},ClientAuthError.createNonceMismatchError=function(){return new ClientAuthError(zH.code,zH.desc)},ClientAuthError.createAuthTimeNotFoundError=function(){return new ClientAuthError(GH.code,GH.desc)},ClientAuthError.createMaxAgeTranspiredError=function(){return new ClientAuthError(KH.code,KH.desc)},ClientAuthError.createNonceNotFoundError=function(t){return new ClientAuthError(VH.code,VH.desc+":  "+t)},ClientAuthError.createMultipleMatchingTokensInCacheError=function(){return new ClientAuthError(WH.code,WH.desc+".")},ClientAuthError.createMultipleMatchingAccountsInCacheError=function(){return new ClientAuthError(QH.code,QH.desc)},ClientAuthError.createMultipleMatchingAppMetadataInCacheError=function(){return new ClientAuthError(YH.code,YH.desc)},ClientAuthError.createTokenRequestCannotBeMadeError=function(){return new ClientAuthError(JH.code,JH.desc)},ClientAuthError.createAppendEmptyScopeToSetError=function(t){return new ClientAuthError(XH.code,XH.desc+" Given Scope: "+t)},ClientAuthError.createRemoveEmptyScopeFromSetError=function(t){return new ClientAuthError(ZH.code,ZH.desc+" Given Scope: "+t)},ClientAuthError.createAppendScopeSetError=function(t){return new ClientAuthError(eB.code,eB.desc+" Detail Error: "+t)},ClientAuthError.createEmptyInputScopeSetError=function(){return new ClientAuthError(tB.code,""+tB.desc)},ClientAuthError.createDeviceCodeCancelledError=function(){return new ClientAuthError(rB.code,""+rB.desc)},ClientAuthError.createDeviceCodeExpiredError=function(){return new ClientAuthError(oB.code,""+oB.desc)},ClientAuthError.createDeviceCodeUnknownError=function(){return new ClientAuthError(nB.code,""+nB.desc)},ClientAuthError.createNoAccountInSilentRequestError=function(){return new ClientAuthError(iB.code,""+iB.desc)},ClientAuthError.createNullOrUndefinedCacheRecord=function(){return new ClientAuthError(sB.code,sB.desc)},ClientAuthError.createInvalidCacheEnvironmentError=function(){return new ClientAuthError(aB.code,aB.desc)},ClientAuthError.createNoAccountFoundError=function(){return new ClientAuthError(lB.code,lB.desc)},ClientAuthError.createCachePluginError=function(){return new ClientAuthError(cB.code,""+cB.desc)},ClientAuthError.createNoCryptoObjectError=function(t){return new ClientAuthError(dB.code,""+dB.desc+t)},ClientAuthError.createInvalidCacheTypeError=function(){return new ClientAuthError(uB.code,""+uB.desc)},ClientAuthError.createUnexpectedAccountTypeError=function(){return new ClientAuthError(hB.code,""+hB.desc)},ClientAuthError.createUnexpectedCredentialTypeError=function(){return new ClientAuthError(pB.code,""+pB.desc)},ClientAuthError.createInvalidAssertionError=function(){return new ClientAuthError(fB.code,""+fB.desc)},ClientAuthError.createInvalidCredentialError=function(){return new ClientAuthError(gB.code,""+gB.desc)},ClientAuthError.createRefreshRequiredError=function(){return new ClientAuthError(vB.code,vB.desc)},ClientAuthError.createUserTimeoutReachedError=function(){return new ClientAuthError(mB.code,mB.desc)},ClientAuthError.createTokenClaimsRequiredError=function(){return new ClientAuthError(bB.code,bB.desc)},ClientAuthError.createNoAuthCodeInServerResponseError=function(){return new ClientAuthError(yB.code,yB.desc)},ClientAuthError.createBindingKeyNotRemovedError=function(){return new ClientAuthError(wB.code,wB.desc)},ClientAuthError.createLogoutNotSupportedError=function(){return new ClientAuthError(_B.code,_B.desc)},ClientAuthError.createKeyIdMissingError=function(){return new ClientAuthError(CB.code,CB.desc)},ClientAuthError}(RH),TB=function(){function StringUtils(){}return StringUtils.decodeAuthToken=function(t){if(StringUtils.isEmpty(t))throw kB.createTokenNullOrEmptyError(t);var o=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);if(!o||o.length<4)throw kB.createTokenParsingError("Given token is malformed: "+JSON.stringify(t));return{header:o[1],JWSPayload:o[2],JWSSig:o[3]}},StringUtils.isEmpty=function(t){return void 0===t||!t||0===t.length},StringUtils.isEmptyObj=function(t){if(t&&!StringUtils.isEmpty(t))try{var o=JSON.parse(t);return 0===Object.keys(o).length}catch(t){}return!0},StringUtils.startsWith=function(t,o){return 0===t.indexOf(o)},StringUtils.endsWith=function(t,o){return t.length>=o.length&&t.lastIndexOf(o)===t.length-o.length},StringUtils.queryStringToObject=function(t){var o={},s=t.split("&"),decode=function(t){return decodeURIComponent(t.replace(/\+/g," "))};return s.forEach((function(t){if(t.trim()){var s=t.split(/=(.+)/g,2),l=s[0],h=s[1];l&&h&&(o[decode(l)]=decode(h))}})),o},StringUtils.trimArrayEntries=function(t){return t.map((function(t){return t.trim()}))},StringUtils.removeEmptyStringsFromArray=function(t){return t.filter((function(t){return!StringUtils.isEmpty(t)}))},StringUtils.jsonParseHelper=function(t){try{return JSON.parse(t)}catch(t){return null}},StringUtils.matchPattern=function(t,o){return new RegExp(t.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(o)},StringUtils}();!function(t){t[t.Error=0]="Error",t[t.Warning=1]="Warning",t[t.Info=2]="Info",t[t.Verbose=3]="Verbose",t[t.Trace=4]="Trace"}(IH||(IH={}));var SB,xB=function(){function Logger(t,o,s){this.level=IH.Info;var l=t||Logger.createDefaultLoggerOptions();this.localCallback=l.loggerCallback||function(){},this.piiLoggingEnabled=l.piiLoggingEnabled||!1,this.level="number"==typeof l.logLevel?l.logLevel:IH.Info,this.correlationId=l.correlationId||JU.EMPTY_STRING,this.packageName=o||JU.EMPTY_STRING,this.packageVersion=s||JU.EMPTY_STRING}return Logger.createDefaultLoggerOptions=function(){return{loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:IH.Info}},Logger.prototype.clone=function(t,o,s){return new Logger({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:s||this.correlationId},t,o)},Logger.prototype.logMessage=function(t,o){if(!(o.logLevel>this.level||!this.piiLoggingEnabled&&o.containsPii)){var s=(new Date).toUTCString(),l=(TB.isEmpty(o.correlationId)?TB.isEmpty(this.correlationId)?"["+s+"]":"["+s+"] : ["+this.correlationId+"]":"["+s+"] : ["+o.correlationId+"]")+" : "+this.packageName+"@"+this.packageVersion+" : "+IH[o.logLevel]+" - "+t;this.executeCallback(o.logLevel,l,o.containsPii||!1)}},Logger.prototype.executeCallback=function(t,o,s){this.localCallback&&this.localCallback(t,o,s)},Logger.prototype.error=function(t,o){this.logMessage(t,{logLevel:IH.Error,containsPii:!1,correlationId:o||JU.EMPTY_STRING})},Logger.prototype.errorPii=function(t,o){this.logMessage(t,{logLevel:IH.Error,containsPii:!0,correlationId:o||JU.EMPTY_STRING})},Logger.prototype.warning=function(t,o){this.logMessage(t,{logLevel:IH.Warning,containsPii:!1,correlationId:o||JU.EMPTY_STRING})},Logger.prototype.warningPii=function(t,o){this.logMessage(t,{logLevel:IH.Warning,containsPii:!0,correlationId:o||JU.EMPTY_STRING})},Logger.prototype.info=function(t,o){this.logMessage(t,{logLevel:IH.Info,containsPii:!1,correlationId:o||JU.EMPTY_STRING})},Logger.prototype.infoPii=function(t,o){this.logMessage(t,{logLevel:IH.Info,containsPii:!0,correlationId:o||JU.EMPTY_STRING})},Logger.prototype.verbose=function(t,o){this.logMessage(t,{logLevel:IH.Verbose,containsPii:!1,correlationId:o||JU.EMPTY_STRING})},Logger.prototype.verbosePii=function(t,o){this.logMessage(t,{logLevel:IH.Verbose,containsPii:!0,correlationId:o||JU.EMPTY_STRING})},Logger.prototype.trace=function(t,o){this.logMessage(t,{logLevel:IH.Trace,containsPii:!1,correlationId:o||JU.EMPTY_STRING})},Logger.prototype.tracePii=function(t,o){this.logMessage(t,{logLevel:IH.Trace,containsPii:!0,correlationId:o||JU.EMPTY_STRING})},Logger.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},Logger}(),EB="@azure/msal-common",IB="10.0.0";
/*! @azure/msal-common v10.0.0 2023-02-06 */!function(t){t[t.None=0]="None",t.AzurePublic="https://login.microsoftonline.com",t.AzurePpe="https://login.windows-ppe.net",t.AzureChina="https://login.chinacloudapi.cn",t.AzureGermany="https://login.microsoftonline.de",t.AzureUsGovernment="https://login.microsoftonline.us"}(SB||(SB={}));
/*! @azure/msal-common v10.0.0 2023-02-06 */
var AB=function(){function CredentialEntity(){}return CredentialEntity._initRegex=function(){var t=iH.CACHE_KEY_SEPARATOR;CredentialEntity.credentialRegexMap=new Map;for(var o=0,s=Object.keys(sH);o<s.length;o++){var l=s[o],h=sH[l].toLowerCase();try{CredentialEntity.credentialRegexMap.set(sH[l],new RegExp("(?<="+t+CredentialEntity.credentialDomainRegex+")"+t+h+t))}catch(o){CredentialEntity.credentialRegexMap.set(sH[l],new RegExp(""+t+CredentialEntity.credentialDomainRegex+t+h+t))}}},CredentialEntity.prototype.generateAccountId=function(){return CredentialEntity.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},CredentialEntity.prototype.generateCredentialId=function(){return CredentialEntity.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},CredentialEntity.prototype.generateTarget=function(){return CredentialEntity.generateTargetForCacheKey(this.target)},CredentialEntity.prototype.generateCredentialKey=function(){return CredentialEntity.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId,this.tokenType,this.requestedClaimsHash)},CredentialEntity.prototype.generateType=function(){switch(this.credentialType){case sH.ID_TOKEN:return lH.ID_TOKEN;case sH.ACCESS_TOKEN:case sH.ACCESS_TOKEN_WITH_AUTH_SCHEME:return lH.ACCESS_TOKEN;case sH.REFRESH_TOKEN:return lH.REFRESH_TOKEN;default:throw kB.createUnexpectedCredentialTypeError()}},CredentialEntity.getCredentialType=function(t){for(var o,s=0,l=Object.keys(sH);s<l.length;s++){var h=l[s];if(null===(o=this.credentialRegexMap.get(sH[h]))||void 0===o?void 0:o.test(t.toLowerCase()))return sH[h]}return JU.NOT_DEFINED},CredentialEntity.generateCredentialCacheKey=function(t,o,s,l,h,v,m,_,R){return[this.generateAccountIdForCacheKey(t,o),this.generateCredentialIdForCacheKey(s,l,h,m),this.generateTargetForCacheKey(v),this.generateClaimsHashForCacheKey(R),this.generateSchemeForCacheKey(_)].join(iH.CACHE_KEY_SEPARATOR).toLowerCase()},CredentialEntity.generateAccountIdForCacheKey=function(t,o){return[t,o].join(iH.CACHE_KEY_SEPARATOR).toLowerCase()},CredentialEntity.generateCredentialIdForCacheKey=function(t,o,s,l){return[t,t===sH.REFRESH_TOKEN&&l||o,s||JU.EMPTY_STRING].join(iH.CACHE_KEY_SEPARATOR).toLowerCase()},CredentialEntity.generateTargetForCacheKey=function(t){return(t||JU.EMPTY_STRING).toLowerCase()},CredentialEntity.generateClaimsHashForCacheKey=function(t){return(t||JU.EMPTY_STRING).toLowerCase()},CredentialEntity.generateSchemeForCacheKey=function(t){return t&&t.toLowerCase()!==fH.BEARER.toLowerCase()?t.toLowerCase():JU.EMPTY_STRING},CredentialEntity.credentialDomainRegex="(https?:\\/\\/)?((([\\w-]+\\.)*([\\w-]{1,63})(\\.(\\w{2,63})))|(localhost))(\\:[0-9]{4,5})?",CredentialEntity}();AB._initRegex();
/*! @azure/msal-common v10.0.0 2023-02-06 */
var PB,RB={code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},OB={code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},$B={code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},NB={code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},MB={code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},DB={code:"empty_url_error",desc:"URL was empty or null."},LB={code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},FB={code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},UB={code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent', 'create', 'none' and 'no_session'.  Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest"},HB={code:"invalid_claims",desc:"Given claims parameter must be a stringified JSON object."},BB={code:"token_request_empty",desc:"Token request was empty and not found in cache."},qB={code:"logout_request_empty",desc:"The logout request was null or undefined."},jB={code:"invalid_code_challenge_method",desc:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'},zB={code:"pkce_params_missing",desc:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"},VB={code:"invalid_cloud_discovery_metadata",desc:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields"},GB={code:"invalid_authority_metadata",desc:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields."},KB={code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter."},WB={code:"invalid_azure_cloud_instance",desc:"Invalid AzureCloudInstance provided. Please refer MSAL JS docs: aks.ms/msaljs/azure_cloud_instance for valid values"},QB={code:"missing_ssh_jwk",desc:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme."},YB={code:"missing_ssh_kid",desc:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme."},JB={code:"missing_nonce_authentication_header",desc:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce."},XB={code:"invalid_authentication_header",desc:"Invalid authentication header provided"},ZB=function(t){function ClientConfigurationError(o,s){var l=t.call(this,o,s)||this;return l.name="ClientConfigurationError",Object.setPrototypeOf(l,ClientConfigurationError.prototype),l}return __extends(ClientConfigurationError,t),ClientConfigurationError.createRedirectUriEmptyError=function(){return new ClientConfigurationError(RB.code,RB.desc)},ClientConfigurationError.createPostLogoutRedirectUriEmptyError=function(){return new ClientConfigurationError(OB.code,OB.desc)},ClientConfigurationError.createClaimsRequestParsingError=function(t){return new ClientConfigurationError($B.code,$B.desc+" Given value: "+t)},ClientConfigurationError.createInsecureAuthorityUriError=function(t){return new ClientConfigurationError(NB.code,NB.desc+" Given URI: "+t)},ClientConfigurationError.createUrlParseError=function(t){return new ClientConfigurationError(MB.code,MB.desc+" Given Error: "+t)},ClientConfigurationError.createUrlEmptyError=function(){return new ClientConfigurationError(DB.code,DB.desc)},ClientConfigurationError.createEmptyScopesArrayError=function(){return new ClientConfigurationError(LB.code,""+LB.desc)},ClientConfigurationError.createClientIdSingleScopeError=function(t){return new ClientConfigurationError(FB.code,FB.desc+" Given Scopes: "+t)},ClientConfigurationError.createInvalidPromptError=function(t){return new ClientConfigurationError(UB.code,UB.desc+" Given value: "+t)},ClientConfigurationError.createInvalidClaimsRequestError=function(){return new ClientConfigurationError(HB.code,HB.desc)},ClientConfigurationError.createEmptyLogoutRequestError=function(){return new ClientConfigurationError(qB.code,qB.desc)},ClientConfigurationError.createEmptyTokenRequestError=function(){return new ClientConfigurationError(BB.code,BB.desc)},ClientConfigurationError.createInvalidCodeChallengeMethodError=function(){return new ClientConfigurationError(jB.code,jB.desc)},ClientConfigurationError.createInvalidCodeChallengeParamsError=function(){return new ClientConfigurationError(zB.code,zB.desc)},ClientConfigurationError.createInvalidCloudDiscoveryMetadataError=function(){return new ClientConfigurationError(VB.code,VB.desc)},ClientConfigurationError.createInvalidAuthorityMetadataError=function(){return new ClientConfigurationError(GB.code,GB.desc)},ClientConfigurationError.createUntrustedAuthorityError=function(){return new ClientConfigurationError(KB.code,KB.desc)},ClientConfigurationError.createInvalidAzureCloudInstanceError=function(){return new ClientConfigurationError(WB.code,WB.desc)},ClientConfigurationError.createMissingSshJwkError=function(){return new ClientConfigurationError(QB.code,QB.desc)},ClientConfigurationError.createMissingSshKidError=function(){return new ClientConfigurationError(YB.code,YB.desc)},ClientConfigurationError.createMissingNonceAuthenticationHeadersError=function(){return new ClientConfigurationError(JB.code,JB.desc)},ClientConfigurationError.createInvalidAuthenticationHeaderError=function(t,o){return new ClientConfigurationError(XB.code,XB.desc+". Invalid header: "+t+". Details: "+o)},ClientConfigurationError}(kB),eq=function(){function ScopeSet(t){var o=this,s=t?TB.trimArrayEntries(__spreadArrays(t)):[],l=s?TB.removeEmptyStringsFromArray(s):[];this.validateInputScopes(l),this.scopes=new Set,l.forEach((function(t){return o.scopes.add(t)}))}return ScopeSet.fromString=function(t){return new ScopeSet((t||JU.EMPTY_STRING).split(" "))},ScopeSet.prototype.validateInputScopes=function(t){if(!t||t.length<1)throw ZB.createEmptyScopesArrayError()},ScopeSet.prototype.containsScope=function(t){var o=new ScopeSet(this.printScopesLowerCase().split(" "));return!TB.isEmpty(t)&&o.scopes.has(t.toLowerCase())},ScopeSet.prototype.containsScopeSet=function(t){var o=this;return!(!t||t.scopes.size<=0)&&(this.scopes.size>=t.scopes.size&&t.asArray().every((function(t){return o.containsScope(t)})))},ScopeSet.prototype.containsOnlyOIDCScopes=function(){var t=this,o=0;return ZU.forEach((function(s){t.containsScope(s)&&(o+=1)})),this.scopes.size===o},ScopeSet.prototype.appendScope=function(t){TB.isEmpty(t)||this.scopes.add(t.trim())},ScopeSet.prototype.appendScopes=function(t){var o=this;try{t.forEach((function(t){return o.appendScope(t)}))}catch(t){throw kB.createAppendScopeSetError(t)}},ScopeSet.prototype.removeScope=function(t){if(TB.isEmpty(t))throw kB.createRemoveEmptyScopeFromSetError(t);this.scopes.delete(t.trim())},ScopeSet.prototype.removeOIDCScopes=function(){var t=this;ZU.forEach((function(o){t.scopes.delete(o)}))},ScopeSet.prototype.unionScopeSets=function(t){if(!t)throw kB.createEmptyInputScopeSetError();var o=new Set;return t.scopes.forEach((function(t){return o.add(t.toLowerCase())})),this.scopes.forEach((function(t){return o.add(t.toLowerCase())})),o},ScopeSet.prototype.intersectingScopeSets=function(t){if(!t)throw kB.createEmptyInputScopeSetError();t.containsOnlyOIDCScopes()||t.removeOIDCScopes();var o=this.unionScopeSets(t),s=t.getScopeCount(),l=this.getScopeCount();return o.size<l+s},ScopeSet.prototype.getScopeCount=function(){return this.scopes.size},ScopeSet.prototype.asArray=function(){var t=[];return this.scopes.forEach((function(o){return t.push(o)})),t},ScopeSet.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):JU.EMPTY_STRING},ScopeSet.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},ScopeSet}();
/*! @azure/msal-common v10.0.0 2023-02-06 */
function buildClientInfo(t,o){if(TB.isEmpty(t))throw kB.createClientInfoEmptyError();try{var s=o.base64Decode(t);return JSON.parse(s)}catch(t){throw kB.createClientInfoDecodingError(t.message)}}function buildClientInfoFromHomeAccountId(t){if(TB.isEmpty(t))throw kB.createClientInfoDecodingError("Home account ID was empty.");var o=t.split(iH.CLIENT_INFO_SEPARATOR,2);return{uid:o[0],utid:o.length<2?JU.EMPTY_STRING:o[1]}}
/*! @azure/msal-common v10.0.0 2023-02-06 */!function(t){t[t.Default=0]="Default",t[t.Adfs=1]="Adfs",t[t.Dsts=2]="Dsts"}(PB||(PB={}));
/*! @azure/msal-common v10.0.0 2023-02-06 */
var tq=function(){function AccountEntity(){}return AccountEntity.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(iH.CACHE_KEY_SEPARATOR).toLowerCase()},AccountEntity.prototype.generateAccountKey=function(){return AccountEntity.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},AccountEntity.prototype.generateType=function(){switch(this.authorityType){case nH.ADFS_ACCOUNT_TYPE:return lH.ADFS;case nH.MSAV1_ACCOUNT_TYPE:return lH.MSA;case nH.MSSTS_ACCOUNT_TYPE:return lH.MSSTS;case nH.GENERIC_ACCOUNT_TYPE:return lH.GENERIC;default:throw kB.createUnexpectedAccountTypeError()}},AccountEntity.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims,nativeAccountId:this.nativeAccountId}},AccountEntity.generateAccountCacheKey=function(t){return[t.homeAccountId,t.environment||JU.EMPTY_STRING,t.tenantId||JU.EMPTY_STRING].join(iH.CACHE_KEY_SEPARATOR).toLowerCase()},AccountEntity.createAccount=function(t,o,s,l,h,v,m,_){var R,$,B,q,j,z,K=new AccountEntity;K.authorityType=nH.MSSTS_ACCOUNT_TYPE,K.clientInfo=t,K.homeAccountId=o,K.nativeAccountId=_;var W=m||l&&l.getPreferredCache();if(!W)throw kB.createInvalidCacheEnvironmentError();if(K.environment=W,K.realm=(null===(R=null==s?void 0:s.claims)||void 0===R?void 0:R.tid)||JU.EMPTY_STRING,s){K.idTokenClaims=s.claims,K.localAccountId=(null===($=null==s?void 0:s.claims)||void 0===$?void 0:$.oid)||(null===(B=null==s?void 0:s.claims)||void 0===B?void 0:B.sub)||JU.EMPTY_STRING;var Z=null===(q=null==s?void 0:s.claims)||void 0===q?void 0:q.preferred_username,te=(null===(j=null==s?void 0:s.claims)||void 0===j?void 0:j.emails)?s.claims.emails[0]:null;K.username=Z||te||JU.EMPTY_STRING,K.name=null===(z=null==s?void 0:s.claims)||void 0===z?void 0:z.name}return K.cloudGraphHostName=h,K.msGraphHost=v,K},AccountEntity.createGenericAccount=function(t,o,s,l,h,v){var m,_,R,$,B=new AccountEntity;B.authorityType=s&&s.authorityType===PB.Adfs?nH.ADFS_ACCOUNT_TYPE:nH.GENERIC_ACCOUNT_TYPE,B.homeAccountId=t,B.realm=JU.EMPTY_STRING;var q=v||s&&s.getPreferredCache();if(!q)throw kB.createInvalidCacheEnvironmentError();return o&&(B.localAccountId=(null===(m=null==o?void 0:o.claims)||void 0===m?void 0:m.oid)||(null===(_=null==o?void 0:o.claims)||void 0===_?void 0:_.sub)||JU.EMPTY_STRING,B.username=(null===(R=null==o?void 0:o.claims)||void 0===R?void 0:R.upn)||JU.EMPTY_STRING,B.name=(null===($=null==o?void 0:o.claims)||void 0===$?void 0:$.name)||JU.EMPTY_STRING,B.idTokenClaims=null==o?void 0:o.claims),B.environment=q,B.cloudGraphHostName=l,B.msGraphHost=h,B},AccountEntity.generateHomeAccountId=function(t,o,s,l,h){var v,m=(null===(v=null==h?void 0:h.claims)||void 0===v?void 0:v.sub)?h.claims.sub:JU.EMPTY_STRING;if(o===PB.Adfs||o===PB.Dsts)return m;if(t)try{var _=buildClientInfo(t,l);if(!TB.isEmpty(_.uid)&&!TB.isEmpty(_.utid))return""+_.uid+iH.CLIENT_INFO_SEPARATOR+_.utid}catch(t){}return s.verbose("No client info in response"),m},AccountEntity.isAccountEntity=function(t){return!!t&&(t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("realm")&&t.hasOwnProperty("localAccountId")&&t.hasOwnProperty("username")&&t.hasOwnProperty("authorityType"))},AccountEntity.accountInfoIsEqual=function(t,o,s){if(!t||!o)return!1;var l=!0;if(s){var h=t.idTokenClaims||{},v=o.idTokenClaims||{};l=h.iat===v.iat&&h.nonce===v.nonce}return t.homeAccountId===o.homeAccountId&&t.localAccountId===o.localAccountId&&t.username===o.username&&t.tenantId===o.tenantId&&t.environment===o.environment&&t.nativeAccountId===o.nativeAccountId&&l},AccountEntity}(),rq=function(){function AuthToken(t,o){if(TB.isEmpty(t))throw kB.createTokenNullOrEmptyError(t);this.rawToken=t,this.claims=AuthToken.extractTokenClaims(t,o)}return AuthToken.extractTokenClaims=function(t,o){var s=TB.decodeAuthToken(t);try{var l=s.JWSPayload,h=o.base64Decode(l);return JSON.parse(h)}catch(t){throw kB.createTokenParsingError(t)}},AuthToken.checkMaxAge=function(t,o){if(0===o||Date.now()-3e5>t+o)throw kB.createMaxAgeTranspiredError()},AuthToken}(),oq=function(){function CacheManager(t,o){this.clientId=t,this.cryptoImpl=o}return CacheManager.prototype.getAllAccounts=function(){var t=this,o=this.getAccountsFilteredBy(),s=Object.keys(o).map((function(t){return o[t]}));return s.length<1?[]:s.map((function(o){var s=CacheManager.toObject(new tq,o).getAccountInfo(),l=t.readIdTokenFromCache(t.clientId,s);return l&&!s.idTokenClaims&&(s.idToken=l.secret,s.idTokenClaims=new rq(l.secret,t.cryptoImpl).claims),s}))},CacheManager.prototype.saveCacheRecord=function(t){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(o){switch(o.label){case 0:if(!t)throw kB.createNullOrUndefinedCacheRecord();return t.account&&this.setAccount(t.account),t.idToken&&this.setIdTokenCredential(t.idToken),t.accessToken?[4,this.saveAccessToken(t.accessToken)]:[3,2];case 1:o.sent(),o.label=2;case 2:return t.refreshToken&&this.setRefreshTokenCredential(t.refreshToken),t.appMetadata&&this.setAppMetadata(t.appMetadata),[2]}}))}))},CacheManager.prototype.saveAccessToken=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o,s,l,h,v=this;return __generator(this,(function(m){switch(m.label){case 0:return o=this.getCredentialsFilteredBy({clientId:t.clientId,credentialType:t.credentialType,environment:t.environment,homeAccountId:t.homeAccountId,realm:t.realm,tokenType:t.tokenType,requestedClaimsHash:t.requestedClaimsHash}),s=eq.fromString(t.target),l=Object.keys(o.accessTokens).map((function(t){return o.accessTokens[t]})),l?(h=[],l.forEach((function(t){eq.fromString(t.target).intersectingScopeSets(s)&&h.push(v.removeCredential(t))})),[4,Promise.all(h)]):[3,2];case 1:m.sent(),m.label=2;case 2:return this.setAccessTokenCredential(t),[2]}}))}))},CacheManager.prototype.getAccountsFilteredBy=function(t){return this.getAccountsFilteredByInternal(t?t.homeAccountId:JU.EMPTY_STRING,t?t.environment:JU.EMPTY_STRING,t?t.realm:JU.EMPTY_STRING,t?t.nativeAccountId:JU.EMPTY_STRING)},CacheManager.prototype.getAccountsFilteredByInternal=function(t,o,s,l){var h=this,v=this.getKeys(),m={};return v.forEach((function(v){var _=h.getAccount(v);_&&(t&&!h.matchHomeAccountId(_,t)||o&&!h.matchEnvironment(_,o)||s&&!h.matchRealm(_,s)||l&&!h.matchNativeAccountId(_,l)||(m[v]=_))})),m},CacheManager.prototype.getCredentialsFilteredBy=function(t){return this.getCredentialsFilteredByInternal(t.homeAccountId,t.environment,t.credentialType,t.clientId,t.familyId,t.realm,t.target,t.userAssertionHash,t.tokenType,t.keyId,t.requestedClaimsHash)},CacheManager.prototype.getCredentialsFilteredByInternal=function(t,o,s,l,h,v,m,_,R,$,B){var q=this,j=this.getKeys(),z={idTokens:{},accessTokens:{},refreshTokens:{}};return j.forEach((function(j){var K=AB.getCredentialType(j);if(K!==JU.NOT_DEFINED){var W=q.getSpecificCredential(j,K);if(W&&(!_||q.matchUserAssertionHash(W,_))&&("string"!=typeof t||q.matchHomeAccountId(W,t))&&(!o||q.matchEnvironment(W,o))&&(!v||q.matchRealm(W,v))&&(!s||q.matchCredentialType(W,s))&&(!l||q.matchClientId(W,l))&&(!h||q.matchFamilyId(W,h))&&(!m||q.matchTarget(W,m))&&(!B&&!W.requestedClaimsHash||W.requestedClaimsHash===B)){if(s===sH.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(R&&!q.matchTokenType(W,R))return;if(R===fH.SSH&&$&&!q.matchKeyId(W,$))return}var Z=q.updateCredentialCacheKey(j,W);switch(K){case sH.ID_TOKEN:z.idTokens[Z]=W;break;case sH.ACCESS_TOKEN:case sH.ACCESS_TOKEN_WITH_AUTH_SCHEME:z.accessTokens[Z]=W;break;case sH.REFRESH_TOKEN:z.refreshTokens[Z]=W}}}})),z},CacheManager.prototype.getAppMetadataFilteredBy=function(t){return this.getAppMetadataFilteredByInternal(t.environment,t.clientId)},CacheManager.prototype.getAppMetadataFilteredByInternal=function(t,o){var s=this,l=this.getKeys(),h={};return l.forEach((function(l){if(s.isAppMetadata(l)){var v=s.getAppMetadata(l);v&&(t&&!s.matchEnvironment(v,t)||o&&!s.matchClientId(v,o)||(h[l]=v))}})),h},CacheManager.prototype.getAuthorityMetadataByAlias=function(t){var o=this,s=this.getAuthorityMetadataKeys(),l=null;return s.forEach((function(s){if(o.isAuthorityMetadata(s)&&-1!==s.indexOf(o.clientId)){var h=o.getAuthorityMetadata(s);h&&-1!==h.aliases.indexOf(t)&&(l=h)}})),l},CacheManager.prototype.removeAllAccounts=function(){return __awaiter$2(this,void 0,void 0,(function(){var t,o,s=this;return __generator(this,(function(l){switch(l.label){case 0:return t=this.getKeys(),o=[],t.forEach((function(t){s.getAccount(t)&&o.push(s.removeAccount(t))})),[4,Promise.all(o)];case 1:return l.sent(),[2,!0]}}))}))},CacheManager.prototype.removeAccount=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o;return __generator(this,(function(s){switch(s.label){case 0:if(!(o=this.getAccount(t)))throw kB.createNoAccountFoundError();return[4,this.removeAccountContext(o)];case 1:return[2,s.sent()&&this.removeItem(t,aH.ACCOUNT)]}}))}))},CacheManager.prototype.removeAccountContext=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o,s,l,h=this;return __generator(this,(function(v){switch(v.label){case 0:return o=this.getKeys(),s=t.generateAccountId(),l=[],o.forEach((function(t){var o=AB.getCredentialType(t);if(o!==JU.NOT_DEFINED){var v=h.getSpecificCredential(t,o);v&&s===v.generateAccountId()&&l.push(h.removeCredential(v))}})),[4,Promise.all(l)];case 1:return v.sent(),[2,!0]}}))}))},CacheManager.prototype.removeCredential=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o,s;return __generator(this,(function(l){switch(l.label){case 0:if(o=t.generateCredentialKey(),t.credentialType.toLowerCase()!==sH.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())return[3,4];if(t.tokenType!==fH.POP)return[3,4];if(!(s=t.keyId))return[3,4];l.label=1;case 1:return l.trys.push([1,3,,4]),[4,this.cryptoImpl.removeTokenBindingKey(s)];case 2:return l.sent(),[3,4];case 3:throw l.sent(),kB.createBindingKeyNotRemovedError();case 4:return[2,this.removeItem(o,aH.CREDENTIAL)]}}))}))},CacheManager.prototype.removeAppMetadata=function(){var t=this;return this.getKeys().forEach((function(o){t.isAppMetadata(o)&&t.removeItem(o,aH.APP_METADATA)})),!0},CacheManager.prototype.readCacheRecord=function(t,o,s,l){var h=this.readAccountFromCache(t),v=this.readIdTokenFromCache(o,t),m=this.readAccessTokenFromCache(o,t,s),_=this.readRefreshTokenFromCache(o,t,!1),R=this.readAppMetadataFromCache(l,o);return h&&v&&(h.idTokenClaims=new rq(v.secret,this.cryptoImpl).claims),{account:h,idToken:v,accessToken:m,refreshToken:_,appMetadata:R}},CacheManager.prototype.readAccountFromCache=function(t){var o=tq.generateAccountCacheKey(t);return this.getAccount(o)},CacheManager.prototype.readAccountFromCacheWithNativeAccountId=function(t){var o={nativeAccountId:t},s=this.getAccountsFilteredBy(o),l=Object.keys(s).map((function(t){return s[t]}));if(l.length<1)return null;if(l.length>1)throw kB.createMultipleMatchingAccountsInCacheError();return s[0]},CacheManager.prototype.readIdTokenFromCache=function(t,o){var s={homeAccountId:o.homeAccountId,environment:o.environment,credentialType:sH.ID_TOKEN,clientId:t,realm:o.tenantId},l=this.getCredentialsFilteredBy(s),h=Object.keys(l.idTokens).map((function(t){return l.idTokens[t]})),v=h.length;if(v<1)return null;if(v>1)throw kB.createMultipleMatchingTokensInCacheError();return h[0]},CacheManager.prototype.readAccessTokenFromCache=function(t,o,s){var l=new eq(s.scopes||[]),h=s.authenticationScheme||fH.BEARER,v=h&&h.toLowerCase()!==fH.BEARER.toLowerCase()?sH.ACCESS_TOKEN_WITH_AUTH_SCHEME:sH.ACCESS_TOKEN,m={homeAccountId:o.homeAccountId,environment:o.environment,credentialType:v,clientId:t,realm:o.tenantId,target:l.printScopesLowerCase(),tokenType:h,keyId:s.sshKid,requestedClaimsHash:s.requestedClaimsHash},_=this.getCredentialsFilteredBy(m),R=Object.keys(_.accessTokens).map((function(t){return _.accessTokens[t]})),$=R.length;if($<1)return null;if($>1)throw kB.createMultipleMatchingTokensInCacheError();return R[0]},CacheManager.prototype.readRefreshTokenFromCache=function(t,o,s){var l=s?hH:void 0,h={homeAccountId:o.homeAccountId,environment:o.environment,credentialType:sH.REFRESH_TOKEN,clientId:t,familyId:l},v=this.getCredentialsFilteredBy(h),m=Object.keys(v.refreshTokens).map((function(t){return v.refreshTokens[t]}));return m.length<1?null:m[0]},CacheManager.prototype.readAppMetadataFromCache=function(t,o){var s={environment:t,clientId:o},l=this.getAppMetadataFilteredBy(s),h=Object.keys(l).map((function(t){return l[t]})),v=h.length;if(v<1)return null;if(v>1)throw kB.createMultipleMatchingAppMetadataInCacheError();return h[0]},CacheManager.prototype.isAppMetadataFOCI=function(t,o){var s=this.readAppMetadataFromCache(t,o);return!(!s||s.familyId!==hH)},CacheManager.prototype.matchHomeAccountId=function(t,o){return!("string"!=typeof t.homeAccountId||o!==t.homeAccountId)},CacheManager.prototype.matchUserAssertionHash=function(t,o){return!(!t.userAssertionHash||o!==t.userAssertionHash)},CacheManager.prototype.matchEnvironment=function(t,o){var s=this.getAuthorityMetadataByAlias(o);return!!(s&&s.aliases.indexOf(t.environment)>-1)},CacheManager.prototype.matchCredentialType=function(t,o){return t.credentialType&&o.toLowerCase()===t.credentialType.toLowerCase()},CacheManager.prototype.matchClientId=function(t,o){return!(!t.clientId||o!==t.clientId)},CacheManager.prototype.matchFamilyId=function(t,o){return!(!t.familyId||o!==t.familyId)},CacheManager.prototype.matchRealm=function(t,o){return!(!t.realm||o!==t.realm)},CacheManager.prototype.matchNativeAccountId=function(t,o){return!(!t.nativeAccountId||o!==t.nativeAccountId)},CacheManager.prototype.matchTarget=function(t,o){if(t.credentialType!==sH.ACCESS_TOKEN&&t.credentialType!==sH.ACCESS_TOKEN_WITH_AUTH_SCHEME||!t.target)return!1;var s=eq.fromString(t.target),l=eq.fromString(o);return l.containsOnlyOIDCScopes()?l.removeScope(JU.OFFLINE_ACCESS_SCOPE):l.removeOIDCScopes(),s.containsScopeSet(l)},CacheManager.prototype.matchTokenType=function(t,o){return!(!t.tokenType||t.tokenType!==o)},CacheManager.prototype.matchKeyId=function(t,o){return!(!t.keyId||t.keyId!==o)},CacheManager.prototype.isAppMetadata=function(t){return-1!==t.indexOf(uH)},CacheManager.prototype.isAuthorityMetadata=function(t){return-1!==t.indexOf(pH.CACHE_KEY)},CacheManager.prototype.generateAuthorityMetadataCacheKey=function(t){return pH.CACHE_KEY+"-"+this.clientId+"-"+t},CacheManager.prototype.getSpecificCredential=function(t,o){switch(o){case sH.ID_TOKEN:return this.getIdTokenCredential(t);case sH.ACCESS_TOKEN:case sH.ACCESS_TOKEN_WITH_AUTH_SCHEME:return this.getAccessTokenCredential(t);case sH.REFRESH_TOKEN:return this.getRefreshTokenCredential(t);default:return null}},CacheManager.toObject=function(t,o){for(var s in o)t[s]=o[s];return t},CacheManager}(),nq=function(t){function DefaultStorageClass(){return null!==t&&t.apply(this,arguments)||this}return __extends(DefaultStorageClass,t),DefaultStorageClass.prototype.setAccount=function(){throw RH.createUnexpectedError("Storage interface - setAccount() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getAccount=function(){throw RH.createUnexpectedError("Storage interface - getAccount() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setIdTokenCredential=function(){throw RH.createUnexpectedError("Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getIdTokenCredential=function(){throw RH.createUnexpectedError("Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setAccessTokenCredential=function(){throw RH.createUnexpectedError("Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getAccessTokenCredential=function(){throw RH.createUnexpectedError("Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setRefreshTokenCredential=function(){throw RH.createUnexpectedError("Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getRefreshTokenCredential=function(){throw RH.createUnexpectedError("Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setAppMetadata=function(){throw RH.createUnexpectedError("Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getAppMetadata=function(){throw RH.createUnexpectedError("Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setServerTelemetry=function(){throw RH.createUnexpectedError("Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getServerTelemetry=function(){throw RH.createUnexpectedError("Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setAuthorityMetadata=function(){throw RH.createUnexpectedError("Storage interface - setAuthorityMetadata() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getAuthorityMetadata=function(){throw RH.createUnexpectedError("Storage interface - getAuthorityMetadata() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getAuthorityMetadataKeys=function(){throw RH.createUnexpectedError("Storage interface - getAuthorityMetadataKeys() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setThrottlingCache=function(){throw RH.createUnexpectedError("Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getThrottlingCache=function(){throw RH.createUnexpectedError("Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.removeItem=function(){throw RH.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.containsKey=function(){throw RH.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getKeys=function(){throw RH.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.clear=function(){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(t){throw"Storage interface - clear() has not been implemented for the cacheStorage interface.",RH.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")}))}))},DefaultStorageClass.prototype.updateCredentialCacheKey=function(){throw RH.createUnexpectedError("Storage interface - updateCredentialCacheKey() has not been implemented for the cacheStorage interface.")},DefaultStorageClass}(oq),iq={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},sq={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:IH.Info,correlationId:JU.EMPTY_STRING},aq={sendGetRequestAsync:function(){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(t){throw"Network interface - sendGetRequestAsync() has not been implemented",RH.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")}))}))},sendPostRequestAsync:function(){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(t){throw"Network interface - sendPostRequestAsync() has not been implemented",RH.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")}))}))}},lq={sku:JU.SKU,version:IB,cpu:JU.EMPTY_STRING,os:JU.EMPTY_STRING},cq={clientSecret:JU.EMPTY_STRING,clientAssertion:void 0},dq={azureCloudInstance:SB.None,tenant:""+JU.DEFAULT_COMMON_TENANT},uq={application:{appName:"",appVersion:""}};
/*! @azure/msal-common v10.0.0 2023-02-06 */
/*! @azure/msal-common v10.0.0 2023-02-06 */
var hq,pq=function(t){function ServerError(o,s,l){var h=t.call(this,o,s,l)||this;return h.name="ServerError",Object.setPrototypeOf(h,ServerError.prototype),h}return __extends(ServerError,t),ServerError}(RH),fq=function(){function ThrottlingUtils(){}return ThrottlingUtils.generateThrottlingStorageKey=function(t){return TH+"."+JSON.stringify(t)},ThrottlingUtils.preProcess=function(t,o){var s,l=ThrottlingUtils.generateThrottlingStorageKey(o),h=t.getThrottlingCache(l);if(h){if(h.throttleTime<Date.now())return void t.removeItem(l,aH.THROTTLING);throw new pq((null===(s=h.errorCodes)||void 0===s?void 0:s.join(" "))||JU.EMPTY_STRING,h.errorMessage,h.subError)}},ThrottlingUtils.postProcess=function(t,o,s){if(ThrottlingUtils.checkResponseStatus(s)||ThrottlingUtils.checkResponseForRetryAfter(s)){var l={throttleTime:ThrottlingUtils.calculateThrottleTime(parseInt(s.headers[GU.RETRY_AFTER])),error:s.body.error,errorCodes:s.body.error_codes,errorMessage:s.body.error_description,subError:s.body.suberror};t.setThrottlingCache(ThrottlingUtils.generateThrottlingStorageKey(o),l)}},ThrottlingUtils.checkResponseStatus=function(t){return 429===t.status||t.status>=500&&t.status<600},ThrottlingUtils.checkResponseForRetryAfter=function(t){return!!t.headers&&(t.headers.hasOwnProperty(GU.RETRY_AFTER)&&(t.status<200||t.status>=300))},ThrottlingUtils.calculateThrottleTime=function(t){var o=t<=0?0:t,s=Date.now()/1e3;return Math.floor(1e3*Math.min(s+(o||CH),s+kH))},ThrottlingUtils.removeThrottle=function(t,o,s,l){var h={clientId:o,authority:s.authority,scopes:s.scopes,homeAccountIdentifier:l,claims:s.claims,authenticationScheme:s.authenticationScheme,resourceRequestMethod:s.resourceRequestMethod,resourceRequestUri:s.resourceRequestUri,shrClaims:s.shrClaims,sshKid:s.sshKid},v=this.generateThrottlingStorageKey(h);return t.removeItem(v,aH.THROTTLING)},ThrottlingUtils}(),gq=function(){function NetworkManager(t,o){this.networkClient=t,this.cacheManager=o}return NetworkManager.prototype.sendPostRequest=function(t,o,s){return __awaiter$2(this,void 0,void 0,(function(){var l,h;return __generator(this,(function(v){switch(v.label){case 0:fq.preProcess(this.cacheManager,t),v.label=1;case 1:return v.trys.push([1,3,,4]),[4,this.networkClient.sendPostRequestAsync(o,s)];case 2:return l=v.sent(),[3,4];case 3:throw(h=v.sent())instanceof RH?h:kB.createNetworkError(o,h);case 4:return fq.postProcess(this.cacheManager,t,l),[2,l]}}))}))},NetworkManager}();
/*! @azure/msal-common v10.0.0 2023-02-06 */!function(t){t.HOME_ACCOUNT_ID="home_account_id",t.UPN="UPN"}(hq||(hq={}));
/*! @azure/msal-common v10.0.0 2023-02-06 */
var vq,mq,bq=function(){function RequestValidator(){}return RequestValidator.validateRedirectUri=function(t){if(TB.isEmpty(t))throw ZB.createRedirectUriEmptyError()},RequestValidator.validatePrompt=function(t){var o=[];for(var s in tH)o.push(tH[s]);if(o.indexOf(t)<0)throw ZB.createInvalidPromptError(t)},RequestValidator.validateClaims=function(t){try{JSON.parse(t)}catch(t){throw ZB.createInvalidClaimsRequestError()}},RequestValidator.validateCodeChallengeParams=function(t,o){if(TB.isEmpty(t)||TB.isEmpty(o))throw ZB.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(o)},RequestValidator.validateCodeChallengeMethod=function(t){if([cH.PLAIN,cH.S256].indexOf(t)<0)throw ZB.createInvalidCodeChallengeMethodError()},RequestValidator.sanitizeEQParams=function(t,o){return t?(o.forEach((function(o,s){t[s]&&delete t[s]})),Object.fromEntries(Object.entries(t).filter((function(t){return""!==t[1]})))):{}},RequestValidator}(),yq=function(){function RequestParameterBuilder(){this.parameters=new Map}return RequestParameterBuilder.prototype.addResponseTypeCode=function(){this.parameters.set(QU.RESPONSE_TYPE,encodeURIComponent(JU.CODE_RESPONSE_TYPE))},RequestParameterBuilder.prototype.addResponseTypeForTokenAndIdToken=function(){this.parameters.set(QU.RESPONSE_TYPE,encodeURIComponent(JU.TOKEN_RESPONSE_TYPE+" "+JU.ID_TOKEN_RESPONSE_TYPE))},RequestParameterBuilder.prototype.addResponseMode=function(t){this.parameters.set(QU.RESPONSE_MODE,encodeURIComponent(t||rH.QUERY))},RequestParameterBuilder.prototype.addNativeBroker=function(){this.parameters.set(QU.NATIVE_BROKER,encodeURIComponent("1"))},RequestParameterBuilder.prototype.addScopes=function(t,o){void 0===o&&(o=!0);var s=o?__spreadArrays(t||[],XU):t||[],l=new eq(s);this.parameters.set(QU.SCOPE,encodeURIComponent(l.printScopes()))},RequestParameterBuilder.prototype.addClientId=function(t){this.parameters.set(QU.CLIENT_ID,encodeURIComponent(t))},RequestParameterBuilder.prototype.addRedirectUri=function(t){bq.validateRedirectUri(t),this.parameters.set(QU.REDIRECT_URI,encodeURIComponent(t))},RequestParameterBuilder.prototype.addPostLogoutRedirectUri=function(t){bq.validateRedirectUri(t),this.parameters.set(QU.POST_LOGOUT_URI,encodeURIComponent(t))},RequestParameterBuilder.prototype.addIdTokenHint=function(t){this.parameters.set(QU.ID_TOKEN_HINT,encodeURIComponent(t))},RequestParameterBuilder.prototype.addDomainHint=function(t){this.parameters.set(eH.DOMAIN_HINT,encodeURIComponent(t))},RequestParameterBuilder.prototype.addLoginHint=function(t){this.parameters.set(eH.LOGIN_HINT,encodeURIComponent(t))},RequestParameterBuilder.prototype.addCcsUpn=function(t){this.parameters.set(GU.CCS_HEADER,encodeURIComponent("UPN:"+t))},RequestParameterBuilder.prototype.addCcsOid=function(t){this.parameters.set(GU.CCS_HEADER,encodeURIComponent("Oid:"+t.uid+"@"+t.utid))},RequestParameterBuilder.prototype.addSid=function(t){this.parameters.set(eH.SID,encodeURIComponent(t))},RequestParameterBuilder.prototype.addClaims=function(t,o){var s=this.addClientCapabilitiesToClaims(t,o);bq.validateClaims(s),this.parameters.set(QU.CLAIMS,encodeURIComponent(s))},RequestParameterBuilder.prototype.addCorrelationId=function(t){this.parameters.set(QU.CLIENT_REQUEST_ID,encodeURIComponent(t))},RequestParameterBuilder.prototype.addLibraryInfo=function(t){this.parameters.set(QU.X_CLIENT_SKU,t.sku),this.parameters.set(QU.X_CLIENT_VER,t.version),t.os&&this.parameters.set(QU.X_CLIENT_OS,t.os),t.cpu&&this.parameters.set(QU.X_CLIENT_CPU,t.cpu)},RequestParameterBuilder.prototype.addApplicationTelemetry=function(t){(null==t?void 0:t.appName)&&this.parameters.set(QU.X_APP_NAME,t.appName),(null==t?void 0:t.appVersion)&&this.parameters.set(QU.X_APP_VER,t.appVersion)},RequestParameterBuilder.prototype.addPrompt=function(t){bq.validatePrompt(t),this.parameters.set(""+QU.PROMPT,encodeURIComponent(t))},RequestParameterBuilder.prototype.addState=function(t){TB.isEmpty(t)||this.parameters.set(QU.STATE,encodeURIComponent(t))},RequestParameterBuilder.prototype.addNonce=function(t){this.parameters.set(QU.NONCE,encodeURIComponent(t))},RequestParameterBuilder.prototype.addCodeChallengeParams=function(t,o){if(bq.validateCodeChallengeParams(t,o),!t||!o)throw ZB.createInvalidCodeChallengeParamsError();this.parameters.set(QU.CODE_CHALLENGE,encodeURIComponent(t)),this.parameters.set(QU.CODE_CHALLENGE_METHOD,encodeURIComponent(o))},RequestParameterBuilder.prototype.addAuthorizationCode=function(t){this.parameters.set(QU.CODE,encodeURIComponent(t))},RequestParameterBuilder.prototype.addDeviceCode=function(t){this.parameters.set(QU.DEVICE_CODE,encodeURIComponent(t))},RequestParameterBuilder.prototype.addRefreshToken=function(t){this.parameters.set(QU.REFRESH_TOKEN,encodeURIComponent(t))},RequestParameterBuilder.prototype.addCodeVerifier=function(t){this.parameters.set(QU.CODE_VERIFIER,encodeURIComponent(t))},RequestParameterBuilder.prototype.addClientSecret=function(t){this.parameters.set(QU.CLIENT_SECRET,encodeURIComponent(t))},RequestParameterBuilder.prototype.addClientAssertion=function(t){TB.isEmpty(t)||this.parameters.set(QU.CLIENT_ASSERTION,encodeURIComponent(t))},RequestParameterBuilder.prototype.addClientAssertionType=function(t){TB.isEmpty(t)||this.parameters.set(QU.CLIENT_ASSERTION_TYPE,encodeURIComponent(t))},RequestParameterBuilder.prototype.addOboAssertion=function(t){this.parameters.set(QU.OBO_ASSERTION,encodeURIComponent(t))},RequestParameterBuilder.prototype.addRequestTokenUse=function(t){this.parameters.set(QU.REQUESTED_TOKEN_USE,encodeURIComponent(t))},RequestParameterBuilder.prototype.addGrantType=function(t){this.parameters.set(QU.GRANT_TYPE,encodeURIComponent(t))},RequestParameterBuilder.prototype.addClientInfo=function(){this.parameters.set("client_info","1")},RequestParameterBuilder.prototype.addExtraQueryParameters=function(t){var o=this,s=bq.sanitizeEQParams(t,this.parameters);Object.keys(s).forEach((function(s){o.parameters.set(s,t[s])}))},RequestParameterBuilder.prototype.addClientCapabilitiesToClaims=function(t,o){var s;if(t)try{s=JSON.parse(t)}catch(t){throw ZB.createInvalidClaimsRequestError()}else s={};return o&&o.length>0&&(s.hasOwnProperty(YU.ACCESS_TOKEN)||(s[YU.ACCESS_TOKEN]={}),s[YU.ACCESS_TOKEN][YU.XMS_CC]={values:o}),JSON.stringify(s)},RequestParameterBuilder.prototype.addUsername=function(t){this.parameters.set(vH.username,encodeURIComponent(t))},RequestParameterBuilder.prototype.addPassword=function(t){this.parameters.set(vH.password,encodeURIComponent(t))},RequestParameterBuilder.prototype.addPopToken=function(t){TB.isEmpty(t)||(this.parameters.set(QU.TOKEN_TYPE,fH.POP),this.parameters.set(QU.REQ_CNF,encodeURIComponent(t)))},RequestParameterBuilder.prototype.addSshJwk=function(t){TB.isEmpty(t)||(this.parameters.set(QU.TOKEN_TYPE,fH.SSH),this.parameters.set(QU.REQ_CNF,encodeURIComponent(t)))},RequestParameterBuilder.prototype.addServerTelemetry=function(t){this.parameters.set(QU.X_CLIENT_CURR_TELEM,t.generateCurrentRequestHeaderValue()),this.parameters.set(QU.X_CLIENT_LAST_TELEM,t.generateLastRequestHeaderValue())},RequestParameterBuilder.prototype.addThrottling=function(){this.parameters.set(QU.X_MS_LIB_CAPABILITY,SH)},RequestParameterBuilder.prototype.addLogoutHint=function(t){this.parameters.set(QU.LOGOUT_HINT,encodeURIComponent(t))},RequestParameterBuilder.prototype.createQueryString=function(){var t=new Array;return this.parameters.forEach((function(o,s){t.push(s+"="+o)})),t.join("&")},RequestParameterBuilder}(),wq=function(){function BaseClient(t,o){this.config=function buildClientConfiguration(t){var o,s=t.authOptions,l=t.systemOptions,h=t.loggerOptions,v=t.storageInterface,m=t.networkInterface,_=t.cryptoInterface,R=t.clientCredentials,$=t.libraryInfo,B=t.telemetry,q=t.serverTelemetryManager,j=t.persistencePlugin,z=t.serializableCache,K=__assign(__assign({},sq),h);return{authOptions:(o=s,__assign({clientCapabilities:[],azureCloudOptions:dq,skipAuthorityMetadataCache:!1},o)),systemOptions:__assign(__assign({},iq),l),loggerOptions:K,storageInterface:v||new nq(s.clientId,OH),networkInterface:m||aq,cryptoInterface:_||OH,clientCredentials:R||cq,libraryInfo:__assign(__assign({},lq),$),telemetry:__assign(__assign({},uq),B),serverTelemetryManager:q||null,persistencePlugin:j||null,serializableCache:z||null}}(t),this.logger=new xB(this.config.loggerOptions,EB,IB),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new gq(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=o}return BaseClient.prototype.createTokenRequestHeaders=function(t){var o={};if(o[GU.CONTENT_TYPE]=JU.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&t)switch(t.type){case hq.HOME_ACCOUNT_ID:try{var s=buildClientInfoFromHomeAccountId(t.credential);o[GU.CCS_HEADER]="Oid:"+s.uid+"@"+s.utid}catch(t){this.logger.verbose("Could not parse home account ID for CCS Header: "+t)}break;case hq.UPN:o[GU.CCS_HEADER]="UPN: "+t.credential}return o},BaseClient.prototype.executePostToTokenEndpoint=function(t,o,s,l){return __awaiter$2(this,void 0,void 0,(function(){var h;return __generator(this,(function(v){switch(v.label){case 0:return[4,this.networkManager.sendPostRequest(l,t,{body:o,headers:s})];case 1:return h=v.sent(),this.config.serverTelemetryManager&&h.status<500&&429!==h.status&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,h]}}))}))},BaseClient.prototype.updateAuthority=function(t){if(!t.discoveryComplete())throw kB.createEndpointDiscoveryIncompleteError("Updated authority has not completed endpoint discovery.");this.authority=t},BaseClient.prototype.createTokenQueryParameters=function(t){var o=new yq;return t.tokenQueryParameters&&o.addExtraQueryParameters(t.tokenQueryParameters),o.createQueryString()},BaseClient}(),_q=function(t){function IdTokenEntity(){return null!==t&&t.apply(this,arguments)||this}return __extends(IdTokenEntity,t),IdTokenEntity.createIdTokenEntity=function(t,o,s,l,h){var v=new IdTokenEntity;return v.credentialType=sH.ID_TOKEN,v.homeAccountId=t,v.environment=o,v.clientId=l,v.secret=s,v.realm=h,v},IdTokenEntity.isIdTokenEntity=function(t){return!!t&&(t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("realm")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")&&t.credentialType===sH.ID_TOKEN)},IdTokenEntity}(AB),Cq=function(){function TimeUtils(){}return TimeUtils.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},TimeUtils.isTokenExpired=function(t,o){var s=Number(t)||0;return TimeUtils.nowSeconds()+o>s},TimeUtils.wasClockTurnedBack=function(t){return Number(t)>TimeUtils.nowSeconds()},TimeUtils.delay=function(t,o){return new Promise((function(s){return setTimeout((function(){return s(o)}),t)}))},TimeUtils}(),kq=function(t){function AccessTokenEntity(){return null!==t&&t.apply(this,arguments)||this}return __extends(AccessTokenEntity,t),AccessTokenEntity.createAccessTokenEntity=function(t,o,s,l,h,v,m,_,R,$,B,q,j,z,K){var W,Z,te=new AccessTokenEntity;te.homeAccountId=t,te.credentialType=sH.ACCESS_TOKEN,te.secret=s;var ne=Cq.nowSeconds();if(te.cachedAt=ne.toString(),te.expiresOn=m.toString(),te.extendedExpiresOn=_.toString(),$&&(te.refreshOn=$.toString()),te.environment=o,te.clientId=l,te.realm=h,te.target=v,te.userAssertionHash=q,te.tokenType=TB.isEmpty(B)?fH.BEARER:B,z&&(te.requestedClaims=z,te.requestedClaimsHash=K),(null===(W=te.tokenType)||void 0===W?void 0:W.toLowerCase())!==fH.BEARER.toLowerCase())switch(te.credentialType=sH.ACCESS_TOKEN_WITH_AUTH_SCHEME,te.tokenType){case fH.POP:var ie=rq.extractTokenClaims(s,R);if(!(null===(Z=null==ie?void 0:ie.cnf)||void 0===Z?void 0:Z.kid))throw kB.createTokenClaimsRequiredError();te.keyId=ie.cnf.kid;break;case fH.SSH:te.keyId=j}return te},AccessTokenEntity.isAccessTokenEntity=function(t){return!!t&&(t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("realm")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")&&t.hasOwnProperty("target")&&(t.credentialType===sH.ACCESS_TOKEN||t.credentialType===sH.ACCESS_TOKEN_WITH_AUTH_SCHEME))},AccessTokenEntity}(AB),Tq=function(t){function RefreshTokenEntity(){return null!==t&&t.apply(this,arguments)||this}return __extends(RefreshTokenEntity,t),RefreshTokenEntity.createRefreshTokenEntity=function(t,o,s,l,h,v){var m=new RefreshTokenEntity;return m.clientId=l,m.credentialType=sH.REFRESH_TOKEN,m.environment=o,m.homeAccountId=t,m.secret=s,m.userAssertionHash=v,h&&(m.familyId=h),m},RefreshTokenEntity.isRefreshTokenEntity=function(t){return!!t&&(t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")&&t.credentialType===sH.REFRESH_TOKEN)},RefreshTokenEntity}(AB),Sq=["interaction_required","consent_required","login_required"],xq=["message_only","additional_action","basic_action","user_password_expired","consent_required"],Eq={code:"no_tokens_found",desc:"No refresh token found in the cache. Please sign-in."},Iq={code:"native_account_unavailable",desc:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API."},Aq=function(t){function InteractionRequiredAuthError(o,s,l,h,v,m,_){var R=t.call(this,o,s,l)||this;return Object.setPrototypeOf(R,InteractionRequiredAuthError.prototype),R.timestamp=h||JU.EMPTY_STRING,R.traceId=v||JU.EMPTY_STRING,R.correlationId=m||JU.EMPTY_STRING,R.claims=_||JU.EMPTY_STRING,R.name="InteractionRequiredAuthError",R}return __extends(InteractionRequiredAuthError,t),InteractionRequiredAuthError.isInteractionRequiredError=function(t,o,s){var l=!!t&&Sq.indexOf(t)>-1,h=!!s&&xq.indexOf(s)>-1,v=!!o&&Sq.some((function(t){return o.indexOf(t)>-1}));return l||v||h},InteractionRequiredAuthError.createNoTokensFoundError=function(){return new InteractionRequiredAuthError(Eq.code,Eq.desc)},InteractionRequiredAuthError.createNativeAccountUnavailableError=function(){return new InteractionRequiredAuthError(Iq.code,Iq.desc)},InteractionRequiredAuthError}(RH),Pq=function Pq(t,o,s,l,h){this.account=t||null,this.idToken=o||null,this.accessToken=s||null,this.refreshToken=l||null,this.appMetadata=h||null},Rq=function(){function ProtocolUtils(){}return ProtocolUtils.setRequestState=function(t,o,s){var l=ProtocolUtils.generateLibraryState(t,s);return TB.isEmpty(o)?l:""+l+JU.RESOURCE_DELIM+o},ProtocolUtils.generateLibraryState=function(t,o){if(!t)throw kB.createNoCryptoObjectError("generateLibraryState");var s={id:t.createNewGuid()};o&&(s.meta=o);var l=JSON.stringify(s);return t.base64Encode(l)},ProtocolUtils.parseRequestState=function(t,o){if(!t)throw kB.createNoCryptoObjectError("parseRequestState");if(TB.isEmpty(o))throw kB.createInvalidStateError(o,"Null, undefined or empty state");try{var s=o.split(JU.RESOURCE_DELIM),l=s[0],h=s.length>1?s.slice(1).join(JU.RESOURCE_DELIM):JU.EMPTY_STRING,v=t.base64Decode(l),m=JSON.parse(v);return{userRequestState:TB.isEmpty(h)?JU.EMPTY_STRING:h,libraryState:m}}catch(t){throw kB.createInvalidStateError(o,t)}},ProtocolUtils}(),Oq=function(){function UrlString(t){if(this._urlString=t,TB.isEmpty(this._urlString))throw ZB.createUrlEmptyError();TB.isEmpty(this.getHash())&&(this._urlString=UrlString.canonicalizeUri(t))}return Object.defineProperty(UrlString.prototype,"urlString",{get:function(){return this._urlString},enumerable:!1,configurable:!0}),UrlString.canonicalizeUri=function(t){if(t){var o=t.toLowerCase();return TB.endsWith(o,"?")?o=o.slice(0,-1):TB.endsWith(o,"?/")&&(o=o.slice(0,-2)),TB.endsWith(o,"/")||(o+="/"),o}return t},UrlString.prototype.validateAsUri=function(){var t;try{t=this.getUrlComponents()}catch(t){throw ZB.createUrlParseError(t)}if(!t.HostNameAndPort||!t.PathSegments)throw ZB.createUrlParseError("Given url string: "+this.urlString);if(!t.Protocol||"https:"!==t.Protocol.toLowerCase())throw ZB.createInsecureAuthorityUriError(this.urlString)},UrlString.appendQueryString=function(t,o){return TB.isEmpty(o)?t:t.indexOf("?")<0?t+"?"+o:t+"&"+o},UrlString.removeHashFromUrl=function(t){return UrlString.canonicalizeUri(t.split("#")[0])},UrlString.prototype.replaceTenantPath=function(t){var o=this.getUrlComponents(),s=o.PathSegments;return!t||0===s.length||s[0]!==WU.COMMON&&s[0]!==WU.ORGANIZATIONS||(s[0]=t),UrlString.constructAuthorityUriFromObject(o)},UrlString.prototype.getHash=function(){return UrlString.parseHash(this.urlString)},UrlString.prototype.getUrlComponents=function(){var t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),o=this.urlString.match(t);if(!o)throw ZB.createUrlParseError("Given url string: "+this.urlString);var s={Protocol:o[1],HostNameAndPort:o[4],AbsolutePath:o[5],QueryString:o[7]},l=s.AbsolutePath.split("/");return l=l.filter((function(t){return t&&t.length>0})),s.PathSegments=l,!TB.isEmpty(s.QueryString)&&s.QueryString.endsWith("/")&&(s.QueryString=s.QueryString.substring(0,s.QueryString.length-1)),s},UrlString.getDomainFromUrl=function(t){var o=RegExp("^([^:/?#]+://)?([^/?#]*)"),s=t.match(o);if(!s)throw ZB.createUrlParseError("Given url string: "+t);return s[2]},UrlString.getAbsoluteUrl=function(t,o){if(t[0]===JU.FORWARD_SLASH){var s=new UrlString(o).getUrlComponents();return s.Protocol+"//"+s.HostNameAndPort+t}return t},UrlString.parseHash=function(t){var o=t.indexOf("#"),s=t.indexOf("#/");return s>-1?t.substring(s+2):o>-1?t.substring(o+1):JU.EMPTY_STRING},UrlString.parseQueryString=function(t){var o=t.indexOf("?"),s=t.indexOf("/?");return s>-1?t.substring(s+2):o>-1?t.substring(o+1):JU.EMPTY_STRING},UrlString.constructAuthorityUriFromObject=function(t){return new UrlString(t.Protocol+"//"+t.HostNameAndPort+"/"+t.PathSegments.join("/"))},UrlString.getDeserializedHash=function(t){if(TB.isEmpty(t))return{};var o=UrlString.parseHash(t),s=TB.queryStringToObject(TB.isEmpty(o)?t:o);if(!s)throw kB.createHashNotDeserializedError(JSON.stringify(s));return s},UrlString.getDeserializedQueryString=function(t){if(TB.isEmpty(t))return{};var o=UrlString.parseQueryString(t),s=TB.queryStringToObject(TB.isEmpty(o)?t:o);if(!s)throw kB.createHashNotDeserializedError(JSON.stringify(s));return s},UrlString.hashContainsKnownProperties=function(t){if(TB.isEmpty(t)||t.indexOf("=")<0)return!1;var o=UrlString.getDeserializedHash(t);return!!(o.code||o.error_description||o.error||o.state)},UrlString}();
/*! @azure/msal-common v10.0.0 2023-02-06 */!function(t){t.AcquireTokenByCode="acquireTokenByCode",t.AcquireTokenByRefreshToken="acquireTokenByRefreshToken",t.AcquireTokenSilent="acquireTokenSilent",t.AcquireTokenSilentAsync="acquireTokenSilentAsync",t.AcquireTokenPopup="acquireTokenPopup",t.CryptoOptsGetPublicKeyThumbprint="cryptoOptsGetPublicKeyThumbprint",t.CryptoOptsSignJwt="cryptoOptsSignJwt",t.SilentCacheClientAcquireToken="silentCacheClientAcquireToken",t.SilentIframeClientAcquireToken="silentIframeClientAcquireToken",t.SilentRefreshClientAcquireToken="silentRefreshClientAcquireToken",t.SsoSilent="ssoSilent",t.StandardInteractionClientGetDiscoveredAuthority="standardInteractionClientGetDiscoveredAuthority",t.FetchAccountIdWithNativeBroker="fetchAccountIdWithNativeBroker",t.NativeInteractionClientAcquireToken="nativeInteractionClientAcquireToken",t.BaseClientCreateTokenRequestHeaders="baseClientCreateTokenRequestHeaders",t.BrokerHandhshake="brokerHandshake",t.AcquireTokenByRefreshTokenInBroker="acquireTokenByRefreshTokenInBroker",t.AcquireTokenByBroker="acquireTokenByBroker",t.RefreshTokenClientExecuteTokenRequest="refreshTokenClientExecuteTokenRequest",t.RefreshTokenClientAcquireToken="refreshTokenClientAcquireToken",t.RefreshTokenClientAcquireTokenWithCachedRefreshToken="refreshTokenClientAcquireTokenWithCachedRefreshToken",t.RefreshTokenClientAcquireTokenByRefreshToken="refreshTokenClientAcquireTokenByRefreshToken",t.RefreshTokenClientCreateTokenRequestBody="refreshTokenClientCreateTokenRequestBody",t.AcquireTokenFromCache="acquireTokenFromCache",t.AcquireTokenBySilentIframe="acquireTokenBySilentIframe",t.InitializeBaseRequest="initializeBaseRequest",t.InitializeSilentRequest="initializeSilentRequest",t.SilentIframeClientTokenHelper="silentIframeClientTokenHelper",t.SilentHandlerInitiateAuthRequest="silentHandlerInitiateAuthRequest",t.SilentHandlerMonitorIframeForHash="silentHandlerMonitorIframeForHash",t.SilentHandlerLoadFrame="silentHandlerLoadFrame",t.StandardInteractionClientCreateAuthCodeClient="standardInteractionClientCreateAuthCodeClient",t.StandardInteractionClientGetClientConfiguration="standardInteractionClientGetClientConfiguration",t.StandardInteractionClientInitializeAuthorizationRequest="standardInteractionClientInitializeAuthorizationRequest",t.StandardInteractionClientInitializeAuthorizationCodeRequest="standardInteractionClientInitializeAuthorizationCodeRequest",t.GetAuthCodeUrl="getAuthCodeUrl",t.HandleCodeResponseFromServer="handleCodeResponseFromServer",t.HandleCodeResponseFromHash="handleCodeResponseFromHash",t.UpdateTokenEndpointAuthority="updateTokenEndpointAuthority",t.AuthClientAcquireToken="authClientAcquireToken",t.AuthClientExecuteTokenRequest="authClientExecuteTokenRequest",t.AuthClientCreateTokenRequestBody="authClientCreateTokenRequestBody",t.AuthClientCreateQueryString="authClientCreateQueryString",t.PopTokenGenerateCnf="popTokenGenerateCnf",t.PopTokenGenerateKid="popTokenGenerateKid",t.HandleServerTokenResponse="handleServerTokenResponse",t.AuthorityFactoryCreateDiscoveredInstance="authorityFactoryCreateDiscoveredInstance",t.AuthorityResolveEndpointsAsync="authorityResolveEndpointsAsync",t.AuthorityGetCloudDiscoveryMetadataFromNetwork="authorityGetCloudDiscoveryMetadataFromNetwork",t.AuthorityUpdateCloudDiscoveryMetadata="authorityUpdateCloudDiscoveryMetadata",t.AuthorityGetEndpointMetadataFromNetwork="authorityGetEndpointMetadataFromNetwork",t.AuthorityUpdateEndpointMetadata="authorityUpdateEndpointMetadata",t.AuthorityUpdateMetadataWithRegionalInformation="authorityUpdateMetadataWithRegionalInformation",t.RegionDiscoveryDetectRegion="regionDiscoveryDetectRegion",t.RegionDiscoveryGetRegionFromIMDS="regionDiscoveryGetRegionFromIMDS",t.RegionDiscoveryGetCurrentVersion="regionDiscoveryGetCurrentVersion",t.AcquireTokenByCodeAsync="acquireTokenByCodeAsync",t.GetEndpointMetadataFromNetwork="getEndpointMetadataFromNetwork",t.GetCloudDiscoveryMetadataFromNetworkMeasurement="getCloudDiscoveryMetadataFromNetworkMeasurement",t.HandleRedirectPromiseMeasurement="handleRedirectPromiseMeasurement",t.UpdateCloudDiscoveryMetadataMeasurement="updateCloudDiscoveryMetadataMeasurement",t.UsernamePasswordClientAcquireToken="usernamePasswordClientAcquireToken"}(vq||(vq={})),function(t){t[t.NotStarted=0]="NotStarted",t[t.InProgress=1]="InProgress",t[t.Completed=2]="Completed"}(mq||(mq={}));var $q,Nq=new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status"]);
/*! @azure/msal-common v10.0.0 2023-02-06 */!function(t){t.SW="sw",t.UHW="uhw"}($q||($q={}));var Mq=function(){function PopTokenGenerator(t,o){this.cryptoUtils=t,this.performanceClient=o}return PopTokenGenerator.prototype.generateCnf=function(t){var o,s;return __awaiter$2(this,void 0,void 0,(function(){var l,h,v;return __generator(this,(function(m){switch(m.label){case 0:return null===(o=this.performanceClient)||void 0===o||o.addQueueMeasurement(vq.PopTokenGenerateCnf,t.correlationId),null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(vq.PopTokenGenerateKid,t.correlationId),[4,this.generateKid(t)];case 1:return l=m.sent(),h=this.cryptoUtils.base64Encode(JSON.stringify(l)),v={kid:l.kid,reqCnfString:h},[4,this.cryptoUtils.hashString(h)];case 2:return[2,(v.reqCnfHash=m.sent(),v)]}}))}))},PopTokenGenerator.prototype.generateKid=function(t){var o;return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(s){switch(s.label){case 0:return null===(o=this.performanceClient)||void 0===o||o.addQueueMeasurement(vq.PopTokenGenerateKid,t.correlationId),[4,this.cryptoUtils.getPublicKeyThumbprint(t)];case 1:return[2,{kid:s.sent(),xms_ksl:$q.SW}]}}))}))},PopTokenGenerator.prototype.signPopToken=function(t,o,s){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(l){return[2,this.signPayload(t,o,s)]}))}))},PopTokenGenerator.prototype.signPayload=function(t,o,s,l){return __awaiter$2(this,void 0,void 0,(function(){var h,v,m,_,R,$;return __generator(this,(function(B){switch(B.label){case 0:return h=s.resourceRequestMethod,v=s.resourceRequestUri,m=s.shrClaims,_=s.shrNonce,R=v?new Oq(v):void 0,$=null==R?void 0:R.getUrlComponents(),[4,this.cryptoUtils.signJwt(__assign({at:t,ts:Cq.nowSeconds(),m:null==h?void 0:h.toUpperCase(),u:null==$?void 0:$.HostNameAndPort,nonce:_||this.cryptoUtils.createNewGuid(),p:null==$?void 0:$.AbsolutePath,q:(null==$?void 0:$.QueryString)?[[],$.QueryString]:void 0,client_claims:m||void 0},l),o,s.correlationId)];case 1:return[2,B.sent()]}}))}))},PopTokenGenerator}(),Dq=function(){function AppMetadataEntity(){}return AppMetadataEntity.prototype.generateAppMetadataKey=function(){return AppMetadataEntity.generateAppMetadataCacheKey(this.environment,this.clientId)},AppMetadataEntity.generateAppMetadataCacheKey=function(t,o){return[uH,t,o].join(iH.CACHE_KEY_SEPARATOR).toLowerCase()},AppMetadataEntity.createAppMetadataEntity=function(t,o,s){var l=new AppMetadataEntity;return l.clientId=t,l.environment=o,s&&(l.familyId=s),l},AppMetadataEntity.isAppMetadataEntity=function(t,o){return!!o&&(0===t.indexOf(uH)&&o.hasOwnProperty("clientId")&&o.hasOwnProperty("environment"))},AppMetadataEntity}(),Lq=function(){function TokenCacheContext(t,o){this.cache=t,this.hasChanged=o}return Object.defineProperty(TokenCacheContext.prototype,"cacheHasChanged",{get:function(){return this.hasChanged},enumerable:!1,configurable:!0}),Object.defineProperty(TokenCacheContext.prototype,"tokenCache",{get:function(){return this.cache},enumerable:!1,configurable:!0}),TokenCacheContext}(),Fq=function(){function ResponseHandler(t,o,s,l,h,v,m){this.clientId=t,this.cacheStorage=o,this.cryptoObj=s,this.logger=l,this.serializableCache=h,this.persistencePlugin=v,this.performanceClient=m}return ResponseHandler.prototype.validateServerAuthorizationCodeResponse=function(t,o,s){if(!t.state||!o)throw t.state?kB.createStateNotFoundError("Cached State"):kB.createStateNotFoundError("Server State");if(decodeURIComponent(t.state)!==decodeURIComponent(o))throw kB.createStateMismatchError();if(t.error||t.error_description||t.suberror){if(Aq.isInteractionRequiredError(t.error,t.error_description,t.suberror))throw new Aq(t.error||JU.EMPTY_STRING,t.error_description,t.suberror,t.timestamp||JU.EMPTY_STRING,t.trace_id||JU.EMPTY_STRING,t.correlation_id||JU.EMPTY_STRING,t.claims||JU.EMPTY_STRING);throw new pq(t.error||JU.EMPTY_STRING,t.error_description,t.suberror)}t.client_info&&buildClientInfo(t.client_info,s)},ResponseHandler.prototype.validateTokenResponse=function(t){if(t.error||t.error_description||t.suberror){if(Aq.isInteractionRequiredError(t.error,t.error_description,t.suberror))throw new Aq(t.error,t.error_description,t.suberror,t.timestamp||JU.EMPTY_STRING,t.trace_id||JU.EMPTY_STRING,t.correlation_id||JU.EMPTY_STRING,t.claims||JU.EMPTY_STRING);var o=t.error_codes+" - ["+t.timestamp+"]: "+t.error_description+" - Correlation ID: "+t.correlation_id+" - Trace ID: "+t.trace_id;throw new pq(t.error,o,t.suberror)}},ResponseHandler.prototype.handleServerTokenResponse=function(t,o,s,l,h,v,m,_,R){var $;return __awaiter$2(this,void 0,void 0,(function(){var B,q,j,z,K,W;return __generator(this,(function(Z){switch(Z.label){case 0:if(null===($=this.performanceClient)||void 0===$||$.addQueueMeasurement(vq.HandleServerTokenResponse,t.correlation_id),t.id_token){if(B=new rq(t.id_token||JU.EMPTY_STRING,this.cryptoObj),h&&!TB.isEmpty(h.nonce)&&B.claims.nonce!==h.nonce)throw kB.createNonceMismatchError();if(l.maxAge||0===l.maxAge){if(!(q=B.claims.auth_time))throw kB.createAuthTimeNotFoundError();rq.checkMaxAge(q,l.maxAge)}}this.homeAccountIdentifier=tq.generateHomeAccountId(t.client_info||JU.EMPTY_STRING,o.authorityType,this.logger,this.cryptoObj,B),h&&h.state&&(j=Rq.parseRequestState(this.cryptoObj,h.state)),t.key_id=t.key_id||l.sshKid||void 0,z=this.generateCacheRecord(t,o,s,l,B,v,h),Z.label=1;case 1:return Z.trys.push([1,,5,8]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),K=new Lq(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(K)]):[3,3];case 2:Z.sent(),Z.label=3;case 3:return!m||_||!z.account||(W=z.account.generateAccountKey(),this.cacheStorage.getAccount(W))?[4,this.cacheStorage.saveCacheRecord(z)]:(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,ResponseHandler.generateAuthenticationResult(this.cryptoObj,o,z,!1,l,B,j,void 0,R)]);case 4:return Z.sent(),[3,8];case 5:return this.persistencePlugin&&this.serializableCache&&K?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(K)]):[3,7];case 6:Z.sent(),Z.label=7;case 7:return[7];case 8:return[2,ResponseHandler.generateAuthenticationResult(this.cryptoObj,o,z,!1,l,B,j,t.spa_code,R)]}}))}))},ResponseHandler.prototype.generateCacheRecord=function(t,o,s,l,h,v,m){var _,R,$=o.getPreferredCache();if(TB.isEmpty($))throw kB.createInvalidCacheEnvironmentError();!TB.isEmpty(t.id_token)&&h&&(_=_q.createIdTokenEntity(this.homeAccountIdentifier,$,t.id_token||JU.EMPTY_STRING,this.clientId,h.claims.tid||JU.EMPTY_STRING),R=this.generateAccountEntity(t,h,o,m));var B=null;if(!TB.isEmpty(t.access_token)){var q=t.scope?eq.fromString(t.scope):new eq(l.scopes||[]),j=("string"==typeof t.expires_in?parseInt(t.expires_in,10):t.expires_in)||0,z=("string"==typeof t.ext_expires_in?parseInt(t.ext_expires_in,10):t.ext_expires_in)||0,K=("string"==typeof t.refresh_in?parseInt(t.refresh_in,10):t.refresh_in)||void 0,W=s+j,Z=W+z,te=K&&K>0?s+K:void 0;B=kq.createAccessTokenEntity(this.homeAccountIdentifier,$,t.access_token||JU.EMPTY_STRING,this.clientId,h?h.claims.tid||JU.EMPTY_STRING:o.tenant,q.printScopes(),W,Z,this.cryptoObj,te,t.token_type,v,t.key_id,l.claims,l.requestedClaimsHash)}var ne=null;TB.isEmpty(t.refresh_token)||(ne=Tq.createRefreshTokenEntity(this.homeAccountIdentifier,$,t.refresh_token||JU.EMPTY_STRING,this.clientId,t.foci,v));var ie=null;return TB.isEmpty(t.foci)||(ie=Dq.createAppMetadataEntity(this.clientId,$,t.foci)),new Pq(R,_,B,ne,ie)},ResponseHandler.prototype.generateAccountEntity=function(t,o,s,l){var h=s.authorityType,v=l?l.cloud_graph_host_name:JU.EMPTY_STRING,m=l?l.msgraph_host:JU.EMPTY_STRING;if(h===PB.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),tq.createGenericAccount(this.homeAccountIdentifier,o,s,v,m);if(TB.isEmpty(t.client_info)&&"AAD"===s.protocolMode)throw kB.createClientInfoEmptyError();return t.client_info?tq.createAccount(t.client_info,this.homeAccountIdentifier,o,s,v,m):tq.createGenericAccount(this.homeAccountIdentifier,o,s,v,m)},ResponseHandler.generateAuthenticationResult=function(t,o,s,l,h,v,m,_,R){var $,B,q;return __awaiter$2(this,void 0,void 0,(function(){var j,z,K,W,Z,te,ne,ie,se,he,me;return __generator(this,(function(_e){switch(_e.label){case 0:if(j=JU.EMPTY_STRING,z=[],K=null,Z=JU.EMPTY_STRING,!s.accessToken)return[3,4];if(s.accessToken.tokenType!==fH.POP)return[3,2];if(te=new Mq(t),ne=s.accessToken,ie=ne.secret,!(se=ne.keyId))throw kB.createKeyIdMissingError();return[4,te.signPopToken(ie,se,h)];case 1:return j=_e.sent(),[3,3];case 2:j=s.accessToken.secret,_e.label=3;case 3:z=eq.fromString(s.accessToken.target).asArray(),K=new Date(1e3*Number(s.accessToken.expiresOn)),W=new Date(1e3*Number(s.accessToken.extendedExpiresOn)),_e.label=4;case 4:return s.appMetadata&&(Z=s.appMetadata.familyId===hH?hH:JU.EMPTY_STRING),he=(null==v?void 0:v.claims.oid)||(null==v?void 0:v.claims.sub)||JU.EMPTY_STRING,me=(null==v?void 0:v.claims.tid)||JU.EMPTY_STRING,[2,{authority:o.canonicalAuthority,uniqueId:he,tenantId:me,scopes:z,account:s.account?s.account.getAccountInfo():null,idToken:v?v.rawToken:JU.EMPTY_STRING,idTokenClaims:v?v.claims:{},accessToken:j,fromCache:l,expiresOn:K,correlationId:h.correlationId,requestId:R||JU.EMPTY_STRING,extExpiresOn:W,familyId:Z,tokenType:(null===($=s.accessToken)||void 0===$?void 0:$.tokenType)||JU.EMPTY_STRING,state:m?m.userRequestState:JU.EMPTY_STRING,cloudGraphHostName:(null===(B=s.account)||void 0===B?void 0:B.cloudGraphHostName)||JU.EMPTY_STRING,msGraphHost:(null===(q=s.account)||void 0===q?void 0:q.msGraphHost)||JU.EMPTY_STRING,code:_,fromNativeBroker:!1}]}}))}))},ResponseHandler}(),Uq=function(t){function AuthorizationCodeClient(o,s){var l=t.call(this,o,s)||this;return l.includeRedirectUri=!0,l}return __extends(AuthorizationCodeClient,t),AuthorizationCodeClient.prototype.getAuthCodeUrl=function(t){var o,s;return __awaiter$2(this,void 0,void 0,(function(){var l;return __generator(this,(function(h){switch(h.label){case 0:return null===(o=this.performanceClient)||void 0===o||o.addQueueMeasurement(vq.GetAuthCodeUrl,t.correlationId),null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(vq.AuthClientCreateQueryString,t.correlationId),[4,this.createAuthCodeUrlQueryString(t)];case 1:return l=h.sent(),[2,Oq.appendQueryString(this.authority.authorizationEndpoint,l)]}}))}))},AuthorizationCodeClient.prototype.acquireToken=function(t,o){var s,l,h,v,m,_;return __awaiter$2(this,void 0,void 0,(function(){var R,$,B,q,j,z,K=this;return __generator(this,(function(W){switch(W.label){case 0:if(!t||!t.code)throw kB.createTokenRequestCannotBeMadeError();return null===(s=this.performanceClient)||void 0===s||s.addQueueMeasurement(vq.AuthClientAcquireToken,t.correlationId),R=null===(l=this.performanceClient)||void 0===l?void 0:l.startMeasurement("AuthCodeClientAcquireToken",t.correlationId),this.logger.info("in acquireToken call in auth-code client"),$=Cq.nowSeconds(),null===(h=this.performanceClient)||void 0===h||h.setPreQueueTime(vq.AuthClientExecuteTokenRequest,t.correlationId),[4,this.executeTokenRequest(this.authority,t)];case 1:return B=W.sent(),q=null===(v=B.headers)||void 0===v?void 0:v[GU.X_MS_REQUEST_ID],(j=null===(m=B.headers)||void 0===m?void 0:m[GU.X_MS_HTTP_VERSION])&&(null==R||R.addStaticFields({httpVerAuthority:j})),(z=new Fq(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient)).validateTokenResponse(B.body),null===(_=this.performanceClient)||void 0===_||_.setPreQueueTime(vq.HandleServerTokenResponse,t.correlationId),[2,z.handleServerTokenResponse(B.body,this.authority,$,t,o,void 0,void 0,void 0,q).then((function(t){return null==R||R.endMeasurement({success:!0}),t})).catch((function(o){throw K.logger.verbose("Error in fetching token in ACC",t.correlationId),null==R||R.endMeasurement({errorCode:o.errorCode,subErrorCode:o.subError,success:!1}),o}))]}}))}))},AuthorizationCodeClient.prototype.handleFragmentResponse=function(t,o){var s=new Fq(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null),l=new Oq(t),h=Oq.getDeserializedHash(l.getHash());if(s.validateServerAuthorizationCodeResponse(h,o,this.cryptoUtils),!h.code)throw kB.createNoAuthCodeInServerResponseError();return __assign(__assign({},h),{code:h.code})},AuthorizationCodeClient.prototype.getLogoutUri=function(t){if(!t)throw ZB.createEmptyLogoutRequestError();var o=this.createLogoutUrlQueryString(t);return Oq.appendQueryString(this.authority.endSessionEndpoint,o)},AuthorizationCodeClient.prototype.executeTokenRequest=function(t,o){var s,l;return __awaiter$2(this,void 0,void 0,(function(){var h,v,m,_,R,$,B;return __generator(this,(function(q){switch(q.label){case 0:return null===(s=this.performanceClient)||void 0===s||s.addQueueMeasurement(vq.AuthClientExecuteTokenRequest,o.correlationId),null===(l=this.performanceClient)||void 0===l||l.setPreQueueTime(vq.AuthClientCreateTokenRequestBody,o.correlationId),h=this.createTokenQueryParameters(o),v=Oq.appendQueryString(t.tokenEndpoint,h),[4,this.createTokenRequestBody(o)];case 1:if(m=q.sent(),_=void 0,o.clientInfo)try{R=buildClientInfo(o.clientInfo,this.cryptoUtils),_={credential:""+R.uid+iH.CLIENT_INFO_SEPARATOR+R.utid,type:hq.HOME_ACCOUNT_ID}}catch(t){this.logger.verbose("Could not parse client info for CCS Header: "+t)}return $=this.createTokenRequestHeaders(_||o.ccsCredential),B={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:o.scopes,claims:o.claims,authenticationScheme:o.authenticationScheme,resourceRequestMethod:o.resourceRequestMethod,resourceRequestUri:o.resourceRequestUri,shrClaims:o.shrClaims,sshKid:o.sshKid},[2,this.executePostToTokenEndpoint(v,m,$,B)]}}))}))},AuthorizationCodeClient.prototype.createTokenRequestBody=function(t){var o,s;return __awaiter$2(this,void 0,void 0,(function(){var l,h,v,m,_,R,$,B;return __generator(this,(function(q){switch(q.label){case 0:return null===(o=this.performanceClient)||void 0===o||o.addQueueMeasurement(vq.AuthClientCreateTokenRequestBody,t.correlationId),(l=new yq).addClientId(this.config.authOptions.clientId),this.includeRedirectUri?l.addRedirectUri(t.redirectUri):bq.validateRedirectUri(t.redirectUri),l.addScopes(t.scopes),l.addAuthorizationCode(t.code),l.addLibraryInfo(this.config.libraryInfo),l.addApplicationTelemetry(this.config.telemetry.application),l.addThrottling(),this.serverTelemetryManager&&l.addServerTelemetry(this.serverTelemetryManager),t.codeVerifier&&l.addCodeVerifier(t.codeVerifier),this.config.clientCredentials.clientSecret&&l.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(h=this.config.clientCredentials.clientAssertion,l.addClientAssertion(h.assertion),l.addClientAssertionType(h.assertionType)),l.addGrantType(oH.AUTHORIZATION_CODE_GRANT),l.addClientInfo(),t.authenticationScheme!==fH.POP?[3,2]:(v=new Mq(this.cryptoUtils,this.performanceClient),null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(vq.PopTokenGenerateCnf,t.correlationId),[4,v.generateCnf(t)]);case 1:return m=q.sent(),l.addPopToken(m.reqCnfString),[3,3];case 2:if(t.authenticationScheme===fH.SSH){if(!t.sshJwk)throw ZB.createMissingSshJwkError();l.addSshJwk(t.sshJwk)}q.label=3;case 3:if(_=t.correlationId||this.config.cryptoInterface.createNewGuid(),l.addCorrelationId(_),(!TB.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&l.addClaims(t.claims,this.config.authOptions.clientCapabilities),R=void 0,t.clientInfo)try{$=buildClientInfo(t.clientInfo,this.cryptoUtils),R={credential:""+$.uid+iH.CLIENT_INFO_SEPARATOR+$.utid,type:hq.HOME_ACCOUNT_ID}}catch(t){this.logger.verbose("Could not parse client info for CCS Header: "+t)}else R=t.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&R)switch(R.type){case hq.HOME_ACCOUNT_ID:try{$=buildClientInfoFromHomeAccountId(R.credential),l.addCcsOid($)}catch(t){this.logger.verbose("Could not parse home account ID for CCS Header: "+t)}break;case hq.UPN:l.addCcsUpn(R.credential)}return t.tokenBodyParameters&&l.addExtraQueryParameters(t.tokenBodyParameters),!t.enableSpaAuthorizationCode||t.tokenBodyParameters&&t.tokenBodyParameters[QU.RETURN_SPA_CODE]||l.addExtraQueryParameters(((B={})[QU.RETURN_SPA_CODE]="1",B)),[2,l.createQueryString()]}}))}))},AuthorizationCodeClient.prototype.createAuthCodeUrlQueryString=function(t){var o;return __awaiter$2(this,void 0,void 0,(function(){var s,l,h,v,m,_,R;return __generator(this,(function($){switch($.label){case 0:if(null===(o=this.performanceClient)||void 0===o||o.addQueueMeasurement(vq.AuthClientCreateQueryString,t.correlationId),(s=new yq).addClientId(this.config.authOptions.clientId),l=__spreadArrays(t.scopes||[],t.extraScopesToConsent||[]),s.addScopes(l),s.addRedirectUri(t.redirectUri),h=t.correlationId||this.config.cryptoInterface.createNewGuid(),s.addCorrelationId(h),s.addResponseMode(t.responseMode),s.addResponseTypeCode(),s.addLibraryInfo(this.config.libraryInfo),s.addApplicationTelemetry(this.config.telemetry.application),s.addClientInfo(),t.codeChallenge&&t.codeChallengeMethod&&s.addCodeChallengeParams(t.codeChallenge,t.codeChallengeMethod),t.prompt&&s.addPrompt(t.prompt),t.domainHint&&s.addDomainHint(t.domainHint),t.prompt!==tH.SELECT_ACCOUNT)if(t.sid&&t.prompt===tH.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),s.addSid(t.sid);else if(t.account){if(v=this.extractAccountSid(t.account),m=this.extractLoginHint(t.account)){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),s.addLoginHint(m);try{_=buildClientInfoFromHomeAccountId(t.account.homeAccountId),s.addCcsOid(_)}catch(t){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(v&&t.prompt===tH.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),s.addSid(v);try{_=buildClientInfoFromHomeAccountId(t.account.homeAccountId),s.addCcsOid(_)}catch(t){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(t.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),s.addLoginHint(t.loginHint),s.addCcsUpn(t.loginHint);else if(t.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),s.addLoginHint(t.account.username);try{_=buildClientInfoFromHomeAccountId(t.account.homeAccountId),s.addCcsOid(_)}catch(t){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else t.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),s.addLoginHint(t.loginHint),s.addCcsUpn(t.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return t.nonce&&s.addNonce(t.nonce),t.state&&s.addState(t.state),(!TB.isEmpty(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&s.addClaims(t.claims,this.config.authOptions.clientCapabilities),t.extraQueryParameters&&s.addExtraQueryParameters(t.extraQueryParameters),t.nativeBroker?(s.addNativeBroker(),t.authenticationScheme!==fH.POP?[3,2]:[4,new Mq(this.cryptoUtils).generateCnf(t)]):[3,2];case 1:R=$.sent(),s.addPopToken(R.reqCnfHash),$.label=2;case 2:return[2,s.createQueryString()]}}))}))},AuthorizationCodeClient.prototype.createLogoutUrlQueryString=function(t){var o=new yq;return t.postLogoutRedirectUri&&o.addPostLogoutRedirectUri(t.postLogoutRedirectUri),t.correlationId&&o.addCorrelationId(t.correlationId),t.idTokenHint&&o.addIdTokenHint(t.idTokenHint),t.state&&o.addState(t.state),t.logoutHint&&o.addLogoutHint(t.logoutHint),t.extraQueryParameters&&o.addExtraQueryParameters(t.extraQueryParameters),o.createQueryString()},AuthorizationCodeClient.prototype.extractAccountSid=function(t){var o;return(null===(o=t.idTokenClaims)||void 0===o?void 0:o.sid)||null},AuthorizationCodeClient.prototype.extractLoginHint=function(t){var o;return(null===(o=t.idTokenClaims)||void 0===o?void 0:o.login_hint)||null},AuthorizationCodeClient}(wq),Hq=function(t){function RefreshTokenClient(o,s){return t.call(this,o,s)||this}return __extends(RefreshTokenClient,t),RefreshTokenClient.prototype.acquireToken=function(t){var o,s,l,h,v,m,_;return __awaiter$2(this,void 0,void 0,(function(){var R,$,B,q,j,z,K=this;return __generator(this,(function(W){switch(W.label){case 0:return null===(o=this.performanceClient)||void 0===o||o.addQueueMeasurement(vq.RefreshTokenClientAcquireToken,t.correlationId),R=null===(s=this.performanceClient)||void 0===s?void 0:s.startMeasurement(vq.RefreshTokenClientAcquireToken,t.correlationId),this.logger.verbose("RefreshTokenClientAcquireToken called",t.correlationId),$=Cq.nowSeconds(),null===(l=this.performanceClient)||void 0===l||l.setPreQueueTime(vq.RefreshTokenClientExecuteTokenRequest,t.correlationId),[4,this.executeTokenRequest(t,this.authority)];case 1:return B=W.sent(),q=null===(h=B.headers)||void 0===h?void 0:h[GU.X_MS_HTTP_VERSION],null==R||R.addStaticFields({refreshTokenSize:(null===(v=B.body.refresh_token)||void 0===v?void 0:v.length)||0}),q&&(null==R||R.addStaticFields({httpVerToken:q})),j=null===(m=B.headers)||void 0===m?void 0:m[GU.X_MS_REQUEST_ID],(z=new Fq(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(B.body),null===(_=this.performanceClient)||void 0===_||_.setPreQueueTime(vq.HandleServerTokenResponse,t.correlationId),[2,z.handleServerTokenResponse(B.body,this.authority,$,t,void 0,void 0,!0,t.forceCache,j).then((function(t){return null==R||R.endMeasurement({success:!0}),t})).catch((function(o){throw K.logger.verbose("Error in fetching refresh token",t.correlationId),null==R||R.endMeasurement({errorCode:o.errorCode,subErrorCode:o.subError,success:!1}),o}))]}}))}))},RefreshTokenClient.prototype.acquireTokenByRefreshToken=function(t){var o,s,l,h;return __awaiter$2(this,void 0,void 0,(function(){var v,m;return __generator(this,(function(_){if(!t)throw ZB.createEmptyTokenRequestError();if(null===(o=this.performanceClient)||void 0===o||o.addQueueMeasurement(vq.RefreshTokenClientAcquireTokenByRefreshToken,t.correlationId),!t.account)throw kB.createNoAccountInSilentRequestError();if(this.cacheManager.isAppMetadataFOCI(t.account.environment,this.config.authOptions.clientId))try{return null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(vq.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),[2,this.acquireTokenWithCachedRefreshToken(t,!0)]}catch(o){if(v=o instanceof Aq&&o.errorCode===Eq.code,m=o instanceof pq&&o.errorCode===xH&&o.subError===EH,v||m)return null===(l=this.performanceClient)||void 0===l||l.setPreQueueTime(vq.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),[2,this.acquireTokenWithCachedRefreshToken(t,!1)];throw o}return null===(h=this.performanceClient)||void 0===h||h.setPreQueueTime(vq.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),[2,this.acquireTokenWithCachedRefreshToken(t,!1)]}))}))},RefreshTokenClient.prototype.acquireTokenWithCachedRefreshToken=function(t,o){var s,l,h;return __awaiter$2(this,void 0,void 0,(function(){var v,m,_;return __generator(this,(function(R){if(null===(s=this.performanceClient)||void 0===s||s.addQueueMeasurement(vq.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),v=null===(l=this.performanceClient)||void 0===l?void 0:l.startMeasurement(vq.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),this.logger.verbose("RefreshTokenClientAcquireTokenWithCachedRefreshToken called",t.correlationId),!(m=this.cacheManager.readRefreshTokenFromCache(this.config.authOptions.clientId,t.account,o)))throw null==v||v.discardMeasurement(),Aq.createNoTokensFoundError();return null==v||v.endMeasurement({success:!0}),_=__assign(__assign({},t),{refreshToken:m.secret,authenticationScheme:t.authenticationScheme||fH.BEARER,ccsCredential:{credential:t.account.homeAccountId,type:hq.HOME_ACCOUNT_ID}}),null===(h=this.performanceClient)||void 0===h||h.setPreQueueTime(vq.RefreshTokenClientAcquireToken,t.correlationId),[2,this.acquireToken(_)]}))}))},RefreshTokenClient.prototype.executeTokenRequest=function(t,o){var s,l,h;return __awaiter$2(this,void 0,void 0,(function(){var v,m,_,R,$,B;return __generator(this,(function(q){switch(q.label){case 0:return null===(s=this.performanceClient)||void 0===s||s.addQueueMeasurement(vq.RefreshTokenClientExecuteTokenRequest,t.correlationId),v=null===(l=this.performanceClient)||void 0===l?void 0:l.startMeasurement(vq.RefreshTokenClientExecuteTokenRequest,t.correlationId),null===(h=this.performanceClient)||void 0===h||h.setPreQueueTime(vq.RefreshTokenClientCreateTokenRequestBody,t.correlationId),m=this.createTokenQueryParameters(t),_=Oq.appendQueryString(o.tokenEndpoint,m),[4,this.createTokenRequestBody(t)];case 1:return R=q.sent(),$=this.createTokenRequestHeaders(t.ccsCredential),B={clientId:this.config.authOptions.clientId,authority:o.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},[2,this.executePostToTokenEndpoint(_,R,$,B).then((function(t){return null==v||v.endMeasurement({success:!0}),t})).catch((function(t){throw null==v||v.endMeasurement({success:!1}),t}))]}}))}))},RefreshTokenClient.prototype.createTokenRequestBody=function(t){var o,s,l;return __awaiter$2(this,void 0,void 0,(function(){var h,v,m,_,R,$,B;return __generator(this,(function(q){switch(q.label){case 0:return null===(o=this.performanceClient)||void 0===o||o.addQueueMeasurement(vq.RefreshTokenClientCreateTokenRequestBody,t.correlationId),h=t.correlationId,v=null===(s=this.performanceClient)||void 0===s?void 0:s.startMeasurement(vq.BaseClientCreateTokenRequestHeaders,h),(m=new yq).addClientId(this.config.authOptions.clientId),m.addScopes(t.scopes),m.addGrantType(oH.REFRESH_TOKEN_GRANT),m.addClientInfo(),m.addLibraryInfo(this.config.libraryInfo),m.addApplicationTelemetry(this.config.telemetry.application),m.addThrottling(),this.serverTelemetryManager&&m.addServerTelemetry(this.serverTelemetryManager),m.addCorrelationId(h),m.addRefreshToken(t.refreshToken),this.config.clientCredentials.clientSecret&&m.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(_=this.config.clientCredentials.clientAssertion,m.addClientAssertion(_.assertion),m.addClientAssertionType(_.assertionType)),t.authenticationScheme!==fH.POP?[3,2]:(R=new Mq(this.cryptoUtils,this.performanceClient),null===(l=this.performanceClient)||void 0===l||l.setPreQueueTime(vq.PopTokenGenerateCnf,t.correlationId),[4,R.generateCnf(t)]);case 1:return $=q.sent(),m.addPopToken($.reqCnfString),[3,3];case 2:if(t.authenticationScheme===fH.SSH){if(!t.sshJwk)throw null==v||v.endMeasurement({success:!1}),ZB.createMissingSshJwkError();m.addSshJwk(t.sshJwk)}q.label=3;case 3:if((!TB.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&m.addClaims(t.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&t.ccsCredential)switch(t.ccsCredential.type){case hq.HOME_ACCOUNT_ID:try{B=buildClientInfoFromHomeAccountId(t.ccsCredential.credential),m.addCcsOid(B)}catch(t){this.logger.verbose("Could not parse home account ID for CCS Header: "+t)}break;case hq.UPN:m.addCcsUpn(t.ccsCredential.credential)}return null==v||v.endMeasurement({success:!0}),[2,m.createQueryString()]}}))}))},RefreshTokenClient}(wq),Bq=function(t){function SilentFlowClient(o,s){return t.call(this,o,s)||this}return __extends(SilentFlowClient,t),SilentFlowClient.prototype.acquireToken=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o;return __generator(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,this.acquireCachedToken(t)];case 1:return[2,s.sent()];case 2:if((o=s.sent())instanceof kB&&o.errorCode===vB.code)return[2,new Hq(this.config,this.performanceClient).acquireTokenByRefreshToken(t)];throw o;case 3:return[2]}}))}))},SilentFlowClient.prototype.acquireCachedToken=function(t){var o,s,l,h;return __awaiter$2(this,void 0,void 0,(function(){var v,m;return __generator(this,(function(_){switch(_.label){case 0:if(!t)throw ZB.createEmptyTokenRequestError();if(t.forceRefresh)throw null===(o=this.serverTelemetryManager)||void 0===o||o.setCacheOutcome(wH.FORCE_REFRESH),this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because forceRefresh is true."),kB.createRefreshRequiredError();if(!t.account)throw kB.createNoAccountInSilentRequestError();if(v=t.authority||this.authority.getPreferredCache(),!(m=this.cacheManager.readCacheRecord(t.account,this.config.authOptions.clientId,t,v)).accessToken)throw null===(s=this.serverTelemetryManager)||void 0===s||s.setCacheOutcome(wH.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),kB.createRefreshRequiredError();if(Cq.wasClockTurnedBack(m.accessToken.cachedAt)||Cq.isTokenExpired(m.accessToken.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw null===(l=this.serverTelemetryManager)||void 0===l||l.setCacheOutcome(wH.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token is expired or will expire within "+this.config.systemOptions.tokenRenewalOffsetSeconds+" seconds."),kB.createRefreshRequiredError();if(m.accessToken.refreshOn&&Cq.isTokenExpired(m.accessToken.refreshOn,0))throw null===(h=this.serverTelemetryManager)||void 0===h||h.setCacheOutcome(wH.REFRESH_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'."),kB.createRefreshRequiredError();return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,this.generateResultFromCacheRecord(m,t)];case 1:return[2,_.sent()]}}))}))},SilentFlowClient.prototype.generateResultFromCacheRecord=function(t,o){return __awaiter$2(this,void 0,void 0,(function(){var s,l;return __generator(this,(function(h){switch(h.label){case 0:if(t.idToken&&(s=new rq(t.idToken.secret,this.config.cryptoInterface)),o.maxAge||0===o.maxAge){if(!(l=null==s?void 0:s.claims.auth_time))throw kB.createAuthTimeNotFoundError();rq.checkMaxAge(l,o.maxAge)}return[4,Fq.generateAuthenticationResult(this.cryptoUtils,this.authority,t,!0,o,s)];case 1:return[2,h.sent()]}}))}))},SilentFlowClient}(wq);
/*! @azure/msal-common v10.0.0 2023-02-06 */
/*! @azure/msal-common v10.0.0 2023-02-06 */
function isOpenIdConfigResponse(t){return t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("jwks_uri")}
/*! @azure/msal-common v10.0.0 2023-02-06 */var qq,jq={"https://login.microsoftonline.com/common/":{token_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/common/":{token_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/common/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/common/":{token_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/consumers/":{token_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/consumers/":{token_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/consumers/":{token_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/organizations/":{token_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/organizations/":{token_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/organizations/":{token_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"}},zq={"https://login.microsoftonline.com/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/common/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/consumers/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/organizations/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}};!function(t){t.AAD="AAD",t.OIDC="OIDC"}(qq||(qq={}));
/*! @azure/msal-common v10.0.0 2023-02-06 */
var Vq=function(){function AuthorityMetadataEntity(){this.expiresAt=Cq.nowSeconds()+pH.REFRESH_TIME_SECONDS}return AuthorityMetadataEntity.prototype.updateCloudDiscoveryMetadata=function(t,o){this.aliases=t.aliases,this.preferred_cache=t.preferred_cache,this.preferred_network=t.preferred_network,this.aliasesFromNetwork=o},AuthorityMetadataEntity.prototype.updateEndpointMetadata=function(t,o){this.authorization_endpoint=t.authorization_endpoint,this.token_endpoint=t.token_endpoint,this.end_session_endpoint=t.end_session_endpoint,this.issuer=t.issuer,this.endpointsFromNetwork=o,this.jwks_uri=t.jwks_uri},AuthorityMetadataEntity.prototype.updateCanonicalAuthority=function(t){this.canonical_authority=t},AuthorityMetadataEntity.prototype.resetExpiresAt=function(){this.expiresAt=Cq.nowSeconds()+pH.REFRESH_TIME_SECONDS},AuthorityMetadataEntity.prototype.isExpired=function(){return this.expiresAt<=Cq.nowSeconds()},AuthorityMetadataEntity.isAuthorityMetadataEntity=function(t,o){return!!o&&(0===t.indexOf(pH.CACHE_KEY)&&o.hasOwnProperty("aliases")&&o.hasOwnProperty("preferred_cache")&&o.hasOwnProperty("preferred_network")&&o.hasOwnProperty("canonical_authority")&&o.hasOwnProperty("authorization_endpoint")&&o.hasOwnProperty("token_endpoint")&&o.hasOwnProperty("issuer")&&o.hasOwnProperty("aliasesFromNetwork")&&o.hasOwnProperty("endpointsFromNetwork")&&o.hasOwnProperty("expiresAt")&&o.hasOwnProperty("jwks_uri"))},AuthorityMetadataEntity}();
/*! @azure/msal-common v10.0.0 2023-02-06 */
/*! @azure/msal-common v10.0.0 2023-02-06 */
var Gq,Kq,Wq,Qq,Yq,Jq,Xq,Zq,rj=function(){function RegionDiscovery(t,o,s){this.networkInterface=t,this.performanceClient=o,this.correlationId=s}return RegionDiscovery.prototype.detectRegion=function(t,o){var s,l,h,v;return __awaiter$2(this,void 0,void 0,(function(){var m,_,R,$,B;return __generator(this,(function(q){switch(q.label){case 0:if(null===(s=this.performanceClient)||void 0===s||s.addQueueMeasurement(vq.RegionDiscoveryDetectRegion,this.correlationId),m=t)return[3,8];_=RegionDiscovery.IMDS_OPTIONS,q.label=1;case 1:return q.trys.push([1,6,,7]),null===(l=this.performanceClient)||void 0===l||l.setPreQueueTime(vq.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[4,this.getRegionFromIMDS(JU.IMDS_VERSION,_)];case 2:return(R=q.sent()).status===mH.httpSuccess&&(m=R.body,o.region_source=bH.IMDS),R.status!==mH.httpBadRequest?[3,5]:(null===(h=this.performanceClient)||void 0===h||h.setPreQueueTime(vq.RegionDiscoveryGetCurrentVersion,this.correlationId),[4,this.getCurrentVersion(_)]);case 3:return($=q.sent())?(null===(v=this.performanceClient)||void 0===v||v.setPreQueueTime(vq.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[4,this.getRegionFromIMDS($,_)]):(o.region_source=bH.FAILED_AUTO_DETECTION,[2,null]);case 4:(B=q.sent()).status===mH.httpSuccess&&(m=B.body,o.region_source=bH.IMDS),q.label=5;case 5:return[3,7];case 6:return q.sent(),o.region_source=bH.FAILED_AUTO_DETECTION,[2,null];case 7:return[3,9];case 8:o.region_source=bH.ENVIRONMENT_VARIABLE,q.label=9;case 9:return m||(o.region_source=bH.FAILED_AUTO_DETECTION),[2,m||null]}}))}))},RegionDiscovery.prototype.getRegionFromIMDS=function(t,o){var s;return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(l){return null===(s=this.performanceClient)||void 0===s||s.addQueueMeasurement(vq.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[2,this.networkInterface.sendGetRequestAsync(JU.IMDS_ENDPOINT+"?api-version="+t+"&format=text",o,JU.IMDS_TIMEOUT)]}))}))},RegionDiscovery.prototype.getCurrentVersion=function(t){var o;return __awaiter$2(this,void 0,void 0,(function(){var s;return __generator(this,(function(l){switch(l.label){case 0:null===(o=this.performanceClient)||void 0===o||o.addQueueMeasurement(vq.RegionDiscoveryGetCurrentVersion,this.correlationId),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(JU.IMDS_ENDPOINT+"?format=json",t)];case 2:return(s=l.sent()).status===mH.httpBadRequest&&s.body&&s.body["newest-versions"]&&s.body["newest-versions"].length>0?[2,s.body["newest-versions"][0]]:[2,null];case 3:return l.sent(),[2,null];case 4:return[2]}}))}))},RegionDiscovery.IMDS_OPTIONS={headers:{Metadata:"true"}},RegionDiscovery}(),nj=function(){function Authority(t,o,s,l,h,v,m){this.canonicalAuthority=t,this._canonicalAuthority.validateAsUri(),this.networkInterface=o,this.cacheManager=s,this.authorityOptions=l,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=h,this.performanceClient=v,this.correlationId=m,this.regionDiscovery=new rj(o,this.performanceClient,this.correlationId)}return Object.defineProperty(Authority.prototype,"authorityType",{get:function(){var t=this.canonicalAuthorityUrlComponents.PathSegments;if(t.length)switch(t[0].toLowerCase()){case JU.ADFS:return PB.Adfs;case JU.DSTS:return PB.Dsts}return PB.Default},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"protocolMode",{get:function(){return this.authorityOptions.protocolMode},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"options",{get:function(){return this.authorityOptions},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(t){this._canonicalAuthority=new Oq(t),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"hostnameAndPort",{get:function(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete()){var t=this.replacePath(this.metadata.authorization_endpoint);return this.replaceTenant(t)}throw kB.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete()){var t=this.replacePath(this.metadata.token_endpoint);return this.replaceTenant(t)}throw kB.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete()){var t=this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));return this.replaceTenant(t)}throw kB.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw kB.createLogoutNotSupportedError();var t=this.replacePath(this.metadata.end_session_endpoint);return this.replaceTenant(t)}throw kB.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete()){var t=this.replacePath(this.metadata.issuer);return this.replaceTenant(t)}throw kB.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"jwksUri",{get:function(){if(this.discoveryComplete()){var t=this.replacePath(this.metadata.jwks_uri);return this.replaceTenant(t)}throw kB.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Authority.prototype.replaceTenant=function(t){return t.replace(/{tenant}|{tenantid}/g,this.tenant)},Authority.prototype.replacePath=function(t){var o=t,s=new Oq(this.metadata.canonical_authority).getUrlComponents().PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((function(t,l){var h=s[l];t!==h&&(o=o.replace("/"+h+"/","/"+t+"/"))})),o},Object.defineProperty(Authority.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===PB.Adfs||this.authorityType===PB.Dsts||this.protocolMode===qq.OIDC?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!1,configurable:!0}),Authority.prototype.discoveryComplete=function(){return!!this.metadata},Authority.prototype.resolveEndpointsAsync=function(){var t,o,s;return __awaiter$2(this,void 0,void 0,(function(){var l,h,v,m;return __generator(this,(function(_){switch(_.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(vq.AuthorityResolveEndpointsAsync,this.correlationId),(l=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort))||(l=new Vq).updateCanonicalAuthority(this.canonicalAuthority),null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(vq.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId),[4,this.updateCloudDiscoveryMetadata(l)];case 1:return h=_.sent(),this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,l.preferred_network),null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(vq.AuthorityUpdateEndpointMetadata,this.correlationId),[4,this.updateEndpointMetadata(l)];case 2:return v=_.sent(),h!==dH.CACHE&&v!==dH.CACHE&&(l.resetExpiresAt(),l.updateCanonicalAuthority(this.canonicalAuthority)),m=this.cacheManager.generateAuthorityMetadataCacheKey(l.preferred_cache),this.cacheManager.setAuthorityMetadata(m,l),this.metadata=l,[2]}}))}))},Authority.prototype.updateEndpointMetadata=function(t){var o,s,l,h,v,m;return __awaiter$2(this,void 0,void 0,(function(){var _,R;return __generator(this,(function($){switch($.label){case 0:return null===(o=this.performanceClient)||void 0===o||o.addQueueMeasurement(vq.AuthorityUpdateEndpointMetadata,this.correlationId),(_=this.getEndpointMetadataFromConfig())?(t.updateEndpointMetadata(_,!1),[2,dH.CONFIG]):this.isAuthoritySameType(t)&&t.endpointsFromNetwork&&!t.isExpired()?[2,dH.CACHE]:(R=this.getEndpointMetadataFromHardcodedValues(),null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(vq.AuthorityGetEndpointMetadataFromNetwork,this.correlationId),[4,this.getEndpointMetadataFromNetwork()]);case 1:return(_=$.sent())?(null===(l=this.authorityOptions.azureRegionConfiguration)||void 0===l?void 0:l.azureRegion)?(null===(h=this.performanceClient)||void 0===h||h.setPreQueueTime(vq.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),[4,this.updateMetadataWithRegionalInformation(_)]):[3,3]:[3,4];case 2:_=$.sent(),$.label=3;case 3:return t.updateEndpointMetadata(_,!0),[2,dH.NETWORK];case 4:return!R||this.authorityOptions.skipAuthorityMetadataCache?[3,7]:(null===(v=this.authorityOptions.azureRegionConfiguration)||void 0===v?void 0:v.azureRegion)?(null===(m=this.performanceClient)||void 0===m||m.setPreQueueTime(vq.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),[4,this.updateMetadataWithRegionalInformation(R)]):[3,6];case 5:R=$.sent(),$.label=6;case 6:return t.updateEndpointMetadata(R,!1),[2,dH.HARDCODED_VALUES];case 7:throw kB.createUnableToGetOpenidConfigError(this.defaultOpenIdConfigurationEndpoint)}}))}))},Authority.prototype.isAuthoritySameType=function(t){return new Oq(t.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length},Authority.prototype.getEndpointMetadataFromConfig=function(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(t){throw ZB.createInvalidAuthorityMetadataError()}return null},Authority.prototype.getEndpointMetadataFromNetwork=function(){var t;return __awaiter$2(this,void 0,void 0,(function(){var o,s;return __generator(this,(function(l){switch(l.label){case 0:null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(vq.AuthorityGetEndpointMetadataFromNetwork,this.correlationId),o={},l.label=1;case 1:return l.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(this.defaultOpenIdConfigurationEndpoint,o)];case 2:return[2,isOpenIdConfigResponse((s=l.sent()).body)?s.body:null];case 3:return l.sent(),[2,null];case 4:return[2]}}))}))},Authority.prototype.getEndpointMetadataFromHardcodedValues=function(){return this.canonicalAuthority in jq?jq[this.canonicalAuthority]:null},Authority.prototype.updateMetadataWithRegionalInformation=function(t){var o,s,l,h,v,m,_;return __awaiter$2(this,void 0,void 0,(function(){var R,$;return __generator(this,(function(B){switch(B.label){case 0:return null===(o=this.performanceClient)||void 0===o||o.addQueueMeasurement(vq.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(vq.RegionDiscoveryDetectRegion,this.correlationId),[4,this.regionDiscovery.detectRegion(null===(l=this.authorityOptions.azureRegionConfiguration)||void 0===l?void 0:l.environmentRegion,this.regionDiscoveryMetadata)];case 1:return R=B.sent(),$=(null===(h=this.authorityOptions.azureRegionConfiguration)||void 0===h?void 0:h.azureRegion)===JU.AZURE_REGION_AUTO_DISCOVER_FLAG?R:null===(v=this.authorityOptions.azureRegionConfiguration)||void 0===v?void 0:v.azureRegion,(null===(m=this.authorityOptions.azureRegionConfiguration)||void 0===m?void 0:m.azureRegion)===JU.AZURE_REGION_AUTO_DISCOVER_FLAG?this.regionDiscoveryMetadata.region_outcome=R?yH.AUTO_DETECTION_REQUESTED_SUCCESSFUL:yH.AUTO_DETECTION_REQUESTED_FAILED:this.regionDiscoveryMetadata.region_outcome=R?(null===(_=this.authorityOptions.azureRegionConfiguration)||void 0===_?void 0:_.azureRegion)===R?yH.CONFIGURED_MATCHES_DETECTED:yH.CONFIGURED_NOT_DETECTED:yH.CONFIGURED_NO_AUTO_DETECTION,$?(this.regionDiscoveryMetadata.region_used=$,[2,Authority.replaceWithRegionalInformation(t,$)]):[2,t]}}))}))},Authority.prototype.updateCloudDiscoveryMetadata=function(t){var o,s;return __awaiter$2(this,void 0,void 0,(function(){var l,h,v;return __generator(this,(function(m){switch(m.label){case 0:return null===(o=this.performanceClient)||void 0===o||o.addQueueMeasurement(vq.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId),this.logger.verbose("Attempting to get cloud discovery metadata in the config"),this.logger.verbosePii("Known Authorities: "+(this.authorityOptions.knownAuthorities||JU.NOT_APPLICABLE)),this.logger.verbosePii("Authority Metadata: "+(this.authorityOptions.authorityMetadata||JU.NOT_APPLICABLE)),this.logger.verbosePii("Canonical Authority: "+(t.canonical_authority||JU.NOT_APPLICABLE)),(l=this.getCloudDiscoveryMetadataFromConfig())?(this.logger.verbose("Found cloud discovery metadata in the config."),t.updateCloudDiscoveryMetadata(l,!1),[2,dH.CONFIG]):(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the cache."),h=t.isExpired(),this.isAuthoritySameType(t)&&t.aliasesFromNetwork&&!h?(this.logger.verbose("Found metadata in the cache."),[2,dH.CACHE]):(h&&this.logger.verbose("The metadata entity is expired."),this.logger.verbose("Did not find cloud discovery metadata in the cache... Attempting to get cloud discovery metadata from the network."),null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(vq.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId),[4,this.getCloudDiscoveryMetadataFromNetwork()]));case 1:if(l=m.sent())return this.logger.verbose("cloud discovery metadata was successfully returned from getCloudDiscoveryMetadataFromNetwork()"),t.updateCloudDiscoveryMetadata(l,!0),[2,dH.NETWORK];if(this.logger.verbose("Did not find cloud discovery metadata from the network... Attempting to get cloud discovery metadata from hardcoded values."),(v=this.getCloudDiscoveryMetadataFromHarcodedValues())&&!this.options.skipAuthorityMetadataCache)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),t.updateCloudDiscoveryMetadata(v,!1),[2,dH.HARDCODED_VALUES];throw this.logger.error("Did not find cloud discovery metadata from hardcoded values... Metadata could not be obtained from config, cache, network or hardcoded values. Throwing Untrusted Authority Error."),ZB.createUntrustedAuthorityError()}}))}))},Authority.prototype.getCloudDiscoveryMetadataFromConfig=function(){if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");var t=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),o=Authority.getCloudDiscoveryMetadataFromNetworkResponse(t.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),o)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),o;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(t){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),ZB.createInvalidCloudDiscoveryMetadataError()}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),Authority.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null},Authority.prototype.getCloudDiscoveryMetadataFromNetwork=function(){var t;return __awaiter$2(this,void 0,void 0,(function(){var o,s,l,h,v,m,_,R;return __generator(this,(function($){switch($.label){case 0:null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(vq.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId),o=""+JU.AAD_INSTANCE_DISCOVERY_ENDPT+this.canonicalAuthority+"oauth2/v2.0/authorize",s={},l=null,$.label=1;case 1:return $.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(o,s)];case 2:if(h=$.sent(),v=void 0,m=void 0,function isCloudInstanceDiscoveryResponse(t){return t.hasOwnProperty("tenant_discovery_endpoint")&&t.hasOwnProperty("metadata")}
/*! @azure/msal-common v10.0.0 2023-02-06 */(h.body))v=h.body,m=v.metadata,this.logger.verbosePii("tenant_discovery_endpoint is: "+v.tenant_discovery_endpoint);else{if(!function isCloudInstanceDiscoveryErrorResponse(t){return t.hasOwnProperty("error")&&t.hasOwnProperty("error_description")}(h.body))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),[2,null];if(this.logger.warning("A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: "+h.status),(v=h.body).error===JU.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),[2,null];this.logger.warning("The CloudInstanceDiscoveryErrorResponse error is "+v.error),this.logger.warning("The CloudInstanceDiscoveryErrorResponse error description is "+v.error_description),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),m=[]}return this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),l=Authority.getCloudDiscoveryMetadataFromNetworkResponse(m,this.hostnameAndPort),[3,4];case 3:return(_=$.sent())instanceof RH?this.logger.error("There was a network error while attempting to get the cloud discovery instance metadata.\nError: "+_.errorCode+"\nError Description: "+_.errorMessage):(R=_,this.logger.error("A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: "+R.name+"\nError Description: "+R.message)),[2,null];case 4:return l||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),l=Authority.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),[2,l]}}))}))},Authority.prototype.getCloudDiscoveryMetadataFromHarcodedValues=function(){return this.canonicalAuthority in zq?zq[this.canonicalAuthority]:null},Authority.prototype.isInKnownAuthorities=function(){var t=this;return this.authorityOptions.knownAuthorities.filter((function(o){return Oq.getDomainFromUrl(o).toLowerCase()===t.hostnameAndPort})).length>0},Authority.generateAuthority=function(t,o){var s;if(o&&o.azureCloudInstance!==SB.None){var l=o.tenant?o.tenant:JU.DEFAULT_COMMON_TENANT;s=o.azureCloudInstance+"/"+l+"/"}return s||t},Authority.createCloudDiscoveryMetadataFromHost=function(t){return{preferred_network:t,preferred_cache:t,aliases:[t]}},Authority.getCloudDiscoveryMetadataFromNetworkResponse=function(t,o){for(var s=0;s<t.length;s++){var l=t[s];if(l.aliases.indexOf(o)>-1)return l}return null},Authority.prototype.getPreferredCache=function(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw kB.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},Authority.prototype.isAlias=function(t){return this.metadata.aliases.indexOf(t)>-1},Authority.isPublicCloudAuthority=function(t){return JU.KNOWN_PUBLIC_CLOUDS.indexOf(t)>=0},Authority.buildRegionalAuthorityString=function(t,o,s){var l=new Oq(t);l.validateAsUri();var h=l.getUrlComponents(),v=o+"."+h.HostNameAndPort;this.isPublicCloudAuthority(h.HostNameAndPort)&&(v=o+"."+JU.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX);var m=Oq.constructAuthorityUriFromObject(__assign(__assign({},l.getUrlComponents()),{HostNameAndPort:v})).urlString;return s?m+"?"+s:m},Authority.replaceWithRegionalInformation=function(t,o){return t.authorization_endpoint=Authority.buildRegionalAuthorityString(t.authorization_endpoint,o),t.token_endpoint=Authority.buildRegionalAuthorityString(t.token_endpoint,o,JU.REGIONAL_AUTH_NON_MSI_QUERY_STRING),t.end_session_endpoint&&(t.end_session_endpoint=Authority.buildRegionalAuthorityString(t.end_session_endpoint,o)),t},Authority}(),sj=function(){function AuthorityFactory(){}return AuthorityFactory.createDiscoveredInstance=function(t,o,s,l,h,v,m){return __awaiter$2(this,void 0,void 0,(function(){var _,R;return __generator(this,(function($){switch($.label){case 0:null==v||v.addQueueMeasurement(vq.AuthorityFactoryCreateDiscoveredInstance,m),_=AuthorityFactory.createInstance(t,o,s,l,h,v,m),$.label=1;case 1:return $.trys.push([1,3,,4]),null==v||v.setPreQueueTime(vq.AuthorityResolveEndpointsAsync,m),[4,_.resolveEndpointsAsync()];case 2:return $.sent(),[2,_];case 3:throw R=$.sent(),kB.createEndpointDiscoveryIncompleteError(R);case 4:return[2]}}))}))},AuthorityFactory.createInstance=function(t,o,s,l,h,v,m){if(TB.isEmpty(t))throw ZB.createUrlEmptyError();return new nj(t,o,s,l,h,v,m)},AuthorityFactory}(),aj=function(){function ServerTelemetryEntity(){this.failedRequests=[],this.errors=[],this.cacheHits=0}return ServerTelemetryEntity.isServerTelemetryEntity=function(t,o){var s=0===t.indexOf(gH.CACHE_KEY),l=!0;return o&&(l=o.hasOwnProperty("failedRequests")&&o.hasOwnProperty("errors")&&o.hasOwnProperty("cacheHits")),s&&l},ServerTelemetryEntity}(),cj=function(){function ThrottlingEntity(){}return ThrottlingEntity.isThrottlingEntity=function(t,o){var s=!1;t&&(s=0===t.indexOf(TH));var l=!0;return o&&(l=o.hasOwnProperty("throttleTime")),s&&l},ThrottlingEntity}(),fj={sendGetRequestAsync:function(){return Promise.reject(RH.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented for the Network interface."))},sendPostRequestAsync:function(){return Promise.reject(RH.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented for the Network interface."))}},mj={code:"missing_kid_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided."},bj={code:"missing_alg_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."},_j=function(t){function JoseHeaderError(o,s){var l=t.call(this,o,s)||this;return l.name="JoseHeaderError",Object.setPrototypeOf(l,JoseHeaderError.prototype),l}return __extends(JoseHeaderError,t),JoseHeaderError.createMissingKidError=function(){return new JoseHeaderError(mj.code,mj.desc)},JoseHeaderError.createMissingAlgError=function(){return new JoseHeaderError(bj.code,bj.desc)},JoseHeaderError}(RH),Cj=function(){function JoseHeader(t){this.typ=t.typ,this.alg=t.alg,this.kid=t.kid}return JoseHeader.getShrHeaderString=function(t){if(!t.kid)throw _j.createMissingKidError();if(!t.alg)throw _j.createMissingAlgError();var o=new JoseHeader({typ:t.typ||_H.Jwt,kid:t.kid,alg:t.alg});return JSON.stringify(o)},JoseHeader}(),Tj=function(){function ServerTelemetryManager(t,o){this.cacheOutcome=wH.NO_CACHE_HIT,this.cacheManager=o,this.apiId=t.apiId,this.correlationId=t.correlationId,this.wrapperSKU=t.wrapperSKU||JU.EMPTY_STRING,this.wrapperVer=t.wrapperVer||JU.EMPTY_STRING,this.telemetryCacheKey=gH.CACHE_KEY+iH.CACHE_KEY_SEPARATOR+t.clientId}return ServerTelemetryManager.prototype.generateCurrentRequestHeaderValue=function(){var t=""+this.apiId+gH.VALUE_SEPARATOR+this.cacheOutcome,o=[this.wrapperSKU,this.wrapperVer].join(gH.VALUE_SEPARATOR),s=[t,this.getRegionDiscoveryFields()].join(gH.VALUE_SEPARATOR);return[gH.SCHEMA_VERSION,s,o].join(gH.CATEGORY_SEPARATOR)},ServerTelemetryManager.prototype.generateLastRequestHeaderValue=function(){var t=this.getLastRequests(),o=ServerTelemetryManager.maxErrorsToSend(t),s=t.failedRequests.slice(0,2*o).join(gH.VALUE_SEPARATOR),l=t.errors.slice(0,o).join(gH.VALUE_SEPARATOR),h=t.errors.length,v=[h,o<h?gH.OVERFLOW_TRUE:gH.OVERFLOW_FALSE].join(gH.VALUE_SEPARATOR);return[gH.SCHEMA_VERSION,t.cacheHits,s,l,v].join(gH.CATEGORY_SEPARATOR)},ServerTelemetryManager.prototype.cacheFailedRequest=function(t){var o=this.getLastRequests();o.errors.length>=gH.MAX_CACHED_ERRORS&&(o.failedRequests.shift(),o.failedRequests.shift(),o.errors.shift()),o.failedRequests.push(this.apiId,this.correlationId),TB.isEmpty(t.subError)?TB.isEmpty(t.errorCode)?t&&t.toString()?o.errors.push(t.toString()):o.errors.push(gH.UNKNOWN_ERROR):o.errors.push(t.errorCode):o.errors.push(t.subError),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,o)},ServerTelemetryManager.prototype.incrementCacheHits=function(){var t=this.getLastRequests();return t.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t),t.cacheHits},ServerTelemetryManager.prototype.getLastRequests=function(){var t=new aj;return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||t},ServerTelemetryManager.prototype.clearTelemetryCache=function(){var t=this.getLastRequests(),o=ServerTelemetryManager.maxErrorsToSend(t);if(o===t.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{var s=new aj;s.failedRequests=t.failedRequests.slice(2*o),s.errors=t.errors.slice(o),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,s)}},ServerTelemetryManager.maxErrorsToSend=function(t){var o,s=0,l=0,h=t.errors.length;for(o=0;o<h;o++){var v=t.failedRequests[2*o]||JU.EMPTY_STRING,m=t.failedRequests[2*o+1]||JU.EMPTY_STRING,_=t.errors[o]||JU.EMPTY_STRING;if(!((l+=v.toString().length+m.toString().length+_.length+3)<gH.MAX_LAST_HEADER_BYTES))break;s+=1}return s},ServerTelemetryManager.prototype.getRegionDiscoveryFields=function(){var t=[];return t.push(this.regionUsed||JU.EMPTY_STRING),t.push(this.regionSource||JU.EMPTY_STRING),t.push(this.regionOutcome||JU.EMPTY_STRING),t.join(",")},ServerTelemetryManager.prototype.updateRegionDiscoveryMetadata=function(t){this.regionUsed=t.region_used,this.regionSource=t.region_source,this.regionOutcome=t.region_outcome},ServerTelemetryManager.prototype.setCacheOutcome=function(t){this.cacheOutcome=t},ServerTelemetryManager}(),Sj=function(){function PerformanceClient(t,o,s,l,h,v){this.authority=o,this.libraryName=l,this.libraryVersion=h,this.applicationTelemetry=v,this.clientId=t,this.logger=s,this.callbacks=new Map,this.eventsByCorrelationId=new Map,this.staticFieldsByCorrelationId=new Map,this.measurementsById=new Map,this.queueMeasurements=new Map,this.preQueueTimeByCorrelationId=new Map,this.countersByCorrelationId=new Map}return PerformanceClient.prototype.startPerformanceMeasurement=function(t,o){return{}},PerformanceClient.prototype.startPerformanceMeasuremeant=function(t,o){return{}},PerformanceClient.prototype.getIntFields=function(){return Nq},PerformanceClient.prototype.getPreQueueTime=function(t,o){var s=this.preQueueTimeByCorrelationId.get(o);if(s){if(s.get(t))return s.get(t);this.logger.trace("PerformanceClient.getPreQueueTime: no pre-queue time found for "+t+", unable to add queue measurement")}else this.logger.trace("PerformanceClient.getPreQueueTime: no pre-queue times found for correlationId: "+o+", unable to add queue measurement")},PerformanceClient.prototype.calculateQueuedTime=function(t,o){return t<1?(this.logger.trace("PerformanceClient: preQueueTime should be a positive integer and not "+t),0):o<1?(this.logger.trace("PerformanceClient: currentTime should be a positive integer and not "+o),0):o<t?(this.logger.trace("PerformanceClient: currentTime is less than preQueueTime, check how time is being retrieved"),0):o-t},PerformanceClient.prototype.addQueueMeasurement=function(t,o,s){if(o){if(0===s)this.logger.trace("PerformanceClient.addQueueMeasurement: queue time provided for "+t+" is "+s);else if(!s)return void this.logger.trace("PerformanceClient.addQueueMeasurement: no queue time provided for "+t);var l={eventName:t,queueTime:s},h=this.queueMeasurements.get(o);if(h)h.push(l),this.queueMeasurements.set(o,h);else{this.logger.trace("PerformanceClient.addQueueMeasurement: adding correlationId "+o+" to queue measurements");var v=[l];this.queueMeasurements.set(o,v)}}else this.logger.trace("PerformanceClient.addQueueMeasurement: correlationId not provided for "+t+", cannot add queue measurement")},PerformanceClient.prototype.startMeasurement=function(t,o){var s,l,h,v=this,m=o||this.generateId();o||this.logger.info("PerformanceClient: No correlation id provided for "+t+", generating",m),this.logger.trace("PerformanceClient: Performance measurement started for "+t,m);var _=this.startPerformanceMeasuremeant(t,m);if(_.startMeasurement)_.startMeasurement(),h=_;else{var R=this.startPerformanceMeasurement(t,m);R.startMeasurement(),h=R}var $={eventId:this.generateId(),status:mq.InProgress,authority:this.authority,libraryName:this.libraryName,libraryVersion:this.libraryVersion,clientId:this.clientId,name:t,startTimeMs:Date.now(),correlationId:m};this.cacheEventByCorrelationId($);var B={appName:null===(s=this.applicationTelemetry)||void 0===s?void 0:s.appName,appVersion:null===(l=this.applicationTelemetry)||void 0===l?void 0:l.appVersion};return this.addStaticFields(B,m),this.cacheMeasurement($,h),{endMeasurement:function(t){var o=v.endMeasurement(__assign(__assign({},$),t));return o&&v.cacheEventByCorrelationId(o),o},flushMeasurement:function(){return v.flushMeasurements($.name,$.correlationId)},discardMeasurement:function(){return v.discardMeasurements($.correlationId)},addStaticFields:function(t){return v.addStaticFields(t,$.correlationId)},increment:function(t){return v.increment(t,$.correlationId)},measurement:h,event:$}},PerformanceClient.prototype.endMeasurement=function(t){var o=this.measurementsById.get(t.eventId);if(o){this.measurementsById.delete(t.eventId),o.endMeasurement();var s=o.flushMeasurement();if(null!==s)return this.logger.trace("PerformanceClient: Performance measurement ended for "+t.name+": "+s+" ms",t.correlationId),__assign(__assign({durationMs:Math.round(s)},t),{status:mq.Completed});this.logger.trace("PerformanceClient: Performance measurement not taken",t.correlationId)}else this.logger.trace("PerformanceClient: Measurement not found for "+t.eventId,t.correlationId);return null},PerformanceClient.prototype.addStaticFields=function(t,o){var s=this.staticFieldsByCorrelationId.get(o);s?(this.logger.trace("PerformanceClient: Updating static fields"),this.staticFieldsByCorrelationId.set(o,__assign(__assign({},s),t))):(this.logger.trace("PerformanceClient: Adding static fields"),this.staticFieldsByCorrelationId.set(o,t))},PerformanceClient.prototype.increment=function(t,o){var s=this.countersByCorrelationId.get(o);if(!s)return this.logger.trace("PerformanceClient: Setting counters"),void this.countersByCorrelationId.set(o,__assign({},t));for(var l in this.logger.trace("PerformanceClient: Updating counters"),t)s.hasOwnProperty(l)||(s[l]=0),s[l]+=t[l]},PerformanceClient.prototype.cacheEventByCorrelationId=function(t){var o=this.eventsByCorrelationId.get(t.correlationId);o?(this.logger.trace("PerformanceClient: Performance measurement for "+t.name+" added/updated",t.correlationId),o.set(t.eventId,t)):(this.logger.trace("PerformanceClient: Performance measurement for "+t.name+" started",t.correlationId),this.eventsByCorrelationId.set(t.correlationId,(new Map).set(t.eventId,t)))},PerformanceClient.prototype.cacheMeasurement=function(t,o){this.measurementsById.set(t.eventId,o)},PerformanceClient.prototype.flushMeasurements=function(t,o){var s=this;this.logger.trace("PerformanceClient: Performance measurements flushed for "+t,o);var l=this.queueMeasurements.get(o);l||this.logger.trace("PerformanceClient: no queue measurements found for for correlationId: "+o);var h=0,v=0;null==l||l.forEach((function(t){h+=t.queueTime,v++}));var m=this.eventsByCorrelationId.get(o),_=this.staticFieldsByCorrelationId.get(o),R=this.countersByCorrelationId.get(o);if(m){this.discardCache(o);var $=[],B=0;m.forEach((function(l){if(l.name!==t&&l.status!==mq.Completed){s.logger.trace("PerformanceClient: Incomplete submeasurement "+l.name+" found for "+t,o),B++;var h=s.endMeasurement(l);h&&$.push(h)}$.push(l)}));var q=$.sort((function(t,o){return t.startTimeMs-o.startTimeMs})),j=q.filter((function(o){return o.name===t&&o.status===mq.Completed}));if(j.length>0){j.length>1&&this.logger.verbose("PerformanceClient: Multiple distinct top-level performance events found, using the first",o);var z=j[0];this.logger.verbose("PerformanceClient: Measurement found for "+t,o);var K=q.reduce((function(l,h){if(h.name!==t){s.logger.trace("PerformanceClient: Complete submeasurement found for "+h.name,o);var v=h.name+"DurationMs";l[v]?s.logger.verbose("PerformanceClient: Submeasurement for "+t+" already exists for "+h.name+", ignoring",o):l[v]=h.durationMs}return l}),z),W=__assign(__assign(__assign(__assign({},K),_),R),{queuedTimeMs:h,queuedCount:v,incompleteSubsCount:B});this.truncateIntegralFields(W,this.getIntFields()),this.emitEvents([W],K.correlationId)}else this.logger.verbose("PerformanceClient: No completed top-level measurements found for "+t,o)}else this.logger.verbose("PerformanceClient: No measurements found",o)},PerformanceClient.prototype.discardMeasurements=function(t){this.logger.trace("PerformanceClient: Performance measurements discarded",t),this.eventsByCorrelationId.delete(t)},PerformanceClient.prototype.discardCache=function(t){this.discardMeasurements(t),this.logger.trace("PerformanceClient: Static fields discarded",t),this.staticFieldsByCorrelationId.delete(t),this.logger.trace("PerformanceClient: Counters discarded",t),this.countersByCorrelationId.delete(t),this.logger.trace("PerformanceClient: QueueMeasurements discarded",t),this.queueMeasurements.delete(t),this.logger.trace("PerformanceClient: Pre-queue times discarded",t),this.preQueueTimeByCorrelationId.delete(t)},PerformanceClient.prototype.addPerformanceCallback=function(t){var o=this.generateId();return this.callbacks.set(o,t),this.logger.verbose("PerformanceClient: Performance callback registered with id: "+o),o},PerformanceClient.prototype.removePerformanceCallback=function(t){var o=this.callbacks.delete(t);return o?this.logger.verbose("PerformanceClient: Performance callback "+t+" removed."):this.logger.verbose("PerformanceClient: Performance callback "+t+" not removed."),o},PerformanceClient.prototype.emitEvents=function(t,o){var s=this;this.logger.verbose("PerformanceClient: Emitting performance events",o),this.callbacks.forEach((function(l,h){s.logger.trace("PerformanceClient: Emitting event to callback "+h,o),l.apply(null,[t])}))},PerformanceClient.prototype.truncateIntegralFields=function(t,o){o.forEach((function(o){o in t&&"number"==typeof t[o]&&(t[o]=Math.floor(t[o]))}))},PerformanceClient}(),Ej=function(){function StubPerformanceMeasurement(){}return StubPerformanceMeasurement.prototype.startMeasurement=function(){},StubPerformanceMeasurement.prototype.endMeasurement=function(){},StubPerformanceMeasurement.prototype.flushMeasurement=function(){return null},StubPerformanceMeasurement}(),Ij=function(t){function StubPerformanceClient(){return null!==t&&t.apply(this,arguments)||this}return __extends(StubPerformanceClient,t),StubPerformanceClient.prototype.generateId=function(){return"callback-id"},StubPerformanceClient.prototype.startPerformanceMeasuremeant=function(){return new Ej},StubPerformanceClient.prototype.startPerformanceMeasurement=function(){return new Ej},StubPerformanceClient.prototype.calculateQueuedTime=function(t,o){return 0},StubPerformanceClient.prototype.addQueueMeasurement=function(t,o,s){},StubPerformanceClient.prototype.setPreQueueTime=function(t,o){},StubPerformanceClient}(Sj),Aj={code:"pkce_not_created",desc:"The PKCE code challenge and verifier could not be generated."},Pj={code:"crypto_nonexistent",desc:"The crypto object or function is not available."},Rj={code:"http_method_not_implemented",desc:"The HTTP method given has not been implemented in this library."},Oj={code:"empty_navigate_uri",desc:"Navigation URI is empty. Please check stack trace for more info."},$j={code:"hash_empty_error",desc:"Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. For more visit: aka.ms/msaljs/browser-errors."},Nj={code:"no_state_in_hash",desc:"Hash does not contain state. Please verify that the request originated from msal."},Mj={code:"hash_does_not_contain_known_properties",desc:"Hash does not contain known properites. Please verify that your redirectUri is not changing the hash. For more visit: aka.ms/msaljs/browser-errors."},Dj={code:"unable_to_parse_state",desc:"Unable to parse state. Please verify that the request originated from msal."},Lj={code:"state_interaction_type_mismatch",desc:"Hash contains state but the interaction type does not match the caller."},Uj={code:"interaction_in_progress",desc:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.  For more visit: aka.ms/msaljs/browser-errors."},Hj={code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},Bj={code:"empty_window_error",desc:"window.open returned null or undefined window object."},jj={code:"user_cancelled",desc:"User cancelled the flow."},Vj={code:"monitor_window_timeout",desc:"Token acquisition in popup failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},Gj={code:"monitor_window_timeout",desc:"Token acquisition in iframe failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},Kj={code:"redirect_in_iframe",desc:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."},Wj={code:"block_iframe_reload",desc:"Request was blocked inside an iframe because MSAL detected an authentication response. For more visit: aka.ms/msaljs/browser-errors"},Qj={code:"block_nested_popups",desc:"Request was blocked inside a popup because MSAL detected it was running in a popup."},Yj={code:"iframe_closed_prematurely",desc:"The iframe being monitored was closed prematurely."},Jj={code:"silent_logout_unsupported",desc:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead."},Xj={code:"no_account_error",desc:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request."},Zj={code:"silent_prompt_value_error",desc:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'."},ez={code:"no_token_request_cache_error",desc:"No token request found in cache."},tz={code:"unable_to_parse_token_request_cache_error",desc:"The cached token request could not be parsed."},rz={code:"no_cached_authority_error",desc:"No cached authority found."},oz={code:"auth_request_not_set_error",desc:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler"},nz={code:"invalid_cache_type",desc:"Invalid cache type"},iz={code:"non_browser_environment",desc:"Login and token requests are not supported in non-browser environments."},sz={code:"database_not_open",desc:"Database is not open!"},az={code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},lz={code:"post_request_failed",desc:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'"},cz={code:"get_request_failed",desc:"Network request failed. Please check the network trace to determine root cause."},dz={code:"failed_to_parse_response",desc:"Failed to parse network response. Check network trace."},uz={code:"unable_to_load_token",desc:"Error loading token to cache."},hz={code:"crypto_key_not_found",desc:"Cryptographic Key or Keypair not found in browser storage."},pz={code:"auth_code_required",desc:"An authorization code must be provided (as the `code` property on the request) to this flow."},fz={code:"auth_code_or_nativeAccountId_required",desc:"An authorization code or nativeAccountId must be provided to this flow."},gz={code:"database_unavailable",desc:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts."},vz={code:"unable_to_acquire_token_from_native_platform",desc:"Unable to acquire token from native platform. For a list of possible reasons visit aka.ms/msaljs/browser-errors."},mz={code:"native_handshake_timeout",desc:"Timed out while attempting to establish connection to browser extension"},bz={code:"native_extension_not_installed",desc:"Native extension is not installed. If you think this is a mistake call the initialize function."},yz={code:"native_connection_not_established",desc:"Connection to native platform has not been established. Please install a compatible browser extension and run initialize(). For more please visit aka.ms/msaljs/browser-errors."},wz={code:"native_broker_called_before_initialize",desc:"You must call and await the initialize function before attempting to call any other MSAL API when native brokering is enabled. For more please visit aka.ms/msaljs/browser-errors."},_z={code:"native_prompt_not_supported",desc:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow."},Cz=function(t){function BrowserAuthError(o,s){var l=t.call(this,o,s)||this;return Object.setPrototypeOf(l,BrowserAuthError.prototype),l.name="BrowserAuthError",l}return __extends$1(BrowserAuthError,t),BrowserAuthError.createPkceNotGeneratedError=function(t){return new BrowserAuthError(Aj.code,Aj.desc+" Detail:"+t)},BrowserAuthError.createCryptoNotAvailableError=function(t){return new BrowserAuthError(Pj.code,Pj.desc+" Detail:"+t)},BrowserAuthError.createHttpMethodNotImplementedError=function(t){return new BrowserAuthError(Rj.code,Rj.desc+" Given Method: "+t)},BrowserAuthError.createEmptyNavigationUriError=function(){return new BrowserAuthError(Oj.code,Oj.desc)},BrowserAuthError.createEmptyHashError=function(t){return new BrowserAuthError($j.code,$j.desc+" Given Url: "+t)},BrowserAuthError.createHashDoesNotContainStateError=function(){return new BrowserAuthError(Nj.code,Nj.desc)},BrowserAuthError.createHashDoesNotContainKnownPropertiesError=function(){return new BrowserAuthError(Mj.code,Mj.desc)},BrowserAuthError.createUnableToParseStateError=function(){return new BrowserAuthError(Dj.code,Dj.desc)},BrowserAuthError.createStateInteractionTypeMismatchError=function(){return new BrowserAuthError(Lj.code,Lj.desc)},BrowserAuthError.createInteractionInProgressError=function(){return new BrowserAuthError(Uj.code,Uj.desc)},BrowserAuthError.createPopupWindowError=function(t){var o=Hj.desc;return o=TB.isEmpty(t)?o:o+" Details: "+t,new BrowserAuthError(Hj.code,o)},BrowserAuthError.createEmptyWindowCreatedError=function(){return new BrowserAuthError(Bj.code,Bj.desc)},BrowserAuthError.createUserCancelledError=function(){return new BrowserAuthError(jj.code,jj.desc)},BrowserAuthError.createMonitorPopupTimeoutError=function(){return new BrowserAuthError(Vj.code,Vj.desc)},BrowserAuthError.createMonitorIframeTimeoutError=function(){return new BrowserAuthError(Gj.code,Gj.desc)},BrowserAuthError.createRedirectInIframeError=function(t){return new BrowserAuthError(Kj.code,Kj.desc+" (window.parent !== window) => "+t)},BrowserAuthError.createBlockReloadInHiddenIframeError=function(){return new BrowserAuthError(Wj.code,Wj.desc)},BrowserAuthError.createBlockAcquireTokenInPopupsError=function(){return new BrowserAuthError(Qj.code,Qj.desc)},BrowserAuthError.createIframeClosedPrematurelyError=function(){return new BrowserAuthError(Yj.code,Yj.desc)},BrowserAuthError.createSilentLogoutUnsupportedError=function(){return new BrowserAuthError(Jj.code,Jj.desc)},BrowserAuthError.createNoAccountError=function(){return new BrowserAuthError(Xj.code,Xj.desc)},BrowserAuthError.createSilentPromptValueError=function(t){return new BrowserAuthError(Zj.code,Zj.desc+" Given value: "+t)},BrowserAuthError.createUnableToParseTokenRequestCacheError=function(){return new BrowserAuthError(tz.code,tz.desc)},BrowserAuthError.createNoTokenRequestCacheError=function(){return new BrowserAuthError(ez.code,ez.desc)},BrowserAuthError.createAuthRequestNotSetError=function(){return new BrowserAuthError(oz.code,oz.desc)},BrowserAuthError.createNoCachedAuthorityError=function(){return new BrowserAuthError(rz.code,rz.desc)},BrowserAuthError.createInvalidCacheTypeError=function(){return new BrowserAuthError(nz.code,""+nz.desc)},BrowserAuthError.createNonBrowserEnvironmentError=function(){return new BrowserAuthError(iz.code,iz.desc)},BrowserAuthError.createDatabaseNotOpenError=function(){return new BrowserAuthError(sz.code,sz.desc)},BrowserAuthError.createNoNetworkConnectivityError=function(){return new BrowserAuthError(az.code,az.desc)},BrowserAuthError.createPostRequestFailedError=function(t,o){return new BrowserAuthError(lz.code,lz.desc+" | Network client threw: "+t+" | Attempted to reach: "+o.split("?")[0])},BrowserAuthError.createGetRequestFailedError=function(t,o){return new BrowserAuthError(cz.code,cz.desc+" | Network client threw: "+t+" | Attempted to reach: "+o.split("?")[0])},BrowserAuthError.createFailedToParseNetworkResponseError=function(t){return new BrowserAuthError(dz.code,dz.desc+" | Attempted to reach: "+t.split("?")[0])},BrowserAuthError.createUnableToLoadTokenError=function(t){return new BrowserAuthError(uz.code,uz.desc+" | "+t)},BrowserAuthError.createSigningKeyNotFoundInStorageError=function(t){return new BrowserAuthError(hz.code,hz.desc+" | No match found for KeyId: "+t)},BrowserAuthError.createAuthCodeRequiredError=function(){return new BrowserAuthError(pz.code,pz.desc)},BrowserAuthError.createAuthCodeOrNativeAccountIdRequiredError=function(){return new BrowserAuthError(fz.code,fz.desc)},BrowserAuthError.createDatabaseUnavailableError=function(){return new BrowserAuthError(gz.code,gz.desc)},BrowserAuthError.createUnableToAcquireTokenFromNativePlatformError=function(){return new BrowserAuthError(vz.code,vz.desc)},BrowserAuthError.createNativeHandshakeTimeoutError=function(){return new BrowserAuthError(mz.code,mz.desc)},BrowserAuthError.createNativeExtensionNotInstalledError=function(){return new BrowserAuthError(bz.code,bz.desc)},BrowserAuthError.createNativeConnectionNotEstablishedError=function(){return new BrowserAuthError(yz.code,yz.desc)},BrowserAuthError.createNativeBrokerCalledBeforeInitialize=function(){return new BrowserAuthError(wz.code,wz.desc)},BrowserAuthError.createNativePromptParameterNotSupportedError=function(){return new BrowserAuthError(_z.code,_z.desc)},BrowserAuthError}(RH),kz={INTERACTION_IN_PROGRESS_VALUE:"interaction_in_progress",INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},Tz="53ee284d-920a-4b59-9d30-a60315b26836",Sz="ppnbnpeolgkicgegkbkbjmhlideopiji",xz="MATS";
/*! @azure/msal-common v10.0.0 2023-02-06 */!function(t){t.HandshakeRequest="Handshake",t.HandshakeResponse="HandshakeResponse",t.GetToken="GetToken",t.Response="Response"}(Gq||(Gq={})),function(t){t.LocalStorage="localStorage",t.SessionStorage="sessionStorage",t.MemoryStorage="memoryStorage"}(Kq||(Kq={})),function(t){t.GET="GET",t.POST="POST"}(Wq||(Wq={})),function(t){t.AUTHORITY="authority",t.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",t.SESSION_STATE="session.state",t.REQUEST_STATE="request.state",t.NONCE_IDTOKEN="nonce.id_token",t.ORIGIN_URI="request.origin",t.RENEW_STATUS="token.renew.status",t.URL_HASH="urlHash",t.REQUEST_PARAMS="request.params",t.SCOPES="scopes",t.INTERACTION_STATUS_KEY="interaction.status",t.CCS_CREDENTIAL="ccs.credential",t.CORRELATION_ID="request.correlationId",t.NATIVE_REQUEST="request.native",t.REDIRECT_CONTEXT="request.redirect.context"}(Qq||(Qq={})),function(t){t.WRAPPER_SKU="wrapper.sku",t.WRAPPER_VER="wrapper.version"}(Yq||(Yq={})),function(t){t[t.acquireTokenRedirect=861]="acquireTokenRedirect",t[t.acquireTokenPopup=862]="acquireTokenPopup",t[t.ssoSilent=863]="ssoSilent",t[t.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",t[t.handleRedirectPromise=865]="handleRedirectPromise",t[t.acquireTokenByCode=866]="acquireTokenByCode",t[t.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow",t[t.logout=961]="logout",t[t.logoutPopup=962]="logoutPopup"}(Jq||(Jq={})),function(t){t.Redirect="redirect",t.Popup="popup",t.Silent="silent",t.None="none"}(Xq||(Xq={})),function(t){t.Startup="startup",t.Login="login",t.Logout="logout",t.AcquireToken="acquireToken",t.SsoSilent="ssoSilent",t.HandleRedirect="handleRedirect",t.None="none"}(Zq||(Zq={}));var Ez,Iz={scopes:XU},Az="jwk";!function(t){t.React="@azure/msal-react",t.Angular="@azure/msal-angular"}(Ez||(Ez={}));var Pz,Rz="msal.db",Oz=1,$z=Rz+".keys";!function(t){t[t.Default=0]="Default",t[t.AccessToken=1]="AccessToken",t[t.AccessTokenAndRefreshToken=2]="AccessTokenAndRefreshToken",t[t.RefreshToken=3]="RefreshToken",t[t.RefreshTokenAndNetwork=4]="RefreshTokenAndNetwork",t[t.Skip=5]="Skip"}(Pz||(Pz={}));
/*! @azure/msal-browser v2.33.0 2023-02-06 */
var Nz,Mz,Dz={code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},Lz={code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},Fz={code:"storage_not_supported",desc:"Given storage configuration option was not supported."},Uz={code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},Hz={code:"stubbed_public_client_application_called",desc:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors"},Bz={code:"in_mem_redirect_unavailable",desc:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."},qz={code:"entropy_not_provided",desc:"The available browser crypto interface requires entropy set via system.cryptoOptions.entropy configuration option."},jz=function(t){function BrowserConfigurationAuthError(o,s){var l=t.call(this,o,s)||this;return l.name="BrowserConfigurationAuthError",Object.setPrototypeOf(l,BrowserConfigurationAuthError.prototype),l}return __extends$1(BrowserConfigurationAuthError,t),BrowserConfigurationAuthError.createRedirectUriEmptyError=function(){return new BrowserConfigurationAuthError(Dz.code,Dz.desc)},BrowserConfigurationAuthError.createPostLogoutRedirectUriEmptyError=function(){return new BrowserConfigurationAuthError(Lz.code,Lz.desc)},BrowserConfigurationAuthError.createStorageNotSupportedError=function(t){return new BrowserConfigurationAuthError(Fz.code,Fz.desc+" Given Location: "+t)},BrowserConfigurationAuthError.createRedirectCallbacksNotSetError=function(){return new BrowserConfigurationAuthError(Uz.code,Uz.desc)},BrowserConfigurationAuthError.createStubPcaInstanceCalledError=function(){return new BrowserConfigurationAuthError(Hz.code,Hz.desc)},BrowserConfigurationAuthError.createInMemoryRedirectUnavailableError=function(){return new BrowserConfigurationAuthError(Bz.code,Bz.desc)},BrowserConfigurationAuthError.createEntropyNotProvided=function(){return new BrowserConfigurationAuthError(qz.code,qz.desc)},BrowserConfigurationAuthError}(RH),zz=function(){function BrowserStorage(t){this.validateWindowStorage(t),this.windowStorage=window[t]}return BrowserStorage.prototype.validateWindowStorage=function(t){if(t!==Kq.LocalStorage&&t!==Kq.SessionStorage)throw jz.createStorageNotSupportedError(t);if(!!!window[t])throw jz.createStorageNotSupportedError(t)},BrowserStorage.prototype.getItem=function(t){return this.windowStorage.getItem(t)},BrowserStorage.prototype.setItem=function(t,o){this.windowStorage.setItem(t,o)},BrowserStorage.prototype.removeItem=function(t){this.windowStorage.removeItem(t)},BrowserStorage.prototype.getKeys=function(){return Object.keys(this.windowStorage)},BrowserStorage.prototype.containsKey=function(t){return this.windowStorage.hasOwnProperty(t)},BrowserStorage}(),Vz=function(){function MemoryStorage(){this.cache=new Map}return MemoryStorage.prototype.getItem=function(t){return this.cache.get(t)||null},MemoryStorage.prototype.setItem=function(t,o){this.cache.set(t,o)},MemoryStorage.prototype.removeItem=function(t){this.cache.delete(t)},MemoryStorage.prototype.getKeys=function(){var t=[];return this.cache.forEach((function(o,s){t.push(s)})),t},MemoryStorage.prototype.containsKey=function(t){return this.cache.has(t)},MemoryStorage.prototype.clear=function(){this.cache.clear()},MemoryStorage}(),Gz=function(){function BrowserProtocolUtils(){}return BrowserProtocolUtils.extractBrowserRequestState=function(t,o){if(TB.isEmpty(o))return null;try{return Rq.parseRequestState(t,o).libraryState.meta}catch(t){throw kB.createInvalidStateError(o,t)}},BrowserProtocolUtils.parseServerResponseFromHash=function(t){if(!t)return{};var o=new Oq(t);return Oq.getDeserializedHash(o.getHash())},BrowserProtocolUtils}(),Kz=function(t){function BrowserCacheManager(o,s,l,h){var v=t.call(this,o,l)||this;return v.COOKIE_LIFE_MULTIPLIER=864e5,v.cacheConfig=s,v.logger=h,v.internalStorage=new Vz,v.browserStorage=v.setupBrowserStorage(v.cacheConfig.cacheLocation),v.temporaryCacheStorage=v.setupTemporaryCacheStorage(v.cacheConfig.cacheLocation),v.migrateCacheEntries(),v}return __extends$1(BrowserCacheManager,t),BrowserCacheManager.prototype.setupBrowserStorage=function(t){switch(t){case Kq.LocalStorage:case Kq.SessionStorage:try{return new zz(t)}catch(t){this.logger.verbose(t);break}}return this.cacheConfig.cacheLocation=Kq.MemoryStorage,new Vz},BrowserCacheManager.prototype.setupTemporaryCacheStorage=function(t){switch(t){case Kq.LocalStorage:case Kq.SessionStorage:try{return new zz(Kq.SessionStorage)}catch(t){return this.logger.verbose(t),this.internalStorage}case Kq.MemoryStorage:default:return this.internalStorage}},BrowserCacheManager.prototype.migrateCacheEntries=function(){var t=this,o=JU.CACHE_PREFIX+"."+KU.ID_TOKEN,s=JU.CACHE_PREFIX+"."+KU.CLIENT_INFO,l=JU.CACHE_PREFIX+"."+KU.ERROR,h=JU.CACHE_PREFIX+"."+KU.ERROR_DESC,v=[this.browserStorage.getItem(o),this.browserStorage.getItem(s),this.browserStorage.getItem(l),this.browserStorage.getItem(h)];[KU.ID_TOKEN,KU.CLIENT_INFO,KU.ERROR,KU.ERROR_DESC].forEach((function(o,s){return t.migrateCacheEntry(o,v[s])}))},BrowserCacheManager.prototype.migrateCacheEntry=function(t,o){o&&this.setTemporaryCache(t,o,!0)},BrowserCacheManager.prototype.validateAndParseJson=function(t){try{var o=JSON.parse(t);return o&&"object"==typeof o?o:null}catch(t){return null}},BrowserCacheManager.prototype.getItem=function(t){return this.browserStorage.getItem(t)},BrowserCacheManager.prototype.setItem=function(t,o){this.browserStorage.setItem(t,o)},BrowserCacheManager.prototype.getAccount=function(t){var o=this.getItem(t);if(!o)return null;var s=this.validateAndParseJson(o);return s&&tq.isAccountEntity(s)?oq.toObject(new tq,s):null},BrowserCacheManager.prototype.setAccount=function(t){this.logger.trace("BrowserCacheManager.setAccount called");var o=t.generateAccountKey();this.setItem(o,JSON.stringify(t))},BrowserCacheManager.prototype.getIdTokenCredential=function(t){var o=this.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null;var s=this.validateAndParseJson(o);return s&&_q.isIdTokenEntity(s)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),oq.toObject(new _q,s)):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null)},BrowserCacheManager.prototype.setIdTokenCredential=function(t){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");var o=t.generateCredentialKey();this.setItem(o,JSON.stringify(t))},BrowserCacheManager.prototype.getAccessTokenCredential=function(t){var o=this.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null;var s=this.validateAndParseJson(o);return s&&kq.isAccessTokenEntity(s)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),oq.toObject(new kq,s)):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null)},BrowserCacheManager.prototype.setAccessTokenCredential=function(t){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");var o=t.generateCredentialKey();this.setItem(o,JSON.stringify(t))},BrowserCacheManager.prototype.getRefreshTokenCredential=function(t){var o=this.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null;var s=this.validateAndParseJson(o);return s&&Tq.isRefreshTokenEntity(s)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),oq.toObject(new Tq,s)):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null)},BrowserCacheManager.prototype.setRefreshTokenCredential=function(t){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");var o=t.generateCredentialKey();this.setItem(o,JSON.stringify(t))},BrowserCacheManager.prototype.getAppMetadata=function(t){var o=this.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;var s=this.validateAndParseJson(o);return s&&Dq.isAppMetadataEntity(t,s)?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),oq.toObject(new Dq,s)):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null)},BrowserCacheManager.prototype.setAppMetadata=function(t){this.logger.trace("BrowserCacheManager.setAppMetadata called");var o=t.generateAppMetadataKey();this.setItem(o,JSON.stringify(t))},BrowserCacheManager.prototype.getServerTelemetry=function(t){var o=this.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;var s=this.validateAndParseJson(o);return s&&aj.isServerTelemetryEntity(t,s)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),oq.toObject(new aj,s)):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)},BrowserCacheManager.prototype.setServerTelemetry=function(t,o){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(t,JSON.stringify(o))},BrowserCacheManager.prototype.getAuthorityMetadata=function(t){var o=this.internalStorage.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;var s=this.validateAndParseJson(o);return s&&Vq.isAuthorityMetadataEntity(t,s)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),oq.toObject(new Vq,s)):null},BrowserCacheManager.prototype.getAuthorityMetadataKeys=function(){var t=this;return this.internalStorage.getKeys().filter((function(o){return t.isAuthorityMetadata(o)}))},BrowserCacheManager.prototype.setWrapperMetadata=function(t,o){this.internalStorage.setItem(Yq.WRAPPER_SKU,t),this.internalStorage.setItem(Yq.WRAPPER_VER,o)},BrowserCacheManager.prototype.getWrapperMetadata=function(){return[this.internalStorage.getItem(Yq.WRAPPER_SKU)||JU.EMPTY_STRING,this.internalStorage.getItem(Yq.WRAPPER_VER)||JU.EMPTY_STRING]},BrowserCacheManager.prototype.setAuthorityMetadata=function(t,o){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(t,JSON.stringify(o))},BrowserCacheManager.prototype.getActiveAccount=function(){var t=this.generateCacheKey(KU.ACTIVE_ACCOUNT_FILTERS),o=this.getItem(t);if(!o){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");var s=this.generateCacheKey(KU.ACTIVE_ACCOUNT),l=this.getItem(s);if(!l)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;var h=this.getAccountInfoByFilter({localAccountId:l})[0]||null;return h?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(h),h):null}var v=this.validateAndParseJson(o);return v?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoByFilter({homeAccountId:v.homeAccountId,localAccountId:v.localAccountId})[0]||null):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)},BrowserCacheManager.prototype.setActiveAccount=function(t){var o=this.generateCacheKey(KU.ACTIVE_ACCOUNT_FILTERS),s=this.generateCacheKey(KU.ACTIVE_ACCOUNT);if(t){this.logger.verbose("setActiveAccount: Active account set");var l={homeAccountId:t.homeAccountId,localAccountId:t.localAccountId};this.browserStorage.setItem(o,JSON.stringify(l)),this.browserStorage.setItem(s,t.localAccountId)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(o),this.browserStorage.removeItem(s)},BrowserCacheManager.prototype.getAccountInfoByFilter=function(t){var o=this.getAllAccounts();return this.logger.trace("BrowserCacheManager.getAccountInfoByFilter: total "+o.length+" accounts found"),o.filter((function(o){return(!t.username||t.username.toLowerCase()===o.username.toLowerCase())&&((!t.homeAccountId||t.homeAccountId===o.homeAccountId)&&((!t.localAccountId||t.localAccountId===o.localAccountId)&&((!t.tenantId||t.tenantId===o.tenantId)&&(!t.environment||t.environment===o.environment))))}))},BrowserCacheManager.prototype.getAccountInfoByHints=function(t,o){var s=this.getAllAccounts().filter((function(s){if(o){var l=s.idTokenClaims&&s.idTokenClaims.sid;return o===l}return!!t&&t===s.username}));if(1===s.length)return s[0];if(s.length>1)throw kB.createMultipleMatchingAccountsInCacheError();return null},BrowserCacheManager.prototype.getThrottlingCache=function(t){var o=this.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;var s=this.validateAndParseJson(o);return s&&cj.isThrottlingEntity(t,s)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),oq.toObject(new cj,s)):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)},BrowserCacheManager.prototype.setThrottlingCache=function(t,o){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(t,JSON.stringify(o))},BrowserCacheManager.prototype.getTemporaryCache=function(t,o){var s=o?this.generateCacheKey(t):t;if(this.cacheConfig.storeAuthStateInCookie){var l=this.getItemCookie(s);if(l)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),l}var h=this.temporaryCacheStorage.getItem(s);if(!h){if(this.cacheConfig.cacheLocation===Kq.LocalStorage){var v=this.browserStorage.getItem(s);if(v)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),v}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),h},BrowserCacheManager.prototype.setTemporaryCache=function(t,o,s){var l=s?this.generateCacheKey(t):t;this.temporaryCacheStorage.setItem(l,o),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(l,o))},BrowserCacheManager.prototype.removeItem=function(t){return this.browserStorage.removeItem(t),this.temporaryCacheStorage.removeItem(t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(t)),!0},BrowserCacheManager.prototype.containsKey=function(t){return this.browserStorage.containsKey(t)||this.temporaryCacheStorage.containsKey(t)},BrowserCacheManager.prototype.getKeys=function(){return __spread(this.browserStorage.getKeys(),this.temporaryCacheStorage.getKeys())},BrowserCacheManager.prototype.clear=function(){return __awaiter$3(this,void 0,void 0,(function(){var t=this;return __generator$1(this,(function(o){switch(o.label){case 0:return[4,this.removeAllAccounts()];case 1:return o.sent(),this.removeAppMetadata(),this.getKeys().forEach((function(o){!t.browserStorage.containsKey(o)&&!t.temporaryCacheStorage.containsKey(o)||-1===o.indexOf(JU.CACHE_PREFIX)&&-1===o.indexOf(t.clientId)||t.removeItem(o)})),this.internalStorage.clear(),[2]}}))}))},BrowserCacheManager.prototype.setItemCookie=function(t,o,s){var l=encodeURIComponent(t)+"="+encodeURIComponent(o)+";path=/;SameSite=Lax;";s&&(l+="expires="+this.getCookieExpirationTime(s)+";");this.cacheConfig.secureCookies&&(l+="Secure;"),document.cookie=l},BrowserCacheManager.prototype.getItemCookie=function(t){for(var o=encodeURIComponent(t)+"=",s=document.cookie.split(";"),l=0;l<s.length;l++){for(var h=s[l];" "===h.charAt(0);)h=h.substring(1);if(0===h.indexOf(o))return decodeURIComponent(h.substring(o.length,h.length))}return JU.EMPTY_STRING},BrowserCacheManager.prototype.clearMsalCookies=function(){var t=this,o=JU.CACHE_PREFIX+"."+this.clientId;document.cookie.split(";").forEach((function(s){for(;" "===s.charAt(0);)s=s.substring(1);if(0===s.indexOf(o)){var l=s.split("=")[0];t.clearItemCookie(l)}}))},BrowserCacheManager.prototype.clearItemCookie=function(t){this.setItemCookie(t,JU.EMPTY_STRING,-1)},BrowserCacheManager.prototype.getCookieExpirationTime=function(t){var o=new Date;return new Date(o.getTime()+t*this.COOKIE_LIFE_MULTIPLIER).toUTCString()},BrowserCacheManager.prototype.getCache=function(){return this.browserStorage},BrowserCacheManager.prototype.setCache=function(){},BrowserCacheManager.prototype.generateCacheKey=function(t){return this.validateAndParseJson(t)?JSON.stringify(t):TB.startsWith(t,JU.CACHE_PREFIX)||TB.startsWith(t,KU.ADAL_ID_TOKEN)?t:JU.CACHE_PREFIX+"."+this.clientId+"."+t},BrowserCacheManager.prototype.generateAuthorityKey=function(t){var o=Rq.parseRequestState(this.cryptoImpl,t).libraryState.id;return this.generateCacheKey(Qq.AUTHORITY+"."+o)},BrowserCacheManager.prototype.generateNonceKey=function(t){var o=Rq.parseRequestState(this.cryptoImpl,t).libraryState.id;return this.generateCacheKey(Qq.NONCE_IDTOKEN+"."+o)},BrowserCacheManager.prototype.generateStateKey=function(t){var o=Rq.parseRequestState(this.cryptoImpl,t).libraryState.id;return this.generateCacheKey(Qq.REQUEST_STATE+"."+o)},BrowserCacheManager.prototype.getCachedAuthority=function(t){var o=this.generateStateKey(t),s=this.getTemporaryCache(o);if(!s)return null;var l=this.generateAuthorityKey(s);return this.getTemporaryCache(l)},BrowserCacheManager.prototype.updateCacheEntries=function(t,o,s,l,h){this.logger.trace("BrowserCacheManager.updateCacheEntries called");var v=this.generateStateKey(t);this.setTemporaryCache(v,t,!1);var m=this.generateNonceKey(t);this.setTemporaryCache(m,o,!1);var _=this.generateAuthorityKey(t);if(this.setTemporaryCache(_,s,!1),h){var R={credential:h.homeAccountId,type:hq.HOME_ACCOUNT_ID};this.setTemporaryCache(Qq.CCS_CREDENTIAL,JSON.stringify(R),!0)}else if(!TB.isEmpty(l)){R={credential:l,type:hq.UPN};this.setTemporaryCache(Qq.CCS_CREDENTIAL,JSON.stringify(R),!0)}},BrowserCacheManager.prototype.resetRequestCache=function(t){var o=this;this.logger.trace("BrowserCacheManager.resetRequestCache called"),TB.isEmpty(t)||this.getKeys().forEach((function(s){-1!==s.indexOf(t)&&o.removeItem(s)})),t&&(this.removeItem(this.generateStateKey(t)),this.removeItem(this.generateNonceKey(t)),this.removeItem(this.generateAuthorityKey(t))),this.removeItem(this.generateCacheKey(Qq.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(Qq.ORIGIN_URI)),this.removeItem(this.generateCacheKey(Qq.URL_HASH)),this.removeItem(this.generateCacheKey(Qq.CORRELATION_ID)),this.removeItem(this.generateCacheKey(Qq.CCS_CREDENTIAL)),this.removeItem(this.generateCacheKey(Qq.NATIVE_REQUEST)),this.setInteractionInProgress(!1)},BrowserCacheManager.prototype.cleanRequestByState=function(t){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),t){var o=this.generateStateKey(t),s=this.temporaryCacheStorage.getItem(o);this.logger.infoPii("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: "+s),this.resetRequestCache(s||JU.EMPTY_STRING)}this.clearMsalCookies()},BrowserCacheManager.prototype.cleanRequestByInteractionType=function(t){var o=this;this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.getKeys().forEach((function(s){if(-1!==s.indexOf(Qq.REQUEST_STATE)){var l=o.temporaryCacheStorage.getItem(s);if(l){var h=Gz.extractBrowserRequestState(o.cryptoImpl,l);h&&h.interactionType===t&&(o.logger.infoPii("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: "+l),o.resetRequestCache(l))}}})),this.clearMsalCookies(),this.setInteractionInProgress(!1)},BrowserCacheManager.prototype.cacheCodeRequest=function(t,o){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");var s=o.base64Encode(JSON.stringify(t));this.setTemporaryCache(Qq.REQUEST_PARAMS,s,!0)},BrowserCacheManager.prototype.getCachedRequest=function(t,o){this.logger.trace("BrowserCacheManager.getCachedRequest called");var s=this.getTemporaryCache(Qq.REQUEST_PARAMS,!0);if(!s)throw Cz.createNoTokenRequestCacheError();var l=this.validateAndParseJson(o.base64Decode(s));if(!l)throw Cz.createUnableToParseTokenRequestCacheError();if(this.removeItem(this.generateCacheKey(Qq.REQUEST_PARAMS)),TB.isEmpty(l.authority)){var h=this.generateAuthorityKey(t),v=this.getTemporaryCache(h);if(!v)throw Cz.createNoCachedAuthorityError();l.authority=v}return l},BrowserCacheManager.prototype.getCachedNativeRequest=function(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");var t=this.getTemporaryCache(Qq.NATIVE_REQUEST,!0);if(!t)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;var o=this.validateAndParseJson(t);return o||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)},BrowserCacheManager.prototype.isInteractionInProgress=function(t){var o=this.getInteractionInProgress();return t?o===this.clientId:!!o},BrowserCacheManager.prototype.getInteractionInProgress=function(){var t=JU.CACHE_PREFIX+"."+Qq.INTERACTION_STATUS_KEY;return this.getTemporaryCache(t,!1)},BrowserCacheManager.prototype.setInteractionInProgress=function(t){var o=JU.CACHE_PREFIX+"."+Qq.INTERACTION_STATUS_KEY;if(t){if(this.getInteractionInProgress())throw Cz.createInteractionInProgressError();this.setTemporaryCache(o,this.clientId,!1)}else t||this.getInteractionInProgress()!==this.clientId||this.removeItem(o)},BrowserCacheManager.prototype.getLegacyLoginHint=function(){var t=this.getTemporaryCache(KU.ADAL_ID_TOKEN);t&&(this.browserStorage.removeItem(KU.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));var o=this.getTemporaryCache(KU.ID_TOKEN,!0);o&&(this.removeItem(this.generateCacheKey(KU.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));var s=o||t;if(s){var l=new rq(s,this.cryptoImpl);if(l.claims&&l.claims.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),l.claims.preferred_username;if(l.claims&&l.claims.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),l.claims.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null},BrowserCacheManager.prototype.updateCredentialCacheKey=function(t,o){var s=o.generateCredentialKey();if(t!==s){var l=this.getItem(t);if(l)return this.removeItem(t),this.setItem(s,l),this.logger.verbose("Updated an outdated "+o.credentialType+" cache key"),s;this.logger.error("Attempted to update an outdated "+o.credentialType+" cache key but no item matching the outdated key was found in storage")}return t},BrowserCacheManager.prototype.getRedirectRequestContext=function(){return this.getTemporaryCache(Qq.REDIRECT_CONTEXT,!0)},BrowserCacheManager.prototype.setRedirectRequestContext=function(t){this.setTemporaryCache(Qq.REDIRECT_CONTEXT,t,!0)},BrowserCacheManager}(oq),DEFAULT_BROWSER_CACHE_MANAGER=function(t,o){var s={cacheLocation:Kq.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1};return new Kz(t,s,OH,o)},Wz="@azure/msal-browser",Qz="2.33.0",Yz=function(){function FetchClient(){}return FetchClient.prototype.sendGetRequestAsync=function(t,o){return __awaiter$3(this,void 0,void 0,(function(){var s,l,h;return __generator$1(this,(function(v){switch(v.label){case 0:return v.trys.push([0,2,,3]),[4,fetch(t,{method:Wq.GET,headers:this.getFetchHeaders(o)})];case 1:return s=v.sent(),[3,3];case 2:throw l=v.sent(),window.navigator.onLine?Cz.createGetRequestFailedError(l,t):Cz.createNoNetworkConnectivityError();case 3:return v.trys.push([3,5,,6]),h={headers:this.getHeaderDict(s.headers)},[4,s.json()];case 4:return[2,(h.body=v.sent(),h.status=s.status,h)];case 5:throw v.sent(),Cz.createFailedToParseNetworkResponseError(t);case 6:return[2]}}))}))},FetchClient.prototype.sendPostRequestAsync=function(t,o){return __awaiter$3(this,void 0,void 0,(function(){var s,l,h,v;return __generator$1(this,(function(m){switch(m.label){case 0:s=o&&o.body||JU.EMPTY_STRING,m.label=1;case 1:return m.trys.push([1,3,,4]),[4,fetch(t,{method:Wq.POST,headers:this.getFetchHeaders(o),body:s})];case 2:return l=m.sent(),[3,4];case 3:throw h=m.sent(),window.navigator.onLine?Cz.createPostRequestFailedError(h,t):Cz.createNoNetworkConnectivityError();case 4:return m.trys.push([4,6,,7]),v={headers:this.getHeaderDict(l.headers)},[4,l.json()];case 5:return[2,(v.body=m.sent(),v.status=l.status,v)];case 6:throw m.sent(),Cz.createFailedToParseNetworkResponseError(t);case 7:return[2]}}))}))},FetchClient.prototype.getFetchHeaders=function(t){var o=new Headers;if(!t||!t.headers)return o;var s=t.headers;return Object.keys(s).forEach((function(t){o.append(t,s[t])})),o},FetchClient.prototype.getHeaderDict=function(t){var o={};return t.forEach((function(t,s){o[s]=t})),o},FetchClient}(),Jz=function(){function XhrClient(){}return XhrClient.prototype.sendGetRequestAsync=function(t,o){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(s){return[2,this.sendRequestAsync(t,Wq.GET,o)]}))}))},XhrClient.prototype.sendPostRequestAsync=function(t,o){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(s){return[2,this.sendRequestAsync(t,Wq.POST,o)]}))}))},XhrClient.prototype.sendRequestAsync=function(t,o,s){var l=this;return new Promise((function(h,v){var m=new XMLHttpRequest;if(m.open(o,t,!0),l.setXhrHeaders(m,s),m.onload=function(){(m.status<200||m.status>=300)&&(o===Wq.POST?v(Cz.createPostRequestFailedError("Failed with status "+m.status,t)):v(Cz.createGetRequestFailedError("Failed with status "+m.status,t)));try{var s=JSON.parse(m.responseText),_={headers:l.getHeaderDict(m),body:s,status:m.status};h(_)}catch(o){v(Cz.createFailedToParseNetworkResponseError(t))}},m.onerror=function(){window.navigator.onLine?o===Wq.POST?v(Cz.createPostRequestFailedError("Failed with status "+m.status,t)):v(Cz.createGetRequestFailedError("Failed with status "+m.status,t)):v(Cz.createNoNetworkConnectivityError())},o===Wq.POST&&s&&s.body)m.send(s.body);else{if(o!==Wq.GET)throw Cz.createHttpMethodNotImplementedError(o);m.send()}}))},XhrClient.prototype.setXhrHeaders=function(t,o){if(o&&o.headers){var s=o.headers;Object.keys(s).forEach((function(o){t.setRequestHeader(o,s[o])}))}},XhrClient.prototype.getHeaderDict=function(t){var o=t.getAllResponseHeaders().trim().split(/[\r\n]+/),s={};return o.forEach((function(t){var o=t.split(": "),l=o.shift(),h=o.join(": ");l&&h&&(s[l]=h)})),s},XhrClient}(),Xz=function(){function BrowserUtils(){}return BrowserUtils.clearHash=function(t){t.location.hash=JU.EMPTY_STRING,"function"==typeof t.history.replaceState&&t.history.replaceState(null,JU.EMPTY_STRING,""+t.location.origin+t.location.pathname+t.location.search)},BrowserUtils.replaceHash=function(t){var o=t.split("#");o.shift(),window.location.hash=o.length>0?o.join("#"):JU.EMPTY_STRING},BrowserUtils.isInIframe=function(){return window.parent!==window},BrowserUtils.isInPopup=function(){return"undefined"!=typeof window&&!!window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf(kz.POPUP_NAME_PREFIX+".")},BrowserUtils.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},BrowserUtils.getHomepage=function(){var t=new Oq(window.location.href).getUrlComponents();return t.Protocol+"//"+t.HostNameAndPort+"/"},BrowserUtils.getBrowserNetworkClient=function(){return window.fetch&&window.Headers?new Yz:new Jz},BrowserUtils.blockReloadInHiddenIframes=function(){if(Oq.hashContainsKnownProperties(window.location.hash)&&BrowserUtils.isInIframe())throw Cz.createBlockReloadInHiddenIframeError()},BrowserUtils.blockRedirectInIframe=function(t,o){var s=BrowserUtils.isInIframe();if(t===Xq.Redirect&&s&&!o)throw Cz.createRedirectInIframeError(s)},BrowserUtils.blockAcquireTokenInPopups=function(){if(BrowserUtils.isInPopup())throw Cz.createBlockAcquireTokenInPopupsError()},BrowserUtils.blockNonBrowserEnvironment=function(t){if(!t)throw Cz.createNonBrowserEnvironmentError()},BrowserUtils.blockNativeBrokerCalledBeforeInitialized=function(t,o){if(t&&!o)throw Cz.createNativeBrokerCalledBeforeInitialize()},BrowserUtils.detectIEOrEdge=function(){var t=window.navigator.userAgent,o=t.indexOf("MSIE "),s=t.indexOf("Trident/"),l=t.indexOf("Edge/");return o>0||s>0||l>0},BrowserUtils}(),Zz=function(){function BaseInteractionClient(t,o,s,l,h,v,m,_,R){this.config=t,this.browserStorage=o,this.browserCrypto=s,this.networkClient=this.config.system.networkClient,this.eventHandler=h,this.navigationClient=v,this.nativeMessageHandler=_,this.correlationId=R||this.browserCrypto.createNewGuid(),this.logger=l.clone(kz.MSAL_SKU,Qz,this.correlationId),this.performanceClient=m}return BaseInteractionClient.prototype.clearCacheOnLogout=function(t){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(o){switch(o.label){case 0:if(!t)return[3,5];tq.accountInfoIsEqual(t,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null)),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.browserStorage.removeAccount(tq.generateAccountCacheKey(t))];case 2:return o.sent(),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request."),[3,4];case 3:return o.sent(),this.logger.error("Account provided in logout request was not found. Local cache unchanged."),[3,4];case 4:return[3,9];case 5:return o.trys.push([5,8,,9]),this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),[4,this.browserStorage.clear()];case 6:return o.sent(),[4,this.browserCrypto.clearKeystore()];case 7:return o.sent(),[3,9];case 8:return o.sent(),this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged."),[3,9];case 9:return[2]}}))}))},BaseInteractionClient.prototype.initializeBaseRequest=function(t){return __awaiter$3(this,void 0,void 0,(function(){var o,s,l,h;return __generator$1(this,(function(v){switch(v.label){case 0:if(this.performanceClient.addQueueMeasurement(vq.InitializeBaseRequest,t.correlationId),this.logger.verbose("Initializing BaseAuthRequest"),o=t.authority||this.config.auth.authority,s=__spread(t&&t.scopes||[]),(l=__assign$1(__assign$1({},t),{correlationId:this.correlationId,authority:o,scopes:s})).authenticationScheme){if(l.authenticationScheme===fH.SSH){if(!t.sshJwk)throw ZB.createMissingSshJwkError();if(!t.sshKid)throw ZB.createMissingSshKidError()}this.logger.verbose('Authentication Scheme set to "'+l.authenticationScheme+'" as configured in Auth request')}else l.authenticationScheme=fH.BEARER,this.logger.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return!t.claims||TB.isEmpty(t.claims)?[3,2]:(h=l,[4,this.browserCrypto.hashString(t.claims)]);case 1:h.requestedClaimsHash=v.sent(),v.label=2;case 2:return[2,l]}}))}))},BaseInteractionClient.prototype.getRedirectUri=function(t){this.logger.verbose("getRedirectUri called");var o=t||this.config.auth.redirectUri||Xz.getCurrentUri();return Oq.getAbsoluteUrl(o,Xz.getCurrentUri())},BaseInteractionClient.prototype.initializeServerTelemetryManager=function(t,o){this.logger.verbose("initializeServerTelemetryManager called");var s={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:t,forceRefresh:o||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new Tj(s,this.browserStorage)},BaseInteractionClient.prototype.getDiscoveredAuthority=function(t){return __awaiter$3(this,void 0,void 0,(function(){var o;return __generator$1(this,(function(s){switch(s.label){case 0:return this.logger.verbose("getDiscoveredAuthority called"),o={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},t?(this.logger.verbose("Creating discovered authority with request authority"),[4,sj.createDiscoveredInstance(t,this.config.system.networkClient,this.browserStorage,o,this.logger)]):[3,2];case 1:case 3:return[2,s.sent()];case 2:return this.logger.verbose("Creating discovered authority with configured authority"),[4,sj.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient,this.browserStorage,o,this.logger)]}}))}))},BaseInteractionClient}(),eV=function(t){function StandardInteractionClient(){return null!==t&&t.apply(this,arguments)||this}return __extends$1(StandardInteractionClient,t),StandardInteractionClient.prototype.initializeAuthorizationCodeRequest=function(t){return __awaiter$3(this,void 0,void 0,(function(){var o,s;return __generator$1(this,(function(l){switch(l.label){case 0:return this.performanceClient.addQueueMeasurement(vq.StandardInteractionClientInitializeAuthorizationCodeRequest,t.correlationId),this.logger.verbose("initializeAuthorizationRequest called",t.correlationId),[4,this.browserCrypto.generatePkceCodes()];case 1:return o=l.sent(),s=__assign$1(__assign$1({},t),{redirectUri:t.redirectUri,code:JU.EMPTY_STRING,codeVerifier:o.verifier}),t.codeChallenge=o.challenge,t.codeChallengeMethod=JU.S256_CODE_CHALLENGE_METHOD,[2,s]}}))}))},StandardInteractionClient.prototype.initializeLogoutRequest=function(t){this.logger.verbose("initializeLogoutRequest called",null==t?void 0:t.correlationId);var o=__assign$1({correlationId:this.correlationId||this.browserCrypto.createNewGuid()},t);if(t)if(t.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(t.account){var s=this.getLogoutHintFromIdTokenClaims(t.account);s&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),o.logoutHint=s)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return t&&null===t.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",o.correlationId):t&&t.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",o.correlationId),o.postLogoutRedirectUri=Oq.getAbsoluteUrl(t.postLogoutRedirectUri,Xz.getCurrentUri())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",o.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",o.correlationId),o.postLogoutRedirectUri=Oq.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,Xz.getCurrentUri())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",o.correlationId),o.postLogoutRedirectUri=Oq.getAbsoluteUrl(Xz.getCurrentUri(),Xz.getCurrentUri())),o},StandardInteractionClient.prototype.getLogoutHintFromIdTokenClaims=function(t){var o=t.idTokenClaims;if(o){if(o.login_hint)return o.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null},StandardInteractionClient.prototype.createAuthCodeClient=function(t,o,s){return __awaiter$3(this,void 0,void 0,(function(){var l;return __generator$1(this,(function(h){switch(h.label){case 0:return this.performanceClient.addQueueMeasurement(vq.StandardInteractionClientCreateAuthCodeClient,this.correlationId),this.performanceClient.setPreQueueTime(vq.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(t,o,s)];case 1:return l=h.sent(),[2,new Uq(l,this.performanceClient)]}}))}))},StandardInteractionClient.prototype.getClientConfiguration=function(t,o,s){return __awaiter$3(this,void 0,void 0,(function(){var l,h;return __generator$1(this,(function(v){switch(v.label){case 0:return this.performanceClient.addQueueMeasurement(vq.StandardInteractionClientGetClientConfiguration,this.correlationId),this.logger.verbose("getClientConfiguration called",this.correlationId),this.performanceClient.setPreQueueTime(vq.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),[4,this.getDiscoveredAuthority(o,s)];case 1:return l=v.sent(),h=this.config.system.loggerOptions,[2,{authOptions:{clientId:this.config.auth.clientId,authority:l,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:h.loggerCallback,piiLoggingEnabled:h.piiLoggingEnabled,logLevel:h.logLevel,correlationId:this.correlationId},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:kz.MSAL_SKU,version:Qz,cpu:JU.EMPTY_STRING,os:JU.EMPTY_STRING},telemetry:this.config.telemetry}]}}))}))},StandardInteractionClient.prototype.validateAndExtractStateFromHash=function(t,o,s){if(this.logger.verbose("validateAndExtractStateFromHash called",s),!t.state)throw Cz.createHashDoesNotContainStateError();var l=Gz.extractBrowserRequestState(this.browserCrypto,t.state);if(!l)throw Cz.createUnableToParseStateError();if(l.interactionType!==o)throw Cz.createStateInteractionTypeMismatchError();return this.logger.verbose("Returning state from hash",s),t.state},StandardInteractionClient.prototype.getDiscoveredAuthority=function(t,o){var s;return __awaiter$3(this,void 0,void 0,(function(){var l,h,v,m;return __generator$1(this,(function(_){switch(_.label){case 0:return this.performanceClient.addQueueMeasurement(vq.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),this.logger.verbose("getDiscoveredAuthority called",this.correlationId),l=null===(s=this.performanceClient)||void 0===s?void 0:s.startMeasurement(vq.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),h={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},v=t||this.config.auth.authority,m=nj.generateAuthority(v,o||this.config.auth.azureCloudOptions),this.logger.verbose("Creating discovered authority with configured authority",this.correlationId),this.performanceClient.setPreQueueTime(vq.AuthorityFactoryCreateDiscoveredInstance,this.correlationId),[4,sj.createDiscoveredInstance(m,this.config.system.networkClient,this.browserStorage,h,this.logger,this.performanceClient,this.correlationId).then((function(t){return l.endMeasurement({success:!0}),t})).catch((function(t){throw l.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t}))];case 1:return[2,_.sent()]}}))}))},StandardInteractionClient.prototype.initializeAuthorizationRequest=function(t,o){return __awaiter$3(this,void 0,void 0,(function(){var s,l,h,v,m,_,R;return __generator$1(this,(function($){switch($.label){case 0:return this.performanceClient.addQueueMeasurement(vq.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId),this.logger.verbose("initializeAuthorizationRequest called",this.correlationId),s=this.getRedirectUri(t.redirectUri),l={interactionType:o},h=Rq.setRequestState(this.browserCrypto,t&&t.state||JU.EMPTY_STRING,l),this.performanceClient.setPreQueueTime(vq.InitializeBaseRequest,this.correlationId),m=[{}],[4,this.initializeBaseRequest(t)];case 1:return v=__assign$1.apply(void 0,[__assign$1.apply(void 0,m.concat([$.sent()])),{redirectUri:s,state:h,nonce:t.nonce||this.browserCrypto.createNewGuid(),responseMode:rH.FRAGMENT}]),(_=t.account||this.browserStorage.getActiveAccount())&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii("Setting validated request account: "+_.homeAccountId,this.correlationId),v.account=_),TB.isEmpty(v.loginHint)&&!_&&(R=this.browserStorage.getLegacyLoginHint())&&(v.loginHint=R),[2,v]}}))}))},StandardInteractionClient}(Zz),tV=function(){function InteractionHandler(t,o,s,l,h){this.authModule=t,this.browserStorage=o,this.authCodeRequest=s,this.logger=l,this.performanceClient=h}return InteractionHandler.prototype.handleCodeResponseFromHash=function(t,o,s,l){return __awaiter$3(this,void 0,void 0,(function(){var h,v,m;return __generator$1(this,(function(_){if(this.performanceClient.addQueueMeasurement(vq.HandleCodeResponseFromHash,this.authCodeRequest.correlationId),this.logger.verbose("InteractionHandler.handleCodeResponse called"),TB.isEmpty(t))throw Cz.createEmptyHashError(t);if(h=this.browserStorage.generateStateKey(o),!(v=this.browserStorage.getTemporaryCache(h)))throw kB.createStateNotFoundError("Cached State");try{m=this.authModule.handleFragmentResponse(t,v)}catch(t){throw t instanceof pq&&t.subError===jj.code?Cz.createUserCancelledError():t}return this.performanceClient.setPreQueueTime(vq.HandleCodeResponseFromServer,this.authCodeRequest.correlationId),[2,this.handleCodeResponseFromServer(m,o,s,l)]}))}))},InteractionHandler.prototype.handleCodeResponseFromServer=function(t,o,s,l,h){return void 0===h&&(h=!0),__awaiter$3(this,void 0,void 0,(function(){var v,m,_,R,$,B;return __generator$1(this,(function(q){switch(q.label){case 0:if(this.performanceClient.addQueueMeasurement(vq.HandleCodeResponseFromServer,this.authCodeRequest.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),v=this.browserStorage.generateStateKey(o),!(m=this.browserStorage.getTemporaryCache(v)))throw kB.createStateNotFoundError("Cached State");return _=this.browserStorage.generateNonceKey(m),R=this.browserStorage.getTemporaryCache(_),this.authCodeRequest.code=t.code,t.cloud_instance_host_name?(this.performanceClient.setPreQueueTime(vq.UpdateTokenEndpointAuthority,this.authCodeRequest.correlationId),[4,this.updateTokenEndpointAuthority(t.cloud_instance_host_name,s,l)]):[3,2];case 1:q.sent(),q.label=2;case 2:return h&&(t.nonce=R||void 0),t.state=m,t.client_info?this.authCodeRequest.clientInfo=t.client_info:($=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=$),this.performanceClient.setPreQueueTime(vq.AuthClientAcquireToken,this.authCodeRequest.correlationId),[4,this.authModule.acquireToken(this.authCodeRequest,t)];case 3:return B=q.sent(),this.browserStorage.cleanRequestByState(o),[2,B]}}))}))},InteractionHandler.prototype.updateTokenEndpointAuthority=function(t,o,s){return __awaiter$3(this,void 0,void 0,(function(){var l,h;return __generator$1(this,(function(v){switch(v.label){case 0:return this.performanceClient.addQueueMeasurement(vq.UpdateTokenEndpointAuthority,this.authCodeRequest.correlationId),l="https://"+t+"/"+o.tenant+"/",[4,sj.createDiscoveredInstance(l,s,this.browserStorage,o.options,this.logger,this.performanceClient,this.authCodeRequest.correlationId)];case 1:return h=v.sent(),this.authModule.updateAuthority(h),[2]}}))}))},InteractionHandler.prototype.checkCcsCredentials=function(){var t=this.browserStorage.getTemporaryCache(Qq.CCS_CREDENTIAL,!0);if(t)try{return JSON.parse(t)}catch(o){this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii("Cache credential could not be parsed: "+t)}return null},InteractionHandler}(),rV=function(t){function RedirectHandler(o,s,l,h,v,m){var _=t.call(this,o,s,l,h,m)||this;return _.browserCrypto=v,_}return __extends$1(RedirectHandler,t),RedirectHandler.prototype.initiateAuthRequest=function(t,o){return __awaiter$3(this,void 0,void 0,(function(){var s;return __generator$1(this,(function(l){switch(l.label){case 0:return this.logger.verbose("RedirectHandler.initiateAuthRequest called"),TB.isEmpty(t)?[3,7]:(o.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(Qq.ORIGIN_URI,o.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(Qq.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest,this.browserCrypto),this.logger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: "+t),s={apiId:Jq.acquireTokenRedirect,timeout:o.redirectTimeout,noHistory:!1},"function"!=typeof o.onRedirectNavigate?[3,4]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1===o.onRedirectNavigate(t)?[3,2]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),[4,o.navigationClient.navigateExternal(t,s)])));case 1:case 5:return l.sent(),[2];case 2:return this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation"),[2];case 3:return[3,6];case 4:return this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),[4,o.navigationClient.navigateExternal(t,s)];case 6:return[3,8];case 7:throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),Cz.createEmptyNavigationUriError();case 8:return[2]}}))}))},RedirectHandler.prototype.handleCodeResponseFromHash=function(t,o,s,l){return __awaiter$3(this,void 0,void 0,(function(){var h,v,m,_,R,$,B;return __generator$1(this,(function(q){switch(q.label){case 0:if(this.logger.verbose("RedirectHandler.handleCodeResponse called"),TB.isEmpty(t))throw Cz.createEmptyHashError(t);if(this.browserStorage.setInteractionInProgress(!1),h=this.browserStorage.generateStateKey(o),!(v=this.browserStorage.getTemporaryCache(h)))throw kB.createStateNotFoundError("Cached State");try{m=this.authModule.handleFragmentResponse(t,v)}catch(t){throw t instanceof pq&&t.subError===jj.code?Cz.createUserCancelledError():t}return _=this.browserStorage.generateNonceKey(v),R=this.browserStorage.getTemporaryCache(_),this.authCodeRequest.code=m.code,m.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(m.cloud_instance_host_name,s,l)]:[3,2];case 1:q.sent(),q.label=2;case 2:return m.nonce=R||void 0,m.state=v,m.client_info?this.authCodeRequest.clientInfo=m.client_info:($=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=$),[4,this.authModule.acquireToken(this.authCodeRequest,m)];case 3:return B=q.sent(),this.browserStorage.cleanRequestByState(o),[2,B]}}))}))},RedirectHandler}(tV);!function(t){t.INITIALIZE_START="msal:initializeStart",t.INITIALIZE_END="msal:initializeEnd",t.ACCOUNT_ADDED="msal:accountAdded",t.ACCOUNT_REMOVED="msal:accountRemoved",t.LOGIN_START="msal:loginStart",t.LOGIN_SUCCESS="msal:loginSuccess",t.LOGIN_FAILURE="msal:loginFailure",t.ACQUIRE_TOKEN_START="msal:acquireTokenStart",t.ACQUIRE_TOKEN_SUCCESS="msal:acquireTokenSuccess",t.ACQUIRE_TOKEN_FAILURE="msal:acquireTokenFailure",t.ACQUIRE_TOKEN_NETWORK_START="msal:acquireTokenFromNetworkStart",t.SSO_SILENT_START="msal:ssoSilentStart",t.SSO_SILENT_SUCCESS="msal:ssoSilentSuccess",t.SSO_SILENT_FAILURE="msal:ssoSilentFailure",t.ACQUIRE_TOKEN_BY_CODE_START="msal:acquireTokenByCodeStart",t.ACQUIRE_TOKEN_BY_CODE_SUCCESS="msal:acquireTokenByCodeSuccess",t.ACQUIRE_TOKEN_BY_CODE_FAILURE="msal:acquireTokenByCodeFailure",t.HANDLE_REDIRECT_START="msal:handleRedirectStart",t.HANDLE_REDIRECT_END="msal:handleRedirectEnd",t.POPUP_OPENED="msal:popupOpened",t.LOGOUT_START="msal:logoutStart",t.LOGOUT_SUCCESS="msal:logoutSuccess",t.LOGOUT_FAILURE="msal:logoutFailure",t.LOGOUT_END="msal:logoutEnd"}(Nz||(Nz={})),function(t){t.USER_INTERACTION_REQUIRED="USER_INTERACTION_REQUIRED",t.USER_CANCEL="USER_CANCEL",t.NO_NETWORK="NO_NETWORK",t.TRANSIENT_ERROR="TRANSIENT_ERROR",t.PERSISTENT_ERROR="PERSISTENT_ERROR",t.DISABLED="DISABLED",t.ACCOUNT_UNAVAILABLE="ACCOUNT_UNAVAILABLE"}(Mz||(Mz={}));var oV={code:"ContentError"},nV={code:"user_switch",desc:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."},iV={code:"tokens_not_found_in_internal_memory_cache",desc:"Tokens not cached in MSAL JS internal memory, please make the WAM request"},sV=function(t){function NativeAuthError(o,s,l){var h=t.call(this,o,s)||this;return Object.setPrototypeOf(h,NativeAuthError.prototype),h.name="NativeAuthError",h.ext=l,h}return __extends$1(NativeAuthError,t),NativeAuthError.prototype.isFatal=function(){return!(!this.ext||!this.ext.status||this.ext.status!==Mz.PERSISTENT_ERROR&&this.ext.status!==Mz.DISABLED)||this.errorCode===oV.code},NativeAuthError.createError=function(t,o,s){if(s&&s.status)switch(s.status){case Mz.ACCOUNT_UNAVAILABLE:return Aq.createNativeAccountUnavailableError();case Mz.USER_INTERACTION_REQUIRED:return new Aq(t,o);case Mz.USER_CANCEL:return Cz.createUserCancelledError();case Mz.NO_NETWORK:return Cz.createNoNetworkConnectivityError()}return new NativeAuthError(t,o,s)},NativeAuthError.createUserSwitchError=function(){return new NativeAuthError(nV.code,nV.desc)},NativeAuthError.createTokensNotFoundInCacheError=function(){return new NativeAuthError(iV.code,iV.desc)},NativeAuthError}(RH),aV=function(t){function SilentCacheClient(){return null!==t&&t.apply(this,arguments)||this}return __extends$1(SilentCacheClient,t),SilentCacheClient.prototype.acquireToken=function(t){return __awaiter$3(this,void 0,void 0,(function(){var o,s,l,h,v;return __generator$1(this,(function(m){switch(m.label){case 0:return o=this.performanceClient.startMeasurement(vq.SilentCacheClientAcquireToken,t.correlationId),s=this.initializeServerTelemetryManager(Jq.acquireTokenSilent_silentFlow),[4,this.createSilentFlowClient(s,t.authority,t.azureCloudOptions)];case 1:l=m.sent(),this.logger.verbose("Silent auth client created"),m.label=2;case 2:return m.trys.push([2,4,,5]),[4,l.acquireCachedToken(t)];case 3:return h=m.sent(),o.endMeasurement({success:!0,fromCache:!0}),[2,h];case 4:throw(v=m.sent())instanceof Cz&&v.errorCode===hz.code&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),o.endMeasurement({errorCode:v instanceof RH&&v.errorCode||void 0,subErrorCode:v instanceof RH&&v.subError||void 0,success:!1}),v;case 5:return[2]}}))}))},SilentCacheClient.prototype.logout=function(){return Promise.reject(Cz.createSilentLogoutUnsupportedError())},SilentCacheClient.prototype.createSilentFlowClient=function(t,o,s){return __awaiter$3(this,void 0,void 0,(function(){var l;return __generator$1(this,(function(h){switch(h.label){case 0:return this.performanceClient.setPreQueueTime(vq.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(t,o,s)];case 1:return l=h.sent(),[2,new Bq(l,this.performanceClient)]}}))}))},SilentCacheClient.prototype.initializeSilentRequest=function(t,o){return __awaiter$3(this,void 0,void 0,(function(){var s;return __generator$1(this,(function(l){switch(l.label){case 0:return this.performanceClient.addQueueMeasurement(vq.InitializeSilentRequest,this.correlationId),this.performanceClient.setPreQueueTime(vq.InitializeBaseRequest,this.correlationId),s=[__assign$1({},t)],[4,this.initializeBaseRequest(t)];case 1:return[2,__assign$1.apply(void 0,[__assign$1.apply(void 0,s.concat([l.sent()])),{account:o,forceRefresh:t.forceRefresh||!1}])]}}))}))},SilentCacheClient}(eV),lV=function(t){function NativeInteractionClient(o,s,l,h,v,m,_,R,$,B,q,j){var z=t.call(this,o,s,l,h,v,m,R,$,j)||this;return z.apiId=_,z.accountId=B,z.nativeMessageHandler=$,z.nativeStorageManager=q,z.silentCacheClient=new aV(o,z.nativeStorageManager,l,h,v,m,R,$,j),z}return __extends$1(NativeInteractionClient,t),NativeInteractionClient.prototype.acquireToken=function(t){return __awaiter$3(this,void 0,void 0,(function(){var o,s,l,h,v,m,_;return __generator$1(this,(function(R){switch(R.label){case 0:return this.logger.trace("NativeInteractionClient - acquireToken called."),o=this.performanceClient.startMeasurement(vq.NativeInteractionClientAcquireToken,t.correlationId),s=Cq.nowSeconds(),[4,this.initializeNativeRequest(t)];case 1:l=R.sent(),R.label=2;case 2:return R.trys.push([2,4,,5]),[4,this.acquireTokensFromCache(this.accountId,l)];case 3:return h=R.sent(),o.endMeasurement({success:!0,isNativeBroker:!1,fromCache:!0}),[2,h];case 4:return R.sent(),this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call"),[3,5];case 5:return v={method:Gq.GetToken,request:l},[4,this.nativeMessageHandler.sendMessage(v)];case 6:return m=R.sent(),_=this.validateNativeResponse(m),[2,this.handleNativeResponse(_,l,s).then((function(t){return o.endMeasurement({success:!0,isNativeBroker:!0,requestId:t.requestId}),t})).catch((function(t){throw o.endMeasurement({success:!1,errorCode:t.errorCode,subErrorCode:t.subError,isNativeBroker:!0}),t}))]}}))}))},NativeInteractionClient.prototype.createSilentCacheRequest=function(t,o){return{authority:t.authority,correlationId:this.correlationId,scopes:eq.fromString(t.scope).asArray(),account:o,forceRefresh:!1}},NativeInteractionClient.prototype.acquireTokensFromCache=function(t,o){return __awaiter$3(this,void 0,void 0,(function(){var s,l,h;return __generator$1(this,(function(v){switch(v.label){case 0:if(!(s=this.browserStorage.readAccountFromCacheWithNativeAccountId(t)))throw kB.createNoAccountFoundError();l=s.getAccountInfo(),v.label=1;case 1:return v.trys.push([1,3,,4]),h=this.createSilentCacheRequest(o,l),[4,this.silentCacheClient.acquireToken(h)];case 2:return[2,v.sent()];case 3:throw v.sent();case 4:return[2]}}))}))},NativeInteractionClient.prototype.acquireTokenRedirect=function(t){return __awaiter$3(this,void 0,void 0,(function(){var o,s,l,h,v,m;return __generator$1(this,(function(_){switch(_.label){case 0:return this.logger.trace("NativeInteractionClient - acquireTokenRedirect called."),[4,this.initializeNativeRequest(t)];case 1:o=_.sent(),s={method:Gq.GetToken,request:o},_.label=2;case 2:return _.trys.push([2,4,,5]),[4,this.nativeMessageHandler.sendMessage(s)];case 3:return l=_.sent(),this.validateNativeResponse(l),[3,5];case 4:if((h=_.sent())instanceof sV&&h.isFatal())throw h;return[3,5];case 5:return this.browserStorage.setTemporaryCache(Qq.NATIVE_REQUEST,JSON.stringify(o),!0),v={apiId:Jq.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},m=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(t.redirectUri),[4,this.navigationClient.navigateExternal(m,v)];case 6:return _.sent(),[2]}}))}))},NativeInteractionClient.prototype.handleRedirectPromise=function(){return __awaiter$3(this,void 0,void 0,(function(){var t,o,s,l,h,v,m,_;return __generator$1(this,(function(R){switch(R.label){case 0:if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(t=this.browserStorage.getCachedNativeRequest()))return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),[2,null];o=t.prompt,s=__rest(t,["prompt"]),o&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Qq.NATIVE_REQUEST)),l={method:Gq.GetToken,request:s},h=Cq.nowSeconds(),R.label=1;case 1:return R.trys.push([1,3,,4]),this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker."),[4,this.nativeMessageHandler.sendMessage(l)];case 2:return v=R.sent(),this.validateNativeResponse(v),m=this.handleNativeResponse(v,s,h),this.browserStorage.setInteractionInProgress(!1),[2,m];case 3:throw _=R.sent(),this.browserStorage.setInteractionInProgress(!1),_;case 4:return[2]}}))}))},NativeInteractionClient.prototype.logout=function(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")},NativeInteractionClient.prototype.handleNativeResponse=function(t,o,s){return __awaiter$3(this,void 0,void 0,(function(){var l,h,v,m,_,R,$,B,q,j,z,K,W,Z,te,ne,ie,se,he,me=this;return __generator$1(this,(function(_e){switch(_e.label){case 0:if(this.logger.trace("NativeInteractionClient - handleNativeResponse called."),l=this.getMATSFromResponse(t),this.performanceClient.addStaticFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:l?l.broker_version:void 0,matsAccountJoinOnStart:l?l.account_join_on_start:void 0,matsAccountJoinOnEnd:l?l.account_join_on_end:void 0,matsDeviceJoin:l?l.device_join:void 0,matsPromptBehavior:l?l.prompt_behavior:void 0,matsApiErrorCode:l?l.api_error_code:void 0,matsUiVisible:l?l.ui_visible:void 0,matsSilentCode:l?l.silent_code:void 0,matsSilentBiSubCode:l?l.silent_bi_sub_code:void 0,matsSilentMessage:l?l.silent_message:void 0,matsSilentStatus:l?l.silent_status:void 0,matsHttpStatus:l?l.http_status:void 0,matsHttpEventCount:l?l.http_event_count:void 0},this.correlationId),t.account.id!==o.accountId)throw sV.createUserSwitchError();return h=new rq(t.id_token||JU.EMPTY_STRING,this.browserCrypto),[4,this.getDiscoveredAuthority(o.authority)];case 1:return v=_e.sent(),m=v.getPreferredCache(),_=tq.generateHomeAccountId(t.client_info||JU.EMPTY_STRING,PB.Default,this.logger,this.browserCrypto,h),R=tq.createAccount(t.client_info,_,h,void 0,void 0,void 0,m,t.account.id),this.browserStorage.setAccount(R),$=t.scope?eq.fromString(t.scope):eq.fromString(o.scope),B=t.account.properties||{},q=B.UID||h.claims.oid||h.claims.sub||JU.EMPTY_STRING,j=B.TenantId||h.claims.tid||JU.EMPTY_STRING,K=fH.BEARER,o.tokenType===fH.POP?[3,2]:[3,4];case 2:if(K=fH.POP,t.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),z=t.shr,[3,5];if(W=new Mq(this.browserCrypto),Z={resourceRequestMethod:o.resourceRequestMethod,resourceRequestUri:o.resourceRequestUri,shrClaims:o.shrClaims,shrNonce:o.shrNonce},!o.keyId)throw kB.createKeyIdMissingError();return[4,W.signPopToken(t.access_token,o.keyId,Z)];case 3:return z=_e.sent(),[3,5];case 4:z=t.access_token,_e.label=5;case 5:return te={authority:v.canonicalAuthority,uniqueId:q,tenantId:j,scopes:$.asArray(),account:R.getAccountInfo(),idToken:t.id_token,idTokenClaims:h.claims,accessToken:z,fromCache:!!l&&this.isResponseFromCache(l),expiresOn:new Date(1e3*Number(s+t.expires_in)),tokenType:K,correlationId:this.correlationId,state:t.state,fromNativeBroker:!0},ne=_q.createIdTokenEntity(_,o.authority,t.id_token||JU.EMPTY_STRING,o.clientId,h.claims.tid||JU.EMPTY_STRING),this.nativeStorageManager.setIdTokenCredential(ne),ie=K===fH.POP?JU.SHR_NONCE_VALIDITY:("string"==typeof t.expires_in?parseInt(t.expires_in,10):t.expires_in)||0,se=s+ie,he=kq.createAccessTokenEntity(_,o.authority,z,o.clientId,j,$.printScopes(),se,0,this.browserCrypto),this.nativeStorageManager.setAccessTokenCredential(he),this.browserStorage.removeAccountContext(R).catch((function(t){me.logger.error("Error occurred while removing account context from browser storage. "+t)})),[2,te]}}))}))},NativeInteractionClient.prototype.validateNativeResponse=function(t){if(t.hasOwnProperty("access_token")&&t.hasOwnProperty("id_token")&&t.hasOwnProperty("client_info")&&t.hasOwnProperty("account")&&t.hasOwnProperty("scope")&&t.hasOwnProperty("expires_in"))return t;throw sV.createUnexpectedError("Response missing expected properties.")},NativeInteractionClient.prototype.getMATSFromResponse=function(t){if(t.properties.MATS)try{return JSON.parse(t.properties.MATS)}catch(t){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null},NativeInteractionClient.prototype.isResponseFromCache=function(t){return void 0===t.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!t.is_cached},NativeInteractionClient.prototype.initializeNativeRequest=function(t){return __awaiter$3(this,void 0,void 0,(function(){var o,s,l,h,v,m,_,R,$,B=this;return __generator$1(this,(function(q){switch(q.label){case 0:return this.logger.trace("NativeInteractionClient - initializeNativeRequest called"),o=t.authority||this.config.auth.authority,(s=new Oq(o)).validateAsUri(),l=t.scopes,h=__rest(t,["scopes"]),(v=new eq(l||[])).appendScopes(XU),m=function(){switch(B.apiId){case Jq.ssoSilent:case Jq.acquireTokenSilent_silentFlow:return B.logger.trace("initializeNativeRequest: silent request sets prompt to none"),tH.NONE}if(t.prompt)switch(t.prompt){case tH.NONE:case tH.CONSENT:case tH.LOGIN:return B.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),t.prompt;default:throw B.logger.trace("initializeNativeRequest: prompt = "+t.prompt+" is not compatible with native flow"),Cz.createNativePromptParameterNotSupportedError()}else B.logger.trace("initializeNativeRequest: prompt was not provided")},_=__assign$1(__assign$1({},h),{accountId:this.accountId,clientId:this.config.auth.clientId,authority:s.urlString,scope:v.printScopes(),redirectUri:this.getRedirectUri(t.redirectUri),prompt:m(),correlationId:this.correlationId,tokenType:t.authenticationScheme,windowTitleSubstring:document.title,extraParameters:__assign$1(__assign$1(__assign$1({},t.extraQueryParameters),t.tokenQueryParameters),{telemetry:xz}),extendedExpiryToken:!1}),t.authenticationScheme!==fH.POP?[3,2]:(R={resourceRequestUri:t.resourceRequestUri,resourceRequestMethod:t.resourceRequestMethod,shrClaims:t.shrClaims,shrNonce:t.shrNonce},[4,new Mq(this.browserCrypto).generateCnf(R)]);case 1:$=q.sent(),_.reqCnf=$.reqCnfHash,_.keyId=$.kid,q.label=2;case 2:return[2,_]}}))}))},NativeInteractionClient}(Zz),cV=function(){function NativeMessageHandler(t,o,s){this.logger=t,this.handshakeTimeoutMs=o,this.extensionId=s,this.resolvers=new Map,this.handshakeResolvers=new Map,this.responseId=0,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this)}return NativeMessageHandler.prototype.sendMessage=function(t){return __awaiter$3(this,void 0,void 0,(function(){var o,s=this;return __generator$1(this,(function(l){return this.logger.trace("NativeMessageHandler - sendMessage called."),o={channel:Tz,extensionId:this.extensionId,responseId:this.responseId++,body:t},this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii("NativeMessageHandler - Sending request to browser extension: "+JSON.stringify(o)),this.messageChannel.port1.postMessage(o),[2,new Promise((function(t,l){s.resolvers.set(o.responseId,{resolve:t,reject:l})}))]}))}))},NativeMessageHandler.createProvider=function(t,o){return __awaiter$3(this,void 0,void 0,(function(){var s,l;return __generator$1(this,(function(h){switch(h.label){case 0:t.trace("NativeMessageHandler - createProvider called."),h.label=1;case 1:return h.trys.push([1,3,,5]),[4,(s=new NativeMessageHandler(t,o,Sz)).sendHandshakeRequest()];case 2:return h.sent(),[2,s];case 3:return h.sent(),[4,(l=new NativeMessageHandler(t,o)).sendHandshakeRequest()];case 4:return h.sent(),[2,l];case 5:return[2]}}))}))},NativeMessageHandler.prototype.sendHandshakeRequest=function(){return __awaiter$3(this,void 0,void 0,(function(){var t,o=this;return __generator$1(this,(function(s){return this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1),t={channel:Tz,extensionId:this.extensionId,responseId:this.responseId++,body:{method:Gq.HandshakeRequest}},this.messageChannel.port1.onmessage=function(t){o.onChannelMessage(t)},window.postMessage(t,window.origin,[this.messageChannel.port2]),[2,new Promise((function(s,l){o.handshakeResolvers.set(t.responseId,{resolve:s,reject:l}),o.timeoutId=window.setTimeout((function(){window.removeEventListener("message",o.windowListener,!1),o.messageChannel.port1.close(),o.messageChannel.port2.close(),l(Cz.createNativeHandshakeTimeoutError()),o.handshakeResolvers.delete(t.responseId)}),o.handshakeTimeoutMs)}))]}))}))},NativeMessageHandler.prototype.onWindowMessage=function(t){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),t.source===window){var o=t.data;if(o.channel&&o.channel===Tz&&(!o.extensionId||o.extensionId===this.extensionId)&&o.body.method===Gq.HandshakeRequest){this.logger.verbose(o.extensionId?"Extension with id: "+o.extensionId+" not installed":"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1);var s=this.handshakeResolvers.get(o.responseId);s&&s.reject(Cz.createNativeExtensionNotInstalledError())}}},NativeMessageHandler.prototype.onChannelMessage=function(t){this.logger.trace("NativeMessageHandler - onChannelMessage called.");var o=t.data,s=this.resolvers.get(o.responseId),l=this.handshakeResolvers.get(o.responseId);try{var h=o.body.method;if(h===Gq.Response){if(!s)return;var v=o.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii("NativeMessageHandler - Received response from browser extension: "+JSON.stringify(v)),"Success"!==v.status)s.reject(sV.createError(v.code,v.description,v.ext));else{if(!v.result)throw RH.createUnexpectedError("Event does not contain result.");v.result.code&&v.result.description?s.reject(sV.createError(v.result.code,v.result.description,v.result.ext)):s.resolve(v.result)}this.resolvers.delete(o.responseId)}else if(h===Gq.HandshakeResponse){if(!l)return;clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=o.extensionId,this.extensionVersion=o.body.version,this.logger.verbose("NativeMessageHandler - Received HandshakeResponse from extension: "+this.extensionId),l.resolve(),this.handshakeResolvers.delete(o.responseId)}}catch(o){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii("Error parsing response from WAM Extension: "+o.toString()),this.logger.errorPii("Unable to parse "+t),s?s.reject(o):l&&l.reject(o)}},NativeMessageHandler.prototype.getExtensionId=function(){return this.extensionId},NativeMessageHandler.prototype.getExtensionVersion=function(){return this.extensionVersion},NativeMessageHandler.isNativeAvailable=function(t,o,s,l){if(o.trace("isNativeAvailable called"),!t.system.allowNativeBroker)return o.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!s)return o.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(l)switch(l){case fH.BEARER:case fH.POP:return o.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return o.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0},NativeMessageHandler}(),dV=function(t){function RedirectClient(o,s,l,h,v,m,_,R,$,B){var q=t.call(this,o,s,l,h,v,m,_,$,B)||this;return q.nativeStorage=R,q}return __extends$1(RedirectClient,t),RedirectClient.prototype.acquireToken=function(t){return __awaiter$3(this,void 0,void 0,(function(){var o,s,l,h,v,m,_,R,$,B=this;return __generator$1(this,(function(q){switch(q.label){case 0:return this.performanceClient.setPreQueueTime(vq.StandardInteractionClientInitializeAuthorizationRequest,t.correlationId),[4,this.initializeAuthorizationRequest(t,Xq.Redirect)];case 1:o=q.sent(),this.browserStorage.updateCacheEntries(o.state,o.nonce,o.authority,o.loginHint||JU.EMPTY_STRING,o.account||null),s=this.initializeServerTelemetryManager(Jq.acquireTokenRedirect),l=function(t){t.persisted&&(B.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),B.browserStorage.cleanRequestByState(o.state))},q.label=2;case 2:return q.trys.push([2,7,,8]),this.performanceClient.setPreQueueTime(vq.StandardInteractionClientInitializeAuthorizationCodeRequest,t.correlationId),[4,this.initializeAuthorizationCodeRequest(o)];case 3:return h=q.sent(),this.performanceClient.setPreQueueTime(vq.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(s,o.authority,o.azureCloudOptions)];case 4:return v=q.sent(),this.logger.verbose("Auth code client created"),m=new rV(v,this.browserStorage,h,this.logger,this.browserCrypto,this.performanceClient),[4,v.getAuthCodeUrl(__assign$1(__assign$1({},o),{nativeBroker:cV.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)}))];case 5:return _=q.sent(),R=this.getRedirectStartPage(t.redirectStartPage),this.logger.verbosePii("Redirect start page: "+R),window.addEventListener("pageshow",l),[4,m.initiateAuthRequest(_,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:R,onRedirectNavigate:t.onRedirectNavigate})];case 6:return[2,q.sent()];case 7:throw($=q.sent())instanceof RH&&$.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",l),s.cacheFailedRequest($),this.browserStorage.cleanRequestByState(o.state),$;case 8:return[2]}}))}))},RedirectClient.prototype.handleRedirectPromise=function(t){return __awaiter$3(this,void 0,void 0,(function(){var o,s,l,h,v,m,_,R,$,B,q,j;return __generator$1(this,(function(z){switch(z.label){case 0:o=this.initializeServerTelemetryManager(Jq.handleRedirectPromise),z.label=1;case 1:if(z.trys.push([1,10,,11]),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(s=this.getRedirectResponseHash(t||window.location.hash)))return this.logger.info("handleRedirectPromise did not detect a response hash as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(Xq.Redirect),[2,null];l=void 0;try{h=Oq.getDeserializedHash(s),l=this.validateAndExtractStateFromHash(h,Xq.Redirect),this.logger.verbose("State extracted from hash")}catch(t){return this.logger.info("handleRedirectPromise was unable to extract state due to: "+t),this.browserStorage.cleanRequestByInteractionType(Xq.Redirect),[2,null]}return v=this.browserStorage.getTemporaryCache(Qq.ORIGIN_URI,!0)||JU.EMPTY_STRING,m=Oq.removeHashFromUrl(v),_=Oq.removeHashFromUrl(window.location.href),m===_&&this.config.auth.navigateToLoginRequestUrl?(this.logger.verbose("Current page is loginRequestUrl, handling hash"),[4,this.handleHash(s,l,o)]):[3,3];case 2:return R=z.sent(),v.indexOf("#")>-1&&Xz.replaceHash(v),[2,R];case 3:return this.config.auth.navigateToLoginRequestUrl?[3,4]:(this.logger.verbose("NavigateToLoginRequestUrl set to false, handling hash"),[2,this.handleHash(s,l,o)]);case 4:return Xz.isInIframe()&&!this.config.system.allowRedirectInIframe?[3,9]:(this.browserStorage.setTemporaryCache(Qq.URL_HASH,s,!0),$={apiId:Jq.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},B=!0,v&&"null"!==v?[3,6]:(q=Xz.getHomepage(),this.browserStorage.setTemporaryCache(Qq.ORIGIN_URI,q,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),[4,this.navigationClient.navigateInternal(q,$)]));case 5:return B=z.sent(),[3,8];case 6:return this.logger.verbose("Navigating to loginRequestUrl: "+v),[4,this.navigationClient.navigateInternal(v,$)];case 7:B=z.sent(),z.label=8;case 8:if(!B)return[2,this.handleHash(s,l,o)];z.label=9;case 9:return[2,null];case 10:throw(j=z.sent())instanceof RH&&j.setCorrelationId(this.correlationId),o.cacheFailedRequest(j),this.browserStorage.cleanRequestByInteractionType(Xq.Redirect),j;case 11:return[2]}}))}))},RedirectClient.prototype.getRedirectResponseHash=function(t){if(this.logger.verbose("getRedirectResponseHash called"),Oq.hashContainsKnownProperties(t))return Xz.clearHash(window),this.logger.verbose("Hash contains known properties, returning response hash"),t;var o=this.browserStorage.getTemporaryCache(Qq.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Qq.URL_HASH)),this.logger.verbose("Hash does not contain known properties, returning cached hash"),o},RedirectClient.prototype.handleHash=function(t,o,s){return __awaiter$3(this,void 0,void 0,(function(){var l,h,v,m,_,R,$=this;return __generator$1(this,(function(B){switch(B.label){case 0:if(l=this.browserStorage.getCachedRequest(o,this.browserCrypto),this.logger.verbose("handleHash called, retrieved cached request"),(h=Oq.getDeserializedHash(t)).accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw Cz.createNativeConnectionNotEstablishedError();return v=new lV(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Jq.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,h.accountId,this.browserStorage,l.correlationId),m=Rq.parseRequestState(this.browserCrypto,o).userRequestState,[2,v.acquireToken(__assign$1(__assign$1({},l),{state:m,prompt:void 0})).finally((function(){$.browserStorage.cleanRequestByState(o)}))]}if(!(_=this.browserStorage.getCachedAuthority(o)))throw Cz.createNoCachedAuthorityError();return this.performanceClient.setPreQueueTime(vq.StandardInteractionClientCreateAuthCodeClient,l.correlationId),[4,this.createAuthCodeClient(s,_)];case 1:return R=B.sent(),this.logger.verbose("Auth code client created"),fq.removeThrottle(this.browserStorage,this.config.auth.clientId,l),[4,new rV(R,this.browserStorage,l,this.logger,this.browserCrypto,this.performanceClient).handleCodeResponseFromHash(t,o,R.authority,this.networkClient)];case 2:return[2,B.sent()]}}))}))},RedirectClient.prototype.logout=function(t){return __awaiter$3(this,void 0,void 0,(function(){var o,s,l,h,v,m;return __generator$1(this,(function(_){switch(_.label){case 0:this.logger.verbose("logoutRedirect called"),o=this.initializeLogoutRequest(t),s=this.initializeServerTelemetryManager(Jq.logout),_.label=1;case 1:return _.trys.push([1,10,,11]),this.eventHandler.emitEvent(Nz.LOGOUT_START,Xq.Redirect,t),[4,this.clearCacheOnLogout(o.account)];case 2:return _.sent(),l={apiId:Jq.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},this.performanceClient.setPreQueueTime(vq.StandardInteractionClientCreateAuthCodeClient,o.correlationId),[4,this.createAuthCodeClient(s,t&&t.authority)];case 3:return h=_.sent(),this.logger.verbose("Auth code client created"),v=h.getLogoutUri(o),this.eventHandler.emitEvent(Nz.LOGOUT_SUCCESS,Xq.Redirect,o),t&&"function"==typeof t.onRedirectNavigate?!1===t.onRedirectNavigate(v)?[3,5]:(this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(v,l)]):[3,7];case 4:return _.sent(),[2];case 5:this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation"),_.label=6;case 6:return[3,9];case 7:return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(v,l)];case 8:return _.sent(),[2];case 9:return[3,11];case 10:throw(m=_.sent())instanceof RH&&m.setCorrelationId(this.correlationId),s.cacheFailedRequest(m),this.eventHandler.emitEvent(Nz.LOGOUT_FAILURE,Xq.Redirect,null,m),this.eventHandler.emitEvent(Nz.LOGOUT_END,Xq.Redirect),m;case 11:return this.eventHandler.emitEvent(Nz.LOGOUT_END,Xq.Redirect),[2]}}))}))},RedirectClient.prototype.getRedirectStartPage=function(t){var o=t||window.location.href;return Oq.getAbsoluteUrl(o,Xz.getCurrentUri())},RedirectClient}(eV),uV=function(t){function PopupClient(o,s,l,h,v,m,_,R,$,B){var q=t.call(this,o,s,l,h,v,m,_,$,B)||this;return q.unloadWindow=q.unloadWindow.bind(q),q.nativeStorage=R,q}return __extends$1(PopupClient,t),PopupClient.prototype.acquireToken=function(t){try{var o=this.generatePopupName(t.scopes||XU,t.authority||this.config.auth.authority),s=t.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(t,o,s);this.logger.verbose("asyncPopup set to false, opening popup before acquiring token");var l=this.openSizedPopup("about:blank",o,s);return this.acquireTokenPopupAsync(t,o,s,l)}catch(t){return Promise.reject(t)}},PopupClient.prototype.logout=function(t){try{this.logger.verbose("logoutPopup called");var o=this.initializeLogoutRequest(t),s=this.generateLogoutPopupName(o),l=t&&t.authority,h=t&&t.mainWindowRedirectUri,v=(null==t?void 0:t.popupWindowAttributes)||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(o,s,v,l,void 0,h);this.logger.verbose("asyncPopup set to false, opening popup");var m=this.openSizedPopup("about:blank",s,v);return this.logoutPopupAsync(o,s,v,l,m,h)}catch(t){return Promise.reject(t)}},PopupClient.prototype.acquireTokenPopupAsync=function(t,o,s,l){return __awaiter$3(this,void 0,void 0,(function(){var h,v,m,_,R,$,B,q,j,z,K,W,Z,te,ne,ie,se=this;return __generator$1(this,(function(he){switch(he.label){case 0:return this.logger.verbose("acquireTokenPopupAsync called"),h=this.initializeServerTelemetryManager(Jq.acquireTokenPopup),this.performanceClient.setPreQueueTime(vq.StandardInteractionClientInitializeAuthorizationRequest,t.correlationId),[4,this.initializeAuthorizationRequest(t,Xq.Popup)];case 1:v=he.sent(),this.browserStorage.updateCacheEntries(v.state,v.nonce,v.authority,v.loginHint||JU.EMPTY_STRING,v.account||null),he.label=2;case 2:return he.trys.push([2,8,,9]),this.performanceClient.setPreQueueTime(vq.StandardInteractionClientInitializeAuthorizationCodeRequest,t.correlationId),[4,this.initializeAuthorizationCodeRequest(v)];case 3:return m=he.sent(),this.performanceClient.setPreQueueTime(vq.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(h,v.authority,v.azureCloudOptions)];case 4:return _=he.sent(),this.logger.verbose("Auth code client created"),R=cV.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme),$=void 0,R&&($=this.performanceClient.startMeasurement(vq.FetchAccountIdWithNativeBroker,t.correlationId)),[4,_.getAuthCodeUrl(__assign$1(__assign$1({},v),{nativeBroker:R}))];case 5:return B=he.sent(),q=new tV(_,this.browserStorage,m,this.logger,this.performanceClient),j={popup:l,popupName:o,popupWindowAttributes:s},z=this.initiateAuthRequest(B,j),this.eventHandler.emitEvent(Nz.POPUP_OPENED,Xq.Popup,{popupWindow:z},null),[4,this.monitorPopupForHash(z)];case 6:if(K=he.sent(),W=Oq.getDeserializedHash(K),Z=this.validateAndExtractStateFromHash(W,Xq.Popup,v.correlationId),fq.removeThrottle(this.browserStorage,this.config.auth.clientId,m),W.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),$&&$.endMeasurement({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw Cz.createNativeConnectionNotEstablishedError();return te=new lV(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Jq.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,W.accountId,this.nativeStorage,v.correlationId),ne=Rq.parseRequestState(this.browserCrypto,Z).userRequestState,[2,te.acquireToken(__assign$1(__assign$1({},v),{state:ne,prompt:void 0})).finally((function(){se.browserStorage.cleanRequestByState(Z)}))]}return[4,q.handleCodeResponseFromHash(K,Z,_.authority,this.networkClient)];case 7:return[2,he.sent()];case 8:throw ie=he.sent(),l&&l.close(),ie instanceof RH&&ie.setCorrelationId(this.correlationId),h.cacheFailedRequest(ie),this.browserStorage.cleanRequestByState(v.state),ie;case 9:return[2]}}))}))},PopupClient.prototype.logoutPopupAsync=function(t,o,s,l,h,v){return __awaiter$3(this,void 0,void 0,(function(){var m,_,R,$,B,q,j;return __generator$1(this,(function(z){switch(z.label){case 0:this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(Nz.LOGOUT_START,Xq.Popup,t),m=this.initializeServerTelemetryManager(Jq.logoutPopup),z.label=1;case 1:return z.trys.push([1,5,,6]),[4,this.clearCacheOnLogout(t.account)];case 2:return z.sent(),this.performanceClient.setPreQueueTime(vq.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(m,l)];case 3:return _=z.sent(),this.logger.verbose("Auth code client created"),R=_.getLogoutUri(t),this.eventHandler.emitEvent(Nz.LOGOUT_SUCCESS,Xq.Popup,t),$=this.openPopup(R,{popupName:o,popupWindowAttributes:s,popup:h}),this.eventHandler.emitEvent(Nz.POPUP_OPENED,Xq.Popup,{popupWindow:$},null),[4,this.waitForLogoutPopup($)];case 4:return z.sent(),v?(B={apiId:Jq.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},q=Oq.getAbsoluteUrl(v,Xz.getCurrentUri()),this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii("Redirecting main window to: "+q),this.navigationClient.navigateInternal(q,B)):this.logger.verbose("No main window navigation requested"),[3,6];case 5:throw j=z.sent(),h&&h.close(),j instanceof RH&&j.setCorrelationId(this.correlationId),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(Nz.LOGOUT_FAILURE,Xq.Popup,null,j),this.eventHandler.emitEvent(Nz.LOGOUT_END,Xq.Popup),m.cacheFailedRequest(j),j;case 6:return this.eventHandler.emitEvent(Nz.LOGOUT_END,Xq.Popup),[2]}}))}))},PopupClient.prototype.initiateAuthRequest=function(t,o){if(TB.isEmpty(t))throw this.logger.error("Navigate url is empty"),Cz.createEmptyNavigationUriError();return this.logger.infoPii("Navigate to: "+t),this.openPopup(t,o)},PopupClient.prototype.monitorPopupForHash=function(t){var o=this;return new Promise((function(s,l){var h=o.config.system.windowHashTimeout/o.config.system.pollIntervalMilliseconds,v=0;o.logger.verbose("PopupHandler.monitorPopupForHash - polling started");var m=setInterval((function(){if(t.closed)return o.logger.error("PopupHandler.monitorPopupForHash - window closed"),o.cleanPopup(),clearInterval(m),void l(Cz.createUserCancelledError());var _=JU.EMPTY_STRING,R=JU.EMPTY_STRING;try{_=t.location.href,R=t.location.hash}catch(t){}TB.isEmpty(_)||"about:blank"===_||(o.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),v++,R?(o.logger.verbose("PopupHandler.monitorPopupForHash - found hash in url"),clearInterval(m),o.cleanPopup(t),Oq.hashContainsKnownProperties(R)?(o.logger.verbose("PopupHandler.monitorPopupForHash - hash contains known properties, returning."),s(R)):(o.logger.error("PopupHandler.monitorPopupForHash - found hash in url but it does not contain known properties. Check that your router is not changing the hash prematurely."),o.logger.errorPii("PopupHandler.monitorPopupForHash - hash found: "+R),l(Cz.createHashDoesNotContainKnownPropertiesError()))):v>h&&(o.logger.error("PopupHandler.monitorPopupForHash - unable to find hash in url, timing out"),clearInterval(m),l(Cz.createMonitorPopupTimeoutError())))}),o.config.system.pollIntervalMilliseconds)}))},PopupClient.prototype.waitForLogoutPopup=function(t){var o=this;return new Promise((function(s){o.logger.verbose("PopupHandler.waitForLogoutPopup - polling started");var l=setInterval((function(){t.closed&&(o.logger.error("PopupHandler.waitForLogoutPopup - window closed"),o.cleanPopup(),clearInterval(l),s());var h=JU.EMPTY_STRING;try{h=t.location.href}catch(t){}TB.isEmpty(h)||"about:blank"===h||(o.logger.verbose("PopupHandler.waitForLogoutPopup - popup window is on same origin as caller, closing."),clearInterval(l),o.cleanPopup(t),s())}),o.config.system.pollIntervalMilliseconds)}))},PopupClient.prototype.openPopup=function(t,o){try{var s=void 0;if(o.popup?(s=o.popup,this.logger.verbosePii("Navigating popup window to: "+t),s.location.assign(t)):void 0===o.popup&&(this.logger.verbosePii("Opening popup window to: "+t),s=this.openSizedPopup(t,o.popupName,o.popupWindowAttributes)),!s)throw Cz.createEmptyWindowCreatedError();return s.focus&&s.focus(),this.currentWindow=s,window.addEventListener("beforeunload",this.unloadWindow),s}catch(t){throw this.logger.error("error opening popup "+t.message),this.browserStorage.setInteractionInProgress(!1),Cz.createPopupWindowError(t.toString())}},PopupClient.prototype.openSizedPopup=function(t,o,s){var l,h,v,m,_=window.screenLeft?window.screenLeft:window.screenX,R=window.screenTop?window.screenTop:window.screenY,$=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,B=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,q=null===(l=s.popupSize)||void 0===l?void 0:l.width,j=null===(h=s.popupSize)||void 0===h?void 0:h.height,z=null===(v=s.popupPosition)||void 0===v?void 0:v.top,K=null===(m=s.popupPosition)||void 0===m?void 0:m.left;return(!q||q<0||q>$)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),q=kz.POPUP_WIDTH),(!j||j<0||j>B)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),j=kz.POPUP_HEIGHT),(!z||z<0||z>B)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),z=Math.max(0,B/2-kz.POPUP_HEIGHT/2+R)),(!K||K<0||K>$)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),K=Math.max(0,$/2-kz.POPUP_WIDTH/2+_)),window.open(t,o,"width="+q+", height="+j+", top="+z+", left="+K+", scrollbars=yes")},PopupClient.prototype.unloadWindow=function(t){this.browserStorage.cleanRequestByInteractionType(Xq.Popup),this.currentWindow&&this.currentWindow.close(),t.preventDefault()},PopupClient.prototype.cleanPopup=function(t){t&&t.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)},PopupClient.prototype.generatePopupName=function(t,o){return kz.POPUP_NAME_PREFIX+"."+this.config.auth.clientId+"."+t.join("-")+"."+o+"."+this.correlationId},PopupClient.prototype.generateLogoutPopupName=function(t){var o=t.account&&t.account.homeAccountId;return kz.POPUP_NAME_PREFIX+"."+this.config.auth.clientId+"."+o+"."+this.correlationId},PopupClient}(eV),hV=function(){function NavigationClient(){}return NavigationClient.prototype.navigateInternal=function(t,o){return NavigationClient.defaultNavigateWindow(t,o)},NavigationClient.prototype.navigateExternal=function(t,o){return NavigationClient.defaultNavigateWindow(t,o)},NavigationClient.defaultNavigateWindow=function(t,o){return o.noHistory?window.location.replace(t):window.location.assign(t),new Promise((function(t){setTimeout((function(){t(!0)}),o.timeout)}))},NavigationClient}(),pV=6e4,fV=6e3,gV=3e4,vV=2e3;
/*! @azure/msal-browser v2.33.0 2023-02-06 */
var mV,bV=function(t){function SilentHandler(o,s,l,h,v,m){var _=t.call(this,o,s,l,h,m)||this;return _.navigateFrameWait=v.navigateFrameWait,_.pollIntervalMilliseconds=v.pollIntervalMilliseconds,_}return __extends$1(SilentHandler,t),SilentHandler.prototype.initiateAuthRequest=function(t){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(o){switch(o.label){case 0:if(this.performanceClient.addQueueMeasurement(vq.SilentHandlerInitiateAuthRequest,this.authCodeRequest.correlationId),TB.isEmpty(t))throw this.logger.info("Navigate url is empty"),Cz.createEmptyNavigationUriError();return this.navigateFrameWait?(this.performanceClient.setPreQueueTime(vq.SilentHandlerLoadFrame,this.authCodeRequest.correlationId),[4,this.loadFrame(t)]):[3,2];case 1:return[2,o.sent()];case 2:return[2,this.loadFrameSync(t)]}}))}))},SilentHandler.prototype.monitorIframeForHash=function(t,o){var s=this;return this.performanceClient.addQueueMeasurement(vq.SilentHandlerMonitorIframeForHash,this.authCodeRequest.correlationId),new Promise((function(l,h){o<fV&&s.logger.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower ("+o+"ms) than the default ("+fV+"ms). This may result in timeouts.");var v=window.performance.now()+o,m=setInterval((function(){if(window.performance.now()>v)return s.removeHiddenIframe(t),clearInterval(m),void h(Cz.createMonitorIframeTimeoutError());var o=JU.EMPTY_STRING,_=t.contentWindow;try{o=_?_.location.href:JU.EMPTY_STRING}catch(t){}if(!TB.isEmpty(o)){var R=_?_.location.hash:JU.EMPTY_STRING;return Oq.hashContainsKnownProperties(R)?(s.removeHiddenIframe(t),clearInterval(m),void l(R)):void 0}}),s.pollIntervalMilliseconds)}))},SilentHandler.prototype.loadFrame=function(t){var o=this;return this.performanceClient.addQueueMeasurement(vq.SilentHandlerLoadFrame,this.authCodeRequest.correlationId),new Promise((function(s,l){var h=o.createHiddenIframe();setTimeout((function(){h?(h.src=t,s(h)):l("Unable to load iframe")}),o.navigateFrameWait)}))},SilentHandler.prototype.loadFrameSync=function(t){var o=this.createHiddenIframe();return o.src=t,o},SilentHandler.prototype.createHiddenIframe=function(){var t=document.createElement("iframe");return t.style.visibility="hidden",t.style.position="absolute",t.style.width=t.style.height="0",t.style.border="0",t.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(t),t},SilentHandler.prototype.removeHiddenIframe=function(t){document.body===t.parentNode&&document.body.removeChild(t)},SilentHandler}(tV),yV=function(t){function SilentIframeClient(o,s,l,h,v,m,_,R,$,B,q){var j=t.call(this,o,s,l,h,v,m,R,B,q)||this;return j.apiId=_,j.nativeStorage=$,j}return __extends$1(SilentIframeClient,t),SilentIframeClient.prototype.acquireToken=function(t){return __awaiter$3(this,void 0,void 0,(function(){var o,s,l,h,v;return __generator$1(this,(function(m){switch(m.label){case 0:if(this.performanceClient.addQueueMeasurement(vq.SilentIframeClientAcquireToken,t.correlationId),this.logger.verbose("acquireTokenByIframe called"),o=this.performanceClient.startMeasurement(vq.SilentIframeClientAcquireToken,t.correlationId),TB.isEmpty(t.loginHint)&&TB.isEmpty(t.sid)&&(!t.account||TB.isEmpty(t.account.username))&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request."),t.prompt&&t.prompt!==tH.NONE&&t.prompt!==tH.NO_SESSION)throw o.endMeasurement({success:!1}),Cz.createSilentPromptValueError(t.prompt);return this.performanceClient.setPreQueueTime(vq.StandardInteractionClientInitializeAuthorizationRequest,t.correlationId),[4,this.initializeAuthorizationRequest(__assign$1(__assign$1({},t),{prompt:t.prompt||tH.NONE}),Xq.Silent)];case 1:s=m.sent(),this.browserStorage.updateCacheEntries(s.state,s.nonce,s.authority,s.loginHint||JU.EMPTY_STRING,s.account||null),l=this.initializeServerTelemetryManager(this.apiId),m.label=2;case 2:return m.trys.push([2,5,,6]),this.performanceClient.setPreQueueTime(vq.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(l,s.authority,s.azureCloudOptions)];case 3:return h=m.sent(),this.logger.verbose("Auth code client created"),this.performanceClient.setPreQueueTime(vq.SilentIframeClientTokenHelper,t.correlationId),[4,this.silentTokenHelper(h,s).then((function(t){return o.endMeasurement({success:!0,fromCache:!1,requestId:t.requestId}),t}))];case 4:return[2,m.sent()];case 5:throw(v=m.sent())instanceof RH&&v.setCorrelationId(this.correlationId),l.cacheFailedRequest(v),this.browserStorage.cleanRequestByState(s.state),o.endMeasurement({errorCode:v instanceof RH&&v.errorCode||void 0,subErrorCode:v instanceof RH&&v.subError||void 0,success:!1}),v;case 6:return[2]}}))}))},SilentIframeClient.prototype.logout=function(){return Promise.reject(Cz.createSilentLogoutUnsupportedError())},SilentIframeClient.prototype.silentTokenHelper=function(t,o){return __awaiter$3(this,void 0,void 0,(function(){var s,l,h,v,m,_,R,$,B,q=this;return __generator$1(this,(function(j){switch(j.label){case 0:return this.performanceClient.addQueueMeasurement(vq.SilentIframeClientTokenHelper,o.correlationId),this.performanceClient.setPreQueueTime(vq.StandardInteractionClientInitializeAuthorizationCodeRequest,o.correlationId),[4,this.initializeAuthorizationCodeRequest(o)];case 1:return s=j.sent(),this.performanceClient.setPreQueueTime(vq.GetAuthCodeUrl,o.correlationId),[4,t.getAuthCodeUrl(__assign$1(__assign$1({},o),{nativeBroker:cV.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,o.authenticationScheme)}))];case 2:return l=j.sent(),h=new bV(t,this.browserStorage,s,this.logger,this.config.system,this.performanceClient),this.performanceClient.setPreQueueTime(vq.SilentHandlerInitiateAuthRequest,o.correlationId),[4,h.initiateAuthRequest(l)];case 3:return v=j.sent(),this.performanceClient.setPreQueueTime(vq.SilentHandlerMonitorIframeForHash,o.correlationId),[4,h.monitorIframeForHash(v,this.config.system.iframeHashTimeout)];case 4:if(m=j.sent(),_=Oq.getDeserializedHash(m),R=this.validateAndExtractStateFromHash(_,Xq.Silent,s.correlationId),_.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw Cz.createNativeConnectionNotEstablishedError();return $=new lV(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,_.accountId,this.browserStorage,this.correlationId),B=Rq.parseRequestState(this.browserCrypto,R).userRequestState,[2,$.acquireToken(__assign$1(__assign$1({},o),{state:B,prompt:o.prompt||tH.NONE})).finally((function(){q.browserStorage.cleanRequestByState(R)}))]}return this.performanceClient.setPreQueueTime(vq.HandleCodeResponseFromHash,o.correlationId),[2,h.handleCodeResponseFromHash(m,R,t.authority,this.networkClient)]}}))}))},SilentIframeClient}(eV),wV=function(t){function SilentRefreshClient(){return null!==t&&t.apply(this,arguments)||this}return __extends$1(SilentRefreshClient,t),SilentRefreshClient.prototype.acquireToken=function(t){return __awaiter$3(this,void 0,void 0,(function(){var o,s,l,h,v,m=this;return __generator$1(this,(function(_){switch(_.label){case 0:return this.performanceClient.addQueueMeasurement(vq.SilentRefreshClientAcquireToken,t.correlationId),this.performanceClient.setPreQueueTime(vq.InitializeBaseRequest,t.correlationId),s=[__assign$1({},t)],[4,this.initializeBaseRequest(t)];case 1:return o=__assign$1.apply(void 0,s.concat([_.sent()])),l=this.performanceClient.startMeasurement(vq.SilentRefreshClientAcquireToken,o.correlationId),h=this.initializeServerTelemetryManager(Jq.acquireTokenSilent_silentFlow),[4,this.createRefreshTokenClient(h,o.authority,o.azureCloudOptions)];case 2:return v=_.sent(),this.logger.verbose("Refresh token client created"),this.performanceClient.setPreQueueTime(vq.RefreshTokenClientAcquireTokenByRefreshToken,t.correlationId),[2,v.acquireTokenByRefreshToken(o).then((function(t){return l.endMeasurement({success:!0,fromCache:t.fromCache,requestId:t.requestId}),t})).catch((function(t){throw t instanceof RH&&t.setCorrelationId(m.correlationId),h.cacheFailedRequest(t),l.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t}))]}}))}))},SilentRefreshClient.prototype.logout=function(){return Promise.reject(Cz.createSilentLogoutUnsupportedError())},SilentRefreshClient.prototype.createRefreshTokenClient=function(t,o,s){return __awaiter$3(this,void 0,void 0,(function(){var l;return __generator$1(this,(function(h){switch(h.label){case 0:return this.performanceClient.setPreQueueTime(vq.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(t,o,s)];case 1:return l=h.sent(),[2,new Hq(l,this.performanceClient)]}}))}))},SilentRefreshClient}(eV),_V=function(){function EventHandler(t,o){this.eventCallbacks=new Map,this.logger=t,this.browserCrypto=o,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}return EventHandler.prototype.addEventCallback=function(t){if("undefined"!=typeof window){var o=this.browserCrypto.createNewGuid();return this.eventCallbacks.set(o,t),this.logger.verbose("Event callback registered with id: "+o),o}return null},EventHandler.prototype.removeEventCallback=function(t){this.eventCallbacks.delete(t),this.logger.verbose("Event callback "+t+" removed.")},EventHandler.prototype.enableAccountStorageEvents=function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))},EventHandler.prototype.disableAccountStorageEvents=function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))},EventHandler.prototype.emitEvent=function(t,o,s,l){var h=this;if("undefined"!=typeof window){var v={eventType:t,interactionType:o||null,payload:s||null,error:l||null,timestamp:Date.now()};this.logger.info("Emitting event: "+t),this.eventCallbacks.forEach((function(o,s){h.logger.verbose("Emitting event to callback "+s+": "+t),o.apply(null,[v])}))}},EventHandler.prototype.handleAccountCacheChange=function(t){try{var o=t.newValue||t.oldValue;if(!o)return;var s=JSON.parse(o);if("object"!=typeof s||!tq.isAccountEntity(s))return;var l=oq.toObject(new tq,s).getAccountInfo();!t.oldValue&&t.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent(Nz.ACCOUNT_ADDED,void 0,l)):!t.newValue&&t.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent(Nz.ACCOUNT_REMOVED,void 0,l))}catch(t){return}},EventHandler}(),CV=function(){function MathUtils(){}return MathUtils.decimalToHex=function(t){for(var o=t.toString(16);o.length<2;)o="0"+o;return o},MathUtils}(),kV=function(){function GuidGenerator(t){this.cryptoObj=t}return GuidGenerator.prototype.generateGuid=function(){try{var t=new Uint8Array(16);return this.cryptoObj.getRandomValues(t),t[6]|=64,t[6]&=79,t[8]|=128,t[8]&=191,CV.decimalToHex(t[0])+CV.decimalToHex(t[1])+CV.decimalToHex(t[2])+CV.decimalToHex(t[3])+"-"+CV.decimalToHex(t[4])+CV.decimalToHex(t[5])+"-"+CV.decimalToHex(t[6])+CV.decimalToHex(t[7])+"-"+CV.decimalToHex(t[8])+CV.decimalToHex(t[9])+"-"+CV.decimalToHex(t[10])+CV.decimalToHex(t[11])+CV.decimalToHex(t[12])+CV.decimalToHex(t[13])+CV.decimalToHex(t[14])+CV.decimalToHex(t[15])}catch(t){for(var o="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",s="0123456789abcdef",l=0,h=JU.EMPTY_STRING,v=0;v<36;v++)"-"!==o[v]&&"4"!==o[v]&&(l=16*Math.random()|0),"x"===o[v]?h+=s[l]:"y"===o[v]?(l&=3,h+=s[l|=8]):h+=o[v];return h}},GuidGenerator.prototype.isGuid=function(t){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)},GuidGenerator}(),TV=function(){function BrowserStringUtils(){}return BrowserStringUtils.stringToUtf8Arr=function(t){for(var o,s=0,l=t.length,h=0;h<l;h++)s+=(o=t.charCodeAt(h))<128?1:o<2048?2:o<65536?3:o<2097152?4:o<67108864?5:6;for(var v=new Uint8Array(s),m=0,_=0;m<s;_++)(o=t.charCodeAt(_))<128?v[m++]=o:o<2048?(v[m++]=192+(o>>>6),v[m++]=128+(63&o)):o<65536?(v[m++]=224+(o>>>12),v[m++]=128+(o>>>6&63),v[m++]=128+(63&o)):o<2097152?(v[m++]=240+(o>>>18),v[m++]=128+(o>>>12&63),v[m++]=128+(o>>>6&63),v[m++]=128+(63&o)):o<67108864?(v[m++]=248+(o>>>24),v[m++]=128+(o>>>18&63),v[m++]=128+(o>>>12&63),v[m++]=128+(o>>>6&63),v[m++]=128+(63&o)):(v[m++]=252+(o>>>30),v[m++]=128+(o>>>24&63),v[m++]=128+(o>>>18&63),v[m++]=128+(o>>>12&63),v[m++]=128+(o>>>6&63),v[m++]=128+(63&o));return v},BrowserStringUtils.stringToArrayBuffer=function(t){for(var o=new ArrayBuffer(t.length),s=new Uint8Array(o),l=0;l<t.length;l++)s[l]=t.charCodeAt(l);return o},BrowserStringUtils.utf8ArrToString=function(t){for(var o=JU.EMPTY_STRING,s=void 0,l=t.length,h=0;h<l;h++)s=t[h],o+=String.fromCharCode(s>251&&s<254&&h+5<l?1073741824*(s-252)+(t[++h]-128<<24)+(t[++h]-128<<18)+(t[++h]-128<<12)+(t[++h]-128<<6)+t[++h]-128:s>247&&s<252&&h+4<l?(s-248<<24)+(t[++h]-128<<18)+(t[++h]-128<<12)+(t[++h]-128<<6)+t[++h]-128:s>239&&s<248&&h+3<l?(s-240<<18)+(t[++h]-128<<12)+(t[++h]-128<<6)+t[++h]-128:s>223&&s<240&&h+2<l?(s-224<<12)+(t[++h]-128<<6)+t[++h]-128:s>191&&s<224&&h+1<l?(s-192<<6)+t[++h]-128:s);return o},BrowserStringUtils.getSortedObjectString=function(t){return JSON.stringify(t,Object.keys(t).sort())},BrowserStringUtils}(),SV=function(){function Base64Encode(){}return Base64Encode.prototype.urlEncode=function(t){return encodeURIComponent(this.encode(t).replace(/=/g,JU.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_"))},Base64Encode.prototype.urlEncodeArr=function(t){return this.base64EncArr(t).replace(/=/g,JU.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_")},Base64Encode.prototype.encode=function(t){var o=TV.stringToUtf8Arr(t);return this.base64EncArr(o)},Base64Encode.prototype.base64EncArr=function(t){for(var o=(3-t.length%3)%3,s=JU.EMPTY_STRING,l=void 0,h=t.length,v=0,m=0;m<h;m++)l=m%3,v|=t[m]<<(16>>>l&24),2!==l&&t.length-m!=1||(s+=String.fromCharCode(this.uint6ToB64(v>>>18&63),this.uint6ToB64(v>>>12&63),this.uint6ToB64(v>>>6&63),this.uint6ToB64(63&v)),v=0);return 0===o?s:s.substring(0,s.length-o)+(1===o?"=":"==")},Base64Encode.prototype.uint6ToB64=function(t){return t<26?t+65:t<52?t+71:t<62?t-4:62===t?43:63===t?47:65},Base64Encode}(),xV=function(){function Base64Decode(){}return Base64Decode.prototype.decode=function(t){var o=t.replace(/-/g,"+").replace(/_/g,"/");switch(o.length%4){case 0:break;case 2:o+="==";break;case 3:o+="=";break;default:throw new Error("Invalid base64 string")}var s=this.base64DecToArr(o);return TV.utf8ArrToString(s)},Base64Decode.prototype.base64DecToArr=function(t,o){for(var s=t.replace(/[^A-Za-z0-9\+\/]/g,JU.EMPTY_STRING),l=s.length,h=o?Math.ceil((3*l+1>>>2)/o)*o:3*l+1>>>2,v=new Uint8Array(h),m=void 0,_=void 0,R=0,$=0,B=0;B<l;B++)if(_=3&B,R|=this.b64ToUint6(s.charCodeAt(B))<<18-6*_,3===_||l-B==1){for(m=0;m<3&&$<h;m++,$++)v[$]=R>>>(16>>>m&24)&255;R=0}return v},Base64Decode.prototype.b64ToUint6=function(t){return t>64&&t<91?t-65:t>96&&t<123?t-71:t>47&&t<58?t+4:43===t?62:47===t?63:0},Base64Decode}(),EV=function(){function PkceGenerator(t){this.base64Encode=new SV,this.cryptoObj=t}return PkceGenerator.prototype.generateCodes=function(){return __awaiter$3(this,void 0,void 0,(function(){var t,o;return __generator$1(this,(function(s){switch(s.label){case 0:return t=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(t)];case 1:return o=s.sent(),[2,{verifier:t,challenge:o}]}}))}))},PkceGenerator.prototype.generateCodeVerifier=function(){try{var t=new Uint8Array(32);return this.cryptoObj.getRandomValues(t),this.base64Encode.urlEncodeArr(t)}catch(t){throw Cz.createPkceNotGeneratedError(t)}},PkceGenerator.prototype.generateCodeChallengeFromVerifier=function(t){return __awaiter$3(this,void 0,void 0,(function(){var o,s;return __generator$1(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(t)];case 1:return o=l.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(o))];case 2:throw s=l.sent(),Cz.createPkceNotGeneratedError(s);case 3:return[2]}}))}))},PkceGenerator}(),IV=function(){function ModernBrowserCrypto(){}return ModernBrowserCrypto.prototype.getRandomValues=function(t){return window.crypto.getRandomValues(t)},ModernBrowserCrypto.prototype.generateKey=function(t,o,s){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(l){return[2,window.crypto.subtle.generateKey(t,o,s)]}))}))},ModernBrowserCrypto.prototype.exportKey=function(t){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(o){return[2,window.crypto.subtle.exportKey(Az,t)]}))}))},ModernBrowserCrypto.prototype.importKey=function(t,o,s,l){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(h){return[2,window.crypto.subtle.importKey(Az,t,o,s,l)]}))}))},ModernBrowserCrypto.prototype.sign=function(t,o,s){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(l){return[2,window.crypto.subtle.sign(t,o,s)]}))}))},ModernBrowserCrypto.prototype.digest=function(t,o){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(s){return[2,window.crypto.subtle.digest(t,o)]}))}))},ModernBrowserCrypto}(),AV=function(){function MsrBrowserCrypto(){}return MsrBrowserCrypto.prototype.initPrng=function(t){return window.msrCrypto.initPrng(__spread(t))},MsrBrowserCrypto.prototype.getRandomValues=function(t){return window.msrCrypto.getRandomValues(t)},MsrBrowserCrypto.prototype.generateKey=function(t,o,s){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(l){return[2,window.msrCrypto.subtle.generateKey(t,o,s)]}))}))},MsrBrowserCrypto.prototype.exportKey=function(t){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(o){return[2,window.msrCrypto.subtle.exportKey(Az,t)]}))}))},MsrBrowserCrypto.prototype.importKey=function(t,o,s,l){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(h){return[2,window.msrCrypto.subtle.importKey(Az,t,o,s,l)]}))}))},MsrBrowserCrypto.prototype.sign=function(t,o,s){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(l){return[2,window.msrCrypto.subtle.sign(t,o,s)]}))}))},MsrBrowserCrypto.prototype.digest=function(t,o){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(s){return[2,window.msrCrypto.subtle.digest(t,o)]}))}))},MsrBrowserCrypto}(),PV=function(){function MsBrowserCrypto(){}return MsBrowserCrypto.prototype.getRandomValues=function(t){return window.msCrypto.getRandomValues(t)},MsBrowserCrypto.prototype.generateKey=function(t,o,s){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(l){return[2,new Promise((function(l,h){var v=window.msCrypto.subtle.generateKey(t,o,s);v.addEventListener("complete",(function(t){l(t.target.result)})),v.addEventListener("error",(function(t){h(t)}))}))]}))}))},MsBrowserCrypto.prototype.exportKey=function(t){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(o){return[2,new Promise((function(o,s){var l=window.msCrypto.subtle.exportKey(Az,t);l.addEventListener("complete",(function(t){var l=t.target.result,h=TV.utf8ArrToString(new Uint8Array(l)).replace(/\r/g,JU.EMPTY_STRING).replace(/\n/g,JU.EMPTY_STRING).replace(/\t/g,JU.EMPTY_STRING).split(" ").join(JU.EMPTY_STRING).replace("\0",JU.EMPTY_STRING);try{o(JSON.parse(h))}catch(t){s(t)}})),l.addEventListener("error",(function(t){s(t)}))}))]}))}))},MsBrowserCrypto.prototype.importKey=function(t,o,s,l){return __awaiter$3(this,void 0,void 0,(function(){var h,v;return __generator$1(this,(function(m){return h=TV.getSortedObjectString(t),v=TV.stringToArrayBuffer(h),[2,new Promise((function(t,h){var m=window.msCrypto.subtle.importKey(Az,v,o,s,l);m.addEventListener("complete",(function(o){t(o.target.result)})),m.addEventListener("error",(function(t){h(t)}))}))]}))}))},MsBrowserCrypto.prototype.sign=function(t,o,s){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(l){return[2,new Promise((function(l,h){var v=window.msCrypto.subtle.sign(t,o,s);v.addEventListener("complete",(function(t){l(t.target.result)})),v.addEventListener("error",(function(t){h(t)}))}))]}))}))},MsBrowserCrypto.prototype.digest=function(t,o){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(s){return[2,new Promise((function(s,l){var h=window.msCrypto.subtle.digest(t,o.buffer);h.addEventListener("complete",(function(t){s(t.target.result)})),h.addEventListener("error",(function(t){l(t)}))}))]}))}))},MsBrowserCrypto}(),RV="RSASSA-PKCS1-v1_5",OV="SHA-256",$V=2048,NV=new Uint8Array([1,0,1]),MV=function(){function BrowserCrypto(t,o){var s,l;if(this.logger=t,this.cryptoOptions=o,this.hasBrowserCrypto())this.logger.verbose("BrowserCrypto: modern crypto interface available"),this.subtleCrypto=new IV;else if(this.hasIECrypto())this.logger.verbose("BrowserCrypto: MS crypto interface available"),this.subtleCrypto=new PV;else{if(!this.hasMsrCrypto()||!(null===(s=this.cryptoOptions)||void 0===s?void 0:s.useMsrCrypto))throw this.hasMsrCrypto()&&this.logger.info("BrowserCrypto: MSR Crypto interface available but system.cryptoOptions.useMsrCrypto not enabled"),this.logger.error("BrowserCrypto: No crypto interfaces available."),Cz.createCryptoNotAvailableError("Browser crypto, msCrypto, or msrCrypto interfaces not available.");this.logger.verbose("BrowserCrypto: MSR crypto interface available"),this.subtleCrypto=new AV}if(this.subtleCrypto.initPrng){if(this.logger.verbose("BrowserCrypto: Interface requires entropy"),!(null===(l=this.cryptoOptions)||void 0===l?void 0:l.entropy))throw this.logger.error("BrowserCrypto: Interface requires entropy but none provided."),jz.createEntropyNotProvided();this.logger.verbose("BrowserCrypto: Entropy provided"),this.subtleCrypto.initPrng(this.cryptoOptions.entropy)}this.keygenAlgorithmOptions={name:RV,hash:OV,modulusLength:$V,publicExponent:NV}}return BrowserCrypto.prototype.hasIECrypto=function(){return"msCrypto"in window},BrowserCrypto.prototype.hasBrowserCrypto=function(){return"crypto"in window},BrowserCrypto.prototype.hasMsrCrypto=function(){return"msrCrypto"in window},BrowserCrypto.prototype.sha256Digest=function(t){return __awaiter$3(this,void 0,void 0,(function(){var o;return __generator$1(this,(function(s){return o=TV.stringToUtf8Arr(t),[2,this.subtleCrypto.digest({name:OV},o)]}))}))},BrowserCrypto.prototype.getRandomValues=function(t){return this.subtleCrypto.getRandomValues(t)},BrowserCrypto.prototype.generateKeyPair=function(t,o){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(s){return[2,this.subtleCrypto.generateKey(this.keygenAlgorithmOptions,t,o)]}))}))},BrowserCrypto.prototype.exportJwk=function(t){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(o){return[2,this.subtleCrypto.exportKey(t)]}))}))},BrowserCrypto.prototype.importJwk=function(t,o,s){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(l){return[2,this.subtleCrypto.importKey(t,this.keygenAlgorithmOptions,o,s)]}))}))},BrowserCrypto.prototype.sign=function(t,o){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(s){return[2,this.subtleCrypto.sign(this.keygenAlgorithmOptions,t,o)]}))}))},BrowserCrypto}(),DV=function(){function DatabaseStorage(){this.dbName=Rz,this.version=Oz,this.tableName=$z,this.dbOpen=!1}return DatabaseStorage.prototype.open=function(){return __awaiter$3(this,void 0,void 0,(function(){var t=this;return __generator$1(this,(function(o){return[2,new Promise((function(o,s){var l=window.indexedDB.open(t.dbName,t.version);l.addEventListener("upgradeneeded",(function(o){o.target.result.createObjectStore(t.tableName)})),l.addEventListener("success",(function(s){var l=s;t.db=l.target.result,t.dbOpen=!0,o()})),l.addEventListener("error",(function(){return s(Cz.createDatabaseUnavailableError())}))}))]}))}))},DatabaseStorage.prototype.closeConnection=function(){var t=this.db;t&&this.dbOpen&&(t.close(),this.dbOpen=!1)},DatabaseStorage.prototype.validateDbIsOpen=function(){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(t){switch(t.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:return[2,t.sent()];case 2:return[2]}}))}))},DatabaseStorage.prototype.getItem=function(t){return __awaiter$3(this,void 0,void 0,(function(){var o=this;return __generator$1(this,(function(s){switch(s.label){case 0:return[4,this.validateDbIsOpen()];case 1:return s.sent(),[2,new Promise((function(s,l){if(!o.db)return l(Cz.createDatabaseNotOpenError());var h=o.db.transaction([o.tableName],"readonly").objectStore(o.tableName).get(t);h.addEventListener("success",(function(t){var l=t;o.closeConnection(),s(l.target.result)})),h.addEventListener("error",(function(t){o.closeConnection(),l(t)}))}))]}}))}))},DatabaseStorage.prototype.setItem=function(t,o){return __awaiter$3(this,void 0,void 0,(function(){var s=this;return __generator$1(this,(function(l){switch(l.label){case 0:return[4,this.validateDbIsOpen()];case 1:return l.sent(),[2,new Promise((function(l,h){if(!s.db)return h(Cz.createDatabaseNotOpenError());var v=s.db.transaction([s.tableName],"readwrite").objectStore(s.tableName).put(o,t);v.addEventListener("success",(function(){s.closeConnection(),l()})),v.addEventListener("error",(function(t){s.closeConnection(),h(t)}))}))]}}))}))},DatabaseStorage.prototype.removeItem=function(t){return __awaiter$3(this,void 0,void 0,(function(){var o=this;return __generator$1(this,(function(s){switch(s.label){case 0:return[4,this.validateDbIsOpen()];case 1:return s.sent(),[2,new Promise((function(s,l){if(!o.db)return l(Cz.createDatabaseNotOpenError());var h=o.db.transaction([o.tableName],"readwrite").objectStore(o.tableName).delete(t);h.addEventListener("success",(function(){o.closeConnection(),s()})),h.addEventListener("error",(function(t){o.closeConnection(),l(t)}))}))]}}))}))},DatabaseStorage.prototype.getKeys=function(){return __awaiter$3(this,void 0,void 0,(function(){var t=this;return __generator$1(this,(function(o){switch(o.label){case 0:return[4,this.validateDbIsOpen()];case 1:return o.sent(),[2,new Promise((function(o,s){if(!t.db)return s(Cz.createDatabaseNotOpenError());var l=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).getAllKeys();l.addEventListener("success",(function(s){var l=s;t.closeConnection(),o(l.target.result)})),l.addEventListener("error",(function(o){t.closeConnection(),s(o)}))}))]}}))}))},DatabaseStorage.prototype.containsKey=function(t){return __awaiter$3(this,void 0,void 0,(function(){var o=this;return __generator$1(this,(function(s){switch(s.label){case 0:return[4,this.validateDbIsOpen()];case 1:return s.sent(),[2,new Promise((function(s,l){if(!o.db)return l(Cz.createDatabaseNotOpenError());var h=o.db.transaction([o.tableName],"readonly").objectStore(o.tableName).count(t);h.addEventListener("success",(function(t){var l=t;o.closeConnection(),s(1===l.target.result)})),h.addEventListener("error",(function(t){o.closeConnection(),l(t)}))}))]}}))}))},DatabaseStorage.prototype.deleteDatabase=function(){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(t){return this.db&&this.dbOpen&&this.closeConnection(),[2,new Promise((function(t,o){var s=window.indexedDB.deleteDatabase(Rz);s.addEventListener("success",(function(){return t(!0)})),s.addEventListener("blocked",(function(){return t(!0)})),s.addEventListener("error",(function(){return o(!1)}))}))]}))}))},DatabaseStorage}(),LV=function(){function AsyncMemoryStorage(t,o){this.inMemoryCache=new Vz,this.indexedDBCache=new DV,this.logger=t,this.storeName=o}return AsyncMemoryStorage.prototype.handleDatabaseAccessError=function(t){if(!(t instanceof Cz&&t.errorCode===gz.code))throw t;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")},AsyncMemoryStorage.prototype.getItem=function(t){return __awaiter$3(this,void 0,void 0,(function(){var o,s;return __generator$1(this,(function(l){switch(l.label){case 0:if(o=this.inMemoryCache.getItem(t))return[3,4];l.label=1;case 1:return l.trys.push([1,3,,4]),this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.getItem(t)];case 2:return[2,l.sent()];case 3:return s=l.sent(),this.handleDatabaseAccessError(s),[3,4];case 4:return[2,o]}}))}))},AsyncMemoryStorage.prototype.setItem=function(t,o){return __awaiter$3(this,void 0,void 0,(function(){var s;return __generator$1(this,(function(l){switch(l.label){case 0:this.inMemoryCache.setItem(t,o),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,this.indexedDBCache.setItem(t,o)];case 2:return l.sent(),[3,4];case 3:return s=l.sent(),this.handleDatabaseAccessError(s),[3,4];case 4:return[2]}}))}))},AsyncMemoryStorage.prototype.removeItem=function(t){return __awaiter$3(this,void 0,void 0,(function(){var o;return __generator$1(this,(function(s){switch(s.label){case 0:this.inMemoryCache.removeItem(t),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.indexedDBCache.removeItem(t)];case 2:return s.sent(),[3,4];case 3:return o=s.sent(),this.handleDatabaseAccessError(o),[3,4];case 4:return[2]}}))}))},AsyncMemoryStorage.prototype.getKeys=function(){return __awaiter$3(this,void 0,void 0,(function(){var t,o;return __generator$1(this,(function(s){switch(s.label){case 0:if(0!==(t=this.inMemoryCache.getKeys()).length)return[3,4];s.label=1;case 1:return s.trys.push([1,3,,4]),this.logger.verbose("In-memory cache is empty, now querying persistent storage."),[4,this.indexedDBCache.getKeys()];case 2:return[2,s.sent()];case 3:return o=s.sent(),this.handleDatabaseAccessError(o),[3,4];case 4:return[2,t]}}))}))},AsyncMemoryStorage.prototype.containsKey=function(t){return __awaiter$3(this,void 0,void 0,(function(){var o,s;return __generator$1(this,(function(l){switch(l.label){case 0:if(o=this.inMemoryCache.containsKey(t))return[3,4];l.label=1;case 1:return l.trys.push([1,3,,4]),this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.containsKey(t)];case 2:return[2,l.sent()];case 3:return s=l.sent(),this.handleDatabaseAccessError(s),[3,4];case 4:return[2,o]}}))}))},AsyncMemoryStorage.prototype.clearInMemory=function(){this.logger.verbose("Deleting in-memory keystore "+this.storeName),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore "+this.storeName+" deleted")},AsyncMemoryStorage.prototype.clearPersistent=function(){return __awaiter$3(this,void 0,void 0,(function(){var t,o;return __generator$1(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),this.logger.verbose("Deleting persistent keystore"),[4,this.indexedDBCache.deleteDatabase()];case 1:return(t=s.sent())&&this.logger.verbose("Persistent keystore deleted"),[2,t];case 2:return o=s.sent(),this.handleDatabaseAccessError(o),[2,!1];case 3:return[2]}}))}))},AsyncMemoryStorage}();
/*! @azure/msal-browser v2.33.0 2023-02-06 */!function(t){t.asymmetricKeys="asymmetricKeys",t.symmetricKeys="symmetricKeys"}(mV||(mV={}));var FV,UV=function(){function CryptoKeyStore(t){this.logger=t,this.asymmetricKeys=new LV(this.logger,mV.asymmetricKeys),this.symmetricKeys=new LV(this.logger,mV.symmetricKeys)}return CryptoKeyStore.prototype.clear=function(){return __awaiter$3(this,void 0,void 0,(function(){var t;return __generator$1(this,(function(o){switch(o.label){case 0:this.asymmetricKeys.clearInMemory(),this.symmetricKeys.clearInMemory(),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.asymmetricKeys.clearPersistent()];case 2:return o.sent(),[2,!0];case 3:return(t=o.sent())instanceof Error?this.logger.error("Clearing keystore failed with error: "+t.message):this.logger.error("Clearing keystore failed with unknown error"),[2,!1];case 4:return[2]}}))}))},CryptoKeyStore}(),HV=function(){function CryptoOps(t,o,s){this.logger=t,this.browserCrypto=new MV(this.logger,s),this.b64Encode=new SV,this.b64Decode=new xV,this.guidGenerator=new kV(this.browserCrypto),this.pkceGenerator=new EV(this.browserCrypto),this.cache=new UV(this.logger),this.performanceClient=o}return CryptoOps.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},CryptoOps.prototype.base64Encode=function(t){return this.b64Encode.encode(t)},CryptoOps.prototype.base64Decode=function(t){return this.b64Decode.decode(t)},CryptoOps.prototype.generatePkceCodes=function(){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(t){return[2,this.pkceGenerator.generateCodes()]}))}))},CryptoOps.prototype.getPublicKeyThumbprint=function(t){var o;return __awaiter$3(this,void 0,void 0,(function(){var s,l,h,v,m,_,R,$;return __generator$1(this,(function(B){switch(B.label){case 0:return s=null===(o=this.performanceClient)||void 0===o?void 0:o.startMeasurement(vq.CryptoOptsGetPublicKeyThumbprint,t.correlationId),[4,this.browserCrypto.generateKeyPair(CryptoOps.EXTRACTABLE,CryptoOps.POP_KEY_USAGES)];case 1:return l=B.sent(),[4,this.browserCrypto.exportJwk(l.publicKey)];case 2:return h=B.sent(),v={e:h.e,kty:h.kty,n:h.n},m=TV.getSortedObjectString(v),[4,this.hashString(m)];case 3:return _=B.sent(),[4,this.browserCrypto.exportJwk(l.privateKey)];case 4:return R=B.sent(),[4,this.browserCrypto.importJwk(R,!1,["sign"])];case 5:return $=B.sent(),[4,this.cache.asymmetricKeys.setItem(_,{privateKey:$,publicKey:l.publicKey,requestMethod:t.resourceRequestMethod,requestUri:t.resourceRequestUri})];case 6:return B.sent(),s&&s.endMeasurement({success:!0}),[2,_]}}))}))},CryptoOps.prototype.removeTokenBindingKey=function(t){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(o){switch(o.label){case 0:return[4,this.cache.asymmetricKeys.removeItem(t)];case 1:return o.sent(),[4,this.cache.asymmetricKeys.containsKey(t)];case 2:return[2,!o.sent()]}}))}))},CryptoOps.prototype.clearKeystore=function(){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(t){switch(t.label){case 0:return[4,this.cache.clear()];case 1:return[2,t.sent()]}}))}))},CryptoOps.prototype.signJwt=function(t,o,s){var l;return __awaiter$3(this,void 0,void 0,(function(){var h,v,m,_,R,$,B,q,j,z,K,W,Z;return __generator$1(this,(function(te){switch(te.label){case 0:return h=null===(l=this.performanceClient)||void 0===l?void 0:l.startMeasurement(vq.CryptoOptsSignJwt,s),[4,this.cache.asymmetricKeys.getItem(o)];case 1:if(!(v=te.sent()))throw Cz.createSigningKeyNotFoundInStorageError(o);return[4,this.browserCrypto.exportJwk(v.publicKey)];case 2:return m=te.sent(),_=TV.getSortedObjectString(m),R=this.b64Encode.urlEncode(JSON.stringify({kid:o})),$=Cj.getShrHeaderString({kid:R,alg:m.alg}),B=this.b64Encode.urlEncode($),t.cnf={jwk:JSON.parse(_)},q=this.b64Encode.urlEncode(JSON.stringify(t)),j=B+"."+q,z=TV.stringToArrayBuffer(j),[4,this.browserCrypto.sign(v.privateKey,z)];case 3:return K=te.sent(),W=this.b64Encode.urlEncodeArr(new Uint8Array(K)),Z=j+"."+W,h&&h.endMeasurement({success:!0}),[2,Z]}}))}))},CryptoOps.prototype.hashString=function(t){return __awaiter$3(this,void 0,void 0,(function(){var o,s;return __generator$1(this,(function(l){switch(l.label){case 0:return[4,this.browserCrypto.sha256Digest(t)];case 1:return o=l.sent(),s=new Uint8Array(o),[2,this.b64Encode.urlEncodeArr(s)]}}))}))},CryptoOps.POP_KEY_USAGES=["sign","verify"],CryptoOps.EXTRACTABLE=!0,CryptoOps}(),BV=function(){function BrowserPerformanceMeasurement(t,o){this.correlationId=o,this.measureName="msal.measure."+t+"."+this.correlationId,this.startMark="msal.start."+t+"."+this.correlationId,this.endMark="msal.end."+t+"."+this.correlationId}return BrowserPerformanceMeasurement.supportsBrowserPerformance=function(){return"undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.mark&&"function"==typeof window.performance.measure&&"function"==typeof window.performance.clearMarks&&"function"==typeof window.performance.clearMeasures&&"function"==typeof window.performance.getEntriesByName},BrowserPerformanceMeasurement.prototype.startMeasurement=function(){if(BrowserPerformanceMeasurement.supportsBrowserPerformance())try{window.performance.mark(this.startMark)}catch(t){}},BrowserPerformanceMeasurement.prototype.endMeasurement=function(){if(BrowserPerformanceMeasurement.supportsBrowserPerformance())try{window.performance.mark(this.endMark),window.performance.measure(this.measureName,this.startMark,this.endMark)}catch(t){}},BrowserPerformanceMeasurement.prototype.flushMeasurement=function(){if(BrowserPerformanceMeasurement.supportsBrowserPerformance())try{var t=window.performance.getEntriesByName(this.measureName,"measure");if(t.length>0){var o=t[0].duration;return window.performance.clearMeasures(this.measureName),window.performance.clearMarks(this.startMark),window.performance.clearMarks(this.endMark),o}}catch(t){}return null},BrowserPerformanceMeasurement}(),qV=function(t){function BrowserPerformanceClient(o,s,l,h,v,m,_){var R=t.call(this,o,s,l,h,v,m)||this;return R.browserCrypto=new MV(R.logger,_),R.guidGenerator=new kV(R.browserCrypto),R}return __extends$1(BrowserPerformanceClient,t),BrowserPerformanceClient.prototype.startPerformanceMeasuremeant=function(t,o){return new BV(t,o)},BrowserPerformanceClient.prototype.generateId=function(){return this.guidGenerator.generateGuid()},BrowserPerformanceClient.prototype.getPageVisibility=function(){var t;return(null===(t=document.visibilityState)||void 0===t?void 0:t.toString())||null},BrowserPerformanceClient.prototype.supportsBrowserPerformanceNow=function(){return"undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.now},BrowserPerformanceClient.prototype.startMeasurement=function(o,s){var l=this,h=this.getPageVisibility(),v=t.prototype.startMeasurement.call(this,o,s);return __assign$1(__assign$1({},v),{endMeasurement:function(t){return v.endMeasurement(__assign$1({startPageVisibility:h,endPageVisibility:l.getPageVisibility()},t))}})},BrowserPerformanceClient.prototype.setPreQueueTime=function(t,o){if(this.supportsBrowserPerformanceNow())if(o){var s=this.preQueueTimeByCorrelationId.get(o);if(s)s.set(t,window.performance.now()),this.preQueueTimeByCorrelationId.set(o,s);else{var l=new Map;l.set(t,window.performance.now()),this.preQueueTimeByCorrelationId.set(o,l)}}else this.logger.trace("BrowserPerformanceClient: correlationId for "+t+" not provided, unable to set telemetry queue time");else this.logger.trace("BrowserPerformanceClient: window performance API not available, unable to set telemetry queue time for "+t)},BrowserPerformanceClient.prototype.addQueueMeasurement=function(o,s){if(this.supportsBrowserPerformanceNow())if(s){var l=t.prototype.getPreQueueTime.call(this,o,s);if(l){var h=window.performance.now(),v=t.prototype.calculateQueuedTime.call(this,l,h);return t.prototype.addQueueMeasurement.call(this,o,s,v)}}else this.logger.trace("BrowserPerformanceClient: correlationId for "+o+" not provided, unable to add queue measurement");else this.logger.trace("BrowserPerformanceClient: window performance API not available, unable to add queue measurement for "+o)},BrowserPerformanceClient}(Sj),jV=function(){function TokenCache(t,o,s,l){this.isBrowserEnvironment="undefined"!=typeof window,this.config=t,this.storage=o,this.logger=s,this.cryptoObj=l}return TokenCache.prototype.loadExternalTokens=function(t,o,s){if(this.logger.info("TokenCache - loadExternalTokens called"),!o.id_token)throw Cz.createUnableToLoadTokenError("Please ensure server response includes id token.");var l,h,v=new rq(o.id_token,this.cryptoObj);if(t.account){var m=this.loadAccount(v,t.account.environment,void 0,void 0,t.account.homeAccountId);l=new Pq(m,this.loadIdToken(v,m.homeAccountId,t.account.environment,t.account.tenantId),this.loadAccessToken(t,o,m.homeAccountId,t.account.environment,t.account.tenantId,s),this.loadRefreshToken(t,o,m.homeAccountId,t.account.environment))}else{if(!t.authority)throw Cz.createUnableToLoadTokenError("Please provide a request with an account or a request with authority.");var _=nj.generateAuthority(t.authority,t.azureCloudOptions),R={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache};if(h=new nj(_,this.config.system.networkClient,this.storage,R,this.logger),s.clientInfo){this.logger.trace("TokenCache - homeAccountId from options");m=this.loadAccount(v,h.hostnameAndPort,s.clientInfo,h.authorityType);l=new Pq(m,this.loadIdToken(v,m.homeAccountId,h.hostnameAndPort,h.tenant),this.loadAccessToken(t,o,m.homeAccountId,h.hostnameAndPort,h.tenant,s),this.loadRefreshToken(t,o,m.homeAccountId,h.hostnameAndPort))}else{if(!o.client_info)throw Cz.createUnableToLoadTokenError("Please provide clientInfo in the response or options.");this.logger.trace("TokenCache - homeAccountId from response");m=this.loadAccount(v,h.hostnameAndPort,o.client_info,h.authorityType);l=new Pq(m,this.loadIdToken(v,m.homeAccountId,h.hostnameAndPort,h.tenant),this.loadAccessToken(t,o,m.homeAccountId,h.hostnameAndPort,h.tenant,s),this.loadRefreshToken(t,o,m.homeAccountId,h.hostnameAndPort))}}return this.generateAuthenticationResult(t,v,l,h)},TokenCache.prototype.loadAccount=function(t,o,s,l,h){var v;if(h?v=h:void 0!==l&&s&&(v=tq.generateHomeAccountId(s,l,this.logger,this.cryptoObj,t)),!v)throw Cz.createUnableToLoadTokenError("Unexpected missing homeAccountId");var m=s?tq.createAccount(s,v,t,void 0,void 0,void 0,o):tq.createGenericAccount(v,t,void 0,void 0,void 0,o);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading account"),this.storage.setAccount(m),m;throw Cz.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},TokenCache.prototype.loadIdToken=function(t,o,s,l){var h=_q.createIdTokenEntity(o,s,t.rawToken,this.config.auth.clientId,l);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading id token"),this.storage.setIdTokenCredential(h),h;throw Cz.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},TokenCache.prototype.loadAccessToken=function(t,o,s,l,h,v){if(!o.access_token)return this.logger.verbose("TokenCache - No access token provided for caching"),null;if(!o.expires_in)throw Cz.createUnableToLoadTokenError("Please ensure server response includes expires_in value.");if(!v.extendedExpiresOn)throw Cz.createUnableToLoadTokenError("Please provide an extendedExpiresOn value in the options.");var m=new eq(t.scopes).printScopes(),_=v.expiresOn||o.expires_in+(new Date).getTime()/1e3,R=v.extendedExpiresOn,$=kq.createAccessTokenEntity(s,l,o.access_token,this.config.auth.clientId,h,m,_,R,this.cryptoObj);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading access token"),this.storage.setAccessTokenCredential($),$;throw Cz.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},TokenCache.prototype.loadRefreshToken=function(t,o,s,l){if(!o.refresh_token)return this.logger.verbose("TokenCache - No refresh token provided for caching"),null;var h=Tq.createRefreshTokenEntity(s,l,o.refresh_token,this.config.auth.clientId);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading refresh token"),this.storage.setRefreshTokenCredential(h),h;throw Cz.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},TokenCache.prototype.generateAuthenticationResult=function(t,o,s,l){var h,v,m,_,R=JU.EMPTY_STRING,$=[],B=null;(null==s?void 0:s.accessToken)&&(R=s.accessToken.secret,$=eq.fromString(s.accessToken.target).asArray(),B=new Date(1e3*Number(s.accessToken.expiresOn)),_=new Date(1e3*Number(s.accessToken.extendedExpiresOn)));var q=(null==o?void 0:o.claims.oid)||(null==o?void 0:o.claims.sub)||JU.EMPTY_STRING,j=(null==o?void 0:o.claims.tid)||JU.EMPTY_STRING;return{authority:l?l.canonicalAuthority:JU.EMPTY_STRING,uniqueId:q,tenantId:j,scopes:$,account:(null==s?void 0:s.account)?s.account.getAccountInfo():null,idToken:o?o.rawToken:JU.EMPTY_STRING,idTokenClaims:o?o.claims:{},accessToken:R,fromCache:!0,expiresOn:B,correlationId:t.correlationId||JU.EMPTY_STRING,requestId:JU.EMPTY_STRING,extExpiresOn:_,familyId:JU.EMPTY_STRING,tokenType:(null===(h=null==s?void 0:s.accessToken)||void 0===h?void 0:h.tokenType)||JU.EMPTY_STRING,state:JU.EMPTY_STRING,cloudGraphHostName:(null===(v=null==s?void 0:s.account)||void 0===v?void 0:v.cloudGraphHostName)||JU.EMPTY_STRING,msGraphHost:(null===(m=null==s?void 0:s.account)||void 0===m?void 0:m.msGraphHost)||JU.EMPTY_STRING,code:void 0,fromNativeBroker:!1}},TokenCache}(),zV=function(t){function HybridSpaAuthorizationCodeClient(o){var s=t.call(this,o)||this;return s.includeRedirectUri=!1,s}return __extends$1(HybridSpaAuthorizationCodeClient,t),HybridSpaAuthorizationCodeClient}(Uq),VV=function(t){function SilentAuthCodeClient(o,s,l,h,v,m,_,R,$,B){var q=t.call(this,o,s,l,h,v,m,R,$,B)||this;return q.apiId=_,q}return __extends$1(SilentAuthCodeClient,t),SilentAuthCodeClient.prototype.acquireToken=function(t){return __awaiter$3(this,void 0,void 0,(function(){var o,s,l,h,v,m;return __generator$1(this,(function(_){switch(_.label){case 0:if(this.logger.trace("SilentAuthCodeClient.acquireToken called"),!t.code)throw Cz.createAuthCodeRequiredError();return this.performanceClient.setPreQueueTime(vq.StandardInteractionClientInitializeAuthorizationRequest,t.correlationId),[4,this.initializeAuthorizationRequest(t,Xq.Silent)];case 1:o=_.sent(),this.browserStorage.updateCacheEntries(o.state,o.nonce,o.authority,o.loginHint||JU.EMPTY_STRING,o.account||null),s=this.initializeServerTelemetryManager(this.apiId),_.label=2;case 2:return _.trys.push([2,4,,5]),l=__assign$1(__assign$1({},o),{code:t.code}),this.performanceClient.setPreQueueTime(vq.StandardInteractionClientGetClientConfiguration,t.correlationId),[4,this.getClientConfiguration(s,o.authority)];case 3:return h=_.sent(),v=new zV(h),this.logger.verbose("Auth code client created"),[2,new bV(v,this.browserStorage,l,this.logger,this.config.system,this.performanceClient).handleCodeResponseFromServer({code:t.code,msgraph_host:t.msGraphHost,cloud_graph_host_name:t.cloudGraphHostName,cloud_instance_host_name:t.cloudInstanceHostName},o.state,v.authority,this.networkClient,!1)];case 4:throw(m=_.sent())instanceof RH&&m.setCorrelationId(this.correlationId),s.cacheFailedRequest(m),this.browserStorage.cleanRequestByState(o.state),m;case 5:return[2]}}))}))},SilentAuthCodeClient.prototype.logout=function(){return Promise.reject(Cz.createSilentLogoutUnsupportedError())},SilentAuthCodeClient}(eV),GV=function(){function ClientApplication(t){this.isBrowserEnvironment="undefined"!=typeof window,this.config=function buildConfiguration(t,o){var s=t.auth,l=t.cache,h=t.system,v=t.telemetry,m={clientId:JU.EMPTY_STRING,authority:""+JU.DEFAULT_AUTHORITY,knownAuthorities:[],cloudDiscoveryMetadata:JU.EMPTY_STRING,authorityMetadata:JU.EMPTY_STRING,redirectUri:JU.EMPTY_STRING,postLogoutRedirectUri:JU.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:qq.AAD,azureCloudOptions:{azureCloudInstance:SB.None,tenant:JU.EMPTY_STRING},skipAuthorityMetadataCache:!1},_={cacheLocation:Kq.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1},R={loggerCallback:function(){},logLevel:IH.Info,piiLoggingEnabled:!1},$=__assign$1(__assign$1({},iq),{loggerOptions:R,networkClient:o?Xz.getBrowserNetworkClient():fj,navigationClient:new hV,loadFrameTimeout:0,windowHashTimeout:(null==h?void 0:h.loadFrameTimeout)||pV,iframeHashTimeout:(null==h?void 0:h.loadFrameTimeout)||fV,navigateFrameWait:o&&Xz.detectIEOrEdge()?500:0,redirectNavigationTimeout:gV,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:(null==h?void 0:h.nativeBrokerHandshakeTimeout)||vV,pollIntervalMilliseconds:kz.DEFAULT_POLL_INTERVAL_MS,cryptoOptions:{useMsrCrypto:!1,entropy:void 0}}),B=__assign$1(__assign$1({},h),{loggerOptions:(null==h?void 0:h.loggerOptions)||R}),q={application:{appName:JU.EMPTY_STRING,appVersion:JU.EMPTY_STRING}};return{auth:__assign$1(__assign$1({},m),s),cache:__assign$1(__assign$1({},_),l),system:__assign$1(__assign$1({},$),B),telemetry:__assign$1(__assign$1({},q),v)}}(t,this.isBrowserEnvironment),this.initialized=!1,this.logger=new xB(this.config.system.loggerOptions,Wz,Qz),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.isBrowserEnvironment?new qV(this.config.auth.clientId,this.config.auth.authority,this.logger,Wz,Qz,this.config.telemetry.application,this.config.system.cryptoOptions):new Ij(this.config.auth.clientId,this.config.auth.authority,this.logger,Wz,Qz,this.config.telemetry.application),this.browserCrypto=this.isBrowserEnvironment?new HV(this.logger,this.performanceClient,this.config.system.cryptoOptions):OH,this.eventHandler=new _V(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new Kz(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger):DEFAULT_BROWSER_CACHE_MANAGER(this.config.auth.clientId,this.logger);var o={cacheLocation:Kq.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1};this.nativeInternalStorage=new Kz(this.config.auth.clientId,o,this.browserCrypto,this.logger),this.tokenCache=new jV(this.config,this.browserStorage,this.logger,this.browserCrypto),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}return ClientApplication.prototype.initialize=function(){return __awaiter$3(this,void 0,void 0,(function(){var t,o;return __generator$1(this,(function(s){switch(s.label){case 0:if(this.logger.trace("initialize called"),this.initialized)return this.logger.info("initialize has already been called, exiting early."),[2];if(this.eventHandler.emitEvent(Nz.INITIALIZE_START),!this.config.system.allowNativeBroker)return[3,4];s.label=1;case 1:return s.trys.push([1,3,,4]),t=this,[4,cV.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout)];case 2:return t.nativeExtensionProvider=s.sent(),[3,4];case 3:return o=s.sent(),this.logger.verbose(o),[3,4];case 4:return this.initialized=!0,this.eventHandler.emitEvent(Nz.INITIALIZE_END),[2]}}))}))},ClientApplication.prototype.handleRedirectPromise=function(t){return __awaiter$3(this,void 0,void 0,(function(){var o,s,l,h,v,m,_,R,$=this;return __generator$1(this,(function(B){return this.logger.verbose("handleRedirectPromise called"),Xz.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),o=this.getAllAccounts(),this.isBrowserEnvironment?(s=t||JU.EMPTY_STRING,void 0===(l=this.redirectResponse.get(s))?(this.eventHandler.emitEvent(Nz.HANDLE_REDIRECT_START,Xq.Redirect),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise"),h=this.browserStorage.getCachedNativeRequest(),v=void 0,h&&cV.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!t?(this.logger.trace("handleRedirectPromise - acquiring token from native platform"),m=new lV(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Jq.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,h.accountId,this.nativeInternalStorage,h.correlationId),v=m.handleRedirectPromise()):(this.logger.trace("handleRedirectPromise - acquiring token from web flow"),_=this.browserStorage.getTemporaryCache(Qq.CORRELATION_ID,!0)||JU.EMPTY_STRING,R=this.createRedirectClient(_),v=R.handleRedirectPromise(t)),l=v.then((function(t){t&&(o.length<$.getAllAccounts().length?($.eventHandler.emitEvent(Nz.LOGIN_SUCCESS,Xq.Redirect,t),$.logger.verbose("handleRedirectResponse returned result, login success")):($.eventHandler.emitEvent(Nz.ACQUIRE_TOKEN_SUCCESS,Xq.Redirect,t),$.logger.verbose("handleRedirectResponse returned result, acquire token success")));return $.eventHandler.emitEvent(Nz.HANDLE_REDIRECT_END,Xq.Redirect),t})).catch((function(t){throw o.length>0?$.eventHandler.emitEvent(Nz.ACQUIRE_TOKEN_FAILURE,Xq.Redirect,null,t):$.eventHandler.emitEvent(Nz.LOGIN_FAILURE,Xq.Redirect,null,t),$.eventHandler.emitEvent(Nz.HANDLE_REDIRECT_END,Xq.Redirect),t})),this.redirectResponse.set(s,l)):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),[2,l]):(this.logger.verbose("handleRedirectPromise returns null, not browser environment"),[2,null])}))}))},ClientApplication.prototype.acquireTokenRedirect=function(t){return __awaiter$3(this,void 0,void 0,(function(){var o,s,l,h,v,m=this;return __generator$1(this,(function(_){return o=this.getRequestCorrelationId(t),this.logger.verbose("acquireTokenRedirect called",o),this.preflightBrowserEnvironmentCheck(Xq.Redirect),(s=this.getAllAccounts().length>0)?this.eventHandler.emitEvent(Nz.ACQUIRE_TOKEN_START,Xq.Redirect,t):this.eventHandler.emitEvent(Nz.LOGIN_START,Xq.Redirect,t),this.nativeExtensionProvider&&this.canUseNative(t)?(h=new lV(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Jq.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(t),this.nativeInternalStorage,t.correlationId),l=h.acquireTokenRedirect(t).catch((function(o){if(o instanceof sV&&o.isFatal())return m.nativeExtensionProvider=void 0,m.createRedirectClient(t.correlationId).acquireToken(t);if(o instanceof Aq)return m.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),m.createRedirectClient(t.correlationId).acquireToken(t);throw m.browserStorage.setInteractionInProgress(!1),o}))):(v=this.createRedirectClient(t.correlationId),l=v.acquireToken(t)),[2,l.catch((function(t){throw s?m.eventHandler.emitEvent(Nz.ACQUIRE_TOKEN_FAILURE,Xq.Redirect,null,t):m.eventHandler.emitEvent(Nz.LOGIN_FAILURE,Xq.Redirect,null,t),t}))]}))}))},ClientApplication.prototype.acquireTokenPopup=function(t){var o=this,s=this.getRequestCorrelationId(t),l=this.performanceClient.startMeasurement(vq.AcquireTokenPopup,s);try{this.logger.verbose("acquireTokenPopup called",s),this.preflightBrowserEnvironmentCheck(Xq.Popup)}catch(t){return Promise.reject(t)}var h,v=this.getAllAccounts();(v.length>0?this.eventHandler.emitEvent(Nz.ACQUIRE_TOKEN_START,Xq.Popup,t):this.eventHandler.emitEvent(Nz.LOGIN_START,Xq.Popup,t),this.canUseNative(t))?h=this.acquireTokenNative(t,Jq.acquireTokenPopup).then((function(t){return o.browserStorage.setInteractionInProgress(!1),l.endMeasurement({success:!0,isNativeBroker:!0,requestId:t.requestId}),l.flushMeasurement(),t})).catch((function(s){if(s instanceof sV&&s.isFatal())return o.nativeExtensionProvider=void 0,o.createPopupClient(t.correlationId).acquireToken(t);if(s instanceof Aq)return o.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),o.createPopupClient(t.correlationId).acquireToken(t);throw o.browserStorage.setInteractionInProgress(!1),s})):h=this.createPopupClient(t.correlationId).acquireToken(t);return h.then((function(t){return v.length<o.getAllAccounts().length?o.eventHandler.emitEvent(Nz.LOGIN_SUCCESS,Xq.Popup,t):o.eventHandler.emitEvent(Nz.ACQUIRE_TOKEN_SUCCESS,Xq.Popup,t),l.addStaticFields({accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length}),l.endMeasurement({success:!0,requestId:t.requestId}),l.flushMeasurement(),t})).catch((function(t){return v.length>0?o.eventHandler.emitEvent(Nz.ACQUIRE_TOKEN_FAILURE,Xq.Popup,null,t):o.eventHandler.emitEvent(Nz.LOGIN_FAILURE,Xq.Popup,null,t),l.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),l.flushMeasurement(),Promise.reject(t)}))},ClientApplication.prototype.trackPageVisibilityWithMeasurement=function(){var t=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;t&&(this.logger.info("Perf: Visibility change detected in ",t.event.name),t.increment({visibilityChangeCount:1}))},ClientApplication.prototype.ssoSilent=function(t){var o;return __awaiter$3(this,void 0,void 0,(function(){var s,l,h,v,m=this;return __generator$1(this,(function(_){return s=this.getRequestCorrelationId(t),l=__assign$1(__assign$1({},t),{prompt:t.prompt,correlationId:s}),this.preflightBrowserEnvironmentCheck(Xq.Silent),this.ssoSilentMeasurement=this.performanceClient.startMeasurement(vq.SsoSilent,s),null===(o=this.ssoSilentMeasurement)||void 0===o||o.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",s),this.eventHandler.emitEvent(Nz.SSO_SILENT_START,Xq.Silent,l),this.canUseNative(l)?h=this.acquireTokenNative(l,Jq.ssoSilent).catch((function(t){if(t instanceof sV&&t.isFatal())return m.nativeExtensionProvider=void 0,m.createSilentIframeClient(l.correlationId).acquireToken(l);throw t})):(v=this.createSilentIframeClient(l.correlationId),h=v.acquireToken(l)),[2,h.then((function(t){var o,s,l;return m.eventHandler.emitEvent(Nz.SSO_SILENT_SUCCESS,Xq.Silent,t),null===(o=m.ssoSilentMeasurement)||void 0===o||o.addStaticFields({accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length}),null===(s=m.ssoSilentMeasurement)||void 0===s||s.endMeasurement({success:!0,isNativeBroker:t.fromNativeBroker,requestId:t.requestId}),null===(l=m.ssoSilentMeasurement)||void 0===l||l.flushMeasurement(),t})).catch((function(t){var o,s;throw m.eventHandler.emitEvent(Nz.SSO_SILENT_FAILURE,Xq.Silent,null,t),null===(o=m.ssoSilentMeasurement)||void 0===o||o.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),null===(s=m.ssoSilentMeasurement)||void 0===s||s.flushMeasurement(),t})).finally((function(){document.removeEventListener("visibilitychange",m.trackPageVisibilityWithMeasurement)}))]}))}))},ClientApplication.prototype.acquireTokenByCode=function(t){return __awaiter$3(this,void 0,void 0,(function(){var o,s,l,h,v=this;return __generator$1(this,(function(m){o=this.getRequestCorrelationId(t),this.preflightBrowserEnvironmentCheck(Xq.Silent),this.logger.trace("acquireTokenByCode called",o),this.eventHandler.emitEvent(Nz.ACQUIRE_TOKEN_BY_CODE_START,Xq.Silent,t),s=this.performanceClient.startMeasurement(vq.AcquireTokenByCode,t.correlationId);try{if(t.code)return l=t.code,(h=this.hybridAuthCodeResponses.get(l))?(this.logger.verbose("Existing acquireTokenByCode request found",t.correlationId),s.endMeasurement({success:!0}),s.discardMeasurement()):(this.logger.verbose("Initiating new acquireTokenByCode request",o),h=this.acquireTokenByCodeAsync(__assign$1(__assign$1({},t),{correlationId:o})).then((function(t){return v.eventHandler.emitEvent(Nz.ACQUIRE_TOKEN_BY_CODE_SUCCESS,Xq.Silent,t),v.hybridAuthCodeResponses.delete(l),s.addStaticFields({accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length}),s.endMeasurement({success:!0,isNativeBroker:t.fromNativeBroker,requestId:t.requestId}),s.flushMeasurement(),t})).catch((function(t){throw v.hybridAuthCodeResponses.delete(l),v.eventHandler.emitEvent(Nz.ACQUIRE_TOKEN_BY_CODE_FAILURE,Xq.Silent,null,t),s.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),s.flushMeasurement(),t})),this.hybridAuthCodeResponses.set(l,h)),[2,h];if(t.nativeAccountId){if(this.canUseNative(t,t.nativeAccountId))return[2,this.acquireTokenNative(t,Jq.acquireTokenByCode,t.nativeAccountId).catch((function(t){throw t instanceof sV&&t.isFatal()&&(v.nativeExtensionProvider=void 0),t}))];throw Cz.createUnableToAcquireTokenFromNativePlatformError()}throw Cz.createAuthCodeOrNativeAccountIdRequiredError()}catch(t){throw this.eventHandler.emitEvent(Nz.ACQUIRE_TOKEN_BY_CODE_FAILURE,Xq.Silent,null,t),s.endMeasurement({errorCode:t instanceof RH&&t.errorCode||void 0,subErrorCode:t instanceof RH&&t.subError||void 0,success:!1}),t}return[2]}))}))},ClientApplication.prototype.acquireTokenByCodeAsync=function(t){var o;return __awaiter$3(this,void 0,void 0,(function(){var s=this;return __generator$1(this,(function(l){switch(l.label){case 0:return this.logger.trace("acquireTokenByCodeAsync called",t.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(vq.AcquireTokenByCodeAsync,t.correlationId),null===(o=this.acquireTokenByCodeAsyncMeasurement)||void 0===o||o.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),[4,this.createSilentAuthCodeClient(t.correlationId).acquireToken(t).then((function(t){var o;return null===(o=s.acquireTokenByCodeAsyncMeasurement)||void 0===o||o.endMeasurement({success:!0,fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker,requestId:t.requestId}),t})).catch((function(t){var o;throw null===(o=s.acquireTokenByCodeAsyncMeasurement)||void 0===o||o.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t})).finally((function(){document.removeEventListener("visibilitychange",s.trackPageVisibilityWithMeasurement)}))];case 1:return[2,l.sent()]}}))}))},ClientApplication.prototype.acquireTokenFromCache=function(t,o,s){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(l){switch(this.performanceClient.addQueueMeasurement(vq.AcquireTokenFromCache,o.correlationId),s.cacheLookupPolicy){case Pz.Default:case Pz.AccessToken:case Pz.AccessTokenAndRefreshToken:return[2,t.acquireToken(o)];default:throw kB.createRefreshRequiredError()}return[2]}))}))},ClientApplication.prototype.acquireTokenByRefreshToken=function(t,o){return __awaiter$3(this,void 0,void 0,(function(){var s;return __generator$1(this,(function(l){switch(this.performanceClient.addQueueMeasurement(vq.AcquireTokenByRefreshToken,t.correlationId),o.cacheLookupPolicy){case Pz.Default:case Pz.AccessTokenAndRefreshToken:case Pz.RefreshToken:case Pz.RefreshTokenAndNetwork:return s=this.createSilentRefreshClient(t.correlationId),this.performanceClient.setPreQueueTime(vq.SilentRefreshClientAcquireToken,t.correlationId),[2,s.acquireToken(t)];default:throw kB.createRefreshRequiredError()}return[2]}))}))},ClientApplication.prototype.acquireTokenBySilentIframe=function(t){return __awaiter$3(this,void 0,void 0,(function(){var o;return __generator$1(this,(function(s){return this.performanceClient.addQueueMeasurement(vq.AcquireTokenBySilentIframe,t.correlationId),o=this.createSilentIframeClient(t.correlationId),this.performanceClient.setPreQueueTime(vq.SilentIframeClientAcquireToken,t.correlationId),[2,o.acquireToken(t)]}))}))},ClientApplication.prototype.logout=function(t){return __awaiter$3(this,void 0,void 0,(function(){var o;return __generator$1(this,(function(s){return o=this.getRequestCorrelationId(t),this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",o),[2,this.logoutRedirect(__assign$1({correlationId:o},t))]}))}))},ClientApplication.prototype.logoutRedirect=function(t){return __awaiter$3(this,void 0,void 0,(function(){var o;return __generator$1(this,(function(s){return o=this.getRequestCorrelationId(t),this.preflightBrowserEnvironmentCheck(Xq.Redirect),[2,this.createRedirectClient(o).logout(t)]}))}))},ClientApplication.prototype.logoutPopup=function(t){try{var o=this.getRequestCorrelationId(t);return this.preflightBrowserEnvironmentCheck(Xq.Popup),this.createPopupClient(o).logout(t)}catch(t){return Promise.reject(t)}},ClientApplication.prototype.getAllAccounts=function(){return this.logger.verbose("getAllAccounts called"),this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]},ClientApplication.prototype.getAccountByUsername=function(t){var o=this.getAllAccounts();return!TB.isEmpty(t)&&o&&o.length?(this.logger.verbose("Account matching username found, returning"),this.logger.verbosePii("Returning signed-in accounts matching username: "+t),o.filter((function(o){return o.username.toLowerCase()===t.toLowerCase()}))[0]||null):(this.logger.verbose("getAccountByUsername: No matching account found, returning null"),null)},ClientApplication.prototype.getAccountByHomeId=function(t){var o=this.getAllAccounts();return!TB.isEmpty(t)&&o&&o.length?(this.logger.verbose("Account matching homeAccountId found, returning"),this.logger.verbosePii("Returning signed-in accounts matching homeAccountId: "+t),o.filter((function(o){return o.homeAccountId===t}))[0]||null):(this.logger.verbose("getAccountByHomeId: No matching account found, returning null"),null)},ClientApplication.prototype.getAccountByLocalId=function(t){var o=this.getAllAccounts();return!TB.isEmpty(t)&&o&&o.length?(this.logger.verbose("Account matching localAccountId found, returning"),this.logger.verbosePii("Returning signed-in accounts matching localAccountId: "+t),o.filter((function(o){return o.localAccountId===t}))[0]||null):(this.logger.verbose("getAccountByLocalId: No matching account found, returning null"),null)},ClientApplication.prototype.setActiveAccount=function(t){this.browserStorage.setActiveAccount(t)},ClientApplication.prototype.getActiveAccount=function(){return this.browserStorage.getActiveAccount()},ClientApplication.prototype.preflightBrowserEnvironmentCheck=function(t,o){if(void 0===o&&(o=!0),this.logger.verbose("preflightBrowserEnvironmentCheck started"),Xz.blockNonBrowserEnvironment(this.isBrowserEnvironment),Xz.blockRedirectInIframe(t,this.config.system.allowRedirectInIframe),Xz.blockReloadInHiddenIframes(),Xz.blockAcquireTokenInPopups(),Xz.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),t===Xq.Redirect&&this.config.cache.cacheLocation===Kq.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw jz.createInMemoryRedirectUnavailableError();t!==Xq.Redirect&&t!==Xq.Popup||this.preflightInteractiveRequest(o)},ClientApplication.prototype.preflightInteractiveRequest=function(t){this.logger.verbose("preflightInteractiveRequest called, validating app environment"),Xz.blockReloadInHiddenIframes(),t&&this.browserStorage.setInteractionInProgress(!0)},ClientApplication.prototype.acquireTokenNative=function(t,o,s){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(l){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw Cz.createNativeConnectionNotEstablishedError();return[2,new lV(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,o,this.performanceClient,this.nativeExtensionProvider,s||this.getNativeAccountId(t),this.nativeInternalStorage,t.correlationId).acquireToken(t)]}))}))},ClientApplication.prototype.canUseNative=function(t,o){if(this.logger.trace("canUseNative called"),!cV.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,t.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(t.prompt)switch(t.prompt){case tH.NONE:case tH.CONSENT:case tH.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace("canUseNative: prompt = "+t.prompt+" is not compatible with native flow, returning false"),!1}return!(!o&&!this.getNativeAccountId(t))||(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1)},ClientApplication.prototype.getNativeAccountId=function(t){var o=t.account||this.browserStorage.getAccountInfoByHints(t.loginHint,t.sid)||this.getActiveAccount();return o&&o.nativeAccountId||""},ClientApplication.prototype.createPopupClient=function(t){return new uV(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,t)},ClientApplication.prototype.createRedirectClient=function(t){return new dV(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,t)},ClientApplication.prototype.createSilentIframeClient=function(t){return new yV(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Jq.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,t)},ClientApplication.prototype.createSilentCacheClient=function(t){return new aV(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,t)},ClientApplication.prototype.createSilentRefreshClient=function(t){return new wV(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,t)},ClientApplication.prototype.createSilentAuthCodeClient=function(t){return new VV(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Jq.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,t)},ClientApplication.prototype.addEventCallback=function(t){return this.eventHandler.addEventCallback(t)},ClientApplication.prototype.removeEventCallback=function(t){this.eventHandler.removeEventCallback(t)},ClientApplication.prototype.addPerformanceCallback=function(t){return this.performanceClient.addPerformanceCallback(t)},ClientApplication.prototype.removePerformanceCallback=function(t){return this.performanceClient.removePerformanceCallback(t)},ClientApplication.prototype.enableAccountStorageEvents=function(){this.eventHandler.enableAccountStorageEvents()},ClientApplication.prototype.disableAccountStorageEvents=function(){this.eventHandler.disableAccountStorageEvents()},ClientApplication.prototype.getTokenCache=function(){return this.tokenCache},ClientApplication.prototype.getLogger=function(){return this.logger},ClientApplication.prototype.setLogger=function(t){this.logger=t},ClientApplication.prototype.initializeWrapperLibrary=function(t,o){this.browserStorage.setWrapperMetadata(t,o)},ClientApplication.prototype.setNavigationClient=function(t){this.navigationClient=t},ClientApplication.prototype.getConfiguration=function(){return this.config},ClientApplication.prototype.getRequestCorrelationId=function(t){return(null==t?void 0:t.correlationId)?t.correlationId:this.isBrowserEnvironment?this.browserCrypto.createNewGuid():JU.EMPTY_STRING},ClientApplication}(),KV=function(t){function PublicClientApplication(o){var s=t.call(this,o)||this;return s.astsAsyncMeasurement=void 0,s.activeSilentTokenRequests=new Map,s.trackPageVisibility=s.trackPageVisibility.bind(s),s}return __extends$1(PublicClientApplication,t),PublicClientApplication.prototype.loginRedirect=function(t){return __awaiter$3(this,void 0,void 0,(function(){var o;return __generator$1(this,(function(s){return o=this.getRequestCorrelationId(t),this.logger.verbose("loginRedirect called",o),[2,this.acquireTokenRedirect(__assign$1({correlationId:o},t||Iz))]}))}))},PublicClientApplication.prototype.loginPopup=function(t){var o=this.getRequestCorrelationId(t);return this.logger.verbose("loginPopup called",o),this.acquireTokenPopup(__assign$1({correlationId:o},t||Iz))},PublicClientApplication.prototype.acquireTokenSilent=function(t){return __awaiter$3(this,void 0,void 0,(function(){var o,s,l,h,v,m,_,R=this;return __generator$1(this,(function($){if(o=this.getRequestCorrelationId(t),(s=this.performanceClient.startMeasurement(vq.AcquireTokenSilent,o)).addStaticFields({cacheLookupPolicy:t.cacheLookupPolicy}),this.preflightBrowserEnvironmentCheck(Xq.Silent),this.logger.verbose("acquireTokenSilent called",o),!(l=t.account||this.getActiveAccount()))throw Cz.createNoAccountError();return h={clientId:this.config.auth.clientId,authority:t.authority||JU.EMPTY_STRING,scopes:t.scopes,homeAccountIdentifier:l.homeAccountId,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},v=JSON.stringify(h),void 0===(m=this.activeSilentTokenRequests.get(v))?(this.logger.verbose("acquireTokenSilent called for the first time, storing active request",o),this.performanceClient.setPreQueueTime(vq.AcquireTokenSilentAsync,o),_=this.acquireTokenSilentAsync(__assign$1(__assign$1({},t),{correlationId:o}),l).then((function(o){return R.activeSilentTokenRequests.delete(v),s.addStaticFields({accessTokenSize:o.accessToken.length,idTokenSize:o.idToken.length}),s.endMeasurement({success:!0,fromCache:o.fromCache,isNativeBroker:o.fromNativeBroker,cacheLookupPolicy:t.cacheLookupPolicy,requestId:o.requestId}),s.flushMeasurement(),o})).catch((function(t){throw R.activeSilentTokenRequests.delete(v),s.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),s.flushMeasurement(),t})),this.activeSilentTokenRequests.set(v,_),[2,_]):(this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",o),s.endMeasurement({success:!0}),s.discardMeasurement(),[2,m])}))}))},PublicClientApplication.prototype.trackPageVisibility=function(){this.astsAsyncMeasurement&&(this.logger.info("Perf: Visibility change detected"),this.astsAsyncMeasurement.increment({visibilityChangeCount:1}))},PublicClientApplication.prototype.acquireTokenSilentAsync=function(t,o){var s;return __awaiter$3(this,void 0,void 0,(function(){var l,h,v,m,_,R=this;return __generator$1(this,(function($){switch($.label){case 0:return this.performanceClient.addQueueMeasurement(vq.AcquireTokenSilentAsync,t.correlationId),this.eventHandler.emitEvent(Nz.ACQUIRE_TOKEN_START,Xq.Silent,t),this.astsAsyncMeasurement=this.performanceClient.startMeasurement(vq.AcquireTokenSilentAsync,t.correlationId),null===(s=this.astsAsyncMeasurement)||void 0===s||s.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibility),cV.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,t.authenticationScheme)&&o.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),h=__assign$1(__assign$1({},t),{account:o}),l=this.acquireTokenNative(h,Jq.acquireTokenSilent_silentFlow).catch((function(o){return __awaiter$3(R,void 0,void 0,(function(){return __generator$1(this,(function(s){if(o instanceof sV&&o.isFatal())return this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,[2,this.createSilentIframeClient(t.correlationId).acquireToken(t)];throw o}))}))})),[3,3]):[3,1];case 1:return this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),v=this.createSilentCacheClient(t.correlationId),this.performanceClient.setPreQueueTime(vq.InitializeSilentRequest,t.correlationId),[4,v.initializeSilentRequest(t,o)];case 2:m=$.sent(),_=__assign$1(__assign$1({},t),{cacheLookupPolicy:t.cacheLookupPolicy||Pz.Default}),this.performanceClient.setPreQueueTime(vq.AcquireTokenFromCache,m.correlationId),l=this.acquireTokenFromCache(v,m,_).catch((function(o){if(_.cacheLookupPolicy===Pz.AccessToken)throw o;return Xz.blockReloadInHiddenIframes(),R.eventHandler.emitEvent(Nz.ACQUIRE_TOKEN_NETWORK_START,Xq.Silent,m),R.performanceClient.setPreQueueTime(vq.AcquireTokenByRefreshToken,m.correlationId),R.acquireTokenByRefreshToken(m,_).catch((function(o){var s=o instanceof pq,l=o instanceof Aq,h=o.errorCode===kz.INVALID_GRANT_ERROR;if((!s||!h||l||_.cacheLookupPolicy===Pz.AccessTokenAndRefreshToken||_.cacheLookupPolicy===Pz.RefreshToken)&&_.cacheLookupPolicy!==Pz.Skip)throw o;return R.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",t.correlationId),R.performanceClient.setPreQueueTime(vq.AcquireTokenBySilentIframe,m.correlationId),R.acquireTokenBySilentIframe(m)}))})),$.label=3;case 3:return[2,l.then((function(t){var o;return R.eventHandler.emitEvent(Nz.ACQUIRE_TOKEN_SUCCESS,Xq.Silent,t),null===(o=R.astsAsyncMeasurement)||void 0===o||o.endMeasurement({success:!0,fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker,requestId:t.requestId}),t})).catch((function(t){var o;throw R.eventHandler.emitEvent(Nz.ACQUIRE_TOKEN_FAILURE,Xq.Silent,null,t),null===(o=R.astsAsyncMeasurement)||void 0===o||o.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t})).finally((function(){document.removeEventListener("visibilitychange",R.trackPageVisibility)}))]}}))}))},PublicClientApplication}(GV),__awaiter$1=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};
/*! @azure/msal-browser v2.33.0 2023-02-06 */exports.PromptType=void 0,(FV=exports.PromptType||(exports.PromptType={})).SELECT_ACCOUNT="select_account",FV.LOGIN="login",FV.CONSENT="consent";class Msal2Provider extends IProvider{get publicClientApplication(){return this._publicClientApplication}get name(){return"MgtMsal2Provider"}get isMultiAccountDisabled(){return!this.isMultipleAccountEnabled}set isMultiAccountDisabled(t){this.isMultipleAccountEnabled=!t}get isMultiAccountSupportedAndEnabled(){return this.isMultipleAccountEnabled}constructor(t){super(),this.isMultipleAccountEnabled=!0,this.sessionStorageRequestedScopesKey="mgt-requested-scopes",this.sessionStorageDeniedScopesKey="mgt-denied-scopes",this.homeAccountKey="275f3731-e4a4-468a-bf9c-baca24b31e26",this.initProvider(t)}initProvider(t){return __awaiter$1(this,void 0,void 0,(function*(){const o=t.options||{auth:{clientId:""}};if(this.ms_config=o,this.ms_config.cache=o.cache||{},this.ms_config.cache.cacheLocation=o.cache.cacheLocation||"localStorage",void 0!==this.ms_config.cache.storeAuthStateInCookie&&null!==this.ms_config.cache.storeAuthStateInCookie||(this.ms_config.cache.storeAuthStateInCookie=!0),this.ms_config.system=o.system||{},this.ms_config.system.iframeHashTimeout=o.system.iframeHashTimeout||1e4,t.authority&&(this.ms_config.auth.authority=t.authority),t.redirectUri&&(this.ms_config.auth.redirectUri=t.redirectUri),"clientId"in t){if(!t.clientId)throw new Error("clientId must be provided");this.ms_config.auth.clientId=t.clientId,this._publicClientApplication=new KV(this.ms_config)}else{if(!("publicClientApplication"in t))throw new Error("either clientId or publicClientApplication must be provided");if(!t.publicClientApplication)throw new Error("publicClientApplication must be provided");this._publicClientApplication=t.publicClientApplication}this.ms_config.system=o.system||{},this.ms_config.system.iframeHashTimeout=o.system.iframeHashTimeout||1e4,this._loginType=void 0!==t.loginType?t.loginType:exports.LoginType.Redirect,this._loginHint=void 0!==t.loginHint?t.loginHint:null,this._sid=void 0!==t.sid?t.sid:null,this.isIncrementalConsentDisabled=void 0!==t.isIncrementalConsentDisabled&&t.isIncrementalConsentDisabled,this._domainHint=void 0!==t.domainHint?t.domainHint:null,this.scopes=void 0!==t.scopes?t.scopes:["user.read"],this._prompt=void 0!==t.prompt?t.prompt:exports.PromptType.SELECT_ACCOUNT;const s=t;this.isMultipleAccountEnabled=void 0===s.isMultiAccountEnabled||s.isMultiAccountEnabled,this.baseURL=void 0!==s.baseURL?s.baseURL:this.baseURL,this.graph=createFromProvider(this);try{const t=yield this._publicClientApplication.handleRedirectPromise();null!==t?this.handleResponse(null==t?void 0:t.account):this.trySilentSignIn()}catch(t){throw t}}))}trySilentSignIn(){return __awaiter$1(this,void 0,void 0,(function*(){const t={scopes:this.scopes,domainHint:this._domainHint};if(this._sid||this._loginHint){t.sid=this._sid,t.loginHint=this._loginHint;try{this.setState(exports.ProviderState.Loading);const o=yield this._publicClientApplication.ssoSilent(t);o&&this.handleResponse(null==o?void 0:o.account)}catch(t){this.setState(exports.ProviderState.SignedOut)}}else{const t=this.getAccount();if(t&&(yield this.getAccessToken(null)))return void this.handleResponse(t);this.setState(exports.ProviderState.SignedOut)}}))}login(){return __awaiter$1(this,void 0,void 0,(function*(){const t={scopes:this.scopes,loginHint:this._loginHint,prompt:this._prompt,domainHint:this._domainHint};if(this._loginType===exports.LoginType.Popup){const o=yield this._publicClientApplication.loginPopup(t);this.handleResponse(null==o?void 0:o.account)}else{const o=Object.assign({},t);this._publicClientApplication.loginRedirect(o)}}))}getAllAccounts(){const t=[];return this._publicClientApplication.getAllAccounts().forEach((o=>{t.push({name:o.name,mail:o.username,id:o.homeAccountId})})),t}setActiveAccount(t){this._publicClientApplication.setActiveAccount(this._publicClientApplication.getAccountByHomeId(t.id)),this.setStoredAccount(),super.setActiveAccount(t)}getActiveAccount(){const t=this._publicClientApplication.getActiveAccount();return{name:t.name,mail:t.username,id:t.homeAccountId,tenantId:t.tenantId}}handleResponse(t){null!==t?(this.setActiveAccount({name:t.name,id:t.homeAccountId,mail:t.username}),this.setState(exports.ProviderState.SignedIn)):this.setState(exports.ProviderState.SignedOut),this.clearRequestedScopes()}setStoredAccount(){this.clearStoredAccount(),window[this.ms_config.cache.cacheLocation].setItem(this.homeAccountKey,this._publicClientApplication.getActiveAccount().homeAccountId)}getStoredAccount(){let t=null;return t=window[this.ms_config.cache.cacheLocation].getItem(this.homeAccountKey),this._publicClientApplication.getAccountByHomeId(t)}clearStoredAccount(){window[this.ms_config.cache.cacheLocation].removeItem(this.homeAccountKey)}setRequestedScopes(t){t&&sessionStorage.setItem(this.sessionStorageRequestedScopesKey,JSON.stringify(t))}addDeniedScopes(t){if(t){let o=this.getDeniedScopes()||[];o=o.concat(t);let s=o.indexOf("openid");-1!==s&&o.splice(s,1),s=o.indexOf("profile"),-1!==s&&o.splice(s,1),sessionStorage.setItem(this.sessionStorageDeniedScopesKey,JSON.stringify(o))}}getDeniedScopes(){const t=sessionStorage.getItem(this.sessionStorageDeniedScopesKey);return t?JSON.parse(t):null}areScopesDenied(t){if(t){const o=this.getDeniedScopes();if(o&&o.filter((o=>-1!==t.indexOf(o))).length>0)return!0}return!1}clearRequestedScopes(){sessionStorage.removeItem(this.sessionStorageRequestedScopesKey)}getAccount(){const t=this.getStoredAccount();return t||(this._publicClientApplication.getAllAccounts().length>0?this._publicClientApplication.getAllAccounts()[0]:null)}logout(){return __awaiter$1(this,void 0,void 0,(function*(){const t={account:this._publicClientApplication.getActiveAccount()};this.clearStoredAccount(),this._loginType===exports.LoginType.Redirect?(this._publicClientApplication.logoutRedirect(t),this.setState(exports.ProviderState.SignedOut)):(yield this._publicClientApplication.logoutPopup(Object.assign({},t)),1!==this._publicClientApplication.getAllAccounts.length&&this.isMultipleAccountEnabled?this.trySilentSignIn():this.setState(exports.ProviderState.SignedOut))}))}getAccessToken(t){return __awaiter$1(this,void 0,void 0,(function*(){const o=t&&t.scopes||this.scopes,s={scopes:o,account:this.getAccount()};try{const t=s;return(yield this._publicClientApplication.acquireTokenSilent(t)).accessToken}catch(t){if(t instanceof Aq){if(this.isIncrementalConsentDisabled)return null;if(this._loginType===exports.LoginType.Redirect){if(this.areScopesDenied(o))throw t;this.setRequestedScopes(o),this._publicClientApplication.acquireTokenRedirect(s)}else try{return(yield this._publicClientApplication.acquireTokenPopup(s)).accessToken}catch(t){throw t}}else this.setState(exports.ProviderState.SignedOut)}throw null}))}}var __decorate$2=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},__metadata$2=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)};exports.MgtMsal2Provider=class MgtMsal2Provider extends MgtBaseProvider{constructor(){super(...arguments),this.clientId=""}get isAvailable(){return!0}initializeProvider(){if(this.clientId){const t={clientId:this.clientId};if(this.loginType&&this.loginType.length>1){let o=this.loginType.toLowerCase();o=o[0].toUpperCase()+o.slice(1);const s=exports.LoginType[o];t.loginType=s}if(this.authority&&(t.authority=this.authority),this.scopes){const o=this.scopes.split(",");o&&o.length>0&&(t.scopes=o)}if(this.redirectUri&&(t.redirectUri=this.redirectUri),this.loginHint&&(t.loginHint=this.loginHint),this.domainHint&&(t.domainHint=this.domainHint),this.prompt){const o=this.prompt.toUpperCase(),s=exports.PromptType[o];t.prompt=s}this.isIncrementalConsentDisabled&&(t.isIncrementalConsentDisabled=!0),this.isMultiAccountDisabled&&(t.isMultiAccountEnabled=!1),this.baseUrl&&(t.baseURL=this.baseUrl),this.provider=new Msal2Provider(t),Providers.globalProvider=this.provider}}},__decorate$2([e$1({attribute:"client-id",type:String}),__metadata$2("design:type",Object)],exports.MgtMsal2Provider.prototype,"clientId",void 0),__decorate$2([e$1({attribute:"login-hint",type:String}),__metadata$2("design:type",Object)],exports.MgtMsal2Provider.prototype,"loginHint",void 0),__decorate$2([e$1({attribute:"domain-hint",type:String}),__metadata$2("design:type",Object)],exports.MgtMsal2Provider.prototype,"domainHint",void 0),__decorate$2([e$1({attribute:"login-type",type:String}),__metadata$2("design:type",Object)],exports.MgtMsal2Provider.prototype,"loginType",void 0),__decorate$2([e$1(),__metadata$2("design:type",Object)],exports.MgtMsal2Provider.prototype,"authority",void 0),__decorate$2([e$1({attribute:"scopes",type:String}),__metadata$2("design:type",Object)],exports.MgtMsal2Provider.prototype,"scopes",void 0),__decorate$2([e$1({attribute:"redirect-uri",type:String}),__metadata$2("design:type",Object)],exports.MgtMsal2Provider.prototype,"redirectUri",void 0),__decorate$2([e$1({attribute:"prompt",type:String}),__metadata$2("design:type",String)],exports.MgtMsal2Provider.prototype,"prompt",void 0),__decorate$2([e$1({attribute:"incremental-consent-disabled",type:Boolean}),__metadata$2("design:type",Boolean)],exports.MgtMsal2Provider.prototype,"isIncrementalConsentDisabled",void 0),__decorate$2([e$1({attribute:"multi-account-disabled",type:Boolean}),__metadata$2("design:type",Object)],exports.MgtMsal2Provider.prototype,"isMultiAccountDisabled",void 0),exports.MgtMsal2Provider=__decorate$2([customElement("msal2-provider")],exports.MgtMsal2Provider);var WV,__awaiter=function(t,o,s,l){return new(s||(s=Promise))((function(h,v){function fulfilled(t){try{step(l.next(t))}catch(t){v(t)}}function rejected(t){try{step(l.throw(t))}catch(t){v(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};exports.HttpMethod=void 0,(WV=exports.HttpMethod||(exports.HttpMethod={})).GET="GET",WV.POST="POST";class TeamsMsal2Provider extends Msal2Provider{static get isAvailable(){return TeamsHelper.isAvailable}static get microsoftTeamsLib(){return TeamsHelper.microsoftTeamsLib}static set microsoftTeamsLib(t){TeamsHelper.microsoftTeamsLib=t}get name(){return"MgtTeamsMsal2Provider"}static handleAuth(t=HE){return __awaiter(this,void 0,void 0,(function*(){const o=TeamsHelper.microsoftTeamsLib;if(!o)return void console.error("Make sure you have referenced the Microsoft Teams sdk before using the TeamsMsal2Provider");o.initialize(),sessionStorage.getItem(this._sessionStorageLogoutInProgress)&&o.authentication.notifySuccess();const s=new URL(window.location.href).searchParams.get("signout"),l=localStorage.getItem(this._localStorageParametersKey);let h;if(h=l?JSON.parse(l):{},!h.clientId)return void o.authentication.notifyFailure("no clientId provided");const v=h.scopes?h.scopes.split(","):null,m=h.isConsent?exports.PromptType.CONSENT:exports.PromptType.SELECT_ACCOUNT,_=h.options||{auth:{clientId:h.clientId}};_.system=_.system||{},_.system.loadFrameTimeout=1e4;const R=new Msal2Provider({clientId:h.clientId,options:_,scopes:v,loginHint:h.loginHint,prompt:m,baseURL:t}),handleProviderState=()=>__awaiter(this,void 0,void 0,(function*(){if(R.state===exports.ProviderState.SignedOut){if(s)return void o.authentication.notifySuccess();if(!sessionStorage.getItem(this._sessionStorageLoginInProgress)){window.parent!==window?console.warn("handleProviderState - Is in iframe... will try to login anyway... but will not set session storage variable"):sessionStorage.setItem(this._sessionStorageLoginInProgress,"true"),R.login()}}else if(R.state===exports.ProviderState.SignedIn){if(s)return sessionStorage.setItem(this._sessionStorageLogoutInProgress,"true"),void(yield R.logout());try{const t=yield R.getAccessTokenForScopes(...R.scopes);o.authentication.notifySuccess(t)}catch(t){o.authentication.notifyFailure(t)}}}));R.onStateChanged(handleProviderState),handleProviderState()}))}constructor(t){super({clientId:t.clientId,loginType:exports.LoginType.Redirect,options:t.msalOptions,scopes:t.scopes,baseURL:t.baseURL}),this.clientId=t.clientId,this._msalOptions=t.msalOptions,this._authPopupUrl=t.authPopupUrl,this._ssoUrl=t.ssoUrl,this._autoConsent=void 0===t.autoConsent||t.autoConsent,this._httpMethod=void 0!==t.httpMethod?t.httpMethod:exports.HttpMethod.GET;TeamsHelper.microsoftTeamsLib.initialize(),this._ssoUrl&&this.internalLogin()}login(){return __awaiter(this,void 0,void 0,(function*(){if(this._ssoUrl&&!this._needsConsent)return;this.setState(exports.ProviderState.Loading);const t=TeamsHelper.microsoftTeamsLib;return new Promise(((o,s)=>{t.getContext((l=>{this.teamsContext=l;const h={clientId:this.clientId,loginHint:l.loginHint,options:this._msalOptions,scopes:this.scopes.join(","),isConsent:this._autoConsent};localStorage.setItem(TeamsMsal2Provider._localStorageParametersKey,JSON.stringify(h));const v=new URL(this._authPopupUrl,new URL(window.location.href));t.authentication.authenticate({failureCallback:t=>{this.setState(exports.ProviderState.SignedOut),s()},successCallback:t=>{this._ssoUrl?(this.setState(exports.ProviderState.SignedIn),o()):(this.trySilentSignIn(),o())},url:v.href})}))}))}))}logout(){return __awaiter(this,void 0,void 0,(function*(){if(this._ssoUrl)return;const t=TeamsHelper.microsoftTeamsLib;return new Promise(((o,s)=>{t.getContext((l=>{this.teamsContext=l;const h=new URL(this._authPopupUrl,new URL(window.location.href));h.searchParams.append("signout","true"),t.authentication.authenticate({failureCallback:t=>{this.trySilentSignIn(),s()},successCallback:t=>{this.trySilentSignIn(),o()},url:h.href})}))}))}))}getAccessToken(t){return __awaiter(this,void 0,void 0,(function*(){if(!this.teamsContext&&TeamsHelper.microsoftTeamsLib){TeamsHelper.microsoftTeamsLib.initialize(),this.teamsContext=yield this.getTeamsContext()}const o=t&&t.scopes||this.scopes;if(!this._ssoUrl)return new Promise(((t,s)=>__awaiter(this,void 0,void 0,(function*(){const l={scopes:o,account:this.getAccount()};try{const o=yield this.publicClientApplication.acquireTokenSilent(l);t(o.accessToken)}catch(o){o instanceof Aq?t(null):s(o)}}))));{const t=yield this.getClientToken();let s,l=new URL(this._ssoUrl,new URL(window.location.href));if(this._httpMethod===exports.HttpMethod.GET){const h=new URLSearchParams({ssoToken:t,scopes:o.join(","),clientId:this.clientId});s=yield fetch(`${l.href}?${h}`,{method:"GET",mode:"cors",cache:"default"})}else s=yield fetch(l.href,{method:"POST",headers:{"Content-Type":"application/json",authorization:`Bearer ${t}`},body:JSON.stringify({scopes:o,clientid:this.clientId}),mode:"cors",cache:"default"});const h=yield s.json().catch(this.unhandledFetchError);if(s.ok||"consent_required"!==h.error){if(s.ok)return this._needsConsent=!1,h.access_token;throw h}this._needsConsent=!0}}))}internalLogin(){return __awaiter(this,void 0,void 0,(function*(){if(yield this.getAccessToken(null))this.setState(exports.ProviderState.SignedIn);else if(this._needsConsent){if(this._autoConsent){if(this.scopes)return void this.login();throw new Error("For auto consent, scopes must be provided")}throw new Error("Auto consent is not configured. You need to consent to additional scopes")}}))}getClientToken(){return __awaiter(this,void 0,void 0,(function*(){const t=TeamsHelper.microsoftTeamsLib;return new Promise(((o,s)=>{t.authentication.getAuthToken({successCallback:t=>{o(t)},failureCallback:t=>{this.setState(exports.ProviderState.SignedOut),s()}})}))}))}getTeamsContext(){return __awaiter(this,void 0,void 0,(function*(){return new Promise((t=>{const o=TeamsHelper.microsoftTeamsLib;o.initialize(),o.getContext((o=>{t(o)}))}))}))}unhandledFetchError(t){console.error(`There was an error during the server side token exchange:Â ${t}`)}}TeamsMsal2Provider._localStorageParametersKey="msg-TeamsMsal2Provider-auth-parameters",TeamsMsal2Provider._sessionStorageLoginInProgress="msg-TeamsMsal2Provider-login-in-progress",TeamsMsal2Provider._sessionStorageLogoutInProgress="msg-TeamsMsal2Provider-logout-in-progress";var __decorate$1=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},__metadata$1=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)};exports.MgtTeamsMsal2Provider=class MgtTeamsMsal2Provider extends MgtBaseProvider{constructor(){super(...arguments),this.clientId="",this.authPopupUrl="",this.ssoUrl=""}get isAvailable(){return TeamsMsal2Provider.isAvailable}initializeProvider(){if(this.clientId&&this.authPopupUrl){const t={authPopupUrl:this.authPopupUrl,clientId:this.clientId};if(this.scopes){const o=this.scopes.split(",");o&&o.length>0&&(t.scopes=o)}if(this.authority){const o={auth:{authority:this.authority,clientId:this.clientId}};t.msalOptions=o}if(this.ssoUrl&&(t.ssoUrl=this.ssoUrl),this.isAutoConsentDisabled&&(t.autoConsent=!1),this.httpMethod){const o=this.httpMethod.toUpperCase(),s=exports.HttpMethod[o];t.httpMethod=s}this.baseUrl&&(t.baseURL=this.baseUrl),this.provider=new TeamsMsal2Provider(t),Providers.globalProvider=this.provider}}},__decorate$1([e$1({attribute:"client-id",type:String}),__metadata$1("design:type",Object)],exports.MgtTeamsMsal2Provider.prototype,"clientId",void 0),__decorate$1([e$1({attribute:"auth-popup-url",type:String}),__metadata$1("design:type",Object)],exports.MgtTeamsMsal2Provider.prototype,"authPopupUrl",void 0),__decorate$1([e$1({attribute:"sso-url",type:String}),__metadata$1("design:type",Object)],exports.MgtTeamsMsal2Provider.prototype,"ssoUrl",void 0),__decorate$1([e$1(),__metadata$1("design:type",Object)],exports.MgtTeamsMsal2Provider.prototype,"authority",void 0),__decorate$1([e$1({attribute:"scopes",type:String}),__metadata$1("design:type",Object)],exports.MgtTeamsMsal2Provider.prototype,"scopes",void 0),__decorate$1([e$1({attribute:"auto-consent-disabled",type:Boolean}),__metadata$1("design:type",Object)],exports.MgtTeamsMsal2Provider.prototype,"isAutoConsentDisabled",void 0),__decorate$1([e$1({attribute:"http-method",type:String}),__metadata$1("design:type",Object)],exports.MgtTeamsMsal2Provider.prototype,"httpMethod",void 0),exports.MgtTeamsMsal2Provider=__decorate$1([customElement("teams-msal2-provider")],exports.MgtTeamsMsal2Provider);var __decorate=function(t,o,s,l){var h,v=arguments.length,m=v<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(t,o,s,l);else for(var _=t.length-1;_>=0;_--)(h=t[_])&&(m=(v<3?h(m):v>3?h(o,s,m):h(o,s))||m);return v>3&&m&&Object.defineProperty(o,s,m),m},__metadata=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)};exports.MgtMockProvider=class MgtMockProvider extends MgtBaseProvider{initializeProvider(){Providers.globalProvider=new MockProvider(!this.signedOut)}},__decorate([e$1({attribute:"signed-out",type:Boolean}),__metadata("design:type",Object)],exports.MgtMockProvider.prototype,"signedOut",void 0),exports.MgtMockProvider=__decorate([customElement("mock-provider")],exports.MgtMockProvider),exports.BatchResponse=BatchResponse,exports.BetaGraph=BetaGraph,exports.CacheService=CacheService,exports.CacheStore=CacheStore,exports.EventDispatcher=EventDispatcher,exports.Graph=Graph,exports.GraphPageIterator=GraphPageIterator,exports.IProvider=IProvider,exports.LocalizationHelper=LocalizationHelper,exports.MICROSOFT_GRAPH_DEFAULT_ENDPOINT=HE,exports.MICROSOFT_GRAPH_ENDPOINTS=UE,exports.MgtBaseComponent=MgtBaseComponent,exports.MgtBaseProvider=MgtBaseProvider,exports.MgtTemplatedComponent=MgtTemplatedComponent,exports.MockProvider=MockProvider,exports.Msal2Provider=Msal2Provider,exports.MsalProvider=MsalProvider,exports.PACKAGE_VERSION=ZE,exports.Providers=Providers,exports.ProxyProvider=ProxyProvider,exports.SharePointProvider=class SharePointProvider extends IProvider{get provider(){return this._provider}get isLoggedIn(){return!!this._idToken}get name(){return"MgtSharePointProvider"}constructor(t,o=HE){super(),t.aadTokenProviderFactory.getTokenProvider().then((t=>{this._provider=t,this.baseURL=o,this.graph=createFromProvider(this),this.internalLogin()}))}getAccessToken(){return __awaiter$4(this,void 0,void 0,(function*(){let t;const o=this.baseURL?this.baseURL:HE;try{t=yield this.provider.getToken(o)}catch(t){throw t}return t}))}updateScopes(t){this.scopes=t}internalLogin(){return __awaiter$4(this,void 0,void 0,(function*(){this._idToken=yield this.getAccessToken(),this.setState(this._idToken?exports.ProviderState.SignedIn:exports.ProviderState.SignedOut)}))}},exports.SimpleProvider=class SimpleProvider extends IProvider{get name(){return"MgtSimpleProvider"}constructor(t,o,s){super(),this._getAccessTokenHandler=t,this._loginHandler=o,this._logoutHandler=s,this.graph=createFromProvider(this)}getAccessToken(t){return this._getAccessTokenHandler(null==t?void 0:t.scopes)}login(){return this._loginHandler()}logout(){return this._logoutHandler()}},exports.TeamsHelper=TeamsHelper,exports.TeamsMsal2Provider=TeamsMsal2Provider,exports.TeamsProvider=TeamsProvider,exports.TemplateHelper=TemplateHelper,exports.arraysAreEqual=arraysAreEqual,exports.chainMiddleware=chainMiddleware,exports.createFromProvider=createFromProvider,exports.customElement=customElement,exports.customElementHelper=eI,exports.equals=equals,exports.mgtHtml=mgtHtml,exports.prepScopes=prepScopes,exports.validateBaseURL=validateBaseURL;
//# sourceMappingURL=index.js.map
